const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/dagre-OKDRZEBW-BP_uGu6R.js","assets/graph-CriWao33.js","assets/_baseUniq-C0bb_mFs.js","assets/layout-DPESh4NU.js","assets/_basePickBy-BWdnTDeb.js","assets/clone-rNAJPkRc.js","assets/c4Diagram-VJAJSXHY-DAoYp8P1.js","assets/chunk-D6G4REZN-CUGyGY38.js","assets/flowDiagram-4HSFHLVR-DV0MFZip.js","assets/chunk-RZ5BOZE2-B7e3iobb.js","assets/channel-Bzo2vI2W.js","assets/erDiagram-Q7BY3M3F-DQXt_1Bg.js","assets/gitGraphDiagram-7IBYFJ6S-D4Y31WBC.js","assets/chunk-4BMEZGHF-Bt7Wor2v.js","assets/chunk-XZIHB7SX-BHL6IEuk.js","assets/radar-MK3ICKWK-C8zRb4w-.js","assets/ganttDiagram-APWFNJXF-BzM2t_dV.js","assets/linear-1KgKtojT.js","assets/init-Gi6I4Gst.js","assets/infoDiagram-PH2N3AL5-jE3WwQYk.js","assets/pieDiagram-IB7DONF6-Dm8Axtby.js","assets/arc-BV7-4RXa.js","assets/ordinal-Cboi1Yqb.js","assets/quadrantDiagram-7GDLP6J5-DgaaC3vq.js","assets/xychartDiagram-VJFVF3MP-B8QNAwNv.js","assets/requirementDiagram-KVF5MWMF-CuBxPlW9.js","assets/sequenceDiagram-X6HHIX6F-CgSrSdSo.js","assets/classDiagram-GIVACNV2-6ORpZH1j.js","assets/chunk-A2AXSNBT-D8zA_7pu.js","assets/classDiagram-v2-COTLJTTW-6ORpZH1j.js","assets/stateDiagram-DGXRK772-BiXRKdTN.js","assets/chunk-AEK57VVT-9CYAYmzv.js","assets/stateDiagram-v2-YXO3MK2T-Ch1LouUT.js","assets/journeyDiagram-U35MCT3I-633ng70h.js","assets/timeline-definition-BDJGKUSR-DlhRL8hc.js","assets/mindmap-definition-ALO5MXBD-DJOoKNdo.js","assets/cytoscape.esm-D9QUsnXz.js","assets/sankeyDiagram-QLVOVGJD-BpP9x-9M.js","assets/diagram-VNBRO52H-CZc-FANS.js","assets/diagram-SSKATNLV-BITmD47d.js","assets/blockDiagram-JOT3LUYC-CJ7Eq9Ut.js","assets/architectureDiagram-IEHRJDOE-Caw6k2ZI.js"])))=>i.map(i=>d[i]);
var uhe=Object.defineProperty;var dhe=(e,t,n)=>t in e?uhe(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ue=(e,t,n)=>dhe(e,typeof t!="symbol"?t+"":t,n);function fhe(e,t){for(var n=0;n<t.length;n++){const r=t[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in e)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(e,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}))}(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var im=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function da(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var mN={exports:{}},Ov={};/**
 * @license React
 * react-jsx-runtime.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var uB;function hhe(){if(uB)return Ov;uB=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.fragment");function n(r,s,i){var a=null;if(i!==void 0&&(a=""+i),s.key!==void 0&&(a=""+s.key),"key"in s){i={};for(var o in s)o!=="key"&&(i[o]=s[o])}else i=s;return s=i.ref,{$$typeof:e,type:r,key:a,ref:s!==void 0?s:null,props:i}}return Ov.Fragment=t,Ov.jsx=n,Ov.jsxs=n,Ov}var dB;function phe(){return dB||(dB=1,mN.exports=hhe()),mN.exports}var f=phe(),gN={exports:{}};function mhe(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var eH={exports:{}},wi=eH.exports={},hu,pu;function Z3(){throw new Error("setTimeout has not been defined")}function X3(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?hu=setTimeout:hu=Z3}catch{hu=Z3}try{typeof clearTimeout=="function"?pu=clearTimeout:pu=X3}catch{pu=X3}})();function tH(e){if(hu===setTimeout)return setTimeout(e,0);if((hu===Z3||!hu)&&setTimeout)return hu=setTimeout,setTimeout(e,0);try{return hu(e,0)}catch{try{return hu.call(null,e,0)}catch{return hu.call(this,e,0)}}}function ghe(e){if(pu===clearTimeout)return clearTimeout(e);if((pu===X3||!pu)&&clearTimeout)return pu=clearTimeout,clearTimeout(e);try{return pu(e)}catch{try{return pu.call(null,e)}catch{return pu.call(this,e)}}}var Md=[],O0=!1,am,jC=-1;function yhe(){!O0||!am||(O0=!1,am.length?Md=am.concat(Md):jC=-1,Md.length&&nH())}function nH(){if(!O0){var e=tH(yhe);O0=!0;for(var t=Md.length;t;){for(am=Md,Md=[];++jC<t;)am&&am[jC].run();jC=-1,t=Md.length}am=null,O0=!1,ghe(e)}}wi.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];Md.push(new rH(e,t)),Md.length===1&&!O0&&tH(nH)};function rH(e,t){this.fun=e,this.array=t}rH.prototype.run=function(){this.fun.apply(null,this.array)};wi.title="browser";wi.browser=!0;wi.env={};wi.argv=[];wi.version="";wi.versions={};function rf(){}wi.on=rf;wi.addListener=rf;wi.once=rf;wi.off=rf;wi.removeListener=rf;wi.removeAllListeners=rf;wi.emit=rf;wi.prependListener=rf;wi.prependOnceListener=rf;wi.listeners=function(e){return[]};wi.binding=function(e){throw new Error("process.binding is not supported")};wi.cwd=function(){return"/"};wi.chdir=function(e){throw new Error("process.chdir is not supported")};wi.umask=function(){return 0};var bhe=eH.exports;const Mi=mhe(bhe);var Ar={},fB;function vhe(){if(fB)return Ar;fB=1;var e=Symbol.for("react.transitional.element"),t=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),s=Symbol.for("react.profiler"),i=Symbol.for("react.consumer"),a=Symbol.for("react.context"),o=Symbol.for("react.forward_ref"),l=Symbol.for("react.suspense"),c=Symbol.for("react.memo"),u=Symbol.for("react.lazy"),d=Symbol.iterator;function h(W){return W===null||typeof W!="object"?null:(W=d&&W[d]||W["@@iterator"],typeof W=="function"?W:null)}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},y=Object.assign,b={};function v(W,Q,ee){this.props=W,this.context=Q,this.refs=b,this.updater=ee||m}v.prototype.isReactComponent={},v.prototype.setState=function(W,Q){if(typeof W!="object"&&typeof W!="function"&&W!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,W,Q,"setState")},v.prototype.forceUpdate=function(W){this.updater.enqueueForceUpdate(this,W,"forceUpdate")};function x(){}x.prototype=v.prototype;function w(W,Q,ee){this.props=W,this.context=Q,this.refs=b,this.updater=ee||m}var S=w.prototype=new x;S.constructor=w,y(S,v.prototype),S.isPureReactComponent=!0;var k=Array.isArray,C={H:null,A:null,T:null,S:null,V:null},T=Object.prototype.hasOwnProperty;function A(W,Q,ee,re,pe,de){return ee=de.ref,{$$typeof:e,type:W,key:Q,ref:ee!==void 0?ee:null,props:de}}function N(W,Q){return A(W.type,Q,void 0,void 0,void 0,W.props)}function I(W){return typeof W=="object"&&W!==null&&W.$$typeof===e}function O(W){var Q={"=":"=0",":":"=2"};return"$"+W.replace(/[=:]/g,function(ee){return Q[ee]})}var B=/\/+/g;function D(W,Q){return typeof W=="object"&&W!==null&&W.key!=null?O(""+W.key):Q.toString(36)}function H(){}function P(W){switch(W.status){case"fulfilled":return W.value;case"rejected":throw W.reason;default:switch(typeof W.status=="string"?W.then(H,H):(W.status="pending",W.then(function(Q){W.status==="pending"&&(W.status="fulfilled",W.value=Q)},function(Q){W.status==="pending"&&(W.status="rejected",W.reason=Q)})),W.status){case"fulfilled":return W.value;case"rejected":throw W.reason}}throw W}function K(W,Q,ee,re,pe){var de=typeof W;(de==="undefined"||de==="boolean")&&(W=null);var Oe=!1;if(W===null)Oe=!0;else switch(de){case"bigint":case"string":case"number":Oe=!0;break;case"object":switch(W.$$typeof){case e:case t:Oe=!0;break;case u:return Oe=W._init,K(Oe(W._payload),Q,ee,re,pe)}}if(Oe)return pe=pe(W),Oe=re===""?"."+D(W,0):re,k(pe)?(ee="",Oe!=null&&(ee=Oe.replace(B,"$&/")+"/"),K(pe,Q,ee,"",function(Ce){return Ce})):pe!=null&&(I(pe)&&(pe=N(pe,ee+(pe.key==null||W&&W.key===pe.key?"":(""+pe.key).replace(B,"$&/")+"/")+Oe)),Q.push(pe)),1;Oe=0;var Fe=re===""?".":re+":";if(k(W))for(var Se=0;Se<W.length;Se++)re=W[Se],de=Fe+D(re,Se),Oe+=K(re,Q,ee,de,pe);else if(Se=h(W),typeof Se=="function")for(W=Se.call(W),Se=0;!(re=W.next()).done;)re=re.value,de=Fe+D(re,Se++),Oe+=K(re,Q,ee,de,pe);else if(de==="object"){if(typeof W.then=="function")return K(P(W),Q,ee,re,pe);throw Q=String(W),Error("Objects are not valid as a React child (found: "+(Q==="[object Object]"?"object with keys {"+Object.keys(W).join(", ")+"}":Q)+"). If you meant to render a collection of children, use an array instead.")}return Oe}function U(W,Q,ee){if(W==null)return W;var re=[],pe=0;return K(W,re,"","",function(de){return Q.call(ee,de,pe++)}),re}function V(W){if(W._status===-1){var Q=W._result;Q=Q(),Q.then(function(ee){(W._status===0||W._status===-1)&&(W._status=1,W._result=ee)},function(ee){(W._status===0||W._status===-1)&&(W._status=2,W._result=ee)}),W._status===-1&&(W._status=0,W._result=Q)}if(W._status===1)return W._result.default;throw W._result}var L=typeof reportError=="function"?reportError:function(W){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var Q=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof W=="object"&&W!==null&&typeof W.message=="string"?String(W.message):String(W),error:W});if(!window.dispatchEvent(Q))return}else if(typeof Mi=="object"&&typeof Mi.emit=="function"){Mi.emit("uncaughtException",W);return}console.error(W)};function te(){}return Ar.Children={map:U,forEach:function(W,Q,ee){U(W,function(){Q.apply(this,arguments)},ee)},count:function(W){var Q=0;return U(W,function(){Q++}),Q},toArray:function(W){return U(W,function(Q){return Q})||[]},only:function(W){if(!I(W))throw Error("React.Children.only expected to receive a single React element child.");return W}},Ar.Component=v,Ar.Fragment=n,Ar.Profiler=s,Ar.PureComponent=w,Ar.StrictMode=r,Ar.Suspense=l,Ar.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=C,Ar.__COMPILER_RUNTIME={__proto__:null,c:function(W){return C.H.useMemoCache(W)}},Ar.cache=function(W){return function(){return W.apply(null,arguments)}},Ar.cloneElement=function(W,Q,ee){if(W==null)throw Error("The argument must be a React element, but you passed "+W+".");var re=y({},W.props),pe=W.key,de=void 0;if(Q!=null)for(Oe in Q.ref!==void 0&&(de=void 0),Q.key!==void 0&&(pe=""+Q.key),Q)!T.call(Q,Oe)||Oe==="key"||Oe==="__self"||Oe==="__source"||Oe==="ref"&&Q.ref===void 0||(re[Oe]=Q[Oe]);var Oe=arguments.length-2;if(Oe===1)re.children=ee;else if(1<Oe){for(var Fe=Array(Oe),Se=0;Se<Oe;Se++)Fe[Se]=arguments[Se+2];re.children=Fe}return A(W.type,pe,void 0,void 0,de,re)},Ar.createContext=function(W){return W={$$typeof:a,_currentValue:W,_currentValue2:W,_threadCount:0,Provider:null,Consumer:null},W.Provider=W,W.Consumer={$$typeof:i,_context:W},W},Ar.createElement=function(W,Q,ee){var re,pe={},de=null;if(Q!=null)for(re in Q.key!==void 0&&(de=""+Q.key),Q)T.call(Q,re)&&re!=="key"&&re!=="__self"&&re!=="__source"&&(pe[re]=Q[re]);var Oe=arguments.length-2;if(Oe===1)pe.children=ee;else if(1<Oe){for(var Fe=Array(Oe),Se=0;Se<Oe;Se++)Fe[Se]=arguments[Se+2];pe.children=Fe}if(W&&W.defaultProps)for(re in Oe=W.defaultProps,Oe)pe[re]===void 0&&(pe[re]=Oe[re]);return A(W,de,void 0,void 0,null,pe)},Ar.createRef=function(){return{current:null}},Ar.forwardRef=function(W){return{$$typeof:o,render:W}},Ar.isValidElement=I,Ar.lazy=function(W){return{$$typeof:u,_payload:{_status:-1,_result:W},_init:V}},Ar.memo=function(W,Q){return{$$typeof:c,type:W,compare:Q===void 0?null:Q}},Ar.startTransition=function(W){var Q=C.T,ee={};C.T=ee;try{var re=W(),pe=C.S;pe!==null&&pe(ee,re),typeof re=="object"&&re!==null&&typeof re.then=="function"&&re.then(te,L)}catch(de){L(de)}finally{C.T=Q}},Ar.unstable_useCacheRefresh=function(){return C.H.useCacheRefresh()},Ar.use=function(W){return C.H.use(W)},Ar.useActionState=function(W,Q,ee){return C.H.useActionState(W,Q,ee)},Ar.useCallback=function(W,Q){return C.H.useCallback(W,Q)},Ar.useContext=function(W){return C.H.useContext(W)},Ar.useDebugValue=function(){},Ar.useDeferredValue=function(W,Q){return C.H.useDeferredValue(W,Q)},Ar.useEffect=function(W,Q,ee){var re=C.H;if(typeof ee=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return re.useEffect(W,Q)},Ar.useId=function(){return C.H.useId()},Ar.useImperativeHandle=function(W,Q,ee){return C.H.useImperativeHandle(W,Q,ee)},Ar.useInsertionEffect=function(W,Q){return C.H.useInsertionEffect(W,Q)},Ar.useLayoutEffect=function(W,Q){return C.H.useLayoutEffect(W,Q)},Ar.useMemo=function(W,Q){return C.H.useMemo(W,Q)},Ar.useOptimistic=function(W,Q){return C.H.useOptimistic(W,Q)},Ar.useReducer=function(W,Q,ee){return C.H.useReducer(W,Q,ee)},Ar.useRef=function(W){return C.H.useRef(W)},Ar.useState=function(W){return C.H.useState(W)},Ar.useSyncExternalStore=function(W,Q,ee){return C.H.useSyncExternalStore(W,Q,ee)},Ar.useTransition=function(){return C.H.useTransition()},Ar.version="19.1.0",Ar}var hB;function qy(){return hB||(hB=1,gN.exports=vhe()),gN.exports}var E=qy();const Ve=da(E),sH=fhe({__proto__:null,default:Ve},[E]);var yN={exports:{}},Dv={},bN={exports:{}},vN={};/**
 * @license React
 * scheduler.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var pB;function xhe(){return pB||(pB=1,function(e){function t(U,V){var L=U.length;U.push(V);e:for(;0<L;){var te=L-1>>>1,W=U[te];if(0<s(W,V))U[te]=V,U[L]=W,L=te;else break e}}function n(U){return U.length===0?null:U[0]}function r(U){if(U.length===0)return null;var V=U[0],L=U.pop();if(L!==V){U[0]=L;e:for(var te=0,W=U.length,Q=W>>>1;te<Q;){var ee=2*(te+1)-1,re=U[ee],pe=ee+1,de=U[pe];if(0>s(re,L))pe<W&&0>s(de,re)?(U[te]=de,U[pe]=L,te=pe):(U[te]=re,U[ee]=L,te=ee);else if(pe<W&&0>s(de,L))U[te]=de,U[pe]=L,te=pe;else break e}}return V}function s(U,V){var L=U.sortIndex-V.sortIndex;return L!==0?L:U.id-V.id}if(e.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var i=performance;e.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],c=[],u=1,d=null,h=3,m=!1,y=!1,b=!1,v=!1,x=typeof setTimeout=="function"?setTimeout:null,w=typeof clearTimeout=="function"?clearTimeout:null,S=typeof setImmediate<"u"?setImmediate:null;function k(U){for(var V=n(c);V!==null;){if(V.callback===null)r(c);else if(V.startTime<=U)r(c),V.sortIndex=V.expirationTime,t(l,V);else break;V=n(c)}}function C(U){if(b=!1,k(U),!y)if(n(l)!==null)y=!0,T||(T=!0,D());else{var V=n(c);V!==null&&K(C,V.startTime-U)}}var T=!1,A=-1,N=5,I=-1;function O(){return v?!0:!(e.unstable_now()-I<N)}function B(){if(v=!1,T){var U=e.unstable_now();I=U;var V=!0;try{e:{y=!1,b&&(b=!1,w(A),A=-1),m=!0;var L=h;try{t:{for(k(U),d=n(l);d!==null&&!(d.expirationTime>U&&O());){var te=d.callback;if(typeof te=="function"){d.callback=null,h=d.priorityLevel;var W=te(d.expirationTime<=U);if(U=e.unstable_now(),typeof W=="function"){d.callback=W,k(U),V=!0;break t}d===n(l)&&r(l),k(U)}else r(l);d=n(l)}if(d!==null)V=!0;else{var Q=n(c);Q!==null&&K(C,Q.startTime-U),V=!1}}break e}finally{d=null,h=L,m=!1}V=void 0}}finally{V?D():T=!1}}}var D;if(typeof S=="function")D=function(){S(B)};else if(typeof MessageChannel<"u"){var H=new MessageChannel,P=H.port2;H.port1.onmessage=B,D=function(){P.postMessage(null)}}else D=function(){x(B,0)};function K(U,V){A=x(function(){U(e.unstable_now())},V)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(U){U.callback=null},e.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):N=0<U?Math.floor(1e3/U):5},e.unstable_getCurrentPriorityLevel=function(){return h},e.unstable_next=function(U){switch(h){case 1:case 2:case 3:var V=3;break;default:V=h}var L=h;h=V;try{return U()}finally{h=L}},e.unstable_requestPaint=function(){v=!0},e.unstable_runWithPriority=function(U,V){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var L=h;h=U;try{return V()}finally{h=L}},e.unstable_scheduleCallback=function(U,V,L){var te=e.unstable_now();switch(typeof L=="object"&&L!==null?(L=L.delay,L=typeof L=="number"&&0<L?te+L:te):L=te,U){case 1:var W=-1;break;case 2:W=250;break;case 5:W=1073741823;break;case 4:W=1e4;break;default:W=5e3}return W=L+W,U={id:u++,callback:V,priorityLevel:U,startTime:L,expirationTime:W,sortIndex:-1},L>te?(U.sortIndex=L,t(c,U),n(l)===null&&U===n(c)&&(b?(w(A),A=-1):b=!0,K(C,L-te))):(U.sortIndex=W,t(l,U),y||m||(y=!0,T||(T=!0,D()))),U},e.unstable_shouldYield=O,e.unstable_wrapCallback=function(U){var V=h;return function(){var L=h;h=V;try{return U.apply(this,arguments)}finally{h=L}}}}(vN)),vN}var mB;function whe(){return mB||(mB=1,bN.exports=xhe()),bN.exports}var xN={exports:{}},Na={};/**
 * @license React
 * react-dom.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var gB;function _he(){if(gB)return Na;gB=1;var e=qy();function t(l){var c="https://react.dev/errors/"+l;if(1<arguments.length){c+="?args[]="+encodeURIComponent(arguments[1]);for(var u=2;u<arguments.length;u++)c+="&args[]="+encodeURIComponent(arguments[u])}return"Minified React error #"+l+"; visit "+c+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function n(){}var r={d:{f:n,r:function(){throw Error(t(522))},D:n,C:n,L:n,m:n,X:n,S:n,M:n},p:0,findDOMNode:null},s=Symbol.for("react.portal");function i(l,c,u){var d=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:s,key:d==null?null:""+d,children:l,containerInfo:c,implementation:u}}var a=e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;function o(l,c){if(l==="font")return"";if(typeof c=="string")return c==="use-credentials"?c:""}return Na.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=r,Na.createPortal=function(l,c){var u=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!c||c.nodeType!==1&&c.nodeType!==9&&c.nodeType!==11)throw Error(t(299));return i(l,c,null,u)},Na.flushSync=function(l){var c=a.T,u=r.p;try{if(a.T=null,r.p=2,l)return l()}finally{a.T=c,r.p=u,r.d.f()}},Na.preconnect=function(l,c){typeof l=="string"&&(c?(c=c.crossOrigin,c=typeof c=="string"?c==="use-credentials"?c:"":void 0):c=null,r.d.C(l,c))},Na.prefetchDNS=function(l){typeof l=="string"&&r.d.D(l)},Na.preinit=function(l,c){if(typeof l=="string"&&c&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin),h=typeof c.integrity=="string"?c.integrity:void 0,m=typeof c.fetchPriority=="string"?c.fetchPriority:void 0;u==="style"?r.d.S(l,typeof c.precedence=="string"?c.precedence:void 0,{crossOrigin:d,integrity:h,fetchPriority:m}):u==="script"&&r.d.X(l,{crossOrigin:d,integrity:h,fetchPriority:m,nonce:typeof c.nonce=="string"?c.nonce:void 0})}},Na.preinitModule=function(l,c){if(typeof l=="string")if(typeof c=="object"&&c!==null){if(c.as==null||c.as==="script"){var u=o(c.as,c.crossOrigin);r.d.M(l,{crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0})}}else c==null&&r.d.M(l)},Na.preload=function(l,c){if(typeof l=="string"&&typeof c=="object"&&c!==null&&typeof c.as=="string"){var u=c.as,d=o(u,c.crossOrigin);r.d.L(l,u,{crossOrigin:d,integrity:typeof c.integrity=="string"?c.integrity:void 0,nonce:typeof c.nonce=="string"?c.nonce:void 0,type:typeof c.type=="string"?c.type:void 0,fetchPriority:typeof c.fetchPriority=="string"?c.fetchPriority:void 0,referrerPolicy:typeof c.referrerPolicy=="string"?c.referrerPolicy:void 0,imageSrcSet:typeof c.imageSrcSet=="string"?c.imageSrcSet:void 0,imageSizes:typeof c.imageSizes=="string"?c.imageSizes:void 0,media:typeof c.media=="string"?c.media:void 0})}},Na.preloadModule=function(l,c){if(typeof l=="string")if(c){var u=o(c.as,c.crossOrigin);r.d.m(l,{as:typeof c.as=="string"&&c.as!=="script"?c.as:void 0,crossOrigin:u,integrity:typeof c.integrity=="string"?c.integrity:void 0})}else r.d.m(l)},Na.requestFormReset=function(l){r.d.r(l)},Na.unstable_batchedUpdates=function(l,c){return l(c)},Na.useFormState=function(l,c,u){return a.H.useFormState(l,c,u)},Na.useFormStatus=function(){return a.H.useHostTransitionStatus()},Na.version="19.1.0",Na}var yB;function iH(){if(yB)return xN.exports;yB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),xN.exports=_he(),xN.exports}var bB;function She(){if(bB)return Dv;bB=1;var e=whe(),t=qy(),n=iH();function r(p){var g="https://react.dev/errors/"+p;if(1<arguments.length){g+="?args[]="+encodeURIComponent(arguments[1]);for(var _=2;_<arguments.length;_++)g+="&args[]="+encodeURIComponent(arguments[_])}return"Minified React error #"+p+"; visit "+g+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}function s(p){return!(!p||p.nodeType!==1&&p.nodeType!==9&&p.nodeType!==11)}function i(p){var g=p,_=p;if(p.alternate)for(;g.return;)g=g.return;else{p=g;do g=p,(g.flags&4098)!==0&&(_=g.return),p=g.return;while(p)}return g.tag===3?_:null}function a(p){if(p.tag===13){var g=p.memoizedState;if(g===null&&(p=p.alternate,p!==null&&(g=p.memoizedState)),g!==null)return g.dehydrated}return null}function o(p){if(i(p)!==p)throw Error(r(188))}function l(p){var g=p.alternate;if(!g){if(g=i(p),g===null)throw Error(r(188));return g!==p?null:p}for(var _=p,R=g;;){var j=_.return;if(j===null)break;var q=j.alternate;if(q===null){if(R=j.return,R!==null){_=R;continue}break}if(j.child===q.child){for(q=j.child;q;){if(q===_)return o(j),p;if(q===R)return o(j),g;q=q.sibling}throw Error(r(188))}if(_.return!==R.return)_=j,R=q;else{for(var he=!1,Pe=j.child;Pe;){if(Pe===_){he=!0,_=j,R=q;break}if(Pe===R){he=!0,R=j,_=q;break}Pe=Pe.sibling}if(!he){for(Pe=q.child;Pe;){if(Pe===_){he=!0,_=q,R=j;break}if(Pe===R){he=!0,R=q,_=j;break}Pe=Pe.sibling}if(!he)throw Error(r(189))}}if(_.alternate!==R)throw Error(r(190))}if(_.tag!==3)throw Error(r(188));return _.stateNode.current===_?p:g}function c(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p;for(p=p.child;p!==null;){if(g=c(p),g!==null)return g;p=p.sibling}return null}var u=Object.assign,d=Symbol.for("react.element"),h=Symbol.for("react.transitional.element"),m=Symbol.for("react.portal"),y=Symbol.for("react.fragment"),b=Symbol.for("react.strict_mode"),v=Symbol.for("react.profiler"),x=Symbol.for("react.provider"),w=Symbol.for("react.consumer"),S=Symbol.for("react.context"),k=Symbol.for("react.forward_ref"),C=Symbol.for("react.suspense"),T=Symbol.for("react.suspense_list"),A=Symbol.for("react.memo"),N=Symbol.for("react.lazy"),I=Symbol.for("react.activity"),O=Symbol.for("react.memo_cache_sentinel"),B=Symbol.iterator;function D(p){return p===null||typeof p!="object"?null:(p=B&&p[B]||p["@@iterator"],typeof p=="function"?p:null)}var H=Symbol.for("react.client.reference");function P(p){if(p==null)return null;if(typeof p=="function")return p.$$typeof===H?null:p.displayName||p.name||null;if(typeof p=="string")return p;switch(p){case y:return"Fragment";case v:return"Profiler";case b:return"StrictMode";case C:return"Suspense";case T:return"SuspenseList";case I:return"Activity"}if(typeof p=="object")switch(p.$$typeof){case m:return"Portal";case S:return(p.displayName||"Context")+".Provider";case w:return(p._context.displayName||"Context")+".Consumer";case k:var g=p.render;return p=p.displayName,p||(p=g.displayName||g.name||"",p=p!==""?"ForwardRef("+p+")":"ForwardRef"),p;case A:return g=p.displayName||null,g!==null?g:P(p.type)||"Memo";case N:g=p._payload,p=p._init;try{return P(p(g))}catch{}}return null}var K=Array.isArray,U=t.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,V=n.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,L={pending:!1,data:null,method:null,action:null},te=[],W=-1;function Q(p){return{current:p}}function ee(p){0>W||(p.current=te[W],te[W]=null,W--)}function re(p,g){W++,te[W]=p.current,p.current=g}var pe=Q(null),de=Q(null),Oe=Q(null),Fe=Q(null);function Se(p,g){switch(re(Oe,g),re(de,p),re(pe,null),g.nodeType){case 9:case 11:p=(p=g.documentElement)&&(p=p.namespaceURI)?LL(p):0;break;default:if(p=g.tagName,g=g.namespaceURI)g=LL(g),p=BL(g,p);else switch(p){case"svg":p=1;break;case"math":p=2;break;default:p=0}}ee(pe),re(pe,p)}function Ce(){ee(pe),ee(de),ee(Oe)}function qe(p){p.memoizedState!==null&&re(Fe,p);var g=pe.current,_=BL(g,p.type);g!==_&&(re(de,p),re(pe,_))}function Qe(p){de.current===p&&(ee(pe),ee(de)),Fe.current===p&&(ee(Fe),Nv._currentValue=L)}var We=Object.prototype.hasOwnProperty,je=e.unstable_scheduleCallback,Y=e.unstable_cancelCallback,ye=e.unstable_shouldYield,Ie=e.unstable_requestPaint,ce=e.unstable_now,oe=e.unstable_getCurrentPriorityLevel,se=e.unstable_ImmediatePriority,Me=e.unstable_UserBlockingPriority,Be=e.unstable_NormalPriority,Ae=e.unstable_LowPriority,lt=e.unstable_IdlePriority,Tt=e.log,dt=e.unstable_setDisableYieldValue,Pt=null,qt=null;function Ft(p){if(typeof Tt=="function"&&dt(p),qt&&typeof qt.setStrictMode=="function")try{qt.setStrictMode(Pt,p)}catch{}}var Ht=Math.clz32?Math.clz32:X,we=Math.log,F=Math.LN2;function X(p){return p>>>=0,p===0?32:31-(we(p)/F|0)|0}var be=256,ke=4194304;function ge(p){var g=p&42;if(g!==0)return g;switch(p&-p){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return p&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return p&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return p}}function Ee(p,g,_){var R=p.pendingLanes;if(R===0)return 0;var j=0,q=p.suspendedLanes,he=p.pingedLanes;p=p.warmLanes;var Pe=R&134217727;return Pe!==0?(R=Pe&~q,R!==0?j=ge(R):(he&=Pe,he!==0?j=ge(he):_||(_=Pe&~p,_!==0&&(j=ge(_))))):(Pe=R&~q,Pe!==0?j=ge(Pe):he!==0?j=ge(he):_||(_=R&~p,_!==0&&(j=ge(_)))),j===0?0:g!==0&&g!==j&&(g&q)===0&&(q=j&-j,_=g&-g,q>=_||q===32&&(_&4194048)!==0)?g:j}function le(p,g){return(p.pendingLanes&~(p.suspendedLanes&~p.pingedLanes)&g)===0}function ft(p,g){switch(p){case 1:case 2:case 4:case 8:case 64:return g+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return g+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function et(){var p=be;return be<<=1,(be&4194048)===0&&(be=256),p}function $(){var p=ke;return ke<<=1,(ke&62914560)===0&&(ke=4194304),p}function Ue(p){for(var g=[],_=0;31>_;_++)g.push(p);return g}function tt(p,g){p.pendingLanes|=g,g!==268435456&&(p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0)}function ve(p,g,_,R,j,q){var he=p.pendingLanes;p.pendingLanes=_,p.suspendedLanes=0,p.pingedLanes=0,p.warmLanes=0,p.expiredLanes&=_,p.entangledLanes&=_,p.errorRecoveryDisabledLanes&=_,p.shellSuspendCounter=0;var Pe=p.entanglements,Ye=p.expirationTimes,St=p.hiddenUpdates;for(_=he&~_;0<_;){var Dt=31-Ht(_),Bt=1<<Dt;Pe[Dt]=0,Ye[Dt]=-1;var Et=St[Dt];if(Et!==null)for(St[Dt]=null,Dt=0;Dt<Et.length;Dt++){var Rt=Et[Dt];Rt!==null&&(Rt.lane&=-536870913)}_&=~Bt}R!==0&&_e(p,R,0),q!==0&&j===0&&p.tag!==0&&(p.suspendedLanes|=q&~(he&~g))}function _e(p,g,_){p.pendingLanes|=g,p.suspendedLanes&=~g;var R=31-Ht(g);p.entangledLanes|=g,p.entanglements[R]=p.entanglements[R]|1073741824|_&4194090}function ze(p,g){var _=p.entangledLanes|=g;for(p=p.entanglements;_;){var R=31-Ht(_),j=1<<R;j&g|p[R]&g&&(p[R]|=g),_&=~j}}function Ct(p){switch(p){case 2:p=1;break;case 8:p=4;break;case 32:p=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:p=128;break;case 268435456:p=134217728;break;default:p=0}return p}function fe(p){return p&=-p,2<p?8<p?(p&134217727)!==0?32:268435456:8:2}function Z(){var p=V.p;return p!==0?p:(p=window.event,p===void 0?32:sB(p.type))}function G(p,g){var _=V.p;try{return V.p=p,g()}finally{V.p=_}}var J=Math.random().toString(36).slice(2),xe="__reactFiber$"+J,De="__reactProps$"+J,He="__reactContainer$"+J,wt="__reactEvents$"+J,Qt="__reactListeners$"+J,On="__reactHandles$"+J,Zt="__reactResources$"+J,nn="__reactMarker$"+J;function fn(p){delete p[xe],delete p[De],delete p[wt],delete p[Qt],delete p[On]}function br(p){var g=p[xe];if(g)return g;for(var _=p.parentNode;_;){if(g=_[He]||_[xe]){if(_=g.alternate,g.child!==null||_!==null&&_.child!==null)for(p=qL(p);p!==null;){if(_=p[xe])return _;p=qL(p)}return g}p=_,_=p.parentNode}return null}function Mr(p){if(p=p[xe]||p[He]){var g=p.tag;if(g===5||g===6||g===13||g===26||g===27||g===3)return p}return null}function rs(p){var g=p.tag;if(g===5||g===26||g===27||g===6)return p.stateNode;throw Error(r(33))}function ss(p){var g=p[Zt];return g||(g=p[Zt]={hoistableStyles:new Map,hoistableScripts:new Map}),g}function kr(p){p[nn]=!0}var mn=new Set,nt={};function Vt(p,g){gn(p,g),gn(p+"Capture",g)}function gn(p,g){for(nt[p]=g,p=0;p<g.length;p++)mn.add(g[p])}var ir=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),Rs={},ts={};function Di(p){return We.call(ts,p)?!0:We.call(Rs,p)?!1:ir.test(p)?ts[p]=!0:(Rs[p]=!0,!1)}function di(p,g,_){if(Di(g))if(_===null)p.removeAttribute(g);else{switch(typeof _){case"undefined":case"function":case"symbol":p.removeAttribute(g);return;case"boolean":var R=g.toLowerCase().slice(0,5);if(R!=="data-"&&R!=="aria-"){p.removeAttribute(g);return}}p.setAttribute(g,""+_)}}function Ga(p,g,_){if(_===null)p.removeAttribute(g);else{switch(typeof _){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(g);return}p.setAttribute(g,""+_)}}function pa(p,g,_,R){if(R===null)p.removeAttribute(_);else{switch(typeof R){case"undefined":case"function":case"symbol":case"boolean":p.removeAttribute(_);return}p.setAttributeNS(g,_,""+R)}}var Hs,Yo;function wl(p){if(Hs===void 0)try{throw Error()}catch(_){var g=_.stack.trim().match(/\n( *(at )?)/);Hs=g&&g[1]||"",Yo=-1<_.stack.indexOf(`
    at`)?" (<anonymous>)":-1<_.stack.indexOf("@")?"@unknown:0:0":""}return`
`+Hs+p+Yo}var Sf=!1;function fg(p,g){if(!p||Sf)return"";Sf=!0;var _=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{var R={DetermineComponentFrameRoot:function(){try{if(g){var Bt=function(){throw Error()};if(Object.defineProperty(Bt.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(Bt,[])}catch(Rt){var Et=Rt}Reflect.construct(p,[],Bt)}else{try{Bt.call()}catch(Rt){Et=Rt}p.call(Bt.prototype)}}else{try{throw Error()}catch(Rt){Et=Rt}(Bt=p())&&typeof Bt.catch=="function"&&Bt.catch(function(){})}}catch(Rt){if(Rt&&Et&&typeof Rt.stack=="string")return[Rt.stack,Et.stack]}return[null,null]}};R.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var j=Object.getOwnPropertyDescriptor(R.DetermineComponentFrameRoot,"name");j&&j.configurable&&Object.defineProperty(R.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var q=R.DetermineComponentFrameRoot(),he=q[0],Pe=q[1];if(he&&Pe){var Ye=he.split(`
`),St=Pe.split(`
`);for(j=R=0;R<Ye.length&&!Ye[R].includes("DetermineComponentFrameRoot");)R++;for(;j<St.length&&!St[j].includes("DetermineComponentFrameRoot");)j++;if(R===Ye.length||j===St.length)for(R=Ye.length-1,j=St.length-1;1<=R&&0<=j&&Ye[R]!==St[j];)j--;for(;1<=R&&0<=j;R--,j--)if(Ye[R]!==St[j]){if(R!==1||j!==1)do if(R--,j--,0>j||Ye[R]!==St[j]){var Dt=`
`+Ye[R].replace(" at new "," at ");return p.displayName&&Dt.includes("<anonymous>")&&(Dt=Dt.replace("<anonymous>",p.displayName)),Dt}while(1<=R&&0<=j);break}}}finally{Sf=!1,Error.prepareStackTrace=_}return(_=p?p.displayName||p.name:"")?wl(_):""}function Fr(p){switch(p.tag){case 26:case 27:case 5:return wl(p.type);case 16:return wl("Lazy");case 13:return wl("Suspense");case 19:return wl("SuspenseList");case 0:case 15:return fg(p.type,!1);case 11:return fg(p.type.render,!1);case 1:return fg(p.type,!0);case 31:return wl("Activity");default:return""}}function Ib(p){try{var g="";do g+=Fr(p),p=p.return;while(p);return g}catch(_){return`
Error generating stack: `+_.message+`
`+_.stack}}function Ka(p){switch(typeof p){case"bigint":case"boolean":case"number":case"string":case"undefined":return p;case"object":return p;default:return""}}function jb(p){var g=p.type;return(p=p.nodeName)&&p.toLowerCase()==="input"&&(g==="checkbox"||g==="radio")}function Ns(p){var g=jb(p)?"checked":"value",_=Object.getOwnPropertyDescriptor(p.constructor.prototype,g),R=""+p[g];if(!p.hasOwnProperty(g)&&typeof _<"u"&&typeof _.get=="function"&&typeof _.set=="function"){var j=_.get,q=_.set;return Object.defineProperty(p,g,{configurable:!0,get:function(){return j.call(this)},set:function(he){R=""+he,q.call(this,he)}}),Object.defineProperty(p,g,{enumerable:_.enumerable}),{getValue:function(){return R},setValue:function(he){R=""+he},stopTracking:function(){p._valueTracker=null,delete p[g]}}}}function Kc(p){p._valueTracker||(p._valueTracker=Ns(p))}function Cf(p){if(!p)return!1;var g=p._valueTracker;if(!g)return!0;var _=g.getValue(),R="";return p&&(R=jb(p)?p.checked?"true":"false":p.value),p=R,p!==_?(g.setValue(p),!0):!1}function lc(p){if(p=p||(typeof document<"u"?document:void 0),typeof p>"u")return null;try{return p.activeElement||p.body}catch{return p.body}}var Pb=/[\n"\\]/g;function Ea(p){return p.replace(Pb,function(g){return"\\"+g.charCodeAt(0).toString(16)+" "})}function kf(p,g,_,R,j,q,he,Pe){p.name="",he!=null&&typeof he!="function"&&typeof he!="symbol"&&typeof he!="boolean"?p.type=he:p.removeAttribute("type"),g!=null?he==="number"?(g===0&&p.value===""||p.value!=g)&&(p.value=""+Ka(g)):p.value!==""+Ka(g)&&(p.value=""+Ka(g)):he!=="submit"&&he!=="reset"||p.removeAttribute("value"),g!=null?Ef(p,he,Ka(g)):_!=null?Ef(p,he,Ka(_)):R!=null&&p.removeAttribute("value"),j==null&&q!=null&&(p.defaultChecked=!!q),j!=null&&(p.checked=j&&typeof j!="function"&&typeof j!="symbol"),Pe!=null&&typeof Pe!="function"&&typeof Pe!="symbol"&&typeof Pe!="boolean"?p.name=""+Ka(Pe):p.removeAttribute("name")}function Ob(p,g,_,R,j,q,he,Pe){if(q!=null&&typeof q!="function"&&typeof q!="symbol"&&typeof q!="boolean"&&(p.type=q),g!=null||_!=null){if(!(q!=="submit"&&q!=="reset"||g!=null))return;_=_!=null?""+Ka(_):"",g=g!=null?""+Ka(g):_,Pe||g===p.value||(p.value=g),p.defaultValue=g}R=R??j,R=typeof R!="function"&&typeof R!="symbol"&&!!R,p.checked=Pe?p.checked:!!R,p.defaultChecked=!!R,he!=null&&typeof he!="function"&&typeof he!="symbol"&&typeof he!="boolean"&&(p.name=he)}function Ef(p,g,_){g==="number"&&lc(p.ownerDocument)===p||p.defaultValue===""+_||(p.defaultValue=""+_)}function Zu(p,g,_,R){if(p=p.options,g){g={};for(var j=0;j<_.length;j++)g["$"+_[j]]=!0;for(_=0;_<p.length;_++)j=g.hasOwnProperty("$"+p[_].value),p[_].selected!==j&&(p[_].selected=j),j&&R&&(p[_].defaultSelected=!0)}else{for(_=""+Ka(_),g=null,j=0;j<p.length;j++){if(p[j].value===_){p[j].selected=!0,R&&(p[j].defaultSelected=!0);return}g!==null||p[j].disabled||(g=p[j])}g!==null&&(g.selected=!0)}}function Tf(p,g,_){if(g!=null&&(g=""+Ka(g),g!==p.value&&(p.value=g),_==null)){p.defaultValue!==g&&(p.defaultValue=g);return}p.defaultValue=_!=null?""+Ka(_):""}function Db(p,g,_,R){if(g==null){if(R!=null){if(_!=null)throw Error(r(92));if(K(R)){if(1<R.length)throw Error(r(93));R=R[0]}_=R}_==null&&(_=""),g=_}_=Ka(g),p.defaultValue=_,R=p.textContent,R===_&&R!==""&&R!==null&&(p.value=R)}function Af(p,g){if(g){var _=p.firstChild;if(_&&_===p.lastChild&&_.nodeType===3){_.nodeValue=g;return}}p.textContent=g}var Kr=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" "));function hg(p,g,_){var R=g.indexOf("--")===0;_==null||typeof _=="boolean"||_===""?R?p.setProperty(g,""):g==="float"?p.cssFloat="":p[g]="":R?p.setProperty(g,_):typeof _!="number"||_===0||Kr.has(g)?g==="float"?p.cssFloat=_:p[g]=(""+_).trim():p[g]=_+"px"}function C_(p,g,_){if(g!=null&&typeof g!="object")throw Error(r(62));if(p=p.style,_!=null){for(var R in _)!_.hasOwnProperty(R)||g!=null&&g.hasOwnProperty(R)||(R.indexOf("--")===0?p.setProperty(R,""):R==="float"?p.cssFloat="":p[R]="");for(var j in g)R=g[j],g.hasOwnProperty(j)&&_[j]!==R&&hg(p,j,R)}else for(var q in g)g.hasOwnProperty(q)&&hg(p,q,g[q])}function Fb(p){if(p.indexOf("-")===-1)return!1;switch(p){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Ya=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),Rf=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i;function Xu(p){return Rf.test(""+p)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":p}var _l=null;function pg(p){return p=p.target||p.srcElement||window,p.correspondingUseElement&&(p=p.correspondingUseElement),p.nodeType===3?p.parentNode:p}var Ju=null,Ls=null;function Zo(p){var g=Mr(p);if(g&&(p=g.stateNode)){var _=p[De]||null;e:switch(p=g.stateNode,g.type){case"input":if(kf(p,_.value,_.defaultValue,_.defaultValue,_.checked,_.defaultChecked,_.type,_.name),g=_.name,_.type==="radio"&&g!=null){for(_=p;_.parentNode;)_=_.parentNode;for(_=_.querySelectorAll('input[name="'+Ea(""+g)+'"][type="radio"]'),g=0;g<_.length;g++){var R=_[g];if(R!==p&&R.form===p.form){var j=R[De]||null;if(!j)throw Error(r(90));kf(R,j.value,j.defaultValue,j.defaultValue,j.checked,j.defaultChecked,j.type,j.name)}}for(g=0;g<_.length;g++)R=_[g],R.form===p.form&&Cf(R)}break e;case"textarea":Tf(p,_.value,_.defaultValue);break e;case"select":g=_.value,g!=null&&Zu(p,!!_.multiple,g,!1)}}}var Qu=!1;function Nf(p,g,_){if(Qu)return p(g,_);Qu=!0;try{var R=p(g);return R}finally{if(Qu=!1,(Ju!==null||Ls!==null)&&(fS(),Ju&&(g=Ju,p=Ls,Ls=Ju=null,Zo(g),p)))for(g=0;g<p.length;g++)Zo(p[g])}}function ed(p,g){var _=p.stateNode;if(_===null)return null;var R=_[De]||null;if(R===null)return null;_=R[g];e:switch(g){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(R=!R.disabled)||(p=p.type,R=!(p==="button"||p==="input"||p==="select"||p==="textarea")),p=!R;break e;default:p=!1}if(p)return null;if(_&&typeof _!="function")throw Error(r(231,g,typeof _));return _}var Zi=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Lb=!1;if(Zi)try{var Ta={};Object.defineProperty(Ta,"passive",{get:function(){Lb=!0}}),window.addEventListener("test",Ta,Ta),window.removeEventListener("test",Ta,Ta)}catch{Lb=!1}var Sl=null,mg=null,Mf=null;function If(){if(Mf)return Mf;var p,g=mg,_=g.length,R,j="value"in Sl?Sl.value:Sl.textContent,q=j.length;for(p=0;p<_&&g[p]===j[p];p++);var he=_-p;for(R=1;R<=he&&g[_-R]===j[q-R];R++);return Mf=j.slice(p,1<R?1-R:void 0)}function jf(p){var g=p.keyCode;return"charCode"in p?(p=p.charCode,p===0&&g===13&&(p=13)):p=g,p===10&&(p=13),32<=p||p===13?p:0}function vp(){return!0}function k_(){return!1}function Si(p){function g(_,R,j,q,he){this._reactName=_,this._targetInst=j,this.type=R,this.nativeEvent=q,this.target=he,this.currentTarget=null;for(var Pe in p)p.hasOwnProperty(Pe)&&(_=p[Pe],this[Pe]=_?_(q):q[Pe]);return this.isDefaultPrevented=(q.defaultPrevented!=null?q.defaultPrevented:q.returnValue===!1)?vp:k_,this.isPropagationStopped=k_,this}return u(g.prototype,{preventDefault:function(){this.defaultPrevented=!0;var _=this.nativeEvent;_&&(_.preventDefault?_.preventDefault():typeof _.returnValue!="unknown"&&(_.returnValue=!1),this.isDefaultPrevented=vp)},stopPropagation:function(){var _=this.nativeEvent;_&&(_.stopPropagation?_.stopPropagation():typeof _.cancelBubble!="unknown"&&(_.cancelBubble=!0),this.isPropagationStopped=vp)},persist:function(){},isPersistent:vp}),g}var td={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(p){return p.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},gg=Si(td),Yc=u({},td,{view:0,detail:0}),yg=Si(Yc),xp,Bb,wp,bg=u({},Yc,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nd,button:0,buttons:0,relatedTarget:function(p){return p.relatedTarget===void 0?p.fromElement===p.srcElement?p.toElement:p.fromElement:p.relatedTarget},movementX:function(p){return"movementX"in p?p.movementX:(p!==wp&&(wp&&p.type==="mousemove"?(xp=p.screenX-wp.screenX,Bb=p.screenY-wp.screenY):Bb=xp=0,wp=p),xp)},movementY:function(p){return"movementY"in p?p.movementY:Bb}}),vg=Si(bg),$b=u({},bg,{dataTransfer:0}),E_=Si($b),xg=u({},Yc,{relatedTarget:0}),Pf=Si(xg),wg=u({},td,{animationName:0,elapsedTime:0,pseudoElement:0}),T_=Si(wg),RA=u({},td,{clipboardData:function(p){return"clipboardData"in p?p.clipboardData:window.clipboardData}}),_g=Si(RA),zb=u({},td,{data:0}),Sg=Si(zb),Ub={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},qb={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Xi={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function _p(p){var g=this.nativeEvent;return g.getModifierState?g.getModifierState(p):(p=Xi[p])?!!g[p]:!1}function nd(){return _p}var A_=u({},Yc,{key:function(p){if(p.key){var g=Ub[p.key]||p.key;if(g!=="Unidentified")return g}return p.type==="keypress"?(p=jf(p),p===13?"Enter":String.fromCharCode(p)):p.type==="keydown"||p.type==="keyup"?qb[p.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nd,charCode:function(p){return p.type==="keypress"?jf(p):0},keyCode:function(p){return p.type==="keydown"||p.type==="keyup"?p.keyCode:0},which:function(p){return p.type==="keypress"?jf(p):p.type==="keydown"||p.type==="keyup"?p.keyCode:0}}),Cg=Si(A_),R_=u({},bg,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Vb=Si(R_),kg=u({},Yc,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nd}),Wb=Si(kg),rd=u({},td,{propertyName:0,elapsedTime:0,pseudoElement:0}),Hb=Si(rd),Gb=u({},bg,{deltaX:function(p){return"deltaX"in p?p.deltaX:"wheelDeltaX"in p?-p.wheelDeltaX:0},deltaY:function(p){return"deltaY"in p?p.deltaY:"wheelDeltaY"in p?-p.wheelDeltaY:"wheelDelta"in p?-p.wheelDelta:0},deltaZ:0,deltaMode:0}),Eg=Si(Gb),Kb=u({},td,{newState:0,oldState:0}),N_=Si(Kb),NA=[9,13,27,32],Sp=Zi&&"CompositionEvent"in window,Zc=null;Zi&&"documentMode"in document&&(Zc=document.documentMode);var MA=Zi&&"TextEvent"in window&&!Zc,Tg=Zi&&(!Sp||Zc&&8<Zc&&11>=Zc),Ag=" ",M_=!1;function Yb(p,g){switch(p){case"keyup":return NA.indexOf(g.keyCode)!==-1;case"keydown":return g.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function I_(p){return p=p.detail,typeof p=="object"&&"data"in p?p.data:null}var sd=!1;function j_(p,g){switch(p){case"compositionend":return I_(g);case"keypress":return g.which!==32?null:(M_=!0,Ag);case"textInput":return p=g.data,p===Ag&&M_?null:p;default:return null}}function IA(p,g){if(sd)return p==="compositionend"||!Sp&&Yb(p,g)?(p=If(),Mf=mg=Sl=null,sd=!1,p):null;switch(p){case"paste":return null;case"keypress":if(!(g.ctrlKey||g.altKey||g.metaKey)||g.ctrlKey&&g.altKey){if(g.char&&1<g.char.length)return g.char;if(g.which)return String.fromCharCode(g.which)}return null;case"compositionend":return Tg&&g.locale!=="ko"?null:g.data;default:return null}}var P_={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rg(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g==="input"?!!P_[p.type]:g==="textarea"}function Zb(p,g,_,R){Ju?Ls?Ls.push(R):Ls=[R]:Ju=R,g=bS(g,"onChange"),0<g.length&&(_=new gg("onChange","change",null,_,R),p.push({event:_,listeners:g}))}var Of=null,Cp=null;function jA(p){jL(p,0)}function Ng(p){var g=rs(p);if(Cf(g))return p}function kp(p,g){if(p==="change")return g}var Cl=!1;if(Zi){var Bs;if(Zi){var Df="oninput"in document;if(!Df){var Za=document.createElement("div");Za.setAttribute("oninput","return;"),Df=typeof Za.oninput=="function"}Bs=Df}else Bs=!1;Cl=Bs&&(!document.documentMode||9<document.documentMode)}function O_(){Of&&(Of.detachEvent("onpropertychange",Mg),Cp=Of=null)}function Mg(p){if(p.propertyName==="value"&&Ng(Cp)){var g=[];Zb(g,Cp,p,pg(p)),Nf(jA,g)}}function D_(p,g,_){p==="focusin"?(O_(),Of=g,Cp=_,Of.attachEvent("onpropertychange",Mg)):p==="focusout"&&O_()}function id(p){if(p==="selectionchange"||p==="keyup"||p==="keydown")return Ng(Cp)}function Xb(p,g){if(p==="click")return Ng(g)}function Ff(p,g){if(p==="input"||p==="change")return Ng(g)}function Xc(p,g){return p===g&&(p!==0||1/p===1/g)||p!==p&&g!==g}var Aa=typeof Object.is=="function"?Object.is:Xc;function M(p,g){if(Aa(p,g))return!0;if(typeof p!="object"||p===null||typeof g!="object"||g===null)return!1;var _=Object.keys(p),R=Object.keys(g);if(_.length!==R.length)return!1;for(R=0;R<_.length;R++){var j=_[R];if(!We.call(g,j)||!Aa(p[j],g[j]))return!1}return!0}function z(p){for(;p&&p.firstChild;)p=p.firstChild;return p}function ne(p,g){var _=z(p);p=0;for(var R;_;){if(_.nodeType===3){if(R=p+_.textContent.length,p<=g&&R>=g)return{node:_,offset:g-p};p=R}e:{for(;_;){if(_.nextSibling){_=_.nextSibling;break e}_=_.parentNode}_=void 0}_=z(_)}}function ae(p,g){return p&&g?p===g?!0:p&&p.nodeType===3?!1:g&&g.nodeType===3?ae(p,g.parentNode):"contains"in p?p.contains(g):p.compareDocumentPosition?!!(p.compareDocumentPosition(g)&16):!1:!1}function me(p){p=p!=null&&p.ownerDocument!=null&&p.ownerDocument.defaultView!=null?p.ownerDocument.defaultView:window;for(var g=lc(p.document);g instanceof p.HTMLIFrameElement;){try{var _=typeof g.contentWindow.location.href=="string"}catch{_=!1}if(_)p=g.contentWindow;else break;g=lc(p.document)}return g}function Ne(p){var g=p&&p.nodeName&&p.nodeName.toLowerCase();return g&&(g==="input"&&(p.type==="text"||p.type==="search"||p.type==="tel"||p.type==="url"||p.type==="password")||g==="textarea"||p.contentEditable==="true")}var Le=Zi&&"documentMode"in document&&11>=document.documentMode,Ge=null,st=null,at=null,pt=!1;function Je(p,g,_){var R=_.window===_?_.document:_.nodeType===9?_:_.ownerDocument;pt||Ge==null||Ge!==lc(R)||(R=Ge,"selectionStart"in R&&Ne(R)?R={start:R.selectionStart,end:R.selectionEnd}:(R=(R.ownerDocument&&R.ownerDocument.defaultView||window).getSelection(),R={anchorNode:R.anchorNode,anchorOffset:R.anchorOffset,focusNode:R.focusNode,focusOffset:R.focusOffset}),at&&M(at,R)||(at=R,R=bS(st,"onSelect"),0<R.length&&(g=new gg("onSelect","select",null,g,_),p.push({event:g,listeners:R}),g.target=Ge)))}function gt(p,g){var _={};return _[p.toLowerCase()]=g.toLowerCase(),_["Webkit"+p]="webkit"+g,_["Moz"+p]="moz"+g,_}var rt={animationend:gt("Animation","AnimationEnd"),animationiteration:gt("Animation","AnimationIteration"),animationstart:gt("Animation","AnimationStart"),transitionrun:gt("Transition","TransitionRun"),transitionstart:gt("Transition","TransitionStart"),transitioncancel:gt("Transition","TransitionCancel"),transitionend:gt("Transition","TransitionEnd")},ht={},yt={};Zi&&(yt=document.createElement("div").style,"AnimationEvent"in window||(delete rt.animationend.animation,delete rt.animationiteration.animation,delete rt.animationstart.animation),"TransitionEvent"in window||delete rt.transitionend.transition);function ot(p){if(ht[p])return ht[p];if(!rt[p])return p;var g=rt[p],_;for(_ in g)if(g.hasOwnProperty(_)&&_ in yt)return ht[p]=g[_];return p}var kt=ot("animationend"),Nt=ot("animationiteration"),Mt=ot("animationstart"),Ot=ot("transitionrun"),Xt=ot("transitionstart"),rn=ot("transitioncancel"),Gt=ot("transitionend"),en=new Map,on="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");on.push("scrollEnd");function Kt(p,g){en.set(p,g),Vt(g,[p])}var bn=new WeakMap;function zn(p,g){if(typeof p=="object"&&p!==null){var _=bn.get(p);return _!==void 0?_:(g={value:p,source:g,stack:Ib(g)},bn.set(p,g),g)}return{value:p,source:g,stack:Ib(g)}}var Hn=[],mr=0,ma=0;function ar(){for(var p=mr,g=ma=mr=0;g<p;){var _=Hn[g];Hn[g++]=null;var R=Hn[g];Hn[g++]=null;var j=Hn[g];Hn[g++]=null;var q=Hn[g];if(Hn[g++]=null,R!==null&&j!==null){var he=R.pending;he===null?j.next=j:(j.next=he.next,he.next=j),R.pending=j}q!==0&&Ji(_,j,q)}}function fi(p,g,_,R){Hn[mr++]=p,Hn[mr++]=g,Hn[mr++]=_,Hn[mr++]=R,ma|=R,p.lanes|=R,p=p.alternate,p!==null&&(p.lanes|=R)}function Ci(p,g,_,R){return fi(p,g,_,R),kl(p)}function cc(p,g){return fi(p,null,null,g),kl(p)}function Ji(p,g,_){p.lanes|=_;var R=p.alternate;R!==null&&(R.lanes|=_);for(var j=!1,q=p.return;q!==null;)q.childLanes|=_,R=q.alternate,R!==null&&(R.childLanes|=_),q.tag===22&&(p=q.stateNode,p===null||p._visibility&1||(j=!0)),p=q,q=q.return;return p.tag===3?(q=p.stateNode,j&&g!==null&&(j=31-Ht(_),p=q.hiddenUpdates,R=p[j],R===null?p[j]=[g]:R.push(g),g.lane=_|536870912),q):null}function kl(p){if(50<_v)throw _v=0,BR=null,Error(r(185));for(var g=p.return;g!==null;)p=g,g=p.return;return p.tag===3?p.stateNode:null}var Jc={};function Yde(p,g,_,R){this.tag=p,this.key=_,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=g,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=R,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Xo(p,g,_,R){return new Yde(p,g,_,R)}function PA(p){return p=p.prototype,!(!p||!p.isReactComponent)}function ad(p,g){var _=p.alternate;return _===null?(_=Xo(p.tag,g,p.key,p.mode),_.elementType=p.elementType,_.type=p.type,_.stateNode=p.stateNode,_.alternate=p,p.alternate=_):(_.pendingProps=g,_.type=p.type,_.flags=0,_.subtreeFlags=0,_.deletions=null),_.flags=p.flags&65011712,_.childLanes=p.childLanes,_.lanes=p.lanes,_.child=p.child,_.memoizedProps=p.memoizedProps,_.memoizedState=p.memoizedState,_.updateQueue=p.updateQueue,g=p.dependencies,_.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext},_.sibling=p.sibling,_.index=p.index,_.ref=p.ref,_.refCleanup=p.refCleanup,_}function b5(p,g){p.flags&=65011714;var _=p.alternate;return _===null?(p.childLanes=0,p.lanes=g,p.child=null,p.subtreeFlags=0,p.memoizedProps=null,p.memoizedState=null,p.updateQueue=null,p.dependencies=null,p.stateNode=null):(p.childLanes=_.childLanes,p.lanes=_.lanes,p.child=_.child,p.subtreeFlags=0,p.deletions=null,p.memoizedProps=_.memoizedProps,p.memoizedState=_.memoizedState,p.updateQueue=_.updateQueue,p.type=_.type,g=_.dependencies,p.dependencies=g===null?null:{lanes:g.lanes,firstContext:g.firstContext}),p}function F_(p,g,_,R,j,q){var he=0;if(R=p,typeof p=="function")PA(p)&&(he=1);else if(typeof p=="string")he=Xfe(p,_,pe.current)?26:p==="html"||p==="head"||p==="body"?27:5;else e:switch(p){case I:return p=Xo(31,_,g,j),p.elementType=I,p.lanes=q,p;case y:return Ep(_.children,j,q,g);case b:he=8,j|=24;break;case v:return p=Xo(12,_,g,j|2),p.elementType=v,p.lanes=q,p;case C:return p=Xo(13,_,g,j),p.elementType=C,p.lanes=q,p;case T:return p=Xo(19,_,g,j),p.elementType=T,p.lanes=q,p;default:if(typeof p=="object"&&p!==null)switch(p.$$typeof){case x:case S:he=10;break e;case w:he=9;break e;case k:he=11;break e;case A:he=14;break e;case N:he=16,R=null;break e}he=29,_=Error(r(130,p===null?"null":typeof p,"")),R=null}return g=Xo(he,_,g,j),g.elementType=p,g.type=R,g.lanes=q,g}function Ep(p,g,_,R){return p=Xo(7,p,R,g),p.lanes=_,p}function OA(p,g,_){return p=Xo(6,p,null,g),p.lanes=_,p}function DA(p,g,_){return g=Xo(4,p.children!==null?p.children:[],p.key,g),g.lanes=_,g.stateNode={containerInfo:p.containerInfo,pendingChildren:null,implementation:p.implementation},g}var Ig=[],jg=0,L_=null,B_=0,El=[],Tl=0,Tp=null,od=1,ld="";function Ap(p,g){Ig[jg++]=B_,Ig[jg++]=L_,L_=p,B_=g}function v5(p,g,_){El[Tl++]=od,El[Tl++]=ld,El[Tl++]=Tp,Tp=p;var R=od;p=ld;var j=32-Ht(R)-1;R&=~(1<<j),_+=1;var q=32-Ht(g)+j;if(30<q){var he=j-j%5;q=(R&(1<<he)-1).toString(32),R>>=he,j-=he,od=1<<32-Ht(g)+j|_<<j|R,ld=q+p}else od=1<<q|_<<j|R,ld=p}function FA(p){p.return!==null&&(Ap(p,1),v5(p,1,0))}function LA(p){for(;p===L_;)L_=Ig[--jg],Ig[jg]=null,B_=Ig[--jg],Ig[jg]=null;for(;p===Tp;)Tp=El[--Tl],El[Tl]=null,ld=El[--Tl],El[Tl]=null,od=El[--Tl],El[Tl]=null}var Xa=null,ai=null,is=!1,Rp=null,Qc=!1,BA=Error(r(519));function Np(p){var g=Error(r(418,""));throw ev(zn(g,p)),BA}function x5(p){var g=p.stateNode,_=p.type,R=p.memoizedProps;switch(g[xe]=p,g[De]=R,_){case"dialog":Br("cancel",g),Br("close",g);break;case"iframe":case"object":case"embed":Br("load",g);break;case"video":case"audio":for(_=0;_<Cv.length;_++)Br(Cv[_],g);break;case"source":Br("error",g);break;case"img":case"image":case"link":Br("error",g),Br("load",g);break;case"details":Br("toggle",g);break;case"input":Br("invalid",g),Ob(g,R.value,R.defaultValue,R.checked,R.defaultChecked,R.type,R.name,!0),Kc(g);break;case"select":Br("invalid",g);break;case"textarea":Br("invalid",g),Db(g,R.value,R.defaultValue,R.children),Kc(g)}_=R.children,typeof _!="string"&&typeof _!="number"&&typeof _!="bigint"||g.textContent===""+_||R.suppressHydrationWarning===!0||FL(g.textContent,_)?(R.popover!=null&&(Br("beforetoggle",g),Br("toggle",g)),R.onScroll!=null&&Br("scroll",g),R.onScrollEnd!=null&&Br("scrollend",g),R.onClick!=null&&(g.onclick=vS),g=!0):g=!1,g||Np(p)}function w5(p){for(Xa=p.return;Xa;)switch(Xa.tag){case 5:case 13:Qc=!1;return;case 27:case 3:Qc=!0;return;default:Xa=Xa.return}}function Jb(p){if(p!==Xa)return!1;if(!is)return w5(p),is=!0,!1;var g=p.tag,_;if((_=g!==3&&g!==27)&&((_=g===5)&&(_=p.type,_=!(_!=="form"&&_!=="button")||tN(p.type,p.memoizedProps)),_=!_),_&&ai&&Np(p),w5(p),g===13){if(p=p.memoizedState,p=p!==null?p.dehydrated:null,!p)throw Error(r(317));e:{for(p=p.nextSibling,g=0;p;){if(p.nodeType===8)if(_=p.data,_==="/$"){if(g===0){ai=dc(p.nextSibling);break e}g--}else _!=="$"&&_!=="$!"&&_!=="$?"||g++;p=p.nextSibling}ai=null}}else g===27?(g=ai,Qf(p.type)?(p=iN,iN=null,ai=p):ai=g):ai=Xa?dc(p.stateNode.nextSibling):null;return!0}function Qb(){ai=Xa=null,is=!1}function _5(){var p=Rp;return p!==null&&(_o===null?_o=p:_o.push.apply(_o,p),Rp=null),p}function ev(p){Rp===null?Rp=[p]:Rp.push(p)}var $A=Q(null),Mp=null,cd=null;function Lf(p,g,_){re($A,g._currentValue),g._currentValue=_}function ud(p){p._currentValue=$A.current,ee($A)}function zA(p,g,_){for(;p!==null;){var R=p.alternate;if((p.childLanes&g)!==g?(p.childLanes|=g,R!==null&&(R.childLanes|=g)):R!==null&&(R.childLanes&g)!==g&&(R.childLanes|=g),p===_)break;p=p.return}}function UA(p,g,_,R){var j=p.child;for(j!==null&&(j.return=p);j!==null;){var q=j.dependencies;if(q!==null){var he=j.child;q=q.firstContext;e:for(;q!==null;){var Pe=q;q=j;for(var Ye=0;Ye<g.length;Ye++)if(Pe.context===g[Ye]){q.lanes|=_,Pe=q.alternate,Pe!==null&&(Pe.lanes|=_),zA(q.return,_,p),R||(he=null);break e}q=Pe.next}}else if(j.tag===18){if(he=j.return,he===null)throw Error(r(341));he.lanes|=_,q=he.alternate,q!==null&&(q.lanes|=_),zA(he,_,p),he=null}else he=j.child;if(he!==null)he.return=j;else for(he=j;he!==null;){if(he===p){he=null;break}if(j=he.sibling,j!==null){j.return=he.return,he=j;break}he=he.return}j=he}}function tv(p,g,_,R){p=null;for(var j=g,q=!1;j!==null;){if(!q){if((j.flags&524288)!==0)q=!0;else if((j.flags&262144)!==0)break}if(j.tag===10){var he=j.alternate;if(he===null)throw Error(r(387));if(he=he.memoizedProps,he!==null){var Pe=j.type;Aa(j.pendingProps.value,he.value)||(p!==null?p.push(Pe):p=[Pe])}}else if(j===Fe.current){if(he=j.alternate,he===null)throw Error(r(387));he.memoizedState.memoizedState!==j.memoizedState.memoizedState&&(p!==null?p.push(Nv):p=[Nv])}j=j.return}p!==null&&UA(g,p,_,R),g.flags|=262144}function $_(p){for(p=p.firstContext;p!==null;){if(!Aa(p.context._currentValue,p.memoizedValue))return!0;p=p.next}return!1}function Ip(p){Mp=p,cd=null,p=p.dependencies,p!==null&&(p.firstContext=null)}function Ra(p){return S5(Mp,p)}function z_(p,g){return Mp===null&&Ip(p),S5(p,g)}function S5(p,g){var _=g._currentValue;if(g={context:g,memoizedValue:_,next:null},cd===null){if(p===null)throw Error(r(308));cd=g,p.dependencies={lanes:0,firstContext:g},p.flags|=524288}else cd=cd.next=g;return _}var Zde=typeof AbortController<"u"?AbortController:function(){var p=[],g=this.signal={aborted:!1,addEventListener:function(_,R){p.push(R)}};this.abort=function(){g.aborted=!0,p.forEach(function(_){return _()})}},Xde=e.unstable_scheduleCallback,Jde=e.unstable_NormalPriority,Fi={$$typeof:S,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0};function qA(){return{controller:new Zde,data:new Map,refCount:0}}function nv(p){p.refCount--,p.refCount===0&&Xde(Jde,function(){p.controller.abort()})}var rv=null,VA=0,Pg=0,Og=null;function Qde(p,g){if(rv===null){var _=rv=[];VA=0,Pg=HR(),Og={status:"pending",value:void 0,then:function(R){_.push(R)}}}return VA++,g.then(C5,C5),g}function C5(){if(--VA===0&&rv!==null){Og!==null&&(Og.status="fulfilled");var p=rv;rv=null,Pg=0,Og=null;for(var g=0;g<p.length;g++)(0,p[g])()}}function efe(p,g){var _=[],R={status:"pending",value:null,reason:null,then:function(j){_.push(j)}};return p.then(function(){R.status="fulfilled",R.value=g;for(var j=0;j<_.length;j++)(0,_[j])(g)},function(j){for(R.status="rejected",R.reason=j,j=0;j<_.length;j++)(0,_[j])(void 0)}),R}var k5=U.S;U.S=function(p,g){typeof g=="object"&&g!==null&&typeof g.then=="function"&&Qde(p,g),k5!==null&&k5(p,g)};var jp=Q(null);function WA(){var p=jp.current;return p!==null?p:Os.pooledCache}function U_(p,g){g===null?re(jp,jp.current):re(jp,g.pool)}function E5(){var p=WA();return p===null?null:{parent:Fi._currentValue,pool:p}}var sv=Error(r(460)),T5=Error(r(474)),q_=Error(r(542)),HA={then:function(){}};function A5(p){return p=p.status,p==="fulfilled"||p==="rejected"}function V_(){}function R5(p,g,_){switch(_=p[_],_===void 0?p.push(g):_!==g&&(g.then(V_,V_),g=_),g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,M5(p),p;default:if(typeof g.status=="string")g.then(V_,V_);else{if(p=Os,p!==null&&100<p.shellSuspendCounter)throw Error(r(482));p=g,p.status="pending",p.then(function(R){if(g.status==="pending"){var j=g;j.status="fulfilled",j.value=R}},function(R){if(g.status==="pending"){var j=g;j.status="rejected",j.reason=R}})}switch(g.status){case"fulfilled":return g.value;case"rejected":throw p=g.reason,M5(p),p}throw iv=g,sv}}var iv=null;function N5(){if(iv===null)throw Error(r(459));var p=iv;return iv=null,p}function M5(p){if(p===sv||p===q_)throw Error(r(483))}var Bf=!1;function GA(p){p.updateQueue={baseState:p.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function KA(p,g){p=p.updateQueue,g.updateQueue===p&&(g.updateQueue={baseState:p.baseState,firstBaseUpdate:p.firstBaseUpdate,lastBaseUpdate:p.lastBaseUpdate,shared:p.shared,callbacks:null})}function $f(p){return{lane:p,tag:0,payload:null,callback:null,next:null}}function zf(p,g,_){var R=p.updateQueue;if(R===null)return null;if(R=R.shared,(ys&2)!==0){var j=R.pending;return j===null?g.next=g:(g.next=j.next,j.next=g),R.pending=g,g=kl(p),Ji(p,null,_),g}return fi(p,R,g,_),kl(p)}function av(p,g,_){if(g=g.updateQueue,g!==null&&(g=g.shared,(_&4194048)!==0)){var R=g.lanes;R&=p.pendingLanes,_|=R,g.lanes=_,ze(p,_)}}function YA(p,g){var _=p.updateQueue,R=p.alternate;if(R!==null&&(R=R.updateQueue,_===R)){var j=null,q=null;if(_=_.firstBaseUpdate,_!==null){do{var he={lane:_.lane,tag:_.tag,payload:_.payload,callback:null,next:null};q===null?j=q=he:q=q.next=he,_=_.next}while(_!==null);q===null?j=q=g:q=q.next=g}else j=q=g;_={baseState:R.baseState,firstBaseUpdate:j,lastBaseUpdate:q,shared:R.shared,callbacks:R.callbacks},p.updateQueue=_;return}p=_.lastBaseUpdate,p===null?_.firstBaseUpdate=g:p.next=g,_.lastBaseUpdate=g}var ZA=!1;function ov(){if(ZA){var p=Og;if(p!==null)throw p}}function lv(p,g,_,R){ZA=!1;var j=p.updateQueue;Bf=!1;var q=j.firstBaseUpdate,he=j.lastBaseUpdate,Pe=j.shared.pending;if(Pe!==null){j.shared.pending=null;var Ye=Pe,St=Ye.next;Ye.next=null,he===null?q=St:he.next=St,he=Ye;var Dt=p.alternate;Dt!==null&&(Dt=Dt.updateQueue,Pe=Dt.lastBaseUpdate,Pe!==he&&(Pe===null?Dt.firstBaseUpdate=St:Pe.next=St,Dt.lastBaseUpdate=Ye))}if(q!==null){var Bt=j.baseState;he=0,Dt=St=Ye=null,Pe=q;do{var Et=Pe.lane&-536870913,Rt=Et!==Pe.lane;if(Rt?(Yr&Et)===Et:(R&Et)===Et){Et!==0&&Et===Pg&&(ZA=!0),Dt!==null&&(Dt=Dt.next={lane:0,tag:Pe.tag,payload:Pe.payload,callback:null,next:null});e:{var or=p,Gn=Pe;Et=g;var Cs=_;switch(Gn.tag){case 1:if(or=Gn.payload,typeof or=="function"){Bt=or.call(Cs,Bt,Et);break e}Bt=or;break e;case 3:or.flags=or.flags&-65537|128;case 0:if(or=Gn.payload,Et=typeof or=="function"?or.call(Cs,Bt,Et):or,Et==null)break e;Bt=u({},Bt,Et);break e;case 2:Bf=!0}}Et=Pe.callback,Et!==null&&(p.flags|=64,Rt&&(p.flags|=8192),Rt=j.callbacks,Rt===null?j.callbacks=[Et]:Rt.push(Et))}else Rt={lane:Et,tag:Pe.tag,payload:Pe.payload,callback:Pe.callback,next:null},Dt===null?(St=Dt=Rt,Ye=Bt):Dt=Dt.next=Rt,he|=Et;if(Pe=Pe.next,Pe===null){if(Pe=j.shared.pending,Pe===null)break;Rt=Pe,Pe=Rt.next,Rt.next=null,j.lastBaseUpdate=Rt,j.shared.pending=null}}while(!0);Dt===null&&(Ye=Bt),j.baseState=Ye,j.firstBaseUpdate=St,j.lastBaseUpdate=Dt,q===null&&(j.shared.lanes=0),Yf|=he,p.lanes=he,p.memoizedState=Bt}}function I5(p,g){if(typeof p!="function")throw Error(r(191,p));p.call(g)}function j5(p,g){var _=p.callbacks;if(_!==null)for(p.callbacks=null,p=0;p<_.length;p++)I5(_[p],g)}var Dg=Q(null),W_=Q(0);function P5(p,g){p=yd,re(W_,p),re(Dg,g),yd=p|g.baseLanes}function XA(){re(W_,yd),re(Dg,Dg.current)}function JA(){yd=W_.current,ee(Dg),ee(W_)}var Uf=0,jr=null,_s=null,ki=null,H_=!1,Fg=!1,Pp=!1,G_=0,cv=0,Lg=null,tfe=0;function hi(){throw Error(r(321))}function QA(p,g){if(g===null)return!1;for(var _=0;_<g.length&&_<p.length;_++)if(!Aa(p[_],g[_]))return!1;return!0}function eR(p,g,_,R,j,q){return Uf=q,jr=g,g.memoizedState=null,g.updateQueue=null,g.lanes=0,U.H=p===null||p.memoizedState===null?y8:b8,Pp=!1,q=_(R,j),Pp=!1,Fg&&(q=D5(g,_,R,j)),O5(p),q}function O5(p){U.H=Q_;var g=_s!==null&&_s.next!==null;if(Uf=0,ki=_s=jr=null,H_=!1,cv=0,Lg=null,g)throw Error(r(300));p===null||Qi||(p=p.dependencies,p!==null&&$_(p)&&(Qi=!0))}function D5(p,g,_,R){jr=p;var j=0;do{if(Fg&&(Lg=null),cv=0,Fg=!1,25<=j)throw Error(r(301));if(j+=1,ki=_s=null,p.updateQueue!=null){var q=p.updateQueue;q.lastEffect=null,q.events=null,q.stores=null,q.memoCache!=null&&(q.memoCache.index=0)}U.H=lfe,q=g(_,R)}while(Fg);return q}function nfe(){var p=U.H,g=p.useState()[0];return g=typeof g.then=="function"?uv(g):g,p=p.useState()[0],(_s!==null?_s.memoizedState:null)!==p&&(jr.flags|=1024),g}function tR(){var p=G_!==0;return G_=0,p}function nR(p,g,_){g.updateQueue=p.updateQueue,g.flags&=-2053,p.lanes&=~_}function rR(p){if(H_){for(p=p.memoizedState;p!==null;){var g=p.queue;g!==null&&(g.pending=null),p=p.next}H_=!1}Uf=0,ki=_s=jr=null,Fg=!1,cv=G_=0,Lg=null}function xo(){var p={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ki===null?jr.memoizedState=ki=p:ki=ki.next=p,ki}function Ei(){if(_s===null){var p=jr.alternate;p=p!==null?p.memoizedState:null}else p=_s.next;var g=ki===null?jr.memoizedState:ki.next;if(g!==null)ki=g,_s=p;else{if(p===null)throw jr.alternate===null?Error(r(467)):Error(r(310));_s=p,p={memoizedState:_s.memoizedState,baseState:_s.baseState,baseQueue:_s.baseQueue,queue:_s.queue,next:null},ki===null?jr.memoizedState=ki=p:ki=ki.next=p}return ki}function sR(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function uv(p){var g=cv;return cv+=1,Lg===null&&(Lg=[]),p=R5(Lg,p,g),g=jr,(ki===null?g.memoizedState:ki.next)===null&&(g=g.alternate,U.H=g===null||g.memoizedState===null?y8:b8),p}function K_(p){if(p!==null&&typeof p=="object"){if(typeof p.then=="function")return uv(p);if(p.$$typeof===S)return Ra(p)}throw Error(r(438,String(p)))}function iR(p){var g=null,_=jr.updateQueue;if(_!==null&&(g=_.memoCache),g==null){var R=jr.alternate;R!==null&&(R=R.updateQueue,R!==null&&(R=R.memoCache,R!=null&&(g={data:R.data.map(function(j){return j.slice()}),index:0})))}if(g==null&&(g={data:[],index:0}),_===null&&(_=sR(),jr.updateQueue=_),_.memoCache=g,_=g.data[g.index],_===void 0)for(_=g.data[g.index]=Array(p),R=0;R<p;R++)_[R]=O;return g.index++,_}function dd(p,g){return typeof g=="function"?g(p):g}function Y_(p){var g=Ei();return aR(g,_s,p)}function aR(p,g,_){var R=p.queue;if(R===null)throw Error(r(311));R.lastRenderedReducer=_;var j=p.baseQueue,q=R.pending;if(q!==null){if(j!==null){var he=j.next;j.next=q.next,q.next=he}g.baseQueue=j=q,R.pending=null}if(q=p.baseState,j===null)p.memoizedState=q;else{g=j.next;var Pe=he=null,Ye=null,St=g,Dt=!1;do{var Bt=St.lane&-536870913;if(Bt!==St.lane?(Yr&Bt)===Bt:(Uf&Bt)===Bt){var Et=St.revertLane;if(Et===0)Ye!==null&&(Ye=Ye.next={lane:0,revertLane:0,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null}),Bt===Pg&&(Dt=!0);else if((Uf&Et)===Et){St=St.next,Et===Pg&&(Dt=!0);continue}else Bt={lane:0,revertLane:St.revertLane,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null},Ye===null?(Pe=Ye=Bt,he=q):Ye=Ye.next=Bt,jr.lanes|=Et,Yf|=Et;Bt=St.action,Pp&&_(q,Bt),q=St.hasEagerState?St.eagerState:_(q,Bt)}else Et={lane:Bt,revertLane:St.revertLane,action:St.action,hasEagerState:St.hasEagerState,eagerState:St.eagerState,next:null},Ye===null?(Pe=Ye=Et,he=q):Ye=Ye.next=Et,jr.lanes|=Bt,Yf|=Bt;St=St.next}while(St!==null&&St!==g);if(Ye===null?he=q:Ye.next=Pe,!Aa(q,p.memoizedState)&&(Qi=!0,Dt&&(_=Og,_!==null)))throw _;p.memoizedState=q,p.baseState=he,p.baseQueue=Ye,R.lastRenderedState=q}return j===null&&(R.lanes=0),[p.memoizedState,R.dispatch]}function oR(p){var g=Ei(),_=g.queue;if(_===null)throw Error(r(311));_.lastRenderedReducer=p;var R=_.dispatch,j=_.pending,q=g.memoizedState;if(j!==null){_.pending=null;var he=j=j.next;do q=p(q,he.action),he=he.next;while(he!==j);Aa(q,g.memoizedState)||(Qi=!0),g.memoizedState=q,g.baseQueue===null&&(g.baseState=q),_.lastRenderedState=q}return[q,R]}function F5(p,g,_){var R=jr,j=Ei(),q=is;if(q){if(_===void 0)throw Error(r(407));_=_()}else _=g();var he=!Aa((_s||j).memoizedState,_);he&&(j.memoizedState=_,Qi=!0),j=j.queue;var Pe=$5.bind(null,R,j,p);if(dv(2048,8,Pe,[p]),j.getSnapshot!==g||he||ki!==null&&ki.memoizedState.tag&1){if(R.flags|=2048,Bg(9,Z_(),B5.bind(null,R,j,_,g),null),Os===null)throw Error(r(349));q||(Uf&124)!==0||L5(R,g,_)}return _}function L5(p,g,_){p.flags|=16384,p={getSnapshot:g,value:_},g=jr.updateQueue,g===null?(g=sR(),jr.updateQueue=g,g.stores=[p]):(_=g.stores,_===null?g.stores=[p]:_.push(p))}function B5(p,g,_,R){g.value=_,g.getSnapshot=R,z5(g)&&U5(p)}function $5(p,g,_){return _(function(){z5(g)&&U5(p)})}function z5(p){var g=p.getSnapshot;p=p.value;try{var _=g();return!Aa(p,_)}catch{return!0}}function U5(p){var g=cc(p,2);g!==null&&nl(g,p,2)}function lR(p){var g=xo();if(typeof p=="function"){var _=p;if(p=_(),Pp){Ft(!0);try{_()}finally{Ft(!1)}}}return g.memoizedState=g.baseState=p,g.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:dd,lastRenderedState:p},g}function q5(p,g,_,R){return p.baseState=_,aR(p,_s,typeof R=="function"?R:dd)}function rfe(p,g,_,R,j){if(J_(p))throw Error(r(485));if(p=g.action,p!==null){var q={payload:j,action:p,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(he){q.listeners.push(he)}};U.T!==null?_(!0):q.isTransition=!1,R(q),_=g.pending,_===null?(q.next=g.pending=q,V5(g,q)):(q.next=_.next,g.pending=_.next=q)}}function V5(p,g){var _=g.action,R=g.payload,j=p.state;if(g.isTransition){var q=U.T,he={};U.T=he;try{var Pe=_(j,R),Ye=U.S;Ye!==null&&Ye(he,Pe),W5(p,g,Pe)}catch(St){cR(p,g,St)}finally{U.T=q}}else try{q=_(j,R),W5(p,g,q)}catch(St){cR(p,g,St)}}function W5(p,g,_){_!==null&&typeof _=="object"&&typeof _.then=="function"?_.then(function(R){H5(p,g,R)},function(R){return cR(p,g,R)}):H5(p,g,_)}function H5(p,g,_){g.status="fulfilled",g.value=_,G5(g),p.state=_,g=p.pending,g!==null&&(_=g.next,_===g?p.pending=null:(_=_.next,g.next=_,V5(p,_)))}function cR(p,g,_){var R=p.pending;if(p.pending=null,R!==null){R=R.next;do g.status="rejected",g.reason=_,G5(g),g=g.next;while(g!==R)}p.action=null}function G5(p){p=p.listeners;for(var g=0;g<p.length;g++)(0,p[g])()}function K5(p,g){return g}function Y5(p,g){if(is){var _=Os.formState;if(_!==null){e:{var R=jr;if(is){if(ai){t:{for(var j=ai,q=Qc;j.nodeType!==8;){if(!q){j=null;break t}if(j=dc(j.nextSibling),j===null){j=null;break t}}q=j.data,j=q==="F!"||q==="F"?j:null}if(j){ai=dc(j.nextSibling),R=j.data==="F!";break e}}Np(R)}R=!1}R&&(g=_[0])}}return _=xo(),_.memoizedState=_.baseState=g,R={pending:null,lanes:0,dispatch:null,lastRenderedReducer:K5,lastRenderedState:g},_.queue=R,_=p8.bind(null,jr,R),R.dispatch=_,R=lR(!1),q=pR.bind(null,jr,!1,R.queue),R=xo(),j={state:g,dispatch:null,action:p,pending:null},R.queue=j,_=rfe.bind(null,jr,j,q,_),j.dispatch=_,R.memoizedState=p,[g,_,!1]}function Z5(p){var g=Ei();return X5(g,_s,p)}function X5(p,g,_){if(g=aR(p,g,K5)[0],p=Y_(dd)[0],typeof g=="object"&&g!==null&&typeof g.then=="function")try{var R=uv(g)}catch(he){throw he===sv?q_:he}else R=g;g=Ei();var j=g.queue,q=j.dispatch;return _!==g.memoizedState&&(jr.flags|=2048,Bg(9,Z_(),sfe.bind(null,j,_),null)),[R,q,p]}function sfe(p,g){p.action=g}function J5(p){var g=Ei(),_=_s;if(_!==null)return X5(g,_,p);Ei(),g=g.memoizedState,_=Ei();var R=_.queue.dispatch;return _.memoizedState=p,[g,R,!1]}function Bg(p,g,_,R){return p={tag:p,create:_,deps:R,inst:g,next:null},g=jr.updateQueue,g===null&&(g=sR(),jr.updateQueue=g),_=g.lastEffect,_===null?g.lastEffect=p.next=p:(R=_.next,_.next=p,p.next=R,g.lastEffect=p),p}function Z_(){return{destroy:void 0,resource:void 0}}function Q5(){return Ei().memoizedState}function X_(p,g,_,R){var j=xo();R=R===void 0?null:R,jr.flags|=p,j.memoizedState=Bg(1|g,Z_(),_,R)}function dv(p,g,_,R){var j=Ei();R=R===void 0?null:R;var q=j.memoizedState.inst;_s!==null&&R!==null&&QA(R,_s.memoizedState.deps)?j.memoizedState=Bg(g,q,_,R):(jr.flags|=p,j.memoizedState=Bg(1|g,q,_,R))}function e8(p,g){X_(8390656,8,p,g)}function t8(p,g){dv(2048,8,p,g)}function n8(p,g){return dv(4,2,p,g)}function r8(p,g){return dv(4,4,p,g)}function s8(p,g){if(typeof g=="function"){p=p();var _=g(p);return function(){typeof _=="function"?_():g(null)}}if(g!=null)return p=p(),g.current=p,function(){g.current=null}}function i8(p,g,_){_=_!=null?_.concat([p]):null,dv(4,4,s8.bind(null,g,p),_)}function uR(){}function a8(p,g){var _=Ei();g=g===void 0?null:g;var R=_.memoizedState;return g!==null&&QA(g,R[1])?R[0]:(_.memoizedState=[p,g],p)}function o8(p,g){var _=Ei();g=g===void 0?null:g;var R=_.memoizedState;if(g!==null&&QA(g,R[1]))return R[0];if(R=p(),Pp){Ft(!0);try{p()}finally{Ft(!1)}}return _.memoizedState=[R,g],R}function dR(p,g,_){return _===void 0||(Uf&1073741824)!==0?p.memoizedState=g:(p.memoizedState=_,p=uL(),jr.lanes|=p,Yf|=p,_)}function l8(p,g,_,R){return Aa(_,g)?_:Dg.current!==null?(p=dR(p,_,R),Aa(p,g)||(Qi=!0),p):(Uf&42)===0?(Qi=!0,p.memoizedState=_):(p=uL(),jr.lanes|=p,Yf|=p,g)}function c8(p,g,_,R,j){var q=V.p;V.p=q!==0&&8>q?q:8;var he=U.T,Pe={};U.T=Pe,pR(p,!1,g,_);try{var Ye=j(),St=U.S;if(St!==null&&St(Pe,Ye),Ye!==null&&typeof Ye=="object"&&typeof Ye.then=="function"){var Dt=efe(Ye,R);fv(p,g,Dt,tl(p))}else fv(p,g,R,tl(p))}catch(Bt){fv(p,g,{then:function(){},status:"rejected",reason:Bt},tl())}finally{V.p=q,U.T=he}}function ife(){}function fR(p,g,_,R){if(p.tag!==5)throw Error(r(476));var j=u8(p).queue;c8(p,j,g,L,_===null?ife:function(){return d8(p),_(R)})}function u8(p){var g=p.memoizedState;if(g!==null)return g;g={memoizedState:L,baseState:L,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:dd,lastRenderedState:L},next:null};var _={};return g.next={memoizedState:_,baseState:_,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:dd,lastRenderedState:_},next:null},p.memoizedState=g,p=p.alternate,p!==null&&(p.memoizedState=g),g}function d8(p){var g=u8(p).next.queue;fv(p,g,{},tl())}function hR(){return Ra(Nv)}function f8(){return Ei().memoizedState}function h8(){return Ei().memoizedState}function afe(p){for(var g=p.return;g!==null;){switch(g.tag){case 24:case 3:var _=tl();p=$f(_);var R=zf(g,p,_);R!==null&&(nl(R,g,_),av(R,g,_)),g={cache:qA()},p.payload=g;return}g=g.return}}function ofe(p,g,_){var R=tl();_={lane:R,revertLane:0,action:_,hasEagerState:!1,eagerState:null,next:null},J_(p)?m8(g,_):(_=Ci(p,g,_,R),_!==null&&(nl(_,p,R),g8(_,g,R)))}function p8(p,g,_){var R=tl();fv(p,g,_,R)}function fv(p,g,_,R){var j={lane:R,revertLane:0,action:_,hasEagerState:!1,eagerState:null,next:null};if(J_(p))m8(g,j);else{var q=p.alternate;if(p.lanes===0&&(q===null||q.lanes===0)&&(q=g.lastRenderedReducer,q!==null))try{var he=g.lastRenderedState,Pe=q(he,_);if(j.hasEagerState=!0,j.eagerState=Pe,Aa(Pe,he))return fi(p,g,j,0),Os===null&&ar(),!1}catch{}finally{}if(_=Ci(p,g,j,R),_!==null)return nl(_,p,R),g8(_,g,R),!0}return!1}function pR(p,g,_,R){if(R={lane:2,revertLane:HR(),action:R,hasEagerState:!1,eagerState:null,next:null},J_(p)){if(g)throw Error(r(479))}else g=Ci(p,_,R,2),g!==null&&nl(g,p,2)}function J_(p){var g=p.alternate;return p===jr||g!==null&&g===jr}function m8(p,g){Fg=H_=!0;var _=p.pending;_===null?g.next=g:(g.next=_.next,_.next=g),p.pending=g}function g8(p,g,_){if((_&4194048)!==0){var R=g.lanes;R&=p.pendingLanes,_|=R,g.lanes=_,ze(p,_)}}var Q_={readContext:Ra,use:K_,useCallback:hi,useContext:hi,useEffect:hi,useImperativeHandle:hi,useLayoutEffect:hi,useInsertionEffect:hi,useMemo:hi,useReducer:hi,useRef:hi,useState:hi,useDebugValue:hi,useDeferredValue:hi,useTransition:hi,useSyncExternalStore:hi,useId:hi,useHostTransitionStatus:hi,useFormState:hi,useActionState:hi,useOptimistic:hi,useMemoCache:hi,useCacheRefresh:hi},y8={readContext:Ra,use:K_,useCallback:function(p,g){return xo().memoizedState=[p,g===void 0?null:g],p},useContext:Ra,useEffect:e8,useImperativeHandle:function(p,g,_){_=_!=null?_.concat([p]):null,X_(4194308,4,s8.bind(null,g,p),_)},useLayoutEffect:function(p,g){return X_(4194308,4,p,g)},useInsertionEffect:function(p,g){X_(4,2,p,g)},useMemo:function(p,g){var _=xo();g=g===void 0?null:g;var R=p();if(Pp){Ft(!0);try{p()}finally{Ft(!1)}}return _.memoizedState=[R,g],R},useReducer:function(p,g,_){var R=xo();if(_!==void 0){var j=_(g);if(Pp){Ft(!0);try{_(g)}finally{Ft(!1)}}}else j=g;return R.memoizedState=R.baseState=j,p={pending:null,lanes:0,dispatch:null,lastRenderedReducer:p,lastRenderedState:j},R.queue=p,p=p.dispatch=ofe.bind(null,jr,p),[R.memoizedState,p]},useRef:function(p){var g=xo();return p={current:p},g.memoizedState=p},useState:function(p){p=lR(p);var g=p.queue,_=p8.bind(null,jr,g);return g.dispatch=_,[p.memoizedState,_]},useDebugValue:uR,useDeferredValue:function(p,g){var _=xo();return dR(_,p,g)},useTransition:function(){var p=lR(!1);return p=c8.bind(null,jr,p.queue,!0,!1),xo().memoizedState=p,[!1,p]},useSyncExternalStore:function(p,g,_){var R=jr,j=xo();if(is){if(_===void 0)throw Error(r(407));_=_()}else{if(_=g(),Os===null)throw Error(r(349));(Yr&124)!==0||L5(R,g,_)}j.memoizedState=_;var q={value:_,getSnapshot:g};return j.queue=q,e8($5.bind(null,R,q,p),[p]),R.flags|=2048,Bg(9,Z_(),B5.bind(null,R,q,_,g),null),_},useId:function(){var p=xo(),g=Os.identifierPrefix;if(is){var _=ld,R=od;_=(R&~(1<<32-Ht(R)-1)).toString(32)+_,g=""+g+"R"+_,_=G_++,0<_&&(g+="H"+_.toString(32)),g+=""}else _=tfe++,g=""+g+"r"+_.toString(32)+"";return p.memoizedState=g},useHostTransitionStatus:hR,useFormState:Y5,useActionState:Y5,useOptimistic:function(p){var g=xo();g.memoizedState=g.baseState=p;var _={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return g.queue=_,g=pR.bind(null,jr,!0,_),_.dispatch=g,[p,g]},useMemoCache:iR,useCacheRefresh:function(){return xo().memoizedState=afe.bind(null,jr)}},b8={readContext:Ra,use:K_,useCallback:a8,useContext:Ra,useEffect:t8,useImperativeHandle:i8,useInsertionEffect:n8,useLayoutEffect:r8,useMemo:o8,useReducer:Y_,useRef:Q5,useState:function(){return Y_(dd)},useDebugValue:uR,useDeferredValue:function(p,g){var _=Ei();return l8(_,_s.memoizedState,p,g)},useTransition:function(){var p=Y_(dd)[0],g=Ei().memoizedState;return[typeof p=="boolean"?p:uv(p),g]},useSyncExternalStore:F5,useId:f8,useHostTransitionStatus:hR,useFormState:Z5,useActionState:Z5,useOptimistic:function(p,g){var _=Ei();return q5(_,_s,p,g)},useMemoCache:iR,useCacheRefresh:h8},lfe={readContext:Ra,use:K_,useCallback:a8,useContext:Ra,useEffect:t8,useImperativeHandle:i8,useInsertionEffect:n8,useLayoutEffect:r8,useMemo:o8,useReducer:oR,useRef:Q5,useState:function(){return oR(dd)},useDebugValue:uR,useDeferredValue:function(p,g){var _=Ei();return _s===null?dR(_,p,g):l8(_,_s.memoizedState,p,g)},useTransition:function(){var p=oR(dd)[0],g=Ei().memoizedState;return[typeof p=="boolean"?p:uv(p),g]},useSyncExternalStore:F5,useId:f8,useHostTransitionStatus:hR,useFormState:J5,useActionState:J5,useOptimistic:function(p,g){var _=Ei();return _s!==null?q5(_,_s,p,g):(_.baseState=p,[p,_.queue.dispatch])},useMemoCache:iR,useCacheRefresh:h8},$g=null,hv=0;function eS(p){var g=hv;return hv+=1,$g===null&&($g=[]),R5($g,p,g)}function pv(p,g){g=g.props.ref,p.ref=g!==void 0?g:null}function tS(p,g){throw g.$$typeof===d?Error(r(525)):(p=Object.prototype.toString.call(g),Error(r(31,p==="[object Object]"?"object with keys {"+Object.keys(g).join(", ")+"}":p)))}function v8(p){var g=p._init;return g(p._payload)}function x8(p){function g(mt,it){if(p){var _t=mt.deletions;_t===null?(mt.deletions=[it],mt.flags|=16):_t.push(it)}}function _(mt,it){if(!p)return null;for(;it!==null;)g(mt,it),it=it.sibling;return null}function R(mt){for(var it=new Map;mt!==null;)mt.key!==null?it.set(mt.key,mt):it.set(mt.index,mt),mt=mt.sibling;return it}function j(mt,it){return mt=ad(mt,it),mt.index=0,mt.sibling=null,mt}function q(mt,it,_t){return mt.index=_t,p?(_t=mt.alternate,_t!==null?(_t=_t.index,_t<it?(mt.flags|=67108866,it):_t):(mt.flags|=67108866,it)):(mt.flags|=1048576,it)}function he(mt){return p&&mt.alternate===null&&(mt.flags|=67108866),mt}function Pe(mt,it,_t,Lt){return it===null||it.tag!==6?(it=OA(_t,mt.mode,Lt),it.return=mt,it):(it=j(it,_t),it.return=mt,it)}function Ye(mt,it,_t,Lt){var wn=_t.type;return wn===y?Dt(mt,it,_t.props.children,Lt,_t.key):it!==null&&(it.elementType===wn||typeof wn=="object"&&wn!==null&&wn.$$typeof===N&&v8(wn)===it.type)?(it=j(it,_t.props),pv(it,_t),it.return=mt,it):(it=F_(_t.type,_t.key,_t.props,null,mt.mode,Lt),pv(it,_t),it.return=mt,it)}function St(mt,it,_t,Lt){return it===null||it.tag!==4||it.stateNode.containerInfo!==_t.containerInfo||it.stateNode.implementation!==_t.implementation?(it=DA(_t,mt.mode,Lt),it.return=mt,it):(it=j(it,_t.children||[]),it.return=mt,it)}function Dt(mt,it,_t,Lt,wn){return it===null||it.tag!==7?(it=Ep(_t,mt.mode,Lt,wn),it.return=mt,it):(it=j(it,_t),it.return=mt,it)}function Bt(mt,it,_t){if(typeof it=="string"&&it!==""||typeof it=="number"||typeof it=="bigint")return it=OA(""+it,mt.mode,_t),it.return=mt,it;if(typeof it=="object"&&it!==null){switch(it.$$typeof){case h:return _t=F_(it.type,it.key,it.props,null,mt.mode,_t),pv(_t,it),_t.return=mt,_t;case m:return it=DA(it,mt.mode,_t),it.return=mt,it;case N:var Lt=it._init;return it=Lt(it._payload),Bt(mt,it,_t)}if(K(it)||D(it))return it=Ep(it,mt.mode,_t,null),it.return=mt,it;if(typeof it.then=="function")return Bt(mt,eS(it),_t);if(it.$$typeof===S)return Bt(mt,z_(mt,it),_t);tS(mt,it)}return null}function Et(mt,it,_t,Lt){var wn=it!==null?it.key:null;if(typeof _t=="string"&&_t!==""||typeof _t=="number"||typeof _t=="bigint")return wn!==null?null:Pe(mt,it,""+_t,Lt);if(typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case h:return _t.key===wn?Ye(mt,it,_t,Lt):null;case m:return _t.key===wn?St(mt,it,_t,Lt):null;case N:return wn=_t._init,_t=wn(_t._payload),Et(mt,it,_t,Lt)}if(K(_t)||D(_t))return wn!==null?null:Dt(mt,it,_t,Lt,null);if(typeof _t.then=="function")return Et(mt,it,eS(_t),Lt);if(_t.$$typeof===S)return Et(mt,it,z_(mt,_t),Lt);tS(mt,_t)}return null}function Rt(mt,it,_t,Lt,wn){if(typeof Lt=="string"&&Lt!==""||typeof Lt=="number"||typeof Lt=="bigint")return mt=mt.get(_t)||null,Pe(it,mt,""+Lt,wn);if(typeof Lt=="object"&&Lt!==null){switch(Lt.$$typeof){case h:return mt=mt.get(Lt.key===null?_t:Lt.key)||null,Ye(it,mt,Lt,wn);case m:return mt=mt.get(Lt.key===null?_t:Lt.key)||null,St(it,mt,Lt,wn);case N:var Or=Lt._init;return Lt=Or(Lt._payload),Rt(mt,it,_t,Lt,wn)}if(K(Lt)||D(Lt))return mt=mt.get(_t)||null,Dt(it,mt,Lt,wn,null);if(typeof Lt.then=="function")return Rt(mt,it,_t,eS(Lt),wn);if(Lt.$$typeof===S)return Rt(mt,it,_t,z_(it,Lt),wn);tS(it,Lt)}return null}function or(mt,it,_t,Lt){for(var wn=null,Or=null,Dn=it,Xn=it=0,ta=null;Dn!==null&&Xn<_t.length;Xn++){Dn.index>Xn?(ta=Dn,Dn=null):ta=Dn.sibling;var ns=Et(mt,Dn,_t[Xn],Lt);if(ns===null){Dn===null&&(Dn=ta);break}p&&Dn&&ns.alternate===null&&g(mt,Dn),it=q(ns,it,Xn),Or===null?wn=ns:Or.sibling=ns,Or=ns,Dn=ta}if(Xn===_t.length)return _(mt,Dn),is&&Ap(mt,Xn),wn;if(Dn===null){for(;Xn<_t.length;Xn++)Dn=Bt(mt,_t[Xn],Lt),Dn!==null&&(it=q(Dn,it,Xn),Or===null?wn=Dn:Or.sibling=Dn,Or=Dn);return is&&Ap(mt,Xn),wn}for(Dn=R(Dn);Xn<_t.length;Xn++)ta=Rt(Dn,mt,Xn,_t[Xn],Lt),ta!==null&&(p&&ta.alternate!==null&&Dn.delete(ta.key===null?Xn:ta.key),it=q(ta,it,Xn),Or===null?wn=ta:Or.sibling=ta,Or=ta);return p&&Dn.forEach(function(sh){return g(mt,sh)}),is&&Ap(mt,Xn),wn}function Gn(mt,it,_t,Lt){if(_t==null)throw Error(r(151));for(var wn=null,Or=null,Dn=it,Xn=it=0,ta=null,ns=_t.next();Dn!==null&&!ns.done;Xn++,ns=_t.next()){Dn.index>Xn?(ta=Dn,Dn=null):ta=Dn.sibling;var sh=Et(mt,Dn,ns.value,Lt);if(sh===null){Dn===null&&(Dn=ta);break}p&&Dn&&sh.alternate===null&&g(mt,Dn),it=q(sh,it,Xn),Or===null?wn=sh:Or.sibling=sh,Or=sh,Dn=ta}if(ns.done)return _(mt,Dn),is&&Ap(mt,Xn),wn;if(Dn===null){for(;!ns.done;Xn++,ns=_t.next())ns=Bt(mt,ns.value,Lt),ns!==null&&(it=q(ns,it,Xn),Or===null?wn=ns:Or.sibling=ns,Or=ns);return is&&Ap(mt,Xn),wn}for(Dn=R(Dn);!ns.done;Xn++,ns=_t.next())ns=Rt(Dn,mt,Xn,ns.value,Lt),ns!==null&&(p&&ns.alternate!==null&&Dn.delete(ns.key===null?Xn:ns.key),it=q(ns,it,Xn),Or===null?wn=ns:Or.sibling=ns,Or=ns);return p&&Dn.forEach(function(che){return g(mt,che)}),is&&Ap(mt,Xn),wn}function Cs(mt,it,_t,Lt){if(typeof _t=="object"&&_t!==null&&_t.type===y&&_t.key===null&&(_t=_t.props.children),typeof _t=="object"&&_t!==null){switch(_t.$$typeof){case h:e:{for(var wn=_t.key;it!==null;){if(it.key===wn){if(wn=_t.type,wn===y){if(it.tag===7){_(mt,it.sibling),Lt=j(it,_t.props.children),Lt.return=mt,mt=Lt;break e}}else if(it.elementType===wn||typeof wn=="object"&&wn!==null&&wn.$$typeof===N&&v8(wn)===it.type){_(mt,it.sibling),Lt=j(it,_t.props),pv(Lt,_t),Lt.return=mt,mt=Lt;break e}_(mt,it);break}else g(mt,it);it=it.sibling}_t.type===y?(Lt=Ep(_t.props.children,mt.mode,Lt,_t.key),Lt.return=mt,mt=Lt):(Lt=F_(_t.type,_t.key,_t.props,null,mt.mode,Lt),pv(Lt,_t),Lt.return=mt,mt=Lt)}return he(mt);case m:e:{for(wn=_t.key;it!==null;){if(it.key===wn)if(it.tag===4&&it.stateNode.containerInfo===_t.containerInfo&&it.stateNode.implementation===_t.implementation){_(mt,it.sibling),Lt=j(it,_t.children||[]),Lt.return=mt,mt=Lt;break e}else{_(mt,it);break}else g(mt,it);it=it.sibling}Lt=DA(_t,mt.mode,Lt),Lt.return=mt,mt=Lt}return he(mt);case N:return wn=_t._init,_t=wn(_t._payload),Cs(mt,it,_t,Lt)}if(K(_t))return or(mt,it,_t,Lt);if(D(_t)){if(wn=D(_t),typeof wn!="function")throw Error(r(150));return _t=wn.call(_t),Gn(mt,it,_t,Lt)}if(typeof _t.then=="function")return Cs(mt,it,eS(_t),Lt);if(_t.$$typeof===S)return Cs(mt,it,z_(mt,_t),Lt);tS(mt,_t)}return typeof _t=="string"&&_t!==""||typeof _t=="number"||typeof _t=="bigint"?(_t=""+_t,it!==null&&it.tag===6?(_(mt,it.sibling),Lt=j(it,_t),Lt.return=mt,mt=Lt):(_(mt,it),Lt=OA(_t,mt.mode,Lt),Lt.return=mt,mt=Lt),he(mt)):_(mt,it)}return function(mt,it,_t,Lt){try{hv=0;var wn=Cs(mt,it,_t,Lt);return $g=null,wn}catch(Dn){if(Dn===sv||Dn===q_)throw Dn;var Or=Xo(29,Dn,null,mt.mode);return Or.lanes=Lt,Or.return=mt,Or}finally{}}}var zg=x8(!0),w8=x8(!1),Al=Q(null),eu=null;function qf(p){var g=p.alternate;re(Li,Li.current&1),re(Al,p),eu===null&&(g===null||Dg.current!==null||g.memoizedState!==null)&&(eu=p)}function _8(p){if(p.tag===22){if(re(Li,Li.current),re(Al,p),eu===null){var g=p.alternate;g!==null&&g.memoizedState!==null&&(eu=p)}}else Vf()}function Vf(){re(Li,Li.current),re(Al,Al.current)}function fd(p){ee(Al),eu===p&&(eu=null),ee(Li)}var Li=Q(0);function nS(p){for(var g=p;g!==null;){if(g.tag===13){var _=g.memoizedState;if(_!==null&&(_=_.dehydrated,_===null||_.data==="$?"||sN(_)))return g}else if(g.tag===19&&g.memoizedProps.revealOrder!==void 0){if((g.flags&128)!==0)return g}else if(g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return null;g=g.return}g.sibling.return=g.return,g=g.sibling}return null}function mR(p,g,_,R){g=p.memoizedState,_=_(R,g),_=_==null?g:u({},g,_),p.memoizedState=_,p.lanes===0&&(p.updateQueue.baseState=_)}var gR={enqueueSetState:function(p,g,_){p=p._reactInternals;var R=tl(),j=$f(R);j.payload=g,_!=null&&(j.callback=_),g=zf(p,j,R),g!==null&&(nl(g,p,R),av(g,p,R))},enqueueReplaceState:function(p,g,_){p=p._reactInternals;var R=tl(),j=$f(R);j.tag=1,j.payload=g,_!=null&&(j.callback=_),g=zf(p,j,R),g!==null&&(nl(g,p,R),av(g,p,R))},enqueueForceUpdate:function(p,g){p=p._reactInternals;var _=tl(),R=$f(_);R.tag=2,g!=null&&(R.callback=g),g=zf(p,R,_),g!==null&&(nl(g,p,_),av(g,p,_))}};function S8(p,g,_,R,j,q,he){return p=p.stateNode,typeof p.shouldComponentUpdate=="function"?p.shouldComponentUpdate(R,q,he):g.prototype&&g.prototype.isPureReactComponent?!M(_,R)||!M(j,q):!0}function C8(p,g,_,R){p=g.state,typeof g.componentWillReceiveProps=="function"&&g.componentWillReceiveProps(_,R),typeof g.UNSAFE_componentWillReceiveProps=="function"&&g.UNSAFE_componentWillReceiveProps(_,R),g.state!==p&&gR.enqueueReplaceState(g,g.state,null)}function Op(p,g){var _=g;if("ref"in g){_={};for(var R in g)R!=="ref"&&(_[R]=g[R])}if(p=p.defaultProps){_===g&&(_=u({},_));for(var j in p)_[j]===void 0&&(_[j]=p[j])}return _}var rS=typeof reportError=="function"?reportError:function(p){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var g=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof p=="object"&&p!==null&&typeof p.message=="string"?String(p.message):String(p),error:p});if(!window.dispatchEvent(g))return}else if(typeof Mi=="object"&&typeof Mi.emit=="function"){Mi.emit("uncaughtException",p);return}console.error(p)};function k8(p){rS(p)}function E8(p){console.error(p)}function T8(p){rS(p)}function sS(p,g){try{var _=p.onUncaughtError;_(g.value,{componentStack:g.stack})}catch(R){setTimeout(function(){throw R})}}function A8(p,g,_){try{var R=p.onCaughtError;R(_.value,{componentStack:_.stack,errorBoundary:g.tag===1?g.stateNode:null})}catch(j){setTimeout(function(){throw j})}}function yR(p,g,_){return _=$f(_),_.tag=3,_.payload={element:null},_.callback=function(){sS(p,g)},_}function R8(p){return p=$f(p),p.tag=3,p}function N8(p,g,_,R){var j=_.type.getDerivedStateFromError;if(typeof j=="function"){var q=R.value;p.payload=function(){return j(q)},p.callback=function(){A8(g,_,R)}}var he=_.stateNode;he!==null&&typeof he.componentDidCatch=="function"&&(p.callback=function(){A8(g,_,R),typeof j!="function"&&(Zf===null?Zf=new Set([this]):Zf.add(this));var Pe=R.stack;this.componentDidCatch(R.value,{componentStack:Pe!==null?Pe:""})})}function cfe(p,g,_,R,j){if(_.flags|=32768,R!==null&&typeof R=="object"&&typeof R.then=="function"){if(g=_.alternate,g!==null&&tv(g,_,j,!0),_=Al.current,_!==null){switch(_.tag){case 13:return eu===null?zR():_.alternate===null&&oi===0&&(oi=3),_.flags&=-257,_.flags|=65536,_.lanes=j,R===HA?_.flags|=16384:(g=_.updateQueue,g===null?_.updateQueue=new Set([R]):g.add(R),qR(p,R,j)),!1;case 22:return _.flags|=65536,R===HA?_.flags|=16384:(g=_.updateQueue,g===null?(g={transitions:null,markerInstances:null,retryQueue:new Set([R])},_.updateQueue=g):(_=g.retryQueue,_===null?g.retryQueue=new Set([R]):_.add(R)),qR(p,R,j)),!1}throw Error(r(435,_.tag))}return qR(p,R,j),zR(),!1}if(is)return g=Al.current,g!==null?((g.flags&65536)===0&&(g.flags|=256),g.flags|=65536,g.lanes=j,R!==BA&&(p=Error(r(422),{cause:R}),ev(zn(p,_)))):(R!==BA&&(g=Error(r(423),{cause:R}),ev(zn(g,_))),p=p.current.alternate,p.flags|=65536,j&=-j,p.lanes|=j,R=zn(R,_),j=yR(p.stateNode,R,j),YA(p,j),oi!==4&&(oi=2)),!1;var q=Error(r(520),{cause:R});if(q=zn(q,_),wv===null?wv=[q]:wv.push(q),oi!==4&&(oi=2),g===null)return!0;R=zn(R,_),_=g;do{switch(_.tag){case 3:return _.flags|=65536,p=j&-j,_.lanes|=p,p=yR(_.stateNode,R,p),YA(_,p),!1;case 1:if(g=_.type,q=_.stateNode,(_.flags&128)===0&&(typeof g.getDerivedStateFromError=="function"||q!==null&&typeof q.componentDidCatch=="function"&&(Zf===null||!Zf.has(q))))return _.flags|=65536,j&=-j,_.lanes|=j,j=R8(j),N8(j,p,_,R),YA(_,j),!1}_=_.return}while(_!==null);return!1}var M8=Error(r(461)),Qi=!1;function ga(p,g,_,R){g.child=p===null?w8(g,null,_,R):zg(g,p.child,_,R)}function I8(p,g,_,R,j){_=_.render;var q=g.ref;if("ref"in R){var he={};for(var Pe in R)Pe!=="ref"&&(he[Pe]=R[Pe])}else he=R;return Ip(g),R=eR(p,g,_,he,q,j),Pe=tR(),p!==null&&!Qi?(nR(p,g,j),hd(p,g,j)):(is&&Pe&&FA(g),g.flags|=1,ga(p,g,R,j),g.child)}function j8(p,g,_,R,j){if(p===null){var q=_.type;return typeof q=="function"&&!PA(q)&&q.defaultProps===void 0&&_.compare===null?(g.tag=15,g.type=q,P8(p,g,q,R,j)):(p=F_(_.type,null,R,g,g.mode,j),p.ref=g.ref,p.return=g,g.child=p)}if(q=p.child,!kR(p,j)){var he=q.memoizedProps;if(_=_.compare,_=_!==null?_:M,_(he,R)&&p.ref===g.ref)return hd(p,g,j)}return g.flags|=1,p=ad(q,R),p.ref=g.ref,p.return=g,g.child=p}function P8(p,g,_,R,j){if(p!==null){var q=p.memoizedProps;if(M(q,R)&&p.ref===g.ref)if(Qi=!1,g.pendingProps=R=q,kR(p,j))(p.flags&131072)!==0&&(Qi=!0);else return g.lanes=p.lanes,hd(p,g,j)}return bR(p,g,_,R,j)}function O8(p,g,_){var R=g.pendingProps,j=R.children,q=p!==null?p.memoizedState:null;if(R.mode==="hidden"){if((g.flags&128)!==0){if(R=q!==null?q.baseLanes|_:_,p!==null){for(j=g.child=p.child,q=0;j!==null;)q=q|j.lanes|j.childLanes,j=j.sibling;g.childLanes=q&~R}else g.childLanes=0,g.child=null;return D8(p,g,R,_)}if((_&536870912)!==0)g.memoizedState={baseLanes:0,cachePool:null},p!==null&&U_(g,q!==null?q.cachePool:null),q!==null?P5(g,q):XA(),_8(g);else return g.lanes=g.childLanes=536870912,D8(p,g,q!==null?q.baseLanes|_:_,_)}else q!==null?(U_(g,q.cachePool),P5(g,q),Vf(),g.memoizedState=null):(p!==null&&U_(g,null),XA(),Vf());return ga(p,g,j,_),g.child}function D8(p,g,_,R){var j=WA();return j=j===null?null:{parent:Fi._currentValue,pool:j},g.memoizedState={baseLanes:_,cachePool:j},p!==null&&U_(g,null),XA(),_8(g),p!==null&&tv(p,g,R,!0),null}function iS(p,g){var _=g.ref;if(_===null)p!==null&&p.ref!==null&&(g.flags|=4194816);else{if(typeof _!="function"&&typeof _!="object")throw Error(r(284));(p===null||p.ref!==_)&&(g.flags|=4194816)}}function bR(p,g,_,R,j){return Ip(g),_=eR(p,g,_,R,void 0,j),R=tR(),p!==null&&!Qi?(nR(p,g,j),hd(p,g,j)):(is&&R&&FA(g),g.flags|=1,ga(p,g,_,j),g.child)}function F8(p,g,_,R,j,q){return Ip(g),g.updateQueue=null,_=D5(g,R,_,j),O5(p),R=tR(),p!==null&&!Qi?(nR(p,g,q),hd(p,g,q)):(is&&R&&FA(g),g.flags|=1,ga(p,g,_,q),g.child)}function L8(p,g,_,R,j){if(Ip(g),g.stateNode===null){var q=Jc,he=_.contextType;typeof he=="object"&&he!==null&&(q=Ra(he)),q=new _(R,q),g.memoizedState=q.state!==null&&q.state!==void 0?q.state:null,q.updater=gR,g.stateNode=q,q._reactInternals=g,q=g.stateNode,q.props=R,q.state=g.memoizedState,q.refs={},GA(g),he=_.contextType,q.context=typeof he=="object"&&he!==null?Ra(he):Jc,q.state=g.memoizedState,he=_.getDerivedStateFromProps,typeof he=="function"&&(mR(g,_,he,R),q.state=g.memoizedState),typeof _.getDerivedStateFromProps=="function"||typeof q.getSnapshotBeforeUpdate=="function"||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(he=q.state,typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount(),he!==q.state&&gR.enqueueReplaceState(q,q.state,null),lv(g,R,q,j),ov(),q.state=g.memoizedState),typeof q.componentDidMount=="function"&&(g.flags|=4194308),R=!0}else if(p===null){q=g.stateNode;var Pe=g.memoizedProps,Ye=Op(_,Pe);q.props=Ye;var St=q.context,Dt=_.contextType;he=Jc,typeof Dt=="object"&&Dt!==null&&(he=Ra(Dt));var Bt=_.getDerivedStateFromProps;Dt=typeof Bt=="function"||typeof q.getSnapshotBeforeUpdate=="function",Pe=g.pendingProps!==Pe,Dt||typeof q.UNSAFE_componentWillReceiveProps!="function"&&typeof q.componentWillReceiveProps!="function"||(Pe||St!==he)&&C8(g,q,R,he),Bf=!1;var Et=g.memoizedState;q.state=Et,lv(g,R,q,j),ov(),St=g.memoizedState,Pe||Et!==St||Bf?(typeof Bt=="function"&&(mR(g,_,Bt,R),St=g.memoizedState),(Ye=Bf||S8(g,_,Ye,R,Et,St,he))?(Dt||typeof q.UNSAFE_componentWillMount!="function"&&typeof q.componentWillMount!="function"||(typeof q.componentWillMount=="function"&&q.componentWillMount(),typeof q.UNSAFE_componentWillMount=="function"&&q.UNSAFE_componentWillMount()),typeof q.componentDidMount=="function"&&(g.flags|=4194308)):(typeof q.componentDidMount=="function"&&(g.flags|=4194308),g.memoizedProps=R,g.memoizedState=St),q.props=R,q.state=St,q.context=he,R=Ye):(typeof q.componentDidMount=="function"&&(g.flags|=4194308),R=!1)}else{q=g.stateNode,KA(p,g),he=g.memoizedProps,Dt=Op(_,he),q.props=Dt,Bt=g.pendingProps,Et=q.context,St=_.contextType,Ye=Jc,typeof St=="object"&&St!==null&&(Ye=Ra(St)),Pe=_.getDerivedStateFromProps,(St=typeof Pe=="function"||typeof q.getSnapshotBeforeUpdate=="function")||typeof q.UNSAFE_componentWillReceiveProps!="function"&&typeof q.componentWillReceiveProps!="function"||(he!==Bt||Et!==Ye)&&C8(g,q,R,Ye),Bf=!1,Et=g.memoizedState,q.state=Et,lv(g,R,q,j),ov();var Rt=g.memoizedState;he!==Bt||Et!==Rt||Bf||p!==null&&p.dependencies!==null&&$_(p.dependencies)?(typeof Pe=="function"&&(mR(g,_,Pe,R),Rt=g.memoizedState),(Dt=Bf||S8(g,_,Dt,R,Et,Rt,Ye)||p!==null&&p.dependencies!==null&&$_(p.dependencies))?(St||typeof q.UNSAFE_componentWillUpdate!="function"&&typeof q.componentWillUpdate!="function"||(typeof q.componentWillUpdate=="function"&&q.componentWillUpdate(R,Rt,Ye),typeof q.UNSAFE_componentWillUpdate=="function"&&q.UNSAFE_componentWillUpdate(R,Rt,Ye)),typeof q.componentDidUpdate=="function"&&(g.flags|=4),typeof q.getSnapshotBeforeUpdate=="function"&&(g.flags|=1024)):(typeof q.componentDidUpdate!="function"||he===p.memoizedProps&&Et===p.memoizedState||(g.flags|=4),typeof q.getSnapshotBeforeUpdate!="function"||he===p.memoizedProps&&Et===p.memoizedState||(g.flags|=1024),g.memoizedProps=R,g.memoizedState=Rt),q.props=R,q.state=Rt,q.context=Ye,R=Dt):(typeof q.componentDidUpdate!="function"||he===p.memoizedProps&&Et===p.memoizedState||(g.flags|=4),typeof q.getSnapshotBeforeUpdate!="function"||he===p.memoizedProps&&Et===p.memoizedState||(g.flags|=1024),R=!1)}return q=R,iS(p,g),R=(g.flags&128)!==0,q||R?(q=g.stateNode,_=R&&typeof _.getDerivedStateFromError!="function"?null:q.render(),g.flags|=1,p!==null&&R?(g.child=zg(g,p.child,null,j),g.child=zg(g,null,_,j)):ga(p,g,_,j),g.memoizedState=q.state,p=g.child):p=hd(p,g,j),p}function B8(p,g,_,R){return Qb(),g.flags|=256,ga(p,g,_,R),g.child}var vR={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null};function xR(p){return{baseLanes:p,cachePool:E5()}}function wR(p,g,_){return p=p!==null?p.childLanes&~_:0,g&&(p|=Rl),p}function $8(p,g,_){var R=g.pendingProps,j=!1,q=(g.flags&128)!==0,he;if((he=q)||(he=p!==null&&p.memoizedState===null?!1:(Li.current&2)!==0),he&&(j=!0,g.flags&=-129),he=(g.flags&32)!==0,g.flags&=-33,p===null){if(is){if(j?qf(g):Vf(),is){var Pe=ai,Ye;if(Ye=Pe){e:{for(Ye=Pe,Pe=Qc;Ye.nodeType!==8;){if(!Pe){Pe=null;break e}if(Ye=dc(Ye.nextSibling),Ye===null){Pe=null;break e}}Pe=Ye}Pe!==null?(g.memoizedState={dehydrated:Pe,treeContext:Tp!==null?{id:od,overflow:ld}:null,retryLane:536870912,hydrationErrors:null},Ye=Xo(18,null,null,0),Ye.stateNode=Pe,Ye.return=g,g.child=Ye,Xa=g,ai=null,Ye=!0):Ye=!1}Ye||Np(g)}if(Pe=g.memoizedState,Pe!==null&&(Pe=Pe.dehydrated,Pe!==null))return sN(Pe)?g.lanes=32:g.lanes=536870912,null;fd(g)}return Pe=R.children,R=R.fallback,j?(Vf(),j=g.mode,Pe=aS({mode:"hidden",children:Pe},j),R=Ep(R,j,_,null),Pe.return=g,R.return=g,Pe.sibling=R,g.child=Pe,j=g.child,j.memoizedState=xR(_),j.childLanes=wR(p,he,_),g.memoizedState=vR,R):(qf(g),_R(g,Pe))}if(Ye=p.memoizedState,Ye!==null&&(Pe=Ye.dehydrated,Pe!==null)){if(q)g.flags&256?(qf(g),g.flags&=-257,g=SR(p,g,_)):g.memoizedState!==null?(Vf(),g.child=p.child,g.flags|=128,g=null):(Vf(),j=R.fallback,Pe=g.mode,R=aS({mode:"visible",children:R.children},Pe),j=Ep(j,Pe,_,null),j.flags|=2,R.return=g,j.return=g,R.sibling=j,g.child=R,zg(g,p.child,null,_),R=g.child,R.memoizedState=xR(_),R.childLanes=wR(p,he,_),g.memoizedState=vR,g=j);else if(qf(g),sN(Pe)){if(he=Pe.nextSibling&&Pe.nextSibling.dataset,he)var St=he.dgst;he=St,R=Error(r(419)),R.stack="",R.digest=he,ev({value:R,source:null,stack:null}),g=SR(p,g,_)}else if(Qi||tv(p,g,_,!1),he=(_&p.childLanes)!==0,Qi||he){if(he=Os,he!==null&&(R=_&-_,R=(R&42)!==0?1:Ct(R),R=(R&(he.suspendedLanes|_))!==0?0:R,R!==0&&R!==Ye.retryLane))throw Ye.retryLane=R,cc(p,R),nl(he,p,R),M8;Pe.data==="$?"||zR(),g=SR(p,g,_)}else Pe.data==="$?"?(g.flags|=192,g.child=p.child,g=null):(p=Ye.treeContext,ai=dc(Pe.nextSibling),Xa=g,is=!0,Rp=null,Qc=!1,p!==null&&(El[Tl++]=od,El[Tl++]=ld,El[Tl++]=Tp,od=p.id,ld=p.overflow,Tp=g),g=_R(g,R.children),g.flags|=4096);return g}return j?(Vf(),j=R.fallback,Pe=g.mode,Ye=p.child,St=Ye.sibling,R=ad(Ye,{mode:"hidden",children:R.children}),R.subtreeFlags=Ye.subtreeFlags&65011712,St!==null?j=ad(St,j):(j=Ep(j,Pe,_,null),j.flags|=2),j.return=g,R.return=g,R.sibling=j,g.child=R,R=j,j=g.child,Pe=p.child.memoizedState,Pe===null?Pe=xR(_):(Ye=Pe.cachePool,Ye!==null?(St=Fi._currentValue,Ye=Ye.parent!==St?{parent:St,pool:St}:Ye):Ye=E5(),Pe={baseLanes:Pe.baseLanes|_,cachePool:Ye}),j.memoizedState=Pe,j.childLanes=wR(p,he,_),g.memoizedState=vR,R):(qf(g),_=p.child,p=_.sibling,_=ad(_,{mode:"visible",children:R.children}),_.return=g,_.sibling=null,p!==null&&(he=g.deletions,he===null?(g.deletions=[p],g.flags|=16):he.push(p)),g.child=_,g.memoizedState=null,_)}function _R(p,g){return g=aS({mode:"visible",children:g},p.mode),g.return=p,p.child=g}function aS(p,g){return p=Xo(22,p,null,g),p.lanes=0,p.stateNode={_visibility:1,_pendingMarkers:null,_retryCache:null,_transitions:null},p}function SR(p,g,_){return zg(g,p.child,null,_),p=_R(g,g.pendingProps.children),p.flags|=2,g.memoizedState=null,p}function z8(p,g,_){p.lanes|=g;var R=p.alternate;R!==null&&(R.lanes|=g),zA(p.return,g,_)}function CR(p,g,_,R,j){var q=p.memoizedState;q===null?p.memoizedState={isBackwards:g,rendering:null,renderingStartTime:0,last:R,tail:_,tailMode:j}:(q.isBackwards=g,q.rendering=null,q.renderingStartTime=0,q.last=R,q.tail=_,q.tailMode=j)}function U8(p,g,_){var R=g.pendingProps,j=R.revealOrder,q=R.tail;if(ga(p,g,R.children,_),R=Li.current,(R&2)!==0)R=R&1|2,g.flags|=128;else{if(p!==null&&(p.flags&128)!==0)e:for(p=g.child;p!==null;){if(p.tag===13)p.memoizedState!==null&&z8(p,_,g);else if(p.tag===19)z8(p,_,g);else if(p.child!==null){p.child.return=p,p=p.child;continue}if(p===g)break e;for(;p.sibling===null;){if(p.return===null||p.return===g)break e;p=p.return}p.sibling.return=p.return,p=p.sibling}R&=1}switch(re(Li,R),j){case"forwards":for(_=g.child,j=null;_!==null;)p=_.alternate,p!==null&&nS(p)===null&&(j=_),_=_.sibling;_=j,_===null?(j=g.child,g.child=null):(j=_.sibling,_.sibling=null),CR(g,!1,j,_,q);break;case"backwards":for(_=null,j=g.child,g.child=null;j!==null;){if(p=j.alternate,p!==null&&nS(p)===null){g.child=j;break}p=j.sibling,j.sibling=_,_=j,j=p}CR(g,!0,_,null,q);break;case"together":CR(g,!1,null,null,void 0);break;default:g.memoizedState=null}return g.child}function hd(p,g,_){if(p!==null&&(g.dependencies=p.dependencies),Yf|=g.lanes,(_&g.childLanes)===0)if(p!==null){if(tv(p,g,_,!1),(_&g.childLanes)===0)return null}else return null;if(p!==null&&g.child!==p.child)throw Error(r(153));if(g.child!==null){for(p=g.child,_=ad(p,p.pendingProps),g.child=_,_.return=g;p.sibling!==null;)p=p.sibling,_=_.sibling=ad(p,p.pendingProps),_.return=g;_.sibling=null}return g.child}function kR(p,g){return(p.lanes&g)!==0?!0:(p=p.dependencies,!!(p!==null&&$_(p)))}function ufe(p,g,_){switch(g.tag){case 3:Se(g,g.stateNode.containerInfo),Lf(g,Fi,p.memoizedState.cache),Qb();break;case 27:case 5:qe(g);break;case 4:Se(g,g.stateNode.containerInfo);break;case 10:Lf(g,g.type,g.memoizedProps.value);break;case 13:var R=g.memoizedState;if(R!==null)return R.dehydrated!==null?(qf(g),g.flags|=128,null):(_&g.child.childLanes)!==0?$8(p,g,_):(qf(g),p=hd(p,g,_),p!==null?p.sibling:null);qf(g);break;case 19:var j=(p.flags&128)!==0;if(R=(_&g.childLanes)!==0,R||(tv(p,g,_,!1),R=(_&g.childLanes)!==0),j){if(R)return U8(p,g,_);g.flags|=128}if(j=g.memoizedState,j!==null&&(j.rendering=null,j.tail=null,j.lastEffect=null),re(Li,Li.current),R)break;return null;case 22:case 23:return g.lanes=0,O8(p,g,_);case 24:Lf(g,Fi,p.memoizedState.cache)}return hd(p,g,_)}function q8(p,g,_){if(p!==null)if(p.memoizedProps!==g.pendingProps)Qi=!0;else{if(!kR(p,_)&&(g.flags&128)===0)return Qi=!1,ufe(p,g,_);Qi=(p.flags&131072)!==0}else Qi=!1,is&&(g.flags&1048576)!==0&&v5(g,B_,g.index);switch(g.lanes=0,g.tag){case 16:e:{p=g.pendingProps;var R=g.elementType,j=R._init;if(R=j(R._payload),g.type=R,typeof R=="function")PA(R)?(p=Op(R,p),g.tag=1,g=L8(null,g,R,p,_)):(g.tag=0,g=bR(null,g,R,p,_));else{if(R!=null){if(j=R.$$typeof,j===k){g.tag=11,g=I8(null,g,R,p,_);break e}else if(j===A){g.tag=14,g=j8(null,g,R,p,_);break e}}throw g=P(R)||R,Error(r(306,g,""))}}return g;case 0:return bR(p,g,g.type,g.pendingProps,_);case 1:return R=g.type,j=Op(R,g.pendingProps),L8(p,g,R,j,_);case 3:e:{if(Se(g,g.stateNode.containerInfo),p===null)throw Error(r(387));R=g.pendingProps;var q=g.memoizedState;j=q.element,KA(p,g),lv(g,R,null,_);var he=g.memoizedState;if(R=he.cache,Lf(g,Fi,R),R!==q.cache&&UA(g,[Fi],_,!0),ov(),R=he.element,q.isDehydrated)if(q={element:R,isDehydrated:!1,cache:he.cache},g.updateQueue.baseState=q,g.memoizedState=q,g.flags&256){g=B8(p,g,R,_);break e}else if(R!==j){j=zn(Error(r(424)),g),ev(j),g=B8(p,g,R,_);break e}else{switch(p=g.stateNode.containerInfo,p.nodeType){case 9:p=p.body;break;default:p=p.nodeName==="HTML"?p.ownerDocument.body:p}for(ai=dc(p.firstChild),Xa=g,is=!0,Rp=null,Qc=!0,_=w8(g,null,R,_),g.child=_;_;)_.flags=_.flags&-3|4096,_=_.sibling}else{if(Qb(),R===j){g=hd(p,g,_);break e}ga(p,g,R,_)}g=g.child}return g;case 26:return iS(p,g),p===null?(_=GL(g.type,null,g.pendingProps,null))?g.memoizedState=_:is||(_=g.type,p=g.pendingProps,R=xS(Oe.current).createElement(_),R[xe]=g,R[De]=p,ba(R,_,p),kr(R),g.stateNode=R):g.memoizedState=GL(g.type,p.memoizedProps,g.pendingProps,p.memoizedState),null;case 27:return qe(g),p===null&&is&&(R=g.stateNode=VL(g.type,g.pendingProps,Oe.current),Xa=g,Qc=!0,j=ai,Qf(g.type)?(iN=j,ai=dc(R.firstChild)):ai=j),ga(p,g,g.pendingProps.children,_),iS(p,g),p===null&&(g.flags|=4194304),g.child;case 5:return p===null&&is&&((j=R=ai)&&(R=Lfe(R,g.type,g.pendingProps,Qc),R!==null?(g.stateNode=R,Xa=g,ai=dc(R.firstChild),Qc=!1,j=!0):j=!1),j||Np(g)),qe(g),j=g.type,q=g.pendingProps,he=p!==null?p.memoizedProps:null,R=q.children,tN(j,q)?R=null:he!==null&&tN(j,he)&&(g.flags|=32),g.memoizedState!==null&&(j=eR(p,g,nfe,null,null,_),Nv._currentValue=j),iS(p,g),ga(p,g,R,_),g.child;case 6:return p===null&&is&&((p=_=ai)&&(_=Bfe(_,g.pendingProps,Qc),_!==null?(g.stateNode=_,Xa=g,ai=null,p=!0):p=!1),p||Np(g)),null;case 13:return $8(p,g,_);case 4:return Se(g,g.stateNode.containerInfo),R=g.pendingProps,p===null?g.child=zg(g,null,R,_):ga(p,g,R,_),g.child;case 11:return I8(p,g,g.type,g.pendingProps,_);case 7:return ga(p,g,g.pendingProps,_),g.child;case 8:return ga(p,g,g.pendingProps.children,_),g.child;case 12:return ga(p,g,g.pendingProps.children,_),g.child;case 10:return R=g.pendingProps,Lf(g,g.type,R.value),ga(p,g,R.children,_),g.child;case 9:return j=g.type._context,R=g.pendingProps.children,Ip(g),j=Ra(j),R=R(j),g.flags|=1,ga(p,g,R,_),g.child;case 14:return j8(p,g,g.type,g.pendingProps,_);case 15:return P8(p,g,g.type,g.pendingProps,_);case 19:return U8(p,g,_);case 31:return R=g.pendingProps,_=g.mode,R={mode:R.mode,children:R.children},p===null?(_=aS(R,_),_.ref=g.ref,g.child=_,_.return=g,g=_):(_=ad(p.child,R),_.ref=g.ref,g.child=_,_.return=g,g=_),g;case 22:return O8(p,g,_);case 24:return Ip(g),R=Ra(Fi),p===null?(j=WA(),j===null&&(j=Os,q=qA(),j.pooledCache=q,q.refCount++,q!==null&&(j.pooledCacheLanes|=_),j=q),g.memoizedState={parent:R,cache:j},GA(g),Lf(g,Fi,j)):((p.lanes&_)!==0&&(KA(p,g),lv(g,null,null,_),ov()),j=p.memoizedState,q=g.memoizedState,j.parent!==R?(j={parent:R,cache:R},g.memoizedState=j,g.lanes===0&&(g.memoizedState=g.updateQueue.baseState=j),Lf(g,Fi,R)):(R=q.cache,Lf(g,Fi,R),R!==j.cache&&UA(g,[Fi],_,!0))),ga(p,g,g.pendingProps.children,_),g.child;case 29:throw g.pendingProps}throw Error(r(156,g.tag))}function pd(p){p.flags|=4}function V8(p,g){if(g.type!=="stylesheet"||(g.state.loading&4)!==0)p.flags&=-16777217;else if(p.flags|=16777216,!JL(g)){if(g=Al.current,g!==null&&((Yr&4194048)===Yr?eu!==null:(Yr&62914560)!==Yr&&(Yr&536870912)===0||g!==eu))throw iv=HA,T5;p.flags|=8192}}function oS(p,g){g!==null&&(p.flags|=4),p.flags&16384&&(g=p.tag!==22?$():536870912,p.lanes|=g,Wg|=g)}function mv(p,g){if(!is)switch(p.tailMode){case"hidden":g=p.tail;for(var _=null;g!==null;)g.alternate!==null&&(_=g),g=g.sibling;_===null?p.tail=null:_.sibling=null;break;case"collapsed":_=p.tail;for(var R=null;_!==null;)_.alternate!==null&&(R=_),_=_.sibling;R===null?g||p.tail===null?p.tail=null:p.tail.sibling=null:R.sibling=null}}function Js(p){var g=p.alternate!==null&&p.alternate.child===p.child,_=0,R=0;if(g)for(var j=p.child;j!==null;)_|=j.lanes|j.childLanes,R|=j.subtreeFlags&65011712,R|=j.flags&65011712,j.return=p,j=j.sibling;else for(j=p.child;j!==null;)_|=j.lanes|j.childLanes,R|=j.subtreeFlags,R|=j.flags,j.return=p,j=j.sibling;return p.subtreeFlags|=R,p.childLanes=_,g}function dfe(p,g,_){var R=g.pendingProps;switch(LA(g),g.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Js(g),null;case 1:return Js(g),null;case 3:return _=g.stateNode,R=null,p!==null&&(R=p.memoizedState.cache),g.memoizedState.cache!==R&&(g.flags|=2048),ud(Fi),Ce(),_.pendingContext&&(_.context=_.pendingContext,_.pendingContext=null),(p===null||p.child===null)&&(Jb(g)?pd(g):p===null||p.memoizedState.isDehydrated&&(g.flags&256)===0||(g.flags|=1024,_5())),Js(g),null;case 26:return _=g.memoizedState,p===null?(pd(g),_!==null?(Js(g),V8(g,_)):(Js(g),g.flags&=-16777217)):_?_!==p.memoizedState?(pd(g),Js(g),V8(g,_)):(Js(g),g.flags&=-16777217):(p.memoizedProps!==R&&pd(g),Js(g),g.flags&=-16777217),null;case 27:Qe(g),_=Oe.current;var j=g.type;if(p!==null&&g.stateNode!=null)p.memoizedProps!==R&&pd(g);else{if(!R){if(g.stateNode===null)throw Error(r(166));return Js(g),null}p=pe.current,Jb(g)?x5(g):(p=VL(j,R,_),g.stateNode=p,pd(g))}return Js(g),null;case 5:if(Qe(g),_=g.type,p!==null&&g.stateNode!=null)p.memoizedProps!==R&&pd(g);else{if(!R){if(g.stateNode===null)throw Error(r(166));return Js(g),null}if(p=pe.current,Jb(g))x5(g);else{switch(j=xS(Oe.current),p){case 1:p=j.createElementNS("http://www.w3.org/2000/svg",_);break;case 2:p=j.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;default:switch(_){case"svg":p=j.createElementNS("http://www.w3.org/2000/svg",_);break;case"math":p=j.createElementNS("http://www.w3.org/1998/Math/MathML",_);break;case"script":p=j.createElement("div"),p.innerHTML="<script><\/script>",p=p.removeChild(p.firstChild);break;case"select":p=typeof R.is=="string"?j.createElement("select",{is:R.is}):j.createElement("select"),R.multiple?p.multiple=!0:R.size&&(p.size=R.size);break;default:p=typeof R.is=="string"?j.createElement(_,{is:R.is}):j.createElement(_)}}p[xe]=g,p[De]=R;e:for(j=g.child;j!==null;){if(j.tag===5||j.tag===6)p.appendChild(j.stateNode);else if(j.tag!==4&&j.tag!==27&&j.child!==null){j.child.return=j,j=j.child;continue}if(j===g)break e;for(;j.sibling===null;){if(j.return===null||j.return===g)break e;j=j.return}j.sibling.return=j.return,j=j.sibling}g.stateNode=p;e:switch(ba(p,_,R),_){case"button":case"input":case"select":case"textarea":p=!!R.autoFocus;break e;case"img":p=!0;break e;default:p=!1}p&&pd(g)}}return Js(g),g.flags&=-16777217,null;case 6:if(p&&g.stateNode!=null)p.memoizedProps!==R&&pd(g);else{if(typeof R!="string"&&g.stateNode===null)throw Error(r(166));if(p=Oe.current,Jb(g)){if(p=g.stateNode,_=g.memoizedProps,R=null,j=Xa,j!==null)switch(j.tag){case 27:case 5:R=j.memoizedProps}p[xe]=g,p=!!(p.nodeValue===_||R!==null&&R.suppressHydrationWarning===!0||FL(p.nodeValue,_)),p||Np(g)}else p=xS(p).createTextNode(R),p[xe]=g,g.stateNode=p}return Js(g),null;case 13:if(R=g.memoizedState,p===null||p.memoizedState!==null&&p.memoizedState.dehydrated!==null){if(j=Jb(g),R!==null&&R.dehydrated!==null){if(p===null){if(!j)throw Error(r(318));if(j=g.memoizedState,j=j!==null?j.dehydrated:null,!j)throw Error(r(317));j[xe]=g}else Qb(),(g.flags&128)===0&&(g.memoizedState=null),g.flags|=4;Js(g),j=!1}else j=_5(),p!==null&&p.memoizedState!==null&&(p.memoizedState.hydrationErrors=j),j=!0;if(!j)return g.flags&256?(fd(g),g):(fd(g),null)}if(fd(g),(g.flags&128)!==0)return g.lanes=_,g;if(_=R!==null,p=p!==null&&p.memoizedState!==null,_){R=g.child,j=null,R.alternate!==null&&R.alternate.memoizedState!==null&&R.alternate.memoizedState.cachePool!==null&&(j=R.alternate.memoizedState.cachePool.pool);var q=null;R.memoizedState!==null&&R.memoizedState.cachePool!==null&&(q=R.memoizedState.cachePool.pool),q!==j&&(R.flags|=2048)}return _!==p&&_&&(g.child.flags|=8192),oS(g,g.updateQueue),Js(g),null;case 4:return Ce(),p===null&&ZR(g.stateNode.containerInfo),Js(g),null;case 10:return ud(g.type),Js(g),null;case 19:if(ee(Li),j=g.memoizedState,j===null)return Js(g),null;if(R=(g.flags&128)!==0,q=j.rendering,q===null)if(R)mv(j,!1);else{if(oi!==0||p!==null&&(p.flags&128)!==0)for(p=g.child;p!==null;){if(q=nS(p),q!==null){for(g.flags|=128,mv(j,!1),p=q.updateQueue,g.updateQueue=p,oS(g,p),g.subtreeFlags=0,p=_,_=g.child;_!==null;)b5(_,p),_=_.sibling;return re(Li,Li.current&1|2),g.child}p=p.sibling}j.tail!==null&&ce()>uS&&(g.flags|=128,R=!0,mv(j,!1),g.lanes=4194304)}else{if(!R)if(p=nS(q),p!==null){if(g.flags|=128,R=!0,p=p.updateQueue,g.updateQueue=p,oS(g,p),mv(j,!0),j.tail===null&&j.tailMode==="hidden"&&!q.alternate&&!is)return Js(g),null}else 2*ce()-j.renderingStartTime>uS&&_!==536870912&&(g.flags|=128,R=!0,mv(j,!1),g.lanes=4194304);j.isBackwards?(q.sibling=g.child,g.child=q):(p=j.last,p!==null?p.sibling=q:g.child=q,j.last=q)}return j.tail!==null?(g=j.tail,j.rendering=g,j.tail=g.sibling,j.renderingStartTime=ce(),g.sibling=null,p=Li.current,re(Li,R?p&1|2:p&1),g):(Js(g),null);case 22:case 23:return fd(g),JA(),R=g.memoizedState!==null,p!==null?p.memoizedState!==null!==R&&(g.flags|=8192):R&&(g.flags|=8192),R?(_&536870912)!==0&&(g.flags&128)===0&&(Js(g),g.subtreeFlags&6&&(g.flags|=8192)):Js(g),_=g.updateQueue,_!==null&&oS(g,_.retryQueue),_=null,p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(_=p.memoizedState.cachePool.pool),R=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(R=g.memoizedState.cachePool.pool),R!==_&&(g.flags|=2048),p!==null&&ee(jp),null;case 24:return _=null,p!==null&&(_=p.memoizedState.cache),g.memoizedState.cache!==_&&(g.flags|=2048),ud(Fi),Js(g),null;case 25:return null;case 30:return null}throw Error(r(156,g.tag))}function ffe(p,g){switch(LA(g),g.tag){case 1:return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 3:return ud(Fi),Ce(),p=g.flags,(p&65536)!==0&&(p&128)===0?(g.flags=p&-65537|128,g):null;case 26:case 27:case 5:return Qe(g),null;case 13:if(fd(g),p=g.memoizedState,p!==null&&p.dehydrated!==null){if(g.alternate===null)throw Error(r(340));Qb()}return p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 19:return ee(Li),null;case 4:return Ce(),null;case 10:return ud(g.type),null;case 22:case 23:return fd(g),JA(),p!==null&&ee(jp),p=g.flags,p&65536?(g.flags=p&-65537|128,g):null;case 24:return ud(Fi),null;case 25:return null;default:return null}}function W8(p,g){switch(LA(g),g.tag){case 3:ud(Fi),Ce();break;case 26:case 27:case 5:Qe(g);break;case 4:Ce();break;case 13:fd(g);break;case 19:ee(Li);break;case 10:ud(g.type);break;case 22:case 23:fd(g),JA(),p!==null&&ee(jp);break;case 24:ud(Fi)}}function gv(p,g){try{var _=g.updateQueue,R=_!==null?_.lastEffect:null;if(R!==null){var j=R.next;_=j;do{if((_.tag&p)===p){R=void 0;var q=_.create,he=_.inst;R=q(),he.destroy=R}_=_.next}while(_!==j)}}catch(Pe){Ms(g,g.return,Pe)}}function Wf(p,g,_){try{var R=g.updateQueue,j=R!==null?R.lastEffect:null;if(j!==null){var q=j.next;R=q;do{if((R.tag&p)===p){var he=R.inst,Pe=he.destroy;if(Pe!==void 0){he.destroy=void 0,j=g;var Ye=_,St=Pe;try{St()}catch(Dt){Ms(j,Ye,Dt)}}}R=R.next}while(R!==q)}}catch(Dt){Ms(g,g.return,Dt)}}function H8(p){var g=p.updateQueue;if(g!==null){var _=p.stateNode;try{j5(g,_)}catch(R){Ms(p,p.return,R)}}}function G8(p,g,_){_.props=Op(p.type,p.memoizedProps),_.state=p.memoizedState;try{_.componentWillUnmount()}catch(R){Ms(p,g,R)}}function yv(p,g){try{var _=p.ref;if(_!==null){switch(p.tag){case 26:case 27:case 5:var R=p.stateNode;break;case 30:R=p.stateNode;break;default:R=p.stateNode}typeof _=="function"?p.refCleanup=_(R):_.current=R}}catch(j){Ms(p,g,j)}}function tu(p,g){var _=p.ref,R=p.refCleanup;if(_!==null)if(typeof R=="function")try{R()}catch(j){Ms(p,g,j)}finally{p.refCleanup=null,p=p.alternate,p!=null&&(p.refCleanup=null)}else if(typeof _=="function")try{_(null)}catch(j){Ms(p,g,j)}else _.current=null}function K8(p){var g=p.type,_=p.memoizedProps,R=p.stateNode;try{e:switch(g){case"button":case"input":case"select":case"textarea":_.autoFocus&&R.focus();break e;case"img":_.src?R.src=_.src:_.srcSet&&(R.srcset=_.srcSet)}}catch(j){Ms(p,p.return,j)}}function ER(p,g,_){try{var R=p.stateNode;jfe(R,p.type,_,g),R[De]=g}catch(j){Ms(p,p.return,j)}}function Y8(p){return p.tag===5||p.tag===3||p.tag===26||p.tag===27&&Qf(p.type)||p.tag===4}function TR(p){e:for(;;){for(;p.sibling===null;){if(p.return===null||Y8(p.return))return null;p=p.return}for(p.sibling.return=p.return,p=p.sibling;p.tag!==5&&p.tag!==6&&p.tag!==18;){if(p.tag===27&&Qf(p.type)||p.flags&2||p.child===null||p.tag===4)continue e;p.child.return=p,p=p.child}if(!(p.flags&2))return p.stateNode}}function AR(p,g,_){var R=p.tag;if(R===5||R===6)p=p.stateNode,g?(_.nodeType===9?_.body:_.nodeName==="HTML"?_.ownerDocument.body:_).insertBefore(p,g):(g=_.nodeType===9?_.body:_.nodeName==="HTML"?_.ownerDocument.body:_,g.appendChild(p),_=_._reactRootContainer,_!=null||g.onclick!==null||(g.onclick=vS));else if(R!==4&&(R===27&&Qf(p.type)&&(_=p.stateNode,g=null),p=p.child,p!==null))for(AR(p,g,_),p=p.sibling;p!==null;)AR(p,g,_),p=p.sibling}function lS(p,g,_){var R=p.tag;if(R===5||R===6)p=p.stateNode,g?_.insertBefore(p,g):_.appendChild(p);else if(R!==4&&(R===27&&Qf(p.type)&&(_=p.stateNode),p=p.child,p!==null))for(lS(p,g,_),p=p.sibling;p!==null;)lS(p,g,_),p=p.sibling}function Z8(p){var g=p.stateNode,_=p.memoizedProps;try{for(var R=p.type,j=g.attributes;j.length;)g.removeAttributeNode(j[0]);ba(g,R,_),g[xe]=p,g[De]=_}catch(q){Ms(p,p.return,q)}}var md=!1,pi=!1,RR=!1,X8=typeof WeakSet=="function"?WeakSet:Set,ea=null;function hfe(p,g){if(p=p.containerInfo,QR=ES,p=me(p),Ne(p)){if("selectionStart"in p)var _={start:p.selectionStart,end:p.selectionEnd};else e:{_=(_=p.ownerDocument)&&_.defaultView||window;var R=_.getSelection&&_.getSelection();if(R&&R.rangeCount!==0){_=R.anchorNode;var j=R.anchorOffset,q=R.focusNode;R=R.focusOffset;try{_.nodeType,q.nodeType}catch{_=null;break e}var he=0,Pe=-1,Ye=-1,St=0,Dt=0,Bt=p,Et=null;t:for(;;){for(var Rt;Bt!==_||j!==0&&Bt.nodeType!==3||(Pe=he+j),Bt!==q||R!==0&&Bt.nodeType!==3||(Ye=he+R),Bt.nodeType===3&&(he+=Bt.nodeValue.length),(Rt=Bt.firstChild)!==null;)Et=Bt,Bt=Rt;for(;;){if(Bt===p)break t;if(Et===_&&++St===j&&(Pe=he),Et===q&&++Dt===R&&(Ye=he),(Rt=Bt.nextSibling)!==null)break;Bt=Et,Et=Bt.parentNode}Bt=Rt}_=Pe===-1||Ye===-1?null:{start:Pe,end:Ye}}else _=null}_=_||{start:0,end:0}}else _=null;for(eN={focusedElem:p,selectionRange:_},ES=!1,ea=g;ea!==null;)if(g=ea,p=g.child,(g.subtreeFlags&1024)!==0&&p!==null)p.return=g,ea=p;else for(;ea!==null;){switch(g=ea,q=g.alternate,p=g.flags,g.tag){case 0:break;case 11:case 15:break;case 1:if((p&1024)!==0&&q!==null){p=void 0,_=g,j=q.memoizedProps,q=q.memoizedState,R=_.stateNode;try{var or=Op(_.type,j,_.elementType===_.type);p=R.getSnapshotBeforeUpdate(or,q),R.__reactInternalSnapshotBeforeUpdate=p}catch(Gn){Ms(_,_.return,Gn)}}break;case 3:if((p&1024)!==0){if(p=g.stateNode.containerInfo,_=p.nodeType,_===9)rN(p);else if(_===1)switch(p.nodeName){case"HEAD":case"HTML":case"BODY":rN(p);break;default:p.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((p&1024)!==0)throw Error(r(163))}if(p=g.sibling,p!==null){p.return=g.return,ea=p;break}ea=g.return}}function J8(p,g,_){var R=_.flags;switch(_.tag){case 0:case 11:case 15:Hf(p,_),R&4&&gv(5,_);break;case 1:if(Hf(p,_),R&4)if(p=_.stateNode,g===null)try{p.componentDidMount()}catch(he){Ms(_,_.return,he)}else{var j=Op(_.type,g.memoizedProps);g=g.memoizedState;try{p.componentDidUpdate(j,g,p.__reactInternalSnapshotBeforeUpdate)}catch(he){Ms(_,_.return,he)}}R&64&&H8(_),R&512&&yv(_,_.return);break;case 3:if(Hf(p,_),R&64&&(p=_.updateQueue,p!==null)){if(g=null,_.child!==null)switch(_.child.tag){case 27:case 5:g=_.child.stateNode;break;case 1:g=_.child.stateNode}try{j5(p,g)}catch(he){Ms(_,_.return,he)}}break;case 27:g===null&&R&4&&Z8(_);case 26:case 5:Hf(p,_),g===null&&R&4&&K8(_),R&512&&yv(_,_.return);break;case 12:Hf(p,_);break;case 13:Hf(p,_),R&4&&tL(p,_),R&64&&(p=_.memoizedState,p!==null&&(p=p.dehydrated,p!==null&&(_=_fe.bind(null,_),$fe(p,_))));break;case 22:if(R=_.memoizedState!==null||md,!R){g=g!==null&&g.memoizedState!==null||pi,j=md;var q=pi;md=R,(pi=g)&&!q?Gf(p,_,(_.subtreeFlags&8772)!==0):Hf(p,_),md=j,pi=q}break;case 30:break;default:Hf(p,_)}}function Q8(p){var g=p.alternate;g!==null&&(p.alternate=null,Q8(g)),p.child=null,p.deletions=null,p.sibling=null,p.tag===5&&(g=p.stateNode,g!==null&&fn(g)),p.stateNode=null,p.return=null,p.dependencies=null,p.memoizedProps=null,p.memoizedState=null,p.pendingProps=null,p.stateNode=null,p.updateQueue=null}var Gs=null,wo=!1;function gd(p,g,_){for(_=_.child;_!==null;)eL(p,g,_),_=_.sibling}function eL(p,g,_){if(qt&&typeof qt.onCommitFiberUnmount=="function")try{qt.onCommitFiberUnmount(Pt,_)}catch{}switch(_.tag){case 26:pi||tu(_,g),gd(p,g,_),_.memoizedState?_.memoizedState.count--:_.stateNode&&(_=_.stateNode,_.parentNode.removeChild(_));break;case 27:pi||tu(_,g);var R=Gs,j=wo;Qf(_.type)&&(Gs=_.stateNode,wo=!1),gd(p,g,_),Ev(_.stateNode),Gs=R,wo=j;break;case 5:pi||tu(_,g);case 6:if(R=Gs,j=wo,Gs=null,gd(p,g,_),Gs=R,wo=j,Gs!==null)if(wo)try{(Gs.nodeType===9?Gs.body:Gs.nodeName==="HTML"?Gs.ownerDocument.body:Gs).removeChild(_.stateNode)}catch(q){Ms(_,g,q)}else try{Gs.removeChild(_.stateNode)}catch(q){Ms(_,g,q)}break;case 18:Gs!==null&&(wo?(p=Gs,UL(p.nodeType===9?p.body:p.nodeName==="HTML"?p.ownerDocument.body:p,_.stateNode),Pv(p)):UL(Gs,_.stateNode));break;case 4:R=Gs,j=wo,Gs=_.stateNode.containerInfo,wo=!0,gd(p,g,_),Gs=R,wo=j;break;case 0:case 11:case 14:case 15:pi||Wf(2,_,g),pi||Wf(4,_,g),gd(p,g,_);break;case 1:pi||(tu(_,g),R=_.stateNode,typeof R.componentWillUnmount=="function"&&G8(_,g,R)),gd(p,g,_);break;case 21:gd(p,g,_);break;case 22:pi=(R=pi)||_.memoizedState!==null,gd(p,g,_),pi=R;break;default:gd(p,g,_)}}function tL(p,g){if(g.memoizedState===null&&(p=g.alternate,p!==null&&(p=p.memoizedState,p!==null&&(p=p.dehydrated,p!==null))))try{Pv(p)}catch(_){Ms(g,g.return,_)}}function pfe(p){switch(p.tag){case 13:case 19:var g=p.stateNode;return g===null&&(g=p.stateNode=new X8),g;case 22:return p=p.stateNode,g=p._retryCache,g===null&&(g=p._retryCache=new X8),g;default:throw Error(r(435,p.tag))}}function NR(p,g){var _=pfe(p);g.forEach(function(R){var j=Sfe.bind(null,p,R);_.has(R)||(_.add(R),R.then(j,j))})}function Jo(p,g){var _=g.deletions;if(_!==null)for(var R=0;R<_.length;R++){var j=_[R],q=p,he=g,Pe=he;e:for(;Pe!==null;){switch(Pe.tag){case 27:if(Qf(Pe.type)){Gs=Pe.stateNode,wo=!1;break e}break;case 5:Gs=Pe.stateNode,wo=!1;break e;case 3:case 4:Gs=Pe.stateNode.containerInfo,wo=!0;break e}Pe=Pe.return}if(Gs===null)throw Error(r(160));eL(q,he,j),Gs=null,wo=!1,q=j.alternate,q!==null&&(q.return=null),j.return=null}if(g.subtreeFlags&13878)for(g=g.child;g!==null;)nL(g,p),g=g.sibling}var uc=null;function nL(p,g){var _=p.alternate,R=p.flags;switch(p.tag){case 0:case 11:case 14:case 15:Jo(g,p),Qo(p),R&4&&(Wf(3,p,p.return),gv(3,p),Wf(5,p,p.return));break;case 1:Jo(g,p),Qo(p),R&512&&(pi||_===null||tu(_,_.return)),R&64&&md&&(p=p.updateQueue,p!==null&&(R=p.callbacks,R!==null&&(_=p.shared.hiddenCallbacks,p.shared.hiddenCallbacks=_===null?R:_.concat(R))));break;case 26:var j=uc;if(Jo(g,p),Qo(p),R&512&&(pi||_===null||tu(_,_.return)),R&4){var q=_!==null?_.memoizedState:null;if(R=p.memoizedState,_===null)if(R===null)if(p.stateNode===null){e:{R=p.type,_=p.memoizedProps,j=j.ownerDocument||j;t:switch(R){case"title":q=j.getElementsByTagName("title")[0],(!q||q[nn]||q[xe]||q.namespaceURI==="http://www.w3.org/2000/svg"||q.hasAttribute("itemprop"))&&(q=j.createElement(R),j.head.insertBefore(q,j.querySelector("head > title"))),ba(q,R,_),q[xe]=p,kr(q),R=q;break e;case"link":var he=ZL("link","href",j).get(R+(_.href||""));if(he){for(var Pe=0;Pe<he.length;Pe++)if(q=he[Pe],q.getAttribute("href")===(_.href==null||_.href===""?null:_.href)&&q.getAttribute("rel")===(_.rel==null?null:_.rel)&&q.getAttribute("title")===(_.title==null?null:_.title)&&q.getAttribute("crossorigin")===(_.crossOrigin==null?null:_.crossOrigin)){he.splice(Pe,1);break t}}q=j.createElement(R),ba(q,R,_),j.head.appendChild(q);break;case"meta":if(he=ZL("meta","content",j).get(R+(_.content||""))){for(Pe=0;Pe<he.length;Pe++)if(q=he[Pe],q.getAttribute("content")===(_.content==null?null:""+_.content)&&q.getAttribute("name")===(_.name==null?null:_.name)&&q.getAttribute("property")===(_.property==null?null:_.property)&&q.getAttribute("http-equiv")===(_.httpEquiv==null?null:_.httpEquiv)&&q.getAttribute("charset")===(_.charSet==null?null:_.charSet)){he.splice(Pe,1);break t}}q=j.createElement(R),ba(q,R,_),j.head.appendChild(q);break;default:throw Error(r(468,R))}q[xe]=p,kr(q),R=q}p.stateNode=R}else XL(j,p.type,p.stateNode);else p.stateNode=YL(j,R,p.memoizedProps);else q!==R?(q===null?_.stateNode!==null&&(_=_.stateNode,_.parentNode.removeChild(_)):q.count--,R===null?XL(j,p.type,p.stateNode):YL(j,R,p.memoizedProps)):R===null&&p.stateNode!==null&&ER(p,p.memoizedProps,_.memoizedProps)}break;case 27:Jo(g,p),Qo(p),R&512&&(pi||_===null||tu(_,_.return)),_!==null&&R&4&&ER(p,p.memoizedProps,_.memoizedProps);break;case 5:if(Jo(g,p),Qo(p),R&512&&(pi||_===null||tu(_,_.return)),p.flags&32){j=p.stateNode;try{Af(j,"")}catch(Rt){Ms(p,p.return,Rt)}}R&4&&p.stateNode!=null&&(j=p.memoizedProps,ER(p,j,_!==null?_.memoizedProps:j)),R&1024&&(RR=!0);break;case 6:if(Jo(g,p),Qo(p),R&4){if(p.stateNode===null)throw Error(r(162));R=p.memoizedProps,_=p.stateNode;try{_.nodeValue=R}catch(Rt){Ms(p,p.return,Rt)}}break;case 3:if(SS=null,j=uc,uc=wS(g.containerInfo),Jo(g,p),uc=j,Qo(p),R&4&&_!==null&&_.memoizedState.isDehydrated)try{Pv(g.containerInfo)}catch(Rt){Ms(p,p.return,Rt)}RR&&(RR=!1,rL(p));break;case 4:R=uc,uc=wS(p.stateNode.containerInfo),Jo(g,p),Qo(p),uc=R;break;case 12:Jo(g,p),Qo(p);break;case 13:Jo(g,p),Qo(p),p.child.flags&8192&&p.memoizedState!==null!=(_!==null&&_.memoizedState!==null)&&(DR=ce()),R&4&&(R=p.updateQueue,R!==null&&(p.updateQueue=null,NR(p,R)));break;case 22:j=p.memoizedState!==null;var Ye=_!==null&&_.memoizedState!==null,St=md,Dt=pi;if(md=St||j,pi=Dt||Ye,Jo(g,p),pi=Dt,md=St,Qo(p),R&8192)e:for(g=p.stateNode,g._visibility=j?g._visibility&-2:g._visibility|1,j&&(_===null||Ye||md||pi||Dp(p)),_=null,g=p;;){if(g.tag===5||g.tag===26){if(_===null){Ye=_=g;try{if(q=Ye.stateNode,j)he=q.style,typeof he.setProperty=="function"?he.setProperty("display","none","important"):he.display="none";else{Pe=Ye.stateNode;var Bt=Ye.memoizedProps.style,Et=Bt!=null&&Bt.hasOwnProperty("display")?Bt.display:null;Pe.style.display=Et==null||typeof Et=="boolean"?"":(""+Et).trim()}}catch(Rt){Ms(Ye,Ye.return,Rt)}}}else if(g.tag===6){if(_===null){Ye=g;try{Ye.stateNode.nodeValue=j?"":Ye.memoizedProps}catch(Rt){Ms(Ye,Ye.return,Rt)}}}else if((g.tag!==22&&g.tag!==23||g.memoizedState===null||g===p)&&g.child!==null){g.child.return=g,g=g.child;continue}if(g===p)break e;for(;g.sibling===null;){if(g.return===null||g.return===p)break e;_===g&&(_=null),g=g.return}_===g&&(_=null),g.sibling.return=g.return,g=g.sibling}R&4&&(R=p.updateQueue,R!==null&&(_=R.retryQueue,_!==null&&(R.retryQueue=null,NR(p,_))));break;case 19:Jo(g,p),Qo(p),R&4&&(R=p.updateQueue,R!==null&&(p.updateQueue=null,NR(p,R)));break;case 30:break;case 21:break;default:Jo(g,p),Qo(p)}}function Qo(p){var g=p.flags;if(g&2){try{for(var _,R=p.return;R!==null;){if(Y8(R)){_=R;break}R=R.return}if(_==null)throw Error(r(160));switch(_.tag){case 27:var j=_.stateNode,q=TR(p);lS(p,q,j);break;case 5:var he=_.stateNode;_.flags&32&&(Af(he,""),_.flags&=-33);var Pe=TR(p);lS(p,Pe,he);break;case 3:case 4:var Ye=_.stateNode.containerInfo,St=TR(p);AR(p,St,Ye);break;default:throw Error(r(161))}}catch(Dt){Ms(p,p.return,Dt)}p.flags&=-3}g&4096&&(p.flags&=-4097)}function rL(p){if(p.subtreeFlags&1024)for(p=p.child;p!==null;){var g=p;rL(g),g.tag===5&&g.flags&1024&&g.stateNode.reset(),p=p.sibling}}function Hf(p,g){if(g.subtreeFlags&8772)for(g=g.child;g!==null;)J8(p,g.alternate,g),g=g.sibling}function Dp(p){for(p=p.child;p!==null;){var g=p;switch(g.tag){case 0:case 11:case 14:case 15:Wf(4,g,g.return),Dp(g);break;case 1:tu(g,g.return);var _=g.stateNode;typeof _.componentWillUnmount=="function"&&G8(g,g.return,_),Dp(g);break;case 27:Ev(g.stateNode);case 26:case 5:tu(g,g.return),Dp(g);break;case 22:g.memoizedState===null&&Dp(g);break;case 30:Dp(g);break;default:Dp(g)}p=p.sibling}}function Gf(p,g,_){for(_=_&&(g.subtreeFlags&8772)!==0,g=g.child;g!==null;){var R=g.alternate,j=p,q=g,he=q.flags;switch(q.tag){case 0:case 11:case 15:Gf(j,q,_),gv(4,q);break;case 1:if(Gf(j,q,_),R=q,j=R.stateNode,typeof j.componentDidMount=="function")try{j.componentDidMount()}catch(St){Ms(R,R.return,St)}if(R=q,j=R.updateQueue,j!==null){var Pe=R.stateNode;try{var Ye=j.shared.hiddenCallbacks;if(Ye!==null)for(j.shared.hiddenCallbacks=null,j=0;j<Ye.length;j++)I5(Ye[j],Pe)}catch(St){Ms(R,R.return,St)}}_&&he&64&&H8(q),yv(q,q.return);break;case 27:Z8(q);case 26:case 5:Gf(j,q,_),_&&R===null&&he&4&&K8(q),yv(q,q.return);break;case 12:Gf(j,q,_);break;case 13:Gf(j,q,_),_&&he&4&&tL(j,q);break;case 22:q.memoizedState===null&&Gf(j,q,_),yv(q,q.return);break;case 30:break;default:Gf(j,q,_)}g=g.sibling}}function MR(p,g){var _=null;p!==null&&p.memoizedState!==null&&p.memoizedState.cachePool!==null&&(_=p.memoizedState.cachePool.pool),p=null,g.memoizedState!==null&&g.memoizedState.cachePool!==null&&(p=g.memoizedState.cachePool.pool),p!==_&&(p!=null&&p.refCount++,_!=null&&nv(_))}function IR(p,g){p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&nv(p))}function nu(p,g,_,R){if(g.subtreeFlags&10256)for(g=g.child;g!==null;)sL(p,g,_,R),g=g.sibling}function sL(p,g,_,R){var j=g.flags;switch(g.tag){case 0:case 11:case 15:nu(p,g,_,R),j&2048&&gv(9,g);break;case 1:nu(p,g,_,R);break;case 3:nu(p,g,_,R),j&2048&&(p=null,g.alternate!==null&&(p=g.alternate.memoizedState.cache),g=g.memoizedState.cache,g!==p&&(g.refCount++,p!=null&&nv(p)));break;case 12:if(j&2048){nu(p,g,_,R),p=g.stateNode;try{var q=g.memoizedProps,he=q.id,Pe=q.onPostCommit;typeof Pe=="function"&&Pe(he,g.alternate===null?"mount":"update",p.passiveEffectDuration,-0)}catch(Ye){Ms(g,g.return,Ye)}}else nu(p,g,_,R);break;case 13:nu(p,g,_,R);break;case 23:break;case 22:q=g.stateNode,he=g.alternate,g.memoizedState!==null?q._visibility&2?nu(p,g,_,R):bv(p,g):q._visibility&2?nu(p,g,_,R):(q._visibility|=2,Ug(p,g,_,R,(g.subtreeFlags&10256)!==0)),j&2048&&MR(he,g);break;case 24:nu(p,g,_,R),j&2048&&IR(g.alternate,g);break;default:nu(p,g,_,R)}}function Ug(p,g,_,R,j){for(j=j&&(g.subtreeFlags&10256)!==0,g=g.child;g!==null;){var q=p,he=g,Pe=_,Ye=R,St=he.flags;switch(he.tag){case 0:case 11:case 15:Ug(q,he,Pe,Ye,j),gv(8,he);break;case 23:break;case 22:var Dt=he.stateNode;he.memoizedState!==null?Dt._visibility&2?Ug(q,he,Pe,Ye,j):bv(q,he):(Dt._visibility|=2,Ug(q,he,Pe,Ye,j)),j&&St&2048&&MR(he.alternate,he);break;case 24:Ug(q,he,Pe,Ye,j),j&&St&2048&&IR(he.alternate,he);break;default:Ug(q,he,Pe,Ye,j)}g=g.sibling}}function bv(p,g){if(g.subtreeFlags&10256)for(g=g.child;g!==null;){var _=p,R=g,j=R.flags;switch(R.tag){case 22:bv(_,R),j&2048&&MR(R.alternate,R);break;case 24:bv(_,R),j&2048&&IR(R.alternate,R);break;default:bv(_,R)}g=g.sibling}}var vv=8192;function qg(p){if(p.subtreeFlags&vv)for(p=p.child;p!==null;)iL(p),p=p.sibling}function iL(p){switch(p.tag){case 26:qg(p),p.flags&vv&&p.memoizedState!==null&&Qfe(uc,p.memoizedState,p.memoizedProps);break;case 5:qg(p);break;case 3:case 4:var g=uc;uc=wS(p.stateNode.containerInfo),qg(p),uc=g;break;case 22:p.memoizedState===null&&(g=p.alternate,g!==null&&g.memoizedState!==null?(g=vv,vv=16777216,qg(p),vv=g):qg(p));break;default:qg(p)}}function aL(p){var g=p.alternate;if(g!==null&&(p=g.child,p!==null)){g.child=null;do g=p.sibling,p.sibling=null,p=g;while(p!==null)}}function xv(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var _=0;_<g.length;_++){var R=g[_];ea=R,lL(R,p)}aL(p)}if(p.subtreeFlags&10256)for(p=p.child;p!==null;)oL(p),p=p.sibling}function oL(p){switch(p.tag){case 0:case 11:case 15:xv(p),p.flags&2048&&Wf(9,p,p.return);break;case 3:xv(p);break;case 12:xv(p);break;case 22:var g=p.stateNode;p.memoizedState!==null&&g._visibility&2&&(p.return===null||p.return.tag!==13)?(g._visibility&=-3,cS(p)):xv(p);break;default:xv(p)}}function cS(p){var g=p.deletions;if((p.flags&16)!==0){if(g!==null)for(var _=0;_<g.length;_++){var R=g[_];ea=R,lL(R,p)}aL(p)}for(p=p.child;p!==null;){switch(g=p,g.tag){case 0:case 11:case 15:Wf(8,g,g.return),cS(g);break;case 22:_=g.stateNode,_._visibility&2&&(_._visibility&=-3,cS(g));break;default:cS(g)}p=p.sibling}}function lL(p,g){for(;ea!==null;){var _=ea;switch(_.tag){case 0:case 11:case 15:Wf(8,_,g);break;case 23:case 22:if(_.memoizedState!==null&&_.memoizedState.cachePool!==null){var R=_.memoizedState.cachePool.pool;R!=null&&R.refCount++}break;case 24:nv(_.memoizedState.cache)}if(R=_.child,R!==null)R.return=_,ea=R;else e:for(_=p;ea!==null;){R=ea;var j=R.sibling,q=R.return;if(Q8(R),R===_){ea=null;break e}if(j!==null){j.return=q,ea=j;break e}ea=q}}}var mfe={getCacheForType:function(p){var g=Ra(Fi),_=g.data.get(p);return _===void 0&&(_=p(),g.data.set(p,_)),_}},gfe=typeof WeakMap=="function"?WeakMap:Map,ys=0,Os=null,Lr=null,Yr=0,bs=0,el=null,Kf=!1,Vg=!1,jR=!1,yd=0,oi=0,Yf=0,Fp=0,PR=0,Rl=0,Wg=0,wv=null,_o=null,OR=!1,DR=0,uS=1/0,dS=null,Zf=null,ya=0,Xf=null,Hg=null,Gg=0,FR=0,LR=null,cL=null,_v=0,BR=null;function tl(){if((ys&2)!==0&&Yr!==0)return Yr&-Yr;if(U.T!==null){var p=Pg;return p!==0?p:HR()}return Z()}function uL(){Rl===0&&(Rl=(Yr&536870912)===0||is?et():536870912);var p=Al.current;return p!==null&&(p.flags|=32),Rl}function nl(p,g,_){(p===Os&&(bs===2||bs===9)||p.cancelPendingCommit!==null)&&(Kg(p,0),Jf(p,Yr,Rl,!1)),tt(p,_),((ys&2)===0||p!==Os)&&(p===Os&&((ys&2)===0&&(Fp|=_),oi===4&&Jf(p,Yr,Rl,!1)),ru(p))}function dL(p,g,_){if((ys&6)!==0)throw Error(r(327));var R=!_&&(g&124)===0&&(g&p.expiredLanes)===0||le(p,g),j=R?vfe(p,g):UR(p,g,!0),q=R;do{if(j===0){Vg&&!R&&Jf(p,g,0,!1);break}else{if(_=p.current.alternate,q&&!yfe(_)){j=UR(p,g,!1),q=!1;continue}if(j===2){if(q=g,p.errorRecoveryDisabledLanes&q)var he=0;else he=p.pendingLanes&-536870913,he=he!==0?he:he&536870912?536870912:0;if(he!==0){g=he;e:{var Pe=p;j=wv;var Ye=Pe.current.memoizedState.isDehydrated;if(Ye&&(Kg(Pe,he).flags|=256),he=UR(Pe,he,!1),he!==2){if(jR&&!Ye){Pe.errorRecoveryDisabledLanes|=q,Fp|=q,j=4;break e}q=_o,_o=j,q!==null&&(_o===null?_o=q:_o.push.apply(_o,q))}j=he}if(q=!1,j!==2)continue}}if(j===1){Kg(p,0),Jf(p,g,0,!0);break}e:{switch(R=p,q=j,q){case 0:case 1:throw Error(r(345));case 4:if((g&4194048)!==g)break;case 6:Jf(R,g,Rl,!Kf);break e;case 2:_o=null;break;case 3:case 5:break;default:throw Error(r(329))}if((g&62914560)===g&&(j=DR+300-ce(),10<j)){if(Jf(R,g,Rl,!Kf),Ee(R,0,!0)!==0)break e;R.timeoutHandle=$L(fL.bind(null,R,_,_o,dS,OR,g,Rl,Fp,Wg,Kf,q,2,-0,0),j);break e}fL(R,_,_o,dS,OR,g,Rl,Fp,Wg,Kf,q,0,-0,0)}}break}while(!0);ru(p)}function fL(p,g,_,R,j,q,he,Pe,Ye,St,Dt,Bt,Et,Rt){if(p.timeoutHandle=-1,Bt=g.subtreeFlags,(Bt&8192||(Bt&16785408)===16785408)&&(Rv={stylesheets:null,count:0,unsuspend:Jfe},iL(g),Bt=ehe(),Bt!==null)){p.cancelPendingCommit=Bt(vL.bind(null,p,g,q,_,R,j,he,Pe,Ye,Dt,1,Et,Rt)),Jf(p,q,he,!St);return}vL(p,g,q,_,R,j,he,Pe,Ye)}function yfe(p){for(var g=p;;){var _=g.tag;if((_===0||_===11||_===15)&&g.flags&16384&&(_=g.updateQueue,_!==null&&(_=_.stores,_!==null)))for(var R=0;R<_.length;R++){var j=_[R],q=j.getSnapshot;j=j.value;try{if(!Aa(q(),j))return!1}catch{return!1}}if(_=g.child,g.subtreeFlags&16384&&_!==null)_.return=g,g=_;else{if(g===p)break;for(;g.sibling===null;){if(g.return===null||g.return===p)return!0;g=g.return}g.sibling.return=g.return,g=g.sibling}}return!0}function Jf(p,g,_,R){g&=~PR,g&=~Fp,p.suspendedLanes|=g,p.pingedLanes&=~g,R&&(p.warmLanes|=g),R=p.expirationTimes;for(var j=g;0<j;){var q=31-Ht(j),he=1<<q;R[q]=-1,j&=~he}_!==0&&_e(p,_,g)}function fS(){return(ys&6)===0?(Sv(0),!1):!0}function $R(){if(Lr!==null){if(bs===0)var p=Lr.return;else p=Lr,cd=Mp=null,rR(p),$g=null,hv=0,p=Lr;for(;p!==null;)W8(p.alternate,p),p=p.return;Lr=null}}function Kg(p,g){var _=p.timeoutHandle;_!==-1&&(p.timeoutHandle=-1,Ofe(_)),_=p.cancelPendingCommit,_!==null&&(p.cancelPendingCommit=null,_()),$R(),Os=p,Lr=_=ad(p.current,null),Yr=g,bs=0,el=null,Kf=!1,Vg=le(p,g),jR=!1,Wg=Rl=PR=Fp=Yf=oi=0,_o=wv=null,OR=!1,(g&8)!==0&&(g|=g&32);var R=p.entangledLanes;if(R!==0)for(p=p.entanglements,R&=g;0<R;){var j=31-Ht(R),q=1<<j;g|=p[j],R&=~q}return yd=g,ar(),_}function hL(p,g){jr=null,U.H=Q_,g===sv||g===q_?(g=N5(),bs=3):g===T5?(g=N5(),bs=4):bs=g===M8?8:g!==null&&typeof g=="object"&&typeof g.then=="function"?6:1,el=g,Lr===null&&(oi=1,sS(p,zn(g,p.current)))}function pL(){var p=U.H;return U.H=Q_,p===null?Q_:p}function mL(){var p=U.A;return U.A=mfe,p}function zR(){oi=4,Kf||(Yr&4194048)!==Yr&&Al.current!==null||(Vg=!0),(Yf&134217727)===0&&(Fp&134217727)===0||Os===null||Jf(Os,Yr,Rl,!1)}function UR(p,g,_){var R=ys;ys|=2;var j=pL(),q=mL();(Os!==p||Yr!==g)&&(dS=null,Kg(p,g)),g=!1;var he=oi;e:do try{if(bs!==0&&Lr!==null){var Pe=Lr,Ye=el;switch(bs){case 8:$R(),he=6;break e;case 3:case 2:case 9:case 6:Al.current===null&&(g=!0);var St=bs;if(bs=0,el=null,Yg(p,Pe,Ye,St),_&&Vg){he=0;break e}break;default:St=bs,bs=0,el=null,Yg(p,Pe,Ye,St)}}bfe(),he=oi;break}catch(Dt){hL(p,Dt)}while(!0);return g&&p.shellSuspendCounter++,cd=Mp=null,ys=R,U.H=j,U.A=q,Lr===null&&(Os=null,Yr=0,ar()),he}function bfe(){for(;Lr!==null;)gL(Lr)}function vfe(p,g){var _=ys;ys|=2;var R=pL(),j=mL();Os!==p||Yr!==g?(dS=null,uS=ce()+500,Kg(p,g)):Vg=le(p,g);e:do try{if(bs!==0&&Lr!==null){g=Lr;var q=el;t:switch(bs){case 1:bs=0,el=null,Yg(p,g,q,1);break;case 2:case 9:if(A5(q)){bs=0,el=null,yL(g);break}g=function(){bs!==2&&bs!==9||Os!==p||(bs=7),ru(p)},q.then(g,g);break e;case 3:bs=7;break e;case 4:bs=5;break e;case 7:A5(q)?(bs=0,el=null,yL(g)):(bs=0,el=null,Yg(p,g,q,7));break;case 5:var he=null;switch(Lr.tag){case 26:he=Lr.memoizedState;case 5:case 27:var Pe=Lr;if(!he||JL(he)){bs=0,el=null;var Ye=Pe.sibling;if(Ye!==null)Lr=Ye;else{var St=Pe.return;St!==null?(Lr=St,hS(St)):Lr=null}break t}}bs=0,el=null,Yg(p,g,q,5);break;case 6:bs=0,el=null,Yg(p,g,q,6);break;case 8:$R(),oi=6;break e;default:throw Error(r(462))}}xfe();break}catch(Dt){hL(p,Dt)}while(!0);return cd=Mp=null,U.H=R,U.A=j,ys=_,Lr!==null?0:(Os=null,Yr=0,ar(),oi)}function xfe(){for(;Lr!==null&&!ye();)gL(Lr)}function gL(p){var g=q8(p.alternate,p,yd);p.memoizedProps=p.pendingProps,g===null?hS(p):Lr=g}function yL(p){var g=p,_=g.alternate;switch(g.tag){case 15:case 0:g=F8(_,g,g.pendingProps,g.type,void 0,Yr);break;case 11:g=F8(_,g,g.pendingProps,g.type.render,g.ref,Yr);break;case 5:rR(g);default:W8(_,g),g=Lr=b5(g,yd),g=q8(_,g,yd)}p.memoizedProps=p.pendingProps,g===null?hS(p):Lr=g}function Yg(p,g,_,R){cd=Mp=null,rR(g),$g=null,hv=0;var j=g.return;try{if(cfe(p,j,g,_,Yr)){oi=1,sS(p,zn(_,p.current)),Lr=null;return}}catch(q){if(j!==null)throw Lr=j,q;oi=1,sS(p,zn(_,p.current)),Lr=null;return}g.flags&32768?(is||R===1?p=!0:Vg||(Yr&536870912)!==0?p=!1:(Kf=p=!0,(R===2||R===9||R===3||R===6)&&(R=Al.current,R!==null&&R.tag===13&&(R.flags|=16384))),bL(g,p)):hS(g)}function hS(p){var g=p;do{if((g.flags&32768)!==0){bL(g,Kf);return}p=g.return;var _=dfe(g.alternate,g,yd);if(_!==null){Lr=_;return}if(g=g.sibling,g!==null){Lr=g;return}Lr=g=p}while(g!==null);oi===0&&(oi=5)}function bL(p,g){do{var _=ffe(p.alternate,p);if(_!==null){_.flags&=32767,Lr=_;return}if(_=p.return,_!==null&&(_.flags|=32768,_.subtreeFlags=0,_.deletions=null),!g&&(p=p.sibling,p!==null)){Lr=p;return}Lr=p=_}while(p!==null);oi=6,Lr=null}function vL(p,g,_,R,j,q,he,Pe,Ye){p.cancelPendingCommit=null;do pS();while(ya!==0);if((ys&6)!==0)throw Error(r(327));if(g!==null){if(g===p.current)throw Error(r(177));if(q=g.lanes|g.childLanes,q|=ma,ve(p,_,q,he,Pe,Ye),p===Os&&(Lr=Os=null,Yr=0),Hg=g,Xf=p,Gg=_,FR=q,LR=j,cL=R,(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?(p.callbackNode=null,p.callbackPriority=0,Cfe(Be,function(){return CL(),null})):(p.callbackNode=null,p.callbackPriority=0),R=(g.flags&13878)!==0,(g.subtreeFlags&13878)!==0||R){R=U.T,U.T=null,j=V.p,V.p=2,he=ys,ys|=4;try{hfe(p,g,_)}finally{ys=he,V.p=j,U.T=R}}ya=1,xL(),wL(),_L()}}function xL(){if(ya===1){ya=0;var p=Xf,g=Hg,_=(g.flags&13878)!==0;if((g.subtreeFlags&13878)!==0||_){_=U.T,U.T=null;var R=V.p;V.p=2;var j=ys;ys|=4;try{nL(g,p);var q=eN,he=me(p.containerInfo),Pe=q.focusedElem,Ye=q.selectionRange;if(he!==Pe&&Pe&&Pe.ownerDocument&&ae(Pe.ownerDocument.documentElement,Pe)){if(Ye!==null&&Ne(Pe)){var St=Ye.start,Dt=Ye.end;if(Dt===void 0&&(Dt=St),"selectionStart"in Pe)Pe.selectionStart=St,Pe.selectionEnd=Math.min(Dt,Pe.value.length);else{var Bt=Pe.ownerDocument||document,Et=Bt&&Bt.defaultView||window;if(Et.getSelection){var Rt=Et.getSelection(),or=Pe.textContent.length,Gn=Math.min(Ye.start,or),Cs=Ye.end===void 0?Gn:Math.min(Ye.end,or);!Rt.extend&&Gn>Cs&&(he=Cs,Cs=Gn,Gn=he);var mt=ne(Pe,Gn),it=ne(Pe,Cs);if(mt&&it&&(Rt.rangeCount!==1||Rt.anchorNode!==mt.node||Rt.anchorOffset!==mt.offset||Rt.focusNode!==it.node||Rt.focusOffset!==it.offset)){var _t=Bt.createRange();_t.setStart(mt.node,mt.offset),Rt.removeAllRanges(),Gn>Cs?(Rt.addRange(_t),Rt.extend(it.node,it.offset)):(_t.setEnd(it.node,it.offset),Rt.addRange(_t))}}}}for(Bt=[],Rt=Pe;Rt=Rt.parentNode;)Rt.nodeType===1&&Bt.push({element:Rt,left:Rt.scrollLeft,top:Rt.scrollTop});for(typeof Pe.focus=="function"&&Pe.focus(),Pe=0;Pe<Bt.length;Pe++){var Lt=Bt[Pe];Lt.element.scrollLeft=Lt.left,Lt.element.scrollTop=Lt.top}}ES=!!QR,eN=QR=null}finally{ys=j,V.p=R,U.T=_}}p.current=g,ya=2}}function wL(){if(ya===2){ya=0;var p=Xf,g=Hg,_=(g.flags&8772)!==0;if((g.subtreeFlags&8772)!==0||_){_=U.T,U.T=null;var R=V.p;V.p=2;var j=ys;ys|=4;try{J8(p,g.alternate,g)}finally{ys=j,V.p=R,U.T=_}}ya=3}}function _L(){if(ya===4||ya===3){ya=0,Ie();var p=Xf,g=Hg,_=Gg,R=cL;(g.subtreeFlags&10256)!==0||(g.flags&10256)!==0?ya=5:(ya=0,Hg=Xf=null,SL(p,p.pendingLanes));var j=p.pendingLanes;if(j===0&&(Zf=null),fe(_),g=g.stateNode,qt&&typeof qt.onCommitFiberRoot=="function")try{qt.onCommitFiberRoot(Pt,g,void 0,(g.current.flags&128)===128)}catch{}if(R!==null){g=U.T,j=V.p,V.p=2,U.T=null;try{for(var q=p.onRecoverableError,he=0;he<R.length;he++){var Pe=R[he];q(Pe.value,{componentStack:Pe.stack})}}finally{U.T=g,V.p=j}}(Gg&3)!==0&&pS(),ru(p),j=p.pendingLanes,(_&4194090)!==0&&(j&42)!==0?p===BR?_v++:(_v=0,BR=p):_v=0,Sv(0)}}function SL(p,g){(p.pooledCacheLanes&=g)===0&&(g=p.pooledCache,g!=null&&(p.pooledCache=null,nv(g)))}function pS(p){return xL(),wL(),_L(),CL()}function CL(){if(ya!==5)return!1;var p=Xf,g=FR;FR=0;var _=fe(Gg),R=U.T,j=V.p;try{V.p=32>_?32:_,U.T=null,_=LR,LR=null;var q=Xf,he=Gg;if(ya=0,Hg=Xf=null,Gg=0,(ys&6)!==0)throw Error(r(331));var Pe=ys;if(ys|=4,oL(q.current),sL(q,q.current,he,_),ys=Pe,Sv(0,!1),qt&&typeof qt.onPostCommitFiberRoot=="function")try{qt.onPostCommitFiberRoot(Pt,q)}catch{}return!0}finally{V.p=j,U.T=R,SL(p,g)}}function kL(p,g,_){g=zn(_,g),g=yR(p.stateNode,g,2),p=zf(p,g,2),p!==null&&(tt(p,2),ru(p))}function Ms(p,g,_){if(p.tag===3)kL(p,p,_);else for(;g!==null;){if(g.tag===3){kL(g,p,_);break}else if(g.tag===1){var R=g.stateNode;if(typeof g.type.getDerivedStateFromError=="function"||typeof R.componentDidCatch=="function"&&(Zf===null||!Zf.has(R))){p=zn(_,p),_=R8(2),R=zf(g,_,2),R!==null&&(N8(_,R,g,p),tt(R,2),ru(R));break}}g=g.return}}function qR(p,g,_){var R=p.pingCache;if(R===null){R=p.pingCache=new gfe;var j=new Set;R.set(g,j)}else j=R.get(g),j===void 0&&(j=new Set,R.set(g,j));j.has(_)||(jR=!0,j.add(_),p=wfe.bind(null,p,g,_),g.then(p,p))}function wfe(p,g,_){var R=p.pingCache;R!==null&&R.delete(g),p.pingedLanes|=p.suspendedLanes&_,p.warmLanes&=~_,Os===p&&(Yr&_)===_&&(oi===4||oi===3&&(Yr&62914560)===Yr&&300>ce()-DR?(ys&2)===0&&Kg(p,0):PR|=_,Wg===Yr&&(Wg=0)),ru(p)}function EL(p,g){g===0&&(g=$()),p=cc(p,g),p!==null&&(tt(p,g),ru(p))}function _fe(p){var g=p.memoizedState,_=0;g!==null&&(_=g.retryLane),EL(p,_)}function Sfe(p,g){var _=0;switch(p.tag){case 13:var R=p.stateNode,j=p.memoizedState;j!==null&&(_=j.retryLane);break;case 19:R=p.stateNode;break;case 22:R=p.stateNode._retryCache;break;default:throw Error(r(314))}R!==null&&R.delete(g),EL(p,_)}function Cfe(p,g){return je(p,g)}var mS=null,Zg=null,VR=!1,gS=!1,WR=!1,Lp=0;function ru(p){p!==Zg&&p.next===null&&(Zg===null?mS=Zg=p:Zg=Zg.next=p),gS=!0,VR||(VR=!0,Efe())}function Sv(p,g){if(!WR&&gS){WR=!0;do for(var _=!1,R=mS;R!==null;){if(p!==0){var j=R.pendingLanes;if(j===0)var q=0;else{var he=R.suspendedLanes,Pe=R.pingedLanes;q=(1<<31-Ht(42|p)+1)-1,q&=j&~(he&~Pe),q=q&201326741?q&201326741|1:q?q|2:0}q!==0&&(_=!0,NL(R,q))}else q=Yr,q=Ee(R,R===Os?q:0,R.cancelPendingCommit!==null||R.timeoutHandle!==-1),(q&3)===0||le(R,q)||(_=!0,NL(R,q));R=R.next}while(_);WR=!1}}function kfe(){TL()}function TL(){gS=VR=!1;var p=0;Lp!==0&&(Pfe()&&(p=Lp),Lp=0);for(var g=ce(),_=null,R=mS;R!==null;){var j=R.next,q=AL(R,g);q===0?(R.next=null,_===null?mS=j:_.next=j,j===null&&(Zg=_)):(_=R,(p!==0||(q&3)!==0)&&(gS=!0)),R=j}Sv(p)}function AL(p,g){for(var _=p.suspendedLanes,R=p.pingedLanes,j=p.expirationTimes,q=p.pendingLanes&-62914561;0<q;){var he=31-Ht(q),Pe=1<<he,Ye=j[he];Ye===-1?((Pe&_)===0||(Pe&R)!==0)&&(j[he]=ft(Pe,g)):Ye<=g&&(p.expiredLanes|=Pe),q&=~Pe}if(g=Os,_=Yr,_=Ee(p,p===g?_:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),R=p.callbackNode,_===0||p===g&&(bs===2||bs===9)||p.cancelPendingCommit!==null)return R!==null&&R!==null&&Y(R),p.callbackNode=null,p.callbackPriority=0;if((_&3)===0||le(p,_)){if(g=_&-_,g===p.callbackPriority)return g;switch(R!==null&&Y(R),fe(_)){case 2:case 8:_=Me;break;case 32:_=Be;break;case 268435456:_=lt;break;default:_=Be}return R=RL.bind(null,p),_=je(_,R),p.callbackPriority=g,p.callbackNode=_,g}return R!==null&&R!==null&&Y(R),p.callbackPriority=2,p.callbackNode=null,2}function RL(p,g){if(ya!==0&&ya!==5)return p.callbackNode=null,p.callbackPriority=0,null;var _=p.callbackNode;if(pS()&&p.callbackNode!==_)return null;var R=Yr;return R=Ee(p,p===Os?R:0,p.cancelPendingCommit!==null||p.timeoutHandle!==-1),R===0?null:(dL(p,R,g),AL(p,ce()),p.callbackNode!=null&&p.callbackNode===_?RL.bind(null,p):null)}function NL(p,g){if(pS())return null;dL(p,g,!0)}function Efe(){Dfe(function(){(ys&6)!==0?je(se,kfe):TL()})}function HR(){return Lp===0&&(Lp=et()),Lp}function ML(p){return p==null||typeof p=="symbol"||typeof p=="boolean"?null:typeof p=="function"?p:Xu(""+p)}function IL(p,g){var _=g.ownerDocument.createElement("input");return _.name=g.name,_.value=g.value,p.id&&_.setAttribute("form",p.id),g.parentNode.insertBefore(_,g),p=new FormData(p),_.parentNode.removeChild(_),p}function Tfe(p,g,_,R,j){if(g==="submit"&&_&&_.stateNode===j){var q=ML((j[De]||null).action),he=R.submitter;he&&(g=(g=he[De]||null)?ML(g.formAction):he.getAttribute("formAction"),g!==null&&(q=g,he=null));var Pe=new gg("action","action",null,R,j);p.push({event:Pe,listeners:[{instance:null,listener:function(){if(R.defaultPrevented){if(Lp!==0){var Ye=he?IL(j,he):new FormData(j);fR(_,{pending:!0,data:Ye,method:j.method,action:q},null,Ye)}}else typeof q=="function"&&(Pe.preventDefault(),Ye=he?IL(j,he):new FormData(j),fR(_,{pending:!0,data:Ye,method:j.method,action:q},q,Ye))},currentTarget:j}]})}}for(var GR=0;GR<on.length;GR++){var KR=on[GR],Afe=KR.toLowerCase(),Rfe=KR[0].toUpperCase()+KR.slice(1);Kt(Afe,"on"+Rfe)}Kt(kt,"onAnimationEnd"),Kt(Nt,"onAnimationIteration"),Kt(Mt,"onAnimationStart"),Kt("dblclick","onDoubleClick"),Kt("focusin","onFocus"),Kt("focusout","onBlur"),Kt(Ot,"onTransitionRun"),Kt(Xt,"onTransitionStart"),Kt(rn,"onTransitionCancel"),Kt(Gt,"onTransitionEnd"),gn("onMouseEnter",["mouseout","mouseover"]),gn("onMouseLeave",["mouseout","mouseover"]),gn("onPointerEnter",["pointerout","pointerover"]),gn("onPointerLeave",["pointerout","pointerover"]),Vt("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Vt("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Vt("onBeforeInput",["compositionend","keypress","textInput","paste"]),Vt("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Vt("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Cv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Nfe=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(Cv));function jL(p,g){g=(g&4)!==0;for(var _=0;_<p.length;_++){var R=p[_],j=R.event;R=R.listeners;e:{var q=void 0;if(g)for(var he=R.length-1;0<=he;he--){var Pe=R[he],Ye=Pe.instance,St=Pe.currentTarget;if(Pe=Pe.listener,Ye!==q&&j.isPropagationStopped())break e;q=Pe,j.currentTarget=St;try{q(j)}catch(Dt){rS(Dt)}j.currentTarget=null,q=Ye}else for(he=0;he<R.length;he++){if(Pe=R[he],Ye=Pe.instance,St=Pe.currentTarget,Pe=Pe.listener,Ye!==q&&j.isPropagationStopped())break e;q=Pe,j.currentTarget=St;try{q(j)}catch(Dt){rS(Dt)}j.currentTarget=null,q=Ye}}}}function Br(p,g){var _=g[wt];_===void 0&&(_=g[wt]=new Set);var R=p+"__bubble";_.has(R)||(PL(g,p,2,!1),_.add(R))}function YR(p,g,_){var R=0;g&&(R|=4),PL(_,p,R,g)}var yS="_reactListening"+Math.random().toString(36).slice(2);function ZR(p){if(!p[yS]){p[yS]=!0,mn.forEach(function(_){_!=="selectionchange"&&(Nfe.has(_)||YR(_,!1,p),YR(_,!0,p))});var g=p.nodeType===9?p:p.ownerDocument;g===null||g[yS]||(g[yS]=!0,YR("selectionchange",!1,g))}}function PL(p,g,_,R){switch(sB(g)){case 2:var j=rhe;break;case 8:j=she;break;default:j=uN}_=j.bind(null,g,_,p),j=void 0,!Lb||g!=="touchstart"&&g!=="touchmove"&&g!=="wheel"||(j=!0),R?j!==void 0?p.addEventListener(g,_,{capture:!0,passive:j}):p.addEventListener(g,_,!0):j!==void 0?p.addEventListener(g,_,{passive:j}):p.addEventListener(g,_,!1)}function XR(p,g,_,R,j){var q=R;if((g&1)===0&&(g&2)===0&&R!==null)e:for(;;){if(R===null)return;var he=R.tag;if(he===3||he===4){var Pe=R.stateNode.containerInfo;if(Pe===j)break;if(he===4)for(he=R.return;he!==null;){var Ye=he.tag;if((Ye===3||Ye===4)&&he.stateNode.containerInfo===j)return;he=he.return}for(;Pe!==null;){if(he=br(Pe),he===null)return;if(Ye=he.tag,Ye===5||Ye===6||Ye===26||Ye===27){R=q=he;continue e}Pe=Pe.parentNode}}R=R.return}Nf(function(){var St=q,Dt=pg(_),Bt=[];e:{var Et=en.get(p);if(Et!==void 0){var Rt=gg,or=p;switch(p){case"keypress":if(jf(_)===0)break e;case"keydown":case"keyup":Rt=Cg;break;case"focusin":or="focus",Rt=Pf;break;case"focusout":or="blur",Rt=Pf;break;case"beforeblur":case"afterblur":Rt=Pf;break;case"click":if(_.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":Rt=vg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":Rt=E_;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":Rt=Wb;break;case kt:case Nt:case Mt:Rt=T_;break;case Gt:Rt=Hb;break;case"scroll":case"scrollend":Rt=yg;break;case"wheel":Rt=Eg;break;case"copy":case"cut":case"paste":Rt=_g;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":Rt=Vb;break;case"toggle":case"beforetoggle":Rt=N_}var Gn=(g&4)!==0,Cs=!Gn&&(p==="scroll"||p==="scrollend"),mt=Gn?Et!==null?Et+"Capture":null:Et;Gn=[];for(var it=St,_t;it!==null;){var Lt=it;if(_t=Lt.stateNode,Lt=Lt.tag,Lt!==5&&Lt!==26&&Lt!==27||_t===null||mt===null||(Lt=ed(it,mt),Lt!=null&&Gn.push(kv(it,Lt,_t))),Cs)break;it=it.return}0<Gn.length&&(Et=new Rt(Et,or,null,_,Dt),Bt.push({event:Et,listeners:Gn}))}}if((g&7)===0){e:{if(Et=p==="mouseover"||p==="pointerover",Rt=p==="mouseout"||p==="pointerout",Et&&_!==_l&&(or=_.relatedTarget||_.fromElement)&&(br(or)||or[He]))break e;if((Rt||Et)&&(Et=Dt.window===Dt?Dt:(Et=Dt.ownerDocument)?Et.defaultView||Et.parentWindow:window,Rt?(or=_.relatedTarget||_.toElement,Rt=St,or=or?br(or):null,or!==null&&(Cs=i(or),Gn=or.tag,or!==Cs||Gn!==5&&Gn!==27&&Gn!==6)&&(or=null)):(Rt=null,or=St),Rt!==or)){if(Gn=vg,Lt="onMouseLeave",mt="onMouseEnter",it="mouse",(p==="pointerout"||p==="pointerover")&&(Gn=Vb,Lt="onPointerLeave",mt="onPointerEnter",it="pointer"),Cs=Rt==null?Et:rs(Rt),_t=or==null?Et:rs(or),Et=new Gn(Lt,it+"leave",Rt,_,Dt),Et.target=Cs,Et.relatedTarget=_t,Lt=null,br(Dt)===St&&(Gn=new Gn(mt,it+"enter",or,_,Dt),Gn.target=_t,Gn.relatedTarget=Cs,Lt=Gn),Cs=Lt,Rt&&or)t:{for(Gn=Rt,mt=or,it=0,_t=Gn;_t;_t=Xg(_t))it++;for(_t=0,Lt=mt;Lt;Lt=Xg(Lt))_t++;for(;0<it-_t;)Gn=Xg(Gn),it--;for(;0<_t-it;)mt=Xg(mt),_t--;for(;it--;){if(Gn===mt||mt!==null&&Gn===mt.alternate)break t;Gn=Xg(Gn),mt=Xg(mt)}Gn=null}else Gn=null;Rt!==null&&OL(Bt,Et,Rt,Gn,!1),or!==null&&Cs!==null&&OL(Bt,Cs,or,Gn,!0)}}e:{if(Et=St?rs(St):window,Rt=Et.nodeName&&Et.nodeName.toLowerCase(),Rt==="select"||Rt==="input"&&Et.type==="file")var wn=kp;else if(Rg(Et))if(Cl)wn=Ff;else{wn=id;var Or=D_}else Rt=Et.nodeName,!Rt||Rt.toLowerCase()!=="input"||Et.type!=="checkbox"&&Et.type!=="radio"?St&&Fb(St.elementType)&&(wn=kp):wn=Xb;if(wn&&(wn=wn(p,St))){Zb(Bt,wn,_,Dt);break e}Or&&Or(p,Et,St),p==="focusout"&&St&&Et.type==="number"&&St.memoizedProps.value!=null&&Ef(Et,"number",Et.value)}switch(Or=St?rs(St):window,p){case"focusin":(Rg(Or)||Or.contentEditable==="true")&&(Ge=Or,st=St,at=null);break;case"focusout":at=st=Ge=null;break;case"mousedown":pt=!0;break;case"contextmenu":case"mouseup":case"dragend":pt=!1,Je(Bt,_,Dt);break;case"selectionchange":if(Le)break;case"keydown":case"keyup":Je(Bt,_,Dt)}var Dn;if(Sp)e:{switch(p){case"compositionstart":var Xn="onCompositionStart";break e;case"compositionend":Xn="onCompositionEnd";break e;case"compositionupdate":Xn="onCompositionUpdate";break e}Xn=void 0}else sd?Yb(p,_)&&(Xn="onCompositionEnd"):p==="keydown"&&_.keyCode===229&&(Xn="onCompositionStart");Xn&&(Tg&&_.locale!=="ko"&&(sd||Xn!=="onCompositionStart"?Xn==="onCompositionEnd"&&sd&&(Dn=If()):(Sl=Dt,mg="value"in Sl?Sl.value:Sl.textContent,sd=!0)),Or=bS(St,Xn),0<Or.length&&(Xn=new Sg(Xn,p,null,_,Dt),Bt.push({event:Xn,listeners:Or}),Dn?Xn.data=Dn:(Dn=I_(_),Dn!==null&&(Xn.data=Dn)))),(Dn=MA?j_(p,_):IA(p,_))&&(Xn=bS(St,"onBeforeInput"),0<Xn.length&&(Or=new Sg("onBeforeInput","beforeinput",null,_,Dt),Bt.push({event:Or,listeners:Xn}),Or.data=Dn)),Tfe(Bt,p,St,_,Dt)}jL(Bt,g)})}function kv(p,g,_){return{instance:p,listener:g,currentTarget:_}}function bS(p,g){for(var _=g+"Capture",R=[];p!==null;){var j=p,q=j.stateNode;if(j=j.tag,j!==5&&j!==26&&j!==27||q===null||(j=ed(p,_),j!=null&&R.unshift(kv(p,j,q)),j=ed(p,g),j!=null&&R.push(kv(p,j,q))),p.tag===3)return R;p=p.return}return[]}function Xg(p){if(p===null)return null;do p=p.return;while(p&&p.tag!==5&&p.tag!==27);return p||null}function OL(p,g,_,R,j){for(var q=g._reactName,he=[];_!==null&&_!==R;){var Pe=_,Ye=Pe.alternate,St=Pe.stateNode;if(Pe=Pe.tag,Ye!==null&&Ye===R)break;Pe!==5&&Pe!==26&&Pe!==27||St===null||(Ye=St,j?(St=ed(_,q),St!=null&&he.unshift(kv(_,St,Ye))):j||(St=ed(_,q),St!=null&&he.push(kv(_,St,Ye)))),_=_.return}he.length!==0&&p.push({event:g,listeners:he})}var Mfe=/\r\n?/g,Ife=/\u0000|\uFFFD/g;function DL(p){return(typeof p=="string"?p:""+p).replace(Mfe,`
`).replace(Ife,"")}function FL(p,g){return g=DL(g),DL(p)===g}function vS(){}function Ss(p,g,_,R,j,q){switch(_){case"children":typeof R=="string"?g==="body"||g==="textarea"&&R===""||Af(p,R):(typeof R=="number"||typeof R=="bigint")&&g!=="body"&&Af(p,""+R);break;case"className":Ga(p,"class",R);break;case"tabIndex":Ga(p,"tabindex",R);break;case"dir":case"role":case"viewBox":case"width":case"height":Ga(p,_,R);break;case"style":C_(p,R,q);break;case"data":if(g!=="object"){Ga(p,"data",R);break}case"src":case"href":if(R===""&&(g!=="a"||_!=="href")){p.removeAttribute(_);break}if(R==null||typeof R=="function"||typeof R=="symbol"||typeof R=="boolean"){p.removeAttribute(_);break}R=Xu(""+R),p.setAttribute(_,R);break;case"action":case"formAction":if(typeof R=="function"){p.setAttribute(_,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof q=="function"&&(_==="formAction"?(g!=="input"&&Ss(p,g,"name",j.name,j,null),Ss(p,g,"formEncType",j.formEncType,j,null),Ss(p,g,"formMethod",j.formMethod,j,null),Ss(p,g,"formTarget",j.formTarget,j,null)):(Ss(p,g,"encType",j.encType,j,null),Ss(p,g,"method",j.method,j,null),Ss(p,g,"target",j.target,j,null)));if(R==null||typeof R=="symbol"||typeof R=="boolean"){p.removeAttribute(_);break}R=Xu(""+R),p.setAttribute(_,R);break;case"onClick":R!=null&&(p.onclick=vS);break;case"onScroll":R!=null&&Br("scroll",p);break;case"onScrollEnd":R!=null&&Br("scrollend",p);break;case"dangerouslySetInnerHTML":if(R!=null){if(typeof R!="object"||!("__html"in R))throw Error(r(61));if(_=R.__html,_!=null){if(j.children!=null)throw Error(r(60));p.innerHTML=_}}break;case"multiple":p.multiple=R&&typeof R!="function"&&typeof R!="symbol";break;case"muted":p.muted=R&&typeof R!="function"&&typeof R!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(R==null||typeof R=="function"||typeof R=="boolean"||typeof R=="symbol"){p.removeAttribute("xlink:href");break}_=Xu(""+R),p.setAttributeNS("http://www.w3.org/1999/xlink","xlink:href",_);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":R!=null&&typeof R!="function"&&typeof R!="symbol"?p.setAttribute(_,""+R):p.removeAttribute(_);break;case"inert":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":R&&typeof R!="function"&&typeof R!="symbol"?p.setAttribute(_,""):p.removeAttribute(_);break;case"capture":case"download":R===!0?p.setAttribute(_,""):R!==!1&&R!=null&&typeof R!="function"&&typeof R!="symbol"?p.setAttribute(_,R):p.removeAttribute(_);break;case"cols":case"rows":case"size":case"span":R!=null&&typeof R!="function"&&typeof R!="symbol"&&!isNaN(R)&&1<=R?p.setAttribute(_,R):p.removeAttribute(_);break;case"rowSpan":case"start":R==null||typeof R=="function"||typeof R=="symbol"||isNaN(R)?p.removeAttribute(_):p.setAttribute(_,R);break;case"popover":Br("beforetoggle",p),Br("toggle",p),di(p,"popover",R);break;case"xlinkActuate":pa(p,"http://www.w3.org/1999/xlink","xlink:actuate",R);break;case"xlinkArcrole":pa(p,"http://www.w3.org/1999/xlink","xlink:arcrole",R);break;case"xlinkRole":pa(p,"http://www.w3.org/1999/xlink","xlink:role",R);break;case"xlinkShow":pa(p,"http://www.w3.org/1999/xlink","xlink:show",R);break;case"xlinkTitle":pa(p,"http://www.w3.org/1999/xlink","xlink:title",R);break;case"xlinkType":pa(p,"http://www.w3.org/1999/xlink","xlink:type",R);break;case"xmlBase":pa(p,"http://www.w3.org/XML/1998/namespace","xml:base",R);break;case"xmlLang":pa(p,"http://www.w3.org/XML/1998/namespace","xml:lang",R);break;case"xmlSpace":pa(p,"http://www.w3.org/XML/1998/namespace","xml:space",R);break;case"is":di(p,"is",R);break;case"innerText":case"textContent":break;default:(!(2<_.length)||_[0]!=="o"&&_[0]!=="O"||_[1]!=="n"&&_[1]!=="N")&&(_=Ya.get(_)||_,di(p,_,R))}}function JR(p,g,_,R,j,q){switch(_){case"style":C_(p,R,q);break;case"dangerouslySetInnerHTML":if(R!=null){if(typeof R!="object"||!("__html"in R))throw Error(r(61));if(_=R.__html,_!=null){if(j.children!=null)throw Error(r(60));p.innerHTML=_}}break;case"children":typeof R=="string"?Af(p,R):(typeof R=="number"||typeof R=="bigint")&&Af(p,""+R);break;case"onScroll":R!=null&&Br("scroll",p);break;case"onScrollEnd":R!=null&&Br("scrollend",p);break;case"onClick":R!=null&&(p.onclick=vS);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(!nt.hasOwnProperty(_))e:{if(_[0]==="o"&&_[1]==="n"&&(j=_.endsWith("Capture"),g=_.slice(2,j?_.length-7:void 0),q=p[De]||null,q=q!=null?q[_]:null,typeof q=="function"&&p.removeEventListener(g,q,j),typeof R=="function")){typeof q!="function"&&q!==null&&(_ in p?p[_]=null:p.hasAttribute(_)&&p.removeAttribute(_)),p.addEventListener(g,R,j);break e}_ in p?p[_]=R:R===!0?p.setAttribute(_,""):di(p,_,R)}}}function ba(p,g,_){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":Br("error",p),Br("load",p);var R=!1,j=!1,q;for(q in _)if(_.hasOwnProperty(q)){var he=_[q];if(he!=null)switch(q){case"src":R=!0;break;case"srcSet":j=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(r(137,g));default:Ss(p,g,q,he,_,null)}}j&&Ss(p,g,"srcSet",_.srcSet,_,null),R&&Ss(p,g,"src",_.src,_,null);return;case"input":Br("invalid",p);var Pe=q=he=j=null,Ye=null,St=null;for(R in _)if(_.hasOwnProperty(R)){var Dt=_[R];if(Dt!=null)switch(R){case"name":j=Dt;break;case"type":he=Dt;break;case"checked":Ye=Dt;break;case"defaultChecked":St=Dt;break;case"value":q=Dt;break;case"defaultValue":Pe=Dt;break;case"children":case"dangerouslySetInnerHTML":if(Dt!=null)throw Error(r(137,g));break;default:Ss(p,g,R,Dt,_,null)}}Ob(p,q,Pe,Ye,St,he,j,!1),Kc(p);return;case"select":Br("invalid",p),R=he=q=null;for(j in _)if(_.hasOwnProperty(j)&&(Pe=_[j],Pe!=null))switch(j){case"value":q=Pe;break;case"defaultValue":he=Pe;break;case"multiple":R=Pe;default:Ss(p,g,j,Pe,_,null)}g=q,_=he,p.multiple=!!R,g!=null?Zu(p,!!R,g,!1):_!=null&&Zu(p,!!R,_,!0);return;case"textarea":Br("invalid",p),q=j=R=null;for(he in _)if(_.hasOwnProperty(he)&&(Pe=_[he],Pe!=null))switch(he){case"value":R=Pe;break;case"defaultValue":j=Pe;break;case"children":q=Pe;break;case"dangerouslySetInnerHTML":if(Pe!=null)throw Error(r(91));break;default:Ss(p,g,he,Pe,_,null)}Db(p,R,j,q),Kc(p);return;case"option":for(Ye in _)if(_.hasOwnProperty(Ye)&&(R=_[Ye],R!=null))switch(Ye){case"selected":p.selected=R&&typeof R!="function"&&typeof R!="symbol";break;default:Ss(p,g,Ye,R,_,null)}return;case"dialog":Br("beforetoggle",p),Br("toggle",p),Br("cancel",p),Br("close",p);break;case"iframe":case"object":Br("load",p);break;case"video":case"audio":for(R=0;R<Cv.length;R++)Br(Cv[R],p);break;case"image":Br("error",p),Br("load",p);break;case"details":Br("toggle",p);break;case"embed":case"source":case"link":Br("error",p),Br("load",p);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(St in _)if(_.hasOwnProperty(St)&&(R=_[St],R!=null))switch(St){case"children":case"dangerouslySetInnerHTML":throw Error(r(137,g));default:Ss(p,g,St,R,_,null)}return;default:if(Fb(g)){for(Dt in _)_.hasOwnProperty(Dt)&&(R=_[Dt],R!==void 0&&JR(p,g,Dt,R,_,void 0));return}}for(Pe in _)_.hasOwnProperty(Pe)&&(R=_[Pe],R!=null&&Ss(p,g,Pe,R,_,null))}function jfe(p,g,_,R){switch(g){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var j=null,q=null,he=null,Pe=null,Ye=null,St=null,Dt=null;for(Rt in _){var Bt=_[Rt];if(_.hasOwnProperty(Rt)&&Bt!=null)switch(Rt){case"checked":break;case"value":break;case"defaultValue":Ye=Bt;default:R.hasOwnProperty(Rt)||Ss(p,g,Rt,null,R,Bt)}}for(var Et in R){var Rt=R[Et];if(Bt=_[Et],R.hasOwnProperty(Et)&&(Rt!=null||Bt!=null))switch(Et){case"type":q=Rt;break;case"name":j=Rt;break;case"checked":St=Rt;break;case"defaultChecked":Dt=Rt;break;case"value":he=Rt;break;case"defaultValue":Pe=Rt;break;case"children":case"dangerouslySetInnerHTML":if(Rt!=null)throw Error(r(137,g));break;default:Rt!==Bt&&Ss(p,g,Et,Rt,R,Bt)}}kf(p,he,Pe,Ye,St,Dt,q,j);return;case"select":Rt=he=Pe=Et=null;for(q in _)if(Ye=_[q],_.hasOwnProperty(q)&&Ye!=null)switch(q){case"value":break;case"multiple":Rt=Ye;default:R.hasOwnProperty(q)||Ss(p,g,q,null,R,Ye)}for(j in R)if(q=R[j],Ye=_[j],R.hasOwnProperty(j)&&(q!=null||Ye!=null))switch(j){case"value":Et=q;break;case"defaultValue":Pe=q;break;case"multiple":he=q;default:q!==Ye&&Ss(p,g,j,q,R,Ye)}g=Pe,_=he,R=Rt,Et!=null?Zu(p,!!_,Et,!1):!!R!=!!_&&(g!=null?Zu(p,!!_,g,!0):Zu(p,!!_,_?[]:"",!1));return;case"textarea":Rt=Et=null;for(Pe in _)if(j=_[Pe],_.hasOwnProperty(Pe)&&j!=null&&!R.hasOwnProperty(Pe))switch(Pe){case"value":break;case"children":break;default:Ss(p,g,Pe,null,R,j)}for(he in R)if(j=R[he],q=_[he],R.hasOwnProperty(he)&&(j!=null||q!=null))switch(he){case"value":Et=j;break;case"defaultValue":Rt=j;break;case"children":break;case"dangerouslySetInnerHTML":if(j!=null)throw Error(r(91));break;default:j!==q&&Ss(p,g,he,j,R,q)}Tf(p,Et,Rt);return;case"option":for(var or in _)if(Et=_[or],_.hasOwnProperty(or)&&Et!=null&&!R.hasOwnProperty(or))switch(or){case"selected":p.selected=!1;break;default:Ss(p,g,or,null,R,Et)}for(Ye in R)if(Et=R[Ye],Rt=_[Ye],R.hasOwnProperty(Ye)&&Et!==Rt&&(Et!=null||Rt!=null))switch(Ye){case"selected":p.selected=Et&&typeof Et!="function"&&typeof Et!="symbol";break;default:Ss(p,g,Ye,Et,R,Rt)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var Gn in _)Et=_[Gn],_.hasOwnProperty(Gn)&&Et!=null&&!R.hasOwnProperty(Gn)&&Ss(p,g,Gn,null,R,Et);for(St in R)if(Et=R[St],Rt=_[St],R.hasOwnProperty(St)&&Et!==Rt&&(Et!=null||Rt!=null))switch(St){case"children":case"dangerouslySetInnerHTML":if(Et!=null)throw Error(r(137,g));break;default:Ss(p,g,St,Et,R,Rt)}return;default:if(Fb(g)){for(var Cs in _)Et=_[Cs],_.hasOwnProperty(Cs)&&Et!==void 0&&!R.hasOwnProperty(Cs)&&JR(p,g,Cs,void 0,R,Et);for(Dt in R)Et=R[Dt],Rt=_[Dt],!R.hasOwnProperty(Dt)||Et===Rt||Et===void 0&&Rt===void 0||JR(p,g,Dt,Et,R,Rt);return}}for(var mt in _)Et=_[mt],_.hasOwnProperty(mt)&&Et!=null&&!R.hasOwnProperty(mt)&&Ss(p,g,mt,null,R,Et);for(Bt in R)Et=R[Bt],Rt=_[Bt],!R.hasOwnProperty(Bt)||Et===Rt||Et==null&&Rt==null||Ss(p,g,Bt,Et,R,Rt)}var QR=null,eN=null;function xS(p){return p.nodeType===9?p:p.ownerDocument}function LL(p){switch(p){case"http://www.w3.org/2000/svg":return 1;case"http://www.w3.org/1998/Math/MathML":return 2;default:return 0}}function BL(p,g){if(p===0)switch(g){case"svg":return 1;case"math":return 2;default:return 0}return p===1&&g==="foreignObject"?0:p}function tN(p,g){return p==="textarea"||p==="noscript"||typeof g.children=="string"||typeof g.children=="number"||typeof g.children=="bigint"||typeof g.dangerouslySetInnerHTML=="object"&&g.dangerouslySetInnerHTML!==null&&g.dangerouslySetInnerHTML.__html!=null}var nN=null;function Pfe(){var p=window.event;return p&&p.type==="popstate"?p===nN?!1:(nN=p,!0):(nN=null,!1)}var $L=typeof setTimeout=="function"?setTimeout:void 0,Ofe=typeof clearTimeout=="function"?clearTimeout:void 0,zL=typeof Promise=="function"?Promise:void 0,Dfe=typeof queueMicrotask=="function"?queueMicrotask:typeof zL<"u"?function(p){return zL.resolve(null).then(p).catch(Ffe)}:$L;function Ffe(p){setTimeout(function(){throw p})}function Qf(p){return p==="head"}function UL(p,g){var _=g,R=0,j=0;do{var q=_.nextSibling;if(p.removeChild(_),q&&q.nodeType===8)if(_=q.data,_==="/$"){if(0<R&&8>R){_=R;var he=p.ownerDocument;if(_&1&&Ev(he.documentElement),_&2&&Ev(he.body),_&4)for(_=he.head,Ev(_),he=_.firstChild;he;){var Pe=he.nextSibling,Ye=he.nodeName;he[nn]||Ye==="SCRIPT"||Ye==="STYLE"||Ye==="LINK"&&he.rel.toLowerCase()==="stylesheet"||_.removeChild(he),he=Pe}}if(j===0){p.removeChild(q),Pv(g);return}j--}else _==="$"||_==="$?"||_==="$!"?j++:R=_.charCodeAt(0)-48;else R=0;_=q}while(_);Pv(g)}function rN(p){var g=p.firstChild;for(g&&g.nodeType===10&&(g=g.nextSibling);g;){var _=g;switch(g=g.nextSibling,_.nodeName){case"HTML":case"HEAD":case"BODY":rN(_),fn(_);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(_.rel.toLowerCase()==="stylesheet")continue}p.removeChild(_)}}function Lfe(p,g,_,R){for(;p.nodeType===1;){var j=_;if(p.nodeName.toLowerCase()!==g.toLowerCase()){if(!R&&(p.nodeName!=="INPUT"||p.type!=="hidden"))break}else if(R){if(!p[nn])switch(g){case"meta":if(!p.hasAttribute("itemprop"))break;return p;case"link":if(q=p.getAttribute("rel"),q==="stylesheet"&&p.hasAttribute("data-precedence"))break;if(q!==j.rel||p.getAttribute("href")!==(j.href==null||j.href===""?null:j.href)||p.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin)||p.getAttribute("title")!==(j.title==null?null:j.title))break;return p;case"style":if(p.hasAttribute("data-precedence"))break;return p;case"script":if(q=p.getAttribute("src"),(q!==(j.src==null?null:j.src)||p.getAttribute("type")!==(j.type==null?null:j.type)||p.getAttribute("crossorigin")!==(j.crossOrigin==null?null:j.crossOrigin))&&q&&p.hasAttribute("async")&&!p.hasAttribute("itemprop"))break;return p;default:return p}}else if(g==="input"&&p.type==="hidden"){var q=j.name==null?null:""+j.name;if(j.type==="hidden"&&p.getAttribute("name")===q)return p}else return p;if(p=dc(p.nextSibling),p===null)break}return null}function Bfe(p,g,_){if(g==="")return null;for(;p.nodeType!==3;)if((p.nodeType!==1||p.nodeName!=="INPUT"||p.type!=="hidden")&&!_||(p=dc(p.nextSibling),p===null))return null;return p}function sN(p){return p.data==="$!"||p.data==="$?"&&p.ownerDocument.readyState==="complete"}function $fe(p,g){var _=p.ownerDocument;if(p.data!=="$?"||_.readyState==="complete")g();else{var R=function(){g(),_.removeEventListener("DOMContentLoaded",R)};_.addEventListener("DOMContentLoaded",R),p._reactRetry=R}}function dc(p){for(;p!=null;p=p.nextSibling){var g=p.nodeType;if(g===1||g===3)break;if(g===8){if(g=p.data,g==="$"||g==="$!"||g==="$?"||g==="F!"||g==="F")break;if(g==="/$")return null}}return p}var iN=null;function qL(p){p=p.previousSibling;for(var g=0;p;){if(p.nodeType===8){var _=p.data;if(_==="$"||_==="$!"||_==="$?"){if(g===0)return p;g--}else _==="/$"&&g++}p=p.previousSibling}return null}function VL(p,g,_){switch(g=xS(_),p){case"html":if(p=g.documentElement,!p)throw Error(r(452));return p;case"head":if(p=g.head,!p)throw Error(r(453));return p;case"body":if(p=g.body,!p)throw Error(r(454));return p;default:throw Error(r(451))}}function Ev(p){for(var g=p.attributes;g.length;)p.removeAttributeNode(g[0]);fn(p)}var Nl=new Map,WL=new Set;function wS(p){return typeof p.getRootNode=="function"?p.getRootNode():p.nodeType===9?p:p.ownerDocument}var bd=V.d;V.d={f:zfe,r:Ufe,D:qfe,C:Vfe,L:Wfe,m:Hfe,X:Kfe,S:Gfe,M:Yfe};function zfe(){var p=bd.f(),g=fS();return p||g}function Ufe(p){var g=Mr(p);g!==null&&g.tag===5&&g.type==="form"?d8(g):bd.r(p)}var Jg=typeof document>"u"?null:document;function HL(p,g,_){var R=Jg;if(R&&typeof g=="string"&&g){var j=Ea(g);j='link[rel="'+p+'"][href="'+j+'"]',typeof _=="string"&&(j+='[crossorigin="'+_+'"]'),WL.has(j)||(WL.add(j),p={rel:p,crossOrigin:_,href:g},R.querySelector(j)===null&&(g=R.createElement("link"),ba(g,"link",p),kr(g),R.head.appendChild(g)))}}function qfe(p){bd.D(p),HL("dns-prefetch",p,null)}function Vfe(p,g){bd.C(p,g),HL("preconnect",p,g)}function Wfe(p,g,_){bd.L(p,g,_);var R=Jg;if(R&&p&&g){var j='link[rel="preload"][as="'+Ea(g)+'"]';g==="image"&&_&&_.imageSrcSet?(j+='[imagesrcset="'+Ea(_.imageSrcSet)+'"]',typeof _.imageSizes=="string"&&(j+='[imagesizes="'+Ea(_.imageSizes)+'"]')):j+='[href="'+Ea(p)+'"]';var q=j;switch(g){case"style":q=Qg(p);break;case"script":q=e0(p)}Nl.has(q)||(p=u({rel:"preload",href:g==="image"&&_&&_.imageSrcSet?void 0:p,as:g},_),Nl.set(q,p),R.querySelector(j)!==null||g==="style"&&R.querySelector(Tv(q))||g==="script"&&R.querySelector(Av(q))||(g=R.createElement("link"),ba(g,"link",p),kr(g),R.head.appendChild(g)))}}function Hfe(p,g){bd.m(p,g);var _=Jg;if(_&&p){var R=g&&typeof g.as=="string"?g.as:"script",j='link[rel="modulepreload"][as="'+Ea(R)+'"][href="'+Ea(p)+'"]',q=j;switch(R){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":q=e0(p)}if(!Nl.has(q)&&(p=u({rel:"modulepreload",href:p},g),Nl.set(q,p),_.querySelector(j)===null)){switch(R){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(_.querySelector(Av(q)))return}R=_.createElement("link"),ba(R,"link",p),kr(R),_.head.appendChild(R)}}}function Gfe(p,g,_){bd.S(p,g,_);var R=Jg;if(R&&p){var j=ss(R).hoistableStyles,q=Qg(p);g=g||"default";var he=j.get(q);if(!he){var Pe={loading:0,preload:null};if(he=R.querySelector(Tv(q)))Pe.loading=5;else{p=u({rel:"stylesheet",href:p,"data-precedence":g},_),(_=Nl.get(q))&&aN(p,_);var Ye=he=R.createElement("link");kr(Ye),ba(Ye,"link",p),Ye._p=new Promise(function(St,Dt){Ye.onload=St,Ye.onerror=Dt}),Ye.addEventListener("load",function(){Pe.loading|=1}),Ye.addEventListener("error",function(){Pe.loading|=2}),Pe.loading|=4,_S(he,g,R)}he={type:"stylesheet",instance:he,count:1,state:Pe},j.set(q,he)}}}function Kfe(p,g){bd.X(p,g);var _=Jg;if(_&&p){var R=ss(_).hoistableScripts,j=e0(p),q=R.get(j);q||(q=_.querySelector(Av(j)),q||(p=u({src:p,async:!0},g),(g=Nl.get(j))&&oN(p,g),q=_.createElement("script"),kr(q),ba(q,"link",p),_.head.appendChild(q)),q={type:"script",instance:q,count:1,state:null},R.set(j,q))}}function Yfe(p,g){bd.M(p,g);var _=Jg;if(_&&p){var R=ss(_).hoistableScripts,j=e0(p),q=R.get(j);q||(q=_.querySelector(Av(j)),q||(p=u({src:p,async:!0,type:"module"},g),(g=Nl.get(j))&&oN(p,g),q=_.createElement("script"),kr(q),ba(q,"link",p),_.head.appendChild(q)),q={type:"script",instance:q,count:1,state:null},R.set(j,q))}}function GL(p,g,_,R){var j=(j=Oe.current)?wS(j):null;if(!j)throw Error(r(446));switch(p){case"meta":case"title":return null;case"style":return typeof _.precedence=="string"&&typeof _.href=="string"?(g=Qg(_.href),_=ss(j).hoistableStyles,R=_.get(g),R||(R={type:"style",instance:null,count:0,state:null},_.set(g,R)),R):{type:"void",instance:null,count:0,state:null};case"link":if(_.rel==="stylesheet"&&typeof _.href=="string"&&typeof _.precedence=="string"){p=Qg(_.href);var q=ss(j).hoistableStyles,he=q.get(p);if(he||(j=j.ownerDocument||j,he={type:"stylesheet",instance:null,count:0,state:{loading:0,preload:null}},q.set(p,he),(q=j.querySelector(Tv(p)))&&!q._p&&(he.instance=q,he.state.loading=5),Nl.has(p)||(_={rel:"preload",as:"style",href:_.href,crossOrigin:_.crossOrigin,integrity:_.integrity,media:_.media,hrefLang:_.hrefLang,referrerPolicy:_.referrerPolicy},Nl.set(p,_),q||Zfe(j,p,_,he.state))),g&&R===null)throw Error(r(528,""));return he}if(g&&R!==null)throw Error(r(529,""));return null;case"script":return g=_.async,_=_.src,typeof _=="string"&&g&&typeof g!="function"&&typeof g!="symbol"?(g=e0(_),_=ss(j).hoistableScripts,R=_.get(g),R||(R={type:"script",instance:null,count:0,state:null},_.set(g,R)),R):{type:"void",instance:null,count:0,state:null};default:throw Error(r(444,p))}}function Qg(p){return'href="'+Ea(p)+'"'}function Tv(p){return'link[rel="stylesheet"]['+p+"]"}function KL(p){return u({},p,{"data-precedence":p.precedence,precedence:null})}function Zfe(p,g,_,R){p.querySelector('link[rel="preload"][as="style"]['+g+"]")?R.loading=1:(g=p.createElement("link"),R.preload=g,g.addEventListener("load",function(){return R.loading|=1}),g.addEventListener("error",function(){return R.loading|=2}),ba(g,"link",_),kr(g),p.head.appendChild(g))}function e0(p){return'[src="'+Ea(p)+'"]'}function Av(p){return"script[async]"+p}function YL(p,g,_){if(g.count++,g.instance===null)switch(g.type){case"style":var R=p.querySelector('style[data-href~="'+Ea(_.href)+'"]');if(R)return g.instance=R,kr(R),R;var j=u({},_,{"data-href":_.href,"data-precedence":_.precedence,href:null,precedence:null});return R=(p.ownerDocument||p).createElement("style"),kr(R),ba(R,"style",j),_S(R,_.precedence,p),g.instance=R;case"stylesheet":j=Qg(_.href);var q=p.querySelector(Tv(j));if(q)return g.state.loading|=4,g.instance=q,kr(q),q;R=KL(_),(j=Nl.get(j))&&aN(R,j),q=(p.ownerDocument||p).createElement("link"),kr(q);var he=q;return he._p=new Promise(function(Pe,Ye){he.onload=Pe,he.onerror=Ye}),ba(q,"link",R),g.state.loading|=4,_S(q,_.precedence,p),g.instance=q;case"script":return q=e0(_.src),(j=p.querySelector(Av(q)))?(g.instance=j,kr(j),j):(R=_,(j=Nl.get(q))&&(R=u({},_),oN(R,j)),p=p.ownerDocument||p,j=p.createElement("script"),kr(j),ba(j,"link",R),p.head.appendChild(j),g.instance=j);case"void":return null;default:throw Error(r(443,g.type))}else g.type==="stylesheet"&&(g.state.loading&4)===0&&(R=g.instance,g.state.loading|=4,_S(R,_.precedence,p));return g.instance}function _S(p,g,_){for(var R=_.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),j=R.length?R[R.length-1]:null,q=j,he=0;he<R.length;he++){var Pe=R[he];if(Pe.dataset.precedence===g)q=Pe;else if(q!==j)break}q?q.parentNode.insertBefore(p,q.nextSibling):(g=_.nodeType===9?_.head:_,g.insertBefore(p,g.firstChild))}function aN(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.title==null&&(p.title=g.title)}function oN(p,g){p.crossOrigin==null&&(p.crossOrigin=g.crossOrigin),p.referrerPolicy==null&&(p.referrerPolicy=g.referrerPolicy),p.integrity==null&&(p.integrity=g.integrity)}var SS=null;function ZL(p,g,_){if(SS===null){var R=new Map,j=SS=new Map;j.set(_,R)}else j=SS,R=j.get(_),R||(R=new Map,j.set(_,R));if(R.has(p))return R;for(R.set(p,null),_=_.getElementsByTagName(p),j=0;j<_.length;j++){var q=_[j];if(!(q[nn]||q[xe]||p==="link"&&q.getAttribute("rel")==="stylesheet")&&q.namespaceURI!=="http://www.w3.org/2000/svg"){var he=q.getAttribute(g)||"";he=p+he;var Pe=R.get(he);Pe?Pe.push(q):R.set(he,[q])}}return R}function XL(p,g,_){p=p.ownerDocument||p,p.head.insertBefore(_,g==="title"?p.querySelector("head > title"):null)}function Xfe(p,g,_){if(_===1||g.itemProp!=null)return!1;switch(p){case"meta":case"title":return!0;case"style":if(typeof g.precedence!="string"||typeof g.href!="string"||g.href==="")break;return!0;case"link":if(typeof g.rel!="string"||typeof g.href!="string"||g.href===""||g.onLoad||g.onError)break;switch(g.rel){case"stylesheet":return p=g.disabled,typeof g.precedence=="string"&&p==null;default:return!0}case"script":if(g.async&&typeof g.async!="function"&&typeof g.async!="symbol"&&!g.onLoad&&!g.onError&&g.src&&typeof g.src=="string")return!0}return!1}function JL(p){return!(p.type==="stylesheet"&&(p.state.loading&3)===0)}var Rv=null;function Jfe(){}function Qfe(p,g,_){if(Rv===null)throw Error(r(475));var R=Rv;if(g.type==="stylesheet"&&(typeof _.media!="string"||matchMedia(_.media).matches!==!1)&&(g.state.loading&4)===0){if(g.instance===null){var j=Qg(_.href),q=p.querySelector(Tv(j));if(q){p=q._p,p!==null&&typeof p=="object"&&typeof p.then=="function"&&(R.count++,R=CS.bind(R),p.then(R,R)),g.state.loading|=4,g.instance=q,kr(q);return}q=p.ownerDocument||p,_=KL(_),(j=Nl.get(j))&&aN(_,j),q=q.createElement("link"),kr(q);var he=q;he._p=new Promise(function(Pe,Ye){he.onload=Pe,he.onerror=Ye}),ba(q,"link",_),g.instance=q}R.stylesheets===null&&(R.stylesheets=new Map),R.stylesheets.set(g,p),(p=g.state.preload)&&(g.state.loading&3)===0&&(R.count++,g=CS.bind(R),p.addEventListener("load",g),p.addEventListener("error",g))}}function ehe(){if(Rv===null)throw Error(r(475));var p=Rv;return p.stylesheets&&p.count===0&&lN(p,p.stylesheets),0<p.count?function(g){var _=setTimeout(function(){if(p.stylesheets&&lN(p,p.stylesheets),p.unsuspend){var R=p.unsuspend;p.unsuspend=null,R()}},6e4);return p.unsuspend=g,function(){p.unsuspend=null,clearTimeout(_)}}:null}function CS(){if(this.count--,this.count===0){if(this.stylesheets)lN(this,this.stylesheets);else if(this.unsuspend){var p=this.unsuspend;this.unsuspend=null,p()}}}var kS=null;function lN(p,g){p.stylesheets=null,p.unsuspend!==null&&(p.count++,kS=new Map,g.forEach(the,p),kS=null,CS.call(p))}function the(p,g){if(!(g.state.loading&4)){var _=kS.get(p);if(_)var R=_.get(null);else{_=new Map,kS.set(p,_);for(var j=p.querySelectorAll("link[data-precedence],style[data-precedence]"),q=0;q<j.length;q++){var he=j[q];(he.nodeName==="LINK"||he.getAttribute("media")!=="not all")&&(_.set(he.dataset.precedence,he),R=he)}R&&_.set(null,R)}j=g.instance,he=j.getAttribute("data-precedence"),q=_.get(he)||R,q===R&&_.set(null,j),_.set(he,j),this.count++,R=CS.bind(this),j.addEventListener("load",R),j.addEventListener("error",R),q?q.parentNode.insertBefore(j,q.nextSibling):(p=p.nodeType===9?p.head:p,p.insertBefore(j,p.firstChild)),g.state.loading|=4}}var Nv={$$typeof:S,Provider:null,Consumer:null,_currentValue:L,_currentValue2:L,_threadCount:0};function nhe(p,g,_,R,j,q,he,Pe){this.tag=1,this.containerInfo=p,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=Ue(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Ue(0),this.hiddenUpdates=Ue(null),this.identifierPrefix=R,this.onUncaughtError=j,this.onCaughtError=q,this.onRecoverableError=he,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=Pe,this.incompleteTransitions=new Map}function QL(p,g,_,R,j,q,he,Pe,Ye,St,Dt,Bt){return p=new nhe(p,g,_,he,Pe,Ye,St,Bt),g=1,q===!0&&(g|=24),q=Xo(3,null,null,g),p.current=q,q.stateNode=p,g=qA(),g.refCount++,p.pooledCache=g,g.refCount++,q.memoizedState={element:R,isDehydrated:_,cache:g},GA(q),p}function eB(p){return p?(p=Jc,p):Jc}function tB(p,g,_,R,j,q){j=eB(j),R.context===null?R.context=j:R.pendingContext=j,R=$f(g),R.payload={element:_},q=q===void 0?null:q,q!==null&&(R.callback=q),_=zf(p,R,g),_!==null&&(nl(_,p,g),av(_,p,g))}function nB(p,g){if(p=p.memoizedState,p!==null&&p.dehydrated!==null){var _=p.retryLane;p.retryLane=_!==0&&_<g?_:g}}function cN(p,g){nB(p,g),(p=p.alternate)&&nB(p,g)}function rB(p){if(p.tag===13){var g=cc(p,67108864);g!==null&&nl(g,p,67108864),cN(p,67108864)}}var ES=!0;function rhe(p,g,_,R){var j=U.T;U.T=null;var q=V.p;try{V.p=2,uN(p,g,_,R)}finally{V.p=q,U.T=j}}function she(p,g,_,R){var j=U.T;U.T=null;var q=V.p;try{V.p=8,uN(p,g,_,R)}finally{V.p=q,U.T=j}}function uN(p,g,_,R){if(ES){var j=dN(R);if(j===null)XR(p,g,R,TS,_),iB(p,R);else if(ahe(j,p,g,_,R))R.stopPropagation();else if(iB(p,R),g&4&&-1<ihe.indexOf(p)){for(;j!==null;){var q=Mr(j);if(q!==null)switch(q.tag){case 3:if(q=q.stateNode,q.current.memoizedState.isDehydrated){var he=ge(q.pendingLanes);if(he!==0){var Pe=q;for(Pe.pendingLanes|=2,Pe.entangledLanes|=2;he;){var Ye=1<<31-Ht(he);Pe.entanglements[1]|=Ye,he&=~Ye}ru(q),(ys&6)===0&&(uS=ce()+500,Sv(0))}}break;case 13:Pe=cc(q,2),Pe!==null&&nl(Pe,q,2),fS(),cN(q,2)}if(q=dN(R),q===null&&XR(p,g,R,TS,_),q===j)break;j=q}j!==null&&R.stopPropagation()}else XR(p,g,R,null,_)}}function dN(p){return p=pg(p),fN(p)}var TS=null;function fN(p){if(TS=null,p=br(p),p!==null){var g=i(p);if(g===null)p=null;else{var _=g.tag;if(_===13){if(p=a(g),p!==null)return p;p=null}else if(_===3){if(g.stateNode.current.memoizedState.isDehydrated)return g.tag===3?g.stateNode.containerInfo:null;p=null}else g!==p&&(p=null)}}return TS=p,null}function sB(p){switch(p){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 2;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 8;case"message":switch(oe()){case se:return 2;case Me:return 8;case Be:case Ae:return 32;case lt:return 268435456;default:return 32}default:return 32}}var hN=!1,eh=null,th=null,nh=null,Mv=new Map,Iv=new Map,rh=[],ihe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" ");function iB(p,g){switch(p){case"focusin":case"focusout":eh=null;break;case"dragenter":case"dragleave":th=null;break;case"mouseover":case"mouseout":nh=null;break;case"pointerover":case"pointerout":Mv.delete(g.pointerId);break;case"gotpointercapture":case"lostpointercapture":Iv.delete(g.pointerId)}}function jv(p,g,_,R,j,q){return p===null||p.nativeEvent!==q?(p={blockedOn:g,domEventName:_,eventSystemFlags:R,nativeEvent:q,targetContainers:[j]},g!==null&&(g=Mr(g),g!==null&&rB(g)),p):(p.eventSystemFlags|=R,g=p.targetContainers,j!==null&&g.indexOf(j)===-1&&g.push(j),p)}function ahe(p,g,_,R,j){switch(g){case"focusin":return eh=jv(eh,p,g,_,R,j),!0;case"dragenter":return th=jv(th,p,g,_,R,j),!0;case"mouseover":return nh=jv(nh,p,g,_,R,j),!0;case"pointerover":var q=j.pointerId;return Mv.set(q,jv(Mv.get(q)||null,p,g,_,R,j)),!0;case"gotpointercapture":return q=j.pointerId,Iv.set(q,jv(Iv.get(q)||null,p,g,_,R,j)),!0}return!1}function aB(p){var g=br(p.target);if(g!==null){var _=i(g);if(_!==null){if(g=_.tag,g===13){if(g=a(_),g!==null){p.blockedOn=g,G(p.priority,function(){if(_.tag===13){var R=tl();R=Ct(R);var j=cc(_,R);j!==null&&nl(j,_,R),cN(_,R)}});return}}else if(g===3&&_.stateNode.current.memoizedState.isDehydrated){p.blockedOn=_.tag===3?_.stateNode.containerInfo:null;return}}}p.blockedOn=null}function AS(p){if(p.blockedOn!==null)return!1;for(var g=p.targetContainers;0<g.length;){var _=dN(p.nativeEvent);if(_===null){_=p.nativeEvent;var R=new _.constructor(_.type,_);_l=R,_.target.dispatchEvent(R),_l=null}else return g=Mr(_),g!==null&&rB(g),p.blockedOn=_,!1;g.shift()}return!0}function oB(p,g,_){AS(p)&&_.delete(g)}function ohe(){hN=!1,eh!==null&&AS(eh)&&(eh=null),th!==null&&AS(th)&&(th=null),nh!==null&&AS(nh)&&(nh=null),Mv.forEach(oB),Iv.forEach(oB)}function RS(p,g){p.blockedOn===g&&(p.blockedOn=null,hN||(hN=!0,e.unstable_scheduleCallback(e.unstable_NormalPriority,ohe)))}var NS=null;function lB(p){NS!==p&&(NS=p,e.unstable_scheduleCallback(e.unstable_NormalPriority,function(){NS===p&&(NS=null);for(var g=0;g<p.length;g+=3){var _=p[g],R=p[g+1],j=p[g+2];if(typeof R!="function"){if(fN(R||_)===null)continue;break}var q=Mr(_);q!==null&&(p.splice(g,3),g-=3,fR(q,{pending:!0,data:j,method:_.method,action:R},R,j))}}))}function Pv(p){function g(Ye){return RS(Ye,p)}eh!==null&&RS(eh,p),th!==null&&RS(th,p),nh!==null&&RS(nh,p),Mv.forEach(g),Iv.forEach(g);for(var _=0;_<rh.length;_++){var R=rh[_];R.blockedOn===p&&(R.blockedOn=null)}for(;0<rh.length&&(_=rh[0],_.blockedOn===null);)aB(_),_.blockedOn===null&&rh.shift();if(_=(p.ownerDocument||p).$$reactFormReplay,_!=null)for(R=0;R<_.length;R+=3){var j=_[R],q=_[R+1],he=j[De]||null;if(typeof q=="function")he||lB(_);else if(he){var Pe=null;if(q&&q.hasAttribute("formAction")){if(j=q,he=q[De]||null)Pe=he.formAction;else if(fN(j)!==null)continue}else Pe=he.action;typeof Pe=="function"?_[R+1]=Pe:(_.splice(R,3),R-=3),lB(_)}}}function pN(p){this._internalRoot=p}MS.prototype.render=pN.prototype.render=function(p){var g=this._internalRoot;if(g===null)throw Error(r(409));var _=g.current,R=tl();tB(_,R,p,g,null,null)},MS.prototype.unmount=pN.prototype.unmount=function(){var p=this._internalRoot;if(p!==null){this._internalRoot=null;var g=p.containerInfo;tB(p.current,2,null,p,null,null),fS(),g[He]=null}};function MS(p){this._internalRoot=p}MS.prototype.unstable_scheduleHydration=function(p){if(p){var g=Z();p={blockedOn:null,target:p,priority:g};for(var _=0;_<rh.length&&g!==0&&g<rh[_].priority;_++);rh.splice(_,0,p),_===0&&aB(p)}};var cB=t.version;if(cB!=="19.1.0")throw Error(r(527,cB,"19.1.0"));V.findDOMNode=function(p){var g=p._reactInternals;if(g===void 0)throw typeof p.render=="function"?Error(r(188)):(p=Object.keys(p).join(","),Error(r(268,p)));return p=l(g),p=p!==null?c(p):null,p=p===null?null:p.stateNode,p};var lhe={bundleType:0,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:U,reconcilerVersion:"19.1.0"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var IS=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!IS.isDisabled&&IS.supportsFiber)try{Pt=IS.inject(lhe),qt=IS}catch{}}return Dv.createRoot=function(p,g){if(!s(p))throw Error(r(299));var _=!1,R="",j=k8,q=E8,he=T8,Pe=null;return g!=null&&(g.unstable_strictMode===!0&&(_=!0),g.identifierPrefix!==void 0&&(R=g.identifierPrefix),g.onUncaughtError!==void 0&&(j=g.onUncaughtError),g.onCaughtError!==void 0&&(q=g.onCaughtError),g.onRecoverableError!==void 0&&(he=g.onRecoverableError),g.unstable_transitionCallbacks!==void 0&&(Pe=g.unstable_transitionCallbacks)),g=QL(p,1,!1,null,null,_,R,j,q,he,Pe,null),p[He]=g.current,ZR(p),new pN(g)},Dv.hydrateRoot=function(p,g,_){if(!s(p))throw Error(r(299));var R=!1,j="",q=k8,he=E8,Pe=T8,Ye=null,St=null;return _!=null&&(_.unstable_strictMode===!0&&(R=!0),_.identifierPrefix!==void 0&&(j=_.identifierPrefix),_.onUncaughtError!==void 0&&(q=_.onUncaughtError),_.onCaughtError!==void 0&&(he=_.onCaughtError),_.onRecoverableError!==void 0&&(Pe=_.onRecoverableError),_.unstable_transitionCallbacks!==void 0&&(Ye=_.unstable_transitionCallbacks),_.formState!==void 0&&(St=_.formState)),g=QL(p,1,!0,g,_??null,R,j,q,he,Pe,Ye,St),g.context=eB(null),_=g.current,R=tl(),R=Ct(R),j=$f(R),j.callback=null,zf(_,j,R),_=R,g.current.lanes=_,tt(g,_),ru(g),p[He]=g.current,ZR(p),new MS(g)},Dv.version="19.1.0",Dv}var vB;function Che(){if(vB)return yN.exports;vB=1;function e(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}return e(),yN.exports=She(),yN.exports}var khe=Che();const Ehe=da(khe);function xB(e,t){if(typeof e=="function")return e(t);e!=null&&(e.current=t)}function pl(...e){return t=>{let n=!1;const r=e.map(s=>{const i=xB(s,t);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():xB(e[s],null)}}}}function In(...e){return E.useCallback(pl(...e),e)}function ju(e){const t=The(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(Rhe);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}var aH=ju("Slot");function The(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=Mhe(s),o=Nhe(i,s.props);return s.type!==E.Fragment&&(o.ref=r?pl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Ahe=Symbol("radix.slottable");function Rhe(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Ahe}function Nhe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{const l=i(...o);return s(...o),l}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function Mhe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function oH(e){var t,n,r="";if(typeof e=="string"||typeof e=="number")r+=e;else if(typeof e=="object")if(Array.isArray(e)){var s=e.length;for(t=0;t<s;t++)e[t]&&(n=oH(e[t]))&&(r&&(r+=" "),r+=n)}else for(n in e)e[n]&&(r&&(r+=" "),r+=n);return r}function lH(){for(var e,t,n=0,r="",s=arguments.length;n<s;n++)(e=arguments[n])&&(t=oH(e))&&(r&&(r+=" "),r+=t);return r}const wB=e=>typeof e=="boolean"?`${e}`:e===0?"0":e,_B=lH,UP=(e,t)=>n=>{var r;if((t==null?void 0:t.variants)==null)return _B(e,n==null?void 0:n.class,n==null?void 0:n.className);const{variants:s,defaultVariants:i}=t,a=Object.keys(s).map(c=>{const u=n==null?void 0:n[c],d=i==null?void 0:i[c];if(u===null)return null;const h=wB(u)||wB(d);return s[c][h]}),o=n&&Object.entries(n).reduce((c,u)=>{let[d,h]=u;return h===void 0||(c[d]=h),c},{}),l=t==null||(r=t.compoundVariants)===null||r===void 0?void 0:r.reduce((c,u)=>{let{class:d,className:h,...m}=u;return Object.entries(m).every(y=>{let[b,v]=y;return Array.isArray(v)?v.includes({...i,...o}[b]):{...i,...o}[b]===v})?[...c,d,h]:c},[]);return _B(e,a,l,n==null?void 0:n.class,n==null?void 0:n.className)},qP="-",Ihe=e=>{const t=Phe(e),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=e;return{getClassGroupId:a=>{const o=a.split(qP);return o[0]===""&&o.length!==1&&o.shift(),cH(o,t)||jhe(a)},getConflictingClassGroupIds:(a,o)=>{const l=n[a]||[];return o&&r[a]?[...l,...r[a]]:l}}},cH=(e,t)=>{var a;if(e.length===0)return t.classGroupId;const n=e[0],r=t.nextPart.get(n),s=r?cH(e.slice(1),r):void 0;if(s)return s;if(t.validators.length===0)return;const i=e.join(qP);return(a=t.validators.find(({validator:o})=>o(i)))==null?void 0:a.classGroupId},SB=/^\[(.+)\]$/,jhe=e=>{if(SB.test(e)){const t=SB.exec(e)[1],n=t==null?void 0:t.substring(0,t.indexOf(":"));if(n)return"arbitrary.."+n}},Phe=e=>{const{theme:t,classGroups:n}=e,r={nextPart:new Map,validators:[]};for(const s in n)J3(n[s],r,s,t);return r},J3=(e,t,n,r)=>{e.forEach(s=>{if(typeof s=="string"){const i=s===""?t:CB(t,s);i.classGroupId=n;return}if(typeof s=="function"){if(Ohe(s)){J3(s(r),t,n,r);return}t.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,a])=>{J3(a,CB(t,i),n,r)})})},CB=(e,t)=>{let n=e;return t.split(qP).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},Ohe=e=>e.isThemeGetter,Dhe=e=>{if(e<1)return{get:()=>{},set:()=>{}};let t=0,n=new Map,r=new Map;const s=(i,a)=>{n.set(i,a),t++,t>e&&(t=0,r=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return s(i,a),a},set(i,a){n.has(i)?n.set(i,a):s(i,a)}}},Q3="!",ej=":",Fhe=ej.length,Lhe=e=>{const{prefix:t,experimentalParseClassName:n}=e;let r=s=>{const i=[];let a=0,o=0,l=0,c;for(let y=0;y<s.length;y++){let b=s[y];if(a===0&&o===0){if(b===ej){i.push(s.slice(l,y)),l=y+Fhe;continue}if(b==="/"){c=y;continue}}b==="["?a++:b==="]"?a--:b==="("?o++:b===")"&&o--}const u=i.length===0?s:s.substring(l),d=Bhe(u),h=d!==u,m=c&&c>l?c-l:void 0;return{modifiers:i,hasImportantModifier:h,baseClassName:d,maybePostfixModifierPosition:m}};if(t){const s=t+ej,i=r;r=a=>a.startsWith(s)?i(a.substring(s.length)):{isExternal:!0,modifiers:[],hasImportantModifier:!1,baseClassName:a,maybePostfixModifierPosition:void 0}}if(n){const s=r;r=i=>n({className:i,parseClassName:s})}return r},Bhe=e=>e.endsWith(Q3)?e.substring(0,e.length-1):e.startsWith(Q3)?e.substring(1):e,$he=e=>{const t=Object.fromEntries(e.orderSensitiveModifiers.map(r=>[r,!0]));return r=>{if(r.length<=1)return r;const s=[];let i=[];return r.forEach(a=>{a[0]==="["||t[a]?(s.push(...i.sort(),a),i=[]):i.push(a)}),s.push(...i.sort()),s}},zhe=e=>({cache:Dhe(e.cacheSize),parseClassName:Lhe(e),sortModifiers:$he(e),...Ihe(e)}),Uhe=/\s+/,qhe=(e,t)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s,sortModifiers:i}=t,a=[],o=e.trim().split(Uhe);let l="";for(let c=o.length-1;c>=0;c-=1){const u=o[c],{isExternal:d,modifiers:h,hasImportantModifier:m,baseClassName:y,maybePostfixModifierPosition:b}=n(u);if(d){l=u+(l.length>0?" "+l:l);continue}let v=!!b,x=r(v?y.substring(0,b):y);if(!x){if(!v){l=u+(l.length>0?" "+l:l);continue}if(x=r(y),!x){l=u+(l.length>0?" "+l:l);continue}v=!1}const w=i(h).join(":"),S=m?w+Q3:w,k=S+x;if(a.includes(k))continue;a.push(k);const C=s(x,v);for(let T=0;T<C.length;++T){const A=C[T];a.push(S+A)}l=u+(l.length>0?" "+l:l)}return l};function Vhe(){let e=0,t,n,r="";for(;e<arguments.length;)(t=arguments[e++])&&(n=uH(t))&&(r&&(r+=" "),r+=n);return r}const uH=e=>{if(typeof e=="string")return e;let t,n="";for(let r=0;r<e.length;r++)e[r]&&(t=uH(e[r]))&&(n&&(n+=" "),n+=t);return n};function Whe(e,...t){let n,r,s,i=a;function a(l){const c=t.reduce((u,d)=>d(u),e());return n=zhe(c),r=n.cache.get,s=n.cache.set,i=o,o(l)}function o(l){const c=r(l);if(c)return c;const u=qhe(l,n);return s(l,u),u}return function(){return i(Vhe.apply(null,arguments))}}const Bi=e=>{const t=n=>n[e]||[];return t.isThemeGetter=!0,t},dH=/^\[(?:(\w[\w-]*):)?(.+)\]$/i,fH=/^\((?:(\w[\w-]*):)?(.+)\)$/i,Hhe=/^\d+\/\d+$/,Ghe=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Khe=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,Yhe=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Zhe=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,Xhe=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,t0=e=>Hhe.test(e),Pr=e=>!!e&&!Number.isNaN(Number(e)),ih=e=>!!e&&Number.isInteger(Number(e)),wN=e=>e.endsWith("%")&&Pr(e.slice(0,-1)),vd=e=>Ghe.test(e),Jhe=()=>!0,Qhe=e=>Khe.test(e)&&!Yhe.test(e),hH=()=>!1,epe=e=>Zhe.test(e),tpe=e=>Xhe.test(e),npe=e=>!_n(e)&&!Sn(e),rpe=e=>Vy(e,gH,hH),_n=e=>dH.test(e),Bp=e=>Vy(e,yH,Qhe),_N=e=>Vy(e,lpe,Pr),kB=e=>Vy(e,pH,hH),spe=e=>Vy(e,mH,tpe),jS=e=>Vy(e,bH,epe),Sn=e=>fH.test(e),Fv=e=>Wy(e,yH),ipe=e=>Wy(e,cpe),EB=e=>Wy(e,pH),ape=e=>Wy(e,gH),ope=e=>Wy(e,mH),PS=e=>Wy(e,bH,!0),Vy=(e,t,n)=>{const r=dH.exec(e);return r?r[1]?t(r[1]):n(r[2]):!1},Wy=(e,t,n=!1)=>{const r=fH.exec(e);return r?r[1]?t(r[1]):n:!1},pH=e=>e==="position"||e==="percentage",mH=e=>e==="image"||e==="url",gH=e=>e==="length"||e==="size"||e==="bg-size",yH=e=>e==="length",lpe=e=>e==="number",cpe=e=>e==="family-name",bH=e=>e==="shadow",upe=()=>{const e=Bi("color"),t=Bi("font"),n=Bi("text"),r=Bi("font-weight"),s=Bi("tracking"),i=Bi("leading"),a=Bi("breakpoint"),o=Bi("container"),l=Bi("spacing"),c=Bi("radius"),u=Bi("shadow"),d=Bi("inset-shadow"),h=Bi("text-shadow"),m=Bi("drop-shadow"),y=Bi("blur"),b=Bi("perspective"),v=Bi("aspect"),x=Bi("ease"),w=Bi("animate"),S=()=>["auto","avoid","all","avoid-page","page","left","right","column"],k=()=>["center","top","bottom","left","right","top-left","left-top","top-right","right-top","bottom-right","right-bottom","bottom-left","left-bottom"],C=()=>[...k(),Sn,_n],T=()=>["auto","hidden","clip","visible","scroll"],A=()=>["auto","contain","none"],N=()=>[Sn,_n,l],I=()=>[t0,"full","auto",...N()],O=()=>[ih,"none","subgrid",Sn,_n],B=()=>["auto",{span:["full",ih,Sn,_n]},ih,Sn,_n],D=()=>[ih,"auto",Sn,_n],H=()=>["auto","min","max","fr",Sn,_n],P=()=>["start","end","center","between","around","evenly","stretch","baseline","center-safe","end-safe"],K=()=>["start","end","center","stretch","center-safe","end-safe"],U=()=>["auto",...N()],V=()=>[t0,"auto","full","dvw","dvh","lvw","lvh","svw","svh","min","max","fit",...N()],L=()=>[e,Sn,_n],te=()=>[...k(),EB,kB,{position:[Sn,_n]}],W=()=>["no-repeat",{repeat:["","x","y","space","round"]}],Q=()=>["auto","cover","contain",ape,rpe,{size:[Sn,_n]}],ee=()=>[wN,Fv,Bp],re=()=>["","none","full",c,Sn,_n],pe=()=>["",Pr,Fv,Bp],de=()=>["solid","dashed","dotted","double"],Oe=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],Fe=()=>[Pr,wN,EB,kB],Se=()=>["","none",y,Sn,_n],Ce=()=>["none",Pr,Sn,_n],qe=()=>["none",Pr,Sn,_n],Qe=()=>[Pr,Sn,_n],We=()=>[t0,"full",...N()];return{cacheSize:500,theme:{animate:["spin","ping","pulse","bounce"],aspect:["video"],blur:[vd],breakpoint:[vd],color:[Jhe],container:[vd],"drop-shadow":[vd],ease:["in","out","in-out"],font:[npe],"font-weight":["thin","extralight","light","normal","medium","semibold","bold","extrabold","black"],"inset-shadow":[vd],leading:["none","tight","snug","normal","relaxed","loose"],perspective:["dramatic","near","normal","midrange","distant","none"],radius:[vd],shadow:[vd],spacing:["px",Pr],text:[vd],"text-shadow":[vd],tracking:["tighter","tight","normal","wide","wider","widest"]},classGroups:{aspect:[{aspect:["auto","square",t0,_n,Sn,v]}],container:["container"],columns:[{columns:[Pr,_n,Sn,o]}],"break-after":[{"break-after":S()}],"break-before":[{"break-before":S()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],sr:["sr-only","not-sr-only"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:C()}],overflow:[{overflow:T()}],"overflow-x":[{"overflow-x":T()}],"overflow-y":[{"overflow-y":T()}],overscroll:[{overscroll:A()}],"overscroll-x":[{"overscroll-x":A()}],"overscroll-y":[{"overscroll-y":A()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:I()}],"inset-x":[{"inset-x":I()}],"inset-y":[{"inset-y":I()}],start:[{start:I()}],end:[{end:I()}],top:[{top:I()}],right:[{right:I()}],bottom:[{bottom:I()}],left:[{left:I()}],visibility:["visible","invisible","collapse"],z:[{z:[ih,"auto",Sn,_n]}],basis:[{basis:[t0,"full","auto",o,...N()]}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["nowrap","wrap","wrap-reverse"]}],flex:[{flex:[Pr,t0,"auto","initial","none",_n]}],grow:[{grow:["",Pr,Sn,_n]}],shrink:[{shrink:["",Pr,Sn,_n]}],order:[{order:[ih,"first","last","none",Sn,_n]}],"grid-cols":[{"grid-cols":O()}],"col-start-end":[{col:B()}],"col-start":[{"col-start":D()}],"col-end":[{"col-end":D()}],"grid-rows":[{"grid-rows":O()}],"row-start-end":[{row:B()}],"row-start":[{"row-start":D()}],"row-end":[{"row-end":D()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":H()}],"auto-rows":[{"auto-rows":H()}],gap:[{gap:N()}],"gap-x":[{"gap-x":N()}],"gap-y":[{"gap-y":N()}],"justify-content":[{justify:[...P(),"normal"]}],"justify-items":[{"justify-items":[...K(),"normal"]}],"justify-self":[{"justify-self":["auto",...K()]}],"align-content":[{content:["normal",...P()]}],"align-items":[{items:[...K(),{baseline:["","last"]}]}],"align-self":[{self:["auto",...K(),{baseline:["","last"]}]}],"place-content":[{"place-content":P()}],"place-items":[{"place-items":[...K(),"baseline"]}],"place-self":[{"place-self":["auto",...K()]}],p:[{p:N()}],px:[{px:N()}],py:[{py:N()}],ps:[{ps:N()}],pe:[{pe:N()}],pt:[{pt:N()}],pr:[{pr:N()}],pb:[{pb:N()}],pl:[{pl:N()}],m:[{m:U()}],mx:[{mx:U()}],my:[{my:U()}],ms:[{ms:U()}],me:[{me:U()}],mt:[{mt:U()}],mr:[{mr:U()}],mb:[{mb:U()}],ml:[{ml:U()}],"space-x":[{"space-x":N()}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":N()}],"space-y-reverse":["space-y-reverse"],size:[{size:V()}],w:[{w:[o,"screen",...V()]}],"min-w":[{"min-w":[o,"screen","none",...V()]}],"max-w":[{"max-w":[o,"screen","none","prose",{screen:[a]},...V()]}],h:[{h:["screen",...V()]}],"min-h":[{"min-h":["screen","none",...V()]}],"max-h":[{"max-h":["screen",...V()]}],"font-size":[{text:["base",n,Fv,Bp]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:[r,Sn,_N]}],"font-stretch":[{"font-stretch":["ultra-condensed","extra-condensed","condensed","semi-condensed","normal","semi-expanded","expanded","extra-expanded","ultra-expanded",wN,_n]}],"font-family":[{font:[ipe,_n,t]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:[s,Sn,_n]}],"line-clamp":[{"line-clamp":[Pr,"none",Sn,_N]}],leading:[{leading:[i,...N()]}],"list-image":[{"list-image":["none",Sn,_n]}],"list-style-position":[{list:["inside","outside"]}],"list-style-type":[{list:["disc","decimal","none",Sn,_n]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"placeholder-color":[{placeholder:L()}],"text-color":[{text:L()}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...de(),"wavy"]}],"text-decoration-thickness":[{decoration:[Pr,"from-font","auto",Sn,Bp]}],"text-decoration-color":[{decoration:L()}],"underline-offset":[{"underline-offset":[Pr,"auto",Sn,_n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:N()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Sn,_n]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],wrap:[{wrap:["break-word","anywhere","normal"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Sn,_n]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:te()}],"bg-repeat":[{bg:W()}],"bg-size":[{bg:Q()}],"bg-image":[{bg:["none",{linear:[{to:["t","tr","r","br","b","bl","l","tl"]},ih,Sn,_n],radial:["",Sn,_n],conic:[ih,Sn,_n]},ope,spe]}],"bg-color":[{bg:L()}],"gradient-from-pos":[{from:ee()}],"gradient-via-pos":[{via:ee()}],"gradient-to-pos":[{to:ee()}],"gradient-from":[{from:L()}],"gradient-via":[{via:L()}],"gradient-to":[{to:L()}],rounded:[{rounded:re()}],"rounded-s":[{"rounded-s":re()}],"rounded-e":[{"rounded-e":re()}],"rounded-t":[{"rounded-t":re()}],"rounded-r":[{"rounded-r":re()}],"rounded-b":[{"rounded-b":re()}],"rounded-l":[{"rounded-l":re()}],"rounded-ss":[{"rounded-ss":re()}],"rounded-se":[{"rounded-se":re()}],"rounded-ee":[{"rounded-ee":re()}],"rounded-es":[{"rounded-es":re()}],"rounded-tl":[{"rounded-tl":re()}],"rounded-tr":[{"rounded-tr":re()}],"rounded-br":[{"rounded-br":re()}],"rounded-bl":[{"rounded-bl":re()}],"border-w":[{border:pe()}],"border-w-x":[{"border-x":pe()}],"border-w-y":[{"border-y":pe()}],"border-w-s":[{"border-s":pe()}],"border-w-e":[{"border-e":pe()}],"border-w-t":[{"border-t":pe()}],"border-w-r":[{"border-r":pe()}],"border-w-b":[{"border-b":pe()}],"border-w-l":[{"border-l":pe()}],"divide-x":[{"divide-x":pe()}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":pe()}],"divide-y-reverse":["divide-y-reverse"],"border-style":[{border:[...de(),"hidden","none"]}],"divide-style":[{divide:[...de(),"hidden","none"]}],"border-color":[{border:L()}],"border-color-x":[{"border-x":L()}],"border-color-y":[{"border-y":L()}],"border-color-s":[{"border-s":L()}],"border-color-e":[{"border-e":L()}],"border-color-t":[{"border-t":L()}],"border-color-r":[{"border-r":L()}],"border-color-b":[{"border-b":L()}],"border-color-l":[{"border-l":L()}],"divide-color":[{divide:L()}],"outline-style":[{outline:[...de(),"none","hidden"]}],"outline-offset":[{"outline-offset":[Pr,Sn,_n]}],"outline-w":[{outline:["",Pr,Fv,Bp]}],"outline-color":[{outline:L()}],shadow:[{shadow:["","none",u,PS,jS]}],"shadow-color":[{shadow:L()}],"inset-shadow":[{"inset-shadow":["none",d,PS,jS]}],"inset-shadow-color":[{"inset-shadow":L()}],"ring-w":[{ring:pe()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:L()}],"ring-offset-w":[{"ring-offset":[Pr,Bp]}],"ring-offset-color":[{"ring-offset":L()}],"inset-ring-w":[{"inset-ring":pe()}],"inset-ring-color":[{"inset-ring":L()}],"text-shadow":[{"text-shadow":["none",h,PS,jS]}],"text-shadow-color":[{"text-shadow":L()}],opacity:[{opacity:[Pr,Sn,_n]}],"mix-blend":[{"mix-blend":[...Oe(),"plus-darker","plus-lighter"]}],"bg-blend":[{"bg-blend":Oe()}],"mask-clip":[{"mask-clip":["border","padding","content","fill","stroke","view"]},"mask-no-clip"],"mask-composite":[{mask:["add","subtract","intersect","exclude"]}],"mask-image-linear-pos":[{"mask-linear":[Pr]}],"mask-image-linear-from-pos":[{"mask-linear-from":Fe()}],"mask-image-linear-to-pos":[{"mask-linear-to":Fe()}],"mask-image-linear-from-color":[{"mask-linear-from":L()}],"mask-image-linear-to-color":[{"mask-linear-to":L()}],"mask-image-t-from-pos":[{"mask-t-from":Fe()}],"mask-image-t-to-pos":[{"mask-t-to":Fe()}],"mask-image-t-from-color":[{"mask-t-from":L()}],"mask-image-t-to-color":[{"mask-t-to":L()}],"mask-image-r-from-pos":[{"mask-r-from":Fe()}],"mask-image-r-to-pos":[{"mask-r-to":Fe()}],"mask-image-r-from-color":[{"mask-r-from":L()}],"mask-image-r-to-color":[{"mask-r-to":L()}],"mask-image-b-from-pos":[{"mask-b-from":Fe()}],"mask-image-b-to-pos":[{"mask-b-to":Fe()}],"mask-image-b-from-color":[{"mask-b-from":L()}],"mask-image-b-to-color":[{"mask-b-to":L()}],"mask-image-l-from-pos":[{"mask-l-from":Fe()}],"mask-image-l-to-pos":[{"mask-l-to":Fe()}],"mask-image-l-from-color":[{"mask-l-from":L()}],"mask-image-l-to-color":[{"mask-l-to":L()}],"mask-image-x-from-pos":[{"mask-x-from":Fe()}],"mask-image-x-to-pos":[{"mask-x-to":Fe()}],"mask-image-x-from-color":[{"mask-x-from":L()}],"mask-image-x-to-color":[{"mask-x-to":L()}],"mask-image-y-from-pos":[{"mask-y-from":Fe()}],"mask-image-y-to-pos":[{"mask-y-to":Fe()}],"mask-image-y-from-color":[{"mask-y-from":L()}],"mask-image-y-to-color":[{"mask-y-to":L()}],"mask-image-radial":[{"mask-radial":[Sn,_n]}],"mask-image-radial-from-pos":[{"mask-radial-from":Fe()}],"mask-image-radial-to-pos":[{"mask-radial-to":Fe()}],"mask-image-radial-from-color":[{"mask-radial-from":L()}],"mask-image-radial-to-color":[{"mask-radial-to":L()}],"mask-image-radial-shape":[{"mask-radial":["circle","ellipse"]}],"mask-image-radial-size":[{"mask-radial":[{closest:["side","corner"],farthest:["side","corner"]}]}],"mask-image-radial-pos":[{"mask-radial-at":k()}],"mask-image-conic-pos":[{"mask-conic":[Pr]}],"mask-image-conic-from-pos":[{"mask-conic-from":Fe()}],"mask-image-conic-to-pos":[{"mask-conic-to":Fe()}],"mask-image-conic-from-color":[{"mask-conic-from":L()}],"mask-image-conic-to-color":[{"mask-conic-to":L()}],"mask-mode":[{mask:["alpha","luminance","match"]}],"mask-origin":[{"mask-origin":["border","padding","content","fill","stroke","view"]}],"mask-position":[{mask:te()}],"mask-repeat":[{mask:W()}],"mask-size":[{mask:Q()}],"mask-type":[{"mask-type":["alpha","luminance"]}],"mask-image":[{mask:["none",Sn,_n]}],filter:[{filter:["","none",Sn,_n]}],blur:[{blur:Se()}],brightness:[{brightness:[Pr,Sn,_n]}],contrast:[{contrast:[Pr,Sn,_n]}],"drop-shadow":[{"drop-shadow":["","none",m,PS,jS]}],"drop-shadow-color":[{"drop-shadow":L()}],grayscale:[{grayscale:["",Pr,Sn,_n]}],"hue-rotate":[{"hue-rotate":[Pr,Sn,_n]}],invert:[{invert:["",Pr,Sn,_n]}],saturate:[{saturate:[Pr,Sn,_n]}],sepia:[{sepia:["",Pr,Sn,_n]}],"backdrop-filter":[{"backdrop-filter":["","none",Sn,_n]}],"backdrop-blur":[{"backdrop-blur":Se()}],"backdrop-brightness":[{"backdrop-brightness":[Pr,Sn,_n]}],"backdrop-contrast":[{"backdrop-contrast":[Pr,Sn,_n]}],"backdrop-grayscale":[{"backdrop-grayscale":["",Pr,Sn,_n]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[Pr,Sn,_n]}],"backdrop-invert":[{"backdrop-invert":["",Pr,Sn,_n]}],"backdrop-opacity":[{"backdrop-opacity":[Pr,Sn,_n]}],"backdrop-saturate":[{"backdrop-saturate":[Pr,Sn,_n]}],"backdrop-sepia":[{"backdrop-sepia":["",Pr,Sn,_n]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":N()}],"border-spacing-x":[{"border-spacing-x":N()}],"border-spacing-y":[{"border-spacing-y":N()}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["","all","colors","opacity","shadow","transform","none",Sn,_n]}],"transition-behavior":[{transition:["normal","discrete"]}],duration:[{duration:[Pr,"initial",Sn,_n]}],ease:[{ease:["linear","initial",x,Sn,_n]}],delay:[{delay:[Pr,Sn,_n]}],animate:[{animate:["none",w,Sn,_n]}],backface:[{backface:["hidden","visible"]}],perspective:[{perspective:[b,Sn,_n]}],"perspective-origin":[{"perspective-origin":C()}],rotate:[{rotate:Ce()}],"rotate-x":[{"rotate-x":Ce()}],"rotate-y":[{"rotate-y":Ce()}],"rotate-z":[{"rotate-z":Ce()}],scale:[{scale:qe()}],"scale-x":[{"scale-x":qe()}],"scale-y":[{"scale-y":qe()}],"scale-z":[{"scale-z":qe()}],"scale-3d":["scale-3d"],skew:[{skew:Qe()}],"skew-x":[{"skew-x":Qe()}],"skew-y":[{"skew-y":Qe()}],transform:[{transform:[Sn,_n,"","none","gpu","cpu"]}],"transform-origin":[{origin:C()}],"transform-style":[{transform:["3d","flat"]}],translate:[{translate:We()}],"translate-x":[{"translate-x":We()}],"translate-y":[{"translate-y":We()}],"translate-z":[{"translate-z":We()}],"translate-none":["translate-none"],accent:[{accent:L()}],appearance:[{appearance:["none","auto"]}],"caret-color":[{caret:L()}],"color-scheme":[{scheme:["normal","dark","light","light-dark","only-dark","only-light"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Sn,_n]}],"field-sizing":[{"field-sizing":["fixed","content"]}],"pointer-events":[{"pointer-events":["auto","none"]}],resize:[{resize:["none","","y","x"]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":N()}],"scroll-mx":[{"scroll-mx":N()}],"scroll-my":[{"scroll-my":N()}],"scroll-ms":[{"scroll-ms":N()}],"scroll-me":[{"scroll-me":N()}],"scroll-mt":[{"scroll-mt":N()}],"scroll-mr":[{"scroll-mr":N()}],"scroll-mb":[{"scroll-mb":N()}],"scroll-ml":[{"scroll-ml":N()}],"scroll-p":[{"scroll-p":N()}],"scroll-px":[{"scroll-px":N()}],"scroll-py":[{"scroll-py":N()}],"scroll-ps":[{"scroll-ps":N()}],"scroll-pe":[{"scroll-pe":N()}],"scroll-pt":[{"scroll-pt":N()}],"scroll-pr":[{"scroll-pr":N()}],"scroll-pb":[{"scroll-pb":N()}],"scroll-pl":[{"scroll-pl":N()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Sn,_n]}],fill:[{fill:["none",...L()]}],"stroke-w":[{stroke:[Pr,Fv,Bp,_N]}],stroke:[{stroke:["none",...L()]}],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-x","border-w-y","border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-x","border-color-y","border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],translate:["translate-x","translate-y","translate-none"],"translate-none":["translate","translate-x","translate-y","translate-z"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]},orderSensitiveModifiers:["*","**","after","backdrop","before","details-content","file","first-letter","first-line","marker","placeholder","selection"]}},dpe=Whe(upe);function Ze(...e){return dpe(lH(e))}const tj=UP("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium transition-all disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg:not([class*='size-'])]:size-4 shrink-0 [&_svg]:shrink-0 outline-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",{variants:{variant:{default:"bg-primary text-primary-foreground shadow-xs hover:bg-primary/90",destructive:"bg-destructive text-white shadow-xs hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"border bg-background shadow-xs hover:bg-accent hover:text-accent-foreground dark:bg-input/30 dark:border-input dark:hover:bg-input/50",secondary:"bg-secondary text-secondary-foreground shadow-xs hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground dark:hover:bg-accent/50",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-9 px-4 py-2 has-[>svg]:px-3",sm:"h-8 rounded-md gap-1.5 px-3 has-[>svg]:px-2.5",lg:"h-10 rounded-md px-6 has-[>svg]:px-4",icon:"size-9"}},defaultVariants:{variant:"default",size:"default"}});function ct({className:e,variant:t,size:n,asChild:r=!1,...s}){const i=r?aH:"button";return f.jsx(i,{"data-slot":"button",className:Ze(tj({variant:t,size:n,className:e})),...s})}/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fpe=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),hpe=e=>e.replace(/^([A-Z])|[\s-_]+(\w)/g,(t,n,r)=>r?r.toUpperCase():n.toLowerCase()),TB=e=>{const t=hpe(e);return t.charAt(0).toUpperCase()+t.slice(1)},vH=(...e)=>e.filter((t,n,r)=>!!t&&t.trim()!==""&&r.indexOf(t)===n).join(" ").trim();/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var ppe={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mpe=E.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:a,...o},l)=>E.createElement("svg",{ref:l,...ppe,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:vH("lucide",s),...o},[...a.map(([c,u])=>E.createElement(c,u)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=(e,t)=>{const n=E.forwardRef(({className:r,...s},i)=>E.createElement(mpe,{ref:i,iconNode:t,className:vH(`lucide-${fpe(TB(e))}`,`lucide-${e}`,r),...s}));return n.displayName=TB(e),n};/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gpe=[["rect",{width:"20",height:"5",x:"2",y:"3",rx:"1",key:"1wp1u1"}],["path",{d:"M4 8v11a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8",key:"1s80jp"}],["path",{d:"M10 12h4",key:"a56b0p"}]],xH=zt("archive",gpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ype=[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]],wH=zt("arrow-down",ype);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bpe=[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]],vpe=zt("arrow-left",bpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xpe=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]],wpe=zt("arrow-right",xpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _pe=[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]],Spe=zt("arrow-up",_pe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cpe=[["path",{d:"m14 12-8.5 8.5a2.12 2.12 0 1 1-3-3L11 9",key:"csbz4o"}],["path",{d:"M15 13 9 7l4-4 6 6h3a8 8 0 0 1-7 7z",key:"113wfo"}]],kpe=zt("axe",Cpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Epe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]],Tpe=zt("ban",Epe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ape=[["path",{d:"M12 7v14",key:"1akyts"}],["path",{d:"M16 12h2",key:"7q9ll5"}],["path",{d:"M16 8h2",key:"msurwy"}],["path",{d:"M3 18a1 1 0 0 1-1-1V4a1 1 0 0 1 1-1h5a4 4 0 0 1 4 4 4 4 0 0 1 4-4h5a1 1 0 0 1 1 1v13a1 1 0 0 1-1 1h-6a3 3 0 0 0-3 3 3 3 0 0 0-3-3z",key:"ruj8y"}],["path",{d:"M6 12h2",key:"32wvfc"}],["path",{d:"M6 8h2",key:"30oboj"}]],Rpe=zt("book-open-text",Ape);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Npe=[["path",{d:"M12 8V4H8",key:"hb8ula"}],["rect",{width:"16",height:"12",x:"4",y:"8",rx:"2",key:"enze0r"}],["path",{d:"M2 14h2",key:"vft8re"}],["path",{d:"M20 14h2",key:"4cs60a"}],["path",{d:"M15 13v2",key:"1xurst"}],["path",{d:"M9 13v2",key:"rq6x2g"}]],ty=zt("bot",Npe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mpe=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M9 13a4.5 4.5 0 0 0 3-4",key:"10igwf"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M12 13h4",key:"1ku699"}],["path",{d:"M12 18h6a2 2 0 0 1 2 2v1",key:"105ag5"}],["path",{d:"M12 8h8",key:"1lhi5i"}],["path",{d:"M16 8V5a2 2 0 0 1 2-2",key:"u6izg6"}],["circle",{cx:"16",cy:"13",r:".5",key:"ry7gng"}],["circle",{cx:"18",cy:"3",r:".5",key:"1aiba7"}],["circle",{cx:"20",cy:"21",r:".5",key:"yhc1fs"}],["circle",{cx:"20",cy:"8",r:".5",key:"1e43v0"}]],Hy=zt("brain-circuit",Mpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ipe=[["path",{d:"M12 5a3 3 0 1 0-5.997.125 4 4 0 0 0-2.526 5.77 4 4 0 0 0 .556 6.588A4 4 0 1 0 12 18Z",key:"l5xja"}],["path",{d:"M12 5a3 3 0 1 1 5.997.125 4 4 0 0 1 2.526 5.77 4 4 0 0 1-.556 6.588A4 4 0 1 1 12 18Z",key:"ep3f8r"}],["path",{d:"M15 13a4.5 4.5 0 0 1-3-4 4.5 4.5 0 0 1-3 4",key:"1p4c4q"}],["path",{d:"M17.599 6.5a3 3 0 0 0 .399-1.375",key:"tmeiqw"}],["path",{d:"M6.003 5.125A3 3 0 0 0 6.401 6.5",key:"105sqy"}],["path",{d:"M3.477 10.896a4 4 0 0 1 .585-.396",key:"ql3yin"}],["path",{d:"M19.938 10.5a4 4 0 0 1 .585.396",key:"1qfode"}],["path",{d:"M6 18a4 4 0 0 1-1.967-.516",key:"2e4loj"}],["path",{d:"M19.967 17.484A4 4 0 0 1 18 18",key:"159ez6"}]],f2=zt("brain",Ipe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jpe=[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]],Ppe=zt("calendar",jpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ope=[["rect",{width:"18",height:"14",x:"3",y:"5",rx:"2",ry:"2",key:"12ruh7"}],["path",{d:"M7 15h4M15 15h2M7 11h2M13 11h4",key:"1ueiar"}]],Dpe=zt("captions",Ope);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fpe=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],co=zt("check",Fpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lpe=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],Ql=zt("chevron-down",Lpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bpe=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],$pe=zt("chevron-left",Bpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zpe=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],VP=zt("chevron-right",zpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Upe=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],Xh=zt("chevron-up",Upe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qpe=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],vE=zt("chevrons-up-down",qpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vpe=[["path",{d:"m17 11-5-5-5 5",key:"e8nh98"}],["path",{d:"m17 18-5-5-5 5",key:"2avn1x"}]],Wpe=zt("chevrons-up",Vpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]],Kl=zt("circle-alert",Hpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gpe=[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]],Kpe=zt("circle-check-big",Gpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ype=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]],xE=zt("circle-check",Ype);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["rect",{x:"9",y:"9",width:"6",height:"6",rx:"1",key:"1ssd4o"}]],Xpe=zt("circle-stop",Zpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jpe=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],Qpe=zt("circle",Jpe);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const eme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]],tme=zt("circle-x",eme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nme=[["rect",{width:"8",height:"4",x:"8",y:"2",rx:"1",ry:"1",key:"tgr4d6"}],["path",{d:"M16 4h2a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H6a2 2 0 0 1-2-2V6a2 2 0 0 1 2-2h2",key:"116196"}]],wE=zt("clipboard",nme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]],sme=zt("clock",rme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ime=[["path",{d:"M12 13v8",key:"1l5pq0"}],["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"m8 17 4-4 4 4",key:"1quai1"}]],WP=zt("cloud-upload",ime);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ame=[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]],_E=zt("code",ame);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ome=[["path",{d:"M12 20a8 8 0 1 0 0-16 8 8 0 0 0 0 16Z",key:"sobvz5"}],["path",{d:"M12 14a2 2 0 1 0 0-4 2 2 0 0 0 0 4Z",key:"11i496"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 22v-2",key:"1osdcq"}],["path",{d:"m17 20.66-1-1.73",key:"eq3orb"}],["path",{d:"M11 10.27 7 3.34",key:"16pf9h"}],["path",{d:"m20.66 17-1.73-1",key:"sg0v6f"}],["path",{d:"m3.34 7 1.73 1",key:"1ulond"}],["path",{d:"M14 12h8",key:"4f43i9"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"m20.66 7-1.73 1",key:"1ow05n"}],["path",{d:"m3.34 17 1.73-1",key:"nuk764"}],["path",{d:"m17 3.34-1 1.73",key:"2wel8s"}],["path",{d:"m11 13.73-4 6.93",key:"794ttg"}]],lme=zt("cog",ome);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cme=[["circle",{cx:"8",cy:"8",r:"6",key:"3yglwk"}],["path",{d:"M18.09 10.37A6 6 0 1 1 10.34 18",key:"t5s6rm"}],["path",{d:"M7 6h1v4",key:"1obek4"}],["path",{d:"m16.71 13.88.7.71-2.82 2.82",key:"1rbuyh"}]],ume=zt("coins",cme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dme=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],fme=zt("copy",dme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hme=[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]],pme=zt("dollar-sign",hme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mme=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]],Tc=zt("download",mme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gme=[["circle",{cx:"12",cy:"12",r:"1",key:"41hilf"}],["circle",{cx:"12",cy:"5",r:"1",key:"gxeob9"}],["circle",{cx:"12",cy:"19",r:"1",key:"lyex9k"}]],yme=zt("ellipsis-vertical",gme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bme=[["path",{d:"M10 12v-1",key:"v7bkov"}],["path",{d:"M10 18v-2",key:"1cjy8d"}],["path",{d:"M10 7V6",key:"dljcrl"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M15.5 22H18a2 2 0 0 0 2-2V7l-5-5H6a2 2 0 0 0-2 2v16a2 2 0 0 0 .274 1.01",key:"gkbcor"}],["circle",{cx:"10",cy:"20",r:"2",key:"1xzdoj"}]],vme=zt("file-archive",bme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 18v-6",key:"17g6i2"}],["path",{d:"m9 15 3 3 3-3",key:"1npd3o"}]],wme=zt("file-down",xme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _me=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 12a1 1 0 0 0-1 1v1a1 1 0 0 1-1 1 1 1 0 0 1 1 1v1a1 1 0 0 0 1 1",key:"1oajmo"}],["path",{d:"M14 18a1 1 0 0 0 1-1v-1a1 1 0 0 1 1-1 1 1 0 0 1-1-1v-1a1 1 0 0 0-1-1",key:"mpwhp6"}]],Sme=zt("file-json",_me);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cme=[["path",{d:"M12 17h.01",key:"p32p05"}],["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7z",key:"1mlx9k"}],["path",{d:"M9.1 9a3 3 0 0 1 5.82 1c0 2-3 3-3 3",key:"mhlwft"}]],kme=zt("file-question",Cme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Eme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]],nj=zt("file-text",Eme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M12 12v6",key:"3ahymv"}],["path",{d:"m15 15-3-3-3 3",key:"15xj92"}]],Ame=zt("file-up",Tme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rme=[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}]],_H=zt("file",Rme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nme=[["circle",{cx:"12",cy:"13",r:"2",key:"1c1ljs"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M14 13h3",key:"1dgedf"}],["path",{d:"M7 13h3",key:"1pygq7"}]],SH=zt("folder-git",Nme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mme=[["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"M9 13h6",key:"1uhe8q"}],["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],CH=zt("folder-plus",Mme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ime=[["path",{d:"M20 10a1 1 0 0 0 1-1V6a1 1 0 0 0-1-1h-2.5a1 1 0 0 1-.8-.4l-.9-1.2A1 1 0 0 0 15 3h-2a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"hod4my"}],["path",{d:"M20 21a1 1 0 0 0 1-1v-3a1 1 0 0 0-1-1h-2.9a1 1 0 0 1-.88-.55l-.42-.85a1 1 0 0 0-.92-.6H13a1 1 0 0 0-1 1v5a1 1 0 0 0 1 1Z",key:"w4yl2u"}],["path",{d:"M3 5a2 2 0 0 0 2 2h3",key:"f2jnh7"}],["path",{d:"M3 3v13a2 2 0 0 0 2 2h3",key:"k8epm1"}]],AB=zt("folder-tree",Ime);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const jme=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}],["path",{d:"M12 10v6",key:"1bos4e"}],["path",{d:"m9 13 3-3 3 3",key:"1pxg3c"}]],Pme=zt("folder-up",jme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ome=[["path",{d:"M20 20a2 2 0 0 0 2-2V8a2 2 0 0 0-2-2h-7.9a2 2 0 0 1-1.69-.9L9.6 3.9A2 2 0 0 0 7.93 3H4a2 2 0 0 0-2 2v13a2 2 0 0 0 2 2Z",key:"1kt360"}]],Th=zt("folder",Ome);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dme=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],Fme=zt("funnel",Dme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Lme=[["line",{x1:"6",x2:"6",y1:"3",y2:"15",key:"17qcm7"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M18 9a9 9 0 0 1-9 9",key:"n2h4wq"}]],jc=zt("git-branch",Lme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bme=[["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}],["line",{x1:"3",x2:"9",y1:"12",y2:"12",key:"1dyftd"}],["line",{x1:"15",x2:"21",y1:"12",y2:"12",key:"oup4p8"}]],kH=zt("git-commit-horizontal",Bme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $me=[["circle",{cx:"12",cy:"18",r:"3",key:"1mpf1b"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["circle",{cx:"18",cy:"6",r:"3",key:"1h7g24"}],["path",{d:"M18 9v2c0 .6-.4 1-1 1H7c-.6 0-1-.4-1-1V9",key:"1uq4wg"}],["path",{d:"M12 12v3",key:"158kv8"}]],EH=zt("git-fork",$me);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zme=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M6 21V9a9 9 0 0 0 9 9",key:"7kw0sc"}]],TH=zt("git-merge",zme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ume=[["circle",{cx:"18",cy:"18",r:"3",key:"1xkwt0"}],["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M13 6h3a2 2 0 0 1 2 2v7",key:"1yeb86"}],["line",{x1:"6",x2:"6",y1:"9",y2:"21",key:"rroup"}]],HP=zt("git-pull-request",Ume);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qme=[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]],Vme=zt("github",qme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wme=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]],h2=zt("globe",Wme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hme=[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]],Gme=zt("grip-vertical",Hme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Kme=[["line",{x1:"22",x2:"2",y1:"12",y2:"12",key:"1y58io"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}],["line",{x1:"6",x2:"6.01",y1:"16",y2:"16",key:"sgf278"}],["line",{x1:"10",x2:"10.01",y1:"16",y2:"16",key:"1l4acy"}]],GP=zt("hard-drive",Kme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yme=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]],Zme=zt("history",Yme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xme=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],Jme=zt("house",Xme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qme=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]],Ah=zt("image",Qme);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ege=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]],KP=zt("info",ege);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tge=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],Zx=zt("key",tge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nge=[["path",{d:"m12 8 6-3-6-3v10",key:"mvpnpy"}],["path",{d:"m8 11.99-5.5 3.14a1 1 0 0 0 0 1.74l8.5 4.86a2 2 0 0 0 2 0l8.5-4.86a1 1 0 0 0 0-1.74L16 12",key:"ek95tt"}],["path",{d:"m6.49 12.85 11.02 6.3",key:"1kt42w"}],["path",{d:"M17.51 12.85 6.5 19.15",key:"v55bdg"}]],AH=zt("land-plot",nge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rge=[["path",{d:"M21 6H3",key:"1jwq7v"}],["path",{d:"M7 12H3",key:"13ou7f"}],["path",{d:"M7 18H3",key:"1sijw9"}],["path",{d:"M12 18a5 5 0 0 0 9-3 4.5 4.5 0 0 0-4.5-4.5c-1.33 0-2.54.54-3.41 1.41L11 14",key:"qth677"}],["path",{d:"M11 10v4h4",key:"172dkj"}]],sge=zt("list-restart",rge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ige=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],Jn=zt("loader-circle",ige);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const age=[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]],oge=zt("menu",age);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lge=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M12 7v6",key:"lw1j43"}],["path",{d:"M9 10h6",key:"9gxzsh"}]],cge=zt("message-square-plus",lge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uge=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}],["path",{d:"M13 8H7",key:"14i4kc"}],["path",{d:"M17 12H7",key:"16if0g"}]],RB=zt("message-square-text",uge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dge=[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]],rj=zt("message-square",dge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fge=[["path",{d:"M9 18V5l12-2v13",key:"1jmyc2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["circle",{cx:"18",cy:"16",r:"3",key:"1hluhg"}]],hge=zt("music",fge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pge=[["path",{d:"M13.4 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-7.4",key:"re6nr2"}],["path",{d:"M2 6h4",key:"aawbzj"}],["path",{d:"M2 10h4",key:"l0bgd4"}],["path",{d:"M2 14h4",key:"1gsvsf"}],["path",{d:"M2 18h4",key:"1bu2t1"}],["path",{d:"M21.378 5.626a1 1 0 1 0-3.004-3.004l-5.01 5.012a2 2 0 0 0-.506.854l-.837 2.87a.5.5 0 0 0 .62.62l2.87-.837a2 2 0 0 0 .854-.506z",key:"pqwjuv"}]],YP=zt("notebook-pen",pge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mge=[["circle",{cx:"13.5",cy:"6.5",r:".5",fill:"currentColor",key:"1okk4w"}],["circle",{cx:"17.5",cy:"10.5",r:".5",fill:"currentColor",key:"f64h9f"}],["circle",{cx:"8.5",cy:"7.5",r:".5",fill:"currentColor",key:"fotxhn"}],["circle",{cx:"6.5",cy:"12.5",r:".5",fill:"currentColor",key:"qy21gx"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]],ny=zt("palette",mge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gge=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"m16 15-3-3 3-3",key:"14y99z"}]],yge=zt("panel-left-close",gge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bge=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M15 3v18",key:"14nvp0"}],["path",{d:"m8 9 3 3-3 3",key:"12hl5m"}]],vge=zt("panel-right-close",bge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xge=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],SE=zt("paperclip",xge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wge=[["rect",{x:"14",y:"4",width:"4",height:"16",rx:"1",key:"zuxfzm"}],["rect",{x:"6",y:"4",width:"4",height:"16",rx:"1",key:"1okwgv"}]],_ge=zt("pause",wge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Sge=[["path",{d:"M21.174 6.812a1 1 0 0 0-3.986-3.987L3.842 16.174a2 2 0 0 0-.5.83l-1.321 4.352a.5.5 0 0 0 .623.622l4.353-1.32a2 2 0 0 0 .83-.497z",key:"1a8usu"}]],y1=zt("pen",Sge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Cge=[["polygon",{points:"6 3 20 12 6 21 6 3",key:"1oa8hb"}]],kge=zt("play",Cge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ege=[["path",{d:"M12 22v-5",key:"1ega77"}],["path",{d:"M9 8V2",key:"14iosj"}],["path",{d:"M15 8V2",key:"18g5xt"}],["path",{d:"M18 8v5a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V8Z",key:"osxo6l"}]],NB=zt("plug",Ege);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Tge=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],Pc=zt("plus",Tge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Age=[["path",{d:"M15.39 4.39a1 1 0 0 0 1.68-.474 2.5 2.5 0 1 1 3.014 3.015 1 1 0 0 0-.474 1.68l1.683 1.682a2.414 2.414 0 0 1 0 3.414L19.61 15.39a1 1 0 0 1-1.68-.474 2.5 2.5 0 1 0-3.014 3.015 1 1 0 0 1 .474 1.68l-1.683 1.682a2.414 2.414 0 0 1-3.414 0L8.61 19.61a1 1 0 0 0-1.68.474 2.5 2.5 0 1 1-3.014-3.015 1 1 0 0 0 .474-1.68l-1.683-1.682a2.414 2.414 0 0 1 0-3.414L4.39 8.61a1 1 0 0 1 1.68.474 2.5 2.5 0 1 0 3.014-3.015 1 1 0 0 1-.474-1.68l1.683-1.682a2.414 2.414 0 0 1 3.414 0z",key:"w46dr5"}]],MB=zt("puzzle",Age);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Rge=[["rect",{width:"20",height:"12",x:"2",y:"6",rx:"2",key:"9lu3g6"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M17 12h.01",key:"1m0b6t"}],["path",{d:"M7 12h.01",key:"eqddd0"}]],Nge=zt("rectangle-ellipsis",Rge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Mge=[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]],_m=zt("refresh-cw",Mge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ige=[["path",{d:"M4.5 16.5c-1.5 1.26-2 5-2 5s3.74-.5 5-2c.71-.84.7-2.13-.09-2.91a2.18 2.18 0 0 0-2.91-.09z",key:"m3kijz"}],["path",{d:"m12 15-3-3a22 22 0 0 1 2-3.95A12.88 12.88 0 0 1 22 2c0 2.72-.78 7.5-6 11a22.35 22.35 0 0 1-4 2z",key:"1fmvmk"}],["path",{d:"M9 12H4s.55-3.03 2-4c1.62-1.08 5 0 5 0",key:"1f8sc4"}],["path",{d:"M12 15v5s3.03-.55 4-2c1.08-1.62 0-5 0-5",key:"qeys4"}]],jge=zt("rocket",Ige);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Pge=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],b1=zt("rotate-ccw",Pge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Oge=[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]],Uu=zt("save",Oge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Dge=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],uo=zt("search",Dge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Fge=[["path",{d:"M3.714 3.048a.498.498 0 0 0-.683.627l2.843 7.627a2 2 0 0 1 0 1.396l-2.842 7.627a.498.498 0 0 0 .682.627l18-8.5a.5.5 0 0 0 0-.904z",key:"117uat"}],["path",{d:"M6 12h16",key:"s4cdu5"}]],Lge=zt("send-horizontal",Fge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Bge=[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]],ry=zt("server",Bge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $ge=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],Rh=zt("settings",$ge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zge=[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"M12 8v4",key:"1got3b"}],["path",{d:"M12 16h.01",key:"1drbdi"}]],IB=zt("shield-alert",zge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Uge=[["line",{x1:"21",x2:"14",y1:"4",y2:"4",key:"obuewd"}],["line",{x1:"10",x2:"3",y1:"4",y2:"4",key:"1q6298"}],["line",{x1:"21",x2:"12",y1:"12",y2:"12",key:"1iu8h1"}],["line",{x1:"8",x2:"3",y1:"12",y2:"12",key:"ntss68"}],["line",{x1:"21",x2:"16",y1:"20",y2:"20",key:"14d8ph"}],["line",{x1:"12",x2:"3",y1:"20",y2:"20",key:"m0wm8r"}],["line",{x1:"14",x2:"14",y1:"2",y2:"6",key:"14e1ph"}],["line",{x1:"8",x2:"8",y1:"10",y2:"14",key:"1i6ji0"}],["line",{x1:"16",x2:"16",y1:"18",y2:"22",key:"1lctlv"}]],qge=zt("sliders-horizontal",Uge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vge=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}],["path",{d:"M20 3v4",key:"1olli1"}],["path",{d:"M22 5h-4",key:"1gvqau"}],["path",{d:"M4 17v2",key:"vumght"}],["path",{d:"M5 18H3",key:"zchphs"}]],RH=zt("sparkles",Vge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Wge=[["path",{d:"M9.937 15.5A2 2 0 0 0 8.5 14.063l-6.135-1.582a.5.5 0 0 1 0-.962L8.5 9.936A2 2 0 0 0 9.937 8.5l1.582-6.135a.5.5 0 0 1 .963 0L14.063 8.5A2 2 0 0 0 15.5 9.937l6.135 1.581a.5.5 0 0 1 0 .964L15.5 14.063a2 2 0 0 0-1.437 1.437l-1.582 6.135a.5.5 0 0 1-.963 0z",key:"4pj2yx"}]],jB=zt("sparkle",Wge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Hge=[["path",{d:"M12 3H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1m0v6g"}],["path",{d:"M18.375 2.625a1 1 0 0 1 3 3l-9.013 9.014a2 2 0 0 1-.853.505l-2.873.84a.5.5 0 0 1-.62-.62l.84-2.873a2 2 0 0 1 .506-.852z",key:"ohrbg2"}]],Ch=zt("square-pen",Hge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Gge=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]],Kge=zt("square",Gge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yge=[["path",{d:"M11.525 2.295a.53.53 0 0 1 .95 0l2.31 4.679a2.123 2.123 0 0 0 1.595 1.16l5.166.756a.53.53 0 0 1 .294.904l-3.736 3.638a2.123 2.123 0 0 0-.611 1.878l.882 5.14a.53.53 0 0 1-.771.56l-4.618-2.428a2.122 2.122 0 0 0-1.973 0L6.396 21.01a.53.53 0 0 1-.77-.56l.881-5.139a2.122 2.122 0 0 0-.611-1.879L2.16 9.795a.53.53 0 0 1 .294-.906l5.165-.755a2.122 2.122 0 0 0 1.597-1.16z",key:"r04s7s"}]],PB=zt("star",Yge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Zge=[["path",{d:"m15 5 6.3 6.3a2.4 2.4 0 0 1 0 3.4L17 19",key:"1cbfv1"}],["path",{d:"M9.586 5.586A2 2 0 0 0 8.172 5H3a1 1 0 0 0-1 1v5.172a2 2 0 0 0 .586 1.414L8.29 18.29a2.426 2.426 0 0 0 3.42 0l3.58-3.58a2.426 2.426 0 0 0 0-3.42z",key:"135mg7"}],["circle",{cx:"6.5",cy:"9.5",r:".5",fill:"currentColor",key:"5pm5xn"}]],sj=zt("tags",Zge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xge=[["path",{d:"M17 6.1H3",key:"wptmhv"}],["path",{d:"M21 12.1H3",key:"1j38uz"}],["path",{d:"M15.1 18H3",key:"1nb16a"}]],Jge=zt("text",Xge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Qge=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]],Po=zt("trash-2",Qge);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e0e=[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}]],t0e=zt("trash",e0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n0e=[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]],ZP=zt("triangle-alert",n0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r0e=[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"17 8 12 3 7 8",key:"t8dd8p"}],["line",{x1:"12",x2:"12",y1:"3",y2:"15",key:"widbto"}]],NH=zt("upload",r0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const s0e=[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]],i0e=zt("user",s0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a0e=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],OB=zt("users",a0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const o0e=[["path",{d:"m16 13 5.223 3.482a.5.5 0 0 0 .777-.416V7.87a.5.5 0 0 0-.752-.432L16 10.5",key:"ftymec"}],["rect",{x:"2",y:"6",width:"14",height:"12",rx:"2",key:"158x01"}]],l0e=zt("video",o0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c0e=[["path",{d:"M14.7 6.3a1 1 0 0 0 0 1.4l1.6 1.6a1 1 0 0 0 1.4 0l3.77-3.77a6 6 0 0 1-7.94 7.94l-6.91 6.91a2.12 2.12 0 0 1-3-3l6.91-6.91a6 6 0 0 1 7.94-7.94l-3.76 3.76z",key:"cbrjhi"}]],Sm=zt("wrench",c0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u0e=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Pi=zt("x",u0e);/**
 * @license lucide-react v0.485.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d0e=[["path",{d:"M4 14a1 1 0 0 1-.78-1.63l9.9-10.2a.5.5 0 0 1 .86.46l-1.92 6.02A1 1 0 0 0 13 10h7a1 1 0 0 1 .78 1.63l-9.9 10.2a.5.5 0 0 1-.86-.46l1.92-6.02A1 1 0 0 0 11 14z",key:"1xq2db"}]],f0e=zt("zap",d0e),DB=({controls:e,area:t,className:n})=>{const r=e.filter(s=>t==="trigger"?!!s.triggerRenderer:!!s.renderer);return r.length===0?null:f.jsx("div",{className:Ze(n),children:r.map(s=>{var a,o;const i=t==="trigger"?(a=s.triggerRenderer)==null?void 0:a.call(s):(o=s.renderer)==null?void 0:o.call(s);return i?f.jsx(Ve.Fragment,{children:i},s.id):null})})},FB=e=>{let t;const n=new Set,r=(c,u)=>{const d=typeof c=="function"?c(t):c;if(!Object.is(d,t)){const h=t;t=u??(typeof d!="object"||d===null)?d:Object.assign({},t,d),n.forEach(m=>m(t,h))}},s=()=>t,o={setState:r,getState:s,getInitialState:()=>l,subscribe:c=>(n.add(c),()=>n.delete(c))},l=t=e(r,s,o);return o},h0e=e=>e?FB(e):FB,p0e=e=>e;function m0e(e,t=p0e){const n=Ve.useSyncExternalStore(e.subscribe,()=>t(e.getState()),()=>t(e.getInitialState()));return Ve.useDebugValue(n),n}const LB=e=>{const t=h0e(e),n=r=>m0e(t,r);return Object.assign(n,t),n},Wo=e=>e?LB(e):LB;var MH=Symbol.for("immer-nothing"),BB=Symbol.for("immer-draftable"),us=Symbol.for("immer-state");function ql(e,...t){throw new Error(`[Immer] minified error nr: ${e}. Full error at: https://bit.ly/3cXEKWf`)}var sy=Object.getPrototypeOf;function iy(e){return!!e&&!!e[us]}function Hd(e){var t;return e?IH(e)||Array.isArray(e)||!!e[BB]||!!((t=e.constructor)!=null&&t[BB])||kE(e)||EE(e):!1}var g0e=Object.prototype.constructor.toString();function IH(e){if(!e||typeof e!="object")return!1;const t=sy(e);if(t===null)return!0;const n=Object.hasOwnProperty.call(t,"constructor")&&t.constructor;return n===Object?!0:typeof n=="function"&&Function.toString.call(n)===g0e}function Xx(e,t){CE(e)===0?Reflect.ownKeys(e).forEach(n=>{t(n,e[n],e)}):e.forEach((n,r)=>t(r,n,e))}function CE(e){const t=e[us];return t?t.type_:Array.isArray(e)?1:kE(e)?2:EE(e)?3:0}function ij(e,t){return CE(e)===2?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function jH(e,t,n){const r=CE(e);r===2?e.set(t,n):r===3?e.add(n):e[t]=n}function y0e(e,t){return e===t?e!==0||1/e===1/t:e!==e&&t!==t}function kE(e){return e instanceof Map}function EE(e){return e instanceof Set}function ra(e){return e.copy_||e.base_}function aj(e,t){if(kE(e))return new Map(e);if(EE(e))return new Set(e);if(Array.isArray(e))return Array.prototype.slice.call(e);const n=IH(e);if(t===!0||t==="class_only"&&!n){const r=Object.getOwnPropertyDescriptors(e);delete r[us];let s=Reflect.ownKeys(r);for(let i=0;i<s.length;i++){const a=s[i],o=r[a];o.writable===!1&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(r[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(sy(e),r)}else{const r=sy(e);if(r!==null&&n)return{...e};const s=Object.create(r);return Object.assign(s,e)}}function XP(e,t=!1){return TE(e)||iy(e)||!Hd(e)||(CE(e)>1&&(e.set=e.add=e.clear=e.delete=b0e),Object.freeze(e),t&&Object.entries(e).forEach(([n,r])=>XP(r,!0))),e}function b0e(){ql(2)}function TE(e){return Object.isFrozen(e)}var oj={};function Cm(e){const t=oj[e];return t||ql(0,e),t}function v0e(e,t){oj[e]||(oj[e]=t)}var Jx;function p2(){return Jx}function x0e(e,t){return{drafts_:[],parent_:e,immer_:t,canAutoFreeze_:!0,unfinalizedDrafts_:0}}function $B(e,t){t&&(Cm("Patches"),e.patches_=[],e.inversePatches_=[],e.patchListener_=t)}function lj(e){cj(e),e.drafts_.forEach(w0e),e.drafts_=null}function cj(e){e===Jx&&(Jx=e.parent_)}function zB(e){return Jx=x0e(Jx,e)}function w0e(e){const t=e[us];t.type_===0||t.type_===1?t.revoke_():t.revoked_=!0}function UB(e,t){t.unfinalizedDrafts_=t.drafts_.length;const n=t.drafts_[0];return e!==void 0&&e!==n?(n[us].modified_&&(lj(t),ql(4)),Hd(e)&&(e=m2(t,e),t.parent_||g2(t,e)),t.patches_&&Cm("Patches").generateReplacementPatches_(n[us].base_,e,t.patches_,t.inversePatches_)):e=m2(t,n,[]),lj(t),t.patches_&&t.patchListener_(t.patches_,t.inversePatches_),e!==MH?e:void 0}function m2(e,t,n){if(TE(t))return t;const r=t[us];if(!r)return Xx(t,(s,i)=>qB(e,r,t,s,i,n)),t;if(r.scope_!==e)return t;if(!r.modified_)return g2(e,r.base_,!0),r.base_;if(!r.finalized_){r.finalized_=!0,r.scope_.unfinalizedDrafts_--;const s=r.copy_;let i=s,a=!1;r.type_===3&&(i=new Set(s),s.clear(),a=!0),Xx(i,(o,l)=>qB(e,r,s,o,l,n,a)),g2(e,s,!1),n&&e.patches_&&Cm("Patches").generatePatches_(r,n,e.patches_,e.inversePatches_)}return r.copy_}function qB(e,t,n,r,s,i,a){if(iy(s)){const o=i&&t&&t.type_!==3&&!ij(t.assigned_,r)?i.concat(r):void 0,l=m2(e,s,o);if(jH(n,r,l),iy(l))e.canAutoFreeze_=!1;else return}else a&&n.add(s);if(Hd(s)&&!TE(s)){if(!e.immer_.autoFreeze_&&e.unfinalizedDrafts_<1)return;m2(e,s),(!t||!t.scope_.parent_)&&typeof r!="symbol"&&Object.prototype.propertyIsEnumerable.call(n,r)&&g2(e,s)}}function g2(e,t,n=!1){!e.parent_&&e.immer_.autoFreeze_&&e.canAutoFreeze_&&XP(t,n)}function _0e(e,t){const n=Array.isArray(e),r={type_:n?1:0,scope_:t?t.scope_:p2(),modified_:!1,finalized_:!1,assigned_:{},parent_:t,base_:e,draft_:null,copy_:null,revoke_:null,isManual_:!1};let s=r,i=JP;n&&(s=[r],i=Qx);const{revoke:a,proxy:o}=Proxy.revocable(s,i);return r.draft_=o,r.revoke_=a,o}var JP={get(e,t){if(t===us)return e;const n=ra(e);if(!ij(n,t))return S0e(e,n,t);const r=n[t];return e.finalized_||!Hd(r)?r:r===SN(e.base_,t)?(CN(e),e.copy_[t]=ew(r,e)):r},has(e,t){return t in ra(e)},ownKeys(e){return Reflect.ownKeys(ra(e))},set(e,t,n){const r=PH(ra(e),t);if(r!=null&&r.set)return r.set.call(e.draft_,n),!0;if(!e.modified_){const s=SN(ra(e),t),i=s==null?void 0:s[us];if(i&&i.base_===n)return e.copy_[t]=n,e.assigned_[t]=!1,!0;if(y0e(n,s)&&(n!==void 0||ij(e.base_,t)))return!0;CN(e),Ad(e)}return e.copy_[t]===n&&(n!==void 0||t in e.copy_)||Number.isNaN(n)&&Number.isNaN(e.copy_[t])||(e.copy_[t]=n,e.assigned_[t]=!0),!0},deleteProperty(e,t){return SN(e.base_,t)!==void 0||t in e.base_?(e.assigned_[t]=!1,CN(e),Ad(e)):delete e.assigned_[t],e.copy_&&delete e.copy_[t],!0},getOwnPropertyDescriptor(e,t){const n=ra(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r&&{writable:!0,configurable:e.type_!==1||t!=="length",enumerable:r.enumerable,value:n[t]}},defineProperty(){ql(11)},getPrototypeOf(e){return sy(e.base_)},setPrototypeOf(){ql(12)}},Qx={};Xx(JP,(e,t)=>{Qx[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}});Qx.deleteProperty=function(e,t){return Qx.set.call(this,e,t,void 0)};Qx.set=function(e,t,n){return JP.set.call(this,e[0],t,n,e[0])};function SN(e,t){const n=e[us];return(n?ra(n):e)[t]}function S0e(e,t,n){var s;const r=PH(t,n);return r?"value"in r?r.value:(s=r.get)==null?void 0:s.call(e.draft_):void 0}function PH(e,t){if(!(t in e))return;let n=sy(e);for(;n;){const r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=sy(n)}}function Ad(e){e.modified_||(e.modified_=!0,e.parent_&&Ad(e.parent_))}function CN(e){e.copy_||(e.copy_=aj(e.base_,e.scope_.immer_.useStrictShallowCopy_))}var C0e=class{constructor(e){this.autoFreeze_=!0,this.useStrictShallowCopy_=!1,this.produce=(t,n,r)=>{if(typeof t=="function"&&typeof n!="function"){const i=n;n=t;const a=this;return function(l=i,...c){return a.produce(l,u=>n.call(this,u,...c))}}typeof n!="function"&&ql(6),r!==void 0&&typeof r!="function"&&ql(7);let s;if(Hd(t)){const i=zB(this),a=ew(t,void 0);let o=!0;try{s=n(a),o=!1}finally{o?lj(i):cj(i)}return $B(i,r),UB(s,i)}else if(!t||typeof t!="object"){if(s=n(t),s===void 0&&(s=t),s===MH&&(s=void 0),this.autoFreeze_&&XP(s,!0),r){const i=[],a=[];Cm("Patches").generateReplacementPatches_(t,s,i,a),r(i,a)}return s}else ql(1,t)},this.produceWithPatches=(t,n)=>{if(typeof t=="function")return(a,...o)=>this.produceWithPatches(a,l=>t(l,...o));let r,s;return[this.produce(t,n,(a,o)=>{r=a,s=o}),r,s]},typeof(e==null?void 0:e.autoFreeze)=="boolean"&&this.setAutoFreeze(e.autoFreeze),typeof(e==null?void 0:e.useStrictShallowCopy)=="boolean"&&this.setUseStrictShallowCopy(e.useStrictShallowCopy)}createDraft(e){Hd(e)||ql(8),iy(e)&&(e=k0e(e));const t=zB(this),n=ew(e,void 0);return n[us].isManual_=!0,cj(t),n}finishDraft(e,t){const n=e&&e[us];(!n||!n.isManual_)&&ql(9);const{scope_:r}=n;return $B(r,t),UB(void 0,r)}setAutoFreeze(e){this.autoFreeze_=e}setUseStrictShallowCopy(e){this.useStrictShallowCopy_=e}applyPatches(e,t){let n;for(n=t.length-1;n>=0;n--){const s=t[n];if(s.path.length===0&&s.op==="replace"){e=s.value;break}}n>-1&&(t=t.slice(n+1));const r=Cm("Patches").applyPatches_;return iy(e)?r(e,t):this.produce(e,s=>r(s,t))}};function ew(e,t){const n=kE(e)?Cm("MapSet").proxyMap_(e,t):EE(e)?Cm("MapSet").proxySet_(e,t):_0e(e,t);return(t?t.scope_:p2()).drafts_.push(n),n}function k0e(e){return iy(e)||ql(10,e),OH(e)}function OH(e){if(!Hd(e)||TE(e))return e;const t=e[us];let n;if(t){if(!t.modified_)return t.base_;t.finalized_=!0,n=aj(e,t.scope_.immer_.useStrictShallowCopy_)}else n=aj(e,!0);return Xx(n,(r,s)=>{jH(n,r,OH(s))}),t&&(t.finalized_=!1),n}function E0e(){class e extends Map{constructor(l,c){super(),this[us]={type_:2,parent_:c,scope_:c?c.scope_:p2(),modified_:!1,finalized_:!1,copy_:void 0,assigned_:void 0,base_:l,draft_:this,isManual_:!1,revoked_:!1}}get size(){return ra(this[us]).size}has(l){return ra(this[us]).has(l)}set(l,c){const u=this[us];return a(u),(!ra(u).has(l)||ra(u).get(l)!==c)&&(n(u),Ad(u),u.assigned_.set(l,!0),u.copy_.set(l,c),u.assigned_.set(l,!0)),this}delete(l){if(!this.has(l))return!1;const c=this[us];return a(c),n(c),Ad(c),c.base_.has(l)?c.assigned_.set(l,!1):c.assigned_.delete(l),c.copy_.delete(l),!0}clear(){const l=this[us];a(l),ra(l).size&&(n(l),Ad(l),l.assigned_=new Map,Xx(l.base_,c=>{l.assigned_.set(c,!1)}),l.copy_.clear())}forEach(l,c){const u=this[us];ra(u).forEach((d,h,m)=>{l.call(c,this.get(h),h,this)})}get(l){const c=this[us];a(c);const u=ra(c).get(l);if(c.finalized_||!Hd(u)||u!==c.base_.get(l))return u;const d=ew(u,c);return n(c),c.copy_.set(l,d),d}keys(){return ra(this[us]).keys()}values(){const l=this.keys();return{[Symbol.iterator]:()=>this.values(),next:()=>{const c=l.next();return c.done?c:{done:!1,value:this.get(c.value)}}}}entries(){const l=this.keys();return{[Symbol.iterator]:()=>this.entries(),next:()=>{const c=l.next();if(c.done)return c;const u=this.get(c.value);return{done:!1,value:[c.value,u]}}}}[Symbol.iterator](){return this.entries()}}function t(o,l){return new e(o,l)}function n(o){o.copy_||(o.assigned_=new Map,o.copy_=new Map(o.base_))}class r extends Set{constructor(l,c){super(),this[us]={type_:3,parent_:c,scope_:c?c.scope_:p2(),modified_:!1,finalized_:!1,copy_:void 0,base_:l,draft_:this,drafts_:new Map,revoked_:!1,isManual_:!1}}get size(){return ra(this[us]).size}has(l){const c=this[us];return a(c),c.copy_?!!(c.copy_.has(l)||c.drafts_.has(l)&&c.copy_.has(c.drafts_.get(l))):c.base_.has(l)}add(l){const c=this[us];return a(c),this.has(l)||(i(c),Ad(c),c.copy_.add(l)),this}delete(l){if(!this.has(l))return!1;const c=this[us];return a(c),i(c),Ad(c),c.copy_.delete(l)||(c.drafts_.has(l)?c.copy_.delete(c.drafts_.get(l)):!1)}clear(){const l=this[us];a(l),ra(l).size&&(i(l),Ad(l),l.copy_.clear())}values(){const l=this[us];return a(l),i(l),l.copy_.values()}entries(){const l=this[us];return a(l),i(l),l.copy_.entries()}keys(){return this.values()}[Symbol.iterator](){return this.values()}forEach(l,c){const u=this.values();let d=u.next();for(;!d.done;)l.call(c,d.value,d.value,this),d=u.next()}}function s(o,l){return new r(o,l)}function i(o){o.copy_||(o.copy_=new Set,o.base_.forEach(l=>{if(Hd(l)){const c=ew(l,o);o.drafts_.set(l,c),o.copy_.add(c)}else o.copy_.add(l)}))}function a(o){o.revoked_&&ql(3,JSON.stringify(ra(o)))}v0e("MapSet",{proxyMap_:t,proxySet_:s})}var ml=new C0e,T0e=ml.produce;ml.produceWithPatches.bind(ml);ml.setAutoFreeze.bind(ml);ml.setUseStrictShallowCopy.bind(ml);ml.applyPatches.bind(ml);ml.createDraft.bind(ml);ml.finishDraft.bind(ml);const A0e=e=>(t,n,r)=>(r.setState=(s,i,...a)=>{const o=typeof s=="function"?T0e(s):s;return t(o,i,...a)},e(r.setState,n,r)),Ho=A0e;function R0e(e){return{all:e=e||new Map,on:function(t,n){var r=e.get(t);r?r.push(n):e.set(t,[n])},off:function(t,n){var r=e.get(t);r&&(n?r.splice(r.indexOf(n)>>>0,1):e.set(t,[]))},emit:function(t,n){var r=e.get(t);r&&r.slice().map(function(s){s(n)}),(r=e.get("*"))&&r.slice().map(function(s){s(t,n)})}}}const Re=R0e(),zr={promptControlsChanged:"control.registry.prompt.controls.changed",chatControlsChanged:"control.registry.chat.controls.changed",canvasControlsChanged:"control.registry.canvas.controls.changed",middlewareChanged:"control.registry.middleware.changed",toolsChanged:"control.registry.tools.changed",modalProvidersChanged:"control.registry.modal.providers.changed",registerPromptControlRequest:"control.registry.register.prompt.control.request",unregisterPromptControlRequest:"control.registry.unregister.prompt.control.request",registerChatControlRequest:"control.registry.register.chat.control.request",unregisterChatControlRequest:"control.registry.unregister.chat.control.request",registerCanvasControlRequest:"control.registry.register.canvas.control.request",unregisterCanvasControlRequest:"control.registry.unregister.canvas.control.request",registerMiddlewareRequest:"control.registry.register.middleware.request",unregisterMiddlewareRequest:"control.registry.unregister.middleware.request",registerToolRequest:"control.registry.register.tool.request",unregisterToolRequest:"control.registry.unregister.tool.request",registerModalProviderRequest:"control.registry.register.modal.provider.request",unregisterModalProviderRequest:"control.registry.unregister.modal.provider.request"},w0={blockRenderersChanged:"block.renderer.renderers.changed",registerBlockRendererRequest:"block.renderer.register.request",unregisterBlockRendererRequest:"block.renderer.unregister.request"},Wi=Wo(Ho((e,t)=>({promptControls:{},chatControls:{},canvasControls:{},blockRenderers:{},middlewareRegistry:{},tools:{},modalProviders:{},registerPromptControl:n=>(e(r=>{r.promptControls[n.id]&&console.warn(`ControlRegistryStore: PromptControl with ID "${n.id}" already registered. Overwriting.`),r.promptControls[n.id]=n}),Re.emit(zr.promptControlsChanged,{controls:t().promptControls}),()=>t().unregisterPromptControl(n.id)),unregisterPromptControl:n=>{e(r=>{r.promptControls[n]?delete r.promptControls[n]:console.warn(`ControlRegistryStore: PromptControl with ID "${n}" not found for unregistration.`)}),Re.emit(zr.promptControlsChanged,{controls:t().promptControls})},registerChatControl:n=>(e(r=>{r.chatControls[n.id]&&console.warn(`ControlRegistryStore: ChatControl with ID "${n.id}" already registered. Overwriting.`),r.chatControls[n.id]=n}),Re.emit(zr.chatControlsChanged,{controls:t().chatControls}),()=>t().unregisterChatControl(n.id)),unregisterChatControl:n=>{e(r=>{r.chatControls[n]?delete r.chatControls[n]:console.warn(`ControlRegistryStore: ChatControl with ID "${n}" not found for unregistration.`)}),Re.emit(zr.chatControlsChanged,{controls:t().chatControls})},registerCanvasControl:n=>(e(r=>{r.canvasControls[n.id]&&console.warn(`ControlRegistryStore: CanvasControl with ID "${n.id}" already registered. Overwriting.`),r.canvasControls[n.id]=n}),Re.emit(zr.canvasControlsChanged,{controls:t().canvasControls}),()=>t().unregisterCanvasControl(n.id)),unregisterCanvasControl:n=>{e(r=>{r.canvasControls[n]?delete r.canvasControls[n]:console.warn(`ControlRegistryStore: CanvasControl with ID "${n}" not found for unregistration.`)}),Re.emit(zr.canvasControlsChanged,{controls:t().canvasControls})},registerBlockRenderer:n=>(e(r=>{r.blockRenderers[n.id]&&console.warn(`ControlRegistryStore: BlockRenderer with ID "${n.id}" already registered. Overwriting.`),r.blockRenderers[n.id]=n}),Re.emit(w0.blockRenderersChanged,{renderers:t().blockRenderers}),()=>t().unregisterBlockRenderer(n.id)),unregisterBlockRenderer:n=>{e(r=>{r.blockRenderers[n]?delete r.blockRenderers[n]:console.warn(`ControlRegistryStore: BlockRenderer with ID "${n}" not found for unregistration.`)}),Re.emit(w0.blockRenderersChanged,{renderers:t().blockRenderers})},registerMiddleware:(n,r,s,i=0)=>{const a={modId:r,callback:s,order:i};return e(o=>{o.middlewareRegistry[n]||(o.middlewareRegistry[n]=[]),o.middlewareRegistry[n].push(a),o.middlewareRegistry[n].sort((l,c)=>(l.order??0)-(c.order??0))}),Re.emit(zr.middlewareChanged,{middleware:t().middlewareRegistry}),()=>t().unregisterMiddleware(n,r,s)},unregisterMiddleware:(n,r,s)=>{e(i=>{var a;i.middlewareRegistry[n]?(i.middlewareRegistry[n]=i.middlewareRegistry[n].filter(o=>!(o.modId===r&&o.callback===s)),((a=i.middlewareRegistry[n])==null?void 0:a.length)===0&&delete i.middlewareRegistry[n]):console.warn(`ControlRegistryStore: Middleware hook "${n}" not found for unregistration.`)}),Re.emit(zr.middlewareChanged,{middleware:t().middlewareRegistry})},getMiddlewareForHook:n=>{const r=t().middlewareRegistry[n]??[];return Object.freeze([...r].sort((s,i)=>(s.order??0)-(i.order??0)))},registerTool:(n,r,s,i)=>(e(a=>{a.tools[r]&&console.warn(`ControlRegistryStore: Tool "${r}" already registered by mod "${a.tools[r].modId}". Overwriting with registration from mod "${n}".`),a.tools[r]={definition:s,implementation:i,modId:n}}),Re.emit(zr.toolsChanged,{tools:t().tools}),()=>t().unregisterTool(r)),unregisterTool:n=>{e(r=>{r.tools[n]?delete r.tools[n]:console.warn(`ControlRegistryStore: Tool "${n}" not found for unregistration.`)}),Re.emit(zr.toolsChanged,{tools:t().tools})},getRegisteredTools:()=>Object.freeze({...t().tools}),registerModalProvider:(n,r)=>(e(s=>{s.modalProviders[n]&&console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" already registered. Overwriting.`),s.modalProviders[n]=r}),Re.emit(zr.modalProvidersChanged,{providers:t().modalProviders}),()=>t().unregisterModalProvider(n)),unregisterModalProvider:n=>{e(r=>{r.modalProviders[n]?delete r.modalProviders[n]:console.warn(`ControlRegistryStore: ModalProvider with ID "${n}" not found for unregistration.`)}),Re.emit(zr.modalProvidersChanged,{providers:t().modalProviders})},getRegisteredActionHandlers:()=>{const n="controlRegistryStore",r=t();return[{eventName:zr.registerPromptControlRequest,handler:s=>{r.registerPromptControl(s.control)},storeId:n},{eventName:zr.unregisterPromptControlRequest,handler:s=>{r.unregisterPromptControl(s.id)},storeId:n},{eventName:zr.registerChatControlRequest,handler:s=>{r.registerChatControl(s.control)},storeId:n},{eventName:zr.unregisterChatControlRequest,handler:s=>{r.unregisterChatControl(s.id)},storeId:n},{eventName:zr.registerCanvasControlRequest,handler:s=>{r.registerCanvasControl(s.control)},storeId:n},{eventName:zr.unregisterCanvasControlRequest,handler:s=>{r.unregisterCanvasControl(s.id)},storeId:n},{eventName:w0.registerBlockRendererRequest,handler:s=>{r.registerBlockRenderer(s.renderer)},storeId:n},{eventName:w0.unregisterBlockRendererRequest,handler:s=>{r.unregisterBlockRenderer(s.id)},storeId:n},{eventName:zr.registerMiddlewareRequest,handler:s=>{r.registerMiddleware(s.hookName,s.modId,s.callback,s.order)},storeId:n},{eventName:zr.unregisterMiddlewareRequest,handler:s=>{r.unregisterMiddleware(s.hookName,s.modId,s.callback)},storeId:n},{eventName:zr.registerToolRequest,handler:s=>{r.registerTool(s.modId,s.toolName,s.definition,s.implementation)},storeId:n},{eventName:zr.unregisterToolRequest,handler:s=>{r.unregisterTool(s.toolName)},storeId:n},{eventName:zr.registerModalProviderRequest,handler:s=>{r.registerModalProvider(s.modalId,s.provider)},storeId:n},{eventName:zr.unregisterModalProviderRequest,handler:s=>{r.unregisterModalProvider(s.modalId)},storeId:n}]}})));var PC={exports:{}},N0e=PC.exports,VB;function M0e(){return VB||(VB=1,function(e,t){(function(n,r){e.exports=r()})(N0e,function(){var n=function(M,z){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(ne,ae){ne.__proto__=ae}||function(ne,ae){for(var me in ae)Object.prototype.hasOwnProperty.call(ae,me)&&(ne[me]=ae[me])})(M,z)},r=function(){return(r=Object.assign||function(M){for(var z,ne=1,ae=arguments.length;ne<ae;ne++)for(var me in z=arguments[ne])Object.prototype.hasOwnProperty.call(z,me)&&(M[me]=z[me]);return M}).apply(this,arguments)};function s(M,z,ne){for(var ae,me=0,Ne=z.length;me<Ne;me++)!ae&&me in z||((ae=ae||Array.prototype.slice.call(z,0,me))[me]=z[me]);return M.concat(ae||Array.prototype.slice.call(z))}var i=typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:im,a=Object.keys,o=Array.isArray;function l(M,z){return typeof z!="object"||a(z).forEach(function(ne){M[ne]=z[ne]}),M}typeof Promise>"u"||i.Promise||(i.Promise=Promise);var c=Object.getPrototypeOf,u={}.hasOwnProperty;function d(M,z){return u.call(M,z)}function h(M,z){typeof z=="function"&&(z=z(c(M))),(typeof Reflect>"u"?a:Reflect.ownKeys)(z).forEach(function(ne){y(M,ne,z[ne])})}var m=Object.defineProperty;function y(M,z,ne,ae){m(M,z,l(ne&&d(ne,"get")&&typeof ne.get=="function"?{get:ne.get,set:ne.set,configurable:!0}:{value:ne,configurable:!0,writable:!0},ae))}function b(M){return{from:function(z){return M.prototype=Object.create(z.prototype),y(M.prototype,"constructor",M),{extend:h.bind(null,M.prototype)}}}}var v=Object.getOwnPropertyDescriptor,x=[].slice;function w(M,z,ne){return x.call(M,z,ne)}function S(M,z){return z(M)}function k(M){if(!M)throw new Error("Assertion Failed")}function C(M){i.setImmediate?setImmediate(M):setTimeout(M,0)}function T(M,z){if(typeof z=="string"&&d(M,z))return M[z];if(!z)return M;if(typeof z!="string"){for(var ne=[],ae=0,me=z.length;ae<me;++ae){var Ne=T(M,z[ae]);ne.push(Ne)}return ne}var Le=z.indexOf(".");if(Le!==-1){var Ge=M[z.substr(0,Le)];return Ge==null?void 0:T(Ge,z.substr(Le+1))}}function A(M,z,ne){if(M&&z!==void 0&&!("isFrozen"in Object&&Object.isFrozen(M)))if(typeof z!="string"&&"length"in z){k(typeof ne!="string"&&"length"in ne);for(var ae=0,me=z.length;ae<me;++ae)A(M,z[ae],ne[ae])}else{var Ne,Le,Ge=z.indexOf(".");Ge!==-1?(Ne=z.substr(0,Ge),(Le=z.substr(Ge+1))===""?ne===void 0?o(M)&&!isNaN(parseInt(Ne))?M.splice(Ne,1):delete M[Ne]:M[Ne]=ne:A(Ge=!(Ge=M[Ne])||!d(M,Ne)?M[Ne]={}:Ge,Le,ne)):ne===void 0?o(M)&&!isNaN(parseInt(z))?M.splice(z,1):delete M[z]:M[z]=ne}}function N(M){var z,ne={};for(z in M)d(M,z)&&(ne[z]=M[z]);return ne}var I=[].concat;function O(M){return I.apply([],M)}var Pt="BigUint64Array,BigInt64Array,Array,Boolean,String,Date,RegExp,Blob,File,FileList,FileSystemFileHandle,FileSystemDirectoryHandle,ArrayBuffer,DataView,Uint8ClampedArray,ImageBitmap,ImageData,Map,Set,CryptoKey".split(",").concat(O([8,16,32,64].map(function(M){return["Int","Uint","Float"].map(function(z){return z+M+"Array"})}))).filter(function(M){return i[M]}),B=new Set(Pt.map(function(M){return i[M]})),D=null;function H(M){return D=new WeakMap,M=function z(ne){if(!ne||typeof ne!="object")return ne;var ae=D.get(ne);if(ae)return ae;if(o(ne)){ae=[],D.set(ne,ae);for(var me=0,Ne=ne.length;me<Ne;++me)ae.push(z(ne[me]))}else if(B.has(ne.constructor))ae=ne;else{var Le,Ge=c(ne);for(Le in ae=Ge===Object.prototype?{}:Object.create(Ge),D.set(ne,ae),ne)d(ne,Le)&&(ae[Le]=z(ne[Le]))}return ae}(M),D=null,M}var P={}.toString;function K(M){return P.call(M).slice(8,-1)}var U=typeof Symbol<"u"?Symbol.iterator:"@@iterator",V=typeof U=="symbol"?function(M){var z;return M!=null&&(z=M[U])&&z.apply(M)}:function(){return null};function L(M,z){return z=M.indexOf(z),0<=z&&M.splice(z,1),0<=z}var te={};function W(M){var z,ne,ae,me;if(arguments.length===1){if(o(M))return M.slice();if(this===te&&typeof M=="string")return[M];if(me=V(M)){for(ne=[];!(ae=me.next()).done;)ne.push(ae.value);return ne}if(M==null)return[M];if(typeof(z=M.length)!="number")return[M];for(ne=new Array(z);z--;)ne[z]=M[z];return ne}for(z=arguments.length,ne=new Array(z);z--;)ne[z]=arguments[z];return ne}var Q=typeof Symbol<"u"?function(M){return M[Symbol.toStringTag]==="AsyncFunction"}:function(){return!1},dt=["Unknown","Constraint","Data","TransactionInactive","ReadOnly","Version","NotFound","InvalidState","InvalidAccess","Abort","Timeout","QuotaExceeded","Syntax","DataClone"],Za=["Modify","Bulk","OpenFailed","VersionChange","Schema","Upgrade","InvalidTable","MissingAPI","NoSuchDatabase","InvalidArgument","SubTransaction","Unsupported","Internal","DatabaseClosed","PrematureCommit","ForeignAwait"].concat(dt),ee={VersionChanged:"Database version changed by other database connection",DatabaseClosed:"Database has been closed",Abort:"Transaction aborted",TransactionInactive:"Transaction has already completed or failed",MissingAPI:"IndexedDB API missing. Please visit https://tinyurl.com/y2uuvskb"};function re(M,z){this.name=M,this.message=z}function pe(M,z){return M+". Errors: "+Object.keys(z).map(function(ne){return z[ne].toString()}).filter(function(ne,ae,me){return me.indexOf(ne)===ae}).join(`
`)}function de(M,z,ne,ae){this.failures=z,this.failedKeys=ae,this.successCount=ne,this.message=pe(M,z)}function Oe(M,z){this.name="BulkError",this.failures=Object.keys(z).map(function(ne){return z[ne]}),this.failuresByPos=z,this.message=pe(M,this.failures)}b(re).from(Error).extend({toString:function(){return this.name+": "+this.message}}),b(de).from(re),b(Oe).from(re);var Fe=Za.reduce(function(M,z){return M[z]=z+"Error",M},{}),Se=re,Ce=Za.reduce(function(M,z){var ne=z+"Error";function ae(me,Ne){this.name=ne,me?typeof me=="string"?(this.message="".concat(me).concat(Ne?`
 `+Ne:""),this.inner=Ne||null):typeof me=="object"&&(this.message="".concat(me.name," ").concat(me.message),this.inner=me):(this.message=ee[z]||ne,this.inner=null)}return b(ae).from(Se),M[z]=ae,M},{});Ce.Syntax=SyntaxError,Ce.Type=TypeError,Ce.Range=RangeError;var qe=dt.reduce(function(M,z){return M[z+"Error"]=Ce[z],M},{}),Qe=Za.reduce(function(M,z){return["Syntax","Type","Range"].indexOf(z)===-1&&(M[z+"Error"]=Ce[z]),M},{});function We(){}function je(M){return M}function Y(M,z){return M==null||M===je?z:function(ne){return z(M(ne))}}function ye(M,z){return function(){M.apply(this,arguments),z.apply(this,arguments)}}function Ie(M,z){return M===We?z:function(){var ne=M.apply(this,arguments);ne!==void 0&&(arguments[0]=ne);var ae=this.onsuccess,me=this.onerror;this.onsuccess=null,this.onerror=null;var Ne=z.apply(this,arguments);return ae&&(this.onsuccess=this.onsuccess?ye(ae,this.onsuccess):ae),me&&(this.onerror=this.onerror?ye(me,this.onerror):me),Ne!==void 0?Ne:ne}}function ce(M,z){return M===We?z:function(){M.apply(this,arguments);var ne=this.onsuccess,ae=this.onerror;this.onsuccess=this.onerror=null,z.apply(this,arguments),ne&&(this.onsuccess=this.onsuccess?ye(ne,this.onsuccess):ne),ae&&(this.onerror=this.onerror?ye(ae,this.onerror):ae)}}function oe(M,z){return M===We?z:function(ne){var ae=M.apply(this,arguments);l(ne,ae);var me=this.onsuccess,Ne=this.onerror;return this.onsuccess=null,this.onerror=null,ne=z.apply(this,arguments),me&&(this.onsuccess=this.onsuccess?ye(me,this.onsuccess):me),Ne&&(this.onerror=this.onerror?ye(Ne,this.onerror):Ne),ae===void 0?ne===void 0?void 0:ne:l(ae,ne)}}function se(M,z){return M===We?z:function(){return z.apply(this,arguments)!==!1&&M.apply(this,arguments)}}function Me(M,z){return M===We?z:function(){var ne=M.apply(this,arguments);if(ne&&typeof ne.then=="function"){for(var ae=this,me=arguments.length,Ne=new Array(me);me--;)Ne[me]=arguments[me];return ne.then(function(){return z.apply(ae,Ne)})}return z.apply(this,arguments)}}Qe.ModifyError=de,Qe.DexieError=re,Qe.BulkError=Oe;var Be=typeof location<"u"&&/^(http|https):\/\/(localhost|127\.0\.0\.1)/.test(location.href);function Ae(M){Be=M}var lt={},Tt=100,Pt=typeof Promise>"u"?[]:function(){var M=Promise.resolve();if(typeof crypto>"u"||!crypto.subtle)return[M,c(M),M];var z=crypto.subtle.digest("SHA-512",new Uint8Array([0]));return[z,c(z),M]}(),dt=Pt[0],Za=Pt[1],Pt=Pt[2],Za=Za&&Za.then,qt=dt&&dt.constructor,Ft=!!Pt,Ht=function(M,z){le.push([M,z]),F&&(queueMicrotask(fe),F=!1)},we=!0,F=!0,X=[],be=[],ke=je,ge={id:"global",global:!0,ref:0,unhandleds:[],onunhandled:We,pgp:!1,env:{},finalize:We},Ee=ge,le=[],ft=0,et=[];function $(M){if(typeof this!="object")throw new TypeError("Promises must be constructed via new");this._listeners=[],this._lib=!1;var z=this._PSD=Ee;if(typeof M!="function"){if(M!==lt)throw new TypeError("Not a function");return this._state=arguments[1],this._value=arguments[2],void(this._state===!1&&ve(this,this._value))}this._state=null,this._value=null,++z.ref,function ne(ae,me){try{me(function(Ne){if(ae._state===null){if(Ne===ae)throw new TypeError("A promise cannot be resolved with itself.");var Le=ae._lib&&Z();Ne&&typeof Ne.then=="function"?ne(ae,function(Ge,st){Ne instanceof $?Ne._then(Ge,st):Ne.then(Ge,st)}):(ae._state=!0,ae._value=Ne,_e(ae)),Le&&G()}},ve.bind(null,ae))}catch(Ne){ve(ae,Ne)}}(this,M)}var Ue={get:function(){var M=Ee,z=Zt;function ne(ae,me){var Ne=this,Le=!M.global&&(M!==Ee||z!==Zt),Ge=Le&&!Mr(),st=new $(function(at,pt){ze(Ne,new tt(Vt(ae,M,Le,Ge),Vt(me,M,Le,Ge),at,pt,M))});return this._consoleTask&&(st._consoleTask=this._consoleTask),st}return ne.prototype=lt,ne},set:function(M){y(this,"then",M&&M.prototype===lt?Ue:{get:function(){return M},set:Ue.set})}};function tt(M,z,ne,ae,me){this.onFulfilled=typeof M=="function"?M:null,this.onRejected=typeof z=="function"?z:null,this.resolve=ne,this.reject=ae,this.psd=me}function ve(M,z){var ne,ae;be.push(z),M._state===null&&(ne=M._lib&&Z(),z=ke(z),M._state=!1,M._value=z,ae=M,X.some(function(me){return me._value===ae._value})||X.push(ae),_e(M),ne&&G())}function _e(M){var z=M._listeners;M._listeners=[];for(var ne=0,ae=z.length;ne<ae;++ne)ze(M,z[ne]);var me=M._PSD;--me.ref||me.finalize(),ft===0&&(++ft,Ht(function(){--ft==0&&J()},[]))}function ze(M,z){if(M._state!==null){var ne=M._state?z.onFulfilled:z.onRejected;if(ne===null)return(M._state?z.resolve:z.reject)(M._value);++z.psd.ref,++ft,Ht(Ct,[ne,M,z])}else M._listeners.push(z)}function Ct(M,z,ne){try{var ae,me=z._value;!z._state&&be.length&&(be=[]),ae=Be&&z._consoleTask?z._consoleTask.run(function(){return M(me)}):M(me),z._state||be.indexOf(me)!==-1||function(Ne){for(var Le=X.length;Le;)if(X[--Le]._value===Ne._value)return X.splice(Le,1)}(z),ne.resolve(ae)}catch(Ne){ne.reject(Ne)}finally{--ft==0&&J(),--ne.psd.ref||ne.psd.finalize()}}function fe(){nt(ge,function(){Z()&&G()})}function Z(){var M=we;return F=we=!1,M}function G(){var M,z,ne;do for(;0<le.length;)for(M=le,le=[],ne=M.length,z=0;z<ne;++z){var ae=M[z];ae[0].apply(null,ae[1])}while(0<le.length);F=we=!0}function J(){var M=X;X=[],M.forEach(function(ae){ae._PSD.onunhandled.call(null,ae._value,ae)});for(var z=et.slice(0),ne=z.length;ne;)z[--ne]()}function xe(M){return new $(lt,!1,M)}function De(M,z){var ne=Ee;return function(){var ae=Z(),me=Ee;try{return kr(ne,!0),M.apply(this,arguments)}catch(Ne){z&&z(Ne)}finally{kr(me,!1),ae&&G()}}}h($.prototype,{then:Ue,_then:function(M,z){ze(this,new tt(null,null,M,z,Ee))},catch:function(M){if(arguments.length===1)return this.then(null,M);var z=M,ne=arguments[1];return typeof z=="function"?this.then(null,function(ae){return(ae instanceof z?ne:xe)(ae)}):this.then(null,function(ae){return(ae&&ae.name===z?ne:xe)(ae)})},finally:function(M){return this.then(function(z){return $.resolve(M()).then(function(){return z})},function(z){return $.resolve(M()).then(function(){return xe(z)})})},timeout:function(M,z){var ne=this;return M<1/0?new $(function(ae,me){var Ne=setTimeout(function(){return me(new Ce.Timeout(z))},M);ne.then(ae,me).finally(clearTimeout.bind(null,Ne))}):this}}),typeof Symbol<"u"&&Symbol.toStringTag&&y($.prototype,Symbol.toStringTag,"Dexie.Promise"),ge.env=mn(),h($,{all:function(){var M=W.apply(null,arguments).map(rs);return new $(function(z,ne){M.length===0&&z([]);var ae=M.length;M.forEach(function(me,Ne){return $.resolve(me).then(function(Le){M[Ne]=Le,--ae||z(M)},ne)})})},resolve:function(M){return M instanceof $?M:M&&typeof M.then=="function"?new $(function(z,ne){M.then(z,ne)}):new $(lt,!0,M)},reject:xe,race:function(){var M=W.apply(null,arguments).map(rs);return new $(function(z,ne){M.map(function(ae){return $.resolve(ae).then(z,ne)})})},PSD:{get:function(){return Ee},set:function(M){return Ee=M}},totalEchoes:{get:function(){return Zt}},newPSD:fn,usePSD:nt,scheduler:{get:function(){return Ht},set:function(M){Ht=M}},rejectionMapper:{get:function(){return ke},set:function(M){ke=M}},follow:function(M,z){return new $(function(ne,ae){return fn(function(me,Ne){var Le=Ee;Le.unhandleds=[],Le.onunhandled=Ne,Le.finalize=ye(function(){var Ge,st=this;Ge=function(){st.unhandleds.length===0?me():Ne(st.unhandleds[0])},et.push(function at(){Ge(),et.splice(et.indexOf(at),1)}),++ft,Ht(function(){--ft==0&&J()},[])},Le.finalize),M()},z,ne,ae)})}}),qt&&(qt.allSettled&&y($,"allSettled",function(){var M=W.apply(null,arguments).map(rs);return new $(function(z){M.length===0&&z([]);var ne=M.length,ae=new Array(ne);M.forEach(function(me,Ne){return $.resolve(me).then(function(Le){return ae[Ne]={status:"fulfilled",value:Le}},function(Le){return ae[Ne]={status:"rejected",reason:Le}}).then(function(){return--ne||z(ae)})})})}),qt.any&&typeof AggregateError<"u"&&y($,"any",function(){var M=W.apply(null,arguments).map(rs);return new $(function(z,ne){M.length===0&&ne(new AggregateError([]));var ae=M.length,me=new Array(ae);M.forEach(function(Ne,Le){return $.resolve(Ne).then(function(Ge){return z(Ge)},function(Ge){me[Le]=Ge,--ae||ne(new AggregateError(me))})})})}),qt.withResolvers&&($.withResolvers=qt.withResolvers));var He={awaits:0,echoes:0,id:0},wt=0,Qt=[],On=0,Zt=0,nn=0;function fn(M,z,ne,ae){var me=Ee,Ne=Object.create(me);return Ne.parent=me,Ne.ref=0,Ne.global=!1,Ne.id=++nn,ge.env,Ne.env=Ft?{Promise:$,PromiseProp:{value:$,configurable:!0,writable:!0},all:$.all,race:$.race,allSettled:$.allSettled,any:$.any,resolve:$.resolve,reject:$.reject}:{},z&&l(Ne,z),++me.ref,Ne.finalize=function(){--this.parent.ref||this.parent.finalize()},ae=nt(Ne,M,ne,ae),Ne.ref===0&&Ne.finalize(),ae}function br(){return He.id||(He.id=++wt),++He.awaits,He.echoes+=Tt,He.id}function Mr(){return!!He.awaits&&(--He.awaits==0&&(He.id=0),He.echoes=He.awaits*Tt,!0)}function rs(M){return He.echoes&&M&&M.constructor===qt?(br(),M.then(function(z){return Mr(),z},function(z){return Mr(),ir(z)})):M}function ss(){var M=Qt[Qt.length-1];Qt.pop(),kr(M,!1)}function kr(M,z){var ne,ae=Ee;(z?!He.echoes||On++&&M===Ee:!On||--On&&M===Ee)||queueMicrotask(z?(function(me){++Zt,He.echoes&&--He.echoes!=0||(He.echoes=He.awaits=He.id=0),Qt.push(Ee),kr(me,!0)}).bind(null,M):ss),M!==Ee&&(Ee=M,ae===ge&&(ge.env=mn()),Ft&&(ne=ge.env.Promise,z=M.env,(ae.global||M.global)&&(Object.defineProperty(i,"Promise",z.PromiseProp),ne.all=z.all,ne.race=z.race,ne.resolve=z.resolve,ne.reject=z.reject,z.allSettled&&(ne.allSettled=z.allSettled),z.any&&(ne.any=z.any))))}function mn(){var M=i.Promise;return Ft?{Promise:M,PromiseProp:Object.getOwnPropertyDescriptor(i,"Promise"),all:M.all,race:M.race,allSettled:M.allSettled,any:M.any,resolve:M.resolve,reject:M.reject}:{}}function nt(M,z,ne,ae,me){var Ne=Ee;try{return kr(M,!0),z(ne,ae,me)}finally{kr(Ne,!1)}}function Vt(M,z,ne,ae){return typeof M!="function"?M:function(){var me=Ee;ne&&br(),kr(z,!0);try{return M.apply(this,arguments)}finally{kr(me,!1),ae&&queueMicrotask(Mr)}}}function gn(M){Promise===qt&&He.echoes===0?On===0?M():enqueueNativeMicroTask(M):setTimeout(M,0)}(""+Za).indexOf("[native code]")===-1&&(br=Mr=We);var ir=$.reject,Rs="",ts="Invalid key provided. Keys must be of type string, number, Date or Array<string | number | Date>.",Di="String expected.",di=[],Ga="__dbnames",pa="readonly",Hs="readwrite";function Yo(M,z){return M?z?function(){return M.apply(this,arguments)&&z.apply(this,arguments)}:M:z}var wl={type:3,lower:-1/0,lowerOpen:!1,upper:[[]],upperOpen:!1};function Sf(M){return typeof M!="string"||/\./.test(M)?function(z){return z}:function(z){return z[M]===void 0&&M in z&&delete(z=H(z))[M],z}}function fg(){throw Ce.Type()}function Fr(M,z){try{var ne=Ib(M),ae=Ib(z);if(ne!==ae)return ne==="Array"?1:ae==="Array"?-1:ne==="binary"?1:ae==="binary"?-1:ne==="string"?1:ae==="string"?-1:ne==="Date"?1:ae!=="Date"?NaN:-1;switch(ne){case"number":case"Date":case"string":return z<M?1:M<z?-1:0;case"binary":return function(me,Ne){for(var Le=me.length,Ge=Ne.length,st=Le<Ge?Le:Ge,at=0;at<st;++at)if(me[at]!==Ne[at])return me[at]<Ne[at]?-1:1;return Le===Ge?0:Le<Ge?-1:1}(Ka(M),Ka(z));case"Array":return function(me,Ne){for(var Le=me.length,Ge=Ne.length,st=Le<Ge?Le:Ge,at=0;at<st;++at){var pt=Fr(me[at],Ne[at]);if(pt!==0)return pt}return Le===Ge?0:Le<Ge?-1:1}(M,z)}}catch{}return NaN}function Ib(M){var z=typeof M;return z!="object"?z:ArrayBuffer.isView(M)?"binary":(M=K(M),M==="ArrayBuffer"?"binary":M)}function Ka(M){return M instanceof Uint8Array?M:ArrayBuffer.isView(M)?new Uint8Array(M.buffer,M.byteOffset,M.byteLength):new Uint8Array(M)}var jb=(Ns.prototype._trans=function(M,z,ne){var ae=this._tx||Ee.trans,me=this.name,Ne=Be&&typeof console<"u"&&console.createTask&&console.createTask("Dexie: ".concat(M==="readonly"?"read":"write"," ").concat(this.name));function Le(at,pt,Je){if(!Je.schema[me])throw new Ce.NotFound("Table "+me+" not part of transaction");return z(Je.idbtrans,Je)}var Ge=Z();try{var st=ae&&ae.db._novip===this.db._novip?ae===Ee.trans?ae._promise(M,Le,ne):fn(function(){return ae._promise(M,Le,ne)},{trans:ae,transless:Ee.transless||Ee}):function at(pt,Je,gt,rt){if(pt.idbdb&&(pt._state.openComplete||Ee.letThrough||pt._vip)){var ht=pt._createTransaction(Je,gt,pt._dbSchema);try{ht.create(),pt._state.PR1398_maxLoop=3}catch(yt){return yt.name===Fe.InvalidState&&pt.isOpen()&&0<--pt._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),pt.close({disableAutoOpen:!1}),pt.open().then(function(){return at(pt,Je,gt,rt)})):ir(yt)}return ht._promise(Je,function(yt,ot){return fn(function(){return Ee.trans=ht,rt(yt,ot,ht)})}).then(function(yt){if(Je==="readwrite")try{ht.idbtrans.commit()}catch{}return Je==="readonly"?yt:ht._completion.then(function(){return yt})})}if(pt._state.openComplete)return ir(new Ce.DatabaseClosed(pt._state.dbOpenError));if(!pt._state.isBeingOpened){if(!pt._state.autoOpen)return ir(new Ce.DatabaseClosed);pt.open().catch(We)}return pt._state.dbReadyPromise.then(function(){return at(pt,Je,gt,rt)})}(this.db,M,[this.name],Le);return Ne&&(st._consoleTask=Ne,st=st.catch(function(at){return console.trace(at),ir(at)})),st}finally{Ge&&G()}},Ns.prototype.get=function(M,z){var ne=this;return M&&M.constructor===Object?this.where(M).first(z):M==null?ir(new Ce.Type("Invalid argument to Table.get()")):this._trans("readonly",function(ae){return ne.core.get({trans:ae,key:M}).then(function(me){return ne.hook.reading.fire(me)})}).then(z)},Ns.prototype.where=function(M){if(typeof M=="string")return new this.db.WhereClause(this,M);if(o(M))return new this.db.WhereClause(this,"[".concat(M.join("+"),"]"));var z=a(M);if(z.length===1)return this.where(z[0]).equals(M[z[0]]);var ne=this.schema.indexes.concat(this.schema.primKey).filter(function(Ge){if(Ge.compound&&z.every(function(at){return 0<=Ge.keyPath.indexOf(at)})){for(var st=0;st<z.length;++st)if(z.indexOf(Ge.keyPath[st])===-1)return!1;return!0}return!1}).sort(function(Ge,st){return Ge.keyPath.length-st.keyPath.length})[0];if(ne&&this.db._maxKey!==Rs){var Ne=ne.keyPath.slice(0,z.length);return this.where(Ne).equals(Ne.map(function(st){return M[st]}))}!ne&&Be&&console.warn("The query ".concat(JSON.stringify(M)," on ").concat(this.name," would benefit from a ")+"compound index [".concat(z.join("+"),"]"));var ae=this.schema.idxByName;function me(Ge,st){return Fr(Ge,st)===0}var Le=z.reduce(function(Je,st){var at=Je[0],pt=Je[1],Je=ae[st],gt=M[st];return[at||Je,at||!Je?Yo(pt,Je&&Je.multi?function(rt){return rt=T(rt,st),o(rt)&&rt.some(function(ht){return me(gt,ht)})}:function(rt){return me(gt,T(rt,st))}):pt]},[null,null]),Ne=Le[0],Le=Le[1];return Ne?this.where(Ne.name).equals(M[Ne.keyPath]).filter(Le):ne?this.filter(Le):this.where(z).equals("")},Ns.prototype.filter=function(M){return this.toCollection().and(M)},Ns.prototype.count=function(M){return this.toCollection().count(M)},Ns.prototype.offset=function(M){return this.toCollection().offset(M)},Ns.prototype.limit=function(M){return this.toCollection().limit(M)},Ns.prototype.each=function(M){return this.toCollection().each(M)},Ns.prototype.toArray=function(M){return this.toCollection().toArray(M)},Ns.prototype.toCollection=function(){return new this.db.Collection(new this.db.WhereClause(this))},Ns.prototype.orderBy=function(M){return new this.db.Collection(new this.db.WhereClause(this,o(M)?"[".concat(M.join("+"),"]"):M))},Ns.prototype.reverse=function(){return this.toCollection().reverse()},Ns.prototype.mapToClass=function(M){var z,ne=this.db,ae=this.name;function me(){return z!==null&&z.apply(this,arguments)||this}(this.schema.mappedClass=M).prototype instanceof fg&&(function(st,at){if(typeof at!="function"&&at!==null)throw new TypeError("Class extends value "+String(at)+" is not a constructor or null");function pt(){this.constructor=st}n(st,at),st.prototype=at===null?Object.create(at):(pt.prototype=at.prototype,new pt)}(me,z=M),Object.defineProperty(me.prototype,"db",{get:function(){return ne},enumerable:!1,configurable:!0}),me.prototype.table=function(){return ae},M=me);for(var Ne=new Set,Le=M.prototype;Le;Le=c(Le))Object.getOwnPropertyNames(Le).forEach(function(st){return Ne.add(st)});function Ge(st){if(!st)return st;var at,pt=Object.create(M.prototype);for(at in st)if(!Ne.has(at))try{pt[at]=st[at]}catch{}return pt}return this.schema.readHook&&this.hook.reading.unsubscribe(this.schema.readHook),this.schema.readHook=Ge,this.hook("reading",Ge),M},Ns.prototype.defineClass=function(){return this.mapToClass(function(M){l(this,M)})},Ns.prototype.add=function(M,z){var ne=this,ae=this.schema.primKey,me=ae.auto,Ne=ae.keyPath,Le=M;return Ne&&me&&(Le=Sf(Ne)(M)),this._trans("readwrite",function(Ge){return ne.core.mutate({trans:Ge,type:"add",keys:z!=null?[z]:null,values:[Le]})}).then(function(Ge){return Ge.numFailures?$.reject(Ge.failures[0]):Ge.lastResult}).then(function(Ge){if(Ne)try{A(M,Ne,Ge)}catch{}return Ge})},Ns.prototype.update=function(M,z){return typeof M!="object"||o(M)?this.where(":id").equals(M).modify(z):(M=T(M,this.schema.primKey.keyPath),M===void 0?ir(new Ce.InvalidArgument("Given object does not contain its primary key")):this.where(":id").equals(M).modify(z))},Ns.prototype.put=function(M,z){var ne=this,ae=this.schema.primKey,me=ae.auto,Ne=ae.keyPath,Le=M;return Ne&&me&&(Le=Sf(Ne)(M)),this._trans("readwrite",function(Ge){return ne.core.mutate({trans:Ge,type:"put",values:[Le],keys:z!=null?[z]:null})}).then(function(Ge){return Ge.numFailures?$.reject(Ge.failures[0]):Ge.lastResult}).then(function(Ge){if(Ne)try{A(M,Ne,Ge)}catch{}return Ge})},Ns.prototype.delete=function(M){var z=this;return this._trans("readwrite",function(ne){return z.core.mutate({trans:ne,type:"delete",keys:[M]})}).then(function(ne){return ne.numFailures?$.reject(ne.failures[0]):void 0})},Ns.prototype.clear=function(){var M=this;return this._trans("readwrite",function(z){return M.core.mutate({trans:z,type:"deleteRange",range:wl})}).then(function(z){return z.numFailures?$.reject(z.failures[0]):void 0})},Ns.prototype.bulkGet=function(M){var z=this;return this._trans("readonly",function(ne){return z.core.getMany({keys:M,trans:ne}).then(function(ae){return ae.map(function(me){return z.hook.reading.fire(me)})})})},Ns.prototype.bulkAdd=function(M,z,ne){var ae=this,me=Array.isArray(z)?z:void 0,Ne=(ne=ne||(me?void 0:z))?ne.allKeys:void 0;return this._trans("readwrite",function(Le){var at=ae.schema.primKey,Ge=at.auto,at=at.keyPath;if(at&&me)throw new Ce.InvalidArgument("bulkAdd(): keys argument invalid on tables with inbound keys");if(me&&me.length!==M.length)throw new Ce.InvalidArgument("Arguments objects and keys must have the same length");var st=M.length,at=at&&Ge?M.map(Sf(at)):M;return ae.core.mutate({trans:Le,type:"add",keys:me,values:at,wantResults:Ne}).then(function(ht){var Je=ht.numFailures,gt=ht.results,rt=ht.lastResult,ht=ht.failures;if(Je===0)return Ne?gt:rt;throw new Oe("".concat(ae.name,".bulkAdd(): ").concat(Je," of ").concat(st," operations failed"),ht)})})},Ns.prototype.bulkPut=function(M,z,ne){var ae=this,me=Array.isArray(z)?z:void 0,Ne=(ne=ne||(me?void 0:z))?ne.allKeys:void 0;return this._trans("readwrite",function(Le){var at=ae.schema.primKey,Ge=at.auto,at=at.keyPath;if(at&&me)throw new Ce.InvalidArgument("bulkPut(): keys argument invalid on tables with inbound keys");if(me&&me.length!==M.length)throw new Ce.InvalidArgument("Arguments objects and keys must have the same length");var st=M.length,at=at&&Ge?M.map(Sf(at)):M;return ae.core.mutate({trans:Le,type:"put",keys:me,values:at,wantResults:Ne}).then(function(ht){var Je=ht.numFailures,gt=ht.results,rt=ht.lastResult,ht=ht.failures;if(Je===0)return Ne?gt:rt;throw new Oe("".concat(ae.name,".bulkPut(): ").concat(Je," of ").concat(st," operations failed"),ht)})})},Ns.prototype.bulkUpdate=function(M){var z=this,ne=this.core,ae=M.map(function(Le){return Le.key}),me=M.map(function(Le){return Le.changes}),Ne=[];return this._trans("readwrite",function(Le){return ne.getMany({trans:Le,keys:ae,cache:"clone"}).then(function(Ge){var st=[],at=[];M.forEach(function(Je,gt){var rt=Je.key,ht=Je.changes,yt=Ge[gt];if(yt){for(var ot=0,kt=Object.keys(ht);ot<kt.length;ot++){var Nt=kt[ot],Mt=ht[Nt];if(Nt===z.schema.primKey.keyPath){if(Fr(Mt,rt)!==0)throw new Ce.Constraint("Cannot update primary key in bulkUpdate()")}else A(yt,Nt,Mt)}Ne.push(gt),st.push(rt),at.push(yt)}});var pt=st.length;return ne.mutate({trans:Le,type:"put",keys:st,values:at,updates:{keys:ae,changeSpecs:me}}).then(function(Je){var gt=Je.numFailures,rt=Je.failures;if(gt===0)return pt;for(var ht=0,yt=Object.keys(rt);ht<yt.length;ht++){var ot,kt=yt[ht],Nt=Ne[Number(kt)];Nt!=null&&(ot=rt[kt],delete rt[kt],rt[Nt]=ot)}throw new Oe("".concat(z.name,".bulkUpdate(): ").concat(gt," of ").concat(pt," operations failed"),rt)})})})},Ns.prototype.bulkDelete=function(M){var z=this,ne=M.length;return this._trans("readwrite",function(ae){return z.core.mutate({trans:ae,type:"delete",keys:M})}).then(function(Le){var me=Le.numFailures,Ne=Le.lastResult,Le=Le.failures;if(me===0)return Ne;throw new Oe("".concat(z.name,".bulkDelete(): ").concat(me," of ").concat(ne," operations failed"),Le)})},Ns);function Ns(){}function Kc(M){function z(Le,Ge){if(Ge){for(var st=arguments.length,at=new Array(st-1);--st;)at[st-1]=arguments[st];return ne[Le].subscribe.apply(null,at),M}if(typeof Le=="string")return ne[Le]}var ne={};z.addEventType=Ne;for(var ae=1,me=arguments.length;ae<me;++ae)Ne(arguments[ae]);return z;function Ne(Le,Ge,st){if(typeof Le!="object"){var at;Ge=Ge||se;var pt={subscribers:[],fire:st=st||We,subscribe:function(Je){pt.subscribers.indexOf(Je)===-1&&(pt.subscribers.push(Je),pt.fire=Ge(pt.fire,Je))},unsubscribe:function(Je){pt.subscribers=pt.subscribers.filter(function(gt){return gt!==Je}),pt.fire=pt.subscribers.reduce(Ge,st)}};return ne[Le]=z[Le]=pt}a(at=Le).forEach(function(Je){var gt=at[Je];if(o(gt))Ne(Je,at[Je][0],at[Je][1]);else{if(gt!=="asap")throw new Ce.InvalidArgument("Invalid event config");var rt=Ne(Je,je,function(){for(var ht=arguments.length,yt=new Array(ht);ht--;)yt[ht]=arguments[ht];rt.subscribers.forEach(function(ot){C(function(){ot.apply(null,yt)})})})}})}}function Cf(M,z){return b(z).from({prototype:M}),z}function lc(M,z){return!(M.filter||M.algorithm||M.or)&&(z?M.justLimit:!M.replayFilter)}function Pb(M,z){M.filter=Yo(M.filter,z)}function Ea(M,z,ne){var ae=M.replayFilter;M.replayFilter=ae?function(){return Yo(ae(),z())}:z,M.justLimit=ne&&!ae}function kf(M,z){if(M.isPrimKey)return z.primaryKey;var ne=z.getIndexByKeyPath(M.index);if(!ne)throw new Ce.Schema("KeyPath "+M.index+" on object store "+z.name+" is not indexed");return ne}function Ob(M,z,ne){var ae=kf(M,z.schema);return z.openCursor({trans:ne,values:!M.keysOnly,reverse:M.dir==="prev",unique:!!M.unique,query:{index:ae,range:M.range}})}function Ef(M,z,ne,ae){var me=M.replayFilter?Yo(M.filter,M.replayFilter()):M.filter;if(M.or){var Ne={},Le=function(Ge,st,at){var pt,Je;me&&!me(st,at,function(gt){return st.stop(gt)},function(gt){return st.fail(gt)})||((Je=""+(pt=st.primaryKey))=="[object ArrayBuffer]"&&(Je=""+new Uint8Array(pt)),d(Ne,Je)||(Ne[Je]=!0,z(Ge,st,at)))};return Promise.all([M.or._iterate(Le,ne),Zu(Ob(M,ae,ne),M.algorithm,Le,!M.keysOnly&&M.valueMapper)])}return Zu(Ob(M,ae,ne),Yo(M.algorithm,me),z,!M.keysOnly&&M.valueMapper)}function Zu(M,z,ne,ae){var me=De(ae?function(Ne,Le,Ge){return ne(ae(Ne),Le,Ge)}:ne);return M.then(function(Ne){if(Ne)return Ne.start(function(){var Le=function(){return Ne.continue()};z&&!z(Ne,function(Ge){return Le=Ge},function(Ge){Ne.stop(Ge),Le=We},function(Ge){Ne.fail(Ge),Le=We})||me(Ne.value,Ne,function(Ge){return Le=Ge}),Le()})})}var Tf=(Db.prototype.execute=function(M){var z=this["@@propmod"];if(z.add!==void 0){var ne=z.add;if(o(ne))return s(s([],o(M)?M:[],!0),ne).sort();if(typeof ne=="number")return(Number(M)||0)+ne;if(typeof ne=="bigint")try{return BigInt(M)+ne}catch{return BigInt(0)+ne}throw new TypeError("Invalid term ".concat(ne))}if(z.remove!==void 0){var ae=z.remove;if(o(ae))return o(M)?M.filter(function(me){return!ae.includes(me)}).sort():[];if(typeof ae=="number")return Number(M)-ae;if(typeof ae=="bigint")try{return BigInt(M)-ae}catch{return BigInt(0)-ae}throw new TypeError("Invalid subtrahend ".concat(ae))}return ne=(ne=z.replacePrefix)===null||ne===void 0?void 0:ne[0],ne&&typeof M=="string"&&M.startsWith(ne)?z.replacePrefix[1]+M.substring(ne.length):M},Db);function Db(M){this["@@propmod"]=M}var Af=(Kr.prototype._read=function(M,z){var ne=this._ctx;return ne.error?ne.table._trans(null,ir.bind(null,ne.error)):ne.table._trans("readonly",M).then(z)},Kr.prototype._write=function(M){var z=this._ctx;return z.error?z.table._trans(null,ir.bind(null,z.error)):z.table._trans("readwrite",M,"locked")},Kr.prototype._addAlgorithm=function(M){var z=this._ctx;z.algorithm=Yo(z.algorithm,M)},Kr.prototype._iterate=function(M,z){return Ef(this._ctx,M,z,this._ctx.table.core)},Kr.prototype.clone=function(M){var z=Object.create(this.constructor.prototype),ne=Object.create(this._ctx);return M&&l(ne,M),z._ctx=ne,z},Kr.prototype.raw=function(){return this._ctx.valueMapper=null,this},Kr.prototype.each=function(M){var z=this._ctx;return this._read(function(ne){return Ef(z,M,ne,z.table.core)})},Kr.prototype.count=function(M){var z=this;return this._read(function(ne){var ae=z._ctx,me=ae.table.core;if(lc(ae,!0))return me.count({trans:ne,query:{index:kf(ae,me.schema),range:ae.range}}).then(function(Le){return Math.min(Le,ae.limit)});var Ne=0;return Ef(ae,function(){return++Ne,!1},ne,me).then(function(){return Ne})}).then(M)},Kr.prototype.sortBy=function(M,z){var ne=M.split(".").reverse(),ae=ne[0],me=ne.length-1;function Ne(st,at){return at?Ne(st[ne[at]],at-1):st[ae]}var Le=this._ctx.dir==="next"?1:-1;function Ge(st,at){return Fr(Ne(st,me),Ne(at,me))*Le}return this.toArray(function(st){return st.sort(Ge)}).then(z)},Kr.prototype.toArray=function(M){var z=this;return this._read(function(ne){var ae=z._ctx;if(ae.dir==="next"&&lc(ae,!0)&&0<ae.limit){var me=ae.valueMapper,Ne=kf(ae,ae.table.core.schema);return ae.table.core.query({trans:ne,limit:ae.limit,values:!0,query:{index:Ne,range:ae.range}}).then(function(Ge){return Ge=Ge.result,me?Ge.map(me):Ge})}var Le=[];return Ef(ae,function(Ge){return Le.push(Ge)},ne,ae.table.core).then(function(){return Le})},M)},Kr.prototype.offset=function(M){var z=this._ctx;return M<=0||(z.offset+=M,lc(z)?Ea(z,function(){var ne=M;return function(ae,me){return ne===0||(ne===1?--ne:me(function(){ae.advance(ne),ne=0}),!1)}}):Ea(z,function(){var ne=M;return function(){return--ne<0}})),this},Kr.prototype.limit=function(M){return this._ctx.limit=Math.min(this._ctx.limit,M),Ea(this._ctx,function(){var z=M;return function(ne,ae,me){return--z<=0&&ae(me),0<=z}},!0),this},Kr.prototype.until=function(M,z){return Pb(this._ctx,function(ne,ae,me){return!M(ne.value)||(ae(me),z)}),this},Kr.prototype.first=function(M){return this.limit(1).toArray(function(z){return z[0]}).then(M)},Kr.prototype.last=function(M){return this.reverse().first(M)},Kr.prototype.filter=function(M){var z;return Pb(this._ctx,function(ne){return M(ne.value)}),(z=this._ctx).isMatch=Yo(z.isMatch,M),this},Kr.prototype.and=function(M){return this.filter(M)},Kr.prototype.or=function(M){return new this.db.WhereClause(this._ctx.table,M,this)},Kr.prototype.reverse=function(){return this._ctx.dir=this._ctx.dir==="prev"?"next":"prev",this._ondirectionchange&&this._ondirectionchange(this._ctx.dir),this},Kr.prototype.desc=function(){return this.reverse()},Kr.prototype.eachKey=function(M){var z=this._ctx;return z.keysOnly=!z.isMatch,this.each(function(ne,ae){M(ae.key,ae)})},Kr.prototype.eachUniqueKey=function(M){return this._ctx.unique="unique",this.eachKey(M)},Kr.prototype.eachPrimaryKey=function(M){var z=this._ctx;return z.keysOnly=!z.isMatch,this.each(function(ne,ae){M(ae.primaryKey,ae)})},Kr.prototype.keys=function(M){var z=this._ctx;z.keysOnly=!z.isMatch;var ne=[];return this.each(function(ae,me){ne.push(me.key)}).then(function(){return ne}).then(M)},Kr.prototype.primaryKeys=function(M){var z=this._ctx;if(z.dir==="next"&&lc(z,!0)&&0<z.limit)return this._read(function(ae){var me=kf(z,z.table.core.schema);return z.table.core.query({trans:ae,values:!1,limit:z.limit,query:{index:me,range:z.range}})}).then(function(ae){return ae.result}).then(M);z.keysOnly=!z.isMatch;var ne=[];return this.each(function(ae,me){ne.push(me.primaryKey)}).then(function(){return ne}).then(M)},Kr.prototype.uniqueKeys=function(M){return this._ctx.unique="unique",this.keys(M)},Kr.prototype.firstKey=function(M){return this.limit(1).keys(function(z){return z[0]}).then(M)},Kr.prototype.lastKey=function(M){return this.reverse().firstKey(M)},Kr.prototype.distinct=function(){var M=this._ctx,M=M.index&&M.table.schema.idxByName[M.index];if(!M||!M.multi)return this;var z={};return Pb(this._ctx,function(me){var ae=me.primaryKey.toString(),me=d(z,ae);return z[ae]=!0,!me}),this},Kr.prototype.modify=function(M){var z=this,ne=this._ctx;return this._write(function(ae){var me,Ne,Le;Le=typeof M=="function"?M:(me=a(M),Ne=me.length,function(ot){for(var kt=!1,Nt=0;Nt<Ne;++Nt){var Mt=me[Nt],Ot=M[Mt],Xt=T(ot,Mt);Ot instanceof Tf?(A(ot,Mt,Ot.execute(Xt)),kt=!0):Xt!==Ot&&(A(ot,Mt,Ot),kt=!0)}return kt});var Ge=ne.table.core,Je=Ge.schema.primaryKey,st=Je.outbound,at=Je.extractKey,pt=200,Je=z.db._options.modifyChunkSize;Je&&(pt=typeof Je=="object"?Je[Ge.name]||Je["*"]||200:Je);function gt(ot,Mt){var Nt=Mt.failures,Mt=Mt.numFailures;ht+=ot-Mt;for(var Ot=0,Xt=a(Nt);Ot<Xt.length;Ot++){var rn=Xt[Ot];rt.push(Nt[rn])}}var rt=[],ht=0,yt=[];return z.clone().primaryKeys().then(function(ot){function kt(Mt){var Ot=Math.min(pt,ot.length-Mt);return Ge.getMany({trans:ae,keys:ot.slice(Mt,Mt+Ot),cache:"immutable"}).then(function(Xt){for(var rn=[],Gt=[],en=st?[]:null,on=[],Kt=0;Kt<Ot;++Kt){var bn=Xt[Kt],zn={value:H(bn),primKey:ot[Mt+Kt]};Le.call(zn,zn.value,zn)!==!1&&(zn.value==null?on.push(ot[Mt+Kt]):st||Fr(at(bn),at(zn.value))===0?(Gt.push(zn.value),st&&en.push(ot[Mt+Kt])):(on.push(ot[Mt+Kt]),rn.push(zn.value)))}return Promise.resolve(0<rn.length&&Ge.mutate({trans:ae,type:"add",values:rn}).then(function(Hn){for(var mr in Hn.failures)on.splice(parseInt(mr),1);gt(rn.length,Hn)})).then(function(){return(0<Gt.length||Nt&&typeof M=="object")&&Ge.mutate({trans:ae,type:"put",keys:en,values:Gt,criteria:Nt,changeSpec:typeof M!="function"&&M,isAdditionalChunk:0<Mt}).then(function(Hn){return gt(Gt.length,Hn)})}).then(function(){return(0<on.length||Nt&&M===hg)&&Ge.mutate({trans:ae,type:"delete",keys:on,criteria:Nt,isAdditionalChunk:0<Mt}).then(function(Hn){return gt(on.length,Hn)})}).then(function(){return ot.length>Mt+Ot&&kt(Mt+pt)})})}var Nt=lc(ne)&&ne.limit===1/0&&(typeof M!="function"||M===hg)&&{index:ne.index,range:ne.range};return kt(0).then(function(){if(0<rt.length)throw new de("Error modifying one or more objects",rt,ht,yt);return ot.length})})})},Kr.prototype.delete=function(){var M=this._ctx,z=M.range;return lc(M)&&(M.isPrimKey||z.type===3)?this._write(function(ne){var ae=M.table.core.schema.primaryKey,me=z;return M.table.core.count({trans:ne,query:{index:ae,range:me}}).then(function(Ne){return M.table.core.mutate({trans:ne,type:"deleteRange",range:me}).then(function(Le){var Ge=Le.failures;if(Le.lastResult,Le.results,Le=Le.numFailures,Le)throw new de("Could not delete some values",Object.keys(Ge).map(function(st){return Ge[st]}),Ne-Le);return Ne-Le})})}):this.modify(hg)},Kr);function Kr(){}var hg=function(M,z){return z.value=null};function C_(M,z){return M<z?-1:M===z?0:1}function Fb(M,z){return z<M?-1:M===z?0:1}function Ya(M,z,ne){return M=M instanceof Ju?new M.Collection(M):M,M._ctx.error=new(ne||TypeError)(z),M}function Rf(M){return new M.Collection(M,function(){return pg("")}).limit(0)}function Xu(M,z,ne,ae){var me,Ne,Le,Ge,st,at,pt,Je=ne.length;if(!ne.every(function(ht){return typeof ht=="string"}))return Ya(M,Di);function gt(ht){me=ht==="next"?function(ot){return ot.toUpperCase()}:function(ot){return ot.toLowerCase()},Ne=ht==="next"?function(ot){return ot.toLowerCase()}:function(ot){return ot.toUpperCase()},Le=ht==="next"?C_:Fb;var yt=ne.map(function(ot){return{lower:Ne(ot),upper:me(ot)}}).sort(function(ot,kt){return Le(ot.lower,kt.lower)});Ge=yt.map(function(ot){return ot.upper}),st=yt.map(function(ot){return ot.lower}),pt=(at=ht)==="next"?"":ae}gt("next"),M=new M.Collection(M,function(){return _l(Ge[0],st[Je-1]+ae)}),M._ondirectionchange=function(ht){gt(ht)};var rt=0;return M._addAlgorithm(function(ht,yt,ot){var kt=ht.key;if(typeof kt!="string")return!1;var Nt=Ne(kt);if(z(Nt,st,rt))return!0;for(var Mt=null,Ot=rt;Ot<Je;++Ot){var Xt=function(rn,Gt,en,on,Kt,bn){for(var zn=Math.min(rn.length,on.length),Hn=-1,mr=0;mr<zn;++mr){var ma=Gt[mr];if(ma!==on[mr])return Kt(rn[mr],en[mr])<0?rn.substr(0,mr)+en[mr]+en.substr(mr+1):Kt(rn[mr],on[mr])<0?rn.substr(0,mr)+on[mr]+en.substr(mr+1):0<=Hn?rn.substr(0,Hn)+Gt[Hn]+en.substr(Hn+1):null;Kt(rn[mr],ma)<0&&(Hn=mr)}return zn<on.length&&bn==="next"?rn+en.substr(rn.length):zn<rn.length&&bn==="prev"?rn.substr(0,en.length):Hn<0?null:rn.substr(0,Hn)+on[Hn]+en.substr(Hn+1)}(kt,Nt,Ge[Ot],st[Ot],Le,at);Xt===null&&Mt===null?rt=Ot+1:(Mt===null||0<Le(Mt,Xt))&&(Mt=Xt)}return yt(Mt!==null?function(){ht.continue(Mt+pt)}:ot),!1}),M}function _l(M,z,ne,ae){return{type:2,lower:M,upper:z,lowerOpen:ne,upperOpen:ae}}function pg(M){return{type:1,lower:M,upper:M}}var Ju=(Object.defineProperty(Ls.prototype,"Collection",{get:function(){return this._ctx.table.db.Collection},enumerable:!1,configurable:!0}),Ls.prototype.between=function(M,z,ne,ae){ne=ne!==!1,ae=ae===!0;try{return 0<this._cmp(M,z)||this._cmp(M,z)===0&&(ne||ae)&&(!ne||!ae)?Rf(this):new this.Collection(this,function(){return _l(M,z,!ne,!ae)})}catch{return Ya(this,ts)}},Ls.prototype.equals=function(M){return M==null?Ya(this,ts):new this.Collection(this,function(){return pg(M)})},Ls.prototype.above=function(M){return M==null?Ya(this,ts):new this.Collection(this,function(){return _l(M,void 0,!0)})},Ls.prototype.aboveOrEqual=function(M){return M==null?Ya(this,ts):new this.Collection(this,function(){return _l(M,void 0,!1)})},Ls.prototype.below=function(M){return M==null?Ya(this,ts):new this.Collection(this,function(){return _l(void 0,M,!1,!0)})},Ls.prototype.belowOrEqual=function(M){return M==null?Ya(this,ts):new this.Collection(this,function(){return _l(void 0,M)})},Ls.prototype.startsWith=function(M){return typeof M!="string"?Ya(this,Di):this.between(M,M+Rs,!0,!0)},Ls.prototype.startsWithIgnoreCase=function(M){return M===""?this.startsWith(M):Xu(this,function(z,ne){return z.indexOf(ne[0])===0},[M],Rs)},Ls.prototype.equalsIgnoreCase=function(M){return Xu(this,function(z,ne){return z===ne[0]},[M],"")},Ls.prototype.anyOfIgnoreCase=function(){var M=W.apply(te,arguments);return M.length===0?Rf(this):Xu(this,function(z,ne){return ne.indexOf(z)!==-1},M,"")},Ls.prototype.startsWithAnyOfIgnoreCase=function(){var M=W.apply(te,arguments);return M.length===0?Rf(this):Xu(this,function(z,ne){return ne.some(function(ae){return z.indexOf(ae)===0})},M,Rs)},Ls.prototype.anyOf=function(){var M=this,z=W.apply(te,arguments),ne=this._cmp;try{z.sort(ne)}catch{return Ya(this,ts)}if(z.length===0)return Rf(this);var ae=new this.Collection(this,function(){return _l(z[0],z[z.length-1])});ae._ondirectionchange=function(Ne){ne=Ne==="next"?M._ascending:M._descending,z.sort(ne)};var me=0;return ae._addAlgorithm(function(Ne,Le,Ge){for(var st=Ne.key;0<ne(st,z[me]);)if(++me===z.length)return Le(Ge),!1;return ne(st,z[me])===0||(Le(function(){Ne.continue(z[me])}),!1)}),ae},Ls.prototype.notEqual=function(M){return this.inAnyRange([[-1/0,M],[M,this.db._maxKey]],{includeLowers:!1,includeUppers:!1})},Ls.prototype.noneOf=function(){var M=W.apply(te,arguments);if(M.length===0)return new this.Collection(this);try{M.sort(this._ascending)}catch{return Ya(this,ts)}var z=M.reduce(function(ne,ae){return ne?ne.concat([[ne[ne.length-1][1],ae]]):[[-1/0,ae]]},null);return z.push([M[M.length-1],this.db._maxKey]),this.inAnyRange(z,{includeLowers:!1,includeUppers:!1})},Ls.prototype.inAnyRange=function(kt,z){var ne=this,ae=this._cmp,me=this._ascending,Ne=this._descending,Le=this._min,Ge=this._max;if(kt.length===0)return Rf(this);if(!kt.every(function(Nt){return Nt[0]!==void 0&&Nt[1]!==void 0&&me(Nt[0],Nt[1])<=0}))return Ya(this,"First argument to inAnyRange() must be an Array of two-value Arrays [lower,upper] where upper must not be lower than lower",Ce.InvalidArgument);var st=!z||z.includeLowers!==!1,at=z&&z.includeUppers===!0,pt,Je=me;function gt(Nt,Mt){return Je(Nt[0],Mt[0])}try{(pt=kt.reduce(function(Nt,Mt){for(var Ot=0,Xt=Nt.length;Ot<Xt;++Ot){var rn=Nt[Ot];if(ae(Mt[0],rn[1])<0&&0<ae(Mt[1],rn[0])){rn[0]=Le(rn[0],Mt[0]),rn[1]=Ge(rn[1],Mt[1]);break}}return Ot===Xt&&Nt.push(Mt),Nt},[])).sort(gt)}catch{return Ya(this,ts)}var rt=0,ht=at?function(Nt){return 0<me(Nt,pt[rt][1])}:function(Nt){return 0<=me(Nt,pt[rt][1])},yt=st?function(Nt){return 0<Ne(Nt,pt[rt][0])}:function(Nt){return 0<=Ne(Nt,pt[rt][0])},ot=ht,kt=new this.Collection(this,function(){return _l(pt[0][0],pt[pt.length-1][1],!st,!at)});return kt._ondirectionchange=function(Nt){Je=Nt==="next"?(ot=ht,me):(ot=yt,Ne),pt.sort(gt)},kt._addAlgorithm(function(Nt,Mt,Ot){for(var Xt,rn=Nt.key;ot(rn);)if(++rt===pt.length)return Mt(Ot),!1;return!ht(Xt=rn)&&!yt(Xt)||(ne._cmp(rn,pt[rt][1])===0||ne._cmp(rn,pt[rt][0])===0||Mt(function(){Je===me?Nt.continue(pt[rt][0]):Nt.continue(pt[rt][1])}),!1)}),kt},Ls.prototype.startsWithAnyOf=function(){var M=W.apply(te,arguments);return M.every(function(z){return typeof z=="string"})?M.length===0?Rf(this):this.inAnyRange(M.map(function(z){return[z,z+Rs]})):Ya(this,"startsWithAnyOf() only works with strings")},Ls);function Ls(){}function Zo(M){return De(function(z){return Qu(z),M(z.target.error),!1})}function Qu(M){M.stopPropagation&&M.stopPropagation(),M.preventDefault&&M.preventDefault()}var Nf="storagemutated",ed="x-storagemutated-1",Zi=Kc(null,Nf),Lb=(Ta.prototype._lock=function(){return k(!Ee.global),++this._reculock,this._reculock!==1||Ee.global||(Ee.lockOwnerFor=this),this},Ta.prototype._unlock=function(){if(k(!Ee.global),--this._reculock==0)for(Ee.global||(Ee.lockOwnerFor=null);0<this._blockedFuncs.length&&!this._locked();){var M=this._blockedFuncs.shift();try{nt(M[1],M[0])}catch{}}return this},Ta.prototype._locked=function(){return this._reculock&&Ee.lockOwnerFor!==this},Ta.prototype.create=function(M){var z=this;if(!this.mode)return this;var ne=this.db.idbdb,ae=this.db._state.dbOpenError;if(k(!this.idbtrans),!M&&!ne)switch(ae&&ae.name){case"DatabaseClosedError":throw new Ce.DatabaseClosed(ae);case"MissingAPIError":throw new Ce.MissingAPI(ae.message,ae);default:throw new Ce.OpenFailed(ae)}if(!this.active)throw new Ce.TransactionInactive;return k(this._completion._state===null),(M=this.idbtrans=M||(this.db.core||ne).transaction(this.storeNames,this.mode,{durability:this.chromeTransactionDurability})).onerror=De(function(me){Qu(me),z._reject(M.error)}),M.onabort=De(function(me){Qu(me),z.active&&z._reject(new Ce.Abort(M.error)),z.active=!1,z.on("abort").fire(me)}),M.oncomplete=De(function(){z.active=!1,z._resolve(),"mutatedParts"in M&&Zi.storagemutated.fire(M.mutatedParts)}),this},Ta.prototype._promise=function(M,z,ne){var ae=this;if(M==="readwrite"&&this.mode!=="readwrite")return ir(new Ce.ReadOnly("Transaction is readonly"));if(!this.active)return ir(new Ce.TransactionInactive);if(this._locked())return new $(function(Ne,Le){ae._blockedFuncs.push([function(){ae._promise(M,z,ne).then(Ne,Le)},Ee])});if(ne)return fn(function(){var Ne=new $(function(Le,Ge){ae._lock();var st=z(Le,Ge,ae);st&&st.then&&st.then(Le,Ge)});return Ne.finally(function(){return ae._unlock()}),Ne._lib=!0,Ne});var me=new $(function(Ne,Le){var Ge=z(Ne,Le,ae);Ge&&Ge.then&&Ge.then(Ne,Le)});return me._lib=!0,me},Ta.prototype._root=function(){return this.parent?this.parent._root():this},Ta.prototype.waitFor=function(M){var z,ne=this._root(),ae=$.resolve(M);ne._waitingFor?ne._waitingFor=ne._waitingFor.then(function(){return ae}):(ne._waitingFor=ae,ne._waitingQueue=[],z=ne.idbtrans.objectStore(ne.storeNames[0]),function Ne(){for(++ne._spinCount;ne._waitingQueue.length;)ne._waitingQueue.shift()();ne._waitingFor&&(z.get(-1/0).onsuccess=Ne)}());var me=ne._waitingFor;return new $(function(Ne,Le){ae.then(function(Ge){return ne._waitingQueue.push(De(Ne.bind(null,Ge)))},function(Ge){return ne._waitingQueue.push(De(Le.bind(null,Ge)))}).finally(function(){ne._waitingFor===me&&(ne._waitingFor=null)})})},Ta.prototype.abort=function(){this.active&&(this.active=!1,this.idbtrans&&this.idbtrans.abort(),this._reject(new Ce.Abort))},Ta.prototype.table=function(M){var z=this._memoizedTables||(this._memoizedTables={});if(d(z,M))return z[M];var ne=this.schema[M];if(!ne)throw new Ce.NotFound("Table "+M+" not part of transaction");return ne=new this.db.Table(M,ne,this),ne.core=this.db.core.table(M),z[M]=ne},Ta);function Ta(){}function Sl(M,z,ne,ae,me,Ne,Le){return{name:M,keyPath:z,unique:ne,multi:ae,auto:me,compound:Ne,src:(ne&&!Le?"&":"")+(ae?"*":"")+(me?"++":"")+mg(z)}}function mg(M){return typeof M=="string"?M:M?"["+[].join.call(M,"+")+"]":""}function Mf(M,z,ne){return{name:M,primKey:z,indexes:ne,mappedClass:null,idxByName:(ae=function(me){return[me.name,me]},ne.reduce(function(me,Ne,Le){return Le=ae(Ne,Le),Le&&(me[Le[0]]=Le[1]),me},{}))};var ae}var If=function(M){try{return M.only([[]]),If=function(){return[[]]},[[]]}catch{return If=function(){return Rs},Rs}};function jf(M){return M==null?function(){}:typeof M=="string"?(z=M).split(".").length===1?function(ne){return ne[z]}:function(ne){return T(ne,z)}:function(ne){return T(ne,M)};var z}function vp(M){return[].slice.call(M)}var k_=0;function Si(M){return M==null?":id":typeof M=="string"?M:"[".concat(M.join("+"),"]")}function td(M,z,st){function ae(ot){if(ot.type===3)return null;if(ot.type===4)throw new Error("Cannot convert never type to IDBKeyRange");var rt=ot.lower,ht=ot.upper,yt=ot.lowerOpen,ot=ot.upperOpen;return rt===void 0?ht===void 0?null:z.upperBound(ht,!!ot):ht===void 0?z.lowerBound(rt,!!yt):z.bound(rt,ht,!!yt,!!ot)}function me(gt){var rt,ht=gt.name;return{name:ht,schema:gt,mutate:function(yt){var ot=yt.trans,kt=yt.type,Nt=yt.keys,Mt=yt.values,Ot=yt.range;return new Promise(function(Xt,rn){Xt=De(Xt);var Gt=ot.objectStore(ht),en=Gt.keyPath==null,on=kt==="put"||kt==="add";if(!on&&kt!=="delete"&&kt!=="deleteRange")throw new Error("Invalid operation type: "+kt);var Kt,bn=(Nt||Mt||{length:1}).length;if(Nt&&Mt&&Nt.length!==Mt.length)throw new Error("Given keys array must have same length as given values array.");if(bn===0)return Xt({numFailures:0,failures:{},results:[],lastResult:void 0});function zn(Ji){++ma,Qu(Ji)}var Hn=[],mr=[],ma=0;if(kt==="deleteRange"){if(Ot.type===4)return Xt({numFailures:ma,failures:mr,results:[],lastResult:void 0});Ot.type===3?Hn.push(Kt=Gt.clear()):Hn.push(Kt=Gt.delete(ae(Ot)))}else{var en=on?en?[Mt,Nt]:[Mt,null]:[Nt,null],ar=en[0],fi=en[1];if(on)for(var Ci=0;Ci<bn;++Ci)Hn.push(Kt=fi&&fi[Ci]!==void 0?Gt[kt](ar[Ci],fi[Ci]):Gt[kt](ar[Ci])),Kt.onerror=zn;else for(Ci=0;Ci<bn;++Ci)Hn.push(Kt=Gt[kt](ar[Ci])),Kt.onerror=zn}function cc(Ji){Ji=Ji.target.result,Hn.forEach(function(kl,Jc){return kl.error!=null&&(mr[Jc]=kl.error)}),Xt({numFailures:ma,failures:mr,results:kt==="delete"?Nt:Hn.map(function(kl){return kl.result}),lastResult:Ji})}Kt.onerror=function(Ji){zn(Ji),cc(Ji)},Kt.onsuccess=cc})},getMany:function(yt){var ot=yt.trans,kt=yt.keys;return new Promise(function(Nt,Mt){Nt=De(Nt);for(var Ot,Xt=ot.objectStore(ht),rn=kt.length,Gt=new Array(rn),en=0,on=0,Kt=function(Hn){Hn=Hn.target,Gt[Hn._pos]=Hn.result,++on===en&&Nt(Gt)},bn=Zo(Mt),zn=0;zn<rn;++zn)kt[zn]!=null&&((Ot=Xt.get(kt[zn]))._pos=zn,Ot.onsuccess=Kt,Ot.onerror=bn,++en);en===0&&Nt(Gt)})},get:function(yt){var ot=yt.trans,kt=yt.key;return new Promise(function(Nt,Mt){Nt=De(Nt);var Ot=ot.objectStore(ht).get(kt);Ot.onsuccess=function(Xt){return Nt(Xt.target.result)},Ot.onerror=Zo(Mt)})},query:(rt=at,function(yt){return new Promise(function(ot,kt){ot=De(ot);var Nt,Mt,Ot,en=yt.trans,Xt=yt.values,rn=yt.limit,Kt=yt.query,Gt=rn===1/0?void 0:rn,on=Kt.index,Kt=Kt.range,en=en.objectStore(ht),on=on.isPrimaryKey?en:en.index(on.name),Kt=ae(Kt);if(rn===0)return ot({result:[]});rt?((Gt=Xt?on.getAll(Kt,Gt):on.getAllKeys(Kt,Gt)).onsuccess=function(bn){return ot({result:bn.target.result})},Gt.onerror=Zo(kt)):(Nt=0,Mt=!Xt&&"openKeyCursor"in on?on.openKeyCursor(Kt):on.openCursor(Kt),Ot=[],Mt.onsuccess=function(bn){var zn=Mt.result;return zn?(Ot.push(Xt?zn.value:zn.primaryKey),++Nt===rn?ot({result:Ot}):void zn.continue()):ot({result:Ot})},Mt.onerror=Zo(kt))})}),openCursor:function(yt){var ot=yt.trans,kt=yt.values,Nt=yt.query,Mt=yt.reverse,Ot=yt.unique;return new Promise(function(Xt,rn){Xt=De(Xt);var on=Nt.index,Gt=Nt.range,en=ot.objectStore(ht),en=on.isPrimaryKey?en:en.index(on.name),on=Mt?Ot?"prevunique":"prev":Ot?"nextunique":"next",Kt=!kt&&"openKeyCursor"in en?en.openKeyCursor(ae(Gt),on):en.openCursor(ae(Gt),on);Kt.onerror=Zo(rn),Kt.onsuccess=De(function(bn){var zn,Hn,mr,ma,ar=Kt.result;ar?(ar.___id=++k_,ar.done=!1,zn=ar.continue.bind(ar),Hn=(Hn=ar.continuePrimaryKey)&&Hn.bind(ar),mr=ar.advance.bind(ar),ma=function(){throw new Error("Cursor not stopped")},ar.trans=ot,ar.stop=ar.continue=ar.continuePrimaryKey=ar.advance=function(){throw new Error("Cursor not started")},ar.fail=De(rn),ar.next=function(){var fi=this,Ci=1;return this.start(function(){return Ci--?fi.continue():fi.stop()}).then(function(){return fi})},ar.start=function(fi){function Ci(){if(Kt.result)try{fi()}catch(Ji){ar.fail(Ji)}else ar.done=!0,ar.start=function(){throw new Error("Cursor behind last entry")},ar.stop()}var cc=new Promise(function(Ji,kl){Ji=De(Ji),Kt.onerror=Zo(kl),ar.fail=kl,ar.stop=function(Jc){ar.stop=ar.continue=ar.continuePrimaryKey=ar.advance=ma,Ji(Jc)}});return Kt.onsuccess=De(function(Ji){Kt.onsuccess=Ci,Ci()}),ar.continue=zn,ar.continuePrimaryKey=Hn,ar.advance=mr,Ci(),cc},Xt(ar)):Xt(null)},rn)})},count:function(yt){var ot=yt.query,kt=yt.trans,Nt=ot.index,Mt=ot.range;return new Promise(function(Ot,Xt){var rn=kt.objectStore(ht),Gt=Nt.isPrimaryKey?rn:rn.index(Nt.name),rn=ae(Mt),Gt=rn?Gt.count(rn):Gt.count();Gt.onsuccess=De(function(en){return Ot(en.target.result)}),Gt.onerror=Zo(Xt)})}}}var Ne,Le,Ge,pt=(Le=st,Ge=vp((Ne=M).objectStoreNames),{schema:{name:Ne.name,tables:Ge.map(function(gt){return Le.objectStore(gt)}).map(function(gt){var rt=gt.keyPath,ot=gt.autoIncrement,ht=o(rt),yt={},ot={name:gt.name,primaryKey:{name:null,isPrimaryKey:!0,outbound:rt==null,compound:ht,keyPath:rt,autoIncrement:ot,unique:!0,extractKey:jf(rt)},indexes:vp(gt.indexNames).map(function(kt){return gt.index(kt)}).map(function(Ot){var Nt=Ot.name,Mt=Ot.unique,Xt=Ot.multiEntry,Ot=Ot.keyPath,Xt={name:Nt,compound:o(Ot),keyPath:Ot,unique:Mt,multiEntry:Xt,extractKey:jf(Ot)};return yt[Si(Ot)]=Xt}),getIndexByKeyPath:function(kt){return yt[Si(kt)]}};return yt[":id"]=ot.primaryKey,rt!=null&&(yt[Si(rt)]=ot.primaryKey),ot})},hasGetAll:0<Ge.length&&"getAll"in Le.objectStore(Ge[0])&&!(typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604)}),st=pt.schema,at=pt.hasGetAll,pt=st.tables.map(me),Je={};return pt.forEach(function(gt){return Je[gt.name]=gt}),{stack:"dbcore",transaction:M.transaction.bind(M),table:function(gt){if(!Je[gt])throw new Error("Table '".concat(gt,"' not found"));return Je[gt]},MIN_KEY:-1/0,MAX_KEY:If(z),schema:st}}function gg(M,z,ne,ae){var me=ne.IDBKeyRange;return ne.indexedDB,{dbcore:(ae=td(z,me,ae),M.dbcore.reduce(function(Ne,Le){return Le=Le.create,r(r({},Ne),Le(Ne))},ae))}}function Yc(M,ae){var ne=ae.db,ae=gg(M._middlewares,ne,M._deps,ae);M.core=ae.dbcore,M.tables.forEach(function(me){var Ne=me.name;M.core.schema.tables.some(function(Le){return Le.name===Ne})&&(me.core=M.core.table(Ne),M[Ne]instanceof M.Table&&(M[Ne].core=me.core))})}function yg(M,z,ne,ae){ne.forEach(function(me){var Ne=ae[me];z.forEach(function(Le){var Ge=function st(at,pt){return v(at,pt)||(at=c(at))&&st(at,pt)}(Le,me);(!Ge||"value"in Ge&&Ge.value===void 0)&&(Le===M.Transaction.prototype||Le instanceof M.Transaction?y(Le,me,{get:function(){return this.table(me)},set:function(st){m(this,me,{value:st,writable:!0,configurable:!0,enumerable:!0})}}):Le[me]=new M.Table(me,Ne))})})}function xp(M,z){z.forEach(function(ne){for(var ae in ne)ne[ae]instanceof M.Table&&delete ne[ae]})}function Bb(M,z){return M._cfg.version-z._cfg.version}function wp(M,z,ne,ae){var me=M._dbSchema;ne.objectStoreNames.contains("$meta")&&!me.$meta&&(me.$meta=Mf("$meta",T_("")[0],[]),M._storeNames.push("$meta"));var Ne=M._createTransaction("readwrite",M._storeNames,me);Ne.create(ne),Ne._completion.catch(ae);var Le=Ne._reject.bind(Ne),Ge=Ee.transless||Ee;fn(function(){return Ee.trans=Ne,Ee.transless=Ge,z!==0?(Yc(M,ne),at=z,((st=Ne).storeNames.includes("$meta")?st.table("$meta").get("version").then(function(pt){return pt??at}):$.resolve(at)).then(function(pt){return gt=pt,rt=Ne,ht=ne,yt=[],pt=(Je=M)._versions,ot=Je._dbSchema=Pf(0,Je.idbdb,ht),(pt=pt.filter(function(kt){return kt._cfg.version>=gt})).length!==0?(pt.forEach(function(kt){yt.push(function(){var Nt=ot,Mt=kt._cfg.dbschema;wg(Je,Nt,ht),wg(Je,Mt,ht),ot=Je._dbSchema=Mt;var Ot=vg(Nt,Mt);Ot.add.forEach(function(on){$b(ht,on[0],on[1].primKey,on[1].indexes)}),Ot.change.forEach(function(on){if(on.recreate)throw new Ce.Upgrade("Not yet support for changing primary key");var Kt=ht.objectStore(on.name);on.add.forEach(function(bn){return xg(Kt,bn)}),on.change.forEach(function(bn){Kt.deleteIndex(bn.name),xg(Kt,bn)}),on.del.forEach(function(bn){return Kt.deleteIndex(bn)})});var Xt=kt._cfg.contentUpgrade;if(Xt&&kt._cfg.version>gt){Yc(Je,ht),rt._memoizedTables={};var rn=N(Mt);Ot.del.forEach(function(on){rn[on]=Nt[on]}),xp(Je,[Je.Transaction.prototype]),yg(Je,[Je.Transaction.prototype],a(rn),rn),rt.schema=rn;var Gt,en=Q(Xt);return en&&br(),Ot=$.follow(function(){var on;(Gt=Xt(rt))&&en&&(on=Mr.bind(null,null),Gt.then(on,on))}),Gt&&typeof Gt.then=="function"?$.resolve(Gt):Ot.then(function(){return Gt})}}),yt.push(function(Nt){var Mt,Ot,Xt=kt._cfg.dbschema;Mt=Xt,Ot=Nt,[].slice.call(Ot.db.objectStoreNames).forEach(function(rn){return Mt[rn]==null&&Ot.db.deleteObjectStore(rn)}),xp(Je,[Je.Transaction.prototype]),yg(Je,[Je.Transaction.prototype],Je._storeNames,Je._dbSchema),rt.schema=Je._dbSchema}),yt.push(function(Nt){Je.idbdb.objectStoreNames.contains("$meta")&&(Math.ceil(Je.idbdb.version/10)===kt._cfg.version?(Je.idbdb.deleteObjectStore("$meta"),delete Je._dbSchema.$meta,Je._storeNames=Je._storeNames.filter(function(Mt){return Mt!=="$meta"})):Nt.objectStore("$meta").put(kt._cfg.version,"version"))})}),function kt(){return yt.length?$.resolve(yt.shift()(rt.idbtrans)).then(kt):$.resolve()}().then(function(){E_(ot,ht)})):$.resolve();var Je,gt,rt,ht,yt,ot}).catch(Le)):(a(me).forEach(function(pt){$b(ne,pt,me[pt].primKey,me[pt].indexes)}),Yc(M,ne),void $.follow(function(){return M.on.populate.fire(Ne)}).catch(Le));var st,at})}function bg(M,z){E_(M._dbSchema,z),z.db.version%10!=0||z.objectStoreNames.contains("$meta")||z.db.createObjectStore("$meta").add(Math.ceil(z.db.version/10-1),"version");var ne=Pf(0,M.idbdb,z);wg(M,M._dbSchema,z);for(var ae=0,me=vg(ne,M._dbSchema).change;ae<me.length;ae++){var Ne=function(Le){if(Le.change.length||Le.recreate)return console.warn("Unable to patch indexes of table ".concat(Le.name," because it has changes on the type of index or primary key.")),{value:void 0};var Ge=z.objectStore(Le.name);Le.add.forEach(function(st){Be&&console.debug("Dexie upgrade patch: Creating missing index ".concat(Le.name,".").concat(st.src)),xg(Ge,st)})}(me[ae]);if(typeof Ne=="object")return Ne.value}}function vg(M,z){var ne,ae={del:[],add:[],change:[]};for(ne in M)z[ne]||ae.del.push(ne);for(ne in z){var me=M[ne],Ne=z[ne];if(me){var Le={name:ne,def:Ne,recreate:!1,del:[],add:[],change:[]};if(""+(me.primKey.keyPath||"")!=""+(Ne.primKey.keyPath||"")||me.primKey.auto!==Ne.primKey.auto)Le.recreate=!0,ae.change.push(Le);else{var Ge=me.idxByName,st=Ne.idxByName,at=void 0;for(at in Ge)st[at]||Le.del.push(at);for(at in st){var pt=Ge[at],Je=st[at];pt?pt.src!==Je.src&&Le.change.push(Je):Le.add.push(Je)}(0<Le.del.length||0<Le.add.length||0<Le.change.length)&&ae.change.push(Le)}}else ae.add.push([ne,Ne])}return ae}function $b(M,z,ne,ae){var me=M.db.createObjectStore(z,ne.keyPath?{keyPath:ne.keyPath,autoIncrement:ne.auto}:{autoIncrement:ne.auto});return ae.forEach(function(Ne){return xg(me,Ne)}),me}function E_(M,z){a(M).forEach(function(ne){z.db.objectStoreNames.contains(ne)||(Be&&console.debug("Dexie: Creating missing table",ne),$b(z,ne,M[ne].primKey,M[ne].indexes))})}function xg(M,z){M.createIndex(z.name,z.keyPath,{unique:z.unique,multiEntry:z.multi})}function Pf(M,z,ne){var ae={};return w(z.objectStoreNames,0).forEach(function(me){for(var Ne=ne.objectStore(me),Le=Sl(mg(at=Ne.keyPath),at||"",!0,!1,!!Ne.autoIncrement,at&&typeof at!="string",!0),Ge=[],st=0;st<Ne.indexNames.length;++st){var pt=Ne.index(Ne.indexNames[st]),at=pt.keyPath,pt=Sl(pt.name,at,!!pt.unique,!!pt.multiEntry,!1,at&&typeof at!="string",!1);Ge.push(pt)}ae[me]=Mf(me,Le,Ge)}),ae}function wg(M,z,ne){for(var ae=ne.db.objectStoreNames,me=0;me<ae.length;++me){var Ne=ae[me],Le=ne.objectStore(Ne);M._hasGetAll="getAll"in Le;for(var Ge=0;Ge<Le.indexNames.length;++Ge){var st=Le.indexNames[Ge],at=Le.index(st).keyPath,pt=typeof at=="string"?at:"["+w(at).join("+")+"]";!z[Ne]||(at=z[Ne].idxByName[pt])&&(at.name=st,delete z[Ne].idxByName[pt],z[Ne].idxByName[st]=at)}}typeof navigator<"u"&&/Safari/.test(navigator.userAgent)&&!/(Chrome\/|Edge\/)/.test(navigator.userAgent)&&i.WorkerGlobalScope&&i instanceof i.WorkerGlobalScope&&[].concat(navigator.userAgent.match(/Safari\/(\d*)/))[1]<604&&(M._hasGetAll=!1)}function T_(M){return M.split(",").map(function(z,ne){var ae=(z=z.trim()).replace(/([&*]|\+\+)/g,""),me=/^\[/.test(ae)?ae.match(/^\[(.*)\]$/)[1].split("+"):ae;return Sl(ae,me||null,/\&/.test(z),/\*/.test(z),/\+\+/.test(z),o(me),ne===0)})}var RA=(_g.prototype._parseStoresSpec=function(M,z){a(M).forEach(function(ne){if(M[ne]!==null){var ae=T_(M[ne]),me=ae.shift();if(me.unique=!0,me.multi)throw new Ce.Schema("Primary key cannot be multi-valued");ae.forEach(function(Ne){if(Ne.auto)throw new Ce.Schema("Only primary key can be marked as autoIncrement (++)");if(!Ne.keyPath)throw new Ce.Schema("Index must have a name and cannot be an empty string")}),z[ne]=Mf(ne,me,ae)}})},_g.prototype.stores=function(ne){var z=this.db;this._cfg.storesSource=this._cfg.storesSource?l(this._cfg.storesSource,ne):ne;var ne=z._versions,ae={},me={};return ne.forEach(function(Ne){l(ae,Ne._cfg.storesSource),me=Ne._cfg.dbschema={},Ne._parseStoresSpec(ae,me)}),z._dbSchema=me,xp(z,[z._allTables,z,z.Transaction.prototype]),yg(z,[z._allTables,z,z.Transaction.prototype,this._cfg.tables],a(me),me),z._storeNames=a(me),this},_g.prototype.upgrade=function(M){return this._cfg.contentUpgrade=Me(this._cfg.contentUpgrade||We,M),this},_g);function _g(){}function zb(M,z){var ne=M._dbNamesDB;return ne||(ne=M._dbNamesDB=new Cl(Ga,{addons:[],indexedDB:M,IDBKeyRange:z})).version(1).stores({dbnames:"name"}),ne.table("dbnames")}function Sg(M){return M&&typeof M.databases=="function"}function Ub(M){return fn(function(){return Ee.letThrough=!0,M()})}function qb(M){return!("from"in M)}var Xi=function(M,z){if(!this){var ne=new Xi;return M&&"d"in M&&l(ne,M),ne}l(this,arguments.length?{d:1,from:M,to:1<arguments.length?z:M}:{d:0})};function _p(M,z,ne){var ae=Fr(z,ne);if(!isNaN(ae)){if(0<ae)throw RangeError();if(qb(M))return l(M,{from:z,to:ne,d:1});var me=M.l,ae=M.r;if(Fr(ne,M.from)<0)return me?_p(me,z,ne):M.l={from:z,to:ne,d:1,l:null,r:null},R_(M);if(0<Fr(z,M.to))return ae?_p(ae,z,ne):M.r={from:z,to:ne,d:1,l:null,r:null},R_(M);Fr(z,M.from)<0&&(M.from=z,M.l=null,M.d=ae?ae.d+1:1),0<Fr(ne,M.to)&&(M.to=ne,M.r=null,M.d=M.l?M.l.d+1:1),ne=!M.r,me&&!M.l&&nd(M,me),ae&&ne&&nd(M,ae)}}function nd(M,z){qb(z)||function ne(ae,st){var Ne=st.from,Le=st.to,Ge=st.l,st=st.r;_p(ae,Ne,Le),Ge&&ne(ae,Ge),st&&ne(ae,st)}(M,z)}function A_(M,z){var ne=Cg(z),ae=ne.next();if(ae.done)return!1;for(var me=ae.value,Ne=Cg(M),Le=Ne.next(me.from),Ge=Le.value;!ae.done&&!Le.done;){if(Fr(Ge.from,me.to)<=0&&0<=Fr(Ge.to,me.from))return!0;Fr(me.from,Ge.from)<0?me=(ae=ne.next(Ge.from)).value:Ge=(Le=Ne.next(me.from)).value}return!1}function Cg(M){var z=qb(M)?null:{s:0,n:M};return{next:function(ne){for(var ae=0<arguments.length;z;)switch(z.s){case 0:if(z.s=1,ae)for(;z.n.l&&Fr(ne,z.n.from)<0;)z={up:z,n:z.n.l,s:1};else for(;z.n.l;)z={up:z,n:z.n.l,s:1};case 1:if(z.s=2,!ae||Fr(ne,z.n.to)<=0)return{value:z.n,done:!1};case 2:if(z.n.r){z.s=3,z={up:z,n:z.n.r,s:0};continue}case 3:z=z.up}return{done:!0}}}}function R_(M){var z,ne,ae=(((z=M.r)===null||z===void 0?void 0:z.d)||0)-(((ne=M.l)===null||ne===void 0?void 0:ne.d)||0),me=1<ae?"r":ae<-1?"l":"";me&&(z=me=="r"?"l":"r",ne=r({},M),ae=M[me],M.from=ae.from,M.to=ae.to,M[me]=ae[me],ne[me]=ae[z],(M[z]=ne).d=Vb(ne)),M.d=Vb(M)}function Vb(ne){var z=ne.r,ne=ne.l;return(z?ne?Math.max(z.d,ne.d):z.d:ne?ne.d:0)+1}function kg(M,z){return a(z).forEach(function(ne){M[ne]?nd(M[ne],z[ne]):M[ne]=function ae(me){var Ne,Le,Ge={};for(Ne in me)d(me,Ne)&&(Le=me[Ne],Ge[Ne]=!Le||typeof Le!="object"||B.has(Le.constructor)?Le:ae(Le));return Ge}(z[ne])}),M}function Wb(M,z){return M.all||z.all||Object.keys(M).some(function(ne){return z[ne]&&A_(z[ne],M[ne])})}h(Xi.prototype,((Za={add:function(M){return nd(this,M),this},addKey:function(M){return _p(this,M,M),this},addKeys:function(M){var z=this;return M.forEach(function(ne){return _p(z,ne,ne)}),this},hasKey:function(M){var z=Cg(this).next(M).value;return z&&Fr(z.from,M)<=0&&0<=Fr(z.to,M)}})[U]=function(){return Cg(this)},Za));var rd={},Hb={},Gb=!1;function Eg(M){kg(Hb,M),Gb||(Gb=!0,setTimeout(function(){Gb=!1,Kb(Hb,!(Hb={}))},0))}function Kb(M,z){z===void 0&&(z=!1);var ne=new Set;if(M.all)for(var ae=0,me=Object.values(rd);ae<me.length;ae++)N_(Le=me[ae],M,ne,z);else for(var Ne in M){var Le,Ge=/^idb\:\/\/(.*)\/(.*)\//.exec(Ne);Ge&&(Ne=Ge[1],Ge=Ge[2],(Le=rd["idb://".concat(Ne,"/").concat(Ge)])&&N_(Le,M,ne,z))}ne.forEach(function(st){return st()})}function N_(M,z,ne,ae){for(var me=[],Ne=0,Le=Object.entries(M.queries.query);Ne<Le.length;Ne++){for(var Ge=Le[Ne],st=Ge[0],at=[],pt=0,Je=Ge[1];pt<Je.length;pt++){var gt=Je[pt];Wb(z,gt.obsSet)?gt.subscribers.forEach(function(ot){return ne.add(ot)}):ae&&at.push(gt)}ae&&me.push([st,at])}if(ae)for(var rt=0,ht=me;rt<ht.length;rt++){var yt=ht[rt],st=yt[0],at=yt[1];M.queries.query[st]=at}}function NA(M){var z=M._state,ne=M._deps.indexedDB;if(z.isBeingOpened||M.idbdb)return z.dbReadyPromise.then(function(){return z.dbOpenError?ir(z.dbOpenError):M});z.isBeingOpened=!0,z.dbOpenError=null,z.openComplete=!1;var ae=z.openCanceller,me=Math.round(10*M.verno),Ne=!1;function Le(){if(z.openCanceller!==ae)throw new Ce.DatabaseClosed("db.open() was cancelled")}function Ge(){return new $(function(gt,rt){if(Le(),!ne)throw new Ce.MissingAPI;var ht=M.name,yt=z.autoSchema||!me?ne.open(ht):ne.open(ht,me);if(!yt)throw new Ce.MissingAPI;yt.onerror=Zo(rt),yt.onblocked=De(M._fireOnBlocked),yt.onupgradeneeded=De(function(ot){var kt;pt=yt.transaction,z.autoSchema&&!M._options.allowEmptyDB?(yt.onerror=Qu,pt.abort(),yt.result.close(),(kt=ne.deleteDatabase(ht)).onsuccess=kt.onerror=De(function(){rt(new Ce.NoSuchDatabase("Database ".concat(ht," doesnt exist")))})):(pt.onerror=Zo(rt),ot=ot.oldVersion>Math.pow(2,62)?0:ot.oldVersion,Je=ot<1,M.idbdb=yt.result,Ne&&bg(M,pt),wp(M,ot/10,pt,rt))},rt),yt.onsuccess=De(function(){pt=null;var ot,kt,Nt,Mt,Ot,Xt=M.idbdb=yt.result,rn=w(Xt.objectStoreNames);if(0<rn.length)try{var Gt=Xt.transaction((Mt=rn).length===1?Mt[0]:Mt,"readonly");if(z.autoSchema)kt=Xt,Nt=Gt,(ot=M).verno=kt.version/10,Nt=ot._dbSchema=Pf(0,kt,Nt),ot._storeNames=w(kt.objectStoreNames,0),yg(ot,[ot._allTables],a(Nt),Nt);else if(wg(M,M._dbSchema,Gt),((Ot=vg(Pf(0,(Ot=M).idbdb,Gt),Ot._dbSchema)).add.length||Ot.change.some(function(en){return en.add.length||en.change.length}))&&!Ne)return console.warn("Dexie SchemaDiff: Schema was extended without increasing the number passed to db.version(). Dexie will add missing parts and increment native version number to workaround this."),Xt.close(),me=Xt.version+1,Ne=!0,gt(Ge());Yc(M,Gt)}catch{}di.push(M),Xt.onversionchange=De(function(en){z.vcFired=!0,M.on("versionchange").fire(en)}),Xt.onclose=De(function(en){M.on("close").fire(en)}),Je&&(Ot=M._deps,Gt=ht,Xt=Ot.indexedDB,Ot=Ot.IDBKeyRange,Sg(Xt)||Gt===Ga||zb(Xt,Ot).put({name:Gt}).catch(We)),gt()},rt)}).catch(function(gt){switch(gt==null?void 0:gt.name){case"UnknownError":if(0<z.PR1398_maxLoop)return z.PR1398_maxLoop--,console.warn("Dexie: Workaround for Chrome UnknownError on open()"),Ge();break;case"VersionError":if(0<me)return me=0,Ge()}return $.reject(gt)})}var st,at=z.dbReadyResolve,pt=null,Je=!1;return $.race([ae,(typeof navigator>"u"?$.resolve():!navigator.userAgentData&&/Safari\//.test(navigator.userAgent)&&!/Chrom(e|ium)\//.test(navigator.userAgent)&&indexedDB.databases?new Promise(function(gt){function rt(){return indexedDB.databases().finally(gt)}st=setInterval(rt,100),rt()}).finally(function(){return clearInterval(st)}):Promise.resolve()).then(Ge)]).then(function(){return Le(),z.onReadyBeingFired=[],$.resolve(Ub(function(){return M.on.ready.fire(M.vip)})).then(function gt(){if(0<z.onReadyBeingFired.length){var rt=z.onReadyBeingFired.reduce(Me,We);return z.onReadyBeingFired=[],$.resolve(Ub(function(){return rt(M.vip)})).then(gt)}})}).finally(function(){z.openCanceller===ae&&(z.onReadyBeingFired=null,z.isBeingOpened=!1)}).catch(function(gt){z.dbOpenError=gt;try{pt&&pt.abort()}catch{}return ae===z.openCanceller&&M._close(),ir(gt)}).finally(function(){z.openComplete=!0,at()}).then(function(){var gt;return Je&&(gt={},M.tables.forEach(function(rt){rt.schema.indexes.forEach(function(ht){ht.name&&(gt["idb://".concat(M.name,"/").concat(rt.name,"/").concat(ht.name)]=new Xi(-1/0,[[[]]]))}),gt["idb://".concat(M.name,"/").concat(rt.name,"/")]=gt["idb://".concat(M.name,"/").concat(rt.name,"/:dels")]=new Xi(-1/0,[[[]]])}),Zi(Nf).fire(gt),Kb(gt,!0)),M})}function Sp(M){function z(Ne){return M.next(Ne)}var ne=me(z),ae=me(function(Ne){return M.throw(Ne)});function me(Ne){return function(st){var Ge=Ne(st),st=Ge.value;return Ge.done?st:st&&typeof st.then=="function"?st.then(ne,ae):o(st)?Promise.all(st).then(ne,ae):ne(st)}}return me(z)()}function Zc(M,z,ne){for(var ae=o(M)?M.slice():[M],me=0;me<ne;++me)ae.push(z);return ae}var MA={stack:"dbcore",name:"VirtualIndexMiddleware",level:1,create:function(M){return r(r({},M),{table:function(z){var ne=M.table(z),ae=ne.schema,me={},Ne=[];function Le(Je,gt,rt){var ht=Si(Je),yt=me[ht]=me[ht]||[],ot=Je==null?0:typeof Je=="string"?1:Je.length,kt=0<gt,kt=r(r({},rt),{name:kt?"".concat(ht,"(virtual-from:").concat(rt.name,")"):rt.name,lowLevelIndex:rt,isVirtual:kt,keyTail:gt,keyLength:ot,extractKey:jf(Je),unique:!kt&&rt.unique});return yt.push(kt),kt.isPrimaryKey||Ne.push(kt),1<ot&&Le(ot===2?Je[0]:Je.slice(0,ot-1),gt+1,rt),yt.sort(function(Nt,Mt){return Nt.keyTail-Mt.keyTail}),kt}z=Le(ae.primaryKey.keyPath,0,ae.primaryKey),me[":id"]=[z];for(var Ge=0,st=ae.indexes;Ge<st.length;Ge++){var at=st[Ge];Le(at.keyPath,0,at)}function pt(Je){var gt,rt=Je.query.index;return rt.isVirtual?r(r({},Je),{query:{index:rt.lowLevelIndex,range:(gt=Je.query.range,rt=rt.keyTail,{type:gt.type===1?2:gt.type,lower:Zc(gt.lower,gt.lowerOpen?M.MAX_KEY:M.MIN_KEY,rt),lowerOpen:!0,upper:Zc(gt.upper,gt.upperOpen?M.MIN_KEY:M.MAX_KEY,rt),upperOpen:!0})}}):Je}return r(r({},ne),{schema:r(r({},ae),{primaryKey:z,indexes:Ne,getIndexByKeyPath:function(Je){return(Je=me[Si(Je)])&&Je[0]}}),count:function(Je){return ne.count(pt(Je))},query:function(Je){return ne.query(pt(Je))},openCursor:function(Je){var gt=Je.query.index,rt=gt.keyTail,ht=gt.isVirtual,yt=gt.keyLength;return ht?ne.openCursor(pt(Je)).then(function(kt){return kt&&ot(kt)}):ne.openCursor(Je);function ot(kt){return Object.create(kt,{continue:{value:function(Nt){Nt!=null?kt.continue(Zc(Nt,Je.reverse?M.MAX_KEY:M.MIN_KEY,rt)):Je.unique?kt.continue(kt.key.slice(0,yt).concat(Je.reverse?M.MIN_KEY:M.MAX_KEY,rt)):kt.continue()}},continuePrimaryKey:{value:function(Nt,Mt){kt.continuePrimaryKey(Zc(Nt,M.MAX_KEY,rt),Mt)}},primaryKey:{get:function(){return kt.primaryKey}},key:{get:function(){var Nt=kt.key;return yt===1?Nt[0]:Nt.slice(0,yt)}},value:{get:function(){return kt.value}}})}}})}})}};function Tg(M,z,ne,ae){return ne=ne||{},ae=ae||"",a(M).forEach(function(me){var Ne,Le,Ge;d(z,me)?(Ne=M[me],Le=z[me],typeof Ne=="object"&&typeof Le=="object"&&Ne&&Le?(Ge=K(Ne))!==K(Le)?ne[ae+me]=z[me]:Ge==="Object"?Tg(Ne,Le,ne,ae+me+"."):Ne!==Le&&(ne[ae+me]=z[me]):Ne!==Le&&(ne[ae+me]=z[me])):ne[ae+me]=void 0}),a(z).forEach(function(me){d(M,me)||(ne[ae+me]=z[me])}),ne}function Ag(M,z){return z.type==="delete"?z.keys:z.keys||z.values.map(M.extractKey)}var M_={stack:"dbcore",name:"HooksMiddleware",level:2,create:function(M){return r(r({},M),{table:function(z){var ne=M.table(z),ae=ne.schema.primaryKey;return r(r({},ne),{mutate:function(me){var Ne=Ee.trans,Le=Ne.table(z).hook,Ge=Le.deleting,st=Le.creating,at=Le.updating;switch(me.type){case"add":if(st.fire===We)break;return Ne._promise("readwrite",function(){return pt(me)},!0);case"put":if(st.fire===We&&at.fire===We)break;return Ne._promise("readwrite",function(){return pt(me)},!0);case"delete":if(Ge.fire===We)break;return Ne._promise("readwrite",function(){return pt(me)},!0);case"deleteRange":if(Ge.fire===We)break;return Ne._promise("readwrite",function(){return function Je(gt,rt,ht){return ne.query({trans:gt,values:!1,query:{index:ae,range:rt},limit:ht}).then(function(yt){var ot=yt.result;return pt({type:"delete",keys:ot,trans:gt}).then(function(kt){return 0<kt.numFailures?Promise.reject(kt.failures[0]):ot.length<ht?{failures:[],numFailures:0,lastResult:void 0}:Je(gt,r(r({},rt),{lower:ot[ot.length-1],lowerOpen:!0}),ht)})})}(me.trans,me.range,1e4)},!0)}return ne.mutate(me);function pt(Je){var gt,rt,ht,yt=Ee.trans,ot=Je.keys||Ag(ae,Je);if(!ot)throw new Error("Keys missing");return(Je=Je.type==="add"||Je.type==="put"?r(r({},Je),{keys:ot}):r({},Je)).type!=="delete"&&(Je.values=s([],Je.values)),Je.keys&&(Je.keys=s([],Je.keys)),gt=ne,ht=ot,((rt=Je).type==="add"?Promise.resolve([]):gt.getMany({trans:rt.trans,keys:ht,cache:"immutable"})).then(function(kt){var Nt=ot.map(function(Mt,Ot){var Xt,rn,Gt,en=kt[Ot],on={onerror:null,onsuccess:null};return Je.type==="delete"?Ge.fire.call(on,Mt,en,yt):Je.type==="add"||en===void 0?(Xt=st.fire.call(on,Mt,Je.values[Ot],yt),Mt==null&&Xt!=null&&(Je.keys[Ot]=Mt=Xt,ae.outbound||A(Je.values[Ot],ae.keyPath,Mt))):(Xt=Tg(en,Je.values[Ot]),(rn=at.fire.call(on,Xt,Mt,en,yt))&&(Gt=Je.values[Ot],Object.keys(rn).forEach(function(Kt){d(Gt,Kt)?Gt[Kt]=rn[Kt]:A(Gt,Kt,rn[Kt])}))),on});return ne.mutate(Je).then(function(Mt){for(var Ot=Mt.failures,Xt=Mt.results,rn=Mt.numFailures,Mt=Mt.lastResult,Gt=0;Gt<ot.length;++Gt){var en=(Xt||ot)[Gt],on=Nt[Gt];en==null?on.onerror&&on.onerror(Ot[Gt]):on.onsuccess&&on.onsuccess(Je.type==="put"&&kt[Gt]?Je.values[Gt]:en)}return{failures:Ot,results:Xt,numFailures:rn,lastResult:Mt}}).catch(function(Mt){return Nt.forEach(function(Ot){return Ot.onerror&&Ot.onerror(Mt)}),Promise.reject(Mt)})})}}})}})}};function Yb(M,z,ne){try{if(!z||z.keys.length<M.length)return null;for(var ae=[],me=0,Ne=0;me<z.keys.length&&Ne<M.length;++me)Fr(z.keys[me],M[Ne])===0&&(ae.push(ne?H(z.values[me]):z.values[me]),++Ne);return ae.length===M.length?ae:null}catch{return null}}var I_={stack:"dbcore",level:-1,create:function(M){return{table:function(z){var ne=M.table(z);return r(r({},ne),{getMany:function(ae){if(!ae.cache)return ne.getMany(ae);var me=Yb(ae.keys,ae.trans._cache,ae.cache==="clone");return me?$.resolve(me):ne.getMany(ae).then(function(Ne){return ae.trans._cache={keys:ae.keys,values:ae.cache==="clone"?H(Ne):Ne},Ne})},mutate:function(ae){return ae.type!=="add"&&(ae.trans._cache=null),ne.mutate(ae)}})}}}};function sd(M,z){return M.trans.mode==="readonly"&&!!M.subscr&&!M.trans.explicit&&M.trans.db._options.cache!=="disabled"&&!z.schema.primaryKey.outbound}function j_(M,z){switch(M){case"query":return z.values&&!z.unique;case"get":case"getMany":case"count":case"openCursor":return!1}}var IA={stack:"dbcore",level:0,name:"Observability",create:function(M){var z=M.schema.name,ne=new Xi(M.MIN_KEY,M.MAX_KEY);return r(r({},M),{transaction:function(ae,me,Ne){if(Ee.subscr&&me!=="readonly")throw new Ce.ReadOnly("Readwrite transaction in liveQuery context. Querier source: ".concat(Ee.querier));return M.transaction(ae,me,Ne)},table:function(ae){var me=M.table(ae),Ne=me.schema,Le=Ne.primaryKey,Je=Ne.indexes,Ge=Le.extractKey,st=Le.outbound,at=Le.autoIncrement&&Je.filter(function(rt){return rt.compound&&rt.keyPath.includes(Le.keyPath)}),pt=r(r({},me),{mutate:function(rt){function ht(Kt){return Kt="idb://".concat(z,"/").concat(ae,"/").concat(Kt),Mt[Kt]||(Mt[Kt]=new Xi)}var yt,ot,kt,Nt=rt.trans,Mt=rt.mutatedParts||(rt.mutatedParts={}),Ot=ht(""),Xt=ht(":dels"),rn=rt.type,on=rt.type==="deleteRange"?[rt.range]:rt.type==="delete"?[rt.keys]:rt.values.length<50?[Ag(Le,rt).filter(function(Kt){return Kt}),rt.values]:[],Gt=on[0],en=on[1],on=rt.trans._cache;return o(Gt)?(Ot.addKeys(Gt),(on=rn==="delete"||Gt.length===en.length?Yb(Gt,on):null)||Xt.addKeys(Gt),(on||en)&&(yt=ht,ot=on,kt=en,Ne.indexes.forEach(function(Kt){var bn=yt(Kt.name||"");function zn(mr){return mr!=null?Kt.extractKey(mr):null}function Hn(mr){return Kt.multiEntry&&o(mr)?mr.forEach(function(ma){return bn.addKey(ma)}):bn.addKey(mr)}(ot||kt).forEach(function(mr,fi){var ar=ot&&zn(ot[fi]),fi=kt&&zn(kt[fi]);Fr(ar,fi)!==0&&(ar!=null&&Hn(ar),fi!=null&&Hn(fi))})}))):Gt?(en={from:(en=Gt.lower)!==null&&en!==void 0?en:M.MIN_KEY,to:(en=Gt.upper)!==null&&en!==void 0?en:M.MAX_KEY},Xt.add(en),Ot.add(en)):(Ot.add(ne),Xt.add(ne),Ne.indexes.forEach(function(Kt){return ht(Kt.name).add(ne)})),me.mutate(rt).then(function(Kt){return!Gt||rt.type!=="add"&&rt.type!=="put"||(Ot.addKeys(Kt.results),at&&at.forEach(function(bn){for(var zn=rt.values.map(function(ar){return bn.extractKey(ar)}),Hn=bn.keyPath.findIndex(function(ar){return ar===Le.keyPath}),mr=0,ma=Kt.results.length;mr<ma;++mr)zn[mr][Hn]=Kt.results[mr];ht(bn.name).addKeys(zn)})),Nt.mutatedParts=kg(Nt.mutatedParts||{},Mt),Kt})}}),Je=function(ht){var yt=ht.query,ht=yt.index,yt=yt.range;return[ht,new Xi((ht=yt.lower)!==null&&ht!==void 0?ht:M.MIN_KEY,(yt=yt.upper)!==null&&yt!==void 0?yt:M.MAX_KEY)]},gt={get:function(rt){return[Le,new Xi(rt.key)]},getMany:function(rt){return[Le,new Xi().addKeys(rt.keys)]},count:Je,query:Je,openCursor:Je};return a(gt).forEach(function(rt){pt[rt]=function(ht){var yt=Ee.subscr,ot=!!yt,kt=sd(Ee,me)&&j_(rt,ht)?ht.obsSet={}:yt;if(ot){var Nt=function(en){return en="idb://".concat(z,"/").concat(ae,"/").concat(en),kt[en]||(kt[en]=new Xi)},Mt=Nt(""),Ot=Nt(":dels"),yt=gt[rt](ht),ot=yt[0],yt=yt[1];if((rt==="query"&&ot.isPrimaryKey&&!ht.values?Ot:Nt(ot.name||"")).add(yt),!ot.isPrimaryKey){if(rt!=="count"){var Xt=rt==="query"&&st&&ht.values&&me.query(r(r({},ht),{values:!1}));return me[rt].apply(this,arguments).then(function(en){if(rt==="query"){if(st&&ht.values)return Xt.then(function(zn){return zn=zn.result,Mt.addKeys(zn),en});var on=ht.values?en.result.map(Ge):en.result;(ht.values?Mt:Ot).addKeys(on)}else if(rt==="openCursor"){var Kt=en,bn=ht.values;return Kt&&Object.create(Kt,{key:{get:function(){return Ot.addKey(Kt.primaryKey),Kt.key}},primaryKey:{get:function(){var zn=Kt.primaryKey;return Ot.addKey(zn),zn}},value:{get:function(){return bn&&Mt.addKey(Kt.primaryKey),Kt.value}}})}return en})}Ot.add(ne)}}return me[rt].apply(this,arguments)}}),pt}})}};function P_(M,z,ne){if(ne.numFailures===0)return z;if(z.type==="deleteRange")return null;var ae=z.keys?z.keys.length:"values"in z&&z.values?z.values.length:1;return ne.numFailures===ae?null:(z=r({},z),o(z.keys)&&(z.keys=z.keys.filter(function(me,Ne){return!(Ne in ne.failures)})),"values"in z&&o(z.values)&&(z.values=z.values.filter(function(me,Ne){return!(Ne in ne.failures)})),z)}function Rg(M,z){return ne=M,((ae=z).lower===void 0||(ae.lowerOpen?0<Fr(ne,ae.lower):0<=Fr(ne,ae.lower)))&&(M=M,(z=z).upper===void 0||(z.upperOpen?Fr(M,z.upper)<0:Fr(M,z.upper)<=0));var ne,ae}function Zb(M,z,gt,ae,me,Ne){if(!gt||gt.length===0)return M;var Le=z.query.index,Ge=Le.multiEntry,st=z.query.range,at=ae.schema.primaryKey.extractKey,pt=Le.extractKey,Je=(Le.lowLevelIndex||Le).extractKey,gt=gt.reduce(function(rt,ht){var yt=rt,ot=[];if(ht.type==="add"||ht.type==="put")for(var kt=new Xi,Nt=ht.values.length-1;0<=Nt;--Nt){var Mt,Ot=ht.values[Nt],Xt=at(Ot);kt.hasKey(Xt)||(Mt=pt(Ot),(Ge&&o(Mt)?Mt.some(function(Kt){return Rg(Kt,st)}):Rg(Mt,st))&&(kt.addKey(Xt),ot.push(Ot)))}switch(ht.type){case"add":var rn=new Xi().addKeys(z.values?rt.map(function(bn){return at(bn)}):rt),yt=rt.concat(z.values?ot.filter(function(bn){return bn=at(bn),!rn.hasKey(bn)&&(rn.addKey(bn),!0)}):ot.map(function(bn){return at(bn)}).filter(function(bn){return!rn.hasKey(bn)&&(rn.addKey(bn),!0)}));break;case"put":var Gt=new Xi().addKeys(ht.values.map(function(bn){return at(bn)}));yt=rt.filter(function(bn){return!Gt.hasKey(z.values?at(bn):bn)}).concat(z.values?ot:ot.map(function(bn){return at(bn)}));break;case"delete":var en=new Xi().addKeys(ht.keys);yt=rt.filter(function(bn){return!en.hasKey(z.values?at(bn):bn)});break;case"deleteRange":var on=ht.range;yt=rt.filter(function(bn){return!Rg(at(bn),on)})}return yt},M);return gt===M?M:(gt.sort(function(rt,ht){return Fr(Je(rt),Je(ht))||Fr(at(rt),at(ht))}),z.limit&&z.limit<1/0&&(gt.length>z.limit?gt.length=z.limit:M.length===z.limit&&gt.length<z.limit&&(me.dirty=!0)),Ne?Object.freeze(gt):gt)}function Of(M,z){return Fr(M.lower,z.lower)===0&&Fr(M.upper,z.upper)===0&&!!M.lowerOpen==!!z.lowerOpen&&!!M.upperOpen==!!z.upperOpen}function Cp(M,z){return function(ne,ae,me,Ne){if(ne===void 0)return ae!==void 0?-1:0;if(ae===void 0)return 1;if((ae=Fr(ne,ae))===0){if(me&&Ne)return 0;if(me)return 1;if(Ne)return-1}return ae}(M.lower,z.lower,M.lowerOpen,z.lowerOpen)<=0&&0<=function(ne,ae,me,Ne){if(ne===void 0)return ae!==void 0?1:0;if(ae===void 0)return-1;if((ae=Fr(ne,ae))===0){if(me&&Ne)return 0;if(me)return-1;if(Ne)return 1}return ae}(M.upper,z.upper,M.upperOpen,z.upperOpen)}function jA(M,z,ne,ae){M.subscribers.add(ne),ae.addEventListener("abort",function(){var me,Ne;M.subscribers.delete(ne),M.subscribers.size===0&&(me=M,Ne=z,setTimeout(function(){me.subscribers.size===0&&L(Ne,me)},3e3))})}var Ng={stack:"dbcore",level:0,name:"Cache",create:function(M){var z=M.schema.name;return r(r({},M),{transaction:function(ne,ae,me){var Ne,Le,Ge=M.transaction(ne,ae,me);return ae==="readwrite"&&(Le=(Ne=new AbortController).signal,me=function(st){return function(){if(Ne.abort(),ae==="readwrite"){for(var at=new Set,pt=0,Je=ne;pt<Je.length;pt++){var gt=Je[pt],rt=rd["idb://".concat(z,"/").concat(gt)];if(rt){var ht=M.table(gt),yt=rt.optimisticOps.filter(function(bn){return bn.trans===Ge});if(Ge._explicit&&st&&Ge.mutatedParts)for(var ot=0,kt=Object.values(rt.queries.query);ot<kt.length;ot++)for(var Nt=0,Mt=(rn=kt[ot]).slice();Nt<Mt.length;Nt++)Wb((Gt=Mt[Nt]).obsSet,Ge.mutatedParts)&&(L(rn,Gt),Gt.subscribers.forEach(function(bn){return at.add(bn)}));else if(0<yt.length){rt.optimisticOps=rt.optimisticOps.filter(function(bn){return bn.trans!==Ge});for(var Ot=0,Xt=Object.values(rt.queries.query);Ot<Xt.length;Ot++)for(var rn,Gt,en,on=0,Kt=(rn=Xt[Ot]).slice();on<Kt.length;on++)(Gt=Kt[on]).res!=null&&Ge.mutatedParts&&(st&&!Gt.dirty?(en=Object.isFrozen(Gt.res),en=Zb(Gt.res,Gt.req,yt,ht,Gt,en),Gt.dirty?(L(rn,Gt),Gt.subscribers.forEach(function(bn){return at.add(bn)})):en!==Gt.res&&(Gt.res=en,Gt.promise=$.resolve({result:en}))):(Gt.dirty&&L(rn,Gt),Gt.subscribers.forEach(function(bn){return at.add(bn)})))}}}at.forEach(function(bn){return bn()})}}},Ge.addEventListener("abort",me(!1),{signal:Le}),Ge.addEventListener("error",me(!1),{signal:Le}),Ge.addEventListener("complete",me(!0),{signal:Le})),Ge},table:function(ne){var ae=M.table(ne),me=ae.schema.primaryKey;return r(r({},ae),{mutate:function(Ne){var Le=Ee.trans;if(me.outbound||Le.db._options.cache==="disabled"||Le.explicit||Le.idbtrans.mode!=="readwrite")return ae.mutate(Ne);var Ge=rd["idb://".concat(z,"/").concat(ne)];return Ge?(Le=ae.mutate(Ne),Ne.type!=="add"&&Ne.type!=="put"||!(50<=Ne.values.length||Ag(me,Ne).some(function(st){return st==null}))?(Ge.optimisticOps.push(Ne),Ne.mutatedParts&&Eg(Ne.mutatedParts),Le.then(function(st){0<st.numFailures&&(L(Ge.optimisticOps,Ne),(st=P_(0,Ne,st))&&Ge.optimisticOps.push(st),Ne.mutatedParts&&Eg(Ne.mutatedParts))}),Le.catch(function(){L(Ge.optimisticOps,Ne),Ne.mutatedParts&&Eg(Ne.mutatedParts)})):Le.then(function(st){var at=P_(0,r(r({},Ne),{values:Ne.values.map(function(pt,Je){var gt;return st.failures[Je]?pt:(pt=(gt=me.keyPath)!==null&&gt!==void 0&&gt.includes(".")?H(pt):r({},pt),A(pt,me.keyPath,st.results[Je]),pt)})}),st);Ge.optimisticOps.push(at),queueMicrotask(function(){return Ne.mutatedParts&&Eg(Ne.mutatedParts)})}),Le):ae.mutate(Ne)},query:function(Ne){if(!sd(Ee,ae)||!j_("query",Ne))return ae.query(Ne);var Le=((at=Ee.trans)===null||at===void 0?void 0:at.db._options.cache)==="immutable",Je=Ee,Ge=Je.requery,st=Je.signal,at=function(ht,yt,ot,kt){var Nt=rd["idb://".concat(ht,"/").concat(yt)];if(!Nt)return[];if(!(yt=Nt.queries[ot]))return[null,!1,Nt,null];var Mt=yt[(kt.query?kt.query.index.name:null)||""];if(!Mt)return[null,!1,Nt,null];switch(ot){case"query":var Ot=Mt.find(function(Xt){return Xt.req.limit===kt.limit&&Xt.req.values===kt.values&&Of(Xt.req.query.range,kt.query.range)});return Ot?[Ot,!0,Nt,Mt]:[Mt.find(function(Xt){return("limit"in Xt.req?Xt.req.limit:1/0)>=kt.limit&&(!kt.values||Xt.req.values)&&Cp(Xt.req.query.range,kt.query.range)}),!1,Nt,Mt];case"count":return Ot=Mt.find(function(Xt){return Of(Xt.req.query.range,kt.query.range)}),[Ot,!!Ot,Nt,Mt]}}(z,ne,"query",Ne),pt=at[0],Je=at[1],gt=at[2],rt=at[3];return pt&&Je?pt.obsSet=Ne.obsSet:(Je=ae.query(Ne).then(function(ht){var yt=ht.result;if(pt&&(pt.res=yt),Le){for(var ot=0,kt=yt.length;ot<kt;++ot)Object.freeze(yt[ot]);Object.freeze(yt)}else ht.result=H(yt);return ht}).catch(function(ht){return rt&&pt&&L(rt,pt),Promise.reject(ht)}),pt={obsSet:Ne.obsSet,promise:Je,subscribers:new Set,type:"query",req:Ne,dirty:!1},rt?rt.push(pt):(rt=[pt],(gt=gt||(rd["idb://".concat(z,"/").concat(ne)]={queries:{query:{},count:{}},objs:new Map,optimisticOps:[],unsignaledParts:{}})).queries.query[Ne.query.index.name||""]=rt)),jA(pt,rt,Ge,st),pt.promise.then(function(ht){return{result:Zb(ht.result,Ne,gt==null?void 0:gt.optimisticOps,ae,pt,Le)}})}})}})}};function kp(M,z){return new Proxy(M,{get:function(ne,ae,me){return ae==="db"?z:Reflect.get(ne,ae,me)}})}var Cl=(Bs.prototype.version=function(M){if(isNaN(M)||M<.1)throw new Ce.Type("Given version is not a positive number");if(M=Math.round(10*M)/10,this.idbdb||this._state.isBeingOpened)throw new Ce.Schema("Cannot add version when database is open");this.verno=Math.max(this.verno,M);var z=this._versions,ne=z.filter(function(ae){return ae._cfg.version===M})[0];return ne||(ne=new this.Version(M),z.push(ne),z.sort(Bb),ne.stores({}),this._state.autoSchema=!1,ne)},Bs.prototype._whenReady=function(M){var z=this;return this.idbdb&&(this._state.openComplete||Ee.letThrough||this._vip)?M():new $(function(ne,ae){if(z._state.openComplete)return ae(new Ce.DatabaseClosed(z._state.dbOpenError));if(!z._state.isBeingOpened){if(!z._state.autoOpen)return void ae(new Ce.DatabaseClosed);z.open().catch(We)}z._state.dbReadyPromise.then(ne,ae)}).then(M)},Bs.prototype.use=function(M){var z=M.stack,ne=M.create,ae=M.level,me=M.name;return me&&this.unuse({stack:z,name:me}),M=this._middlewares[z]||(this._middlewares[z]=[]),M.push({stack:z,create:ne,level:ae??10,name:me}),M.sort(function(Ne,Le){return Ne.level-Le.level}),this},Bs.prototype.unuse=function(M){var z=M.stack,ne=M.name,ae=M.create;return z&&this._middlewares[z]&&(this._middlewares[z]=this._middlewares[z].filter(function(me){return ae?me.create!==ae:!!ne&&me.name!==ne})),this},Bs.prototype.open=function(){var M=this;return nt(ge,function(){return NA(M)})},Bs.prototype._close=function(){var M=this._state,z=di.indexOf(this);if(0<=z&&di.splice(z,1),this.idbdb){try{this.idbdb.close()}catch{}this.idbdb=null}M.isBeingOpened||(M.dbReadyPromise=new $(function(ne){M.dbReadyResolve=ne}),M.openCanceller=new $(function(ne,ae){M.cancelOpen=ae}))},Bs.prototype.close=function(ne){var z=(ne===void 0?{disableAutoOpen:!0}:ne).disableAutoOpen,ne=this._state;z?(ne.isBeingOpened&&ne.cancelOpen(new Ce.DatabaseClosed),this._close(),ne.autoOpen=!1,ne.dbOpenError=new Ce.DatabaseClosed):(this._close(),ne.autoOpen=this._options.autoOpen||ne.isBeingOpened,ne.openComplete=!1,ne.dbOpenError=null)},Bs.prototype.delete=function(M){var z=this;M===void 0&&(M={disableAutoOpen:!0});var ne=0<arguments.length&&typeof arguments[0]!="object",ae=this._state;return new $(function(me,Ne){function Le(){z.close(M);var Ge=z._deps.indexedDB.deleteDatabase(z.name);Ge.onsuccess=De(function(){var st,at,pt;st=z._deps,at=z.name,pt=st.indexedDB,st=st.IDBKeyRange,Sg(pt)||at===Ga||zb(pt,st).delete(at).catch(We),me()}),Ge.onerror=Zo(Ne),Ge.onblocked=z._fireOnBlocked}if(ne)throw new Ce.InvalidArgument("Invalid closeOptions argument to db.delete()");ae.isBeingOpened?ae.dbReadyPromise.then(Le):Le()})},Bs.prototype.backendDB=function(){return this.idbdb},Bs.prototype.isOpen=function(){return this.idbdb!==null},Bs.prototype.hasBeenClosed=function(){var M=this._state.dbOpenError;return M&&M.name==="DatabaseClosed"},Bs.prototype.hasFailed=function(){return this._state.dbOpenError!==null},Bs.prototype.dynamicallyOpened=function(){return this._state.autoSchema},Object.defineProperty(Bs.prototype,"tables",{get:function(){var M=this;return a(this._allTables).map(function(z){return M._allTables[z]})},enumerable:!1,configurable:!0}),Bs.prototype.transaction=function(){var M=(function(z,ne,ae){var me=arguments.length;if(me<2)throw new Ce.InvalidArgument("Too few arguments");for(var Ne=new Array(me-1);--me;)Ne[me-1]=arguments[me];return ae=Ne.pop(),[z,O(Ne),ae]}).apply(this,arguments);return this._transaction.apply(this,M)},Bs.prototype._transaction=function(M,z,ne){var ae=this,me=Ee.trans;me&&me.db===this&&M.indexOf("!")===-1||(me=null);var Ne,Le,Ge=M.indexOf("?")!==-1;M=M.replace("!","").replace("?","");try{if(Le=z.map(function(at){if(at=at instanceof ae.Table?at.name:at,typeof at!="string")throw new TypeError("Invalid table argument to Dexie.transaction(). Only Table or String are allowed");return at}),M=="r"||M===pa)Ne=pa;else{if(M!="rw"&&M!=Hs)throw new Ce.InvalidArgument("Invalid transaction mode: "+M);Ne=Hs}if(me){if(me.mode===pa&&Ne===Hs){if(!Ge)throw new Ce.SubTransaction("Cannot enter a sub-transaction with READWRITE mode when parent transaction is READONLY");me=null}me&&Le.forEach(function(at){if(me&&me.storeNames.indexOf(at)===-1){if(!Ge)throw new Ce.SubTransaction("Table "+at+" not included in parent transaction.");me=null}}),Ge&&me&&!me.active&&(me=null)}}catch(at){return me?me._promise(null,function(pt,Je){Je(at)}):ir(at)}var st=(function at(pt,Je,gt,rt,ht){return $.resolve().then(function(){var yt=Ee.transless||Ee,ot=pt._createTransaction(Je,gt,pt._dbSchema,rt);if(ot.explicit=!0,yt={trans:ot,transless:yt},rt)ot.idbtrans=rt.idbtrans;else try{ot.create(),ot.idbtrans._explicit=!0,pt._state.PR1398_maxLoop=3}catch(Mt){return Mt.name===Fe.InvalidState&&pt.isOpen()&&0<--pt._state.PR1398_maxLoop?(console.warn("Dexie: Need to reopen db"),pt.close({disableAutoOpen:!1}),pt.open().then(function(){return at(pt,Je,gt,null,ht)})):ir(Mt)}var kt,Nt=Q(ht);return Nt&&br(),yt=$.follow(function(){var Mt;(kt=ht.call(ot,ot))&&(Nt?(Mt=Mr.bind(null,null),kt.then(Mt,Mt)):typeof kt.next=="function"&&typeof kt.throw=="function"&&(kt=Sp(kt)))},yt),(kt&&typeof kt.then=="function"?$.resolve(kt).then(function(Mt){return ot.active?Mt:ir(new Ce.PrematureCommit("Transaction committed too early. See http://bit.ly/2kdckMn"))}):yt.then(function(){return kt})).then(function(Mt){return rt&&ot._resolve(),ot._completion.then(function(){return Mt})}).catch(function(Mt){return ot._reject(Mt),ir(Mt)})})}).bind(null,this,Ne,Le,me,ne);return me?me._promise(Ne,st,"lock"):Ee.trans?nt(Ee.transless,function(){return ae._whenReady(st)}):this._whenReady(st)},Bs.prototype.table=function(M){if(!d(this._allTables,M))throw new Ce.InvalidTable("Table ".concat(M," does not exist"));return this._allTables[M]},Bs);function Bs(M,z){var ne=this;this._middlewares={},this.verno=0;var ae=Bs.dependencies;this._options=z=r({addons:Bs.addons,autoOpen:!0,indexedDB:ae.indexedDB,IDBKeyRange:ae.IDBKeyRange,cache:"cloned"},z),this._deps={indexedDB:z.indexedDB,IDBKeyRange:z.IDBKeyRange},ae=z.addons,this._dbSchema={},this._versions=[],this._storeNames=[],this._allTables={},this.idbdb=null,this._novip=this;var me,Ne,Le,Ge,st,at={dbOpenError:null,isBeingOpened:!1,onReadyBeingFired:null,openComplete:!1,dbReadyResolve:We,dbReadyPromise:null,cancelOpen:We,openCanceller:null,autoSchema:!0,PR1398_maxLoop:3,autoOpen:z.autoOpen};at.dbReadyPromise=new $(function(Je){at.dbReadyResolve=Je}),at.openCanceller=new $(function(Je,gt){at.cancelOpen=gt}),this._state=at,this.name=M,this.on=Kc(this,"populate","blocked","versionchange","close",{ready:[Me,We]}),this.on.ready.subscribe=S(this.on.ready.subscribe,function(Je){return function(gt,rt){Bs.vip(function(){var ht,yt=ne._state;yt.openComplete?(yt.dbOpenError||$.resolve().then(gt),rt&&Je(gt)):yt.onReadyBeingFired?(yt.onReadyBeingFired.push(gt),rt&&Je(gt)):(Je(gt),ht=ne,rt||Je(function ot(){ht.on.ready.unsubscribe(gt),ht.on.ready.unsubscribe(ot)}))})}}),this.Collection=(me=this,Cf(Af.prototype,function(kt,ot){this.db=me;var rt=wl,ht=null;if(ot)try{rt=ot()}catch(Nt){ht=Nt}var yt=kt._ctx,ot=yt.table,kt=ot.hook.reading.fire;this._ctx={table:ot,index:yt.index,isPrimKey:!yt.index||ot.schema.primKey.keyPath&&yt.index===ot.schema.primKey.name,range:rt,keysOnly:!1,dir:"next",unique:"",algorithm:null,filter:null,replayFilter:null,justLimit:!0,isMatch:null,offset:0,limit:1/0,error:ht,or:yt.or,valueMapper:kt!==je?kt:null}})),this.Table=(Ne=this,Cf(jb.prototype,function(Je,gt,rt){this.db=Ne,this._tx=rt,this.name=Je,this.schema=gt,this.hook=Ne._allTables[Je]?Ne._allTables[Je].hook:Kc(null,{creating:[Ie,We],reading:[Y,je],updating:[oe,We],deleting:[ce,We]})})),this.Transaction=(Le=this,Cf(Lb.prototype,function(Je,gt,rt,ht,yt){var ot=this;this.db=Le,this.mode=Je,this.storeNames=gt,this.schema=rt,this.chromeTransactionDurability=ht,this.idbtrans=null,this.on=Kc(this,"complete","error","abort"),this.parent=yt||null,this.active=!0,this._reculock=0,this._blockedFuncs=[],this._resolve=null,this._reject=null,this._waitingFor=null,this._waitingQueue=null,this._spinCount=0,this._completion=new $(function(kt,Nt){ot._resolve=kt,ot._reject=Nt}),this._completion.then(function(){ot.active=!1,ot.on.complete.fire()},function(kt){var Nt=ot.active;return ot.active=!1,ot.on.error.fire(kt),ot.parent?ot.parent._reject(kt):Nt&&ot.idbtrans&&ot.idbtrans.abort(),ir(kt)})})),this.Version=(Ge=this,Cf(RA.prototype,function(Je){this.db=Ge,this._cfg={version:Je,storesSource:null,dbschema:{},tables:{},contentUpgrade:null}})),this.WhereClause=(st=this,Cf(Ju.prototype,function(Je,gt,rt){if(this.db=st,this._ctx={table:Je,index:gt===":id"?null:gt,or:rt},this._cmp=this._ascending=Fr,this._descending=function(ht,yt){return Fr(yt,ht)},this._max=function(ht,yt){return 0<Fr(ht,yt)?ht:yt},this._min=function(ht,yt){return Fr(ht,yt)<0?ht:yt},this._IDBKeyRange=st._deps.IDBKeyRange,!this._IDBKeyRange)throw new Ce.MissingAPI})),this.on("versionchange",function(Je){0<Je.newVersion?console.warn("Another connection wants to upgrade database '".concat(ne.name,"'. Closing db now to resume the upgrade.")):console.warn("Another connection wants to delete database '".concat(ne.name,"'. Closing db now to resume the delete request.")),ne.close({disableAutoOpen:!1})}),this.on("blocked",function(Je){!Je.newVersion||Je.newVersion<Je.oldVersion?console.warn("Dexie.delete('".concat(ne.name,"') was blocked")):console.warn("Upgrade '".concat(ne.name,"' blocked by other connection holding version ").concat(Je.oldVersion/10))}),this._maxKey=If(z.IDBKeyRange),this._createTransaction=function(Je,gt,rt,ht){return new ne.Transaction(Je,gt,rt,ne._options.chromeTransactionDurability,ht)},this._fireOnBlocked=function(Je){ne.on("blocked").fire(Je),di.filter(function(gt){return gt.name===ne.name&&gt!==ne&&!gt._state.vcFired}).map(function(gt){return gt.on("versionchange").fire(Je)})},this.use(I_),this.use(Ng),this.use(IA),this.use(MA),this.use(M_);var pt=new Proxy(this,{get:function(Je,gt,rt){if(gt==="_vip")return!0;if(gt==="table")return function(yt){return kp(ne.table(yt),pt)};var ht=Reflect.get(Je,gt,rt);return ht instanceof jb?kp(ht,pt):gt==="tables"?ht.map(function(yt){return kp(yt,pt)}):gt==="_createTransaction"?function(){return kp(ht.apply(this,arguments),pt)}:ht}});this.vip=pt,ae.forEach(function(Je){return Je(ne)})}var Df,Za=typeof Symbol<"u"&&"observable"in Symbol?Symbol.observable:"@@observable",O_=(Mg.prototype.subscribe=function(M,z,ne){return this._subscribe(M&&typeof M!="function"?M:{next:M,error:z,complete:ne})},Mg.prototype[Za]=function(){return this},Mg);function Mg(M){this._subscribe=M}try{Df={indexedDB:i.indexedDB||i.mozIndexedDB||i.webkitIndexedDB||i.msIndexedDB,IDBKeyRange:i.IDBKeyRange||i.webkitIDBKeyRange}}catch{Df={indexedDB:null,IDBKeyRange:null}}function D_(M){var z,ne=!1,ae=new O_(function(me){var Ne=Q(M),Le,Ge=!1,st={},at={},pt={get closed(){return Ge},unsubscribe:function(){Ge||(Ge=!0,Le&&Le.abort(),Je&&Zi.storagemutated.unsubscribe(rt))}};me.start&&me.start(pt);var Je=!1,gt=function(){return gn(ht)},rt=function(yt){kg(st,yt),Wb(at,st)&&gt()},ht=function(){var yt,ot,kt;!Ge&&Df.indexedDB&&(st={},yt={},Le&&Le.abort(),Le=new AbortController,kt=function(Nt){var Mt=Z();try{Ne&&br();var Ot=fn(M,Nt);return Ot=Ne?Ot.finally(Mr):Ot}finally{Mt&&G()}}(ot={subscr:yt,signal:Le.signal,requery:gt,querier:M,trans:null}),Promise.resolve(kt).then(function(Nt){ne=!0,z=Nt,Ge||ot.signal.aborted||(st={},function(Mt){for(var Ot in Mt)if(d(Mt,Ot))return;return 1}(at=yt)||Je||(Zi(Nf,rt),Je=!0),gn(function(){return!Ge&&me.next&&me.next(Nt)}))},function(Nt){ne=!1,["DatabaseClosedError","AbortError"].includes(Nt==null?void 0:Nt.name)||Ge||gn(function(){Ge||me.error&&me.error(Nt)})}))};return setTimeout(gt,0),pt});return ae.hasValue=function(){return ne},ae.getValue=function(){return z},ae}var id=Cl;function Xb(M){var z=Xc;try{Xc=!0,Zi.storagemutated.fire(M),Kb(M,!0)}finally{Xc=z}}h(id,r(r({},Qe),{delete:function(M){return new id(M,{addons:[]}).delete()},exists:function(M){return new id(M,{addons:[]}).open().then(function(z){return z.close(),!0}).catch("NoSuchDatabaseError",function(){return!1})},getDatabaseNames:function(M){try{return z=id.dependencies,ne=z.indexedDB,z=z.IDBKeyRange,(Sg(ne)?Promise.resolve(ne.databases()).then(function(ae){return ae.map(function(me){return me.name}).filter(function(me){return me!==Ga})}):zb(ne,z).toCollection().primaryKeys()).then(M)}catch{return ir(new Ce.MissingAPI)}var z,ne},defineClass:function(){return function(M){l(this,M)}},ignoreTransaction:function(M){return Ee.trans?nt(Ee.transless,M):M()},vip:Ub,async:function(M){return function(){try{var z=Sp(M.apply(this,arguments));return z&&typeof z.then=="function"?z:$.resolve(z)}catch(ne){return ir(ne)}}},spawn:function(M,z,ne){try{var ae=Sp(M.apply(ne,z||[]));return ae&&typeof ae.then=="function"?ae:$.resolve(ae)}catch(me){return ir(me)}},currentTransaction:{get:function(){return Ee.trans||null}},waitFor:function(M,z){return z=$.resolve(typeof M=="function"?id.ignoreTransaction(M):M).timeout(z||6e4),Ee.trans?Ee.trans.waitFor(z):z},Promise:$,debug:{get:function(){return Be},set:function(M){Ae(M)}},derive:b,extend:l,props:h,override:S,Events:Kc,on:Zi,liveQuery:D_,extendObservabilitySet:kg,getByKeyPath:T,setByKeyPath:A,delByKeyPath:function(M,z){typeof z=="string"?A(M,z,void 0):"length"in z&&[].map.call(z,function(ne){A(M,ne,void 0)})},shallowClone:N,deepClone:H,getObjectDiff:Tg,cmp:Fr,asap:C,minKey:-1/0,addons:[],connections:di,errnames:Fe,dependencies:Df,cache:rd,semVer:"4.0.11",version:"4.0.11".split(".").map(function(M){return parseInt(M)}).reduce(function(M,z,ne){return M+z/Math.pow(10,2*ne)})})),id.maxKey=If(id.dependencies.IDBKeyRange),typeof dispatchEvent<"u"&&typeof addEventListener<"u"&&(Zi(Nf,function(M){Xc||(M=new CustomEvent(ed,{detail:M}),Xc=!0,dispatchEvent(M),Xc=!1)}),addEventListener(ed,function(M){M=M.detail,Xc||Xb(M)}));var Ff,Xc=!1,Aa=function(){};return typeof BroadcastChannel<"u"&&((Aa=function(){(Ff=new BroadcastChannel(ed)).onmessage=function(M){return M.data&&Xb(M.data)}})(),typeof Ff.unref=="function"&&Ff.unref(),Zi(Nf,function(M){Xc||Ff.postMessage(M)})),typeof addEventListener<"u"&&(addEventListener("pagehide",function(M){if(!Cl.disableBfCache&&M.persisted){Be&&console.debug("Dexie: handling persisted pagehide"),Ff!=null&&Ff.close();for(var z=0,ne=di;z<ne.length;z++)ne[z].close({disableAutoOpen:!1})}}),addEventListener("pageshow",function(M){!Cl.disableBfCache&&M.persisted&&(Be&&console.debug("Dexie: handling persisted pageshow"),Aa(),Xb({all:new Xi(-1/0,[[]])}))})),$.rejectionMapper=function(M,z){return!M||M instanceof re||M instanceof TypeError||M instanceof SyntaxError||!M.name||!qe[M.name]?M:(z=new qe[M.name](z||M.message,M),"stack"in M&&y(z,"stack",{get:function(){return this.inner.stack}}),z)},Ae(Be),r(Cl,Object.freeze({__proto__:null,Dexie:Cl,liveQuery:D_,Entity:fg,cmp:Fr,PropModification:Tf,replacePrefix:function(M,z){return new Tf({replacePrefix:[M,z]})},add:function(M){return new Tf({add:M})},remove:function(M){return new Tf({remove:M})},default:Cl,RangeSet:Xi,mergeRanges:nd,rangesOverlap:A_}),{default:Cl}),Cl})}(PC)),PC.exports}var I0e=M0e();const uj=da(I0e),WB=Symbol.for("Dexie"),y2=globalThis[WB]||(globalThis[WB]=uj);if(uj.semVer!==y2.semVer)throw new Error(`Two different versions of Dexie loaded in the same app: ${uj.semVer} and ${y2.semVer}`);const{liveQuery:gdt,mergeRanges:ydt,rangesOverlap:bdt,RangeSet:vdt,cmp:xdt,Entity:wdt,PropModification:_dt,replacePrefix:Sdt,add:Cdt,remove:kdt}=y2;class j0e extends y2{constructor(){super("LiteChatDatabase_Rewrite_v1");ue(this,"conversations");ue(this,"interactions");ue(this,"mods");ue(this,"appState");ue(this,"providerConfigs");ue(this,"apiKeys");ue(this,"syncRepos");ue(this,"projects");ue(this,"rules");ue(this,"tags");ue(this,"tagRuleLinks");ue(this,"promptTemplates");this.version(9).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]",promptTemplates:"++id, &name, createdAt, updatedAt, isPublic"}),this.version(8).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId, rating",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(7).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name",rules:"++id, &name, type, createdAt, updatedAt",tags:"++id, &name, createdAt, updatedAt",tagRuleLinks:"++id, tagId, ruleId, &[tagId+ruleId]"}),this.version(6).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl, username",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(5).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &path, parentId, createdAt, updatedAt, name"}),this.version(4).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, name, parentId, createdAt, updatedAt"}),this.version(3).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt, projectId",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl",projects:"++id, &name, parentId, createdAt, updatedAt"}),this.version(2).stores({conversations:"++id, title, createdAt, updatedAt, syncRepoId, lastSyncedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name",syncRepos:"++id, &name, remoteUrl"}),this.version(1).stores({conversations:"++id, title, createdAt, updatedAt",interactions:"++id, conversationId, index, type, status, startedAt, parentId",mods:"++id, &name, enabled, loadOrder",appState:"&key",providerConfigs:"++id, &name, type, isEnabled, apiKeyId",apiKeys:"++id, &name"})}}const It=new j0e,DH="useandom-26T198340PX75pxJACKVERYMINDBUSHWOLF_GQZbfghjklqvwyzrict";let qr=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e|=0));for(;e--;)t+=DH[n[e]&63];return t};const kN=Object.freeze(Object.defineProperty({__proto__:null,nanoid:qr,urlAlphabet:DH},Symbol.toStringTag,{value:"Module"})),mi=(e,t=[])=>{const n={...e};return e.createdAt&&!(e.createdAt instanceof Date)&&(n.createdAt=new Date(e.createdAt)),e.updatedAt&&!(e.updatedAt instanceof Date)&&(n.updatedAt=new Date(e.updatedAt)),Array.isArray(t)?t.forEach(r=>{e[r]&&!(e[r]instanceof Date)&&(n[r]=new Date(e[r]))}):console.warn("[ensureDateFields] Expected otherDateFields to be an array, but received:",t),n};class bt{static async loadConversations(){try{return(await It.conversations.orderBy("updatedAt").reverse().toArray()).map(n=>mi(n,["lastSyncedAt"]))}catch(t){throw console.error("PersistenceService: Error loading conversations:",t),t}}static async saveConversation(t){try{const n={...t,syncRepoId:t.syncRepoId??null,lastSyncedAt:t.lastSyncedAt??null,projectId:t.projectId??null};return await It.conversations.put(n)}catch(n){throw console.error("PersistenceService: Error saving conversation:",n),n}}static async deleteConversation(t){try{await It.conversations.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting conversation:",n),n}}static async loadInteractionsForConversation(t){try{return(await It.interactions.where({conversationId:t}).sortBy("index")).map(r=>mi(r,["startedAt","endedAt"]))}catch(n){throw console.error("PersistenceService: Error loading interactions for conversation:",n),n}}static async saveInteraction(t){try{return await It.interactions.put(t)}catch(n){throw console.error("PersistenceService: Error saving interaction:",n),n}}static async deleteInteraction(t){try{await It.interactions.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting interaction:",n),n}}static async deleteInteractionsForConversation(t){try{await It.interactions.where({conversationId:t}).delete()}catch(n){throw console.error("PersistenceService: Error deleting interactions for conversation:",n),n}}static async loadMods(){try{return(await It.mods.orderBy("loadOrder").toArray()).map(n=>mi(n,[]))}catch(t){throw console.error("PersistenceService: Error loading mods:",t),t}}static async saveMod(t){try{return await It.mods.put(t)}catch(n){throw console.error("PersistenceService: Error saving mod:",n),n}}static async deleteMod(t){try{await It.mods.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting mod:",n),n}}static async saveSetting(t,n){try{return await It.appState.put({key:`settings:${t}`,value:n})}catch(r){throw console.error("PersistenceService: Error saving setting:",r),r}}static async loadSetting(t,n){try{const r=await It.appState.get(`settings:${t}`);return(r==null?void 0:r.value)!==void 0?r.value:n}catch(r){return console.error("PersistenceService: Error loading setting:",r),n}}static async loadProviderConfigs(){var t;try{return(await((t=It.providerConfigs)==null?void 0:t.toArray())??[]).map(r=>mi(r,["modelsLastFetchedAt"]))}catch(n){throw console.error("PersistenceService: Error loading provider configs:",n),n}}static async saveProviderConfig(t){try{return await It.providerConfigs.put(t)}catch(n){throw console.error("PersistenceService: Error saving provider config:",n),n}}static async deleteProviderConfig(t){try{await It.providerConfigs.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting provider config:",n),n}}static async loadApiKeys(){var t;try{return(await((t=It.apiKeys)==null?void 0:t.toArray())??[]).map(r=>mi(r,[]))}catch(n){throw console.error("PersistenceService: Error loading API keys:",n),n}}static async saveApiKey(t){try{return await It.apiKeys.put(t)}catch(n){throw console.error("PersistenceService: Error saving API key:",n),n}}static async deleteApiKey(t){try{await It.transaction("rw",[It.apiKeys,It.providerConfigs],async()=>{const n=await It.providerConfigs.where("apiKeyId").equals(t).toArray();if(n.length>0){const r=n.map(s=>It.providerConfigs.update(s.id,{apiKeyId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked API key ${t} from ${n.length} provider configs.`)}await It.apiKeys.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting API key:",n),n}}static async loadSyncRepos(){try{return(await It.syncRepos.toArray()).map(n=>mi(n,["lastPulledAt","lastPushedAt"]))}catch(t){throw console.error("PersistenceService: Error loading sync repos:",t),t}}static async saveSyncRepo(t){try{return await It.syncRepos.put(t)}catch(n){throw console.error("PersistenceService: Error saving sync repo:",n),n}}static async deleteSyncRepo(t){try{await It.transaction("rw",[It.syncRepos,It.conversations],async()=>{const n=await It.conversations.where("syncRepoId").equals(t).toArray();if(n.length>0){const r=n.map(s=>It.conversations.update(s.id,{syncRepoId:null}));await Promise.all(r),console.log(`PersistenceService: Unlinked SyncRepo ${t} from ${n.length} conversations.`)}await It.syncRepos.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting sync repo:",n),n}}static async loadProjects(){try{return(await It.projects.orderBy("updatedAt").reverse().toArray()).map(n=>mi(n,[]))}catch(t){throw console.error("PersistenceService: Error loading projects:",t),t}}static async saveProject(t){try{const n={id:t.id,path:t.path,createdAt:t.createdAt,updatedAt:t.updatedAt,name:t.name,parentId:t.parentId??null,systemPrompt:t.systemPrompt??null,modelId:t.modelId??null,temperature:t.temperature??null,maxTokens:t.maxTokens??null,topP:t.topP??null,topK:t.topK??null,presencePenalty:t.presencePenalty??null,frequencyPenalty:t.frequencyPenalty??null,defaultTagIds:t.defaultTagIds??null,defaultRuleIds:t.defaultRuleIds??null,metadata:t.metadata?{...t.metadata}:{}};return await It.projects.put(n)}catch(n){throw console.error("PersistenceService: Error saving project:",n),n}}static async deleteProject(t){try{const n=async r=>{const s=await It.projects.where("parentId").equals(r).toArray();for(const i of s)await n(i.id);await It.projects.delete(r),console.log(`PersistenceService: Deleted Project ${r}`)};await It.transaction("rw",[It.projects],async()=>{await n(t)})}catch(n){throw console.error("PersistenceService: Error deleting project:",n),n}}static async loadRules(){try{return(await It.rules.orderBy("name").toArray()).map(n=>mi(n))}catch(t){throw console.error("PersistenceService: Error loading rules:",t),t}}static async saveRule(t){try{return await It.rules.put(t)}catch(n){throw console.error("PersistenceService: Error saving rule:",n),n}}static async deleteRule(t){try{await It.transaction("rw",[It.rules,It.tagRuleLinks],async()=>{await It.tagRuleLinks.where("ruleId").equals(t).delete(),await It.rules.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting rule:",n),n}}static async loadTags(){try{return(await It.tags.orderBy("name").toArray()).map(n=>mi(n))}catch(t){throw console.error("PersistenceService: Error loading tags:",t),t}}static async saveTag(t){try{return await It.tags.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag:",n),n}}static async deleteTag(t){try{await It.transaction("rw",[It.tags,It.tagRuleLinks],async()=>{await It.tagRuleLinks.where("tagId").equals(t).delete(),await It.tags.delete(t)})}catch(n){throw console.error("PersistenceService: Error deleting tag:",n),n}}static async loadTagRuleLinks(){try{return await It.tagRuleLinks.toArray()}catch(t){throw console.error("PersistenceService: Error loading tag-rule links:",t),t}}static async saveTagRuleLink(t){try{return await It.tagRuleLinks.put(t)}catch(n){throw console.error("PersistenceService: Error saving tag-rule link:",n),n}}static async deleteTagRuleLink(t){try{await It.tagRuleLinks.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting tag-rule link:",n),n}}static async getAllDataForExport(t){const n={version:1,exportedAt:new Date().toISOString()};if(t.importSettings){const r=await It.appState.toArray();n.settings={},r.forEach(s=>{s.key.startsWith("settings:")&&s.key!=="settings:mcpServers"&&(n.settings[s.key.substring(9)]=s.value)})}if(t.importApiKeys&&(n.apiKeys=await It.apiKeys.toArray()),t.importProviderConfigs&&(n.providerConfigs=await It.providerConfigs.toArray()),t.importProjects&&(n.projects=await It.projects.toArray()),t.importConversations&&(n.conversations=await It.conversations.toArray(),n.interactions=await It.interactions.toArray()),t.importRulesAndTags&&(n.rules=await It.rules.toArray(),n.tags=await It.tags.toArray(),n.tagRuleLinks=await It.tagRuleLinks.toArray()),t.importMods&&(n.mods=await It.mods.toArray()),t.importSyncRepos&&(n.syncRepos=await It.syncRepos.toArray()),t.importMcpServers){const s=(await It.appState.toArray()).find(i=>i.key==="settings:mcpServers");n.mcpServers=s?s.value:[]}if(t.importPromptTemplates){const r=await It.promptTemplates.toArray();n.promptTemplates=r.filter(s=>!s.type||s.type==="prompt")}if(t.importAgents){const r=await It.promptTemplates.toArray(),s=r.filter(o=>o.type==="agent"),i=s.map(o=>o.id),a=r.filter(o=>o.type==="task"&&i.includes(o.parentId));n.agents=[...s,...a]}return n}static async importAllData(t,n){if(t.version!==1)throw new Error(`Unsupported export version: ${t.version}. Expected version 1.`);await It.transaction("rw",[It.appState,It.apiKeys,It.providerConfigs,It.projects,It.conversations,It.interactions,It.rules,It.tags,It.tagRuleLinks,It.mods,It.syncRepos,It.promptTemplates],async()=>{if(n.importSettings&&await It.appState.clear(),n.importApiKeys&&await It.apiKeys.clear(),n.importProviderConfigs&&await It.providerConfigs.clear(),n.importProjects&&await It.projects.clear(),n.importConversations&&(await It.conversations.clear(),await It.interactions.clear()),n.importRulesAndTags&&(await It.rules.clear(),await It.tags.clear(),await It.tagRuleLinks.clear()),n.importMods&&await It.mods.clear(),n.importSyncRepos&&await It.syncRepos.clear(),n.importMcpServers&&await It.appState.where("key").equals("settings:mcpServers").delete(),n.importPromptTemplates){const i=(await It.promptTemplates.toArray()).filter(a=>!a.type||a.type==="prompt").map(a=>a.id||qr());i.length>0&&await It.promptTemplates.where("id").anyOf(i).delete()}if(n.importAgents&&t.agents){const s=t.agents.filter(l=>l.type==="agent").map(l=>l.id||qr()),a=t.agents.filter(l=>l.type==="task").map(l=>l.id||qr()),o=[...s,...a];o.length>0&&await It.promptTemplates.where("id").anyOf(o).delete()}if(n.importSettings&&t.settings){const r=Object.entries(t.settings).map(([s,i])=>({key:`settings:${s}`,value:i}));await It.appState.bulkPut(r)}n.importApiKeys&&t.apiKeys&&await It.apiKeys.bulkPut(t.apiKeys.map(r=>mi(r))),n.importProviderConfigs&&t.providerConfigs&&await It.providerConfigs.bulkPut(t.providerConfigs.map(r=>mi(r,["modelsLastFetchedAt"]))),n.importProjects&&t.projects&&await It.projects.bulkPut(t.projects.map(r=>mi(r))),n.importConversations&&t.conversations&&(await It.conversations.bulkPut(t.conversations.map(r=>mi(r,["lastSyncedAt"]))),t.interactions&&await It.interactions.bulkPut(t.interactions.map(r=>mi(r,["startedAt","endedAt"])))),n.importRulesAndTags&&(t.rules&&await It.rules.bulkPut(t.rules.map(r=>mi(r))),t.tags&&await It.tags.bulkPut(t.tags.map(r=>mi(r))),t.tagRuleLinks&&await It.tagRuleLinks.bulkPut(t.tagRuleLinks)),n.importMods&&t.mods&&await It.mods.bulkPut(t.mods.map(r=>mi(r))),n.importSyncRepos&&t.syncRepos&&await It.syncRepos.bulkPut(t.syncRepos.map(r=>mi(r,["lastPulledAt","lastPushedAt"]))),n.importMcpServers&&t.mcpServers&&await It.appState.put({key:"settings:mcpServers",value:t.mcpServers}),n.importPromptTemplates&&t.promptTemplates&&await It.promptTemplates.bulkPut(t.promptTemplates.map(r=>mi({...r,id:r.id||qr()},["createdAt","updatedAt"]))),n.importAgents&&t.agents&&await It.promptTemplates.bulkPut(t.agents.map(r=>mi({...r,id:r.id||qr()},["createdAt","updatedAt"])))})}static async loadPromptTemplates(){try{return(await It.promptTemplates.orderBy("name").toArray()).map(n=>mi(n,["createdAt","updatedAt"]))}catch(t){throw console.error("PersistenceService: Error loading prompt templates:",t),t}}static async savePromptTemplate(t){try{return await It.promptTemplates.put(t)}catch(n){throw console.error("PersistenceService: Error saving prompt template:",n),n}}static async deletePromptTemplate(t){try{await It.promptTemplates.delete(t)}catch(n){throw console.error("PersistenceService: Error deleting prompt template:",n),n}}static async clearAllData(){try{await It.transaction("rw",[It.conversations,It.interactions,It.mods,It.appState,It.providerConfigs,It.apiKeys,It.syncRepos,It.projects,It.rules,It.tags,It.tagRuleLinks,It.promptTemplates],async()=>{await It.conversations.clear(),await It.interactions.clear(),await It.mods.clear(),await It.appState.clear(),await It.providerConfigs.clear(),await It.apiKeys.clear(),await It.syncRepos.clear(),await It.projects.clear(),await It.rules.clear(),await It.tags.clear(),await It.tagRuleLinks.clear(),await It.promptTemplates.clear()})}catch(t){throw console.error("PersistenceService: Error clearing all data:",t),t}}}const En={loaded:"interaction.loaded",currentConversationIdChanged:"interaction.current.conversation.id.changed",added:"interaction.added",updated:"interaction.updated",streamingIdsChanged:"interaction.streaming.ids.changed",activeStreamBuffersChanged:"interaction.active.stream.buffers.changed",activeReasoningBuffersChanged:"interaction.active.reasoning.buffers.changed",statusChanged:"interaction.status.changed",errorChanged:"interaction.error.changed",interactionRated:"interaction.rated",started:"interaction.sdk.started",streamChunk:"interaction.sdk.streamChunk",completed:"interaction.sdk.completed",loadInteractionsRequest:"interaction.load.interactions.request",rateInteractionRequest:"interaction.rate.interaction.request",setCurrentConversationIdRequest:"interaction.set.current.conversation.id.request",clearInteractionsRequest:"interaction.clear.interactions.request",setErrorRequest:"interaction.set.error.request",setStatusRequest:"interaction.set.status.request"};var dl=iH();const AE=da(dl);function P0e(e){if(typeof document>"u")return;let t=document.head||document.getElementsByTagName("head")[0],n=document.createElement("style");n.type="text/css",t.appendChild(n),n.styleSheet?n.styleSheet.cssText=e:n.appendChild(document.createTextNode(e))}const O0e=e=>{switch(e){case"success":return L0e;case"info":return $0e;case"warning":return B0e;case"error":return z0e;default:return null}},D0e=Array(12).fill(0),F0e=({visible:e,className:t})=>Ve.createElement("div",{className:["sonner-loading-wrapper",t].filter(Boolean).join(" "),"data-visible":e},Ve.createElement("div",{className:"sonner-spinner"},D0e.map((n,r)=>Ve.createElement("div",{className:"sonner-loading-bar",key:`spinner-bar-${r}`})))),L0e=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ve.createElement("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.857-9.809a.75.75 0 00-1.214-.882l-3.483 4.79-1.88-1.88a.75.75 0 10-1.06 1.061l2.5 2.5a.75.75 0 001.137-.089l4-5.5z",clipRule:"evenodd"})),B0e=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 24 24",fill:"currentColor",height:"20",width:"20"},Ve.createElement("path",{fillRule:"evenodd",d:"M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003zM12 8.25a.75.75 0 01.75.75v3.75a.75.75 0 01-1.5 0V9a.75.75 0 01.75-.75zm0 8.25a.75.75 0 100-1.5.75.75 0 000 1.5z",clipRule:"evenodd"})),$0e=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ve.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a.75.75 0 000 1.5h.253a.25.25 0 01.244.304l-.459 2.066A1.75 1.75 0 0010.747 15H11a.75.75 0 000-1.5h-.253a.25.25 0 01-.244-.304l.459-2.066A1.75 1.75 0 009.253 9H9z",clipRule:"evenodd"})),z0e=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor",height:"20",width:"20"},Ve.createElement("path",{fillRule:"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-8-5a.75.75 0 01.75.75v4.5a.75.75 0 01-1.5 0v-4.5A.75.75 0 0110 5zm0 10a1 1 0 100-2 1 1 0 000 2z",clipRule:"evenodd"})),U0e=Ve.createElement("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"1.5",strokeLinecap:"round",strokeLinejoin:"round"},Ve.createElement("line",{x1:"18",y1:"6",x2:"6",y2:"18"}),Ve.createElement("line",{x1:"6",y1:"6",x2:"18",y2:"18"})),q0e=()=>{const[e,t]=Ve.useState(document.hidden);return Ve.useEffect(()=>{const n=()=>{t(document.hidden)};return document.addEventListener("visibilitychange",n),()=>window.removeEventListener("visibilitychange",n)},[]),e};let dj=1;class V0e{constructor(){this.subscribe=t=>(this.subscribers.push(t),()=>{const n=this.subscribers.indexOf(t);this.subscribers.splice(n,1)}),this.publish=t=>{this.subscribers.forEach(n=>n(t))},this.addToast=t=>{this.publish(t),this.toasts=[...this.toasts,t]},this.create=t=>{var n;const{message:r,...s}=t,i=typeof(t==null?void 0:t.id)=="number"||((n=t.id)==null?void 0:n.length)>0?t.id:dj++,a=this.toasts.find(l=>l.id===i),o=t.dismissible===void 0?!0:t.dismissible;return this.dismissedToasts.has(i)&&this.dismissedToasts.delete(i),a?this.toasts=this.toasts.map(l=>l.id===i?(this.publish({...l,...t,id:i,title:r}),{...l,...t,id:i,dismissible:o,title:r}):l):this.addToast({title:r,...s,dismissible:o,id:i}),i},this.dismiss=t=>(t?(this.dismissedToasts.add(t),requestAnimationFrame(()=>this.subscribers.forEach(n=>n({id:t,dismiss:!0})))):this.toasts.forEach(n=>{this.subscribers.forEach(r=>r({id:n.id,dismiss:!0}))}),t),this.message=(t,n)=>this.create({...n,message:t}),this.error=(t,n)=>this.create({...n,message:t,type:"error"}),this.success=(t,n)=>this.create({...n,type:"success",message:t}),this.info=(t,n)=>this.create({...n,type:"info",message:t}),this.warning=(t,n)=>this.create({...n,type:"warning",message:t}),this.loading=(t,n)=>this.create({...n,type:"loading",message:t}),this.promise=(t,n)=>{if(!n)return;let r;n.loading!==void 0&&(r=this.create({...n,promise:t,type:"loading",message:n.loading,description:typeof n.description!="function"?n.description:void 0}));const s=Promise.resolve(t instanceof Function?t():t);let i=r!==void 0,a;const o=s.then(async c=>{if(a=["resolve",c],Ve.isValidElement(c))i=!1,this.create({id:r,type:"default",message:c});else if(H0e(c)&&!c.ok){i=!1;const d=typeof n.error=="function"?await n.error(`HTTP error! status: ${c.status}`):n.error,h=typeof n.description=="function"?await n.description(`HTTP error! status: ${c.status}`):n.description,y=typeof d=="object"&&!Ve.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...y})}else if(c instanceof Error){i=!1;const d=typeof n.error=="function"?await n.error(c):n.error,h=typeof n.description=="function"?await n.description(c):n.description,y=typeof d=="object"&&!Ve.isValidElement(d)?d:{message:d};this.create({id:r,type:"error",description:h,...y})}else if(n.success!==void 0){i=!1;const d=typeof n.success=="function"?await n.success(c):n.success,h=typeof n.description=="function"?await n.description(c):n.description,y=typeof d=="object"&&!Ve.isValidElement(d)?d:{message:d};this.create({id:r,type:"success",description:h,...y})}}).catch(async c=>{if(a=["reject",c],n.error!==void 0){i=!1;const u=typeof n.error=="function"?await n.error(c):n.error,d=typeof n.description=="function"?await n.description(c):n.description,m=typeof u=="object"&&!Ve.isValidElement(u)?u:{message:u};this.create({id:r,type:"error",description:d,...m})}}).finally(()=>{i&&(this.dismiss(r),r=void 0),n.finally==null||n.finally.call(n)}),l=()=>new Promise((c,u)=>o.then(()=>a[0]==="reject"?u(a[1]):c(a[1])).catch(u));return typeof r!="string"&&typeof r!="number"?{unwrap:l}:Object.assign(r,{unwrap:l})},this.custom=(t,n)=>{const r=(n==null?void 0:n.id)||dj++;return this.create({jsx:t(r),id:r,...n}),r},this.getActiveToasts=()=>this.toasts.filter(t=>!this.dismissedToasts.has(t.id)),this.subscribers=[],this.toasts=[],this.dismissedToasts=new Set}}const Eo=new V0e,W0e=(e,t)=>{const n=(t==null?void 0:t.id)||dj++;return Eo.addToast({title:e,...t,id:n}),n},H0e=e=>e&&typeof e=="object"&&"ok"in e&&typeof e.ok=="boolean"&&"status"in e&&typeof e.status=="number",G0e=W0e,K0e=()=>Eo.toasts,Y0e=()=>Eo.getActiveToasts(),Te=Object.assign(G0e,{success:Eo.success,info:Eo.info,warning:Eo.warning,error:Eo.error,custom:Eo.custom,message:Eo.message,promise:Eo.promise,dismiss:Eo.dismiss,loading:Eo.loading},{getHistory:K0e,getToasts:Y0e});P0e("[data-sonner-toaster][dir=ltr],html[dir=ltr]{--toast-icon-margin-start:-3px;--toast-icon-margin-end:4px;--toast-svg-margin-start:-1px;--toast-svg-margin-end:0px;--toast-button-margin-start:auto;--toast-button-margin-end:0;--toast-close-button-start:0;--toast-close-button-end:unset;--toast-close-button-transform:translate(-35%, -35%)}[data-sonner-toaster][dir=rtl],html[dir=rtl]{--toast-icon-margin-start:4px;--toast-icon-margin-end:-3px;--toast-svg-margin-start:0px;--toast-svg-margin-end:-1px;--toast-button-margin-start:0;--toast-button-margin-end:auto;--toast-close-button-start:unset;--toast-close-button-end:0;--toast-close-button-transform:translate(35%, -35%)}[data-sonner-toaster]{position:fixed;width:var(--width);font-family:ui-sans-serif,system-ui,-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica Neue,Arial,Noto Sans,sans-serif,Apple Color Emoji,Segoe UI Emoji,Segoe UI Symbol,Noto Color Emoji;--gray1:hsl(0, 0%, 99%);--gray2:hsl(0, 0%, 97.3%);--gray3:hsl(0, 0%, 95.1%);--gray4:hsl(0, 0%, 93%);--gray5:hsl(0, 0%, 90.9%);--gray6:hsl(0, 0%, 88.7%);--gray7:hsl(0, 0%, 85.8%);--gray8:hsl(0, 0%, 78%);--gray9:hsl(0, 0%, 56.1%);--gray10:hsl(0, 0%, 52.3%);--gray11:hsl(0, 0%, 43.5%);--gray12:hsl(0, 0%, 9%);--border-radius:8px;box-sizing:border-box;padding:0;margin:0;list-style:none;outline:0;z-index:999999999;transition:transform .4s ease}[data-sonner-toaster][data-lifted=true]{transform:translateY(-8px)}@media (hover:none) and (pointer:coarse){[data-sonner-toaster][data-lifted=true]{transform:none}}[data-sonner-toaster][data-x-position=right]{right:var(--offset-right)}[data-sonner-toaster][data-x-position=left]{left:var(--offset-left)}[data-sonner-toaster][data-x-position=center]{left:50%;transform:translateX(-50%)}[data-sonner-toaster][data-y-position=top]{top:var(--offset-top)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--offset-bottom)}[data-sonner-toast]{--y:translateY(100%);--lift-amount:calc(var(--lift) * var(--gap));z-index:var(--z-index);position:absolute;opacity:0;transform:var(--y);touch-action:none;transition:transform .4s,opacity .4s,height .4s,box-shadow .2s;box-sizing:border-box;outline:0;overflow-wrap:anywhere}[data-sonner-toast][data-styled=true]{padding:16px;background:var(--normal-bg);border:1px solid var(--normal-border);color:var(--normal-text);border-radius:var(--border-radius);box-shadow:0 4px 12px rgba(0,0,0,.1);width:var(--width);font-size:13px;display:flex;align-items:center;gap:6px}[data-sonner-toast]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-y-position=top]{top:0;--y:translateY(-100%);--lift:1;--lift-amount:calc(1 * var(--gap))}[data-sonner-toast][data-y-position=bottom]{bottom:0;--y:translateY(100%);--lift:-1;--lift-amount:calc(var(--lift) * var(--gap))}[data-sonner-toast][data-styled=true] [data-description]{font-weight:400;line-height:1.4;color:#3f3f3f}[data-rich-colors=true][data-sonner-toast][data-styled=true] [data-description]{color:inherit}[data-sonner-toaster][data-sonner-theme=dark] [data-description]{color:#e8e8e8}[data-sonner-toast][data-styled=true] [data-title]{font-weight:500;line-height:1.5;color:inherit}[data-sonner-toast][data-styled=true] [data-icon]{display:flex;height:16px;width:16px;position:relative;justify-content:flex-start;align-items:center;flex-shrink:0;margin-left:var(--toast-icon-margin-start);margin-right:var(--toast-icon-margin-end)}[data-sonner-toast][data-promise=true] [data-icon]>svg{opacity:0;transform:scale(.8);transform-origin:center;animation:sonner-fade-in .3s ease forwards}[data-sonner-toast][data-styled=true] [data-icon]>*{flex-shrink:0}[data-sonner-toast][data-styled=true] [data-icon] svg{margin-left:var(--toast-svg-margin-start);margin-right:var(--toast-svg-margin-end)}[data-sonner-toast][data-styled=true] [data-content]{display:flex;flex-direction:column;gap:2px}[data-sonner-toast][data-styled=true] [data-button]{border-radius:4px;padding-left:8px;padding-right:8px;height:24px;font-size:12px;color:var(--normal-bg);background:var(--normal-text);margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end);border:none;font-weight:500;cursor:pointer;outline:0;display:flex;align-items:center;flex-shrink:0;transition:opacity .4s,box-shadow .2s}[data-sonner-toast][data-styled=true] [data-button]:focus-visible{box-shadow:0 0 0 2px rgba(0,0,0,.4)}[data-sonner-toast][data-styled=true] [data-button]:first-of-type{margin-left:var(--toast-button-margin-start);margin-right:var(--toast-button-margin-end)}[data-sonner-toast][data-styled=true] [data-cancel]{color:var(--normal-text);background:rgba(0,0,0,.08)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-styled=true] [data-cancel]{background:rgba(255,255,255,.3)}[data-sonner-toast][data-styled=true] [data-close-button]{position:absolute;left:var(--toast-close-button-start);right:var(--toast-close-button-end);top:0;height:20px;width:20px;display:flex;justify-content:center;align-items:center;padding:0;color:var(--gray12);background:var(--normal-bg);border:1px solid var(--gray4);transform:var(--toast-close-button-transform);border-radius:50%;cursor:pointer;z-index:1;transition:opacity .1s,background .2s,border-color .2s}[data-sonner-toast][data-styled=true] [data-close-button]:focus-visible{box-shadow:0 4px 12px rgba(0,0,0,.1),0 0 0 2px rgba(0,0,0,.2)}[data-sonner-toast][data-styled=true] [data-disabled=true]{cursor:not-allowed}[data-sonner-toast][data-styled=true]:hover [data-close-button]:hover{background:var(--gray2);border-color:var(--gray5)}[data-sonner-toast][data-swiping=true]::before{content:'';position:absolute;left:-100%;right:-100%;height:100%;z-index:-1}[data-sonner-toast][data-y-position=top][data-swiping=true]::before{bottom:50%;transform:scaleY(3) translateY(50%)}[data-sonner-toast][data-y-position=bottom][data-swiping=true]::before{top:50%;transform:scaleY(3) translateY(-50%)}[data-sonner-toast][data-swiping=false][data-removed=true]::before{content:'';position:absolute;inset:0;transform:scaleY(2)}[data-sonner-toast][data-expanded=true]::after{content:'';position:absolute;left:0;height:calc(var(--gap) + 1px);bottom:100%;width:100%}[data-sonner-toast][data-mounted=true]{--y:translateY(0);opacity:1}[data-sonner-toast][data-expanded=false][data-front=false]{--scale:var(--toasts-before) * 0.05 + 1;--y:translateY(calc(var(--lift-amount) * var(--toasts-before))) scale(calc(-1 * var(--scale)));height:var(--front-toast-height)}[data-sonner-toast]>*{transition:opacity .4s}[data-sonner-toast][data-x-position=right]{right:0}[data-sonner-toast][data-x-position=left]{left:0}[data-sonner-toast][data-expanded=false][data-front=false][data-styled=true]>*{opacity:0}[data-sonner-toast][data-visible=false]{opacity:0;pointer-events:none}[data-sonner-toast][data-mounted=true][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset)));height:var(--initial-height)}[data-sonner-toast][data-removed=true][data-front=true][data-swipe-out=false]{--y:translateY(calc(var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=true]{--y:translateY(calc(var(--lift) * var(--offset) + var(--lift) * -100%));opacity:0}[data-sonner-toast][data-removed=true][data-front=false][data-swipe-out=false][data-expanded=false]{--y:translateY(40%);opacity:0;transition:transform .5s,opacity .2s}[data-sonner-toast][data-removed=true][data-front=false]::before{height:calc(var(--initial-height) + 20%)}[data-sonner-toast][data-swiping=true]{transform:var(--y) translateY(var(--swipe-amount-y,0)) translateX(var(--swipe-amount-x,0));transition:none}[data-sonner-toast][data-swiped=true]{user-select:none}[data-sonner-toast][data-swipe-out=true][data-y-position=bottom],[data-sonner-toast][data-swipe-out=true][data-y-position=top]{animation-duration:.2s;animation-timing-function:ease-out;animation-fill-mode:forwards}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=left]{animation-name:swipe-out-left}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=right]{animation-name:swipe-out-right}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=up]{animation-name:swipe-out-up}[data-sonner-toast][data-swipe-out=true][data-swipe-direction=down]{animation-name:swipe-out-down}@keyframes swipe-out-left{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) - 100%));opacity:0}}@keyframes swipe-out-right{from{transform:var(--y) translateX(var(--swipe-amount-x));opacity:1}to{transform:var(--y) translateX(calc(var(--swipe-amount-x) + 100%));opacity:0}}@keyframes swipe-out-up{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) - 100%));opacity:0}}@keyframes swipe-out-down{from{transform:var(--y) translateY(var(--swipe-amount-y));opacity:1}to{transform:var(--y) translateY(calc(var(--swipe-amount-y) + 100%));opacity:0}}@media (max-width:600px){[data-sonner-toaster]{position:fixed;right:var(--mobile-offset-right);left:var(--mobile-offset-left);width:100%}[data-sonner-toaster][dir=rtl]{left:calc(var(--mobile-offset-left) * -1)}[data-sonner-toaster] [data-sonner-toast]{left:0;right:0;width:calc(100% - var(--mobile-offset-left) * 2)}[data-sonner-toaster][data-x-position=left]{left:var(--mobile-offset-left)}[data-sonner-toaster][data-y-position=bottom]{bottom:var(--mobile-offset-bottom)}[data-sonner-toaster][data-y-position=top]{top:var(--mobile-offset-top)}[data-sonner-toaster][data-x-position=center]{left:var(--mobile-offset-left);right:var(--mobile-offset-right);transform:none}}[data-sonner-toaster][data-sonner-theme=light]{--normal-bg:#fff;--normal-border:var(--gray4);--normal-text:var(--gray12);--success-bg:hsl(143, 85%, 96%);--success-border:hsl(145, 92%, 87%);--success-text:hsl(140, 100%, 27%);--info-bg:hsl(208, 100%, 97%);--info-border:hsl(221, 91%, 93%);--info-text:hsl(210, 92%, 45%);--warning-bg:hsl(49, 100%, 97%);--warning-border:hsl(49, 91%, 84%);--warning-text:hsl(31, 92%, 45%);--error-bg:hsl(359, 100%, 97%);--error-border:hsl(359, 100%, 94%);--error-text:hsl(360, 100%, 45%)}[data-sonner-toaster][data-sonner-theme=light] [data-sonner-toast][data-invert=true]{--normal-bg:#000;--normal-border:hsl(0, 0%, 20%);--normal-text:var(--gray1)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast][data-invert=true]{--normal-bg:#fff;--normal-border:var(--gray3);--normal-text:var(--gray12)}[data-sonner-toaster][data-sonner-theme=dark]{--normal-bg:#000;--normal-bg-hover:hsl(0, 0%, 12%);--normal-border:hsl(0, 0%, 20%);--normal-border-hover:hsl(0, 0%, 25%);--normal-text:var(--gray1);--success-bg:hsl(150, 100%, 6%);--success-border:hsl(147, 100%, 12%);--success-text:hsl(150, 86%, 65%);--info-bg:hsl(215, 100%, 6%);--info-border:hsl(223, 43%, 17%);--info-text:hsl(216, 87%, 65%);--warning-bg:hsl(64, 100%, 6%);--warning-border:hsl(60, 100%, 9%);--warning-text:hsl(46, 87%, 65%);--error-bg:hsl(358, 76%, 10%);--error-border:hsl(357, 89%, 16%);--error-text:hsl(358, 100%, 81%)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]{background:var(--normal-bg);border-color:var(--normal-border);color:var(--normal-text)}[data-sonner-toaster][data-sonner-theme=dark] [data-sonner-toast] [data-close-button]:hover{background:var(--normal-bg-hover);border-color:var(--normal-border-hover)}[data-rich-colors=true][data-sonner-toast][data-type=success]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=success] [data-close-button]{background:var(--success-bg);border-color:var(--success-border);color:var(--success-text)}[data-rich-colors=true][data-sonner-toast][data-type=info]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=info] [data-close-button]{background:var(--info-bg);border-color:var(--info-border);color:var(--info-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=warning] [data-close-button]{background:var(--warning-bg);border-color:var(--warning-border);color:var(--warning-text)}[data-rich-colors=true][data-sonner-toast][data-type=error]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}[data-rich-colors=true][data-sonner-toast][data-type=error] [data-close-button]{background:var(--error-bg);border-color:var(--error-border);color:var(--error-text)}.sonner-loading-wrapper{--size:16px;height:var(--size);width:var(--size);position:absolute;inset:0;z-index:10}.sonner-loading-wrapper[data-visible=false]{transform-origin:center;animation:sonner-fade-out .2s ease forwards}.sonner-spinner{position:relative;top:50%;left:50%;height:var(--size);width:var(--size)}.sonner-loading-bar{animation:sonner-spin 1.2s linear infinite;background:var(--gray11);border-radius:6px;height:8%;left:-10%;position:absolute;top:-3.9%;width:24%}.sonner-loading-bar:first-child{animation-delay:-1.2s;transform:rotate(.0001deg) translate(146%)}.sonner-loading-bar:nth-child(2){animation-delay:-1.1s;transform:rotate(30deg) translate(146%)}.sonner-loading-bar:nth-child(3){animation-delay:-1s;transform:rotate(60deg) translate(146%)}.sonner-loading-bar:nth-child(4){animation-delay:-.9s;transform:rotate(90deg) translate(146%)}.sonner-loading-bar:nth-child(5){animation-delay:-.8s;transform:rotate(120deg) translate(146%)}.sonner-loading-bar:nth-child(6){animation-delay:-.7s;transform:rotate(150deg) translate(146%)}.sonner-loading-bar:nth-child(7){animation-delay:-.6s;transform:rotate(180deg) translate(146%)}.sonner-loading-bar:nth-child(8){animation-delay:-.5s;transform:rotate(210deg) translate(146%)}.sonner-loading-bar:nth-child(9){animation-delay:-.4s;transform:rotate(240deg) translate(146%)}.sonner-loading-bar:nth-child(10){animation-delay:-.3s;transform:rotate(270deg) translate(146%)}.sonner-loading-bar:nth-child(11){animation-delay:-.2s;transform:rotate(300deg) translate(146%)}.sonner-loading-bar:nth-child(12){animation-delay:-.1s;transform:rotate(330deg) translate(146%)}@keyframes sonner-fade-in{0%{opacity:0;transform:scale(.8)}100%{opacity:1;transform:scale(1)}}@keyframes sonner-fade-out{0%{opacity:1;transform:scale(1)}100%{opacity:0;transform:scale(.8)}}@keyframes sonner-spin{0%{opacity:1}100%{opacity:.15}}@media (prefers-reduced-motion){.sonner-loading-bar,[data-sonner-toast],[data-sonner-toast]>*{transition:none!important;animation:none!important}}.sonner-loader{position:absolute;top:50%;left:50%;transform:translate(-50%,-50%);transform-origin:center;transition:opacity .2s,transform .2s}.sonner-loader[data-visible=false]{opacity:0;transform:scale(.8) translate(-50%,-50%)}");function OS(e){return e.label!==void 0}const Z0e=3,X0e="24px",J0e="16px",HB=4e3,Q0e=356,eye=14,tye=45,nye=200;function su(...e){return e.filter(Boolean).join(" ")}function rye(e){const[t,n]=e.split("-"),r=[];return t&&r.push(t),n&&r.push(n),r}const sye=e=>{var t,n,r,s,i,a,o,l,c;const{invert:u,toast:d,unstyled:h,interacting:m,setHeights:y,visibleToasts:b,heights:v,index:x,toasts:w,expanded:S,removeToast:k,defaultRichColors:C,closeButton:T,style:A,cancelButtonStyle:N,actionButtonStyle:I,className:O="",descriptionClassName:B="",duration:D,position:H,gap:P,expandByDefault:K,classNames:U,icons:V,closeButtonAriaLabel:L="Close toast"}=e,[te,W]=Ve.useState(null),[Q,ee]=Ve.useState(null),[re,pe]=Ve.useState(!1),[de,Oe]=Ve.useState(!1),[Fe,Se]=Ve.useState(!1),[Ce,qe]=Ve.useState(!1),[Qe,We]=Ve.useState(!1),[je,Y]=Ve.useState(0),[ye,Ie]=Ve.useState(0),ce=Ve.useRef(d.duration||D||HB),oe=Ve.useRef(null),se=Ve.useRef(null),Me=x===0,Be=x+1<=b,Ae=d.type,lt=d.dismissible!==!1,Tt=d.className||"",dt=d.descriptionClassName||"",Pt=Ve.useMemo(()=>v.findIndex(_e=>_e.toastId===d.id)||0,[v,d.id]),qt=Ve.useMemo(()=>{var _e;return(_e=d.closeButton)!=null?_e:T},[d.closeButton,T]),Ft=Ve.useMemo(()=>d.duration||D||HB,[d.duration,D]),Ht=Ve.useRef(0),we=Ve.useRef(0),F=Ve.useRef(0),X=Ve.useRef(null),[be,ke]=H.split("-"),ge=Ve.useMemo(()=>v.reduce((_e,ze,Ct)=>Ct>=Pt?_e:_e+ze.height,0),[v,Pt]),Ee=q0e(),le=d.invert||u,ft=Ae==="loading";we.current=Ve.useMemo(()=>Pt*P+ge,[Pt,ge]),Ve.useEffect(()=>{ce.current=Ft},[Ft]),Ve.useEffect(()=>{pe(!0)},[]),Ve.useEffect(()=>{const _e=se.current;if(_e){const ze=_e.getBoundingClientRect().height;return Ie(ze),y(Ct=>[{toastId:d.id,height:ze,position:d.position},...Ct]),()=>y(Ct=>Ct.filter(fe=>fe.toastId!==d.id))}},[y,d.id]),Ve.useLayoutEffect(()=>{if(!re)return;const _e=se.current,ze=_e.style.height;_e.style.height="auto";const Ct=_e.getBoundingClientRect().height;_e.style.height=ze,Ie(Ct),y(fe=>fe.find(G=>G.toastId===d.id)?fe.map(G=>G.toastId===d.id?{...G,height:Ct}:G):[{toastId:d.id,height:Ct,position:d.position},...fe])},[re,d.title,d.description,y,d.id]);const et=Ve.useCallback(()=>{Oe(!0),Y(we.current),y(_e=>_e.filter(ze=>ze.toastId!==d.id)),setTimeout(()=>{k(d)},nye)},[d,k,y,we]);Ve.useEffect(()=>{if(d.promise&&Ae==="loading"||d.duration===1/0||d.type==="loading")return;let _e;return S||m||Ee?(()=>{if(F.current<Ht.current){const fe=new Date().getTime()-Ht.current;ce.current=ce.current-fe}F.current=new Date().getTime()})():(()=>{ce.current!==1/0&&(Ht.current=new Date().getTime(),_e=setTimeout(()=>{d.onAutoClose==null||d.onAutoClose.call(d,d),et()},ce.current))})(),()=>clearTimeout(_e)},[S,m,d,Ae,Ee,et]),Ve.useEffect(()=>{d.delete&&et()},[et,d.delete]);function $(){var _e;if(V!=null&&V.loading){var ze;return Ve.createElement("div",{className:su(U==null?void 0:U.loader,d==null||(ze=d.classNames)==null?void 0:ze.loader,"sonner-loader"),"data-visible":Ae==="loading"},V.loading)}return Ve.createElement(F0e,{className:su(U==null?void 0:U.loader,d==null||(_e=d.classNames)==null?void 0:_e.loader),visible:Ae==="loading"})}const Ue=d.icon||(V==null?void 0:V[Ae])||O0e(Ae);var tt,ve;return Ve.createElement("li",{tabIndex:0,ref:se,className:su(O,Tt,U==null?void 0:U.toast,d==null||(t=d.classNames)==null?void 0:t.toast,U==null?void 0:U.default,U==null?void 0:U[Ae],d==null||(n=d.classNames)==null?void 0:n[Ae]),"data-sonner-toast":"","data-rich-colors":(tt=d.richColors)!=null?tt:C,"data-styled":!(d.jsx||d.unstyled||h),"data-mounted":re,"data-promise":!!d.promise,"data-swiped":Qe,"data-removed":de,"data-visible":Be,"data-y-position":be,"data-x-position":ke,"data-index":x,"data-front":Me,"data-swiping":Fe,"data-dismissible":lt,"data-type":Ae,"data-invert":le,"data-swipe-out":Ce,"data-swipe-direction":Q,"data-expanded":!!(S||K&&re),style:{"--index":x,"--toasts-before":x,"--z-index":w.length-x,"--offset":`${de?je:we.current}px`,"--initial-height":K?"auto":`${ye}px`,...A,...d.style},onDragEnd:()=>{Se(!1),W(null),X.current=null},onPointerDown:_e=>{ft||!lt||(oe.current=new Date,Y(we.current),_e.target.setPointerCapture(_e.pointerId),_e.target.tagName!=="BUTTON"&&(Se(!0),X.current={x:_e.clientX,y:_e.clientY}))},onPointerUp:()=>{var _e,ze,Ct;if(Ce||!lt)return;X.current=null;const fe=Number(((_e=se.current)==null?void 0:_e.style.getPropertyValue("--swipe-amount-x").replace("px",""))||0),Z=Number(((ze=se.current)==null?void 0:ze.style.getPropertyValue("--swipe-amount-y").replace("px",""))||0),G=new Date().getTime()-((Ct=oe.current)==null?void 0:Ct.getTime()),J=te==="x"?fe:Z,xe=Math.abs(J)/G;if(Math.abs(J)>=tye||xe>.11){Y(we.current),d.onDismiss==null||d.onDismiss.call(d,d),ee(te==="x"?fe>0?"right":"left":Z>0?"down":"up"),et(),qe(!0);return}else{var De,He;(De=se.current)==null||De.style.setProperty("--swipe-amount-x","0px"),(He=se.current)==null||He.style.setProperty("--swipe-amount-y","0px")}We(!1),Se(!1),W(null)},onPointerMove:_e=>{var ze,Ct,fe;if(!X.current||!lt||((ze=window.getSelection())==null?void 0:ze.toString().length)>0)return;const G=_e.clientY-X.current.y,J=_e.clientX-X.current.x;var xe;const De=(xe=e.swipeDirections)!=null?xe:rye(H);!te&&(Math.abs(J)>1||Math.abs(G)>1)&&W(Math.abs(J)>Math.abs(G)?"x":"y");let He={x:0,y:0};const wt=Qt=>1/(1.5+Math.abs(Qt)/20);if(te==="y"){if(De.includes("top")||De.includes("bottom"))if(De.includes("top")&&G<0||De.includes("bottom")&&G>0)He.y=G;else{const Qt=G*wt(G);He.y=Math.abs(Qt)<Math.abs(G)?Qt:G}}else if(te==="x"&&(De.includes("left")||De.includes("right")))if(De.includes("left")&&J<0||De.includes("right")&&J>0)He.x=J;else{const Qt=J*wt(J);He.x=Math.abs(Qt)<Math.abs(J)?Qt:J}(Math.abs(He.x)>0||Math.abs(He.y)>0)&&We(!0),(Ct=se.current)==null||Ct.style.setProperty("--swipe-amount-x",`${He.x}px`),(fe=se.current)==null||fe.style.setProperty("--swipe-amount-y",`${He.y}px`)}},qt&&!d.jsx&&Ae!=="loading"?Ve.createElement("button",{"aria-label":L,"data-disabled":ft,"data-close-button":!0,onClick:ft||!lt?()=>{}:()=>{et(),d.onDismiss==null||d.onDismiss.call(d,d)},className:su(U==null?void 0:U.closeButton,d==null||(r=d.classNames)==null?void 0:r.closeButton)},(ve=V==null?void 0:V.close)!=null?ve:U0e):null,(Ae||d.icon||d.promise)&&d.icon!==null&&((V==null?void 0:V[Ae])!==null||d.icon)?Ve.createElement("div",{"data-icon":"",className:su(U==null?void 0:U.icon,d==null||(s=d.classNames)==null?void 0:s.icon)},d.promise||d.type==="loading"&&!d.icon?d.icon||$():null,d.type!=="loading"?Ue:null):null,Ve.createElement("div",{"data-content":"",className:su(U==null?void 0:U.content,d==null||(i=d.classNames)==null?void 0:i.content)},Ve.createElement("div",{"data-title":"",className:su(U==null?void 0:U.title,d==null||(a=d.classNames)==null?void 0:a.title)},d.jsx?d.jsx:typeof d.title=="function"?d.title():d.title),d.description?Ve.createElement("div",{"data-description":"",className:su(B,dt,U==null?void 0:U.description,d==null||(o=d.classNames)==null?void 0:o.description)},typeof d.description=="function"?d.description():d.description):null),Ve.isValidElement(d.cancel)?d.cancel:d.cancel&&OS(d.cancel)?Ve.createElement("button",{"data-button":!0,"data-cancel":!0,style:d.cancelButtonStyle||N,onClick:_e=>{OS(d.cancel)&&lt&&(d.cancel.onClick==null||d.cancel.onClick.call(d.cancel,_e),et())},className:su(U==null?void 0:U.cancelButton,d==null||(l=d.classNames)==null?void 0:l.cancelButton)},d.cancel.label):null,Ve.isValidElement(d.action)?d.action:d.action&&OS(d.action)?Ve.createElement("button",{"data-button":!0,"data-action":!0,style:d.actionButtonStyle||I,onClick:_e=>{OS(d.action)&&(d.action.onClick==null||d.action.onClick.call(d.action,_e),!_e.defaultPrevented&&et())},className:su(U==null?void 0:U.actionButton,d==null||(c=d.classNames)==null?void 0:c.actionButton)},d.action.label):null)};function GB(){if(typeof window>"u"||typeof document>"u")return"ltr";const e=document.documentElement.getAttribute("dir");return e==="auto"||!e?window.getComputedStyle(document.documentElement).direction:e}function iye(e,t){const n={};return[e,t].forEach((r,s)=>{const i=s===1,a=i?"--mobile-offset":"--offset",o=i?J0e:X0e;function l(c){["top","right","bottom","left"].forEach(u=>{n[`${a}-${u}`]=typeof c=="number"?`${c}px`:c})}typeof r=="number"||typeof r=="string"?l(r):typeof r=="object"?["top","right","bottom","left"].forEach(c=>{r[c]===void 0?n[`${a}-${c}`]=o:n[`${a}-${c}`]=typeof r[c]=="number"?`${r[c]}px`:r[c]}):l(o)}),n}const aye=Ve.forwardRef(function(t,n){const{invert:r,position:s="bottom-right",hotkey:i=["altKey","KeyT"],expand:a,closeButton:o,className:l,offset:c,mobileOffset:u,theme:d="light",richColors:h,duration:m,style:y,visibleToasts:b=Z0e,toastOptions:v,dir:x=GB(),gap:w=eye,icons:S,containerAriaLabel:k="Notifications"}=t,[C,T]=Ve.useState([]),A=Ve.useMemo(()=>Array.from(new Set([s].concat(C.filter(Q=>Q.position).map(Q=>Q.position)))),[C,s]),[N,I]=Ve.useState([]),[O,B]=Ve.useState(!1),[D,H]=Ve.useState(!1),[P,K]=Ve.useState(d!=="system"?d:typeof window<"u"&&window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"),U=Ve.useRef(null),V=i.join("+").replace(/Key/g,"").replace(/Digit/g,""),L=Ve.useRef(null),te=Ve.useRef(!1),W=Ve.useCallback(Q=>{T(ee=>{var re;return(re=ee.find(pe=>pe.id===Q.id))!=null&&re.delete||Eo.dismiss(Q.id),ee.filter(({id:pe})=>pe!==Q.id)})},[]);return Ve.useEffect(()=>Eo.subscribe(Q=>{if(Q.dismiss){requestAnimationFrame(()=>{T(ee=>ee.map(re=>re.id===Q.id?{...re,delete:!0}:re))});return}setTimeout(()=>{AE.flushSync(()=>{T(ee=>{const re=ee.findIndex(pe=>pe.id===Q.id);return re!==-1?[...ee.slice(0,re),{...ee[re],...Q},...ee.slice(re+1)]:[Q,...ee]})})})}),[C]),Ve.useEffect(()=>{if(d!=="system"){K(d);return}if(d==="system"&&(window.matchMedia&&window.matchMedia("(prefers-color-scheme: dark)").matches?K("dark"):K("light")),typeof window>"u")return;const Q=window.matchMedia("(prefers-color-scheme: dark)");try{Q.addEventListener("change",({matches:ee})=>{K(ee?"dark":"light")})}catch{Q.addListener(({matches:re})=>{try{K(re?"dark":"light")}catch(pe){console.error(pe)}})}},[d]),Ve.useEffect(()=>{C.length<=1&&B(!1)},[C]),Ve.useEffect(()=>{const Q=ee=>{var re;if(i.every(Oe=>ee[Oe]||ee.code===Oe)){var de;B(!0),(de=U.current)==null||de.focus()}ee.code==="Escape"&&(document.activeElement===U.current||(re=U.current)!=null&&re.contains(document.activeElement))&&B(!1)};return document.addEventListener("keydown",Q),()=>document.removeEventListener("keydown",Q)},[i]),Ve.useEffect(()=>{if(U.current)return()=>{L.current&&(L.current.focus({preventScroll:!0}),L.current=null,te.current=!1)}},[U.current]),Ve.createElement("section",{ref:n,"aria-label":`${k} ${V}`,tabIndex:-1,"aria-live":"polite","aria-relevant":"additions text","aria-atomic":"false",suppressHydrationWarning:!0},A.map((Q,ee)=>{var re;const[pe,de]=Q.split("-");return C.length?Ve.createElement("ol",{key:Q,dir:x==="auto"?GB():x,tabIndex:-1,ref:U,className:l,"data-sonner-toaster":!0,"data-sonner-theme":P,"data-y-position":pe,"data-lifted":O&&C.length>1&&!a,"data-x-position":de,style:{"--front-toast-height":`${((re=N[0])==null?void 0:re.height)||0}px`,"--width":`${Q0e}px`,"--gap":`${w}px`,...y,...iye(c,u)},onBlur:Oe=>{te.current&&!Oe.currentTarget.contains(Oe.relatedTarget)&&(te.current=!1,L.current&&(L.current.focus({preventScroll:!0}),L.current=null))},onFocus:Oe=>{Oe.target instanceof HTMLElement&&Oe.target.dataset.dismissible==="false"||te.current||(te.current=!0,L.current=Oe.relatedTarget)},onMouseEnter:()=>B(!0),onMouseMove:()=>B(!0),onMouseLeave:()=>{D||B(!1)},onDragEnd:()=>B(!1),onPointerDown:Oe=>{Oe.target instanceof HTMLElement&&Oe.target.dataset.dismissible==="false"||H(!0)},onPointerUp:()=>H(!1)},C.filter(Oe=>!Oe.position&&ee===0||Oe.position===Q).map((Oe,Fe)=>{var Se,Ce;return Ve.createElement(sye,{key:Oe.id,icons:S,index:Fe,toast:Oe,defaultRichColors:h,duration:(Se=v==null?void 0:v.duration)!=null?Se:m,className:v==null?void 0:v.className,descriptionClassName:v==null?void 0:v.descriptionClassName,invert:r,visibleToasts:b,closeButton:(Ce=v==null?void 0:v.closeButton)!=null?Ce:o,interacting:D,position:Q,style:v==null?void 0:v.style,unstyled:v==null?void 0:v.unstyled,classNames:v==null?void 0:v.classNames,cancelButtonStyle:v==null?void 0:v.cancelButtonStyle,actionButtonStyle:v==null?void 0:v.actionButtonStyle,closeButtonAriaLabel:v==null?void 0:v.closeButtonAriaLabel,removeToast:W,toasts:C.filter(qe=>qe.position==Oe.position),heights:N.filter(qe=>qe.position==Oe.position),setHeights:I,expandByDefault:a,gap:w,expanded:O,swipeDirections:t.swipeDirections})})):null}))}),un=Wo(Ho((e,t)=>({interactions:[],currentConversationId:null,streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},error:null,status:"idle",loadInteractions:async n=>{if(t().currentConversationId!==n){console.warn(`InteractionStore: loadInteractions called for ${n}, but current is ${t().currentConversationId}. Aborting load.`);return}const r=t().status;e({status:"loading",error:null,interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{}}),r!=="loading"&&Re.emit(En.statusChanged,{status:"loading"});try{const s=await bt.loadInteractionsForConversation(n);s.sort((l,c)=>l.index-c.index);const i=t().interactions.filter(l=>l.conversationId===n),a=new Set(s.map(l=>l.id)),o=[...s,...i.filter(l=>!a.has(l.id))];o.sort((l,c)=>l.index-c.index),t().currentConversationId===n?(e({interactions:o,status:"idle"}),Re.emit(En.loaded,{conversationId:n,interactions:o}),Re.emit(En.statusChanged,{status:"idle"})):console.warn(`InteractionStore: loadInteractions for ${n} completed, but currentConversationId changed during fetch to ${t().currentConversationId}. Discarding.`)}catch(s){console.error(`InteractionStore: Error loading interactions for ${n}`,s),t().currentConversationId===n&&(e({error:"Failed load interactions",status:"error"}),Re.emit(En.statusChanged,{status:"error"}),Re.emit(En.errorChanged,{error:"Failed load interactions"}))}},_addInteractionToState:n=>{e(r=>{if(r.currentConversationId!==n.conversationId){console.warn(`InteractionStore: Attempted to add interaction for ${n.conversationId} but current is ${r.currentConversationId}. Skipping.`);return}if(!r.interactions.some(s=>s.id===n.id))r.interactions.push(n),r.interactions.sort((s,i)=>s.index-i.index);else{const s=r.interactions.findIndex(i=>i.id===n.id);s!==-1&&(r.interactions[s]={...r.interactions[s],...n})}}),Re.emit(En.added,{interaction:n})},_updateInteractionInState:(n,r)=>{e(s=>{const i=s.interactions.findIndex(a=>a.id===n);if(i!==-1){if(s.currentConversationId!==s.interactions[i].conversationId){console.warn(`InteractionStore: Attempted to update interaction ${n} which is not in the current conversation ${s.currentConversationId}. Skipping.`);return}const a=s.interactions[i];let o={...a.metadata||{}};r.metadata&&(o={...o,...r.metadata},r.metadata.toolCalls!==void 0&&Array.isArray(r.metadata.toolCalls)&&(o.toolCalls=[...r.metadata.toolCalls]),r.metadata.toolResults!==void 0&&Array.isArray(r.metadata.toolResults)&&(o.toolResults=[...r.metadata.toolResults]),r.metadata.reasoning!==void 0&&(o.reasoning=r.metadata.reasoning));const l={...a,...r,metadata:o};"response"in r&&(l.response=r.response),"rating"in r&&(l.rating=r.rating),s.interactions[i]=l}}),Re.emit(En.updated,{interactionId:n,updates:r})},appendInteractionResponseChunk:(n,r)=>{e(s=>{var i;s.streamingInteractionIds.includes(n)&&s.currentConversationId===((i=s.interactions.find(a=>a.id===n))==null?void 0:i.conversationId)&&(s.activeStreamBuffers[n]=(s.activeStreamBuffers[n]||"")+r)}),Re.emit(En.activeStreamBuffersChanged,{buffers:t().activeStreamBuffers})},appendReasoningChunk:(n,r)=>{e(s=>{var i;s.streamingInteractionIds.includes(n)&&s.currentConversationId===((i=s.interactions.find(a=>a.id===n))==null?void 0:i.conversationId)&&(s.activeReasoningBuffers[n]=(s.activeReasoningBuffers[n]||"")+r)}),Re.emit(En.activeReasoningBuffersChanged,{buffers:t().activeReasoningBuffers})},setActiveStreamBuffer:(n,r)=>{e(s=>{s.streamingInteractionIds.includes(n)&&(s.activeStreamBuffers[n]=r)}),Re.emit(En.activeStreamBuffersChanged,{buffers:t().activeStreamBuffers})},_removeInteractionFromState:n=>{e(r=>{r.interactions=r.interactions.filter(s=>s.id!==n)})},rateInteraction:async(n,r)=>{const s=t().interactions.find(i=>i.id===n);if(s&&t().currentConversationId===s.conversationId){t()._updateInteractionInState(n,{rating:r});try{await bt.saveInteraction({...s,rating:r}),Re.emit(En.interactionRated,{interactionId:n,rating:r})}catch{t()._updateInteractionInState(n,{rating:s.rating}),Te.error("Failed to save rating.")}}},setCurrentConversationId:async n=>{const r=t().currentConversationId;if(r===n){n&&t().interactions.length===0&&t().status!=="loading"?(console.warn(`InteractionStore: Current ID ${n} matches, but no interactions. Forcing reload.`),await t().loadInteractions(n)):console.log(`InteractionStore: setCurrentConversationId called with the same ID (${n}). No change needed or already handled.`);return}console.log(`InteractionStore: Setting current conversation ID from ${r} to ${n}`),e({currentConversationId:n}),Re.emit(En.currentConversationIdChanged,{conversationId:n}),n?await t().loadInteractions(n):t().clearInteractions()},clearInteractions:()=>{const n=t().status;e({interactions:[],streamingInteractionIds:[],activeStreamBuffers:{},activeReasoningBuffers:{},status:"idle",error:null,currentConversationId:null}),n!=="idle"&&Re.emit(En.statusChanged,{status:"idle"}),Re.emit(En.currentConversationIdChanged,{conversationId:null})},setError:n=>{const r=t().status;let s="idle";e(i=>{i.error=n,n?(s="error",i.status="error"):i.status==="error"?(s=i.streamingInteractionIds.length>0?"streaming":"idle",i.status=s):s=i.status}),r!==s&&Re.emit(En.statusChanged,{status:s}),Re.emit(En.errorChanged,{error:n})},setStatus:n=>{t().status!==n&&(e({status:n}),Re.emit(En.statusChanged,{status:n}))},_addStreamingId:n=>{let r=!1;e(s=>{s.streamingInteractionIds.includes(n)||(s.streamingInteractionIds.push(n),s.activeStreamBuffers[n]="",s.activeReasoningBuffers[n]="",s.streamingInteractionIds.length===1&&(s.status="streaming",r=!0),s.error=null)}),r&&Re.emit(En.statusChanged,{status:"streaming"}),Re.emit(En.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},_removeStreamingId:n=>{let r=!1;e(s=>{const i=s.streamingInteractionIds.indexOf(n);i!==-1&&(s.streamingInteractionIds.splice(i,1),delete s.activeStreamBuffers[n],delete s.activeReasoningBuffers[n],s.streamingInteractionIds.length===0&&s.status==="streaming"&&(s.status=s.error?"error":"idle",r=!0))}),r&&Re.emit(En.statusChanged,{status:t().status}),Re.emit(En.streamingIdsChanged,{streamingIds:t().streamingInteractionIds})},getRegisteredActionHandlers:()=>{const n="interactionStore",r=t();return[{eventName:En.loadInteractionsRequest,handler:s=>r.loadInteractions(s.conversationId),storeId:n},{eventName:En.rateInteractionRequest,handler:s=>r.rateInteraction(s.interactionId,s.rating),storeId:n},{eventName:En.setCurrentConversationIdRequest,handler:s=>r.setCurrentConversationId(s.id),storeId:n},{eventName:En.clearInteractionsRequest,handler:()=>r.clearInteractions(),storeId:n},{eventName:En.setErrorRequest,handler:s=>r.setError(s.error),storeId:n},{eventName:En.setStatusRequest,handler:s=>r.setStatus(s.status),storeId:n}]}}))),Ul={attachedFilesChanged:"input.attached.files.changed",addAttachedFileRequest:"input.add.attached.file.request",removeAttachedFileRequest:"input.remove.attached.file.request",clearAttachedFilesRequest:"input.clear.attached.files.request"},Nh=Wo(Ho((e,t)=>({attachedFilesMetadata:[],addAttachedFile:n=>{let r=!1;e(s=>{if(s.attachedFilesMetadata.some(a=>a.source==="direct"&&n.source==="direct"?a.name===n.name&&a.size===n.size:a.source==="vfs"&&n.source==="vfs"?a.path===n.path:!1))console.warn(`InputStore: File "${n.name}" (source: ${n.source}) already attached. Skipping.`);else{const a={id:qr(),...n};s.attachedFilesMetadata.push(a),r=!0}}),r&&Re.emit(Ul.attachedFilesChanged,{files:t().attachedFilesMetadata})},removeAttachedFile:n=>{let r=!1;e(s=>{const i=s.attachedFilesMetadata.length;s.attachedFilesMetadata=s.attachedFilesMetadata.filter(a=>a.id!==n),r=s.attachedFilesMetadata.length<i}),r&&Re.emit(Ul.attachedFilesChanged,{files:t().attachedFilesMetadata})},clearAttachedFiles:()=>{const n=t().attachedFilesMetadata.length>0;e({attachedFilesMetadata:[]}),n&&Re.emit(Ul.attachedFilesChanged,{files:[]})},getRegisteredActionHandlers:()=>{const n="inputStore",r=t();return[{eventName:Ul.addAttachedFileRequest,handler:s=>r.addAttachedFile(s),storeId:n},{eventName:Ul.removeAttachedFileRequest,handler:s=>r.removeAttachedFile(s.attachmentId),storeId:n},{eventName:Ul.clearAttachedFilesRequest,handler:()=>r.clearAttachedFiles(),storeId:n}]}}))),FH=new Set([".txt",".md",".markdown",".json",".js",".ts",".jsx",".tsx",".html",".htm",".css",".scss",".less",".py",".pyw",".java",".c",".cpp",".h",".hpp",".cs",".go",".php",".rb",".swift",".kt",".kts",".rs",".toml",".yaml",".yml",".xml",".sh",".bash",".zsh",".bat",".cmd",".ps1",".gitignore",".gitattributes",".env",".log",".csv",".tsv",".ini",".cfg",".conf",".sql",".dockerfile","dockerfile",".mod",".sum",".csproj",".vbproj",".fsproj",".sln",".props",".targets",".gradle",".kts",".pom",".rst",".tex",".bib",".r",".rmd",".pl",".pm",".lua",".dart",".diff",".patch",".applescript",".properties",".http",".rest",".tf",".tfvars",".hcl",".rego",".liquid",".erb",".jinja",".j2",".mustache",".hbs",".pug",".haml",".slim",".svelte",".vue",".astro",".svg",".webmanifest",".vtt",".srt",".sbv",".ass",".ssa",".config",".mdx",".nfo",".diz"]);Object.freeze(FH);const tw=(e,t)=>{if(!e)return!1;const n=e.toLowerCase();if(t!=null&&t.startsWith("text/")||t==="application/json"||t==="application/xml"||t==="application/javascript"||t==="application/typescript"||t==="application/yaml"||t==="application/toml"||t==="application/sql"||t==="application/x-sh"||t==="application/x-httpd-php"||t==="application/x-python"||t==="application/x-ruby"||t==="image/svg+xml"||n.split(".").length<2)return!0;const s="."+n.split(".").pop();return FH.has(s)};var LH="vercel.ai.error",oye=Symbol.for(LH),BH,lye=class $H extends Error{constructor({name:t,message:n,cause:r}){super(n),this[BH]=!0,this.name=t,this.cause=r}static isInstance(t){return $H.hasMarker(t,LH)}static hasMarker(t,n){const r=Symbol.for(n);return t!=null&&typeof t=="object"&&r in t&&typeof t[r]=="boolean"&&t[r]===!0}};BH=oye;var rr=lye,zH="AI_APICallError",UH=`vercel.ai.error.${zH}`,cye=Symbol.for(UH),qH,Vl=class extends rr{constructor({message:e,url:t,requestBodyValues:n,statusCode:r,responseHeaders:s,responseBody:i,cause:a,isRetryable:o=r!=null&&(r===408||r===409||r===429||r>=500),data:l}){super({name:zH,message:e,cause:a}),this[qH]=!0,this.url=t,this.requestBodyValues=n,this.statusCode=r,this.responseHeaders=s,this.responseBody=i,this.isRetryable=o,this.data=l}static isInstance(e){return rr.hasMarker(e,UH)}};qH=cye;var VH="AI_EmptyResponseBodyError",WH=`vercel.ai.error.${VH}`,uye=Symbol.for(WH),HH,GH=class extends rr{constructor({message:e="Empty response body"}={}){super({name:VH,message:e}),this[HH]=!0}static isInstance(e){return rr.hasMarker(e,WH)}};HH=uye;function v1(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}var KH="AI_InvalidArgumentError",YH=`vercel.ai.error.${KH}`,dye=Symbol.for(YH),ZH,XH=class extends rr{constructor({message:t,cause:n,argument:r}){super({name:KH,message:t,cause:n}),this[ZH]=!0,this.argument=r}static isInstance(t){return rr.hasMarker(t,YH)}};ZH=dye;var JH="AI_InvalidPromptError",QH=`vercel.ai.error.${JH}`,fye=Symbol.for(QH),eG,xc=class extends rr{constructor({prompt:e,message:t,cause:n}){super({name:JH,message:`Invalid prompt: ${t}`,cause:n}),this[eG]=!0,this.prompt=e}static isInstance(e){return rr.hasMarker(e,QH)}};eG=fye;var tG="AI_InvalidResponseDataError",nG=`vercel.ai.error.${tG}`,hye=Symbol.for(nG),rG,Ld=class extends rr{constructor({data:e,message:t=`Invalid response data: ${JSON.stringify(e)}.`}){super({name:tG,message:t}),this[rG]=!0,this.data=e}static isInstance(e){return rr.hasMarker(e,nG)}};rG=hye;var sG="AI_JSONParseError",iG=`vercel.ai.error.${sG}`,pye=Symbol.for(iG),aG,b2=class extends rr{constructor({text:e,cause:t}){super({name:sG,message:`JSON parsing failed: Text: ${e}.
Error message: ${v1(t)}`,cause:t}),this[aG]=!0,this.text=e}static isInstance(e){return rr.hasMarker(e,iG)}};aG=pye;var oG="AI_LoadAPIKeyError",lG=`vercel.ai.error.${oG}`,mye=Symbol.for(lG),cG,DS=class extends rr{constructor({message:e}){super({name:oG,message:e}),this[cG]=!0}static isInstance(e){return rr.hasMarker(e,lG)}};cG=mye;var uG="AI_TooManyEmbeddingValuesForCallError",dG=`vercel.ai.error.${uG}`,gye=Symbol.for(dG),fG,RE=class extends rr{constructor(e){super({name:uG,message:`Too many values for a single embedding call. The ${e.provider} model "${e.modelId}" can only embed up to ${e.maxEmbeddingsPerCall} values per call, but ${e.values.length} values were provided.`}),this[fG]=!0,this.provider=e.provider,this.modelId=e.modelId,this.maxEmbeddingsPerCall=e.maxEmbeddingsPerCall,this.values=e.values}static isInstance(e){return rr.hasMarker(e,dG)}};fG=gye;var hG="AI_TypeValidationError",pG=`vercel.ai.error.${hG}`,yye=Symbol.for(pG),mG,bye=class fj extends rr{constructor({value:t,cause:n}){super({name:hG,message:`Type validation failed: Value: ${JSON.stringify(t)}.
Error message: ${v1(n)}`,cause:n}),this[mG]=!0,this.value=t}static isInstance(t){return rr.hasMarker(t,pG)}static wrap({value:t,cause:n}){return fj.isInstance(n)&&n.value===t?n:new fj({value:t,cause:n})}};mG=yye;var v2=bye,gG="AI_UnsupportedFunctionalityError",yG=`vercel.ai.error.${gG}`,vye=Symbol.for(yG),bG,gr=class extends rr{constructor({functionality:e,message:t=`'${e}' functionality not supported.`}){super({name:gG,message:t}),this[bG]=!0,this.functionality=e}static isInstance(e){return rr.hasMarker(e,yG)}};bG=vye;let xye=(e,t=21)=>(n=t)=>{let r="",s=n|0;for(;s--;)r+=e[Math.random()*e.length|0];return r};var QP={},NE={};NE.byteLength=Sye;NE.toByteArray=kye;NE.fromByteArray=Aye;var yu=[],Bl=[],wye=typeof Uint8Array<"u"?Uint8Array:Array,EN="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var n0=0,_ye=EN.length;n0<_ye;++n0)yu[n0]=EN[n0],Bl[EN.charCodeAt(n0)]=n0;Bl[45]=62;Bl[95]=63;function vG(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");n===-1&&(n=t);var r=n===t?0:4-n%4;return[n,r]}function Sye(e){var t=vG(e),n=t[0],r=t[1];return(n+r)*3/4-r}function Cye(e,t,n){return(t+n)*3/4-n}function kye(e){var t,n=vG(e),r=n[0],s=n[1],i=new wye(Cye(e,r,s)),a=0,o=s>0?r-4:r,l;for(l=0;l<o;l+=4)t=Bl[e.charCodeAt(l)]<<18|Bl[e.charCodeAt(l+1)]<<12|Bl[e.charCodeAt(l+2)]<<6|Bl[e.charCodeAt(l+3)],i[a++]=t>>16&255,i[a++]=t>>8&255,i[a++]=t&255;return s===2&&(t=Bl[e.charCodeAt(l)]<<2|Bl[e.charCodeAt(l+1)]>>4,i[a++]=t&255),s===1&&(t=Bl[e.charCodeAt(l)]<<10|Bl[e.charCodeAt(l+1)]<<4|Bl[e.charCodeAt(l+2)]>>2,i[a++]=t>>8&255,i[a++]=t&255),i}function Eye(e){return yu[e>>18&63]+yu[e>>12&63]+yu[e>>6&63]+yu[e&63]}function Tye(e,t,n){for(var r,s=[],i=t;i<n;i+=3)r=(e[i]<<16&16711680)+(e[i+1]<<8&65280)+(e[i+2]&255),s.push(Eye(r));return s.join("")}function Aye(e){for(var t,n=e.length,r=n%3,s=[],i=16383,a=0,o=n-r;a<o;a+=i)s.push(Tye(e,a,a+i>o?o:a+i));return r===1?(t=e[n-1],s.push(yu[t>>2]+yu[t<<4&63]+"==")):r===2&&(t=(e[n-2]<<8)+e[n-1],s.push(yu[t>>10]+yu[t>>4&63]+yu[t<<2&63]+"=")),s.join("")}var eO={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */eO.read=function(e,t,n,r,s){var i,a,o=s*8-r-1,l=(1<<o)-1,c=l>>1,u=-7,d=n?s-1:0,h=n?-1:1,m=e[t+d];for(d+=h,i=m&(1<<-u)-1,m>>=-u,u+=o;u>0;i=i*256+e[t+d],d+=h,u-=8);for(a=i&(1<<-u)-1,i>>=-u,u+=r;u>0;a=a*256+e[t+d],d+=h,u-=8);if(i===0)i=1-c;else{if(i===l)return a?NaN:(m?-1:1)*(1/0);a=a+Math.pow(2,r),i=i-c}return(m?-1:1)*a*Math.pow(2,i-r)};eO.write=function(e,t,n,r,s,i){var a,o,l,c=i*8-s-1,u=(1<<c)-1,d=u>>1,h=s===23?Math.pow(2,-24)-Math.pow(2,-77):0,m=r?0:i-1,y=r?1:-1,b=t<0||t===0&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(o=isNaN(t)?1:0,a=u):(a=Math.floor(Math.log(t)/Math.LN2),t*(l=Math.pow(2,-a))<1&&(a--,l*=2),a+d>=1?t+=h/l:t+=h*Math.pow(2,1-d),t*l>=2&&(a++,l/=2),a+d>=u?(o=0,a=u):a+d>=1?(o=(t*l-1)*Math.pow(2,s),a=a+d):(o=t*Math.pow(2,d-1)*Math.pow(2,s),a=0));s>=8;e[n+m]=o&255,m+=y,o/=256,s-=8);for(a=a<<s|o,c+=s;c>0;e[n+m]=a&255,m+=y,a/=256,c-=8);e[n+m-y]|=b*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(e){const t=NE,n=eO,r=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;e.Buffer=u,e.SlowBuffer=C,e.INSPECT_MAX_BYTES=50;const s=2147483647;e.kMaxLength=s;const{Uint8Array:i,ArrayBuffer:a,SharedArrayBuffer:o}=globalThis;u.TYPED_ARRAY_SUPPORT=l(),!u.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function l(){try{const we=new i(1),F={foo:function(){return 42}};return Object.setPrototypeOf(F,i.prototype),Object.setPrototypeOf(we,F),we.foo()===42}catch{return!1}}Object.defineProperty(u.prototype,"parent",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.buffer}}),Object.defineProperty(u.prototype,"offset",{enumerable:!0,get:function(){if(u.isBuffer(this))return this.byteOffset}});function c(we){if(we>s)throw new RangeError('The value "'+we+'" is invalid for option "size"');const F=new i(we);return Object.setPrototypeOf(F,u.prototype),F}function u(we,F,X){if(typeof we=="number"){if(typeof F=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return y(we)}return d(we,F,X)}u.poolSize=8192;function d(we,F,X){if(typeof we=="string")return b(we,F);if(a.isView(we))return x(we);if(we==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof we);if(dt(we,a)||we&&dt(we.buffer,a)||typeof o<"u"&&(dt(we,o)||we&&dt(we.buffer,o)))return w(we,F,X);if(typeof we=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const be=we.valueOf&&we.valueOf();if(be!=null&&be!==we)return u.from(be,F,X);const ke=S(we);if(ke)return ke;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof we[Symbol.toPrimitive]=="function")return u.from(we[Symbol.toPrimitive]("string"),F,X);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof we)}u.from=function(we,F,X){return d(we,F,X)},Object.setPrototypeOf(u.prototype,i.prototype),Object.setPrototypeOf(u,i);function h(we){if(typeof we!="number")throw new TypeError('"size" argument must be of type number');if(we<0)throw new RangeError('The value "'+we+'" is invalid for option "size"')}function m(we,F,X){return h(we),we<=0?c(we):F!==void 0?typeof X=="string"?c(we).fill(F,X):c(we).fill(F):c(we)}u.alloc=function(we,F,X){return m(we,F,X)};function y(we){return h(we),c(we<0?0:k(we)|0)}u.allocUnsafe=function(we){return y(we)},u.allocUnsafeSlow=function(we){return y(we)};function b(we,F){if((typeof F!="string"||F==="")&&(F="utf8"),!u.isEncoding(F))throw new TypeError("Unknown encoding: "+F);const X=T(we,F)|0;let be=c(X);const ke=be.write(we,F);return ke!==X&&(be=be.slice(0,ke)),be}function v(we){const F=we.length<0?0:k(we.length)|0,X=c(F);for(let be=0;be<F;be+=1)X[be]=we[be]&255;return X}function x(we){if(dt(we,i)){const F=new i(we);return w(F.buffer,F.byteOffset,F.byteLength)}return v(we)}function w(we,F,X){if(F<0||we.byteLength<F)throw new RangeError('"offset" is outside of buffer bounds');if(we.byteLength<F+(X||0))throw new RangeError('"length" is outside of buffer bounds');let be;return F===void 0&&X===void 0?be=new i(we):X===void 0?be=new i(we,F):be=new i(we,F,X),Object.setPrototypeOf(be,u.prototype),be}function S(we){if(u.isBuffer(we)){const F=k(we.length)|0,X=c(F);return X.length===0||we.copy(X,0,0,F),X}if(we.length!==void 0)return typeof we.length!="number"||Pt(we.length)?c(0):v(we);if(we.type==="Buffer"&&Array.isArray(we.data))return v(we.data)}function k(we){if(we>=s)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s.toString(16)+" bytes");return we|0}function C(we){return+we!=we&&(we=0),u.alloc(+we)}u.isBuffer=function(F){return F!=null&&F._isBuffer===!0&&F!==u.prototype},u.compare=function(F,X){if(dt(F,i)&&(F=u.from(F,F.offset,F.byteLength)),dt(X,i)&&(X=u.from(X,X.offset,X.byteLength)),!u.isBuffer(F)||!u.isBuffer(X))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(F===X)return 0;let be=F.length,ke=X.length;for(let ge=0,Ee=Math.min(be,ke);ge<Ee;++ge)if(F[ge]!==X[ge]){be=F[ge],ke=X[ge];break}return be<ke?-1:ke<be?1:0},u.isEncoding=function(F){switch(String(F).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(F,X){if(!Array.isArray(F))throw new TypeError('"list" argument must be an Array of Buffers');if(F.length===0)return u.alloc(0);let be;if(X===void 0)for(X=0,be=0;be<F.length;++be)X+=F[be].length;const ke=u.allocUnsafe(X);let ge=0;for(be=0;be<F.length;++be){let Ee=F[be];if(dt(Ee,i))ge+Ee.length>ke.length?(u.isBuffer(Ee)||(Ee=u.from(Ee)),Ee.copy(ke,ge)):i.prototype.set.call(ke,Ee,ge);else if(u.isBuffer(Ee))Ee.copy(ke,ge);else throw new TypeError('"list" argument must be an Array of Buffers');ge+=Ee.length}return ke};function T(we,F){if(u.isBuffer(we))return we.length;if(a.isView(we)||dt(we,a))return we.byteLength;if(typeof we!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof we);const X=we.length,be=arguments.length>2&&arguments[2]===!0;if(!be&&X===0)return 0;let ke=!1;for(;;)switch(F){case"ascii":case"latin1":case"binary":return X;case"utf8":case"utf-8":return Me(we).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return X*2;case"hex":return X>>>1;case"base64":return lt(we).length;default:if(ke)return be?-1:Me(we).length;F=(""+F).toLowerCase(),ke=!0}}u.byteLength=T;function A(we,F,X){let be=!1;if((F===void 0||F<0)&&(F=0),F>this.length||((X===void 0||X>this.length)&&(X=this.length),X<=0)||(X>>>=0,F>>>=0,X<=F))return"";for(we||(we="utf8");;)switch(we){case"hex":return ee(this,F,X);case"utf8":case"utf-8":return V(this,F,X);case"ascii":return W(this,F,X);case"latin1":case"binary":return Q(this,F,X);case"base64":return U(this,F,X);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return re(this,F,X);default:if(be)throw new TypeError("Unknown encoding: "+we);we=(we+"").toLowerCase(),be=!0}}u.prototype._isBuffer=!0;function N(we,F,X){const be=we[F];we[F]=we[X],we[X]=be}u.prototype.swap16=function(){const F=this.length;if(F%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let X=0;X<F;X+=2)N(this,X,X+1);return this},u.prototype.swap32=function(){const F=this.length;if(F%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let X=0;X<F;X+=4)N(this,X,X+3),N(this,X+1,X+2);return this},u.prototype.swap64=function(){const F=this.length;if(F%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let X=0;X<F;X+=8)N(this,X,X+7),N(this,X+1,X+6),N(this,X+2,X+5),N(this,X+3,X+4);return this},u.prototype.toString=function(){const F=this.length;return F===0?"":arguments.length===0?V(this,0,F):A.apply(this,arguments)},u.prototype.toLocaleString=u.prototype.toString,u.prototype.equals=function(F){if(!u.isBuffer(F))throw new TypeError("Argument must be a Buffer");return this===F?!0:u.compare(this,F)===0},u.prototype.inspect=function(){let F="";const X=e.INSPECT_MAX_BYTES;return F=this.toString("hex",0,X).replace(/(.{2})/g,"$1 ").trim(),this.length>X&&(F+=" ... "),"<Buffer "+F+">"},r&&(u.prototype[r]=u.prototype.inspect),u.prototype.compare=function(F,X,be,ke,ge){if(dt(F,i)&&(F=u.from(F,F.offset,F.byteLength)),!u.isBuffer(F))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof F);if(X===void 0&&(X=0),be===void 0&&(be=F?F.length:0),ke===void 0&&(ke=0),ge===void 0&&(ge=this.length),X<0||be>F.length||ke<0||ge>this.length)throw new RangeError("out of range index");if(ke>=ge&&X>=be)return 0;if(ke>=ge)return-1;if(X>=be)return 1;if(X>>>=0,be>>>=0,ke>>>=0,ge>>>=0,this===F)return 0;let Ee=ge-ke,le=be-X;const ft=Math.min(Ee,le),et=this.slice(ke,ge),$=F.slice(X,be);for(let Ue=0;Ue<ft;++Ue)if(et[Ue]!==$[Ue]){Ee=et[Ue],le=$[Ue];break}return Ee<le?-1:le<Ee?1:0};function I(we,F,X,be,ke){if(we.length===0)return-1;if(typeof X=="string"?(be=X,X=0):X>2147483647?X=2147483647:X<-2147483648&&(X=-2147483648),X=+X,Pt(X)&&(X=ke?0:we.length-1),X<0&&(X=we.length+X),X>=we.length){if(ke)return-1;X=we.length-1}else if(X<0)if(ke)X=0;else return-1;if(typeof F=="string"&&(F=u.from(F,be)),u.isBuffer(F))return F.length===0?-1:O(we,F,X,be,ke);if(typeof F=="number")return F=F&255,typeof i.prototype.indexOf=="function"?ke?i.prototype.indexOf.call(we,F,X):i.prototype.lastIndexOf.call(we,F,X):O(we,[F],X,be,ke);throw new TypeError("val must be string, number or Buffer")}function O(we,F,X,be,ke){let ge=1,Ee=we.length,le=F.length;if(be!==void 0&&(be=String(be).toLowerCase(),be==="ucs2"||be==="ucs-2"||be==="utf16le"||be==="utf-16le")){if(we.length<2||F.length<2)return-1;ge=2,Ee/=2,le/=2,X/=2}function ft($,Ue){return ge===1?$[Ue]:$.readUInt16BE(Ue*ge)}let et;if(ke){let $=-1;for(et=X;et<Ee;et++)if(ft(we,et)===ft(F,$===-1?0:et-$)){if($===-1&&($=et),et-$+1===le)return $*ge}else $!==-1&&(et-=et-$),$=-1}else for(X+le>Ee&&(X=Ee-le),et=X;et>=0;et--){let $=!0;for(let Ue=0;Ue<le;Ue++)if(ft(we,et+Ue)!==ft(F,Ue)){$=!1;break}if($)return et}return-1}u.prototype.includes=function(F,X,be){return this.indexOf(F,X,be)!==-1},u.prototype.indexOf=function(F,X,be){return I(this,F,X,be,!0)},u.prototype.lastIndexOf=function(F,X,be){return I(this,F,X,be,!1)};function B(we,F,X,be){X=Number(X)||0;const ke=we.length-X;be?(be=Number(be),be>ke&&(be=ke)):be=ke;const ge=F.length;be>ge/2&&(be=ge/2);let Ee;for(Ee=0;Ee<be;++Ee){const le=parseInt(F.substr(Ee*2,2),16);if(Pt(le))return Ee;we[X+Ee]=le}return Ee}function D(we,F,X,be){return Tt(Me(F,we.length-X),we,X,be)}function H(we,F,X,be){return Tt(Be(F),we,X,be)}function P(we,F,X,be){return Tt(lt(F),we,X,be)}function K(we,F,X,be){return Tt(Ae(F,we.length-X),we,X,be)}u.prototype.write=function(F,X,be,ke){if(X===void 0)ke="utf8",be=this.length,X=0;else if(be===void 0&&typeof X=="string")ke=X,be=this.length,X=0;else if(isFinite(X))X=X>>>0,isFinite(be)?(be=be>>>0,ke===void 0&&(ke="utf8")):(ke=be,be=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const ge=this.length-X;if((be===void 0||be>ge)&&(be=ge),F.length>0&&(be<0||X<0)||X>this.length)throw new RangeError("Attempt to write outside buffer bounds");ke||(ke="utf8");let Ee=!1;for(;;)switch(ke){case"hex":return B(this,F,X,be);case"utf8":case"utf-8":return D(this,F,X,be);case"ascii":case"latin1":case"binary":return H(this,F,X,be);case"base64":return P(this,F,X,be);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return K(this,F,X,be);default:if(Ee)throw new TypeError("Unknown encoding: "+ke);ke=(""+ke).toLowerCase(),Ee=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function U(we,F,X){return F===0&&X===we.length?t.fromByteArray(we):t.fromByteArray(we.slice(F,X))}function V(we,F,X){X=Math.min(we.length,X);const be=[];let ke=F;for(;ke<X;){const ge=we[ke];let Ee=null,le=ge>239?4:ge>223?3:ge>191?2:1;if(ke+le<=X){let ft,et,$,Ue;switch(le){case 1:ge<128&&(Ee=ge);break;case 2:ft=we[ke+1],(ft&192)===128&&(Ue=(ge&31)<<6|ft&63,Ue>127&&(Ee=Ue));break;case 3:ft=we[ke+1],et=we[ke+2],(ft&192)===128&&(et&192)===128&&(Ue=(ge&15)<<12|(ft&63)<<6|et&63,Ue>2047&&(Ue<55296||Ue>57343)&&(Ee=Ue));break;case 4:ft=we[ke+1],et=we[ke+2],$=we[ke+3],(ft&192)===128&&(et&192)===128&&($&192)===128&&(Ue=(ge&15)<<18|(ft&63)<<12|(et&63)<<6|$&63,Ue>65535&&Ue<1114112&&(Ee=Ue))}}Ee===null?(Ee=65533,le=1):Ee>65535&&(Ee-=65536,be.push(Ee>>>10&1023|55296),Ee=56320|Ee&1023),be.push(Ee),ke+=le}return te(be)}const L=4096;function te(we){const F=we.length;if(F<=L)return String.fromCharCode.apply(String,we);let X="",be=0;for(;be<F;)X+=String.fromCharCode.apply(String,we.slice(be,be+=L));return X}function W(we,F,X){let be="";X=Math.min(we.length,X);for(let ke=F;ke<X;++ke)be+=String.fromCharCode(we[ke]&127);return be}function Q(we,F,X){let be="";X=Math.min(we.length,X);for(let ke=F;ke<X;++ke)be+=String.fromCharCode(we[ke]);return be}function ee(we,F,X){const be=we.length;(!F||F<0)&&(F=0),(!X||X<0||X>be)&&(X=be);let ke="";for(let ge=F;ge<X;++ge)ke+=qt[we[ge]];return ke}function re(we,F,X){const be=we.slice(F,X);let ke="";for(let ge=0;ge<be.length-1;ge+=2)ke+=String.fromCharCode(be[ge]+be[ge+1]*256);return ke}u.prototype.slice=function(F,X){const be=this.length;F=~~F,X=X===void 0?be:~~X,F<0?(F+=be,F<0&&(F=0)):F>be&&(F=be),X<0?(X+=be,X<0&&(X=0)):X>be&&(X=be),X<F&&(X=F);const ke=this.subarray(F,X);return Object.setPrototypeOf(ke,u.prototype),ke};function pe(we,F,X){if(we%1!==0||we<0)throw new RangeError("offset is not uint");if(we+F>X)throw new RangeError("Trying to access beyond buffer length")}u.prototype.readUintLE=u.prototype.readUIntLE=function(F,X,be){F=F>>>0,X=X>>>0,be||pe(F,X,this.length);let ke=this[F],ge=1,Ee=0;for(;++Ee<X&&(ge*=256);)ke+=this[F+Ee]*ge;return ke},u.prototype.readUintBE=u.prototype.readUIntBE=function(F,X,be){F=F>>>0,X=X>>>0,be||pe(F,X,this.length);let ke=this[F+--X],ge=1;for(;X>0&&(ge*=256);)ke+=this[F+--X]*ge;return ke},u.prototype.readUint8=u.prototype.readUInt8=function(F,X){return F=F>>>0,X||pe(F,1,this.length),this[F]},u.prototype.readUint16LE=u.prototype.readUInt16LE=function(F,X){return F=F>>>0,X||pe(F,2,this.length),this[F]|this[F+1]<<8},u.prototype.readUint16BE=u.prototype.readUInt16BE=function(F,X){return F=F>>>0,X||pe(F,2,this.length),this[F]<<8|this[F+1]},u.prototype.readUint32LE=u.prototype.readUInt32LE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),(this[F]|this[F+1]<<8|this[F+2]<<16)+this[F+3]*16777216},u.prototype.readUint32BE=u.prototype.readUInt32BE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),this[F]*16777216+(this[F+1]<<16|this[F+2]<<8|this[F+3])},u.prototype.readBigUInt64LE=Ft(function(F){F=F>>>0,Ie(F,"offset");const X=this[F],be=this[F+7];(X===void 0||be===void 0)&&ce(F,this.length-8);const ke=X+this[++F]*2**8+this[++F]*2**16+this[++F]*2**24,ge=this[++F]+this[++F]*2**8+this[++F]*2**16+be*2**24;return BigInt(ke)+(BigInt(ge)<<BigInt(32))}),u.prototype.readBigUInt64BE=Ft(function(F){F=F>>>0,Ie(F,"offset");const X=this[F],be=this[F+7];(X===void 0||be===void 0)&&ce(F,this.length-8);const ke=X*2**24+this[++F]*2**16+this[++F]*2**8+this[++F],ge=this[++F]*2**24+this[++F]*2**16+this[++F]*2**8+be;return(BigInt(ke)<<BigInt(32))+BigInt(ge)}),u.prototype.readIntLE=function(F,X,be){F=F>>>0,X=X>>>0,be||pe(F,X,this.length);let ke=this[F],ge=1,Ee=0;for(;++Ee<X&&(ge*=256);)ke+=this[F+Ee]*ge;return ge*=128,ke>=ge&&(ke-=Math.pow(2,8*X)),ke},u.prototype.readIntBE=function(F,X,be){F=F>>>0,X=X>>>0,be||pe(F,X,this.length);let ke=X,ge=1,Ee=this[F+--ke];for(;ke>0&&(ge*=256);)Ee+=this[F+--ke]*ge;return ge*=128,Ee>=ge&&(Ee-=Math.pow(2,8*X)),Ee},u.prototype.readInt8=function(F,X){return F=F>>>0,X||pe(F,1,this.length),this[F]&128?(255-this[F]+1)*-1:this[F]},u.prototype.readInt16LE=function(F,X){F=F>>>0,X||pe(F,2,this.length);const be=this[F]|this[F+1]<<8;return be&32768?be|4294901760:be},u.prototype.readInt16BE=function(F,X){F=F>>>0,X||pe(F,2,this.length);const be=this[F+1]|this[F]<<8;return be&32768?be|4294901760:be},u.prototype.readInt32LE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),this[F]|this[F+1]<<8|this[F+2]<<16|this[F+3]<<24},u.prototype.readInt32BE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),this[F]<<24|this[F+1]<<16|this[F+2]<<8|this[F+3]},u.prototype.readBigInt64LE=Ft(function(F){F=F>>>0,Ie(F,"offset");const X=this[F],be=this[F+7];(X===void 0||be===void 0)&&ce(F,this.length-8);const ke=this[F+4]+this[F+5]*2**8+this[F+6]*2**16+(be<<24);return(BigInt(ke)<<BigInt(32))+BigInt(X+this[++F]*2**8+this[++F]*2**16+this[++F]*2**24)}),u.prototype.readBigInt64BE=Ft(function(F){F=F>>>0,Ie(F,"offset");const X=this[F],be=this[F+7];(X===void 0||be===void 0)&&ce(F,this.length-8);const ke=(X<<24)+this[++F]*2**16+this[++F]*2**8+this[++F];return(BigInt(ke)<<BigInt(32))+BigInt(this[++F]*2**24+this[++F]*2**16+this[++F]*2**8+be)}),u.prototype.readFloatLE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),n.read(this,F,!0,23,4)},u.prototype.readFloatBE=function(F,X){return F=F>>>0,X||pe(F,4,this.length),n.read(this,F,!1,23,4)},u.prototype.readDoubleLE=function(F,X){return F=F>>>0,X||pe(F,8,this.length),n.read(this,F,!0,52,8)},u.prototype.readDoubleBE=function(F,X){return F=F>>>0,X||pe(F,8,this.length),n.read(this,F,!1,52,8)};function de(we,F,X,be,ke,ge){if(!u.isBuffer(we))throw new TypeError('"buffer" argument must be a Buffer instance');if(F>ke||F<ge)throw new RangeError('"value" argument is out of bounds');if(X+be>we.length)throw new RangeError("Index out of range")}u.prototype.writeUintLE=u.prototype.writeUIntLE=function(F,X,be,ke){if(F=+F,X=X>>>0,be=be>>>0,!ke){const le=Math.pow(2,8*be)-1;de(this,F,X,be,le,0)}let ge=1,Ee=0;for(this[X]=F&255;++Ee<be&&(ge*=256);)this[X+Ee]=F/ge&255;return X+be},u.prototype.writeUintBE=u.prototype.writeUIntBE=function(F,X,be,ke){if(F=+F,X=X>>>0,be=be>>>0,!ke){const le=Math.pow(2,8*be)-1;de(this,F,X,be,le,0)}let ge=be-1,Ee=1;for(this[X+ge]=F&255;--ge>=0&&(Ee*=256);)this[X+ge]=F/Ee&255;return X+be},u.prototype.writeUint8=u.prototype.writeUInt8=function(F,X,be){return F=+F,X=X>>>0,be||de(this,F,X,1,255,0),this[X]=F&255,X+1},u.prototype.writeUint16LE=u.prototype.writeUInt16LE=function(F,X,be){return F=+F,X=X>>>0,be||de(this,F,X,2,65535,0),this[X]=F&255,this[X+1]=F>>>8,X+2},u.prototype.writeUint16BE=u.prototype.writeUInt16BE=function(F,X,be){return F=+F,X=X>>>0,be||de(this,F,X,2,65535,0),this[X]=F>>>8,this[X+1]=F&255,X+2},u.prototype.writeUint32LE=u.prototype.writeUInt32LE=function(F,X,be){return F=+F,X=X>>>0,be||de(this,F,X,4,4294967295,0),this[X+3]=F>>>24,this[X+2]=F>>>16,this[X+1]=F>>>8,this[X]=F&255,X+4},u.prototype.writeUint32BE=u.prototype.writeUInt32BE=function(F,X,be){return F=+F,X=X>>>0,be||de(this,F,X,4,4294967295,0),this[X]=F>>>24,this[X+1]=F>>>16,this[X+2]=F>>>8,this[X+3]=F&255,X+4};function Oe(we,F,X,be,ke){ye(F,be,ke,we,X,7);let ge=Number(F&BigInt(4294967295));we[X++]=ge,ge=ge>>8,we[X++]=ge,ge=ge>>8,we[X++]=ge,ge=ge>>8,we[X++]=ge;let Ee=Number(F>>BigInt(32)&BigInt(4294967295));return we[X++]=Ee,Ee=Ee>>8,we[X++]=Ee,Ee=Ee>>8,we[X++]=Ee,Ee=Ee>>8,we[X++]=Ee,X}function Fe(we,F,X,be,ke){ye(F,be,ke,we,X,7);let ge=Number(F&BigInt(4294967295));we[X+7]=ge,ge=ge>>8,we[X+6]=ge,ge=ge>>8,we[X+5]=ge,ge=ge>>8,we[X+4]=ge;let Ee=Number(F>>BigInt(32)&BigInt(4294967295));return we[X+3]=Ee,Ee=Ee>>8,we[X+2]=Ee,Ee=Ee>>8,we[X+1]=Ee,Ee=Ee>>8,we[X]=Ee,X+8}u.prototype.writeBigUInt64LE=Ft(function(F,X=0){return Oe(this,F,X,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeBigUInt64BE=Ft(function(F,X=0){return Fe(this,F,X,BigInt(0),BigInt("0xffffffffffffffff"))}),u.prototype.writeIntLE=function(F,X,be,ke){if(F=+F,X=X>>>0,!ke){const ft=Math.pow(2,8*be-1);de(this,F,X,be,ft-1,-ft)}let ge=0,Ee=1,le=0;for(this[X]=F&255;++ge<be&&(Ee*=256);)F<0&&le===0&&this[X+ge-1]!==0&&(le=1),this[X+ge]=(F/Ee>>0)-le&255;return X+be},u.prototype.writeIntBE=function(F,X,be,ke){if(F=+F,X=X>>>0,!ke){const ft=Math.pow(2,8*be-1);de(this,F,X,be,ft-1,-ft)}let ge=be-1,Ee=1,le=0;for(this[X+ge]=F&255;--ge>=0&&(Ee*=256);)F<0&&le===0&&this[X+ge+1]!==0&&(le=1),this[X+ge]=(F/Ee>>0)-le&255;return X+be},u.prototype.writeInt8=function(F,X,be){return F=+F,X=X>>>0,be||de(this,F,X,1,127,-128),F<0&&(F=255+F+1),this[X]=F&255,X+1},u.prototype.writeInt16LE=function(F,X,be){return F=+F,X=X>>>0,be||de(this,F,X,2,32767,-32768),this[X]=F&255,this[X+1]=F>>>8,X+2},u.prototype.writeInt16BE=function(F,X,be){return F=+F,X=X>>>0,be||de(this,F,X,2,32767,-32768),this[X]=F>>>8,this[X+1]=F&255,X+2},u.prototype.writeInt32LE=function(F,X,be){return F=+F,X=X>>>0,be||de(this,F,X,4,2147483647,-2147483648),this[X]=F&255,this[X+1]=F>>>8,this[X+2]=F>>>16,this[X+3]=F>>>24,X+4},u.prototype.writeInt32BE=function(F,X,be){return F=+F,X=X>>>0,be||de(this,F,X,4,2147483647,-2147483648),F<0&&(F=4294967295+F+1),this[X]=F>>>24,this[X+1]=F>>>16,this[X+2]=F>>>8,this[X+3]=F&255,X+4},u.prototype.writeBigInt64LE=Ft(function(F,X=0){return Oe(this,F,X,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),u.prototype.writeBigInt64BE=Ft(function(F,X=0){return Fe(this,F,X,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Se(we,F,X,be,ke,ge){if(X+be>we.length)throw new RangeError("Index out of range");if(X<0)throw new RangeError("Index out of range")}function Ce(we,F,X,be,ke){return F=+F,X=X>>>0,ke||Se(we,F,X,4),n.write(we,F,X,be,23,4),X+4}u.prototype.writeFloatLE=function(F,X,be){return Ce(this,F,X,!0,be)},u.prototype.writeFloatBE=function(F,X,be){return Ce(this,F,X,!1,be)};function qe(we,F,X,be,ke){return F=+F,X=X>>>0,ke||Se(we,F,X,8),n.write(we,F,X,be,52,8),X+8}u.prototype.writeDoubleLE=function(F,X,be){return qe(this,F,X,!0,be)},u.prototype.writeDoubleBE=function(F,X,be){return qe(this,F,X,!1,be)},u.prototype.copy=function(F,X,be,ke){if(!u.isBuffer(F))throw new TypeError("argument should be a Buffer");if(be||(be=0),!ke&&ke!==0&&(ke=this.length),X>=F.length&&(X=F.length),X||(X=0),ke>0&&ke<be&&(ke=be),ke===be||F.length===0||this.length===0)return 0;if(X<0)throw new RangeError("targetStart out of bounds");if(be<0||be>=this.length)throw new RangeError("Index out of range");if(ke<0)throw new RangeError("sourceEnd out of bounds");ke>this.length&&(ke=this.length),F.length-X<ke-be&&(ke=F.length-X+be);const ge=ke-be;return this===F&&typeof i.prototype.copyWithin=="function"?this.copyWithin(X,be,ke):i.prototype.set.call(F,this.subarray(be,ke),X),ge},u.prototype.fill=function(F,X,be,ke){if(typeof F=="string"){if(typeof X=="string"?(ke=X,X=0,be=this.length):typeof be=="string"&&(ke=be,be=this.length),ke!==void 0&&typeof ke!="string")throw new TypeError("encoding must be a string");if(typeof ke=="string"&&!u.isEncoding(ke))throw new TypeError("Unknown encoding: "+ke);if(F.length===1){const Ee=F.charCodeAt(0);(ke==="utf8"&&Ee<128||ke==="latin1")&&(F=Ee)}}else typeof F=="number"?F=F&255:typeof F=="boolean"&&(F=Number(F));if(X<0||this.length<X||this.length<be)throw new RangeError("Out of range index");if(be<=X)return this;X=X>>>0,be=be===void 0?this.length:be>>>0,F||(F=0);let ge;if(typeof F=="number")for(ge=X;ge<be;++ge)this[ge]=F;else{const Ee=u.isBuffer(F)?F:u.from(F,ke),le=Ee.length;if(le===0)throw new TypeError('The value "'+F+'" is invalid for argument "value"');for(ge=0;ge<be-X;++ge)this[ge+X]=Ee[ge%le]}return this};const Qe={};function We(we,F,X){Qe[we]=class extends X{constructor(){super(),Object.defineProperty(this,"message",{value:F.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${we}]`,this.stack,delete this.name}get code(){return we}set code(ke){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:ke,writable:!0})}toString(){return`${this.name} [${we}]: ${this.message}`}}}We("ERR_BUFFER_OUT_OF_BOUNDS",function(we){return we?`${we} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),We("ERR_INVALID_ARG_TYPE",function(we,F){return`The "${we}" argument must be of type number. Received type ${typeof F}`},TypeError),We("ERR_OUT_OF_RANGE",function(we,F,X){let be=`The value of "${we}" is out of range.`,ke=X;return Number.isInteger(X)&&Math.abs(X)>2**32?ke=je(String(X)):typeof X=="bigint"&&(ke=String(X),(X>BigInt(2)**BigInt(32)||X<-(BigInt(2)**BigInt(32)))&&(ke=je(ke)),ke+="n"),be+=` It must be ${F}. Received ${ke}`,be},RangeError);function je(we){let F="",X=we.length;const be=we[0]==="-"?1:0;for(;X>=be+4;X-=3)F=`_${we.slice(X-3,X)}${F}`;return`${we.slice(0,X)}${F}`}function Y(we,F,X){Ie(F,"offset"),(we[F]===void 0||we[F+X]===void 0)&&ce(F,we.length-(X+1))}function ye(we,F,X,be,ke,ge){if(we>X||we<F){const Ee=typeof F=="bigint"?"n":"";let le;throw F===0||F===BigInt(0)?le=`>= 0${Ee} and < 2${Ee} ** ${(ge+1)*8}${Ee}`:le=`>= -(2${Ee} ** ${(ge+1)*8-1}${Ee}) and < 2 ** ${(ge+1)*8-1}${Ee}`,new Qe.ERR_OUT_OF_RANGE("value",le,we)}Y(be,ke,ge)}function Ie(we,F){if(typeof we!="number")throw new Qe.ERR_INVALID_ARG_TYPE(F,"number",we)}function ce(we,F,X){throw Math.floor(we)!==we?(Ie(we,X),new Qe.ERR_OUT_OF_RANGE("offset","an integer",we)):F<0?new Qe.ERR_BUFFER_OUT_OF_BOUNDS:new Qe.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${F}`,we)}const oe=/[^+/0-9A-Za-z-_]/g;function se(we){if(we=we.split("=")[0],we=we.trim().replace(oe,""),we.length<2)return"";for(;we.length%4!==0;)we=we+"=";return we}function Me(we,F){F=F||1/0;let X;const be=we.length;let ke=null;const ge=[];for(let Ee=0;Ee<be;++Ee){if(X=we.charCodeAt(Ee),X>55295&&X<57344){if(!ke){if(X>56319){(F-=3)>-1&&ge.push(239,191,189);continue}else if(Ee+1===be){(F-=3)>-1&&ge.push(239,191,189);continue}ke=X;continue}if(X<56320){(F-=3)>-1&&ge.push(239,191,189),ke=X;continue}X=(ke-55296<<10|X-56320)+65536}else ke&&(F-=3)>-1&&ge.push(239,191,189);if(ke=null,X<128){if((F-=1)<0)break;ge.push(X)}else if(X<2048){if((F-=2)<0)break;ge.push(X>>6|192,X&63|128)}else if(X<65536){if((F-=3)<0)break;ge.push(X>>12|224,X>>6&63|128,X&63|128)}else if(X<1114112){if((F-=4)<0)break;ge.push(X>>18|240,X>>12&63|128,X>>6&63|128,X&63|128)}else throw new Error("Invalid code point")}return ge}function Be(we){const F=[];for(let X=0;X<we.length;++X)F.push(we.charCodeAt(X)&255);return F}function Ae(we,F){let X,be,ke;const ge=[];for(let Ee=0;Ee<we.length&&!((F-=2)<0);++Ee)X=we.charCodeAt(Ee),be=X>>8,ke=X%256,ge.push(ke),ge.push(be);return ge}function lt(we){return t.toByteArray(se(we))}function Tt(we,F,X,be){let ke;for(ke=0;ke<be&&!(ke+X>=F.length||ke>=we.length);++ke)F[ke+X]=we[ke];return ke}function dt(we,F){return we instanceof F||we!=null&&we.constructor!=null&&we.constructor.name!=null&&we.constructor.name===F.name}function Pt(we){return we!==we}const qt=function(){const we="0123456789abcdef",F=new Array(256);for(let X=0;X<16;++X){const be=X*16;for(let ke=0;ke<16;++ke)F[be+ke]=we[X]+we[ke]}return F}();function Ft(we){return typeof BigInt>"u"?Ht:we}function Ht(){throw new Error("BigInt not supported")}})(QP);const cn=QP.Buffer,Ds=QP.Buffer;var $p={exports:{}},KB;function Rye(){if(KB)return $p.exports;KB=1;const e=typeof cn<"u",t=/"(?:_|\\u005[Ff])(?:_|\\u005[Ff])(?:p|\\u0070)(?:r|\\u0072)(?:o|\\u006[Ff])(?:t|\\u0074)(?:o|\\u006[Ff])(?:_|\\u005[Ff])(?:_|\\u005[Ff])"\s*:/,n=/"(?:c|\\u0063)(?:o|\\u006[Ff])(?:n|\\u006[Ee])(?:s|\\u0073)(?:t|\\u0074)(?:r|\\u0072)(?:u|\\u0075)(?:c|\\u0063)(?:t|\\u0074)(?:o|\\u006[Ff])(?:r|\\u0072)"\s*:/;function r(o,l,c){c==null&&l!==null&&typeof l=="object"&&(c=l,l=void 0),e&&cn.isBuffer(o)&&(o=o.toString()),o&&o.charCodeAt(0)===65279&&(o=o.slice(1));const u=JSON.parse(o,l);if(u===null||typeof u!="object")return u;const d=c&&c.protoAction||"error",h=c&&c.constructorAction||"error";if(d==="ignore"&&h==="ignore")return u;if(d!=="ignore"&&h!=="ignore"){if(t.test(o)===!1&&n.test(o)===!1)return u}else if(d!=="ignore"&&h==="ignore"){if(t.test(o)===!1)return u}else if(n.test(o)===!1)return u;return s(u,{protoAction:d,constructorAction:h,safe:c&&c.safe})}function s(o,{protoAction:l="error",constructorAction:c="error",safe:u}={}){let d=[o];for(;d.length;){const h=d;d=[];for(const m of h){if(l!=="ignore"&&Object.prototype.hasOwnProperty.call(m,"__proto__")){if(u===!0)return null;if(l==="error")throw new SyntaxError("Object contains forbidden prototype property");delete m.__proto__}if(c!=="ignore"&&Object.prototype.hasOwnProperty.call(m,"constructor")&&Object.prototype.hasOwnProperty.call(m.constructor,"prototype")){if(u===!0)return null;if(c==="error")throw new SyntaxError("Object contains forbidden prototype property");delete m.constructor}for(const y in m){const b=m[y];b&&typeof b=="object"&&d.push(b)}}}return o}function i(o,l,c){const u=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,c)}finally{Error.stackTraceLimit=u}}function a(o,l){const c=Error.stackTraceLimit;Error.stackTraceLimit=0;try{return r(o,l,{safe:!0})}catch{return null}finally{Error.stackTraceLimit=c}}return $p.exports=i,$p.exports.default=i,$p.exports.parse=i,$p.exports.safeParse=a,$p.exports.scan=s,$p.exports}var Nye=Rye();const tO=da(Nye);var Mye={};function Vs(...e){return e.reduce((t,n)=>({...t,...n??{}}),{})}function Iye(e){return new ReadableStream({async pull(t){try{const{value:n,done:r}=await e.next();r?t.close():t.enqueue(n)}catch(n){t.error(n)}},cancel(){}})}async function jye(e){return e==null?Promise.resolve():new Promise(t=>setTimeout(t,e))}function xG(){let e="",t,n=[],r,s;function i(l,c){if(l===""){a(c);return}if(l.startsWith(":"))return;const u=l.indexOf(":");if(u===-1){o(l,"");return}const d=l.slice(0,u),h=u+1,m=h<l.length&&l[h]===" "?l.slice(h+1):l.slice(h);o(d,m)}function a(l){n.length>0&&(l.enqueue({event:t,data:n.join(`
`),id:r,retry:s}),n=[],t=void 0,s=void 0)}function o(l,c){switch(l){case"event":t=c;break;case"data":n.push(c);break;case"id":r=c;break;case"retry":const u=parseInt(c,10);isNaN(u)||(s=u);break}}return new TransformStream({transform(l,c){const{lines:u,incompleteLine:d}=Pye(e,l);e=d;for(let h=0;h<u.length;h++)i(u[h],c)},flush(l){i(e,l),a(l)}})}function Pye(e,t){const n=[];let r=e;for(let s=0;s<t.length;){const i=t[s++];i===`
`?(n.push(r),r=""):i==="\r"?(n.push(r),r="",t[s]===`
`&&s++):r+=i}return{lines:n,incompleteLine:r}}function Gy(e){const t={};return e.headers.forEach((n,r)=>{t[r]=n}),t}var Wm=({prefix:e,size:t=16,alphabet:n="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz",separator:r="-"}={})=>{const s=xye(n,t);if(e==null)return s;if(n.includes(r))throw new XH({argument:"separator",message:`The separator "${r}" must not be part of the alphabet "${n}".`});return i=>`${e}${r}${s(i)}`},oa=Wm();function Oye(e){return e==null?"unknown error":typeof e=="string"?e:e instanceof Error?e.message:JSON.stringify(e)}function Dye(e){return Object.fromEntries(Object.entries(e).filter(([t,n])=>n!=null))}function OC(e){return e instanceof Error&&(e.name==="AbortError"||e.name==="TimeoutError")}function nO({apiKey:e,environmentVariableName:t,apiKeyParameterName:n="apiKey",description:r}){if(typeof e=="string")return e;if(e!=null)throw new DS({message:`${r} API key must be a string.`});if(typeof Mi>"u")throw new DS({message:`${r} API key is missing. Pass it using the '${n}' parameter. Environment variables is not supported in this environment.`});if(e=Mye[t],e==null)throw new DS({message:`${r} API key is missing. Pass it using the '${n}' parameter or the ${t} environment variable.`});if(typeof e!="string")throw new DS({message:`${r} API key must be a string. The value of the ${t} environment variable is not a string.`});return e}var x2=Symbol.for("vercel.ai.validator");function Fye(e){return{[x2]:!0,validate:e}}function Lye(e){return typeof e=="object"&&e!==null&&x2 in e&&e[x2]===!0&&"validate"in e}function Bye(e){return Lye(e)?e:$ye(e)}function $ye(e){return Fye(t=>{const n=e.safeParse(t);return n.success?{success:!0,value:n.data}:{success:!1,error:n.error}})}function zye({value:e,schema:t}){const n=Ky({value:e,schema:t});if(!n.success)throw v2.wrap({value:e,cause:n.error});return n.value}function Ky({value:e,schema:t}){const n=Bye(t);try{if(n.validate==null)return{success:!0,value:e};const r=n.validate(e);return r.success?r:{success:!1,error:v2.wrap({value:e,cause:r.error})}}catch(r){return{success:!1,error:v2.wrap({value:e,cause:r})}}}function Uye({text:e,schema:t}){try{const n=tO.parse(e);return t==null?n:zye({value:n,schema:t})}catch(n){throw b2.isInstance(n)||v2.isInstance(n)?n:new b2({text:e,cause:n})}}function km({text:e,schema:t}){try{const n=tO.parse(e);if(t==null)return{success:!0,value:n,rawValue:n};const r=Ky({value:n,schema:t});return r.success?{...r,rawValue:n}:r}catch(n){return{success:!1,error:b2.isInstance(n)?n:new b2({text:e,cause:n})}}}function gm(e){try{return tO.parse(e),!0}catch{return!1}}function ME({provider:e,providerOptions:t,schema:n}){if((t==null?void 0:t[e])==null)return;const r=Ky({value:t[e],schema:n});if(!r.success)throw new XH({argument:"providerOptions",message:`invalid ${e} provider options`,cause:r.error});return r.value}var qye=()=>globalThis.fetch,Ws=async({url:e,headers:t,body:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>wG({url:e,headers:{"Content-Type":"application/json",...t},body:{content:JSON.stringify(n),values:n},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),Vye=async({url:e,headers:t,formData:n,failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a})=>wG({url:e,headers:t,body:{content:n,values:Object.fromEntries(n.entries())},failedResponseHandler:r,successfulResponseHandler:s,abortSignal:i,fetch:a}),wG=async({url:e,headers:t={},body:n,successfulResponseHandler:r,failedResponseHandler:s,abortSignal:i,fetch:a=qye()})=>{try{const o=await a(e,{method:"POST",headers:Dye(t),body:n.content,signal:i}),l=Gy(o);if(!o.ok){let c;try{c=await s({response:o,url:e,requestBodyValues:n.values})}catch(u){throw OC(u)||Vl.isInstance(u)?u:new Vl({message:"Failed to process error response",cause:u,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}throw c.value}try{return await r({response:o,url:e,requestBodyValues:n.values})}catch(c){throw c instanceof Error&&(OC(c)||Vl.isInstance(c))?c:new Vl({message:"Failed to process successful response",cause:c,statusCode:o.status,url:e,responseHeaders:l,requestBodyValues:n.values})}}catch(o){if(OC(o))throw o;if(o instanceof TypeError&&o.message==="fetch failed"){const l=o.cause;if(l!=null)throw new Vl({message:`Cannot connect to API: ${l.message}`,cause:l,url:e,requestBodyValues:n.values,isRetryable:!0})}throw o}};async function hj(e){return typeof e=="function"&&(e=e()),Promise.resolve(e)}var Jh=({errorSchema:e,errorToMessage:t,isRetryable:n})=>async({response:r,url:s,requestBodyValues:i})=>{const a=await r.text(),o=Gy(r);if(a.trim()==="")return{responseHeaders:o,value:new Vl({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})};try{const l=Uye({text:a,schema:e});return{responseHeaders:o,value:new Vl({message:t(l),url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,data:l,isRetryable:n==null?void 0:n(r,l)})}}catch{return{responseHeaders:o,value:new Vl({message:r.statusText,url:s,requestBodyValues:i,statusCode:r.status,responseHeaders:o,responseBody:a,isRetryable:n==null?void 0:n(r)})}}},Qh=e=>async({response:t})=>{const n=Gy(t);if(t.body==null)throw new GH({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(xG()).pipeThrough(new TransformStream({transform({data:r},s){r!=="[DONE]"&&s.enqueue(km({text:r,schema:e}))}}))}},Va=e=>async({response:t,url:n,requestBodyValues:r})=>{const s=await t.text(),i=km({text:s,schema:e}),a=Gy(t);if(!i.success)throw new Vl({message:"Invalid JSON response",cause:i.error,statusCode:t.status,responseHeaders:a,responseBody:s,url:n,requestBodyValues:r});return{responseHeaders:a,value:i.value,rawValue:i.rawValue}},Wye=()=>async({response:e,url:t,requestBodyValues:n})=>{const r=Gy(e);if(!e.body)throw new Vl({message:"Response body is empty",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0});try{const s=await e.arrayBuffer();return{responseHeaders:r,value:new Uint8Array(s)}}catch(s){throw new Vl({message:"Failed to read response as array buffer",url:t,requestBodyValues:n,statusCode:e.status,responseHeaders:r,responseBody:void 0,cause:s})}},{btoa:Hye,atob:Gye}=globalThis;function IE(e){const t=e.replace(/-/g,"+").replace(/_/g,"/"),n=Gye(t);return Uint8Array.from(n,r=>r.codePointAt(0))}function Pu(e){let t="";for(let n=0;n<e.length;n++)t+=String.fromCodePoint(e[n]);return Hye(t)}function x1(e){return e==null?void 0:e.replace(/\/$/,"")}var es;(function(e){e.assertEqual=s=>{};function t(s){}e.assertIs=t;function n(s){throw new Error}e.assertNever=n,e.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},e.getValidEnumValues=s=>{const i=e.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),a={};for(const o of i)a[o]=s[o];return e.objectValues(a)},e.objectValues=s=>e.objectKeys(s).map(function(i){return s[i]}),e.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},e.find=(s,i)=>{for(const a of s)if(i(a))return a},e.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&Number.isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}e.joinValues=r,e.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(es||(es={}));var YB;(function(e){e.mergeShapes=(t,n)=>({...t,...n})})(YB||(YB={}));const vn=es.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),ph=e=>{switch(typeof e){case"undefined":return vn.undefined;case"string":return vn.string;case"number":return Number.isNaN(e)?vn.nan:vn.number;case"boolean":return vn.boolean;case"function":return vn.function;case"bigint":return vn.bigint;case"symbol":return vn.symbol;case"object":return Array.isArray(e)?vn.array:e===null?vn.null:e.then&&typeof e.then=="function"&&e.catch&&typeof e.catch=="function"?vn.promise:typeof Map<"u"&&e instanceof Map?vn.map:typeof Set<"u"&&e instanceof Set?vn.set:typeof Date<"u"&&e instanceof Date?vn.date:vn.object;default:return vn.unknown}},Jt=es.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]);class Oc extends Error{get errors(){return this.issues}constructor(t){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=t}format(t){const n=t||function(i){return i.message},r={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let o=r,l=0;for(;l<a.path.length;){const c=a.path[l];l===a.path.length-1?(o[c]=o[c]||{_errors:[]},o[c]._errors.push(n(a))):o[c]=o[c]||{_errors:[]},o=o[c],l++}}};return s(this),r}static assert(t){if(!(t instanceof Oc))throw new Error(`Not a ZodError: ${t}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,es.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(t=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(t(s))):r.push(t(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}Oc.create=e=>new Oc(e);const pj=(e,t)=>{let n;switch(e.code){case Jt.invalid_type:e.received===vn.undefined?n="Required":n=`Expected ${e.expected}, received ${e.received}`;break;case Jt.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(e.expected,es.jsonStringifyReplacer)}`;break;case Jt.unrecognized_keys:n=`Unrecognized key(s) in object: ${es.joinValues(e.keys,", ")}`;break;case Jt.invalid_union:n="Invalid input";break;case Jt.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${es.joinValues(e.options)}`;break;case Jt.invalid_enum_value:n=`Invalid enum value. Expected ${es.joinValues(e.options)}, received '${e.received}'`;break;case Jt.invalid_arguments:n="Invalid function arguments";break;case Jt.invalid_return_type:n="Invalid function return type";break;case Jt.invalid_date:n="Invalid date";break;case Jt.invalid_string:typeof e.validation=="object"?"includes"in e.validation?(n=`Invalid input: must include "${e.validation.includes}"`,typeof e.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${e.validation.position}`)):"startsWith"in e.validation?n=`Invalid input: must start with "${e.validation.startsWith}"`:"endsWith"in e.validation?n=`Invalid input: must end with "${e.validation.endsWith}"`:es.assertNever(e.validation):e.validation!=="regex"?n=`Invalid ${e.validation}`:n="Invalid";break;case Jt.too_small:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at least":"more than"} ${e.minimum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at least":"over"} ${e.minimum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${e.minimum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly equal to ":e.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(e.minimum))}`:n="Invalid input";break;case Jt.too_big:e.type==="array"?n=`Array must contain ${e.exact?"exactly":e.inclusive?"at most":"less than"} ${e.maximum} element(s)`:e.type==="string"?n=`String must contain ${e.exact?"exactly":e.inclusive?"at most":"under"} ${e.maximum} character(s)`:e.type==="number"?n=`Number must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="bigint"?n=`BigInt must be ${e.exact?"exactly":e.inclusive?"less than or equal to":"less than"} ${e.maximum}`:e.type==="date"?n=`Date must be ${e.exact?"exactly":e.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(e.maximum))}`:n="Invalid input";break;case Jt.custom:n="Invalid input";break;case Jt.invalid_intersection_types:n="Intersection results could not be merged";break;case Jt.not_multiple_of:n=`Number must be a multiple of ${e.multipleOf}`;break;case Jt.not_finite:n="Number must be finite";break;default:n=t.defaultError,es.assertNever(e)}return{message:n}};let Kye=pj;function Yye(){return Kye}const Zye=e=>{const{data:t,path:n,errorMaps:r,issueData:s}=e,i=[...n,...s.path||[]],a={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const l=r.filter(c=>!!c).slice().reverse();for(const c of l)o=c(a,{data:t,defaultError:o}).message;return{...s,path:i,message:o}};function pn(e,t){const n=Yye(),r=Zye({issueData:t,data:e.data,path:e.path,errorMaps:[e.common.contextualErrorMap,e.schemaErrorMap,n,n===pj?void 0:pj].filter(s=>!!s)});e.common.issues.push(r)}class fo{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(t,n){const r=[];for(const s of n){if(s.status==="aborted")return fr;s.status==="dirty"&&t.dirty(),r.push(s.value)}return{status:t.value,value:r}}static async mergeObjectAsync(t,n){const r=[];for(const s of n){const i=await s.key,a=await s.value;r.push({key:i,value:a})}return fo.mergeObjectSync(t,r)}static mergeObjectSync(t,n){const r={};for(const s of n){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return fr;i.status==="dirty"&&t.dirty(),a.status==="dirty"&&t.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(r[i.value]=a.value)}return{status:t.value,value:r}}}const fr=Object.freeze({status:"aborted"}),lx=e=>({status:"dirty",value:e}),ec=e=>({status:"valid",value:e}),ZB=e=>e.status==="aborted",XB=e=>e.status==="dirty",ay=e=>e.status==="valid",w2=e=>typeof Promise<"u"&&e instanceof Promise;var Rn;(function(e){e.errToObj=t=>typeof t=="string"?{message:t}:t||{},e.toString=t=>typeof t=="string"?t:t==null?void 0:t.message})(Rn||(Rn={}));class Ou{constructor(t,n,r,s){this._cachedPath=[],this.parent=t,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(Array.isArray(this._key)?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const JB=(e,t)=>{if(ay(t))return{success:!0,data:t.value};if(!e.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new Oc(e.common.issues);return this._error=n,this._error}}};function Nr(e){if(!e)return{};const{errorMap:t,invalid_type_error:n,required_error:r,description:s}=e;if(t&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return t?{errorMap:t,description:s}:{errorMap:(a,o)=>{const{message:l}=e;return a.code==="invalid_enum_value"?{message:l??o.defaultError}:typeof o.data>"u"?{message:l??r??o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:l??n??o.defaultError}},description:s}}class Vr{get description(){return this._def.description}_getType(t){return ph(t.data)}_getOrReturnCtx(t,n){return n||{common:t.parent.common,data:t.data,parsedType:ph(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}_processInputParams(t){return{status:new fo,ctx:{common:t.parent.common,data:t.data,parsedType:ph(t.data),schemaErrorMap:this._def.errorMap,path:t.path,parent:t.parent}}}_parseSync(t){const n=this._parse(t);if(w2(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(t){const n=this._parse(t);return Promise.resolve(n)}parse(t,n){const r=this.safeParse(t,n);if(r.success)return r.data;throw r.error}safeParse(t,n){const r={common:{issues:[],async:(n==null?void 0:n.async)??!1,contextualErrorMap:n==null?void 0:n.errorMap},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ph(t)},s=this._parseSync({data:t,path:r.path,parent:r});return JB(r,s)}"~validate"(t){var r,s;const n={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ph(t)};if(!this["~standard"].async)try{const i=this._parseSync({data:t,path:[],parent:n});return ay(i)?{value:i.value}:{issues:n.common.issues}}catch(i){(s=(r=i==null?void 0:i.message)==null?void 0:r.toLowerCase())!=null&&s.includes("encountered")&&(this["~standard"].async=!0),n.common={issues:[],async:!0}}return this._parseAsync({data:t,path:[],parent:n}).then(i=>ay(i)?{value:i.value}:{issues:n.common.issues})}async parseAsync(t,n){const r=await this.safeParseAsync(t,n);if(r.success)return r.data;throw r.error}async safeParseAsync(t,n){const r={common:{issues:[],contextualErrorMap:n==null?void 0:n.errorMap,async:!0},path:(n==null?void 0:n.path)||[],schemaErrorMap:this._def.errorMap,parent:null,data:t,parsedType:ph(t)},s=this._parse({data:t,path:r.path,parent:r}),i=await(w2(s)?s:Promise.resolve(s));return JB(r,i)}refine(t,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const a=t(s),o=()=>i.addIssue({code:Jt.custom,...r(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(l=>l?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(t,n){return this._refinement((r,s)=>t(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(t){return new Am({schema:this,typeName:tn.ZodEffects,effect:{type:"refinement",refinement:t}})}superRefine(t){return this._refinement(t)}constructor(t){this.spa=this.safeParseAsync,this._def=t,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Eu.create(this,this._def)}nullable(){return Rm.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return ku.create(this)}promise(){return A2.create(this,this._def)}or(t){return S2.create([this,t],this._def)}and(t){return C2.create(this,t,this._def)}transform(t){return new Am({...Nr(this._def),schema:this,typeName:tn.ZodEffects,effect:{type:"transform",transform:t}})}default(t){const n=typeof t=="function"?t:()=>t;return new R2({...Nr(this._def),innerType:this,defaultValue:n,typeName:tn.ZodDefault})}brand(){return new kG({typeName:tn.ZodBranded,type:this,...Nr(this._def)})}catch(t){const n=typeof t=="function"?t:()=>t;return new N2({...Nr(this._def),innerType:this,catchValue:n,typeName:tn.ZodCatch})}describe(t){const n=this.constructor;return new n({...this._def,description:t})}pipe(t){return sO.create(this,t)}readonly(){return M2.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const Xye=/^c[^\s-]{8,}$/i,Jye=/^[0-9a-z]+$/,Qye=/^[0-9A-HJKMNP-TV-Z]{26}$/i,ebe=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,tbe=/^[a-z0-9_-]{21}$/i,nbe=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,rbe=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,sbe=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,ibe="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let TN;const abe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,obe=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,lbe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,cbe=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,ube=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,dbe=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,_G="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",fbe=new RegExp(`^${_G}$`);function SG(e){let t="[0-5]\\d";e.precision?t=`${t}\\.\\d{${e.precision}}`:e.precision==null&&(t=`${t}(\\.\\d+)?`);const n=e.precision?"+":"?";return`([01]\\d|2[0-3]):[0-5]\\d(:${t})${n}`}function hbe(e){return new RegExp(`^${SG(e)}$`)}function pbe(e){let t=`${_G}T${SG(e)}`;const n=[];return n.push(e.local?"Z?":"Z"),e.offset&&n.push("([+-]\\d{2}:?\\d{2})"),t=`${t}(${n.join("|")})`,new RegExp(`^${t}$`)}function mbe(e,t){return!!((t==="v4"||!t)&&abe.test(e)||(t==="v6"||!t)&&lbe.test(e))}function gbe(e,t){if(!nbe.test(e))return!1;try{const[n]=e.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||"typ"in s&&(s==null?void 0:s.typ)!=="JWT"||!s.alg||t&&s.alg!==t)}catch{return!1}}function ybe(e,t){return!!((t==="v4"||!t)&&obe.test(e)||(t==="v6"||!t)&&cbe.test(e))}class Id extends Vr{_parse(t){if(this._def.coerce&&(t.data=String(t.data)),this._getType(t)!==vn.string){const i=this._getOrReturnCtx(t);return pn(i,{code:Jt.invalid_type,expected:vn.string,received:i.parsedType}),fr}const r=new fo;let s;for(const i of this._def.checks)if(i.kind==="min")t.data.length<i.value&&(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")t.data.length>i.value&&(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const a=t.data.length>i.value,o=t.data.length<i.value;(a||o)&&(s=this._getOrReturnCtx(t,s),a?pn(s,{code:Jt.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&pn(s,{code:Jt.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")sbe.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"email",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")TN||(TN=new RegExp(ibe,"u")),TN.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"emoji",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")ebe.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"uuid",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")tbe.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"nanoid",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")Xye.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"cuid",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")Jye.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"cuid2",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")Qye.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"ulid",code:Jt.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(t.data)}catch{s=this._getOrReturnCtx(t,s),pn(s,{validation:"url",code:Jt.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"regex",code:Jt.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?t.data=t.data.trim():i.kind==="includes"?t.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?t.data=t.data.toLowerCase():i.kind==="toUpperCase"?t.data=t.data.toUpperCase():i.kind==="startsWith"?t.data.startsWith(i.value)||(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?t.data.endsWith(i.value)||(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?pbe(i).test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?fbe.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?hbe(i).test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?rbe.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"duration",code:Jt.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?mbe(t.data,i.version)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"ip",code:Jt.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?gbe(t.data,i.alg)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"jwt",code:Jt.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?ybe(t.data,i.version)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"cidr",code:Jt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?ube.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"base64",code:Jt.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?dbe.test(t.data)||(s=this._getOrReturnCtx(t,s),pn(s,{validation:"base64url",code:Jt.invalid_string,message:i.message}),r.dirty()):es.assertNever(i);return{status:r.value,value:t.data}}_regex(t,n,r){return this.refinement(s=>t.test(s),{validation:n,code:Jt.invalid_string,...Rn.errToObj(r)})}_addCheck(t){return new Id({...this._def,checks:[...this._def.checks,t]})}email(t){return this._addCheck({kind:"email",...Rn.errToObj(t)})}url(t){return this._addCheck({kind:"url",...Rn.errToObj(t)})}emoji(t){return this._addCheck({kind:"emoji",...Rn.errToObj(t)})}uuid(t){return this._addCheck({kind:"uuid",...Rn.errToObj(t)})}nanoid(t){return this._addCheck({kind:"nanoid",...Rn.errToObj(t)})}cuid(t){return this._addCheck({kind:"cuid",...Rn.errToObj(t)})}cuid2(t){return this._addCheck({kind:"cuid2",...Rn.errToObj(t)})}ulid(t){return this._addCheck({kind:"ulid",...Rn.errToObj(t)})}base64(t){return this._addCheck({kind:"base64",...Rn.errToObj(t)})}base64url(t){return this._addCheck({kind:"base64url",...Rn.errToObj(t)})}jwt(t){return this._addCheck({kind:"jwt",...Rn.errToObj(t)})}ip(t){return this._addCheck({kind:"ip",...Rn.errToObj(t)})}cidr(t){return this._addCheck({kind:"cidr",...Rn.errToObj(t)})}datetime(t){return typeof t=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:t}):this._addCheck({kind:"datetime",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,offset:(t==null?void 0:t.offset)??!1,local:(t==null?void 0:t.local)??!1,...Rn.errToObj(t==null?void 0:t.message)})}date(t){return this._addCheck({kind:"date",message:t})}time(t){return typeof t=="string"?this._addCheck({kind:"time",precision:null,message:t}):this._addCheck({kind:"time",precision:typeof(t==null?void 0:t.precision)>"u"?null:t==null?void 0:t.precision,...Rn.errToObj(t==null?void 0:t.message)})}duration(t){return this._addCheck({kind:"duration",...Rn.errToObj(t)})}regex(t,n){return this._addCheck({kind:"regex",regex:t,...Rn.errToObj(n)})}includes(t,n){return this._addCheck({kind:"includes",value:t,position:n==null?void 0:n.position,...Rn.errToObj(n==null?void 0:n.message)})}startsWith(t,n){return this._addCheck({kind:"startsWith",value:t,...Rn.errToObj(n)})}endsWith(t,n){return this._addCheck({kind:"endsWith",value:t,...Rn.errToObj(n)})}min(t,n){return this._addCheck({kind:"min",value:t,...Rn.errToObj(n)})}max(t,n){return this._addCheck({kind:"max",value:t,...Rn.errToObj(n)})}length(t,n){return this._addCheck({kind:"length",value:t,...Rn.errToObj(n)})}nonempty(t){return this.min(1,Rn.errToObj(t))}trim(){return new Id({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Id({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Id({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(t=>t.kind==="datetime")}get isDate(){return!!this._def.checks.find(t=>t.kind==="date")}get isTime(){return!!this._def.checks.find(t=>t.kind==="time")}get isDuration(){return!!this._def.checks.find(t=>t.kind==="duration")}get isEmail(){return!!this._def.checks.find(t=>t.kind==="email")}get isURL(){return!!this._def.checks.find(t=>t.kind==="url")}get isEmoji(){return!!this._def.checks.find(t=>t.kind==="emoji")}get isUUID(){return!!this._def.checks.find(t=>t.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(t=>t.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(t=>t.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(t=>t.kind==="cuid2")}get isULID(){return!!this._def.checks.find(t=>t.kind==="ulid")}get isIP(){return!!this._def.checks.find(t=>t.kind==="ip")}get isCIDR(){return!!this._def.checks.find(t=>t.kind==="cidr")}get isBase64(){return!!this._def.checks.find(t=>t.kind==="base64")}get isBase64url(){return!!this._def.checks.find(t=>t.kind==="base64url")}get minLength(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxLength(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}Id.create=e=>new Id({checks:[],typeName:tn.ZodString,coerce:(e==null?void 0:e.coerce)??!1,...Nr(e)});function bbe(e,t){const n=(e.toString().split(".")[1]||"").length,r=(t.toString().split(".")[1]||"").length,s=n>r?n:r,i=Number.parseInt(e.toFixed(s).replace(".","")),a=Number.parseInt(t.toFixed(s).replace(".",""));return i%a/10**s}class oy extends Vr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(t){if(this._def.coerce&&(t.data=Number(t.data)),this._getType(t)!==vn.number){const i=this._getOrReturnCtx(t);return pn(i,{code:Jt.invalid_type,expected:vn.number,received:i.parsedType}),fr}let r;const s=new fo;for(const i of this._def.checks)i.kind==="int"?es.isInteger(t.data)||(r=this._getOrReturnCtx(t,r),pn(r,{code:Jt.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),pn(r,{code:Jt.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),pn(r,{code:Jt.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?bbe(t.data,i.value)!==0&&(r=this._getOrReturnCtx(t,r),pn(r,{code:Jt.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(t.data)||(r=this._getOrReturnCtx(t,r),pn(r,{code:Jt.not_finite,message:i.message}),s.dirty()):es.assertNever(i);return{status:s.value,value:t.data}}gte(t,n){return this.setLimit("min",t,!0,Rn.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Rn.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Rn.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Rn.toString(n))}setLimit(t,n,r,s){return new oy({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Rn.toString(s)}]})}_addCheck(t){return new oy({...this._def,checks:[...this._def.checks,t]})}int(t){return this._addCheck({kind:"int",message:Rn.toString(t)})}positive(t){return this._addCheck({kind:"min",value:0,inclusive:!1,message:Rn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:0,inclusive:!1,message:Rn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:0,inclusive:!0,message:Rn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:0,inclusive:!0,message:Rn.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Rn.toString(n)})}finite(t){return this._addCheck({kind:"finite",message:Rn.toString(t)})}safe(t){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:Rn.toString(t)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:Rn.toString(t)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}get isInt(){return!!this._def.checks.find(t=>t.kind==="int"||t.kind==="multipleOf"&&es.isInteger(t.value))}get isFinite(){let t=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(t===null||r.value<t)&&(t=r.value)}return Number.isFinite(n)&&Number.isFinite(t)}}oy.create=e=>new oy({checks:[],typeName:tn.ZodNumber,coerce:(e==null?void 0:e.coerce)||!1,...Nr(e)});class nw extends Vr{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(t){if(this._def.coerce)try{t.data=BigInt(t.data)}catch{return this._getInvalidInput(t)}if(this._getType(t)!==vn.bigint)return this._getInvalidInput(t);let r;const s=new fo;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?t.data<i.value:t.data<=i.value)&&(r=this._getOrReturnCtx(t,r),pn(r,{code:Jt.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?t.data>i.value:t.data>=i.value)&&(r=this._getOrReturnCtx(t,r),pn(r,{code:Jt.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?t.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(t,r),pn(r,{code:Jt.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):es.assertNever(i);return{status:s.value,value:t.data}}_getInvalidInput(t){const n=this._getOrReturnCtx(t);return pn(n,{code:Jt.invalid_type,expected:vn.bigint,received:n.parsedType}),fr}gte(t,n){return this.setLimit("min",t,!0,Rn.toString(n))}gt(t,n){return this.setLimit("min",t,!1,Rn.toString(n))}lte(t,n){return this.setLimit("max",t,!0,Rn.toString(n))}lt(t,n){return this.setLimit("max",t,!1,Rn.toString(n))}setLimit(t,n,r,s){return new nw({...this._def,checks:[...this._def.checks,{kind:t,value:n,inclusive:r,message:Rn.toString(s)}]})}_addCheck(t){return new nw({...this._def,checks:[...this._def.checks,t]})}positive(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:Rn.toString(t)})}negative(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:Rn.toString(t)})}nonpositive(t){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:Rn.toString(t)})}nonnegative(t){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:Rn.toString(t)})}multipleOf(t,n){return this._addCheck({kind:"multipleOf",value:t,message:Rn.toString(n)})}get minValue(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t}get maxValue(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t}}nw.create=e=>new nw({checks:[],typeName:tn.ZodBigInt,coerce:(e==null?void 0:e.coerce)??!1,...Nr(e)});class mj extends Vr{_parse(t){if(this._def.coerce&&(t.data=!!t.data),this._getType(t)!==vn.boolean){const r=this._getOrReturnCtx(t);return pn(r,{code:Jt.invalid_type,expected:vn.boolean,received:r.parsedType}),fr}return ec(t.data)}}mj.create=e=>new mj({typeName:tn.ZodBoolean,coerce:(e==null?void 0:e.coerce)||!1,...Nr(e)});class rw extends Vr{_parse(t){if(this._def.coerce&&(t.data=new Date(t.data)),this._getType(t)!==vn.date){const i=this._getOrReturnCtx(t);return pn(i,{code:Jt.invalid_type,expected:vn.date,received:i.parsedType}),fr}if(Number.isNaN(t.data.getTime())){const i=this._getOrReturnCtx(t);return pn(i,{code:Jt.invalid_date}),fr}const r=new fo;let s;for(const i of this._def.checks)i.kind==="min"?t.data.getTime()<i.value&&(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?t.data.getTime()>i.value&&(s=this._getOrReturnCtx(t,s),pn(s,{code:Jt.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):es.assertNever(i);return{status:r.value,value:new Date(t.data.getTime())}}_addCheck(t){return new rw({...this._def,checks:[...this._def.checks,t]})}min(t,n){return this._addCheck({kind:"min",value:t.getTime(),message:Rn.toString(n)})}max(t,n){return this._addCheck({kind:"max",value:t.getTime(),message:Rn.toString(n)})}get minDate(){let t=null;for(const n of this._def.checks)n.kind==="min"&&(t===null||n.value>t)&&(t=n.value);return t!=null?new Date(t):null}get maxDate(){let t=null;for(const n of this._def.checks)n.kind==="max"&&(t===null||n.value<t)&&(t=n.value);return t!=null?new Date(t):null}}rw.create=e=>new rw({checks:[],coerce:(e==null?void 0:e.coerce)||!1,typeName:tn.ZodDate,...Nr(e)});class QB extends Vr{_parse(t){if(this._getType(t)!==vn.symbol){const r=this._getOrReturnCtx(t);return pn(r,{code:Jt.invalid_type,expected:vn.symbol,received:r.parsedType}),fr}return ec(t.data)}}QB.create=e=>new QB({typeName:tn.ZodSymbol,...Nr(e)});class gj extends Vr{_parse(t){if(this._getType(t)!==vn.undefined){const r=this._getOrReturnCtx(t);return pn(r,{code:Jt.invalid_type,expected:vn.undefined,received:r.parsedType}),fr}return ec(t.data)}}gj.create=e=>new gj({typeName:tn.ZodUndefined,...Nr(e)});class _2 extends Vr{_parse(t){if(this._getType(t)!==vn.null){const r=this._getOrReturnCtx(t);return pn(r,{code:Jt.invalid_type,expected:vn.null,received:r.parsedType}),fr}return ec(t.data)}}_2.create=e=>new _2({typeName:tn.ZodNull,...Nr(e)});class sw extends Vr{constructor(){super(...arguments),this._any=!0}_parse(t){return ec(t.data)}}sw.create=e=>new sw({typeName:tn.ZodAny,...Nr(e)});class yj extends Vr{constructor(){super(...arguments),this._unknown=!0}_parse(t){return ec(t.data)}}yj.create=e=>new yj({typeName:tn.ZodUnknown,...Nr(e)});class Mh extends Vr{_parse(t){const n=this._getOrReturnCtx(t);return pn(n,{code:Jt.invalid_type,expected:vn.never,received:n.parsedType}),fr}}Mh.create=e=>new Mh({typeName:tn.ZodNever,...Nr(e)});class e$ extends Vr{_parse(t){if(this._getType(t)!==vn.undefined){const r=this._getOrReturnCtx(t);return pn(r,{code:Jt.invalid_type,expected:vn.void,received:r.parsedType}),fr}return ec(t.data)}}e$.create=e=>new e$({typeName:tn.ZodVoid,...Nr(e)});class ku extends Vr{_parse(t){const{ctx:n,status:r}=this._processInputParams(t),s=this._def;if(n.parsedType!==vn.array)return pn(n,{code:Jt.invalid_type,expected:vn.array,received:n.parsedType}),fr;if(s.exactLength!==null){const a=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(a||o)&&(pn(n,{code:a?Jt.too_big:Jt.too_small,minimum:o?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(pn(n,{code:Jt.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(pn(n,{code:Jt.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,o)=>s.type._parseAsync(new Ou(n,a,n.path,o)))).then(a=>fo.mergeArray(r,a));const i=[...n.data].map((a,o)=>s.type._parseSync(new Ou(n,a,n.path,o)));return fo.mergeArray(r,i)}get element(){return this._def.type}min(t,n){return new ku({...this._def,minLength:{value:t,message:Rn.toString(n)}})}max(t,n){return new ku({...this._def,maxLength:{value:t,message:Rn.toString(n)}})}length(t,n){return new ku({...this._def,exactLength:{value:t,message:Rn.toString(n)}})}nonempty(t){return this.min(1,t)}}ku.create=(e,t)=>new ku({type:e,minLength:null,maxLength:null,exactLength:null,typeName:tn.ZodArray,...Nr(t)});function m0(e){if(e instanceof Ri){const t={};for(const n in e.shape){const r=e.shape[n];t[n]=Eu.create(m0(r))}return new Ri({...e._def,shape:()=>t})}else return e instanceof ku?new ku({...e._def,type:m0(e.element)}):e instanceof Eu?Eu.create(m0(e.unwrap())):e instanceof Rm?Rm.create(m0(e.unwrap())):e instanceof Em?Em.create(e.items.map(t=>m0(t))):e}class Ri extends Vr{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const t=this._def.shape(),n=es.objectKeys(t);return this._cached={shape:t,keys:n},this._cached}_parse(t){if(this._getType(t)!==vn.object){const c=this._getOrReturnCtx(t);return pn(c,{code:Jt.invalid_type,expected:vn.object,received:c.parsedType}),fr}const{status:r,ctx:s}=this._processInputParams(t),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof Mh&&this._def.unknownKeys==="strip"))for(const c in s.data)a.includes(c)||o.push(c);const l=[];for(const c of a){const u=i[c],d=s.data[c];l.push({key:{status:"valid",value:c},value:u._parse(new Ou(s,d,s.path,c)),alwaysSet:c in s.data})}if(this._def.catchall instanceof Mh){const c=this._def.unknownKeys;if(c==="passthrough")for(const u of o)l.push({key:{status:"valid",value:u},value:{status:"valid",value:s.data[u]}});else if(c==="strict")o.length>0&&(pn(s,{code:Jt.unrecognized_keys,keys:o}),r.dirty());else if(c!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const c=this._def.catchall;for(const u of o){const d=s.data[u];l.push({key:{status:"valid",value:u},value:c._parse(new Ou(s,d,s.path,u)),alwaysSet:u in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const c=[];for(const u of l){const d=await u.key,h=await u.value;c.push({key:d,value:h,alwaysSet:u.alwaysSet})}return c}).then(c=>fo.mergeObjectSync(r,c)):fo.mergeObjectSync(r,l)}get shape(){return this._def.shape()}strict(t){return Rn.errToObj,new Ri({...this._def,unknownKeys:"strict",...t!==void 0?{errorMap:(n,r)=>{var i,a;const s=((a=(i=this._def).errorMap)==null?void 0:a.call(i,n,r).message)??r.defaultError;return n.code==="unrecognized_keys"?{message:Rn.errToObj(t).message??s}:{message:s}}}:{}})}strip(){return new Ri({...this._def,unknownKeys:"strip"})}passthrough(){return new Ri({...this._def,unknownKeys:"passthrough"})}extend(t){return new Ri({...this._def,shape:()=>({...this._def.shape(),...t})})}merge(t){return new Ri({unknownKeys:t._def.unknownKeys,catchall:t._def.catchall,shape:()=>({...this._def.shape(),...t._def.shape()}),typeName:tn.ZodObject})}setKey(t,n){return this.augment({[t]:n})}catchall(t){return new Ri({...this._def,catchall:t})}pick(t){const n={};for(const r of es.objectKeys(t))t[r]&&this.shape[r]&&(n[r]=this.shape[r]);return new Ri({...this._def,shape:()=>n})}omit(t){const n={};for(const r of es.objectKeys(this.shape))t[r]||(n[r]=this.shape[r]);return new Ri({...this._def,shape:()=>n})}deepPartial(){return m0(this)}partial(t){const n={};for(const r of es.objectKeys(this.shape)){const s=this.shape[r];t&&!t[r]?n[r]=s:n[r]=s.optional()}return new Ri({...this._def,shape:()=>n})}required(t){const n={};for(const r of es.objectKeys(this.shape))if(t&&!t[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Eu;)i=i._def.innerType;n[r]=i}return new Ri({...this._def,shape:()=>n})}keyof(){return CG(es.objectKeys(this.shape))}}Ri.create=(e,t)=>new Ri({shape:()=>e,unknownKeys:"strip",catchall:Mh.create(),typeName:tn.ZodObject,...Nr(t)});Ri.strictCreate=(e,t)=>new Ri({shape:()=>e,unknownKeys:"strict",catchall:Mh.create(),typeName:tn.ZodObject,...Nr(t)});Ri.lazycreate=(e,t)=>new Ri({shape:e,unknownKeys:"strip",catchall:Mh.create(),typeName:tn.ZodObject,...Nr(t)});class S2 extends Vr{_parse(t){const{ctx:n}=this._processInputParams(t),r=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new Oc(o.ctx.common.issues));return pn(n,{code:Jt.invalid_union,unionErrors:a}),fr}if(n.common.async)return Promise.all(r.map(async i=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const l of r){const c={...n,common:{...n.common,issues:[]},parent:null},u=l._parseSync({data:n.data,path:n.path,parent:c});if(u.status==="valid")return u;u.status==="dirty"&&!i&&(i={result:u,ctx:c}),c.common.issues.length&&a.push(c.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(l=>new Oc(l));return pn(n,{code:Jt.invalid_union,unionErrors:o}),fr}}get options(){return this._def.options}}S2.create=(e,t)=>new S2({options:e,typeName:tn.ZodUnion,...Nr(t)});const Cd=e=>e instanceof E2?Cd(e.schema):e instanceof Am?Cd(e.innerType()):e instanceof T2?[e.value]:e instanceof Tm?e.options:e instanceof vj?es.objectValues(e.enum):e instanceof R2?Cd(e._def.innerType):e instanceof gj?[void 0]:e instanceof _2?[null]:e instanceof Eu?[void 0,...Cd(e.unwrap())]:e instanceof Rm?[null,...Cd(e.unwrap())]:e instanceof kG||e instanceof M2?Cd(e.unwrap()):e instanceof N2?Cd(e._def.innerType):[];class rO extends Vr{_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==vn.object)return pn(n,{code:Jt.invalid_type,expected:vn.object,received:n.parsedType}),fr;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(pn(n,{code:Jt.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),fr)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(t,n,r){const s=new Map;for(const i of n){const a=Cd(i.shape[t]);if(!a.length)throw new Error(`A discriminator value for key \`${t}\` could not be extracted from all schema options`);for(const o of a){if(s.has(o))throw new Error(`Discriminator property ${String(t)} has duplicate value ${String(o)}`);s.set(o,i)}}return new rO({typeName:tn.ZodDiscriminatedUnion,discriminator:t,options:n,optionsMap:s,...Nr(r)})}}function bj(e,t){const n=ph(e),r=ph(t);if(e===t)return{valid:!0,data:e};if(n===vn.object&&r===vn.object){const s=es.objectKeys(t),i=es.objectKeys(e).filter(o=>s.indexOf(o)!==-1),a={...e,...t};for(const o of i){const l=bj(e[o],t[o]);if(!l.valid)return{valid:!1};a[o]=l.data}return{valid:!0,data:a}}else if(n===vn.array&&r===vn.array){if(e.length!==t.length)return{valid:!1};const s=[];for(let i=0;i<e.length;i++){const a=e[i],o=t[i],l=bj(a,o);if(!l.valid)return{valid:!1};s.push(l.data)}return{valid:!0,data:s}}else return n===vn.date&&r===vn.date&&+e==+t?{valid:!0,data:e}:{valid:!1}}class C2 extends Vr{_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=(i,a)=>{if(ZB(i)||ZB(a))return fr;const o=bj(i.value,a.value);return o.valid?((XB(i)||XB(a))&&n.dirty(),{status:n.value,value:o.data}):(pn(r,{code:Jt.invalid_intersection_types}),fr)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}C2.create=(e,t,n)=>new C2({left:e,right:t,typeName:tn.ZodIntersection,...Nr(n)});class Em extends Vr{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==vn.array)return pn(r,{code:Jt.invalid_type,expected:vn.array,received:r.parsedType}),fr;if(r.data.length<this._def.items.length)return pn(r,{code:Jt.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),fr;!this._def.rest&&r.data.length>this._def.items.length&&(pn(r,{code:Jt.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((a,o)=>{const l=this._def.items[o]||this._def.rest;return l?l._parse(new Ou(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(i).then(a=>fo.mergeArray(n,a)):fo.mergeArray(n,i)}get items(){return this._def.items}rest(t){return new Em({...this._def,rest:t})}}Em.create=(e,t)=>{if(!Array.isArray(e))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Em({items:e,typeName:tn.ZodTuple,rest:null,...Nr(t)})};class k2 extends Vr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==vn.object)return pn(r,{code:Jt.invalid_type,expected:vn.object,received:r.parsedType}),fr;const s=[],i=this._def.keyType,a=this._def.valueType;for(const o in r.data)s.push({key:i._parse(new Ou(r,o,r.path,o)),value:a._parse(new Ou(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?fo.mergeObjectAsync(n,s):fo.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(t,n,r){return n instanceof Vr?new k2({keyType:t,valueType:n,typeName:tn.ZodRecord,...Nr(r)}):new k2({keyType:Id.create(),valueType:t,typeName:tn.ZodRecord,...Nr(n)})}}class t$ extends Vr{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==vn.map)return pn(r,{code:Jt.invalid_type,expected:vn.map,received:r.parsedType}),fr;const s=this._def.keyType,i=this._def.valueType,a=[...r.data.entries()].map(([o,l],c)=>({key:s._parse(new Ou(r,o,r.path,[c,"key"])),value:i._parse(new Ou(r,l,r.path,[c,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const l of a){const c=await l.key,u=await l.value;if(c.status==="aborted"||u.status==="aborted")return fr;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const l of a){const c=l.key,u=l.value;if(c.status==="aborted"||u.status==="aborted")return fr;(c.status==="dirty"||u.status==="dirty")&&n.dirty(),o.set(c.value,u.value)}return{status:n.value,value:o}}}}t$.create=(e,t,n)=>new t$({valueType:t,keyType:e,typeName:tn.ZodMap,...Nr(n)});class iw extends Vr{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.parsedType!==vn.set)return pn(r,{code:Jt.invalid_type,expected:vn.set,received:r.parsedType}),fr;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(pn(r,{code:Jt.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(pn(r,{code:Jt.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function a(l){const c=new Set;for(const u of l){if(u.status==="aborted")return fr;u.status==="dirty"&&n.dirty(),c.add(u.value)}return{status:n.value,value:c}}const o=[...r.data.values()].map((l,c)=>i._parse(new Ou(r,l,r.path,c)));return r.common.async?Promise.all(o).then(l=>a(l)):a(o)}min(t,n){return new iw({...this._def,minSize:{value:t,message:Rn.toString(n)}})}max(t,n){return new iw({...this._def,maxSize:{value:t,message:Rn.toString(n)}})}size(t,n){return this.min(t,n).max(t,n)}nonempty(t){return this.min(1,t)}}iw.create=(e,t)=>new iw({valueType:e,minSize:null,maxSize:null,typeName:tn.ZodSet,...Nr(t)});class E2 extends Vr{get schema(){return this._def.getter()}_parse(t){const{ctx:n}=this._processInputParams(t);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}E2.create=(e,t)=>new E2({getter:e,typeName:tn.ZodLazy,...Nr(t)});class T2 extends Vr{_parse(t){if(t.data!==this._def.value){const n=this._getOrReturnCtx(t);return pn(n,{received:n.data,code:Jt.invalid_literal,expected:this._def.value}),fr}return{status:"valid",value:t.data}}get value(){return this._def.value}}T2.create=(e,t)=>new T2({value:e,typeName:tn.ZodLiteral,...Nr(t)});function CG(e,t){return new Tm({values:e,typeName:tn.ZodEnum,...Nr(t)})}class Tm extends Vr{_parse(t){if(typeof t.data!="string"){const n=this._getOrReturnCtx(t),r=this._def.values;return pn(n,{expected:es.joinValues(r),received:n.parsedType,code:Jt.invalid_type}),fr}if(this._cache||(this._cache=new Set(this._def.values)),!this._cache.has(t.data)){const n=this._getOrReturnCtx(t),r=this._def.values;return pn(n,{received:n.data,code:Jt.invalid_enum_value,options:r}),fr}return ec(t.data)}get options(){return this._def.values}get enum(){const t={};for(const n of this._def.values)t[n]=n;return t}get Values(){const t={};for(const n of this._def.values)t[n]=n;return t}get Enum(){const t={};for(const n of this._def.values)t[n]=n;return t}extract(t,n=this._def){return Tm.create(t,{...this._def,...n})}exclude(t,n=this._def){return Tm.create(this.options.filter(r=>!t.includes(r)),{...this._def,...n})}}Tm.create=CG;class vj extends Vr{_parse(t){const n=es.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(t);if(r.parsedType!==vn.string&&r.parsedType!==vn.number){const s=es.objectValues(n);return pn(r,{expected:es.joinValues(s),received:r.parsedType,code:Jt.invalid_type}),fr}if(this._cache||(this._cache=new Set(es.getValidEnumValues(this._def.values))),!this._cache.has(t.data)){const s=es.objectValues(n);return pn(r,{received:r.data,code:Jt.invalid_enum_value,options:s}),fr}return ec(t.data)}get enum(){return this._def.values}}vj.create=(e,t)=>new vj({values:e,typeName:tn.ZodNativeEnum,...Nr(t)});class A2 extends Vr{unwrap(){return this._def.type}_parse(t){const{ctx:n}=this._processInputParams(t);if(n.parsedType!==vn.promise&&n.common.async===!1)return pn(n,{code:Jt.invalid_type,expected:vn.promise,received:n.parsedType}),fr;const r=n.parsedType===vn.promise?n.data:Promise.resolve(n.data);return ec(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}A2.create=(e,t)=>new A2({type:e,typeName:tn.ZodPromise,...Nr(t)});class Am extends Vr{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===tn.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(t){const{status:n,ctx:r}=this._processInputParams(t),s=this._def.effect||null,i={addIssue:a=>{pn(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(r.data,i);if(r.common.async)return Promise.resolve(a).then(async o=>{if(n.value==="aborted")return fr;const l=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return l.status==="aborted"?fr:l.status==="dirty"||n.value==="dirty"?lx(l.value):l});{if(n.value==="aborted")return fr;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?fr:o.status==="dirty"||n.value==="dirty"?lx(o.value):o}}if(s.type==="refinement"){const a=o=>{const l=s.refinement(o,i);if(r.common.async)return Promise.resolve(l);if(l instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?fr:(o.status==="dirty"&&n.dirty(),a(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?fr:(o.status==="dirty"&&n.dirty(),a(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!ay(a))return fr;const o=s.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>ay(a)?Promise.resolve(s.transform(a.value,i)).then(o=>({status:n.value,value:o})):fr);es.assertNever(s)}}Am.create=(e,t,n)=>new Am({schema:e,typeName:tn.ZodEffects,effect:t,...Nr(n)});Am.createWithPreprocess=(e,t,n)=>new Am({schema:t,effect:{type:"preprocess",transform:e},typeName:tn.ZodEffects,...Nr(n)});class Eu extends Vr{_parse(t){return this._getType(t)===vn.undefined?ec(void 0):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Eu.create=(e,t)=>new Eu({innerType:e,typeName:tn.ZodOptional,...Nr(t)});class Rm extends Vr{_parse(t){return this._getType(t)===vn.null?ec(null):this._def.innerType._parse(t)}unwrap(){return this._def.innerType}}Rm.create=(e,t)=>new Rm({innerType:e,typeName:tn.ZodNullable,...Nr(t)});class R2 extends Vr{_parse(t){const{ctx:n}=this._processInputParams(t);let r=n.data;return n.parsedType===vn.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}R2.create=(e,t)=>new R2({innerType:e,typeName:tn.ZodDefault,defaultValue:typeof t.default=="function"?t.default:()=>t.default,...Nr(t)});class N2 extends Vr{_parse(t){const{ctx:n}=this._processInputParams(t),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return w2(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new Oc(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new Oc(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}N2.create=(e,t)=>new N2({innerType:e,typeName:tn.ZodCatch,catchValue:typeof t.catch=="function"?t.catch:()=>t.catch,...Nr(t)});class n$ extends Vr{_parse(t){if(this._getType(t)!==vn.nan){const r=this._getOrReturnCtx(t);return pn(r,{code:Jt.invalid_type,expected:vn.nan,received:r.parsedType}),fr}return{status:"valid",value:t.data}}}n$.create=e=>new n$({typeName:tn.ZodNaN,...Nr(e)});class kG extends Vr{_parse(t){const{ctx:n}=this._processInputParams(t),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class sO extends Vr{_parse(t){const{status:n,ctx:r}=this._processInputParams(t);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?fr:i.status==="dirty"?(n.dirty(),lx(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?fr:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(t,n){return new sO({in:t,out:n,typeName:tn.ZodPipeline})}}class M2 extends Vr{_parse(t){const n=this._def.innerType._parse(t),r=s=>(ay(s)&&(s.value=Object.freeze(s.value)),s);return w2(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}M2.create=(e,t)=>new M2({innerType:e,typeName:tn.ZodReadonly,...Nr(t)});function r$(e,t){const n=typeof e=="function"?e(t):typeof e=="string"?{message:e}:e;return typeof n=="string"?{message:n}:n}function EG(e,t={},n){return e?sw.create().superRefine((r,s)=>{const i=e(r);if(i instanceof Promise)return i.then(a=>{if(!a){const o=r$(t,r),l=o.fatal??n??!0;s.addIssue({code:"custom",...o,fatal:l})}});if(!i){const a=r$(t,r),o=a.fatal??n??!0;s.addIssue({code:"custom",...a,fatal:o})}}):sw.create()}var tn;(function(e){e.ZodString="ZodString",e.ZodNumber="ZodNumber",e.ZodNaN="ZodNaN",e.ZodBigInt="ZodBigInt",e.ZodBoolean="ZodBoolean",e.ZodDate="ZodDate",e.ZodSymbol="ZodSymbol",e.ZodUndefined="ZodUndefined",e.ZodNull="ZodNull",e.ZodAny="ZodAny",e.ZodUnknown="ZodUnknown",e.ZodNever="ZodNever",e.ZodVoid="ZodVoid",e.ZodArray="ZodArray",e.ZodObject="ZodObject",e.ZodUnion="ZodUnion",e.ZodDiscriminatedUnion="ZodDiscriminatedUnion",e.ZodIntersection="ZodIntersection",e.ZodTuple="ZodTuple",e.ZodRecord="ZodRecord",e.ZodMap="ZodMap",e.ZodSet="ZodSet",e.ZodFunction="ZodFunction",e.ZodLazy="ZodLazy",e.ZodLiteral="ZodLiteral",e.ZodEnum="ZodEnum",e.ZodEffects="ZodEffects",e.ZodNativeEnum="ZodNativeEnum",e.ZodOptional="ZodOptional",e.ZodNullable="ZodNullable",e.ZodDefault="ZodDefault",e.ZodCatch="ZodCatch",e.ZodPromise="ZodPromise",e.ZodBranded="ZodBranded",e.ZodPipeline="ZodPipeline",e.ZodReadonly="ZodReadonly"})(tn||(tn={}));const I2=(e,t={message:`Input not instance of ${e.name}`})=>EG(n=>n instanceof e,t),$e=Id.create,At=oy.create,Zn=mj.create,vbe=rw.create,xbe=_2.create,Gd=sw.create,Yy=yj.create;Mh.create;const ln=ku.create,Ke=Ri.create,ms=S2.create,jE=rO.create;C2.create;Em.create;const Ih=k2.create,wbe=E2.create,Mn=T2.create,vl=Tm.create;A2.create;const ia=Eu.create;Rm.create;function _be({prompt:e,useLegacyFunctionCalling:t=!1,systemMessageMode:n="system"}){const r=[],s=[];for(const{role:i,content:a}of e)switch(i){case"system":{switch(n){case"system":{r.push({role:"system",content:a});break}case"developer":{r.push({role:"developer",content:a});break}case"remove":{s.push({type:"other",message:"system messages are removed for this model"});break}default:{const o=n;throw new Error(`Unsupported system message mode: ${o}`)}}break}case"user":{if(a.length===1&&a[0].type==="text"){r.push({role:"user",content:a[0].text});break}r.push({role:"user",content:a.map((o,l)=>{var c,u,d,h;switch(o.type){case"text":return{type:"text",text:o.text};case"image":return{type:"image_url",image_url:{url:o.image instanceof URL?o.image.toString():`data:${(c=o.mimeType)!=null?c:"image/jpeg"};base64,${Pu(o.image)}`,detail:(d=(u=o.providerMetadata)==null?void 0:u.openai)==null?void 0:d.imageDetail}};case"file":{if(o.data instanceof URL)throw new gr({functionality:"'File content parts with URL data' functionality not supported."});switch(o.mimeType){case"audio/wav":return{type:"input_audio",input_audio:{data:o.data,format:"wav"}};case"audio/mp3":case"audio/mpeg":return{type:"input_audio",input_audio:{data:o.data,format:"mp3"}};case"application/pdf":return{type:"file",file:{filename:(h=o.filename)!=null?h:`part-${l}.pdf`,file_data:`data:application/pdf;base64,${o.data}`}};default:throw new gr({functionality:`File content part type ${o.mimeType} in user messages`})}}}})});break}case"assistant":{let o="";const l=[];for(const c of a)switch(c.type){case"text":{o+=c.text;break}case"tool-call":{l.push({id:c.toolCallId,type:"function",function:{name:c.toolName,arguments:JSON.stringify(c.args)}});break}}if(t){if(l.length>1)throw new gr({functionality:"useLegacyFunctionCalling with multiple tool calls in one message"});r.push({role:"assistant",content:o,function_call:l.length>0?l[0].function:void 0})}else r.push({role:"assistant",content:o,tool_calls:l.length>0?l:void 0});break}case"tool":{for(const o of a)t?r.push({role:"function",name:o.toolName,content:JSON.stringify(o.result)}):r.push({role:"tool",tool_call_id:o.toolCallId,content:JSON.stringify(o.result)});break}default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return{messages:r,warnings:s}}function s$(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:s,top_logprobs:i})=>({token:r,logprob:s,topLogprobs:i?i.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function j2(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var iO=Ke({error:Ke({message:$e(),type:$e().nullish(),param:Gd().nullish(),code:ms([$e(),At()]).nullish()})}),Du=Jh({errorSchema:iO,errorToMessage:e=>e.error.message});function P2({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function Sbe({mode:e,useLegacyFunctionCalling:t=!1,structuredOutputs:n}){var r;const s=(r=e.tools)!=null&&r.length?e.tools:void 0,i=[];if(s==null)return{tools:void 0,tool_choice:void 0,toolWarnings:i};const a=e.toolChoice;if(t){const c=[];for(const d of s)d.type==="provider-defined"?i.push({type:"unsupported-tool",tool:d}):c.push({name:d.name,description:d.description,parameters:d.parameters});if(a==null)return{functions:c,function_call:void 0,toolWarnings:i};switch(a.type){case"auto":case"none":case void 0:return{functions:c,function_call:void 0,toolWarnings:i};case"required":throw new gr({functionality:"useLegacyFunctionCalling and toolChoice: required"});default:return{functions:c,function_call:{name:a.toolName},toolWarnings:i}}}const o=[];for(const c of s)c.type==="provider-defined"?i.push({type:"unsupported-tool",tool:c}):o.push({type:"function",function:{name:c.name,description:c.description,parameters:c.parameters,strict:n?!0:void 0}});if(a==null)return{tools:o,tool_choice:void 0,toolWarnings:i};const l=a.type;switch(l){case"auto":case"none":case"required":return{tools:o,tool_choice:l,toolWarnings:i};case"tool":return{tools:o,tool_choice:{type:"function",function:{name:a.toolName}},toolWarnings:i};default:{const c=l;throw new gr({functionality:`Unsupported tool choice type: ${c}`})}}}var Cbe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:xj(this.modelId)}get defaultObjectGenerationMode(){return Tbe(this.modelId)?"tool":this.supportsStructuredOutputs?"json":"tool"}get provider(){return this.config.provider}get supportsImageUrls(){return!this.settings.downloadImages}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,m,y,b,v,x,w,S;const k=e.type,C=[];i!=null&&C.push({type:"unsupported-setting",setting:"topK"}),(c==null?void 0:c.type)==="json"&&c.schema!=null&&!this.supportsStructuredOutputs&&C.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const T=this.settings.useLegacyFunctionCalling;if(T&&this.settings.parallelToolCalls===!0)throw new gr({functionality:"useLegacyFunctionCalling with parallelToolCalls"});if(T&&this.supportsStructuredOutputs)throw new gr({functionality:"structuredOutputs with useLegacyFunctionCalling"});const{messages:A,warnings:N}=_be({prompt:t,useLegacyFunctionCalling:T,systemMessageMode:Abe(this.modelId)});C.push(...N);const I={model:this.modelId,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:s,frequency_penalty:a,presence_penalty:o,response_format:(c==null?void 0:c.type)==="json"?this.supportsStructuredOutputs&&c.schema!=null?{type:"json_schema",json_schema:{schema:c.schema,strict:!0,name:(h=c.name)!=null?h:"response",description:c.description}}:{type:"json_object"}:void 0,stop:l,seed:u,max_completion_tokens:(m=d==null?void 0:d.openai)==null?void 0:m.maxCompletionTokens,store:(y=d==null?void 0:d.openai)==null?void 0:y.store,metadata:(b=d==null?void 0:d.openai)==null?void 0:b.metadata,prediction:(v=d==null?void 0:d.openai)==null?void 0:v.prediction,reasoning_effort:(w=(x=d==null?void 0:d.openai)==null?void 0:x.reasoningEffort)!=null?w:this.settings.reasoningEffort,messages:A};switch(xj(this.modelId)?(I.temperature!=null&&(I.temperature=void 0,C.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),I.top_p!=null&&(I.top_p=void 0,C.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"})),I.frequency_penalty!=null&&(I.frequency_penalty=void 0,C.push({type:"unsupported-setting",setting:"frequencyPenalty",details:"frequencyPenalty is not supported for reasoning models"})),I.presence_penalty!=null&&(I.presence_penalty=void 0,C.push({type:"unsupported-setting",setting:"presencePenalty",details:"presencePenalty is not supported for reasoning models"})),I.logit_bias!=null&&(I.logit_bias=void 0,C.push({type:"other",message:"logitBias is not supported for reasoning models"})),I.logprobs!=null&&(I.logprobs=void 0,C.push({type:"other",message:"logprobs is not supported for reasoning models"})),I.top_logprobs!=null&&(I.top_logprobs=void 0,C.push({type:"other",message:"topLogprobs is not supported for reasoning models"})),I.max_tokens!=null&&(I.max_completion_tokens==null&&(I.max_completion_tokens=I.max_tokens),I.max_tokens=void 0)):(this.modelId.startsWith("gpt-4o-search-preview")||this.modelId.startsWith("gpt-4o-mini-search-preview"))&&I.temperature!=null&&(I.temperature=void 0,C.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for the search preview models and has been removed."})),k){case"regular":{const{tools:O,tool_choice:B,functions:D,function_call:H,toolWarnings:P}=Sbe({mode:e,useLegacyFunctionCalling:T,structuredOutputs:this.supportsStructuredOutputs});return{args:{...I,tools:O,tool_choice:B,functions:D,function_call:H},warnings:[...C,...P]}}case"object-json":return{args:{...I,response_format:this.supportsStructuredOutputs&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,strict:!0,name:(S=e.name)!=null?S:"response",description:e.description}}:{type:"json_object"}},warnings:C};case"object-tool":return{args:T?{...I,function_call:{name:e.tool.name},functions:[{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}]}:{...I,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:this.supportsStructuredOutputs?!0:void 0}}]},warnings:C};default:{const O=k;throw new Error(`Unsupported type: ${O}`)}}}async doGenerate(e){var t,n,r,s,i,a,o,l;const{args:c,warnings:u}=this.getArgs(e),{responseHeaders:d,value:h,rawValue:m}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:c,failedResponseHandler:Du,successfulResponseHandler:Va(kbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:y,...b}=c,v=h.choices[0],x=(t=h.usage)==null?void 0:t.completion_tokens_details,w=(n=h.usage)==null?void 0:n.prompt_tokens_details,S={openai:{}};return(x==null?void 0:x.reasoning_tokens)!=null&&(S.openai.reasoningTokens=x==null?void 0:x.reasoning_tokens),(x==null?void 0:x.accepted_prediction_tokens)!=null&&(S.openai.acceptedPredictionTokens=x==null?void 0:x.accepted_prediction_tokens),(x==null?void 0:x.rejected_prediction_tokens)!=null&&(S.openai.rejectedPredictionTokens=x==null?void 0:x.rejected_prediction_tokens),(w==null?void 0:w.cached_tokens)!=null&&(S.openai.cachedPromptTokens=w==null?void 0:w.cached_tokens),{text:(r=v.message.content)!=null?r:void 0,toolCalls:this.settings.useLegacyFunctionCalling&&v.message.function_call?[{toolCallType:"function",toolCallId:oa(),toolName:v.message.function_call.name,args:v.message.function_call.arguments}]:(s=v.message.tool_calls)==null?void 0:s.map(k=>{var C;return{toolCallType:"function",toolCallId:(C=k.id)!=null?C:oa(),toolName:k.function.name,args:k.function.arguments}}),finishReason:j2(v.finish_reason),usage:{promptTokens:(a=(i=h.usage)==null?void 0:i.prompt_tokens)!=null?a:NaN,completionTokens:(l=(o=h.usage)==null?void 0:o.completion_tokens)!=null?l:NaN},rawCall:{rawPrompt:y,rawSettings:b},rawResponse:{headers:d,body:m},request:{body:JSON.stringify(c)},response:P2(h),warnings:u,logprobs:s$(v.logprobs),providerMetadata:S}}async doStream(e){if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...b.response}),b.text&&x.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const w of b.toolCalls)x.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:w.toolCallId,toolName:w.toolName,argsTextDelta:w.args}),x.enqueue({type:"tool-call",...w});x.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),x.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:r,failedResponseHandler:Du,successfulResponseHandler:Qh(Ebe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:a,...o}=t,l=[];let c="unknown",u={promptTokens:void 0,completionTokens:void 0},d,h=!0;const{useLegacyFunctionCalling:m}=this.settings,y={openai:{}};return{stream:i.pipeThrough(new TransformStream({transform(b,v){var x,w,S,k,C,T,A,N,I,O,B,D;if(!b.success){c="error",v.enqueue({type:"error",error:b.error});return}const H=b.value;if("error"in H){c="error",v.enqueue({type:"error",error:H.error});return}if(h&&(h=!1,v.enqueue({type:"response-metadata",...P2(H)})),H.usage!=null){const{prompt_tokens:L,completion_tokens:te,prompt_tokens_details:W,completion_tokens_details:Q}=H.usage;u={promptTokens:L??void 0,completionTokens:te??void 0},(Q==null?void 0:Q.reasoning_tokens)!=null&&(y.openai.reasoningTokens=Q==null?void 0:Q.reasoning_tokens),(Q==null?void 0:Q.accepted_prediction_tokens)!=null&&(y.openai.acceptedPredictionTokens=Q==null?void 0:Q.accepted_prediction_tokens),(Q==null?void 0:Q.rejected_prediction_tokens)!=null&&(y.openai.rejectedPredictionTokens=Q==null?void 0:Q.rejected_prediction_tokens),(W==null?void 0:W.cached_tokens)!=null&&(y.openai.cachedPromptTokens=W==null?void 0:W.cached_tokens)}const P=H.choices[0];if((P==null?void 0:P.finish_reason)!=null&&(c=j2(P.finish_reason)),(P==null?void 0:P.delta)==null)return;const K=P.delta;K.content!=null&&v.enqueue({type:"text-delta",textDelta:K.content});const U=s$(P==null?void 0:P.logprobs);U!=null&&U.length&&(d===void 0&&(d=[]),d.push(...U));const V=m&&K.function_call!=null?[{type:"function",id:oa(),function:K.function_call,index:0}]:K.tool_calls;if(V!=null)for(const L of V){const te=L.index;if(l[te]==null){if(L.type!=="function")throw new Ld({data:L,message:"Expected 'function' type."});if(L.id==null)throw new Ld({data:L,message:"Expected 'id' to be a string."});if(((x=L.function)==null?void 0:x.name)==null)throw new Ld({data:L,message:"Expected 'function.name' to be a string."});l[te]={id:L.id,type:"function",function:{name:L.function.name,arguments:(w=L.function.arguments)!=null?w:""},hasFinished:!1};const Q=l[te];((S=Q.function)==null?void 0:S.name)!=null&&((k=Q.function)==null?void 0:k.arguments)!=null&&(Q.function.arguments.length>0&&v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Q.id,toolName:Q.function.name,argsTextDelta:Q.function.arguments}),gm(Q.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(C=Q.id)!=null?C:oa(),toolName:Q.function.name,args:Q.function.arguments}),Q.hasFinished=!0));continue}const W=l[te];W.hasFinished||(((T=L.function)==null?void 0:T.arguments)!=null&&(W.function.arguments+=(N=(A=L.function)==null?void 0:A.arguments)!=null?N:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:W.id,toolName:W.function.name,argsTextDelta:(I=L.function.arguments)!=null?I:""}),((O=W.function)==null?void 0:O.name)!=null&&((B=W.function)==null?void 0:B.arguments)!=null&&gm(W.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(D=W.id)!=null?D:oa(),toolName:W.function.name,args:W.function.arguments}),W.hasFinished=!0))}},flush(b){var v,x;b.enqueue({type:"finish",finishReason:c,logprobs:d,usage:{promptTokens:(v=u.promptTokens)!=null?v:NaN,completionTokens:(x=u.completionTokens)!=null?x:NaN},...y!=null?{providerMetadata:y}:{}})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},request:{body:JSON.stringify(r)},warnings:n}}},TG=Ke({prompt_tokens:At().nullish(),completion_tokens:At().nullish(),prompt_tokens_details:Ke({cached_tokens:At().nullish()}).nullish(),completion_tokens_details:Ke({reasoning_tokens:At().nullish(),accepted_prediction_tokens:At().nullish(),rejected_prediction_tokens:At().nullish()}).nullish()}).nullish(),kbe=Ke({id:$e().nullish(),created:At().nullish(),model:$e().nullish(),choices:ln(Ke({message:Ke({role:Mn("assistant").nullish(),content:$e().nullish(),function_call:Ke({arguments:$e(),name:$e()}).nullish(),tool_calls:ln(Ke({id:$e().nullish(),type:Mn("function"),function:Ke({name:$e(),arguments:$e()})})).nullish()}),index:At(),logprobs:Ke({content:ln(Ke({token:$e(),logprob:At(),top_logprobs:ln(Ke({token:$e(),logprob:At()}))})).nullable()}).nullish(),finish_reason:$e().nullish()})),usage:TG}),Ebe=ms([Ke({id:$e().nullish(),created:At().nullish(),model:$e().nullish(),choices:ln(Ke({delta:Ke({role:vl(["assistant"]).nullish(),content:$e().nullish(),function_call:Ke({name:$e().optional(),arguments:$e().optional()}).nullish(),tool_calls:ln(Ke({index:At(),id:$e().nullish(),type:Mn("function").nullish(),function:Ke({name:$e().nullish(),arguments:$e().nullish()})})).nullish()}).nullish(),logprobs:Ke({content:ln(Ke({token:$e(),logprob:At(),top_logprobs:ln(Ke({token:$e(),logprob:At()}))})).nullable()}).nullish(),finish_reason:$e().nullish(),index:At()})),usage:TG}),iO]);function xj(e){return e.startsWith("o")}function Tbe(e){return e.startsWith("gpt-4o-audio-preview")}function Abe(e){var t,n;return xj(e)?(n=(t=Rbe[e])==null?void 0:t.systemMessageMode)!=null?n:"developer":"system"}var Rbe={"o1-mini":{systemMessageMode:"remove"},"o1-mini-2024-09-12":{systemMessageMode:"remove"},"o1-preview":{systemMessageMode:"remove"},"o1-preview-2024-09-12":{systemMessageMode:"remove"},o3:{systemMessageMode:"developer"},"o3-2025-04-16":{systemMessageMode:"developer"},"o3-mini":{systemMessageMode:"developer"},"o3-mini-2025-01-31":{systemMessageMode:"developer"},"o4-mini":{systemMessageMode:"developer"},"o4-mini-2025-04-16":{systemMessageMode:"developer"}};function Nbe({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new xc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new gr({functionality:"images"})}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new gr({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new gr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s,stopSequences:[`
${n}:`]}}function i$(e){return e==null?void 0:e.tokens.map((t,n)=>({token:t,logprob:e.token_logprobs[n],topLogprobs:e.top_logprobs?Object.entries(e.top_logprobs[n]).map(([r,s])=>({token:r,logprob:s})):[]}))}var Mbe=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d}){var h;const m=e.type,y=[];a!=null&&y.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&y.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:b,stopSequences:v}=Nbe({prompt:n,inputFormat:t}),x=[...v??[],...c??[]],w={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:l,seed:d,prompt:b,stop:x.length>0?x:void 0};switch(m){case"regular":{if((h=e.tools)!=null&&h.length)throw new gr({functionality:"tools"});if(e.toolChoice)throw new gr({functionality:"toolChoice"});return{args:w,warnings:y}}case"object-json":throw new gr({functionality:"object-json mode"});case"object-tool":throw new gr({functionality:"object-tool mode"});default:{const S=m;throw new Error(`Unsupported type: ${S}`)}}}async doGenerate(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:s,rawValue:i}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:t,failedResponseHandler:Du,successfulResponseHandler:Va(Ibe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t,l=s.choices[0];return{text:l.text,usage:{promptTokens:s.usage.prompt_tokens,completionTokens:s.usage.completion_tokens},finishReason:j2(l.finish_reason),logprobs:i$(l.logprobs),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:r,body:i},response:P2(s),warnings:n,request:{body:JSON.stringify(t)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:r,failedResponseHandler:Du,successfulResponseHandler:Qh(jbe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u,d=!0;return{stream:i.pipeThrough(new TransformStream({transform(h,m){if(!h.success){l="error",m.enqueue({type:"error",error:h.error});return}const y=h.value;if("error"in y){l="error",m.enqueue({type:"error",error:y.error});return}d&&(d=!1,m.enqueue({type:"response-metadata",...P2(y)})),y.usage!=null&&(c={promptTokens:y.usage.prompt_tokens,completionTokens:y.usage.completion_tokens});const b=y.choices[0];(b==null?void 0:b.finish_reason)!=null&&(l=j2(b.finish_reason)),(b==null?void 0:b.text)!=null&&m.enqueue({type:"text-delta",textDelta:b.text});const v=i$(b==null?void 0:b.logprobs);v!=null&&v.length&&(u===void 0&&(u=[]),u.push(...v))},flush(h){h.enqueue({type:"finish",finishReason:l,logprobs:u,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify(r)}}}},Ibe=Ke({id:$e().nullish(),created:At().nullish(),model:$e().nullish(),choices:ln(Ke({text:$e(),finish_reason:$e(),logprobs:Ke({tokens:ln($e()),token_logprobs:ln(At()),top_logprobs:ln(Ih($e(),At())).nullable()}).nullish()})),usage:Ke({prompt_tokens:At(),completion_tokens:At()})}),jbe=ms([Ke({id:$e().nullish(),created:At().nullish(),model:$e().nullish(),choices:ln(Ke({text:$e(),finish_reason:$e().nullish(),index:At(),logprobs:Ke({tokens:ln($e()),token_logprobs:ln(At()),top_logprobs:ln(Ih($e(),At())).nullable()}).nullish()})),usage:Ke({prompt_tokens:At(),completion_tokens:At()}).nullish()}),iO]),Pbe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.settings.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new RE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:r,value:s}=await Ws({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Vs(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:Du,successfulResponseHandler:Va(Obe),abortSignal:n,fetch:this.config.fetch});return{embeddings:s.data.map(i=>i.embedding),usage:s.usage?{tokens:s.usage.prompt_tokens}:void 0,rawResponse:{headers:r}}}},Obe=Ke({data:ln(Ke({embedding:ln(At())})),usage:Ke({prompt_tokens:At()}).nullish()}),Dbe={"dall-e-3":1,"dall-e-2":10,"gpt-image-1":10},Fbe=new Set(["gpt-image-1"]),Lbe=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e,t;return(t=(e=this.settings.maxImagesPerCall)!=null?e:Dbe[this.modelId])!=null?t:1}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:i,headers:a,abortSignal:o}){var l,c,u,d;const h=[];r!=null&&h.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&h.push({type:"unsupported-setting",setting:"seed"});const m=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:y,responseHeaders:b}=await Ws({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Vs(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(d=i.openai)!=null?d:{},...Fbe.has(this.modelId)?{}:{response_format:"b64_json"}},failedResponseHandler:Du,successfulResponseHandler:Va(Bbe),abortSignal:o,fetch:this.config.fetch});return{images:y.data.map(v=>v.b64_json),warnings:h,response:{timestamp:m,modelId:this.modelId,headers:b}}}},Bbe=Ke({data:ln(Ke({b64_json:$e()}))}),$be=Ke({include:ln($e()).nullish(),language:$e().nullish(),prompt:$e().nullish(),temperature:At().min(0).max(1).nullish().default(0),timestampGranularities:ln(vl(["word","segment"])).nullish().default(["segment"])}),a$={afrikaans:"af",arabic:"ar",armenian:"hy",azerbaijani:"az",belarusian:"be",bosnian:"bs",bulgarian:"bg",catalan:"ca",chinese:"zh",croatian:"hr",czech:"cs",danish:"da",dutch:"nl",english:"en",estonian:"et",finnish:"fi",french:"fr",galician:"gl",german:"de",greek:"el",hebrew:"he",hindi:"hi",hungarian:"hu",icelandic:"is",indonesian:"id",italian:"it",japanese:"ja",kannada:"kn",kazakh:"kk",korean:"ko",latvian:"lv",lithuanian:"lt",macedonian:"mk",malay:"ms",marathi:"mr",maori:"mi",nepali:"ne",norwegian:"no",persian:"fa",polish:"pl",portuguese:"pt",romanian:"ro",russian:"ru",serbian:"sr",slovak:"sk",slovenian:"sl",spanish:"es",swahili:"sw",swedish:"sv",tagalog:"tl",tamil:"ta",thai:"th",turkish:"tr",ukrainian:"uk",urdu:"ur",vietnamese:"vi",welsh:"cy"},zbe=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({audio:e,mediaType:t,providerOptions:n}){var r,s,i,a,o;const l=[],c=ME({provider:"openai",providerOptions:n,schema:$be}),u=new FormData,d=e instanceof Uint8Array?new Blob([e]):new Blob([IE(e)]);if(u.append("model",this.modelId),u.append("file",new File([d],"audio",{type:t})),c){const h={include:(r=c.include)!=null?r:void 0,language:(s=c.language)!=null?s:void 0,prompt:(i=c.prompt)!=null?i:void 0,temperature:(a=c.temperature)!=null?a:void 0,timestamp_granularities:(o=c.timestampGranularities)!=null?o:void 0};for(const m in h){const y=h[m];y!==void 0&&u.append(m,String(y))}}return{formData:u,warnings:l}}async doGenerate(e){var t,n,r,s,i,a;const o=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{formData:l,warnings:c}=this.getArgs(e),{value:u,responseHeaders:d,rawValue:h}=await Vye({url:this.config.url({path:"/audio/transcriptions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),formData:l,failedResponseHandler:Du,successfulResponseHandler:Va(Ube),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=u.language!=null&&u.language in a$?a$[u.language]:void 0;return{text:u.text,segments:(i=(s=u.words)==null?void 0:s.map(y=>({text:y.word,startSecond:y.start,endSecond:y.end})))!=null?i:[],language:m,durationInSeconds:(a=u.duration)!=null?a:void 0,warnings:c,response:{timestamp:o,modelId:this.modelId,headers:d,body:h}}}},Ube=Ke({text:$e(),language:$e().nullish(),duration:At().nullish(),words:ln(Ke({word:$e(),start:At(),end:At()})).nullish()});function qbe({prompt:e,systemMessageMode:t}){const n=[],r=[];for(const{role:s,content:i}of e)switch(s){case"system":{switch(t){case"system":{n.push({role:"system",content:i});break}case"developer":{n.push({role:"developer",content:i});break}case"remove":{r.push({type:"other",message:"system messages are removed for this model"});break}default:{const a=t;throw new Error(`Unsupported system message mode: ${a}`)}}break}case"user":{n.push({role:"user",content:i.map((a,o)=>{var l,c,u,d;switch(a.type){case"text":return{type:"input_text",text:a.text};case"image":return{type:"input_image",image_url:a.image instanceof URL?a.image.toString():`data:${(l=a.mimeType)!=null?l:"image/jpeg"};base64,${Pu(a.image)}`,detail:(u=(c=a.providerMetadata)==null?void 0:c.openai)==null?void 0:u.imageDetail};case"file":{if(a.data instanceof URL)throw new gr({functionality:"File URLs in user messages"});switch(a.mimeType){case"application/pdf":return{type:"input_file",filename:(d=a.filename)!=null?d:`part-${o}.pdf`,file_data:`data:application/pdf;base64,${a.data}`};default:throw new gr({functionality:"Only PDF files are supported in user messages"})}}}})});break}case"assistant":{for(const a of i)switch(a.type){case"text":{n.push({role:"assistant",content:[{type:"output_text",text:a.text}]});break}case"tool-call":{n.push({type:"function_call",call_id:a.toolCallId,name:a.toolName,arguments:JSON.stringify(a.args)});break}}break}case"tool":{for(const a of i)n.push({type:"function_call_output",call_id:a.toolCallId,output:JSON.stringify(a.result)});break}default:{const a=s;throw new Error(`Unsupported role: ${a}`)}}return{messages:n,warnings:r}}function o$({finishReason:e,hasToolCalls:t}){switch(e){case void 0:case null:return t?"tool-calls":"stop";case"max_output_tokens":return"length";case"content_filter":return"content-filter";default:return t?"tool-calls":"unknown"}}function Vbe({mode:e,strict:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=e.toolChoice,a=[];for(const l of r)switch(l.type){case"function":a.push({type:"function",name:l.name,description:l.description,parameters:l.parameters,strict:t?!0:void 0});break;case"provider-defined":switch(l.id){case"openai.web_search_preview":a.push({type:"web_search_preview",search_context_size:l.args.searchContextSize,user_location:l.args.userLocation});break;default:s.push({type:"unsupported-tool",tool:l});break}break;default:s.push({type:"unsupported-tool",tool:l});break}if(i==null)return{tools:a,tool_choice:void 0,toolWarnings:s};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:s};case"tool":return i.toolName==="web_search_preview"?{tools:a,tool_choice:{type:"web_search_preview"},toolWarnings:s}:{tools:a,tool_choice:{type:"function",name:i.toolName},toolWarnings:s};default:{const l=o;throw new gr({functionality:`Unsupported tool choice type: ${l}`})}}}var Wbe=class{constructor(e,t){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsStructuredOutputs=!0,this.modelId=e,this.config=t}get provider(){return this.config.provider}getArgs({mode:e,maxTokens:t,temperature:n,stopSequences:r,topP:s,topK:i,presencePenalty:a,frequencyPenalty:o,seed:l,prompt:c,providerMetadata:u,responseFormat:d}){var h,m,y;const b=[],v=cve(this.modelId),x=e.type;i!=null&&b.push({type:"unsupported-setting",setting:"topK"}),l!=null&&b.push({type:"unsupported-setting",setting:"seed"}),a!=null&&b.push({type:"unsupported-setting",setting:"presencePenalty"}),o!=null&&b.push({type:"unsupported-setting",setting:"frequencyPenalty"}),r!=null&&b.push({type:"unsupported-setting",setting:"stopSequences"});const{messages:w,warnings:S}=qbe({prompt:c,systemMessageMode:v.systemMessageMode});b.push(...S);const k=ME({provider:"openai",providerOptions:u,schema:uve}),C=(h=k==null?void 0:k.strictSchemas)!=null?h:!0,T={model:this.modelId,input:w,temperature:n,top_p:s,max_output_tokens:t,...(d==null?void 0:d.type)==="json"&&{text:{format:d.schema!=null?{type:"json_schema",strict:C,name:(m=d.name)!=null?m:"response",description:d.description,schema:d.schema}:{type:"json_object"}}},metadata:k==null?void 0:k.metadata,parallel_tool_calls:k==null?void 0:k.parallelToolCalls,previous_response_id:k==null?void 0:k.previousResponseId,store:k==null?void 0:k.store,user:k==null?void 0:k.user,instructions:k==null?void 0:k.instructions,...v.isReasoningModel&&((k==null?void 0:k.reasoningEffort)!=null||(k==null?void 0:k.reasoningSummary)!=null)&&{reasoning:{...(k==null?void 0:k.reasoningEffort)!=null&&{effort:k.reasoningEffort},...(k==null?void 0:k.reasoningSummary)!=null&&{summary:k.reasoningSummary}}},...v.requiredAutoTruncation&&{truncation:"auto"}};switch(v.isReasoningModel&&(T.temperature!=null&&(T.temperature=void 0,b.push({type:"unsupported-setting",setting:"temperature",details:"temperature is not supported for reasoning models"})),T.top_p!=null&&(T.top_p=void 0,b.push({type:"unsupported-setting",setting:"topP",details:"topP is not supported for reasoning models"}))),x){case"regular":{const{tools:A,tool_choice:N,toolWarnings:I}=Vbe({mode:e,strict:C});return{args:{...T,tools:A,tool_choice:N},warnings:[...b,...I]}}case"object-json":return{args:{...T,text:{format:e.schema!=null?{type:"json_schema",strict:C,name:(y=e.name)!=null?y:"response",description:e.description,schema:e.schema}:{type:"json_object"}}},warnings:b};case"object-tool":return{args:{...T,tool_choice:{type:"function",name:e.tool.name},tools:[{type:"function",name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters,strict:C}]},warnings:b};default:{const A=x;throw new Error(`Unsupported type: ${A}`)}}}async doGenerate(e){var t,n,r,s,i,a,o;const{args:l,warnings:c}=this.getArgs(e),{responseHeaders:u,value:d,rawValue:h}=await Ws({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:l,failedResponseHandler:Du,successfulResponseHandler:Va(Ke({id:$e(),created_at:At(),model:$e(),output:ln(jE("type",[Ke({type:Mn("message"),role:Mn("assistant"),content:ln(Ke({type:Mn("output_text"),text:$e(),annotations:ln(Ke({type:Mn("url_citation"),start_index:At(),end_index:At(),url:$e(),title:$e()}))}))}),Ke({type:Mn("function_call"),call_id:$e(),name:$e(),arguments:$e()}),Ke({type:Mn("web_search_call")}),Ke({type:Mn("computer_call")}),Ke({type:Mn("reasoning"),summary:ln(Ke({type:Mn("summary_text"),text:$e()}))})])),incomplete_details:Ke({reason:$e()}).nullable(),usage:AG})),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=d.output.filter(v=>v.type==="message").flatMap(v=>v.content).filter(v=>v.type==="output_text"),y=d.output.filter(v=>v.type==="function_call").map(v=>({toolCallType:"function",toolCallId:v.call_id,toolName:v.name,args:v.arguments})),b=(n=(t=d.output.find(v=>v.type==="reasoning"))==null?void 0:t.summary)!=null?n:null;return{text:m.map(v=>v.text).join(`
`),sources:m.flatMap(v=>v.annotations.map(x=>{var w,S,k;return{sourceType:"url",id:(k=(S=(w=this.config).generateId)==null?void 0:S.call(w))!=null?k:oa(),url:x.url,title:x.title}})),finishReason:o$({finishReason:(r=d.incomplete_details)==null?void 0:r.reason,hasToolCalls:y.length>0}),toolCalls:y.length>0?y:void 0,reasoning:b?b.map(v=>({type:"text",text:v.text})):void 0,usage:{promptTokens:d.usage.input_tokens,completionTokens:d.usage.output_tokens},rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:u,body:h},request:{body:JSON.stringify(l)},response:{id:d.id,timestamp:new Date(d.created_at*1e3),modelId:d.model},providerMetadata:{openai:{responseId:d.id,cachedPromptTokens:(i=(s=d.usage.input_tokens_details)==null?void 0:s.cached_tokens)!=null?i:null,reasoningTokens:(o=(a=d.usage.output_tokens_details)==null?void 0:a.reasoning_tokens)!=null?o:null}},warnings:c}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),{responseHeaders:r,value:s}=await Ws({url:this.config.url({path:"/responses",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:{...t,stream:!0},failedResponseHandler:Du,successfulResponseHandler:Qh(eve),abortSignal:e.abortSignal,fetch:this.config.fetch}),i=this;let a="unknown",o=NaN,l=NaN,c=null,u=null,d=null;const h={};let m=!1;return{stream:s.pipeThrough(new TransformStream({transform(y,b){var v,x,w,S,k,C,T,A;if(!y.success){a="error",b.enqueue({type:"error",error:y.error});return}const N=y.value;if(ave(N))N.item.type==="function_call"&&(h[N.output_index]={toolName:N.item.name,toolCallId:N.item.call_id},b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:N.item.call_id,toolName:N.item.name,argsTextDelta:N.item.arguments}));else if(ive(N)){const I=h[N.output_index];I!=null&&b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:I.toolCallId,toolName:I.toolName,argsTextDelta:N.delta})}else sve(N)?(d=N.response.id,b.enqueue({type:"response-metadata",id:N.response.id,timestamp:new Date(N.response.created_at*1e3),modelId:N.response.model})):tve(N)?b.enqueue({type:"text-delta",textDelta:N.delta}):lve(N)?b.enqueue({type:"reasoning",textDelta:N.delta}):nve(N)&&N.item.type==="function_call"?(h[N.output_index]=void 0,m=!0,b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:N.item.call_id,toolName:N.item.name,args:N.item.arguments})):rve(N)?(a=o$({finishReason:(v=N.response.incomplete_details)==null?void 0:v.reason,hasToolCalls:m}),o=N.response.usage.input_tokens,l=N.response.usage.output_tokens,c=(w=(x=N.response.usage.input_tokens_details)==null?void 0:x.cached_tokens)!=null?w:c,u=(k=(S=N.response.usage.output_tokens_details)==null?void 0:S.reasoning_tokens)!=null?k:u):ove(N)&&b.enqueue({type:"source",source:{sourceType:"url",id:(A=(T=(C=i.config).generateId)==null?void 0:T.call(C))!=null?A:oa(),url:N.annotation.url,title:N.annotation.title}})},flush(y){y.enqueue({type:"finish",finishReason:a,usage:{promptTokens:o,completionTokens:l},...(c!=null||u!=null)&&{providerMetadata:{openai:{responseId:d,cachedPromptTokens:c,reasoningTokens:u}}}})}})),rawCall:{rawPrompt:void 0,rawSettings:{}},rawResponse:{headers:r},request:{body:JSON.stringify(t)},warnings:n}}},AG=Ke({input_tokens:At(),input_tokens_details:Ke({cached_tokens:At().nullish()}).nullish(),output_tokens:At(),output_tokens_details:Ke({reasoning_tokens:At().nullish()}).nullish()}),Hbe=Ke({type:Mn("response.output_text.delta"),delta:$e()}),Gbe=Ke({type:vl(["response.completed","response.incomplete"]),response:Ke({incomplete_details:Ke({reason:$e()}).nullish(),usage:AG})}),Kbe=Ke({type:Mn("response.created"),response:Ke({id:$e(),created_at:At(),model:$e()})}),Ybe=Ke({type:Mn("response.output_item.done"),output_index:At(),item:jE("type",[Ke({type:Mn("message")}),Ke({type:Mn("function_call"),id:$e(),call_id:$e(),name:$e(),arguments:$e(),status:Mn("completed")})])}),Zbe=Ke({type:Mn("response.function_call_arguments.delta"),item_id:$e(),output_index:At(),delta:$e()}),Xbe=Ke({type:Mn("response.output_item.added"),output_index:At(),item:jE("type",[Ke({type:Mn("message")}),Ke({type:Mn("function_call"),id:$e(),call_id:$e(),name:$e(),arguments:$e()})])}),Jbe=Ke({type:Mn("response.output_text.annotation.added"),annotation:Ke({type:Mn("url_citation"),url:$e(),title:$e()})}),Qbe=Ke({type:Mn("response.reasoning_summary_text.delta"),item_id:$e(),output_index:At(),summary_index:At(),delta:$e()}),eve=ms([Hbe,Gbe,Kbe,Ybe,Zbe,Xbe,Jbe,Qbe,Ke({type:$e()}).passthrough()]);function tve(e){return e.type==="response.output_text.delta"}function nve(e){return e.type==="response.output_item.done"}function rve(e){return e.type==="response.completed"||e.type==="response.incomplete"}function sve(e){return e.type==="response.created"}function ive(e){return e.type==="response.function_call_arguments.delta"}function ave(e){return e.type==="response.output_item.added"}function ove(e){return e.type==="response.output_text.annotation.added"}function lve(e){return e.type==="response.reasoning_summary_text.delta"}function cve(e){return e.startsWith("o")?e.startsWith("o1-mini")||e.startsWith("o1-preview")?{isReasoningModel:!0,systemMessageMode:"remove",requiredAutoTruncation:!1}:{isReasoningModel:!0,systemMessageMode:"developer",requiredAutoTruncation:!1}:{isReasoningModel:!1,systemMessageMode:"system",requiredAutoTruncation:!1}}var uve=Ke({metadata:Gd().nullish(),parallelToolCalls:Zn().nullish(),previousResponseId:$e().nullish(),store:Zn().nullish(),user:$e().nullish(),reasoningEffort:$e().nullish(),strictSchemas:Zn().nullish(),instructions:$e().nullish(),reasoningSummary:$e().nullish()}),dve=Ke({});function fve({searchContextSize:e,userLocation:t}={}){return{type:"provider-defined",id:"openai.web_search_preview",args:{searchContextSize:e,userLocation:t},parameters:dve}}var hve={webSearchPreview:fve},pve=Ke({instructions:$e().nullish(),speed:At().min(.25).max(4).default(1).nullish()}),mve=class{constructor(e,t){this.modelId=e,this.config=t,this.specificationVersion="v1"}get provider(){return this.config.provider}getArgs({text:e,voice:t="alloy",outputFormat:n="mp3",speed:r,instructions:s,providerOptions:i}){const a=[],o=ME({provider:"openai",providerOptions:i,schema:pve}),l={model:this.modelId,input:e,voice:t,response_format:"mp3",speed:r,instructions:s};if(n&&(["mp3","opus","aac","flac","wav","pcm"].includes(n)?l.response_format=n:a.push({type:"unsupported-setting",setting:"outputFormat",details:`Unsupported output format: ${n}. Using mp3 instead.`})),o){const c={};for(const u in c){const d=c[u];d!==void 0&&(l[u]=d)}}return{requestBody:l,warnings:a}}async doGenerate(e){var t,n,r;const s=(r=(n=(t=this.config._internal)==null?void 0:t.currentDate)==null?void 0:n.call(t))!=null?r:new Date,{requestBody:i,warnings:a}=this.getArgs(e),{value:o,responseHeaders:l,rawValue:c}=await Ws({url:this.config.url({path:"/audio/speech",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:i,failedResponseHandler:Du,successfulResponseHandler:Wye(),abortSignal:e.abortSignal,fetch:this.config.fetch});return{audio:o,warnings:a,request:{body:JSON.stringify(i)},response:{timestamp:s,modelId:this.modelId,headers:l,body:c}}}};function RG(e={}){var t,n,r;const s=(t=x1(e.baseURL))!=null?t:"https://api.openai.com/v1",i=(n=e.compatibility)!=null?n:"compatible",a=(r=e.name)!=null?r:"openai",o=()=>({Authorization:`Bearer ${nO({apiKey:e.apiKey,environmentVariableName:"OPENAI_API_KEY",description:"OpenAI"})}`,"OpenAI-Organization":e.organization,"OpenAI-Project":e.project,...e.headers}),l=(x,w={})=>new Cbe(x,w,{provider:`${a}.chat`,url:({path:S})=>`${s}${S}`,headers:o,compatibility:i,fetch:e.fetch}),c=(x,w={})=>new Mbe(x,w,{provider:`${a}.completion`,url:({path:S})=>`${s}${S}`,headers:o,compatibility:i,fetch:e.fetch}),u=(x,w={})=>new Pbe(x,w,{provider:`${a}.embedding`,url:({path:S})=>`${s}${S}`,headers:o,fetch:e.fetch}),d=(x,w={})=>new Lbe(x,w,{provider:`${a}.image`,url:({path:S})=>`${s}${S}`,headers:o,fetch:e.fetch}),h=x=>new zbe(x,{provider:`${a}.transcription`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),m=x=>new mve(x,{provider:`${a}.speech`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),y=(x,w)=>{if(new.target)throw new Error("The OpenAI model function cannot be called with the new keyword.");return x==="gpt-3.5-turbo-instruct"?c(x,w):l(x,w)},b=x=>new Wbe(x,{provider:`${a}.responses`,url:({path:w})=>`${s}${w}`,headers:o,fetch:e.fetch}),v=function(x,w){return y(x,w)};return v.languageModel=y,v.chat=l,v.completion=c,v.responses=b,v.embedding=u,v.textEmbedding=u,v.textEmbeddingModel=u,v.image=d,v.imageModel=d,v.transcription=h,v.transcriptionModel=h,v.speech=m,v.speechModel=m,v.tools=hve,v}RG({compatibility:"strict"});function $l(e){if(gve(e))return;if(typeof e=="boolean")return{type:"boolean",properties:{}};const{type:t,description:n,required:r,properties:s,items:i,allOf:a,anyOf:o,oneOf:l,format:c,const:u,minLength:d,enum:h}=e,m={};if(n&&(m.description=n),r&&(m.required=r),c&&(m.format=c),u!==void 0&&(m.enum=[u]),t&&(Array.isArray(t)?t.includes("null")?(m.type=t.filter(y=>y!=="null")[0],m.nullable=!0):m.type=t:t==="null"?m.type="null":m.type=t),h!==void 0&&(m.enum=h),s!=null&&(m.properties=Object.entries(s).reduce((y,[b,v])=>(y[b]=$l(v),y),{})),i&&(m.items=Array.isArray(i)?i.map($l):$l(i)),a&&(m.allOf=a.map($l)),o)if(o.some(y=>typeof y=="object"&&(y==null?void 0:y.type)==="null")){const y=o.filter(b=>!(typeof b=="object"&&(b==null?void 0:b.type)==="null"));if(y.length===1){const b=$l(y[0]);typeof b=="object"&&(m.nullable=!0,Object.assign(m,b))}else m.anyOf=y.map($l),m.nullable=!0}else m.anyOf=o.map($l);return l&&(m.oneOf=l.map($l)),d!==void 0&&(m.minLength=d),m}function gve(e){return e!=null&&typeof e=="object"&&e.type==="object"&&(e.properties==null||Object.keys(e.properties).length===0)}function yve(e){var t,n;const r=[],s=[];let i=!0;for(const{role:a,content:o}of e)switch(a){case"system":{if(!i)throw new gr({functionality:"system messages are only supported at the beginning of the conversation"});r.push({text:o});break}case"user":{i=!1;const l=[];for(const c of o)switch(c.type){case"text":{l.push({text:c.text});break}case"image":{l.push(c.image instanceof URL?{fileData:{mimeType:(t=c.mimeType)!=null?t:"image/jpeg",fileUri:c.image.toString()}}:{inlineData:{mimeType:(n=c.mimeType)!=null?n:"image/jpeg",data:Pu(c.image)}});break}case"file":{l.push(c.data instanceof URL?{fileData:{mimeType:c.mimeType,fileUri:c.data.toString()}}:{inlineData:{mimeType:c.mimeType,data:c.data}});break}}s.push({role:"user",parts:l});break}case"assistant":{i=!1,s.push({role:"model",parts:o.map(l=>{switch(l.type){case"text":return l.text.length===0?void 0:{text:l.text};case"file":{if(l.mimeType!=="image/png")throw new gr({functionality:"Only PNG images are supported in assistant messages"});if(l.data instanceof URL)throw new gr({functionality:"File data URLs in assistant messages are not supported"});return{inlineData:{mimeType:l.mimeType,data:l.data}}}case"tool-call":return{functionCall:{name:l.toolName,args:l.args}}}}).filter(l=>l!==void 0)});break}case"tool":{i=!1,s.push({role:"user",parts:o.map(l=>({functionResponse:{name:l.toolName,response:{name:l.toolName,content:l.result}}}))});break}}return{systemInstruction:r.length>0?{parts:r}:void 0,contents:s}}function l$(e){return e.includes("/")?e:`models/${e}`}var bve=Ke({error:Ke({code:At().nullable(),message:$e(),status:$e()})}),wj=Jh({errorSchema:bve,errorToMessage:e=>e.error.message});function vve(e,t,n,r){var s,i;const a=(s=e.tools)!=null&&s.length?e.tools:void 0,o=[],l=r.includes("gemini-2"),c=r.includes("gemini-1.5-flash")&&!r.includes("-8b");if(t)return{tools:l?{googleSearch:{}}:{googleSearchRetrieval:!c||!n?{}:{dynamicRetrievalConfig:n}},toolConfig:void 0,toolWarnings:o};if(a==null)return{tools:void 0,toolConfig:void 0,toolWarnings:o};const u=[];for(const m of a)m.type==="provider-defined"?o.push({type:"unsupported-tool",tool:m}):u.push({name:m.name,description:(i=m.description)!=null?i:"",parameters:$l(m.parameters)});const d=e.toolChoice;if(d==null)return{tools:{functionDeclarations:u},toolConfig:void 0,toolWarnings:o};const h=d.type;switch(h){case"auto":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"AUTO"}},toolWarnings:o};case"none":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"NONE"}},toolWarnings:o};case"required":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY"}},toolWarnings:o};case"tool":return{tools:{functionDeclarations:u},toolConfig:{functionCallingConfig:{mode:"ANY",allowedFunctionNames:[d.toolName]}},toolWarnings:o};default:{const m=h;throw new gr({functionality:`Unsupported tool choice type: ${m}`})}}}function c$({finishReason:e,hasToolCalls:t}){switch(e){case"STOP":return t?"tool-calls":"stop";case"MAX_TOKENS":return"length";case"IMAGE_SAFETY":case"RECITATION":case"SAFETY":case"BLOCKLIST":case"PROHIBITED_CONTENT":case"SPII":return"content-filter";case"FINISH_REASON_UNSPECIFIED":case"OTHER":return"other";case"MALFORMED_FUNCTION_CALL":return"error";default:return"unknown"}}var xve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1,this.modelId=e,this.settings=t,this.config=n}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!0}get provider(){return this.config.provider}async getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,stopSequences:l,responseFormat:c,seed:u,providerMetadata:d}){var h,m,y;const b=e.type,v=[],x=ME({provider:"google",providerOptions:d,schema:Cve});((h=x==null?void 0:x.thinkingConfig)==null?void 0:h.includeThoughts)===!0&&!this.config.provider.startsWith("google.vertex.")&&v.push({type:"other",message:`The 'includeThoughts' option is only supported with the Google Vertex provider and might not be supported or could behave unexpectedly with the current Google provider (${this.config.provider}).`});const w={maxOutputTokens:n,temperature:r,topK:i,topP:s,frequencyPenalty:a,presencePenalty:o,stopSequences:l,seed:u,responseMimeType:(c==null?void 0:c.type)==="json"?"application/json":void 0,responseSchema:(c==null?void 0:c.type)==="json"&&c.schema!=null&&this.supportsStructuredOutputs?$l(c.schema):void 0,...this.settings.audioTimestamp&&{audioTimestamp:this.settings.audioTimestamp},responseModalities:x==null?void 0:x.responseModalities,thinkingConfig:x==null?void 0:x.thinkingConfig},{contents:S,systemInstruction:k}=yve(t);switch(b){case"regular":{const{tools:C,toolConfig:T,toolWarnings:A}=vve(e,(m=this.settings.useSearchGrounding)!=null?m:!1,this.settings.dynamicRetrievalConfig,this.modelId);return{args:{generationConfig:w,contents:S,systemInstruction:k,safetySettings:this.settings.safetySettings,tools:C,toolConfig:T,cachedContent:this.settings.cachedContent},warnings:[...v,...A]}}case"object-json":return{args:{generationConfig:{...w,responseMimeType:"application/json",responseSchema:e.schema!=null&&this.supportsStructuredOutputs?$l(e.schema):void 0},contents:S,systemInstruction:k,safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:v};case"object-tool":return{args:{generationConfig:w,contents:S,tools:{functionDeclarations:[{name:e.tool.name,description:(y=e.tool.description)!=null?y:"",parameters:$l(e.tool.parameters)}]},toolConfig:{functionCallingConfig:{mode:"ANY"}},safetySettings:this.settings.safetySettings,cachedContent:this.settings.cachedContent},warnings:v};default:{const C=b;throw new Error(`Unsupported type: ${C}`)}}}supportsUrl(e){return this.config.isSupportedUrl(e)}async doGenerate(e){var t,n,r,s,i;const{args:a,warnings:o}=await this.getArgs(e),l=JSON.stringify(a),c=Vs(await hj(this.config.headers),e.headers),{responseHeaders:u,value:d,rawValue:h}=await Ws({url:`${this.config.baseURL}/${l$(this.modelId)}:generateContent`,headers:c,body:a,failedResponseHandler:wj,successfulResponseHandler:Va(_ve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:m,...y}=a,b=d.candidates[0],v=b.content==null||typeof b.content!="object"||!("parts"in b.content)?[]:b.content.parts,x=u$({parts:v,generateId:this.config.generateId}),w=d.usageMetadata;return{text:d$(v),reasoning:f$(v),files:(t=h$(v))==null?void 0:t.map(S=>({data:S.inlineData.data,mimeType:S.inlineData.mimeType})),toolCalls:x,finishReason:c$({finishReason:b.finishReason,hasToolCalls:x!=null&&x.length>0}),usage:{promptTokens:(n=w==null?void 0:w.promptTokenCount)!=null?n:NaN,completionTokens:(r=w==null?void 0:w.candidatesTokenCount)!=null?r:NaN},rawCall:{rawPrompt:m,rawSettings:y},rawResponse:{headers:u,body:h},warnings:o,providerMetadata:{google:{groundingMetadata:(s=b.groundingMetadata)!=null?s:null,safetyRatings:(i=b.safetyRatings)!=null?i:null}},sources:p$({groundingMetadata:b.groundingMetadata,generateId:this.config.generateId}),request:{body:l}}}async doStream(e){const{args:t,warnings:n}=await this.getArgs(e),r=JSON.stringify(t),s=Vs(await hj(this.config.headers),e.headers),{responseHeaders:i,value:a}=await Ws({url:`${this.config.baseURL}/${l$(this.modelId)}:streamGenerateContent?alt=sse`,headers:s,body:t,failedResponseHandler:wj,successfulResponseHandler:Qh(Sve),abortSignal:e.abortSignal,fetch:this.config.fetch}),{contents:o,...l}=t;let c="unknown",u={promptTokens:Number.NaN,completionTokens:Number.NaN},d;const h=this.config.generateId;let m=!1;return{stream:a.pipeThrough(new TransformStream({transform(y,b){var v,x,w,S,k,C;if(!y.success){b.enqueue({type:"error",error:y.error});return}const T=y.value,A=T.usageMetadata;A!=null&&(u={promptTokens:(v=A.promptTokenCount)!=null?v:NaN,completionTokens:(x=A.candidatesTokenCount)!=null?x:NaN});const N=(w=T.candidates)==null?void 0:w[0];if(N==null)return;const I=N.content;if(I!=null){const O=d$(I.parts);O!=null&&b.enqueue({type:"text-delta",textDelta:O});const B=f$(I.parts);if(B!=null)for(const P of B)b.enqueue({type:"reasoning",textDelta:P.text});const D=h$(I.parts);if(D!=null)for(const P of D)b.enqueue({type:"file",mimeType:P.inlineData.mimeType,data:P.inlineData.data});const H=u$({parts:I.parts,generateId:h});if(H!=null)for(const P of H)b.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:P.toolCallId,toolName:P.toolName,argsTextDelta:P.args}),b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:P.toolCallId,toolName:P.toolName,args:P.args}),m=!0}if(N.finishReason!=null){c=c$({finishReason:N.finishReason,hasToolCalls:m});const O=(S=p$({groundingMetadata:N.groundingMetadata,generateId:h}))!=null?S:[];for(const B of O)b.enqueue({type:"source",source:B});d={google:{groundingMetadata:(k=N.groundingMetadata)!=null?k:null,safetyRatings:(C=N.safetyRatings)!=null?C:null}}}},flush(y){y.enqueue({type:"finish",finishReason:c,usage:u,providerMetadata:d})}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:i},warnings:n,request:{body:r}}}};function u$({parts:e,generateId:t}){const n=e==null?void 0:e.filter(r=>"functionCall"in r);return n==null||n.length===0?void 0:n.map(r=>({toolCallType:"function",toolCallId:t(),toolName:r.functionCall.name,args:JSON.stringify(r.functionCall.args)}))}function d$(e){const t=e==null?void 0:e.filter(n=>"text"in n&&n.thought!==!0);return t==null||t.length===0?void 0:t.map(n=>n.text).join("")}function f$(e){const t=e==null?void 0:e.filter(n=>"text"in n&&n.thought===!0&&n.text!=null);return t==null||t.length===0?void 0:t.map(n=>({type:"text",text:n.text}))}function h$(e){return e==null?void 0:e.filter(t=>"inlineData"in t)}function p$({groundingMetadata:e,generateId:t}){var n;return(n=e==null?void 0:e.groundingChunks)==null?void 0:n.filter(r=>r.web!=null).map(r=>({sourceType:"url",id:t(),url:r.web.uri,title:r.web.title}))}var NG=Ke({parts:ln(ms([Ke({functionCall:Ke({name:$e(),args:Yy()})}),Ke({inlineData:Ke({mimeType:$e(),data:$e()})}),Ke({text:$e().nullish(),thought:Zn().nullish()})])).nullish()}),wve=Ke({web:Ke({uri:$e(),title:$e()}).nullish(),retrievedContext:Ke({uri:$e(),title:$e()}).nullish()}),MG=Ke({webSearchQueries:ln($e()).nullish(),retrievalQueries:ln($e()).nullish(),searchEntryPoint:Ke({renderedContent:$e()}).nullish(),groundingChunks:ln(wve).nullish(),groundingSupports:ln(Ke({segment:Ke({startIndex:At().nullish(),endIndex:At().nullish(),text:$e().nullish()}),segment_text:$e().nullish(),groundingChunkIndices:ln(At()).nullish(),supportChunkIndices:ln(At()).nullish(),confidenceScores:ln(At()).nullish(),confidenceScore:ln(At()).nullish()})).nullish(),retrievalMetadata:ms([Ke({webDynamicRetrievalScore:At()}),Ke({})]).nullish()}),IG=Ke({category:$e().nullish(),probability:$e().nullish(),probabilityScore:At().nullish(),severity:$e().nullish(),severityScore:At().nullish(),blocked:Zn().nullish()}),_ve=Ke({candidates:ln(Ke({content:NG.nullish().or(Ke({}).strict()),finishReason:$e().nullish(),safetyRatings:ln(IG).nullish(),groundingMetadata:MG.nullish()})),usageMetadata:Ke({promptTokenCount:At().nullish(),candidatesTokenCount:At().nullish(),totalTokenCount:At().nullish()}).nullish()}),Sve=Ke({candidates:ln(Ke({content:NG.nullish(),finishReason:$e().nullish(),safetyRatings:ln(IG).nullish(),groundingMetadata:MG.nullish()})).nullish(),usageMetadata:Ke({promptTokenCount:At().nullish(),candidatesTokenCount:At().nullish(),totalTokenCount:At().nullish()}).nullish()}),Cve=Ke({responseModalities:ln(vl(["TEXT","IMAGE"])).nullish(),thinkingConfig:Ke({thinkingBudget:At().nullish(),includeThoughts:Zn().nullish()}).nullish()}),kve=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){return 2048}get supportsParallelCalls(){return!0}async doEmbed({values:e,headers:t,abortSignal:n}){if(e.length>this.maxEmbeddingsPerCall)throw new RE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const r=Vs(await hj(this.config.headers),t),{responseHeaders:s,value:i}=await Ws({url:`${this.config.baseURL}/models/${this.modelId}:batchEmbedContents`,headers:r,body:{requests:e.map(a=>({model:`models/${this.modelId}`,content:{role:"user",parts:[{text:a}]},outputDimensionality:this.settings.outputDimensionality,taskType:this.settings.taskType}))},failedResponseHandler:wj,successfulResponseHandler:Va(Eve),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.embeddings.map(a=>a.values),usage:void 0,rawResponse:{headers:s}}}},Eve=Ke({embeddings:ln(Ke({values:ln(At())}))});function Tve(e){return e.toString().startsWith("https://generativelanguage.googleapis.com/v1beta/files/")}function jG(e={}){var t;const n=(t=x1(e.baseURL))!=null?t:"https://generativelanguage.googleapis.com/v1beta",r=()=>({"x-goog-api-key":nO({apiKey:e.apiKey,environmentVariableName:"GOOGLE_GENERATIVE_AI_API_KEY",description:"Google Generative AI"}),...e.headers}),s=(o,l={})=>{var c;return new xve(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,generateId:(c=e.generateId)!=null?c:oa,isSupportedUrl:Tve,fetch:e.fetch})},i=(o,l={})=>new kve(o,l,{provider:"google.generative-ai",baseURL:n,headers:r,fetch:e.fetch}),a=function(o,l){if(new.target)throw new Error("The Google Generative AI model function cannot be called with the new keyword.");return s(o,l)};return a.languageModel=s,a.chat=s,a.generativeAI=s,a.embedding=i,a.textEmbedding=i,a.textEmbeddingModel=i,a}jG();var Ave=Object.defineProperty,Rve=Object.defineProperties,Nve=Object.getOwnPropertyDescriptors,O2=Object.getOwnPropertySymbols,PG=Object.prototype.hasOwnProperty,OG=Object.prototype.propertyIsEnumerable,m$=(e,t,n)=>t in e?Ave(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,ja=(e,t)=>{for(var n in t||(t={}))PG.call(t,n)&&m$(e,n,t[n]);if(O2)for(var n of O2(t))OG.call(t,n)&&m$(e,n,t[n]);return e},DC=(e,t)=>Rve(e,Nve(t)),D2=(e,t)=>{var n={};for(var r in e)PG.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&O2)for(var r of O2(e))t.indexOf(r)<0&&OG.call(e,r)&&(n[r]=e[r]);return n},Mve=Ke({type:Mn("reasoning.summary"),summary:$e()}),Ive=Ke({type:Mn("reasoning.encrypted"),data:$e()}),jve=Ke({type:Mn("reasoning.text"),text:$e().nullish(),signature:$e().nullish()}),Pve=ms([Mve,Ive,jve]),Ove=ms([Pve,Yy().transform(()=>null)]),aO=ln(Ove).transform(e=>e.filter(t=>!!t));function ah(e){var t,n,r;const s=e==null?void 0:e.anthropic,i=e==null?void 0:e.openrouter;return(r=(n=(t=i==null?void 0:i.cacheControl)!=null?t:i==null?void 0:i.cache_control)!=null?n:s==null?void 0:s.cacheControl)!=null?r:s==null?void 0:s.cache_control}function Dve(e){var t,n,r;const s=[];for(const{role:i,content:a,providerMetadata:o}of e)switch(i){case"system":{s.push({role:"system",content:a,cache_control:ah(o)});break}case"user":{if(a.length===1&&((t=a[0])==null?void 0:t.type)==="text"){s.push({role:"user",content:a[0].text,cache_control:(n=ah(o))!=null?n:ah(a[0].providerMetadata)});break}const l=ah(o),c=a.map(u=>{var d,h,m,y;const b=(d=ah(u.providerMetadata))!=null?d:l;switch(u.type){case"text":return{type:"text",text:u.text,cache_control:b};case"image":return{type:"image_url",image_url:{url:u.image instanceof URL?u.image.toString():`data:${(h=u.mimeType)!=null?h:"image/jpeg"};base64,${Pu(u.image)}`},cache_control:b};case"file":return{type:"file",file:{filename:String((y=(m=u.providerMetadata)==null?void 0:m.openrouter)==null?void 0:y.filename),file_data:u.data instanceof Uint8Array?`data:${u.mimeType};base64,${Pu(u.data)}`:`data:${u.mimeType};base64,${u.data}`},cache_control:b};default:{const v=u;throw new Error(`Unsupported content part type: ${v}`)}}});s.push({role:"user",content:c});break}case"assistant":{let l="",c="";const u=[],d=[];for(const h of a)switch(h.type){case"text":{l+=h.text;break}case"tool-call":{d.push({id:h.toolCallId,type:"function",function:{name:h.toolName,arguments:JSON.stringify(h.args)}});break}case"reasoning":{c+=h.text,u.push({type:"reasoning.text",text:h.text,signature:h.signature});break}case"redacted-reasoning":{u.push({type:"reasoning.encrypted",data:h.data});break}case"file":break;default:{const m=h;throw new Error(`Unsupported part: ${m}`)}}s.push({role:"assistant",content:l,tool_calls:d.length>0?d:void 0,reasoning:c||void 0,reasoning_details:u.length>0?u:void 0,cache_control:ah(o)});break}case"tool":{for(const l of a)s.push({role:"tool",tool_call_id:l.toolCallId,content:JSON.stringify(l.result),cache_control:(r=ah(o))!=null?r:ah(l.providerMetadata)});break}default:{const l=i;throw new Error(`Unsupported role: ${l}`)}}return s}function g$(e){var t,n;return(n=(t=e==null?void 0:e.content)==null?void 0:t.map(({token:r,logprob:s,top_logprobs:i})=>({token:r,logprob:s,topLogprobs:i?i.map(({token:a,logprob:o})=>({token:a,logprob:o})):[]})))!=null?n:void 0}function F2(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var oO=Ke({error:Ke({code:ms([$e(),At()]).nullable(),message:$e(),type:$e().nullable(),param:Gd().nullable()})}),L2=Jh({errorSchema:oO,errorToMessage:e=>e.error.message});function Fve(e){return"parameters"in e}var Lve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode="tool",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,frequencyPenalty:i,presencePenalty:a,seed:o,stopSequences:l,responseFormat:c,topK:u,providerMetadata:d}){var h;const m=e.type,y=(h=d==null?void 0:d.openrouter)!=null?h:{},b=ja(ja(ja({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:this.settings.logprobs===!0||typeof this.settings.logprobs=="number"?!0:void 0,top_logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,user:this.settings.user,parallel_tool_calls:this.settings.parallelToolCalls,max_tokens:n,temperature:r,top_p:s,frequency_penalty:i,presence_penalty:a,seed:o,stop:l,response_format:c,top_k:u,messages:Dve(t),include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning,usage:this.settings.usage},this.config.extraBody),this.settings.extraBody),y);switch(m){case"regular":return ja(ja({},b),zve(e));case"object-json":return DC(ja({},b),{response_format:{type:"json_object"}});case"object-tool":return DC(ja({},b),{tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]});default:{const v=m;throw new gr({functionality:`${v} mode`})}}}async doGenerate(e){var t,n,r,s,i,a,o,l,c;const u=this.getArgs(e),{responseHeaders:d,value:h}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:u,failedResponseHandler:L2,successfulResponseHandler:Va(Bve),abortSignal:e.abortSignal,fetch:this.config.fetch}),m=u,{messages:y}=m,b=D2(m,["messages"]),v=h.choices[0];if(!v)throw new Error("No choice in response");const x=h.usage?{promptTokens:(t=h.usage.prompt_tokens)!=null?t:0,completionTokens:(n=h.usage.completion_tokens)!=null?n:0}:{promptTokens:0,completionTokens:0},w={};h.usage&&((r=this.settings.usage)!=null&&r.include)&&(w.openrouter={usage:{promptTokens:h.usage.prompt_tokens,promptTokensDetails:h.usage.prompt_tokens_details?{cachedTokens:(s=h.usage.prompt_tokens_details.cached_tokens)!=null?s:0}:void 0,completionTokens:h.usage.completion_tokens,completionTokensDetails:h.usage.completion_tokens_details?{reasoningTokens:(i=h.usage.completion_tokens_details.reasoning_tokens)!=null?i:0}:void 0,cost:h.usage.cost,totalTokens:(a=h.usage.total_tokens)!=null?a:0}});const S=Object.keys(w).length>0,k=(o=v.message.reasoning_details)!=null?o:[],C=k.length>0?k.map(T=>{var A;switch(T.type){case"reasoning.text":{if(T.text)return{type:"text",text:T.text,signature:(A=T.signature)!=null?A:void 0};break}case"reasoning.summary":{if(T.summary)return{type:"text",text:T.summary};break}case"reasoning.encrypted":{if(T.data)return{type:"redacted",data:T.data};break}}return null}).filter(T=>T!==null):v.message.reasoning?[{type:"text",text:v.message.reasoning}]:[];return ja({response:{id:h.id,modelId:h.model},text:(l=v.message.content)!=null?l:void 0,reasoning:C,toolCalls:(c=v.message.tool_calls)==null?void 0:c.map(T=>{var A;return{toolCallType:"function",toolCallId:(A=T.id)!=null?A:oa(),toolName:T.function.name,args:T.function.arguments}}),finishReason:F2(v.finish_reason),usage:x,rawCall:{rawPrompt:y,rawSettings:b},rawResponse:{headers:d},warnings:[],logprobs:g$(v.logprobs)},S?{providerMetadata:w}:{})}async doStream(e){var t,n;const r=this.getArgs(e),{responseHeaders:s,value:i}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:DC(ja({},r),{stream:!0,stream_options:this.config.compatibility==="strict"?ja({include_usage:!0},(t=this.settings.usage)!=null&&t.include?{include_usage:!0}:{}):void 0}),failedResponseHandler:L2,successfulResponseHandler:Qh($ve),abortSignal:e.abortSignal,fetch:this.config.fetch}),a=r,{messages:o}=a,l=D2(a,["messages"]),c=[];let u="other",d={promptTokens:Number.NaN,completionTokens:Number.NaN},h;const m={},y=!!((n=this.settings.usage)!=null&&n.include);return{stream:i.pipeThrough(new TransformStream({transform(b,v){var x,w,S,k,C,T,A,N,I,O,B,D,H,P;if(!b.success){u="error",v.enqueue({type:"error",error:b.error});return}const K=b.value;if("error"in K){u="error",v.enqueue({type:"error",error:K.error});return}K.id&&v.enqueue({type:"response-metadata",id:K.id}),K.model&&v.enqueue({type:"response-metadata",modelId:K.model}),K.usage!=null&&(d={promptTokens:K.usage.prompt_tokens,completionTokens:K.usage.completion_tokens},m.promptTokens=K.usage.prompt_tokens,K.usage.prompt_tokens_details&&(m.promptTokensDetails={cachedTokens:(x=K.usage.prompt_tokens_details.cached_tokens)!=null?x:0}),m.completionTokens=K.usage.completion_tokens,K.usage.completion_tokens_details&&(m.completionTokensDetails={reasoningTokens:(w=K.usage.completion_tokens_details.reasoning_tokens)!=null?w:0}),m.cost=K.usage.cost,m.totalTokens=K.usage.total_tokens);const U=K.choices[0];if((U==null?void 0:U.finish_reason)!=null&&(u=F2(U.finish_reason)),(U==null?void 0:U.delta)==null)return;const V=U.delta;if(V.content!=null&&v.enqueue({type:"text-delta",textDelta:V.content}),V.reasoning!=null&&v.enqueue({type:"reasoning",textDelta:V.reasoning}),V.reasoning_details&&V.reasoning_details.length>0)for(const te of V.reasoning_details)switch(te.type){case"reasoning.text":{te.text&&v.enqueue({type:"reasoning",textDelta:te.text}),te.signature&&v.enqueue({type:"reasoning-signature",signature:te.signature});break}case"reasoning.encrypted":{te.data&&v.enqueue({type:"redacted-reasoning",data:te.data});break}case"reasoning.summary":{te.summary&&v.enqueue({type:"reasoning",textDelta:te.summary});break}}const L=g$(U==null?void 0:U.logprobs);if(L!=null&&L.length&&(h===void 0&&(h=[]),h.push(...L)),V.tool_calls!=null)for(const te of V.tool_calls){const W=te.index;if(c[W]==null){if(te.type!=="function")throw new Ld({data:te,message:"Expected 'function' type."});if(te.id==null)throw new Ld({data:te,message:"Expected 'id' to be a string."});if(((S=te.function)==null?void 0:S.name)==null)throw new Ld({data:te,message:"Expected 'function.name' to be a string."});c[W]={id:te.id,type:"function",function:{name:te.function.name,arguments:(k=te.function.arguments)!=null?k:""},sent:!1};const ee=c[W];if(ee==null)throw new Error("Tool call is missing");((C=ee.function)==null?void 0:C.name)!=null&&((T=ee.function)==null?void 0:T.arguments)!=null&&gm(ee.function.arguments)&&(v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:ee.id,toolName:ee.function.name,argsTextDelta:ee.function.arguments}),v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(A=ee.id)!=null?A:oa(),toolName:ee.function.name,args:ee.function.arguments}),ee.sent=!0);continue}const Q=c[W];if(Q==null)throw new Error("Tool call is missing");((N=te.function)==null?void 0:N.arguments)!=null&&(Q.function.arguments+=(O=(I=te.function)==null?void 0:I.arguments)!=null?O:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:Q.id,toolName:Q.function.name,argsTextDelta:(B=te.function.arguments)!=null?B:""}),((D=Q.function)==null?void 0:D.name)!=null&&((H=Q.function)==null?void 0:H.arguments)!=null&&gm(Q.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(P=Q.id)!=null?P:oa(),toolName:Q.function.name,args:Q.function.arguments}),Q.sent=!0)}},flush(b){var v;if(u==="tool-calls")for(const S of c)S.sent||(b.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(v=S.id)!=null?v:oa(),toolName:S.function.name,args:gm(S.function.arguments)?S.function.arguments:"{}"}),S.sent=!0);const x={};y&&(m.totalTokens!==void 0||m.cost!==void 0||m.promptTokensDetails!==void 0||m.completionTokensDetails!==void 0)&&(x.openrouter={usage:m});const w=Object.keys(x).length>0&&y;b.enqueue(ja({type:"finish",finishReason:u,logprobs:h,usage:d},w?{providerMetadata:x}:{}))}})),rawCall:{rawPrompt:o,rawSettings:l},rawResponse:{headers:s},warnings:[]}}},DG=Ke({id:$e().optional(),model:$e().optional(),usage:Ke({prompt_tokens:At(),prompt_tokens_details:Ke({cached_tokens:At()}).nullish(),completion_tokens:At(),completion_tokens_details:Ke({reasoning_tokens:At()}).nullish(),total_tokens:At(),cost:At().optional()}).nullish()}),Bve=DG.extend({choices:ln(Ke({message:Ke({role:Mn("assistant"),content:$e().nullable().optional(),reasoning:$e().nullable().optional(),reasoning_details:aO.nullish(),tool_calls:ln(Ke({id:$e().optional().nullable(),type:Mn("function"),function:Ke({name:$e(),arguments:$e()})})).optional()}),index:At(),logprobs:Ke({content:ln(Ke({token:$e(),logprob:At(),top_logprobs:ln(Ke({token:$e(),logprob:At()}))})).nullable()}).nullable().optional(),finish_reason:$e().optional().nullable()}))}),$ve=ms([DG.extend({choices:ln(Ke({delta:Ke({role:vl(["assistant"]).optional(),content:$e().nullish(),reasoning:$e().nullish().optional(),reasoning_details:aO.nullish(),tool_calls:ln(Ke({index:At(),id:$e().nullish(),type:Mn("function").optional(),function:Ke({name:$e().nullish(),arguments:$e().nullish()})})).nullish()}).nullish(),logprobs:Ke({content:ln(Ke({token:$e(),logprob:At(),top_logprobs:ln(Ke({token:$e(),logprob:At()}))})).nullable()}).nullish(),finish_reason:$e().nullable().optional(),index:At()}))}),oO]);function zve(e){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0;if(n==null)return{tools:void 0,tool_choice:void 0};const r=n.map(a=>Fve(a)?{type:"function",function:{name:a.name,description:a.description,parameters:a.parameters}}:{type:"function",function:{name:a.name}}),s=e.toolChoice;if(s==null)return{tools:r,tool_choice:void 0};const i=s.type;switch(i){case"auto":case"none":case"required":return{tools:r,tool_choice:i};case"tool":return{tools:r,tool_choice:{type:"function",function:{name:s.toolName}}};default:{const a=i;throw new Error(`Unsupported tool choice type: ${a}`)}}}function Uve({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0]&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0]&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0]&&e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new xc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new gr({functionality:"images"});case"file":throw new gr({functionality:"file attachments"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new gr({functionality:"tool-call messages"});case"reasoning":throw new gr({functionality:"reasoning messages"});case"redacted-reasoning":throw new gr({functionality:"redacted reasoning messages"});case"file":throw new gr({functionality:"file attachments"});default:{const c=l;throw new Error(`Unsupported content type: ${c}`)}}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new gr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s}}function y$(e){return e==null?void 0:e.tokens.map((t,n)=>{var r,s;return{token:t,logprob:(r=e.token_logprobs[n])!=null?r:0,topLogprobs:e.top_logprobs?Object.entries((s=e.top_logprobs[n])!=null?s:{}).map(([i,a])=>({token:i,logprob:a})):[]}})}var qve=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0,this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,frequencyPenalty:a,presencePenalty:o,seed:l,responseFormat:c,topK:u,stopSequences:d,providerMetadata:h}){var m,y;const b=e.type,v=(m=h==null?void 0:h.openrouter)!=null?m:{},{prompt:x}=Uve({prompt:n,inputFormat:t}),w=ja(ja(ja({model:this.modelId,models:this.settings.models,logit_bias:this.settings.logitBias,logprobs:typeof this.settings.logprobs=="number"?this.settings.logprobs:typeof this.settings.logprobs=="boolean"&&this.settings.logprobs?0:void 0,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:a,presence_penalty:o,seed:l,stop:d,response_format:c,top_k:u,prompt:x,include_reasoning:this.settings.includeReasoning,reasoning:this.settings.reasoning},this.config.extraBody),this.settings.extraBody),v);switch(b){case"regular":{if((y=e.tools)!=null&&y.length)throw new gr({functionality:"tools"});if(e.toolChoice)throw new gr({functionality:"toolChoice"});return w}case"object-json":throw new gr({functionality:"object-json mode"});case"object-tool":throw new gr({functionality:"object-tool mode"});default:{const S=b;throw new gr({functionality:`${S} mode`})}}}async doGenerate(e){var t,n,r,s,i;const a=this.getArgs(e),{responseHeaders:o,value:l}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:a,failedResponseHandler:L2,successfulResponseHandler:Va(b$),abortSignal:e.abortSignal,fetch:this.config.fetch}),c=a,{prompt:u}=c,d=D2(c,["prompt"]);if("error"in l)throw new Error(`${l.error.message}`);const h=l.choices[0];if(!h)throw new Error("No choice in OpenRouter completion response");return{response:{id:l.id,modelId:l.model},text:(t=h.text)!=null?t:"",reasoning:h.reasoning||void 0,usage:{promptTokens:(r=(n=l.usage)==null?void 0:n.prompt_tokens)!=null?r:0,completionTokens:(i=(s=l.usage)==null?void 0:s.completion_tokens)!=null?i:0},finishReason:F2(h.finish_reason),logprobs:y$(h.logprobs),rawCall:{rawPrompt:u,rawSettings:d},rawResponse:{headers:o},warnings:[]}}async doStream(e){const t=this.getArgs(e),{responseHeaders:n,value:r}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:DC(ja({},this.getArgs(e)),{stream:!0,stream_options:this.config.compatibility==="strict"?{include_usage:!0}:void 0}),failedResponseHandler:L2,successfulResponseHandler:Qh(b$),abortSignal:e.abortSignal,fetch:this.config.fetch}),s=t,{prompt:i}=s,a=D2(s,["prompt"]);let o="other",l={promptTokens:Number.NaN,completionTokens:Number.NaN},c;return{stream:r.pipeThrough(new TransformStream({transform(u,d){if(!u.success){o="error",d.enqueue({type:"error",error:u.error});return}const h=u.value;if("error"in h){o="error",d.enqueue({type:"error",error:h.error});return}h.usage!=null&&(l={promptTokens:h.usage.prompt_tokens,completionTokens:h.usage.completion_tokens});const m=h.choices[0];(m==null?void 0:m.finish_reason)!=null&&(o=F2(m.finish_reason)),(m==null?void 0:m.text)!=null&&d.enqueue({type:"text-delta",textDelta:m.text});const y=y$(m==null?void 0:m.logprobs);y!=null&&y.length&&(c===void 0&&(c=[]),c.push(...y))},flush(u){u.enqueue({type:"finish",finishReason:o,logprobs:c,usage:l})}})),rawCall:{rawPrompt:i,rawSettings:a},rawResponse:{headers:n},warnings:[]}}},b$=ms([Ke({id:$e().optional(),model:$e().optional(),choices:ln(Ke({text:$e(),reasoning:$e().nullish().optional(),reasoning_details:aO.nullish(),finish_reason:$e().nullish(),index:At(),logprobs:Ke({tokens:ln($e()),token_logprobs:ln(At()),top_logprobs:ln(Ih($e(),At())).nullable()}).nullable().optional()})),usage:Ke({prompt_tokens:At(),completion_tokens:At()}).optional().nullable()}),oO]);function FG(e={}){var t,n,r;const s=(n=x1((t=e.baseURL)!=null?t:e.baseUrl))!=null?n:"https://openrouter.ai/api/v1",i=(r=e.compatibility)!=null?r:"compatible",a=()=>ja({Authorization:`Bearer ${nO({apiKey:e.apiKey,environmentVariableName:"OPENROUTER_API_KEY",description:"OpenRouter"})}`},e.headers),o=(d,h={})=>new Lve(d,h,{provider:"openrouter.chat",url:({path:m})=>`${s}${m}`,headers:a,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),l=(d,h={})=>new qve(d,h,{provider:"openrouter.completion",url:({path:m})=>`${s}${m}`,headers:a,compatibility:i,fetch:e.fetch,extraBody:e.extraBody}),c=(d,h)=>{if(new.target)throw new Error("The OpenRouter model function cannot be called with the new keyword.");return d==="openai/gpt-3.5-turbo-instruct"?l(d,h):o(d,h)},u=(d,h)=>c(d,h);return u.languageModel=c,u.chat=o,u.completion=l,u}FG({compatibility:"strict"});var zp={},AN={},v$;function x$(){return v$||(v$=1,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.ALL=e.COLLECTION=e.ATOM=e.SPECIAL=e.INF=e._INFINITY=e.INFINITY=e.NAN=e.BOOL=e.NULL=e.OBJ=e.ARR=e.NUM=e.STR=void 0,e.STR=1,e.NUM=2,e.ARR=4,e.OBJ=8,e.NULL=16,e.BOOL=32,e.NAN=64,e.INFINITY=128,e._INFINITY=256,e.INF=e.INFINITY|e._INFINITY,e.SPECIAL=e.NULL|e.BOOL|e.INF|e.NAN,e.ATOM=e.STR|e.NUM|e.SPECIAL,e.COLLECTION=e.ARR|e.OBJ,e.ALL=e.ATOM|e.COLLECTION,e.Allow={STR:e.STR,NUM:e.NUM,ARR:e.ARR,OBJ:e.OBJ,NULL:e.NULL,BOOL:e.BOOL,NAN:e.NAN,INFINITY:e.INFINITY,_INFINITY:e._INFINITY,INF:e.INF,SPECIAL:e.SPECIAL,ATOM:e.ATOM,COLLECTION:e.COLLECTION,ALL:e.ALL},e.default=e.Allow}(AN)),AN}var w$;function Vve(){return w$||(w$=1,function(e){var t=zp&&zp.__createBinding||(Object.create?function(c,u,d,h){h===void 0&&(h=d);var m=Object.getOwnPropertyDescriptor(u,d);(!m||("get"in m?!u.__esModule:m.writable||m.configurable))&&(m={enumerable:!0,get:function(){return u[d]}}),Object.defineProperty(c,h,m)}:function(c,u,d,h){h===void 0&&(h=d),c[h]=u[d]}),n=zp&&zp.__exportStar||function(c,u){for(var d in c)d!=="default"&&!Object.prototype.hasOwnProperty.call(u,d)&&t(u,c,d)};Object.defineProperty(e,"__esModule",{value:!0}),e.Allow=e.MalformedJSON=e.PartialJSON=e.parseJSON=e.parse=void 0;const r=x$();Object.defineProperty(e,"Allow",{enumerable:!0,get:function(){return r.Allow}}),n(x$(),e);class s extends Error{}e.PartialJSON=s;class i extends Error{}e.MalformedJSON=i;function a(c,u=r.Allow.ALL){if(typeof c!="string")throw new TypeError(`expecting str, got ${typeof c}`);if(!c.trim())throw new Error(`${c} is empty`);return o(c.trim(),u)}e.parseJSON=a;const o=(c,u)=>{const d=c.length;let h=0;const m=C=>{throw new s(`${C} at position ${h}`)},y=C=>{throw new i(`${C} at position ${h}`)},b=()=>(k(),h>=d&&m("Unexpected end of input"),c[h]==='"'?v():c[h]==="{"?x():c[h]==="["?w():c.substring(h,h+4)==="null"||r.Allow.NULL&u&&d-h<4&&"null".startsWith(c.substring(h))?(h+=4,null):c.substring(h,h+4)==="true"||r.Allow.BOOL&u&&d-h<4&&"true".startsWith(c.substring(h))?(h+=4,!0):c.substring(h,h+5)==="false"||r.Allow.BOOL&u&&d-h<5&&"false".startsWith(c.substring(h))?(h+=5,!1):c.substring(h,h+8)==="Infinity"||r.Allow.INFINITY&u&&d-h<8&&"Infinity".startsWith(c.substring(h))?(h+=8,1/0):c.substring(h,h+9)==="-Infinity"||r.Allow._INFINITY&u&&1<d-h&&d-h<9&&"-Infinity".startsWith(c.substring(h))?(h+=9,-1/0):c.substring(h,h+3)==="NaN"||r.Allow.NAN&u&&d-h<3&&"NaN".startsWith(c.substring(h))?(h+=3,NaN):S()),v=()=>{const C=h;let T=!1;for(h++;h<d&&(c[h]!=='"'||T&&c[h-1]==="\\");)T=c[h]==="\\"?!T:!1,h++;if(c.charAt(h)=='"')try{return JSON.parse(c.substring(C,++h-Number(T)))}catch(A){y(String(A))}else if(r.Allow.STR&u)try{return JSON.parse(c.substring(C,h-Number(T))+'"')}catch{return JSON.parse(c.substring(C,c.lastIndexOf("\\"))+'"')}m("Unterminated string literal")},x=()=>{h++,k();const C={};try{for(;c[h]!=="}";){if(k(),h>=d&&r.Allow.OBJ&u)return C;const T=v();k(),h++;try{const A=b();C[T]=A}catch(A){if(r.Allow.OBJ&u)return C;throw A}k(),c[h]===","&&h++}}catch{if(r.Allow.OBJ&u)return C;m("Expected '}' at end of object")}return h++,C},w=()=>{h++;const C=[];try{for(;c[h]!=="]";)C.push(b()),k(),c[h]===","&&h++}catch{if(r.Allow.ARR&u)return C;m("Expected ']' at end of array")}return h++,C},S=()=>{if(h===0){c==="-"&&y("Not sure what '-' is");try{return JSON.parse(c)}catch(T){if(r.Allow.NUM&u)try{return JSON.parse(c.substring(0,c.lastIndexOf("e")))}catch{}y(String(T))}}const C=h;for(c[h]==="-"&&h++;c[h]&&",]}".indexOf(c[h])===-1;)h++;h==d&&!(r.Allow.NUM&u)&&m("Unterminated number literal");try{return JSON.parse(c.substring(C,h))}catch{c.substring(C,h)==="-"&&m("Not sure what '-' is");try{return JSON.parse(c.substring(C,c.lastIndexOf("e")))}catch(A){y(String(A))}}},k=()=>{for(;h<d&&` 
\r	`.includes(c[h]);)h++};return b()},l=a;e.parse=l}(zp)),zp}var Wve=Vve();function RN(e){const t=[];for(const{content:n,role:r}of e)switch(r){case"system":{t.push({content:n,role:"system"});break}case"user":{t.push({...n.reduce((s,i)=>{if(i.type==="text")s.content+=i.text;else{if(i.type==="image"&&i.image instanceof URL)throw new gr({functionality:"Image URLs in user messages"});i.type==="image"&&i.image instanceof Uint8Array&&(s.images=s.images||[],s.images.push(Pu(i.image)))}return s},{content:""}),role:"user"});break}case"assistant":{const s=[],i=[];for(const a of n)switch(a.type){case"text":{s.push(a.text);break}case"tool-call":{i.push({function:{arguments:a.args,name:a.toolName},id:a.toolCallId,type:"function"});break}default:{const o=a;throw new Error(`Unsupported part: ${o}`)}}t.push({content:s.join(","),role:"assistant",tool_calls:i.length>0?i:void 0});break}case"tool":{t.push(...n.map(s=>({content:typeof s.result=="object"?JSON.stringify(s.result):`${s.result}`,role:"tool",tool_call_id:s.toolCallId})));break}default:{const s=r;throw new Error(`Unsupported role: ${s}`)}}return t}var Hve=class{constructor({tools:e,type:t}){this._firstMessage=!0,this._tools=e,this._toolPartial="",this._toolCalls=[],this._type=t,this._detectedToolCall=!1}get toolCalls(){return this._toolCalls}get detectedToolCall(){return this._detectedToolCall}parse({controller:e,delta:t}){var n;if(this.detectToolCall(t),!this._detectedToolCall)return!1;this._toolPartial+=t;let r=Wve.parse(this._toolPartial);Array.isArray(r)||(r=[r]);for(const[s,i]of r.entries()){const a=(n=JSON.stringify(i==null?void 0:i.parameters))!=null?n:"";if(a==="")continue;this._toolCalls[s]||(this._toolCalls[s]={function:{arguments:"",name:i.name},id:oa(),type:"function"});const o=this._toolCalls[s];o.function.arguments=a,e.enqueue({argsTextDelta:t,toolCallId:o.id,toolCallType:"function",toolName:o.function.name,type:"tool-call-delta"})}return!0}finish({controller:e}){for(const t of this.toolCalls)e.enqueue({args:t.function.arguments,toolCallId:t.id,toolCallType:"function",toolName:t.function.name,type:"tool-call"});return this.finishReason()}detectToolCall(e){!this._tools||this._tools.length===0||this._firstMessage&&(this._type==="object-tool"?this._detectedToolCall=!0:this._type==="regular"&&(e.trim().startsWith("{")||e.trim().startsWith("["))&&(this._detectedToolCall=!0),this._firstMessage=!1)}finishReason(){return this.detectedToolCall?this._type==="object-tool"?"stop":"tool-calls":"stop"}};function Gve({finishReason:e,hasToolCalls:t}){switch(e){case"stop":return t?"tool-calls":"stop";default:return"other"}}var Kve=Ke({error:Ke({code:$e().nullable(),message:$e(),param:Gd().nullable(),type:$e()})}),_j=Jh({errorSchema:Kve,errorToMessage:e=>e.error.message});function Yve({mode:e}){var t;const n=(t=e.tools)!=null&&t.length?e.tools:void 0,r=[],s=e.toolChoice;if(n===void 0)return{tools:void 0,toolWarnings:r};const i=[];for(const o of n)o.type==="provider-defined"?r.push({tool:o,type:"unsupported-tool"}):i.push({function:{description:o.description,name:o.name,parameters:o.parameters},type:"function"});if(s===void 0)return{tools:i,toolWarnings:r};const a=s.type;switch(a){case"auto":return{tools:i,toolWarnings:r};case"none":return{tools:void 0,toolWarnings:r};default:{const o=a;throw new gr({functionality:`Unsupported tool choice type: ${o}`})}}}function Zve(e){return Object.fromEntries(Object.entries(e).filter(([,t])=>t!==void 0))}var Xve=class extends TransformStream{constructor(){super({flush:e=>{this.buffer.length!==0&&e.enqueue(this.buffer)},transform:(e,t)=>{for(e=this.buffer+e;;){const n=e.indexOf(`
`);if(n===-1)break;t.enqueue(e.slice(0,n)),e=e.slice(n+1)}this.buffer=e}}),this.buffer=""}},Jve=e=>async({response:t})=>{const n=Gy(t);if(t.body===null)throw new GH({});return{responseHeaders:n,value:t.body.pipeThrough(new TextDecoderStream).pipeThrough(new Xve).pipeThrough(new TransformStream({transform(r,s){s.enqueue(km({schema:e,text:r}))}}))}},Qve=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1",this.defaultObjectGenerationMode="json",this.supportsImageUrls=!1}get supportsStructuredOutputs(){var e;return(e=this.settings.structuredOutputs)!=null?e:!1}get provider(){return this.config.provider}getArguments({frequencyPenalty:e,maxTokens:t,mode:n,presencePenalty:r,prompt:s,responseFormat:i,seed:a,stopSequences:o,temperature:l,topK:c,topP:u}){const d=n.type,h=[];i!==void 0&&i.type==="json"&&i.schema!==void 0&&!this.supportsStructuredOutputs&&h.push({details:"JSON response format schema is only supported with structuredOutputs",setting:"responseFormat",type:"unsupported-setting"});const m={format:i==null?void 0:i.type,model:this.modelId,options:Zve({f16_kv:this.settings.f16Kv,frequency_penalty:e,low_vram:this.settings.lowVram,main_gpu:this.settings.mainGpu,min_p:this.settings.minP,mirostat:this.settings.mirostat,mirostat_eta:this.settings.mirostatEta,mirostat_tau:this.settings.mirostatTau,num_batch:this.settings.numBatch,num_ctx:this.settings.numCtx,num_gpu:this.settings.numGpu,num_keep:this.settings.numKeep,num_predict:t,num_thread:this.settings.numThread,numa:this.settings.numa,penalize_newline:this.settings.penalizeNewline,presence_penalty:r,repeat_last_n:this.settings.repeatLastN,repeat_penalty:this.settings.repeatPenalty,seed:a,stop:o,temperature:l,tfs_z:this.settings.tfsZ,top_k:c,top_p:u,typical_p:this.settings.typicalP,use_mlock:this.settings.useMlock,use_mmap:this.settings.useMmap,vocab_only:this.settings.vocabOnly})};switch(d){case"regular":{const{tools:y,toolWarnings:b}=Yve({mode:n});return{args:{...m,messages:RN(s),tools:y},type:d,warnings:[...h,...b]}}case"object-json":return{args:{...m,format:this.supportsStructuredOutputs&&n.schema!==void 0?n.schema:"json",messages:RN(s)},type:d,warnings:h};case"object-tool":return{args:{...m,messages:RN(s),tool_choice:{function:{name:n.tool.name},type:"function"},tools:[{function:{description:n.tool.description,name:n.tool.name,parameters:n.tool.parameters},type:"function"}]},type:d,warnings:h};default:{const y=d;throw new Error(`Unsupported type: ${y}`)}}}async doGenerate(e){var t,n;const{args:r,warnings:s}=this.getArguments(e),i={...r,stream:!1},{responseHeaders:a,value:o}=await Ws({abortSignal:e.abortSignal,body:i,failedResponseHandler:_j,fetch:this.config.fetch,headers:Vs(this.config.headers(),e.headers),successfulResponseHandler:Va(exe),url:`${this.config.baseURL}/chat`}),{messages:l,...c}=i,u=(t=o.message.tool_calls)==null?void 0:t.map(d=>{var h;return{args:JSON.stringify(d.function.arguments),toolCallId:(h=d.id)!=null?h:oa(),toolCallType:"function",toolName:d.function.name}});return{finishReason:Gve({finishReason:o.done_reason,hasToolCalls:u!==void 0&&u.length>0}),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},request:{body:JSON.stringify(i)},text:(n=o.message.content)!=null?n:void 0,toolCalls:u,usage:{completionTokens:o.eval_count||0,promptTokens:o.prompt_eval_count||0},warnings:s}}async doStream(e){if(this.settings.simulateStreaming){const m=await this.doGenerate(e),y=new ReadableStream({start(b){if(b.enqueue({type:"response-metadata",...m.response}),m.text&&b.enqueue({textDelta:m.text,type:"text-delta"}),m.toolCalls)for(const v of m.toolCalls)b.enqueue({argsTextDelta:v.args,toolCallId:v.toolCallId,toolCallType:"function",toolName:v.toolName,type:"tool-call-delta"}),b.enqueue({type:"tool-call",...v});b.enqueue({finishReason:m.finishReason,logprobs:m.logprobs,providerMetadata:m.providerMetadata,type:"finish",usage:m.usage}),b.close()}});return{rawCall:m.rawCall,rawResponse:m.rawResponse,stream:y,warnings:m.warnings}}const{args:t,type:n,warnings:r}=this.getArguments(e),{responseHeaders:s,value:i}=await Ws({abortSignal:e.abortSignal,body:t,failedResponseHandler:_j,fetch:this.config.fetch,headers:Vs(this.config.headers(),e.headers),successfulResponseHandler:Jve(txe),url:`${this.config.baseURL}/chat`}),{messages:a,...o}=t,l=e.mode.type==="regular"?e.mode.tools:e.mode.type==="object-tool"?[e.mode.tool]:void 0,c=new Hve({tools:l,type:n});let u="other",d={completionTokens:Number.NaN,promptTokens:Number.NaN};const{experimentalStreamTools:h=!0}=this.settings;return{rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},request:{body:JSON.stringify(t)},stream:i.pipeThrough(new TransformStream({async flush(m){m.enqueue({finishReason:u,type:"finish",usage:d})},async transform(m,y){if(!m.success){y.enqueue({error:m.error,type:"error"});return}const b=m.value;if(b.done){u=c.finish({controller:y}),d={completionTokens:b.eval_count,promptTokens:b.prompt_eval_count||0};return}h&&c.parse({controller:y,delta:b.message.content})||b.message.content!==null&&y.enqueue({textDelta:b.message.content,type:"text-delta"})}})),warnings:r}}},exe=Ke({created_at:$e(),done:Mn(!0),done_reason:$e().optional().nullable(),eval_count:At(),eval_duration:At(),load_duration:At().optional(),message:Ke({content:$e(),role:$e(),tool_calls:ln(Ke({function:Ke({arguments:Ih(Gd()),name:$e()}),id:$e().optional()})).optional().nullable()}),model:$e(),prompt_eval_count:At().optional(),prompt_eval_duration:At().optional(),total_duration:At()}),txe=jE("done",[Ke({created_at:$e(),done:Mn(!1),message:Ke({content:$e(),role:$e()}),model:$e()}),Ke({created_at:$e(),done:Mn(!0),eval_count:At(),eval_duration:At(),load_duration:At().optional(),model:$e(),prompt_eval_count:At().optional(),prompt_eval_duration:At().optional(),total_duration:At()})]),nxe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.settings.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){return!1}async doEmbed({abortSignal:e,values:t}){if(t.length>this.maxEmbeddingsPerCall)throw new RE({maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,modelId:this.modelId,provider:this.provider,values:t});const{responseHeaders:n,value:r}=await Ws({abortSignal:e,body:{input:t,model:this.modelId},failedResponseHandler:_j,fetch:this.config.fetch,headers:this.config.headers(),successfulResponseHandler:Va(rxe),url:`${this.config.baseURL}/embed`});return{embeddings:r.embeddings,rawResponse:{headers:n},usage:r.prompt_eval_count?{tokens:r.prompt_eval_count}:void 0}}},rxe=Ke({embeddings:ln(ln(At())),prompt_eval_count:At().nullable()});function LG(e={}){var t;const n=(t=x1(e.baseURL))!=null?t:"http://127.0.0.1:11434/api",r=()=>({...e.headers}),s=(o,l={})=>new Qve(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.chat"}),i=(o,l={})=>new nxe(o,l,{baseURL:n,fetch:e.fetch,headers:r,provider:"ollama.embedding"}),a=function(o,l){if(new.target)throw new Error("The Ollama model function cannot be called with the new keyword.");return s(o,l)};return a.chat=s,a.embedding=i,a.languageModel=s,a.textEmbedding=i,a.textEmbeddingModel=i,a}LG();function Lv(e){var t,n;return(n=(t=e==null?void 0:e.providerMetadata)==null?void 0:t.openaiCompatible)!=null?n:{}}function sxe(e){const t=[];for(const{role:n,content:r,...s}of e){const i=Lv({...s});switch(n){case"system":{t.push({role:"system",content:r,...i});break}case"user":{if(r.length===1&&r[0].type==="text"){t.push({role:"user",content:r[0].text,...Lv(r[0])});break}t.push({role:"user",content:r.map(a=>{var o;const l=Lv(a);switch(a.type){case"text":return{type:"text",text:a.text,...l};case"image":return{type:"image_url",image_url:{url:a.image instanceof URL?a.image.toString():`data:${(o=a.mimeType)!=null?o:"image/jpeg"};base64,${Pu(a.image)}`},...l};case"file":throw new gr({functionality:"File content parts in user messages"})}}),...i});break}case"assistant":{let a="";const o=[];for(const l of r){const c=Lv(l);switch(l.type){case"text":{a+=l.text;break}case"tool-call":{o.push({id:l.toolCallId,type:"function",function:{name:l.toolName,arguments:JSON.stringify(l.args)},...c});break}}}t.push({role:"assistant",content:a,tool_calls:o.length>0?o:void 0,...i});break}case"tool":{for(const a of r){const o=Lv(a);t.push({role:"tool",tool_call_id:a.toolCallId,content:JSON.stringify(a.result),...o})}break}default:{const a=n;throw new Error(`Unsupported role: ${a}`)}}}return t}function B2({id:e,model:t,created:n}){return{id:e??void 0,modelId:t??void 0,timestamp:n!=null?new Date(n*1e3):void 0}}function $2(e){switch(e){case"stop":return"stop";case"length":return"length";case"content_filter":return"content-filter";case"function_call":case"tool_calls":return"tool-calls";default:return"unknown"}}var ixe=Ke({error:Ke({message:$e(),type:$e().nullish(),param:Gd().nullish(),code:ms([$e(),At()]).nullish()})}),PE={errorSchema:ixe,errorToMessage:e=>e.error.message};function axe({mode:e,structuredOutputs:t}){var n;const r=(n=e.tools)!=null&&n.length?e.tools:void 0,s=[];if(r==null)return{tools:void 0,tool_choice:void 0,toolWarnings:s};const i=e.toolChoice,a=[];for(const l of r)l.type==="provider-defined"?s.push({type:"unsupported-tool",tool:l}):a.push({type:"function",function:{name:l.name,description:l.description,parameters:l.parameters}});if(i==null)return{tools:a,tool_choice:void 0,toolWarnings:s};const o=i.type;switch(o){case"auto":case"none":case"required":return{tools:a,tool_choice:o,toolWarnings:s};case"tool":return{tools:a,tool_choice:{type:"function",function:{name:i.toolName}},toolWarnings:s};default:{const l=o;throw new gr({functionality:`Unsupported tool choice type: ${l}`})}}}var oxe=class{constructor(e,t,n){this.specificationVersion="v1";var r,s;this.modelId=e,this.settings=t,this.config=n;const i=(r=n.errorStructure)!=null?r:PE;this.chunkSchema=cxe(i.errorSchema),this.failedResponseHandler=Jh(i),this.supportsStructuredOutputs=(s=n.supportsStructuredOutputs)!=null?s:!1}get defaultObjectGenerationMode(){return this.config.defaultObjectGenerationMode}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,prompt:t,maxTokens:n,temperature:r,topP:s,topK:i,frequencyPenalty:a,presencePenalty:o,providerMetadata:l,stopSequences:c,responseFormat:u,seed:d}){var h,m,y,b,v;const x=e.type,w=[];i!=null&&w.push({type:"unsupported-setting",setting:"topK"}),(u==null?void 0:u.type)==="json"&&u.schema!=null&&!this.supportsStructuredOutputs&&w.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format schema is only supported with structuredOutputs"});const S={model:this.modelId,user:this.settings.user,max_tokens:n,temperature:r,top_p:s,frequency_penalty:a,presence_penalty:o,response_format:(u==null?void 0:u.type)==="json"?this.supportsStructuredOutputs===!0&&u.schema!=null?{type:"json_schema",json_schema:{schema:u.schema,name:(h=u.name)!=null?h:"response",description:u.description}}:{type:"json_object"}:void 0,stop:c,seed:d,...l==null?void 0:l[this.providerOptionsName],reasoning_effort:(b=(m=l==null?void 0:l[this.providerOptionsName])==null?void 0:m.reasoningEffort)!=null?b:(y=l==null?void 0:l["openai-compatible"])==null?void 0:y.reasoningEffort,messages:sxe(t)};switch(x){case"regular":{const{tools:k,tool_choice:C,toolWarnings:T}=axe({mode:e,structuredOutputs:this.supportsStructuredOutputs});return{args:{...S,tools:k,tool_choice:C},warnings:[...w,...T]}}case"object-json":return{args:{...S,response_format:this.supportsStructuredOutputs===!0&&e.schema!=null?{type:"json_schema",json_schema:{schema:e.schema,name:(v=e.name)!=null?v:"response",description:e.description}}:{type:"json_object"}},warnings:w};case"object-tool":return{args:{...S,tool_choice:{type:"function",function:{name:e.tool.name}},tools:[{type:"function",function:{name:e.tool.name,description:e.tool.description,parameters:e.tool.parameters}}]},warnings:w};default:{const k=x;throw new Error(`Unsupported type: ${k}`)}}}async doGenerate(e){var t,n,r,s,i,a,o,l,c,u,d;const{args:h,warnings:m}=this.getArgs({...e}),y=JSON.stringify(h),{responseHeaders:b,value:v,rawValue:x}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:h,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:Va(lxe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:w,...S}=h,k=v.choices[0],C={[this.providerOptionsName]:{},...(n=(t=this.config.metadataExtractor)==null?void 0:t.extractMetadata)==null?void 0:n.call(t,{parsedBody:x})},T=(r=v.usage)==null?void 0:r.completion_tokens_details,A=(s=v.usage)==null?void 0:s.prompt_tokens_details;return(T==null?void 0:T.reasoning_tokens)!=null&&(C[this.providerOptionsName].reasoningTokens=T==null?void 0:T.reasoning_tokens),(T==null?void 0:T.accepted_prediction_tokens)!=null&&(C[this.providerOptionsName].acceptedPredictionTokens=T==null?void 0:T.accepted_prediction_tokens),(T==null?void 0:T.rejected_prediction_tokens)!=null&&(C[this.providerOptionsName].rejectedPredictionTokens=T==null?void 0:T.rejected_prediction_tokens),(A==null?void 0:A.cached_tokens)!=null&&(C[this.providerOptionsName].cachedPromptTokens=A==null?void 0:A.cached_tokens),{text:(i=k.message.content)!=null?i:void 0,reasoning:(a=k.message.reasoning_content)!=null?a:void 0,toolCalls:(o=k.message.tool_calls)==null?void 0:o.map(N=>{var I;return{toolCallType:"function",toolCallId:(I=N.id)!=null?I:oa(),toolName:N.function.name,args:N.function.arguments}}),finishReason:$2(k.finish_reason),usage:{promptTokens:(c=(l=v.usage)==null?void 0:l.prompt_tokens)!=null?c:NaN,completionTokens:(d=(u=v.usage)==null?void 0:u.completion_tokens)!=null?d:NaN},providerMetadata:C,rawCall:{rawPrompt:w,rawSettings:S},rawResponse:{headers:b,body:x},response:B2(v),warnings:m,request:{body:y}}}async doStream(e){var t;if(this.settings.simulateStreaming){const b=await this.doGenerate(e);return{stream:new ReadableStream({start(x){if(x.enqueue({type:"response-metadata",...b.response}),b.reasoning)if(Array.isArray(b.reasoning))for(const w of b.reasoning)w.type==="text"&&x.enqueue({type:"reasoning",textDelta:w.text});else x.enqueue({type:"reasoning",textDelta:b.reasoning});if(b.text&&x.enqueue({type:"text-delta",textDelta:b.text}),b.toolCalls)for(const w of b.toolCalls)x.enqueue({type:"tool-call",...w});x.enqueue({type:"finish",finishReason:b.finishReason,usage:b.usage,logprobs:b.logprobs,providerMetadata:b.providerMetadata}),x.close()}}),rawCall:b.rawCall,rawResponse:b.rawResponse,warnings:b.warnings}}const{args:n,warnings:r}=this.getArgs({...e}),s={...n,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},i=(t=this.config.metadataExtractor)==null?void 0:t.createStreamExtractor(),{responseHeaders:a,value:o}=await Ws({url:this.config.url({path:"/chat/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:s,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:Qh(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{messages:l,...c}=n,u=[];let d="unknown",h={completionTokens:void 0,completionTokensDetails:{reasoningTokens:void 0,acceptedPredictionTokens:void 0,rejectedPredictionTokens:void 0},promptTokens:void 0,promptTokensDetails:{cachedTokens:void 0}},m=!0,y=this.providerOptionsName;return{stream:o.pipeThrough(new TransformStream({transform(b,v){var x,w,S,k,C,T,A,N,I,O,B,D;if(!b.success){d="error",v.enqueue({type:"error",error:b.error});return}const H=b.value;if(i==null||i.processChunk(b.rawValue),"error"in H){d="error",v.enqueue({type:"error",error:H.error.message});return}if(m&&(m=!1,v.enqueue({type:"response-metadata",...B2(H)})),H.usage!=null){const{prompt_tokens:U,completion_tokens:V,prompt_tokens_details:L,completion_tokens_details:te}=H.usage;h.promptTokens=U??void 0,h.completionTokens=V??void 0,(te==null?void 0:te.reasoning_tokens)!=null&&(h.completionTokensDetails.reasoningTokens=te==null?void 0:te.reasoning_tokens),(te==null?void 0:te.accepted_prediction_tokens)!=null&&(h.completionTokensDetails.acceptedPredictionTokens=te==null?void 0:te.accepted_prediction_tokens),(te==null?void 0:te.rejected_prediction_tokens)!=null&&(h.completionTokensDetails.rejectedPredictionTokens=te==null?void 0:te.rejected_prediction_tokens),(L==null?void 0:L.cached_tokens)!=null&&(h.promptTokensDetails.cachedTokens=L==null?void 0:L.cached_tokens)}const P=H.choices[0];if((P==null?void 0:P.finish_reason)!=null&&(d=$2(P.finish_reason)),(P==null?void 0:P.delta)==null)return;const K=P.delta;if(K.reasoning_content!=null&&v.enqueue({type:"reasoning",textDelta:K.reasoning_content}),K.content!=null&&v.enqueue({type:"text-delta",textDelta:K.content}),K.tool_calls!=null)for(const U of K.tool_calls){const V=U.index;if(u[V]==null){if(U.type!=="function")throw new Ld({data:U,message:"Expected 'function' type."});if(U.id==null)throw new Ld({data:U,message:"Expected 'id' to be a string."});if(((x=U.function)==null?void 0:x.name)==null)throw new Ld({data:U,message:"Expected 'function.name' to be a string."});u[V]={id:U.id,type:"function",function:{name:U.function.name,arguments:(w=U.function.arguments)!=null?w:""},hasFinished:!1};const te=u[V];((S=te.function)==null?void 0:S.name)!=null&&((k=te.function)==null?void 0:k.arguments)!=null&&(te.function.arguments.length>0&&v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:te.id,toolName:te.function.name,argsTextDelta:te.function.arguments}),gm(te.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(C=te.id)!=null?C:oa(),toolName:te.function.name,args:te.function.arguments}),te.hasFinished=!0));continue}const L=u[V];L.hasFinished||(((T=U.function)==null?void 0:T.arguments)!=null&&(L.function.arguments+=(N=(A=U.function)==null?void 0:A.arguments)!=null?N:""),v.enqueue({type:"tool-call-delta",toolCallType:"function",toolCallId:L.id,toolName:L.function.name,argsTextDelta:(I=U.function.arguments)!=null?I:""}),((O=L.function)==null?void 0:O.name)!=null&&((B=L.function)==null?void 0:B.arguments)!=null&&gm(L.function.arguments)&&(v.enqueue({type:"tool-call",toolCallType:"function",toolCallId:(D=L.id)!=null?D:oa(),toolName:L.function.name,args:L.function.arguments}),L.hasFinished=!0))}},flush(b){var v,x;const w={[y]:{},...i==null?void 0:i.buildMetadata()};h.completionTokensDetails.reasoningTokens!=null&&(w[y].reasoningTokens=h.completionTokensDetails.reasoningTokens),h.completionTokensDetails.acceptedPredictionTokens!=null&&(w[y].acceptedPredictionTokens=h.completionTokensDetails.acceptedPredictionTokens),h.completionTokensDetails.rejectedPredictionTokens!=null&&(w[y].rejectedPredictionTokens=h.completionTokensDetails.rejectedPredictionTokens),h.promptTokensDetails.cachedTokens!=null&&(w[y].cachedPromptTokens=h.promptTokensDetails.cachedTokens),b.enqueue({type:"finish",finishReason:d,usage:{promptTokens:(v=h.promptTokens)!=null?v:NaN,completionTokens:(x=h.completionTokens)!=null?x:NaN},providerMetadata:w})}})),rawCall:{rawPrompt:l,rawSettings:c},rawResponse:{headers:a},warnings:r,request:{body:JSON.stringify(s)}}}},BG=Ke({prompt_tokens:At().nullish(),completion_tokens:At().nullish(),prompt_tokens_details:Ke({cached_tokens:At().nullish()}).nullish(),completion_tokens_details:Ke({reasoning_tokens:At().nullish(),accepted_prediction_tokens:At().nullish(),rejected_prediction_tokens:At().nullish()}).nullish()}).nullish(),lxe=Ke({id:$e().nullish(),created:At().nullish(),model:$e().nullish(),choices:ln(Ke({message:Ke({role:Mn("assistant").nullish(),content:$e().nullish(),reasoning_content:$e().nullish(),tool_calls:ln(Ke({id:$e().nullish(),type:Mn("function"),function:Ke({name:$e(),arguments:$e()})})).nullish()}),finish_reason:$e().nullish()})),usage:BG}),cxe=e=>ms([Ke({id:$e().nullish(),created:At().nullish(),model:$e().nullish(),choices:ln(Ke({delta:Ke({role:vl(["assistant"]).nullish(),content:$e().nullish(),reasoning_content:$e().nullish(),tool_calls:ln(Ke({index:At(),id:$e().nullish(),type:Mn("function").nullish(),function:Ke({name:$e().nullish(),arguments:$e().nullish()})})).nullish()}).nullish(),finish_reason:$e().nullish()})),usage:BG}),e]);function uxe({prompt:e,inputFormat:t,user:n="user",assistant:r="assistant"}){if(t==="prompt"&&e.length===1&&e[0].role==="user"&&e[0].content.length===1&&e[0].content[0].type==="text")return{prompt:e[0].content[0].text};let s="";e[0].role==="system"&&(s+=`${e[0].content}

`,e=e.slice(1));for(const{role:i,content:a}of e)switch(i){case"system":throw new xc({message:"Unexpected system message in prompt: ${content}",prompt:e});case"user":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"image":throw new gr({functionality:"images"})}}).join("");s+=`${n}:
${o}

`;break}case"assistant":{const o=a.map(l=>{switch(l.type){case"text":return l.text;case"tool-call":throw new gr({functionality:"tool-call messages"})}}).join("");s+=`${r}:
${o}

`;break}case"tool":throw new gr({functionality:"tool messages"});default:{const o=i;throw new Error(`Unsupported role: ${o}`)}}return s+=`${r}:
`,{prompt:s,stopSequences:[`
${n}:`]}}var dxe=class{constructor(e,t,n){this.specificationVersion="v1",this.defaultObjectGenerationMode=void 0;var r;this.modelId=e,this.settings=t,this.config=n;const s=(r=n.errorStructure)!=null?r:PE;this.chunkSchema=hxe(s.errorSchema),this.failedResponseHandler=Jh(s)}get provider(){return this.config.provider}get providerOptionsName(){return this.config.provider.split(".")[0].trim()}getArgs({mode:e,inputFormat:t,prompt:n,maxTokens:r,temperature:s,topP:i,topK:a,frequencyPenalty:o,presencePenalty:l,stopSequences:c,responseFormat:u,seed:d,providerMetadata:h}){var m;const y=e.type,b=[];a!=null&&b.push({type:"unsupported-setting",setting:"topK"}),u!=null&&u.type!=="text"&&b.push({type:"unsupported-setting",setting:"responseFormat",details:"JSON response format is not supported."});const{prompt:v,stopSequences:x}=uxe({prompt:n,inputFormat:t}),w=[...x??[],...c??[]],S={model:this.modelId,echo:this.settings.echo,logit_bias:this.settings.logitBias,suffix:this.settings.suffix,user:this.settings.user,max_tokens:r,temperature:s,top_p:i,frequency_penalty:o,presence_penalty:l,seed:d,...h==null?void 0:h[this.providerOptionsName],prompt:v,stop:w.length>0?w:void 0};switch(y){case"regular":{if((m=e.tools)!=null&&m.length)throw new gr({functionality:"tools"});if(e.toolChoice)throw new gr({functionality:"toolChoice"});return{args:S,warnings:b}}case"object-json":throw new gr({functionality:"object-json mode"});case"object-tool":throw new gr({functionality:"object-tool mode"});default:{const k=y;throw new Error(`Unsupported type: ${k}`)}}}async doGenerate(e){var t,n,r,s;const{args:i,warnings:a}=this.getArgs(e),{responseHeaders:o,value:l,rawValue:c}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:i,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:Va(fxe),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:u,...d}=i,h=l.choices[0];return{text:h.text,usage:{promptTokens:(n=(t=l.usage)==null?void 0:t.prompt_tokens)!=null?n:NaN,completionTokens:(s=(r=l.usage)==null?void 0:r.completion_tokens)!=null?s:NaN},finishReason:$2(h.finish_reason),rawCall:{rawPrompt:u,rawSettings:d},rawResponse:{headers:o,body:c},response:B2(l),warnings:a,request:{body:JSON.stringify(i)}}}async doStream(e){const{args:t,warnings:n}=this.getArgs(e),r={...t,stream:!0,stream_options:this.config.includeUsage?{include_usage:!0}:void 0},{responseHeaders:s,value:i}=await Ws({url:this.config.url({path:"/completions",modelId:this.modelId}),headers:Vs(this.config.headers(),e.headers),body:r,failedResponseHandler:this.failedResponseHandler,successfulResponseHandler:Qh(this.chunkSchema),abortSignal:e.abortSignal,fetch:this.config.fetch}),{prompt:a,...o}=t;let l="unknown",c={promptTokens:Number.NaN,completionTokens:Number.NaN},u=!0;return{stream:i.pipeThrough(new TransformStream({transform(d,h){if(!d.success){l="error",h.enqueue({type:"error",error:d.error});return}const m=d.value;if("error"in m){l="error",h.enqueue({type:"error",error:m.error});return}u&&(u=!1,h.enqueue({type:"response-metadata",...B2(m)})),m.usage!=null&&(c={promptTokens:m.usage.prompt_tokens,completionTokens:m.usage.completion_tokens});const y=m.choices[0];(y==null?void 0:y.finish_reason)!=null&&(l=$2(y.finish_reason)),(y==null?void 0:y.text)!=null&&h.enqueue({type:"text-delta",textDelta:y.text})},flush(d){d.enqueue({type:"finish",finishReason:l,usage:c})}})),rawCall:{rawPrompt:a,rawSettings:o},rawResponse:{headers:s},warnings:n,request:{body:JSON.stringify(r)}}}},fxe=Ke({id:$e().nullish(),created:At().nullish(),model:$e().nullish(),choices:ln(Ke({text:$e(),finish_reason:$e()})),usage:Ke({prompt_tokens:At(),completion_tokens:At()}).nullish()}),hxe=e=>ms([Ke({id:$e().nullish(),created:At().nullish(),model:$e().nullish(),choices:ln(Ke({text:$e(),finish_reason:$e().nullish(),index:At()})),usage:Ke({prompt_tokens:At(),completion_tokens:At()}).nullish()}),e]),pxe=class{constructor(e,t,n){this.specificationVersion="v1",this.modelId=e,this.settings=t,this.config=n}get provider(){return this.config.provider}get maxEmbeddingsPerCall(){var e;return(e=this.config.maxEmbeddingsPerCall)!=null?e:2048}get supportsParallelCalls(){var e;return(e=this.config.supportsParallelCalls)!=null?e:!0}async doEmbed({values:e,headers:t,abortSignal:n}){var r;if(e.length>this.maxEmbeddingsPerCall)throw new RE({provider:this.provider,modelId:this.modelId,maxEmbeddingsPerCall:this.maxEmbeddingsPerCall,values:e});const{responseHeaders:s,value:i}=await Ws({url:this.config.url({path:"/embeddings",modelId:this.modelId}),headers:Vs(this.config.headers(),t),body:{model:this.modelId,input:e,encoding_format:"float",dimensions:this.settings.dimensions,user:this.settings.user},failedResponseHandler:Jh((r=this.config.errorStructure)!=null?r:PE),successfulResponseHandler:Va(mxe),abortSignal:n,fetch:this.config.fetch});return{embeddings:i.data.map(a=>a.embedding),usage:i.usage?{tokens:i.usage.prompt_tokens}:void 0,rawResponse:{headers:s}}}},mxe=Ke({data:ln(Ke({embedding:ln(At())})),usage:Ke({prompt_tokens:At()}).nullish()}),gxe=class{constructor(e,t,n){this.modelId=e,this.settings=t,this.config=n,this.specificationVersion="v1"}get maxImagesPerCall(){var e;return(e=this.settings.maxImagesPerCall)!=null?e:10}get provider(){return this.config.provider}async doGenerate({prompt:e,n:t,size:n,aspectRatio:r,seed:s,providerOptions:i,headers:a,abortSignal:o}){var l,c,u,d,h;const m=[];r!=null&&m.push({type:"unsupported-setting",setting:"aspectRatio",details:"This model does not support aspect ratio. Use `size` instead."}),s!=null&&m.push({type:"unsupported-setting",setting:"seed"});const y=(u=(c=(l=this.config._internal)==null?void 0:l.currentDate)==null?void 0:c.call(l))!=null?u:new Date,{value:b,responseHeaders:v}=await Ws({url:this.config.url({path:"/images/generations",modelId:this.modelId}),headers:Vs(this.config.headers(),a),body:{model:this.modelId,prompt:e,n:t,size:n,...(d=i.openai)!=null?d:{},response_format:"b64_json",...this.settings.user?{user:this.settings.user}:{}},failedResponseHandler:Jh((h=this.config.errorStructure)!=null?h:PE),successfulResponseHandler:Va(yxe),abortSignal:o,fetch:this.config.fetch});return{images:b.data.map(x=>x.b64_json),warnings:m,response:{timestamp:y,modelId:this.modelId,headers:v}}}},yxe=Ke({data:ln(Ke({b64_json:$e()}))});function bxe(e){const t=x1(e.baseURL),n=e.name,r=()=>({...e.apiKey&&{Authorization:`Bearer ${e.apiKey}`},...e.headers}),s=d=>({provider:`${n}.${d}`,url:({path:h})=>{const m=new URL(`${t}${h}`);return e.queryParams&&(m.search=new URLSearchParams(e.queryParams).toString()),m.toString()},headers:r,fetch:e.fetch}),i=(d,h={})=>a(d,h),a=(d,h={})=>new oxe(d,h,{...s("chat"),defaultObjectGenerationMode:"tool"}),o=(d,h={})=>new dxe(d,h,s("completion")),l=(d,h={})=>new pxe(d,h,s("embedding")),c=(d,h={})=>new gxe(d,h,s("image")),u=(d,h)=>i(d,h);return u.languageModel=i,u.chatModel=a,u.completionModel=o,u.textEmbeddingModel=l,u.imageModel=c,u}const Rx=(e,t)=>`${e}:${t}`,Ac=e=>{if(!e||!e.includes(":"))return{providerId:null,modelId:null};const t=e.split(":"),n=t[0],r=t.slice(1).join(":");return{providerId:n,modelId:r}},ly=e=>e==="openai"||e==="openrouter"||e==="google",z2=e=>e==="ollama"||e==="openai-compatible",ym=e=>e==="openai"||e==="openrouter"||e==="ollama"||e==="openai-compatible",Ao=[{value:"openrouter",label:"OpenRouter"},{value:"openai",label:"OpenAI"},{value:"ollama",label:"Ollama"},{value:"openai-compatible",label:"OpenAI-Compatible (LMStudio, etc.)"},{value:"google",label:"Google Gemini"}],vxe={openai:[{id:"gpt-4o",name:"GPT-4o"},{id:"dall-e-3",name:"DALL-E 3"},{id:"dall-e-2",name:"DALL-E 2"},{id:"o3-mini",name:"o3-mini"},{id:"o4-mini",name:"o4-mini"},{id:"o4-mini-high",name:"o4-mini-high"},{id:"o3-mini-high",name:"o3-mini-high"},{id:"o3",name:"o3"},{id:"4.1",name:"4.1"},{id:"4.1-mini",name:"4.1-mini"},{id:"4.1-nano",name:"4.1-nano"},{id:"o3-pro",name:"o3-pro"},{id:"codex-mini",name:"codex-mini"}],google:[{id:"gemini-2.5-pro-preview",name:"Gemini 2.5 Pro Preview"},{id:"gemini-2.5-flash-preview-05-20:thinking",name:"Gemini 2.5 Flash Preview (Thinking)"},{id:"gemini-2.5-flash-preview",name:"Gemini 2.5 Flash Preview"},{id:"gemini-2.0-flash-001",name:"Gemini 2.0 Flash"}],openrouter:[],ollama:[{id:"llama3",name:"Llama 3 (Ollama)"}],"openai-compatible":[]},$G=e=>{try{const t=e.replace(/\/+$/,"");return/\/(v\d+(\.\d+)*)$/.test(t)?t:t+"/v1"}catch(t){return console.error("Error processing base URL:",e,t),e.replace(/\/+$/,"")}};function lO(e,t,n){try{switch(e.type){case"openai":return RG({apiKey:n})(t);case"google":return jG({apiKey:n})(t);case"openrouter":const s=FG({apiKey:n,extraBody:{include_reasoning:!0}})(t),i=s.doStream.bind(s);return s.doStream=async function(a){const o=await i(a),l=o.stream.getReader(),c=new ReadableStream({async start(u){try{for(;;){const{done:d,value:h}=await l.read();if(d)break;u.enqueue(h)}}catch(d){d&&typeof d=="object"&&"message"in d&&typeof d.message=="string"&&d.message.includes("reading 'sent'")?console.warn("[OpenRouter Provider Bug] Caught toolCall.sent error, attempting graceful recovery"):u.error(d)}finally{u.close()}}});return{...o,stream:c}},s;case"ollama":return LG({baseURL:e.baseURL??void 0})(t);case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required");return bxe({baseURL:$G(e.baseURL),apiKey:n,name:e.name||"Custom API"})(t);default:return console.warn(`Unsupported provider type: ${e.type}`),null}}catch(r){return console.error(`Failed instantiate model ${t} for ${e.name}:`,r),null}}function zG(e,t,n){const s=Qn.getState().getAllAvailableModelDefsForProvider(e.id).find(a=>a.id===t);if(!s){console.warn(`Model definition not found for ${t} in provider ${e.name}`);return}const i=lO(e,t,n);if(!i){console.warn(`Failed to instantiate AI SDK instance for ${t} from provider ${e.name}`);return}return{id:Rx(e.id,t),name:s.name,providerId:e.id,providerName:e.name,instance:i,metadata:s}}const UG={openai:["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs"],google:["max_tokens","temperature","top_p","top_k","stop","tools","tool_choice"],ollama:["max_tokens","temperature","top_p","top_k","stop","presence_penalty","frequency_penalty","seed","repetition_penalty","response_format"],"openai-compatible":["max_tokens","temperature","top_p","stop","presence_penalty","frequency_penalty","seed","logit_bias","response_format","tools","tool_choice","logprobs","top_logprobs","repetition_penalty","min_p","top_k"],openrouter:[]},Bv=new Map,xxe=5*60*1e3,wxe=(e,t)=>{var i,a,o,l,c,u,d,h,m,y,b,v,x,w;const n=e.id||e.name,r=e.name||n,s={id:n,name:r,created:e.created??null,description:e.description??null,context_length:e.context_length??null,architecture:{modality:((i=e.architecture)==null?void 0:i.modality)??"text->text",input_modalities:((a=e.architecture)==null?void 0:a.input_modalities)??["text"],output_modalities:((o=e.architecture)==null?void 0:o.output_modalities)??["text"],tokenizer:((l=e.architecture)==null?void 0:l.tokenizer)??"Unknown",instruct_type:((c=e.architecture)==null?void 0:c.instruct_type)??null},pricing:{prompt:((u=e.pricing)==null?void 0:u.prompt)??"0",completion:((d=e.pricing)==null?void 0:d.completion)??"0",request:((h=e.pricing)==null?void 0:h.request)??"0",image:((m=e.pricing)==null?void 0:m.image)??"0",web_search:((y=e.pricing)==null?void 0:y.web_search)??"0",internal_reasoning:((b=e.pricing)==null?void 0:b.internal_reasoning)??"0"},top_provider:{context_length:((v=e.top_provider)==null?void 0:v.context_length)??e.context_length??null,max_completion_tokens:((x=e.top_provider)==null?void 0:x.max_completion_tokens)??null,is_moderated:((w=e.top_provider)==null?void 0:w.is_moderated)??!1},per_request_limits:e.per_request_limits??null,supported_parameters:e.supported_parameters??UG[t]??[]};return t==="ollama"?(s.context_length=s.context_length??4096,s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Ollama")):t==="openai"?(n.includes("gpt-4")&&(s.context_length=8192),n.includes("gpt-4-32k")&&(s.context_length=32768),n.includes("gpt-4-turbo")&&(s.context_length=128e3),n.includes("gpt-4o")&&(s.context_length=128e3),n.includes("gpt-3.5-turbo")&&(s.context_length=16385),s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="OpenAI")):t==="google"?(n.includes("gemini-1.5")?s.context_length=1048576:n.includes("gemini")&&(s.context_length=32768),s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Google")):t==="openai-compatible"&&(s.context_length=s.context_length??4096,s.top_provider&&(s.top_provider.context_length=s.context_length),s.architecture&&(s.architecture.tokenizer="Compatible")),s};async function _xe(e,t){const n=`${e.id}-${e.baseURL||""}`,r=Bv.get(n);if(r)return console.log(`[ModelFetcher] Using cache for provider ${e.name} (ID: ${e.id})`),r;const s=(async()=>{var o,l,c;let i;const a={Accept:"application/json"};t&&(a.Authorization=`Bearer ${t}`);try{switch(e.type){case"openai":if(!t)throw new Error("API Key required for OpenAI");i="https://api.openai.com/v1/models";break;case"openrouter":if(!t)throw new Error("API Key required for OpenRouter");i="https://openrouter.ai/api/v1/models",a["HTTP-Referer"]=((o=globalThis.location)==null?void 0:o.origin)||"http://localhost:3000",a["X-Title"]="LiteChat";break;case"ollama":const u=((l=e.baseURL)==null?void 0:l.replace(/\/$/,""))||"http://localhost:11434";i=new URL("/api/tags",u).toString(),delete a.Authorization;break;case"openai-compatible":if(!e.baseURL)throw new Error("Base URL required for OpenAI-Compatible");const d=$G(e.baseURL);i=new URL("models",d.endsWith("/")?d:d+"/").toString();break;case"google":default:return console.log(`[ModelFetcher] Model fetching not supported via API for type: ${e.type}. Returning empty list.`),[]}}catch(u){return console.error(`[ModelFetcher] Error constructing URL for ${e.name}:`,u),Te.error(`Invalid Base URL for ${e.name}: ${u instanceof Error?u.message:String(u)}`),[]}console.log(`[ModelFetcher] Fetching models for ${e.name} (Type: ${e.type}) from ${i}`);try{const u=await fetch(i,{headers:a});if(!u.ok){let y=`(${u.status} ${u.statusText})`;try{const b=await u.text();y=b||y;try{const v=JSON.parse(b);y=((c=v==null?void 0:v.error)==null?void 0:c.message)||(v==null?void 0:v.message)||y}catch{}}catch(b){console.warn("[ModelFetcher] Failed to read error response body:",b)}throw new Error(`API Error: ${y}`)}const d=await u.json();let h=[];if(e.type==="ollama"?h=d.models||[]:h=d.data||d||[],!Array.isArray(h))return console.warn(`[ModelFetcher] Unexpected non-array response for ${e.name}:`,d),[];const m=h.map(y=>wxe(y,e.type));return m.sort((y,b)=>(y.name||y.id).localeCompare(b.name||b.id)),console.log(`[ModelFetcher] Fetched and mapped ${m.length} models for ${e.name}`),m}catch(u){const d=u instanceof Error?u.message:String(u);return console.error(`[ModelFetcher] Error fetching models for ${e.name}:`,d),Te.error(`Failed to fetch models for ${e.name}: ${d}`),Bv.delete(n),[]}})();return Bv.set(n,s),setTimeout(()=>{Bv.get(n)===s&&(Bv.delete(n),console.log(`[ModelFetcher] Cache expired for provider ${e.name} (ID: ${e.id})`))},xxe),s}const Wn={initialDataLoaded:"provider.initial.data.loaded",configsChanged:"provider.configs.changed",apiKeysChanged:"provider.api.keys.changed",selectedModelChanged:"provider.selected.model.changed",globalModelSortOrderChanged:"provider.global.model.sort.order.changed",fetchStatusChanged:"provider.fetch.status.changed",globallyEnabledModelsUpdated:"provider.globally.enabled.models.updated",selectedModelForDetailsChanged:"provider.selected.model.for.details.changed",enableApiKeyManagementChanged:"provider.enable.api.key.management.changed",loadInitialDataRequest:"provider.load.initial.data.request",selectModelRequest:"provider.select.model.request",addApiKeyRequest:"provider.add.api.key.request",deleteApiKeyRequest:"provider.delete.api.key.request",addProviderConfigRequest:"provider.add.config.request",updateProviderConfigRequest:"provider.update.config.request",deleteProviderConfigRequest:"provider.delete.config.request",fetchModelsRequest:"provider.fetch.models.request",setGlobalModelSortOrderRequest:"provider.set.global.model.sort.order.request",setEnableApiKeyManagementRequest:"provider.set.enable.api.key.management.request",setSelectedModelForDetailsRequest:"provider.set.selected.model.for.details.request"},NN="provider:lastModelSelection",_$="provider:globalModelSortOrder",Qn=Wo(Ho((e,t)=>({dbProviderConfigs:[],dbApiKeys:[],selectedModelId:null,globalModelSortOrder:[],providerFetchStatus:{},isLoading:!0,error:null,enableApiKeyManagement:!0,_selectedModelForDetails:null,globallyEnabledModelDefinitions:[],_updateGloballyEnabledModelDefinitions:()=>{const{dbProviderConfigs:n,globalModelSortOrder:r}=t(),s=t().getAvailableModelListItems(),i=new Map(s.map(u=>[u.id,u])),a=new Set;n.forEach(u=>{u.isEnabled&&u.enabledModels&&u.enabledModels.forEach(d=>{a.add(Rx(u.id,d))})});const o=[],l=new Set;r.forEach(u=>{if(a.has(u)){const d=i.get(u);d&&!l.has(u)&&(o.push(d),l.add(u))}});const c=s.filter(u=>a.has(u.id)&&!l.has(u.id)).sort((u,d)=>u.name.localeCompare(d.name));o.push(...c),e({globallyEnabledModelDefinitions:o}),Re.emit(Wn.globallyEnabledModelsUpdated,{models:o})},getGloballyEnabledModelDefinitions:()=>t().globallyEnabledModelDefinitions,createAiModelConfig:(n,r,s)=>{const a=t().getAllAvailableModelDefsForProvider(n.id).find(l=>l.id===r);if(!a){console.warn(`Model definition not found for ${r} in provider ${n.name}`);return}const o=lO(n,r,s);if(!o){console.warn(`Failed to instantiate AI SDK instance for ${r} from provider ${n.name}`);return}return{id:Rx(n.id,r),name:a.name,providerId:n.id,providerName:n.name,instance:o,metadata:a}},setEnableApiKeyManagement:n=>{e({enableApiKeyManagement:n}),bt.saveSetting("enableApiKeyManagement",n),Re.emit(Wn.enableApiKeyManagementChanged,{enabled:n})},loadInitialData:async()=>{e({isLoading:!0,error:null});try{const n=await bt.loadSetting("enableApiKeyManagement",!0),[r,s,i,a]=await Promise.all([bt.loadProviderConfigs(),bt.loadApiKeys(),bt.loadSetting(_$,[]),bt.loadSetting(NN,null)]);e({dbProviderConfigs:r,dbApiKeys:s,enableApiKeyManagement:n,globalModelSortOrder:i}),t()._updateGloballyEnabledModelDefinitions();const o=t().globallyEnabledModelDefinitions.map(d=>d.id),l=new Set(o);let c=a;c&&l.has(c)||(c=o[0]??null),e({selectedModelId:c,isLoading:!1}),await bt.saveSetting(NN,c),Re.emit(Wn.initialDataLoaded,{configs:r,apiKeys:s,selectedModelId:c,globalSortOrder:t().globalModelSortOrder}),t().selectedModelId!==c?t().selectModel(c):Re.emit(Wn.selectedModelChanged,{modelId:c})}catch(n){console.error("ProviderStore: Error loading initial data",n),e({isLoading:!1,error:"Failed to load provider data"}),Te.error("Failed to load provider data")}},selectModel:n=>{t().selectedModelId!==n&&(e({selectedModelId:n}),bt.saveSetting(NN,n),Re.emit(Wn.selectedModelChanged,{modelId:n}))},addApiKey:async(n,r,s)=>{const i=qr(),a=new Date,o={id:i,name:n,value:s,providerId:r,createdAt:a,updatedAt:a};try{return await bt.saveApiKey(o),e(l=>{l.dbApiKeys.push(o)}),Te.success(`API Key "${n}" added.`),Re.emit(Wn.apiKeysChanged,{apiKeys:t().dbApiKeys}),i}catch(l){throw console.error("ProviderStore: Error adding API key",l),Te.error(`Failed to add API Key: ${l instanceof Error?l.message:String(l)}`),l}},deleteApiKey:async n=>{var s;const r=((s=t().dbApiKeys.find(i=>i.id===n))==null?void 0:s.name)??"Unknown Key";try{await bt.deleteApiKey(n),e(i=>{i.dbApiKeys=i.dbApiKeys.filter(a=>a.id!==n),i.dbProviderConfigs=i.dbProviderConfigs.map(a=>a.apiKeyId===n?{...a,apiKeyId:null}:a)}),Te.success(`API Key "${r}" deleted.`),Re.emit(Wn.apiKeysChanged,{apiKeys:t().dbApiKeys}),Re.emit(Wn.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(i){throw console.error("ProviderStore: Error deleting API key",i),Te.error(`Failed to delete API Key: ${i instanceof Error?i.message:String(i)}`),i}},addProviderConfig:async n=>{const r=qr(),s=new Date,i={id:r,createdAt:s,updatedAt:s,name:n.name,type:n.type,isEnabled:n.isEnabled??!0,apiKeyId:n.apiKeyId??null,baseURL:n.baseURL??null,enabledModels:n.enabledModels??null,autoFetchModels:n.autoFetchModels??!0,fetchedModels:n.fetchedModels??null,modelsLastFetchedAt:n.modelsLastFetchedAt??null};try{return await bt.saveProviderConfig(i),e(a=>{a.dbProviderConfigs.push(i)}),t()._updateGloballyEnabledModelDefinitions(),Te.success(`Provider "${n.name}" added.`),Re.emit(Wn.configsChanged,{providerConfigs:t().dbProviderConfigs}),t().fetchModels(r).catch(a=>{console.warn(`[ProviderStore] Initial model fetch failed for new provider ${r}:`,a)}),r}catch(a){throw console.error("ProviderStore: Error adding provider config",a),Te.error(`Failed to add Provider: ${a instanceof Error?a.message:String(a)}`),a}},updateProviderConfig:async(n,r)=>{const s=t().dbProviderConfigs.find(a=>a.id===n);if(!s)return;const i={...s,...r,fetchedModels:r.fetchedModels!==void 0?r.fetchedModels:s.fetchedModels,modelsLastFetchedAt:r.modelsLastFetchedAt!==void 0?r.modelsLastFetchedAt:s.modelsLastFetchedAt,updatedAt:new Date};try{await bt.saveProviderConfig(i),e(a=>{const o=a.dbProviderConfigs.findIndex(l=>l.id===n);o!==-1&&(a.dbProviderConfigs[o]=i)}),t()._updateGloballyEnabledModelDefinitions(),Re.emit(Wn.configsChanged,{providerConfigs:t().dbProviderConfigs})}catch(a){throw console.error("ProviderStore: Error updating provider config",a),Te.error(`Failed to update Provider: ${a instanceof Error?a.message:String(a)}`),a}},deleteProviderConfig:async n=>{const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r)return;const s=r.name;try{await bt.deleteProviderConfig(n),e(i=>{i.dbProviderConfigs=i.dbProviderConfigs.filter(a=>a.id!==n),delete i.providerFetchStatus[n]}),t()._updateGloballyEnabledModelDefinitions(),Re.emit(Wn.configsChanged,{providerConfigs:t().dbProviderConfigs}),Te.success(`Provider "${s}" deleted.`)}catch(i){throw console.error("ProviderStore: Error deleting provider config",i),Te.error(`Failed to delete Provider: ${i instanceof Error?i.message:String(i)}`),i}},fetchModels:async n=>{var s;const r=t().dbProviderConfigs.find(i=>i.id===n);if(!r){Te.error("Provider configuration not found for fetching models.");return}if(t().providerFetchStatus[n]!=="fetching"){t()._setProviderFetchStatus(n,"fetching");try{const i=r.apiKeyId,a=(s=t().dbApiKeys.find(l=>l.id===i))==null?void 0:s.value,o=await _xe(r,a);await t().updateProviderConfig(n,{fetchedModels:o,modelsLastFetchedAt:new Date}),t()._setProviderFetchStatus(n,"success"),Te.success(`Models fetched successfully for ${r.name}`)}catch(i){console.error(`Error fetching models for ${r.name}:`,i),t()._setProviderFetchStatus(n,"error")}}},setGlobalModelSortOrder:async n=>{const r=Array.from(new Set(n));e({globalModelSortOrder:r}),await bt.saveSetting(_$,r),t()._updateGloballyEnabledModelDefinitions(),Re.emit(Wn.globalModelSortOrderChanged,{ids:r});const s=t().selectedModelId,i=t().globallyEnabledModelDefinitions.map(o=>o.id),a=new Set(i);if(!s||!a.has(s)){const o=i[0]??null;o!==s&&t().selectModel(o)}},_setProviderFetchStatus:(n,r)=>{e(s=>{s.providerFetchStatus[n]=r}),Re.emit(Wn.fetchStatusChanged,{providerId:n,status:r})},setSelectedModelForDetails:n=>{e({_selectedModelForDetails:n}),Re.emit(Wn.selectedModelForDetailsChanged,{modelId:n})},getSelectedModel:()=>{const{selectedModelId:n}=t();if(!n)return;const{providerId:r,modelId:s}=Ac(n);if(!r||!s)return;const i=t().dbProviderConfigs.find(o=>o.id===r);if(!i)return;const a=t().dbApiKeys.find(o=>o.id===i.apiKeyId);return t().createAiModelConfig(i,s,a==null?void 0:a.value)},getApiKeyForProvider:n=>{var s;const r=t().dbProviderConfigs.find(i=>i.id===n);return(s=t().dbApiKeys.find(i=>i.id===(r==null?void 0:r.apiKeyId)))==null?void 0:s.value},getActiveProviders:()=>t().dbProviderConfigs.filter(n=>n.isEnabled).map(n=>{const r=t().getAllAvailableModelDefsForProvider(n.id);return{id:n.id,name:n.name,type:n.type,allAvailableModels:r}}),getAllAvailableModelDefsForProvider:n=>{const r=t().dbProviderConfigs.find(a=>a.id===n);if(!r)return[];if(r.fetchedModels&&r.fetchedModels.length>0)return[...r.fetchedModels];const s=r.type;return(vxe[s]||[]).map(a=>{let o="text->text",l=["text"],c=["text"];return(a.id.includes("dall-e")||a.id.includes("imagen")||a.id.includes("flux")||a.id.includes("stable-diffusion"))&&(o="text->image",l=["text"],c=["image"]),{id:a.id,name:a.name,context_length:4096,architecture:{modality:o,input_modalities:l,output_modalities:c},pricing:{prompt:"0",completion:"0"},top_provider:{context_length:4096},supported_parameters:UG[r.type]??[]}})},getAvailableModelListItems:()=>{const{dbProviderConfigs:n}=t(),r=[];return n.forEach(s=>{t().getAllAvailableModelDefsForProvider(s.id).forEach(a=>{var o,l,c;r.push({id:Rx(s.id,a.id),name:a.name,providerId:s.id,providerName:s.name,metadataSummary:{context_length:((o=a.top_provider)==null?void 0:o.context_length)??a.context_length,supported_parameters:a.supported_parameters,input_modalities:(l=a.architecture)==null?void 0:l.input_modalities,output_modalities:(c=a.architecture)==null?void 0:c.output_modalities,pricing:a.pricing,description:a.description}})})}),r},getRegisteredActionHandlers:()=>{const n="providerStore",r=t();return[{eventName:Wn.loadInitialDataRequest,handler:r.loadInitialData,storeId:n},{eventName:Wn.selectModelRequest,handler:s=>r.selectModel(s.modelId),storeId:n},{eventName:Wn.addApiKeyRequest,handler:s=>r.addApiKey(s.name,s.providerId,s.value).then(()=>{}),storeId:n},{eventName:Wn.deleteApiKeyRequest,handler:s=>r.deleteApiKey(s.id),storeId:n},{eventName:Wn.addProviderConfigRequest,handler:s=>r.addProviderConfig(s).then(()=>{}),storeId:n},{eventName:Wn.updateProviderConfigRequest,handler:s=>r.updateProviderConfig(s.id,s.changes),storeId:n},{eventName:Wn.deleteProviderConfigRequest,handler:s=>r.deleteProviderConfig(s.id),storeId:n},{eventName:Wn.fetchModelsRequest,handler:s=>r.fetchModels(s.providerConfigId),storeId:n},{eventName:Wn.setGlobalModelSortOrderRequest,handler:s=>r.setGlobalModelSortOrder(s.ids),storeId:n},{eventName:Wn.setEnableApiKeyManagementRequest,handler:s=>r.setEnableApiKeyManagement(s.enabled),storeId:n},{eventName:Wn.setSelectedModelForDetailsRequest,handler:s=>r.setSelectedModelForDetails(s.modelId),storeId:n}]}}))),an={loaded:"settings.loaded",themeChanged:"settings.theme.changed",globalSystemPromptChanged:"settings.global.system.prompt.changed",temperatureChanged:"settings.temperature.changed",maxTokensChanged:"settings.max.tokens.changed",topPChanged:"settings.top.p.changed",topKChanged:"settings.top.k.changed",presencePenaltyChanged:"settings.presence.penalty.changed",frequencyPenaltyChanged:"settings.frequency.penalty.changed",enableAdvancedSettingsChanged:"settings.enable.advanced.settings.changed",enableStreamingMarkdownChanged:"settings.enable.streaming.markdown.changed",enableStreamingCodeBlockParsingChanged:"settings.enable.streaming.code.block.parsing.changed",foldStreamingCodeBlocksChanged:"settings.fold.streaming.code.blocks.changed",foldUserMessagesOnCompletionChanged:"settings.fold.user.messages.on.completion.changed",streamingRenderFpsChanged:"settings.streaming.render.fps.changed",gitUserNameChanged:"settings.git.user.name.changed",gitUserEmailChanged:"settings.git.user.email.changed",toolMaxStepsChanged:"settings.tool.max.steps.changed",prismThemeUrlChanged:"settings.prism.theme.url.changed",autoTitleEnabledChanged:"settings.auto.title.enabled.changed",autoTitleModelIdChanged:"settings.auto.title.model.id.changed",autoTitlePromptMaxLengthChanged:"settings.auto.title.prompt.max.length.changed",autoTitleIncludeFilesChanged:"settings.auto.title.include.files.changed",autoTitleIncludeRulesChanged:"settings.auto.title.include.rules.changed",customFontFamilyChanged:"settings.custom.font.family.changed",customFontSizeChanged:"settings.custom.font.size.changed",chatMaxWidthChanged:"settings.chat.max.width.changed",customThemeColorsChanged:"settings.custom.theme.colors.changed",autoScrollIntervalChanged:"settings.auto.scroll.interval.changed",enableAutoScrollOnStreamChanged:"settings.enable.auto.scroll.on.stream.changed",autoSyncOnStreamCompleteChanged:"settings.auto.sync.on.stream.complete.changed",autoInitializeReposOnStartupChanged:"settings.auto.initialize.repos.on.startup.changed",setThemeRequest:"settings.set.theme.request",setGlobalSystemPromptRequest:"settings.set.global.system.prompt.request",setTemperatureRequest:"settings.set.temperature.request",setMaxTokensRequest:"settings.set.max.tokens.request",setTopPRequest:"settings.set.top.p.request",setTopKRequest:"settings.set.top.k.request",setPresencePenaltyRequest:"settings.set.presence.penalty.request",setFrequencyPenaltyRequest:"settings.set.frequency.penalty.request",setEnableAdvancedSettingsRequest:"settings.set.enable.advanced.settings.request",setEnableStreamingMarkdownRequest:"settings.set.enable.streaming.markdown.request",setEnableStreamingCodeBlockParsingRequest:"settings.set.enable.streaming.code.block.parsing.request",setFoldStreamingCodeBlocksRequest:"settings.set.fold.streaming.code.blocks.request",setFoldUserMessagesOnCompletionRequest:"settings.set.fold.user.messages.on.completion.request",setStreamingRenderFpsRequest:"settings.set.streaming.render.fps.request",setGitUserNameRequest:"settings.set.git.user.name.request",setGitUserEmailRequest:"settings.set.git.user.email.request",setToolMaxStepsRequest:"settings.set.tool.max.steps.request",setPrismThemeUrlRequest:"settings.set.prism.theme.url.request",setAutoTitleEnabledRequest:"settings.set.auto.title.enabled.request",setAutoTitleModelIdRequest:"settings.set.auto.title.model.id.request",setAutoTitlePromptMaxLengthRequest:"settings.set.auto.title.prompt.max.length.request",setAutoTitleIncludeFilesRequest:"settings.set.auto.title.include.files.request",setAutoTitleIncludeRulesRequest:"settings.set.auto.title.include.rules.request",setCustomFontFamilyRequest:"settings.set.custom.font.family.request",setCustomFontSizeRequest:"settings.set.custom.font.size.request",setChatMaxWidthRequest:"settings.set.chat.max.width.request",setCustomThemeColorsRequest:"settings.set.custom.theme.colors.request",setCustomThemeColorRequest:"settings.set.custom.theme.color.request",setAutoScrollIntervalRequest:"settings.set.auto.scroll.interval.request",setEnableAutoScrollOnStreamRequest:"settings.set.enable.auto.scroll.on.stream.request",setAutoSyncOnStreamCompleteRequest:"settings.set.auto.sync.on.stream.complete.request",setAutoInitializeReposOnStartupRequest:"settings.set.auto.initialize.repos.on.startup.request",loadSettingsRequest:"settings.load.settings.request",resetGeneralSettingsRequest:"settings.reset.general.settings.request",resetAssistantSettingsRequest:"settings.reset.assistant.settings.request",resetThemeSettingsRequest:"settings.reset.theme.settings.request"},Sxe=`You are a helpful AI assistant used in LiteChat.

You are knowledgeable, friendly, and always strive to provide accurate and useful information. When you don't know something, you admit it honestly. You communicate clearly and concisely, adapting your tone to be appropriate for the context.

##Key principles
- Be helpful and respectful
- Provide accurate information
- Ask clarifying questions when needed
- Explain complex concepts clearly
- Acknowledge limitations honestly 


##Litechat codeblock support

### downloadable codeblocks

If you create gated blocks and you can infer a filepath or a name for it, you should create it as follow : 

\`\`\`language:relative/path/to/file.ext
The file content would be completely normal
\`\`\`

examples : 
\`\`\`jsx:src/components/button.jsx
export const Button = ({ children, onClick }) => {
  return <button onClick={onClick}>{children}</button>;
};
\`\`\`

\`\`\`markdown:readme.md
---
title: My Project
description: This is a project description
---

# My Project

This is a project description
\`\`\`

### MermaidJS diagrams

Litechat support MermaidJS diagrams. only valid uncommented diagrams are supported.
For example, if a user asks you a simple explanation on http request, you should use a sequence diagram like so : 
\`\`\`mermaid
sequenceDiagram
    participant Client as "Web Browser"
    participant Server as "Web Server"

    Note over Client,Server: User initiates HTTP request
    Client->>Server: HTTP Request (GET /index.html)
    Server->>Server: Process request
    Server->>Client: HTTP Response (200 OK, HTML content)
    Note over Client,Server: User receives response
\`\`\`

### Formedible codeblocks

For guided deterministic interaction with the user through a form, you can use the \`formedible\` codeblock.

**Functionality:**
- The \`formedible\` block interprets a JavaScript object literal that defines a form structure.
- It supports multi-page forms, various input field types (text, number, select, checkbox, etc.), progress indicators, and labels.
- For security reasons, the rendered forms are **read-only** and **cannot execute any custom code or callback functions** (like \`onSubmit\`). Their primary purpose is for previewing and understanding form layouts and data structures.

**Usage:**
To generate a formedible block, enclose your form definition within a markdown code block with the language identifier \`formedible\`.

**Expected Content Format:**
The content inside the \`formedible\` block must be a single JavaScript object literal containing the form's configuration. This object can include the following top-level keys:
- \`schema\`: A \`z.object()\` definition (e.g., \`z.object({ fieldName: z.string().min(1) })\`). You can use basic Zod types. Complex Zod methods or custom functions are not supported and will be ignored or cause parsing errors.
- \`fields\`: An array of field objects. Each field object requires \`name\` (string) and \`type\` (string). Supported types are: \`text\`, \`email\`, \`password\`, \`url\`, \`tel\`, \`textarea\`, \`select\`, \`checkbox\`, \`switch\`, \`number\`, \`date\`, \`slider\`, \`file\`. Additional properties like \`label\`, \`placeholder\`, \`description\`, \`options\`, \`min\`, \`max\`, \`step\`, \`accept\`, \`multiple\`, and \`page\` can be included.
- \`pages\`: (Optional) An array of page objects for multi-page forms. Each page object requires \`page\` (number). \`title\` and \`description\` are optional.
- \`progress\`: (Optional) An object to configure the progress bar, e.g., \`{ showSteps: true, showPercentage: true }\`.
- \`submitLabel\`, \`nextLabel\`, \`previousLabel\`: (Optional) Strings for navigation button labels.
- \`formClassName\`, \`fieldClassName\`: (Optional) Strings for CSS classes.
- \`formOptions\`: (Optional) An object for basic form options. Only \`defaultValues\`, \`asyncDebounceMs\`, and \`canSubmitWhenInvalid\` are supported. Any \`onSubmit\` or other callback functions will be ignored and replaced with a disabled toast message.

**Examples:**

simple: 
\`\`\`formedible
{
  schema: z.object({
    taskName: z.string().min(3, "Task name is required"),
    priority: z.enum(["low", "medium", "high"]),
    dueDate: z.string().optional(),
    isCompleted: z.boolean(),
  }),
  fields: [
    { name: "taskName", type: "text", label: "Task Name", placeholder: "e.g., Finish report" },
    { name: "priority", type: "select", label: "Priority", options: ["low", "medium", "high"] },
    { name: "dueDate", type: "date", label: "Due Date" },
    { name: "isCompleted", type: "checkbox", label: "Mark as Completed" },
  ],
  submitLabel: "Save Task",
  formOptions: {
    defaultValues: {
      taskName: "",
      priority: "medium",
      isCompleted: false,
    }
  }
}
\`\`\`
with pages :
\`\`\`formedible
{
  schema: z.object({
    firstName: z.string().min(1, "First name is required"),
    lastName: z.string().min(1, "Last name is required"),
    email: z.string().email("Invalid email"),
    age: z.number().min(18, "Must be 18 or older"),
    bio: z.string().min(10, "Bio must be at least 10 characters"),
    notifications: z.boolean(),
  }),
  fields: [
    { name: "firstName", type: "text", label: "First Name", page: 1 },
    { name: "lastName", type: "text", label: "Last Name", page: 1 },
    { name: "email", type: "email", label: "Email", page: 2 },
    { name: "age", type: "number", label: "Age", min: 18, max: 120, page: 2 },
    { name: "bio", type: "textarea", label: "Bio", page: 3 },
    { name: "notifications", type: "switch", label: "Enable notifications", page: 3 },
  ],
  pages: [
    { page: 1, title: "Personal Info", description: "Tell us about yourself" },
    { page: 2, title: "Contact Details", description: "How can we reach you?" },
    { page: 3, title: "Preferences", description: "Customize your experience" },
  ],
  progress: { showSteps: true, showPercentage: true },
  nextLabel: "Continue ",
  previousLabel: " Back",
  submitLabel: "Complete Registration",
  formOptions: {
    defaultValues: {
      firstName: "",
      lastName: "",
      email: "",
      age: 18,
      bio: "",
      notifications: true,
    },
  },
}
\`\`\``,MN="system",IN=Sxe,jN=.7,PN=null,ON=null,DN=null,FN=0,LN=0,S$=!0,BN=!0,$N=!0,zN=!1,UN=!1,qN=15,C$=null,k$=null,VN=5,WN=null,HN=!0,GN=null,KN=768,YN=!1,ZN=!1,E$=null,T$=null,XN=null,JN=16,QN="max-w-7xl",eM=null,tM=1e3,nM=!0,A$=!1,R$=!1,pr=Wo(Ho((e,t)=>({theme:MN,globalSystemPrompt:IN,temperature:jN,maxTokens:PN,topP:ON,topK:DN,presencePenalty:FN,frequencyPenalty:LN,enableAdvancedSettings:S$,enableStreamingMarkdown:BN,enableStreamingCodeBlockParsing:$N,foldStreamingCodeBlocks:zN,foldUserMessagesOnCompletion:UN,streamingRenderFPS:qN,gitUserName:C$,gitUserEmail:k$,toolMaxSteps:VN,prismThemeUrl:WN,autoTitleEnabled:HN,autoTitleModelId:GN,autoTitlePromptMaxLength:KN,autoTitleIncludeFiles:YN,autoTitleIncludeRules:ZN,forkCompactPrompt:E$,forkCompactModelId:T$,customFontFamily:XN,customFontSize:JN,chatMaxWidth:QN,customThemeColors:eM,autoScrollInterval:tM,enableAutoScrollOnStream:nM,autoSyncOnStreamComplete:A$,autoInitializeReposOnStartup:R$,setTheme:n=>{e({theme:n}),bt.saveSetting("theme",n),Re.emit(an.themeChanged,{theme:n})},setGlobalSystemPrompt:n=>{e({globalSystemPrompt:n}),bt.saveSetting("globalSystemPrompt",n),Re.emit(an.globalSystemPromptChanged,{prompt:n})},setTemperature:n=>{e({temperature:n}),bt.saveSetting("temperature",n),Re.emit(an.temperatureChanged,{value:n})},setMaxTokens:n=>{e({maxTokens:n}),bt.saveSetting("maxTokens",n),Re.emit(an.maxTokensChanged,{value:n})},setTopP:n=>{e({topP:n}),bt.saveSetting("topP",n),Re.emit(an.topPChanged,{value:n})},setTopK:n=>{e({topK:n}),bt.saveSetting("topK",n),Re.emit(an.topKChanged,{value:n})},setPresencePenalty:n=>{e({presencePenalty:n}),bt.saveSetting("presencePenalty",n),Re.emit(an.presencePenaltyChanged,{value:n})},setFrequencyPenalty:n=>{e({frequencyPenalty:n}),bt.saveSetting("frequencyPenalty",n),Re.emit(an.frequencyPenaltyChanged,{value:n})},setEnableAdvancedSettings:n=>{e({enableAdvancedSettings:n}),bt.saveSetting("enableAdvancedSettings",n),Re.emit(an.enableAdvancedSettingsChanged,{enabled:n})},setEnableStreamingMarkdown:n=>{e({enableStreamingMarkdown:n}),bt.saveSetting("enableStreamingMarkdown",n),Re.emit(an.enableStreamingMarkdownChanged,{enabled:n})},setEnableStreamingCodeBlockParsing:n=>{e({enableStreamingCodeBlockParsing:n}),bt.saveSetting("enableStreamingCodeBlockParsing",n),Re.emit(an.enableStreamingCodeBlockParsingChanged,{enabled:n})},setFoldStreamingCodeBlocks:n=>{e({foldStreamingCodeBlocks:n}),bt.saveSetting("foldStreamingCodeBlocks",n),Re.emit(an.foldStreamingCodeBlocksChanged,{fold:n})},setFoldUserMessagesOnCompletion:n=>{e({foldUserMessagesOnCompletion:n}),bt.saveSetting("foldUserMessagesOnCompletion",n),Re.emit(an.foldUserMessagesOnCompletionChanged,{fold:n})},setStreamingRenderFPS:n=>{const r=Math.max(3,Math.min(60,n));e({streamingRenderFPS:r}),bt.saveSetting("streamingRenderFPS",r),Re.emit(an.streamingRenderFpsChanged,{fps:r})},setGitUserName:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserName:r}),bt.saveSetting("gitUserName",r),Re.emit(an.gitUserNameChanged,{name:r})},setGitUserEmail:n=>{const r=(n==null?void 0:n.trim())||null;e({gitUserEmail:r}),bt.saveSetting("gitUserEmail",r),Re.emit(an.gitUserEmailChanged,{email:r})},setToolMaxSteps:n=>{const r=Math.max(1,Math.min(20,n));e({toolMaxSteps:r}),bt.saveSetting("toolMaxSteps",r),Re.emit(an.toolMaxStepsChanged,{steps:r})},setPrismThemeUrl:n=>{const r=(n==null?void 0:n.trim())||null;e({prismThemeUrl:r}),bt.saveSetting("prismThemeUrl",r),Re.emit(an.prismThemeUrlChanged,{url:r})},setAutoTitleEnabled:n=>{e({autoTitleEnabled:n}),bt.saveSetting("autoTitleEnabled",n),Re.emit(an.autoTitleEnabledChanged,{enabled:n})},setAutoTitleModelId:n=>{e({autoTitleModelId:n}),bt.saveSetting("autoTitleModelId",n),Re.emit(an.autoTitleModelIdChanged,{modelId:n})},setAutoTitlePromptMaxLength:n=>{const r=Math.max(100,Math.min(4e3,n));e({autoTitlePromptMaxLength:r}),bt.saveSetting("autoTitlePromptMaxLength",r),Re.emit(an.autoTitlePromptMaxLengthChanged,{length:r})},setAutoTitleIncludeFiles:n=>{e({autoTitleIncludeFiles:n}),bt.saveSetting("autoTitleIncludeFiles",n),Re.emit(an.autoTitleIncludeFilesChanged,{include:n})},setAutoTitleIncludeRules:n=>{e({autoTitleIncludeRules:n}),bt.saveSetting("autoTitleIncludeRules",n),Re.emit(an.autoTitleIncludeRulesChanged,{include:n})},setForkCompactPrompt:n=>{e({forkCompactPrompt:n}),bt.saveSetting("forkCompactPrompt",n)},setForkCompactModelId:n=>{e({forkCompactModelId:n}),bt.saveSetting("forkCompactModelId",n)},setCustomFontFamily:n=>{const r=(n==null?void 0:n.trim())||null;e({customFontFamily:r}),bt.saveSetting("customFontFamily",r),Re.emit(an.customFontFamilyChanged,{fontFamily:r})},setCustomFontSize:n=>{const r=n===null?null:Math.max(10,Math.min(24,n));e({customFontSize:r}),bt.saveSetting("customFontSize",r),Re.emit(an.customFontSizeChanged,{fontSize:r})},setChatMaxWidth:n=>{e({chatMaxWidth:n}),bt.saveSetting("chatMaxWidth",n),Re.emit(an.chatMaxWidthChanged,{maxWidth:n})},setCustomThemeColors:n=>{e({customThemeColors:n}),bt.saveSetting("customThemeColors",n),Re.emit(an.customThemeColorsChanged,{colors:n})},setCustomThemeColor:(n,r)=>{e(i=>{const o={...i.customThemeColors??{}};r===null||r.trim()===""?delete o[n]:o[n]=r.trim(),i.customThemeColors=Object.keys(o).length>0?o:null});const s=t().customThemeColors;bt.saveSetting("customThemeColors",s),Re.emit(an.customThemeColorsChanged,{colors:s})},setAutoScrollInterval:n=>{const r=Math.max(50,n);e({autoScrollInterval:r}),bt.saveSetting("autoScrollInterval",r),Re.emit(an.autoScrollIntervalChanged,{interval:r})},setEnableAutoScrollOnStream:n=>{e({enableAutoScrollOnStream:n}),bt.saveSetting("enableAutoScrollOnStream",n),Re.emit(an.enableAutoScrollOnStreamChanged,{enabled:n})},setAutoSyncOnStreamComplete:n=>{e({autoSyncOnStreamComplete:n}),bt.saveSetting("autoSyncOnStreamComplete",n),Re.emit(an.autoSyncOnStreamCompleteChanged,{enabled:n})},setAutoInitializeReposOnStartup:n=>{e({autoInitializeReposOnStartup:n}),bt.saveSetting("autoInitializeReposOnStartup",n),Re.emit(an.autoInitializeReposOnStartupChanged,{enabled:n})},loadSettings:async()=>{try{const[n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C,T,A,N,I,O,B,D,H,P,K,U,V,L]=await Promise.all([bt.loadSetting("theme",MN),bt.loadSetting("temperature",jN),bt.loadSetting("maxTokens",PN),bt.loadSetting("topP",ON),bt.loadSetting("topK",DN),bt.loadSetting("presencePenalty",FN),bt.loadSetting("frequencyPenalty",LN),bt.loadSetting("globalSystemPrompt",IN),bt.loadSetting("enableAdvancedSettings",S$),bt.loadSetting("enableStreamingMarkdown",BN),bt.loadSetting("enableStreamingCodeBlockParsing",$N),bt.loadSetting("foldStreamingCodeBlocks",zN),bt.loadSetting("foldUserMessagesOnCompletion",UN),bt.loadSetting("streamingRenderFPS",qN),bt.loadSetting("gitUserName",C$),bt.loadSetting("gitUserEmail",k$),bt.loadSetting("toolMaxSteps",VN),bt.loadSetting("prismThemeUrl",WN),bt.loadSetting("autoTitleEnabled",HN),bt.loadSetting("autoTitleModelId",GN),bt.loadSetting("autoTitlePromptMaxLength",KN),bt.loadSetting("autoTitleIncludeFiles",YN),bt.loadSetting("autoTitleIncludeRules",ZN),bt.loadSetting("forkCompactPrompt",E$),bt.loadSetting("forkCompactModelId",T$),bt.loadSetting("customFontFamily",XN),bt.loadSetting("customFontSize",JN),bt.loadSetting("chatMaxWidth",QN),bt.loadSetting("customThemeColors",eM),bt.loadSetting("autoScrollInterval",tM),bt.loadSetting("enableAutoScrollOnStream",nM),bt.loadSetting("autoSyncOnStreamComplete",A$),bt.loadSetting("autoInitializeReposOnStartup",R$)]),te={theme:n,temperature:r,maxTokens:s,topP:i,topK:a,presencePenalty:o,frequencyPenalty:l,globalSystemPrompt:c,enableAdvancedSettings:u,enableStreamingMarkdown:d,enableStreamingCodeBlockParsing:h,foldStreamingCodeBlocks:m,foldUserMessagesOnCompletion:y,streamingRenderFPS:b,gitUserName:v,gitUserEmail:x,toolMaxSteps:w,prismThemeUrl:S,autoTitleEnabled:k,autoTitleModelId:C,autoTitlePromptMaxLength:T,autoTitleIncludeFiles:A,autoTitleIncludeRules:N,forkCompactPrompt:I,forkCompactModelId:O,customFontFamily:B,customFontSize:D,chatMaxWidth:H,customThemeColors:P,autoScrollInterval:K,enableAutoScrollOnStream:U,autoSyncOnStreamComplete:V,autoInitializeReposOnStartup:L};e(te),Re.emit(an.loaded,{settings:te})}catch(n){console.error("SettingsStore: Error loading settings",n),Re.emit(an.loaded,{settings:t()})}},resetGeneralSettings:async()=>{try{t().setEnableStreamingMarkdown(BN),t().setEnableStreamingCodeBlockParsing($N),t().setFoldStreamingCodeBlocks(zN),t().setFoldUserMessagesOnCompletion(UN),t().setStreamingRenderFPS(qN),t().setAutoScrollInterval(tM),t().setEnableAutoScrollOnStream(nM),Te.success("Streaming & Display settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting general settings",n),Te.error("Failed to reset general settings.")}},resetAssistantSettings:async()=>{try{t().setGlobalSystemPrompt(IN),t().setTemperature(jN),t().setMaxTokens(PN),t().setTopP(ON),t().setTopK(DN),t().setPresencePenalty(FN),t().setFrequencyPenalty(LN),t().setToolMaxSteps(VN),t().setAutoTitleEnabled(HN),t().setAutoTitleModelId(GN),t().setAutoTitlePromptMaxLength(KN),t().setAutoTitleIncludeFiles(YN),t().setAutoTitleIncludeRules(ZN),Te.success("Assistant settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting assistant settings",n),Te.error("Failed to reset assistant settings.")}},resetThemeSettings:async()=>{try{t().setTheme(MN),t().setPrismThemeUrl(WN),t().setCustomFontFamily(XN),t().setCustomFontSize(JN),t().setChatMaxWidth(QN),t().setCustomThemeColors(eM),Te.success("Theme settings reset to defaults.")}catch(n){console.error("SettingsStore: Error resetting theme settings",n),Te.error("Failed to reset theme settings.")}},getRegisteredActionHandlers:()=>{const n="settingsStore",r=t();return[{eventName:an.setThemeRequest,handler:s=>r.setTheme(s.theme),storeId:n},{eventName:an.setGlobalSystemPromptRequest,handler:s=>r.setGlobalSystemPrompt(s.prompt),storeId:n},{eventName:an.setTemperatureRequest,handler:s=>r.setTemperature(s.value),storeId:n},{eventName:an.setMaxTokensRequest,handler:s=>r.setMaxTokens(s.value),storeId:n},{eventName:an.setTopPRequest,handler:s=>r.setTopP(s.value),storeId:n},{eventName:an.setTopKRequest,handler:s=>r.setTopK(s.value),storeId:n},{eventName:an.setPresencePenaltyRequest,handler:s=>r.setPresencePenalty(s.value),storeId:n},{eventName:an.setFrequencyPenaltyRequest,handler:s=>r.setFrequencyPenalty(s.value),storeId:n},{eventName:an.setEnableAdvancedSettingsRequest,handler:s=>r.setEnableAdvancedSettings(s.enabled),storeId:n},{eventName:an.setEnableStreamingMarkdownRequest,handler:s=>r.setEnableStreamingMarkdown(s.enabled),storeId:n},{eventName:an.setEnableStreamingCodeBlockParsingRequest,handler:s=>r.setEnableStreamingCodeBlockParsing(s.enabled),storeId:n},{eventName:an.setFoldStreamingCodeBlocksRequest,handler:s=>r.setFoldStreamingCodeBlocks(s.fold),storeId:n},{eventName:an.setFoldUserMessagesOnCompletionRequest,handler:s=>r.setFoldUserMessagesOnCompletion(s.fold),storeId:n},{eventName:an.setStreamingRenderFpsRequest,handler:s=>r.setStreamingRenderFPS(s.fps),storeId:n},{eventName:an.setGitUserNameRequest,handler:s=>r.setGitUserName(s.name),storeId:n},{eventName:an.setGitUserEmailRequest,handler:s=>r.setGitUserEmail(s.email),storeId:n},{eventName:an.setToolMaxStepsRequest,handler:s=>r.setToolMaxSteps(s.steps),storeId:n},{eventName:an.setPrismThemeUrlRequest,handler:s=>r.setPrismThemeUrl(s.url),storeId:n},{eventName:an.setAutoTitleEnabledRequest,handler:s=>r.setAutoTitleEnabled(s.enabled),storeId:n},{eventName:an.setAutoTitleModelIdRequest,handler:s=>r.setAutoTitleModelId(s.modelId),storeId:n},{eventName:an.setAutoTitlePromptMaxLengthRequest,handler:s=>r.setAutoTitlePromptMaxLength(s.length),storeId:n},{eventName:an.setAutoTitleIncludeFilesRequest,handler:s=>r.setAutoTitleIncludeFiles(s.include),storeId:n},{eventName:an.setAutoTitleIncludeRulesRequest,handler:s=>r.setAutoTitleIncludeRules(s.include),storeId:n},{eventName:an.setCustomFontFamilyRequest,handler:s=>r.setCustomFontFamily(s.fontFamily),storeId:n},{eventName:an.setCustomFontSizeRequest,handler:s=>r.setCustomFontSize(s.fontSize),storeId:n},{eventName:an.setChatMaxWidthRequest,handler:s=>r.setChatMaxWidth(s.maxWidth),storeId:n},{eventName:an.setCustomThemeColorsRequest,handler:s=>r.setCustomThemeColors(s.colors),storeId:n},{eventName:an.setCustomThemeColorRequest,handler:s=>r.setCustomThemeColor(s.colorKey,s.value),storeId:n},{eventName:an.setAutoScrollIntervalRequest,handler:s=>r.setAutoScrollInterval(s.interval),storeId:n},{eventName:an.setEnableAutoScrollOnStreamRequest,handler:s=>r.setEnableAutoScrollOnStream(s.enabled),storeId:n},{eventName:an.setAutoSyncOnStreamCompleteRequest,handler:s=>r.setAutoSyncOnStreamComplete(s.enabled),storeId:n},{eventName:an.setAutoInitializeReposOnStartupRequest,handler:s=>r.setAutoInitializeReposOnStartup(s.enabled),storeId:n},{eventName:an.loadSettingsRequest,handler:()=>r.loadSettings(),storeId:n},{eventName:an.resetGeneralSettingsRequest,handler:()=>r.resetGeneralSettings(),storeId:n},{eventName:an.resetAssistantSettingsRequest,handler:()=>r.resetAssistantSettings(),storeId:n},{eventName:an.resetThemeSettingsRequest,handler:()=>r.resetThemeSettings(),storeId:n}]}})));async function U2(e,t){const n=Wi.getState().getMiddlewareForHook,r=n(e);let s=t;for(const i of r)try{const a=await i.callback(s);if(a===!1)return console.log(`Middleware ${i.modId} cancelled action for hook ${e}`),!1;a&&typeof a=="object"&&(s=a)}catch(a){return console.error(`Middleware error in mod ${i.modId} for hook ${e}:`,a),!1}return s}function N$(){const e=un.getState(),t=Qn.getState(),n=pr.getState(),{providerId:r}=Ac(t.selectedModelId),s={selectedConversationId:e.currentConversationId,interactions:e.interactions,isStreaming:e.status==="streaming",selectedProviderId:r,selectedModelId:t.selectedModelId,activeSystemPrompt:n.globalSystemPrompt,temperature:n.temperature,maxTokens:n.maxTokens,theme:n.theme,gitUserName:n.gitUserName,gitUserEmail:n.gitUserEmail};return Object.freeze(s)}function Cxe(e){try{const t=atob(e),n=t.length,r=new Uint8Array(n);for(let s=0;s<n;s++)r[s]=t.charCodeAt(s);return r}catch(t){throw console.error("Error decoding base64 string:",t),new Error("Invalid base64 string for file content.")}}function M$(e){try{const t=e.type||"application/octet-stream",n=tw(e.name,t),r=t.startsWith("image/");if(e.contentBytes!==void 0)return n?{type:"text",text:new TextDecoder().decode(e.contentBytes)}:r?{type:"image",image:e.contentBytes,mimeType:t}:(console.warn(`AIService: Unsupported VFS file type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached VFS file: ${e.name} (${t})]`});if(e.contentText!==void 0&&n)return{type:"text",text:e.contentText};if(e.contentBase64!==void 0&&r)return{type:"image",image:Cxe(e.contentBase64),mimeType:t};if(e.contentBase64!==void 0&&!n&&!r)return console.warn(`AIService: Unsupported direct upload type "${t}" for direct inclusion. Sending note.`),{type:"text",text:`[Attached file: ${e.name} (${t})]`};throw n&&e.contentText===void 0?new Error(`Missing text content for likely text file: ${e.name}`):r&&e.contentBase64===void 0?new Error(`Missing base64 content for image file: ${e.name}`):new Error(`Missing or unusable content for file: ${e.name}`)}catch(t){return console.error(`AIService: Failed to process content for ${e.name}:`,t),Te.error(`Failed to process file "${e.name}": ${t instanceof Error?t.message:String(t)}`),{type:"text",text:`[Error processing file: ${e.name}]`}}}function FC(e){return e.flatMap(t=>{var s,i,a;const n=[],r=t.prompt;if(r){const o=[];r.content&&o.push({type:"text",text:r.content}),(s=r.metadata)!=null&&s.attachedFiles&&r.metadata.attachedFiles.length>0&&r.metadata.attachedFiles.forEach(l=>{o.push({type:"text",text:`[User attached file: ${l.name}]`})}),o.length>0&&n.push({role:"user",content:o})}if(t.response&&typeof t.response=="string"&&n.push({role:"assistant",content:t.response}),(i=t.metadata)!=null&&i.toolCalls&&Array.isArray(t.metadata.toolCalls)){const o=[];t.metadata.toolCalls.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-call"&&c.toolCallId&&c.toolName&&c.args!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool call structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool call string:",l,c)}}),o.length>0&&n.push({role:"assistant",content:o})}if((a=t.metadata)!=null&&a.toolResults&&Array.isArray(t.metadata.toolResults)){const o=[];t.metadata.toolResults.forEach(l=>{try{const c=JSON.parse(l);c&&c.type==="tool-result"&&c.toolCallId&&c.toolName&&c.result!==void 0?o.push(c):console.warn("[AIService] buildHistory: Invalid tool result structure after parsing:",l)}catch(c){console.error("[AIService] buildHistory: Failed to parse tool result string:",l,c)}}),o.length>0&&n.push({role:"tool",content:o})}return n})}const I$=e=>Symbol.iterator in e,j$=e=>"entries"in e,P$=(e,t)=>{const n=e instanceof Map?e:new Map(e.entries()),r=t instanceof Map?t:new Map(t.entries());if(n.size!==r.size)return!1;for(const[s,i]of n)if(!Object.is(i,r.get(s)))return!1;return!0},kxe=(e,t)=>{const n=e[Symbol.iterator](),r=t[Symbol.iterator]();let s=n.next(),i=r.next();for(;!s.done&&!i.done;){if(!Object.is(s.value,i.value))return!1;s=n.next(),i=r.next()}return!!s.done&&!!i.done};function Exe(e,t){return Object.is(e,t)?!0:typeof e!="object"||e===null||typeof t!="object"||t===null?!1:!I$(e)||!I$(t)?P$({entries:()=>Object.entries(e)},{entries:()=>Object.entries(t)}):j$(e)&&j$(t)?P$(e,t):kxe(e,t)}function yn(e){const t=Ve.useRef(void 0);return n=>{const r=e(n);return Exe(t.current,r)?t.current:t.current=r}}var cy=(e=>(e.PROMPT_TURN_FINALIZE="middleware.prompt.turnFinalize",e.INTERACTION_BEFORE_START="middleware.interaction.beforeStart",e.INTERACTION_PROCESS_CHUNK="middleware.interaction.processChunk",e))(cy||{});const sn={initialized:"prompt.state.initialized",parameterChanged:"prompt.state.parameter.changed",transientParametersReset:"prompt.state.transient.parameters.reset",inputTextStateChanged:"prompt.state.input.text.changed",submitted:"prompt.state.submitted",enhancementStarted:"prompt.enhancement.started",enhancementCompleted:"prompt.enhancement.completed",enhancementFailed:"prompt.enhancement.failed",setModelIdRequest:"prompt.state.set.model.id.request",setTemperatureRequest:"prompt.state.set.temperature.request",setMaxTokensRequest:"prompt.state.set.max.tokens.request",setTopPRequest:"prompt.state.set.top.p.request",setTopKRequest:"prompt.state.set.top.k.request",setPresencePenaltyRequest:"prompt.state.set.presence.penalty.request",setFrequencyPenaltyRequest:"prompt.state.set.frequency.penalty.request",setReasoningEnabledRequest:"prompt.state.set.reasoning.enabled.request",setWebSearchEnabledRequest:"prompt.state.set.web.search.enabled.request",setImageGenerationEnabledRequest:"prompt.state.set.image.generation.enabled.request",setStructuredOutputJsonRequest:"prompt.state.set.structured.output.json.request",initializePromptStateRequest:"prompt.state.initialize.prompt.state.request",resetTransientParametersRequest:"prompt.state.reset.transient.parameters.request",setInputTextRequest:"prompt.input.set.text.request",focusInputRequest:"prompt.input.focus.request",submitPromptRequest:"prompt.submit.request",enhancePromptRequest:"prompt.enhance.request",inputChanged:"prompt.inputChanged"},fc=(e,t)=>{Re.emit(sn.parameterChanged,{params:{[e]:t}})},Yl=Wo(Ho((e,t)=>({modelId:null,temperature:null,maxTokens:null,topP:null,topK:null,presencePenalty:null,frequencyPenalty:null,reasoningEnabled:null,webSearchEnabled:null,imageGenerationEnabled:null,structuredOutputJson:null,setModelId:n=>{t().modelId!==n&&(e({modelId:n}),fc("modelId",n))},setTemperature:n=>{t().temperature!==n&&(e({temperature:n}),fc("temperature",n))},setMaxTokens:n=>{t().maxTokens!==n&&(e({maxTokens:n}),fc("maxTokens",n))},setTopP:n=>{t().topP!==n&&(e({topP:n}),fc("topP",n))},setTopK:n=>{t().topK!==n&&(e({topK:n}),fc("topK",n))},setPresencePenalty:n=>{t().presencePenalty!==n&&(e({presencePenalty:n}),fc("presencePenalty",n))},setFrequencyPenalty:n=>{t().frequencyPenalty!==n&&(e({frequencyPenalty:n}),fc("frequencyPenalty",n))},setReasoningEnabled:n=>{t().reasoningEnabled!==n&&(e({reasoningEnabled:n}),fc("reasoningEnabled",n))},setWebSearchEnabled:n=>{t().webSearchEnabled!==n&&(e({webSearchEnabled:n}),fc("webSearchEnabled",n))},setImageGenerationEnabled:n=>{t().imageGenerationEnabled!==n&&(e({imageGenerationEnabled:n}),fc("imageGenerationEnabled",n))},setStructuredOutputJson:n=>{t().structuredOutputJson!==n&&(e({structuredOutputJson:n}),fc("structuredOutputJson",n))},initializePromptState:n=>{console.log("[PromptStateStore] Initializing with:",n);const r=t(),s={};let i=!1;r.modelId!==n.modelId&&(s.modelId=n.modelId,i=!0),r.temperature!==n.temperature&&(s.temperature=n.temperature,i=!0),r.maxTokens!==n.maxTokens&&(s.maxTokens=n.maxTokens,i=!0),r.topP!==n.topP&&(s.topP=n.topP,i=!0),r.topK!==n.topK&&(s.topK=n.topK,i=!0),r.presencePenalty!==n.presencePenalty&&(s.presencePenalty=n.presencePenalty,i=!0),r.frequencyPenalty!==n.frequencyPenalty&&(s.frequencyPenalty=n.frequencyPenalty,i=!0),i&&(e(s),Re.emit(sn.parameterChanged,{params:s})),Re.emit(sn.initialized,{state:{...t()}})},resetTransientParameters:()=>{console.log("[PromptStateStore] Resetting transient parameters.");const n=t(),r={};let s=!1;n.temperature!==null&&(r.temperature=null,s=!0),n.maxTokens!==null&&(r.maxTokens=null,s=!0),n.topP!==null&&(r.topP=null,s=!0),n.topK!==null&&(r.topK=null,s=!0),n.presencePenalty!==null&&(r.presencePenalty=null,s=!0),n.frequencyPenalty!==null&&(r.frequencyPenalty=null,s=!0),n.reasoningEnabled!==null&&(r.reasoningEnabled=null,s=!0),n.webSearchEnabled!==null&&(r.webSearchEnabled=null,s=!0),n.imageGenerationEnabled!==null&&(r.imageGenerationEnabled=null,s=!0),n.structuredOutputJson!==null&&(r.structuredOutputJson=null,s=!0),s&&(e(r),Re.emit(sn.parameterChanged,{params:r})),Re.emit(sn.transientParametersReset,void 0)},getRegisteredActionHandlers:()=>{const n="promptStateStore",r=t();return[{eventName:sn.setModelIdRequest,handler:s=>r.setModelId(s.id),storeId:n},{eventName:sn.setTemperatureRequest,handler:s=>r.setTemperature(s.value),storeId:n},{eventName:sn.setMaxTokensRequest,handler:s=>r.setMaxTokens(s.value),storeId:n},{eventName:sn.setTopPRequest,handler:s=>r.setTopP(s.value),storeId:n},{eventName:sn.setTopKRequest,handler:s=>r.setTopK(s.value),storeId:n},{eventName:sn.setPresencePenaltyRequest,handler:s=>r.setPresencePenalty(s.value),storeId:n},{eventName:sn.setFrequencyPenaltyRequest,handler:s=>r.setFrequencyPenalty(s.value),storeId:n},{eventName:sn.setReasoningEnabledRequest,handler:s=>r.setReasoningEnabled(s.enabled),storeId:n},{eventName:sn.setWebSearchEnabledRequest,handler:s=>r.setWebSearchEnabled(s.enabled),storeId:n},{eventName:sn.setImageGenerationEnabledRequest,handler:s=>r.setImageGenerationEnabled(s.enabled),storeId:n},{eventName:sn.setStructuredOutputJsonRequest,handler:s=>r.setStructuredOutputJson(s.json),storeId:n},{eventName:sn.initializePromptStateRequest,handler:s=>r.initializePromptState(s.effectiveSettings),storeId:n},{eventName:sn.resetTransientParametersRequest,handler:()=>r.resetTransientParameters(),storeId:n}]}}))),Txe=({InputAreaRenderer:e,onSubmit:t,className:n,placeholder:r="Send a message...",inputAreaRef:s,selectedItemId:i,selectedItemType:a})=>{const[o,l]=E.useState(!1),[c,u]=E.useState(!1),d=Wi(yn(C=>C.promptControls)),h=un(yn(C=>C.status==="streaming")),{attachedFilesMetadata:m,clearAttachedFiles:y}=Nh(yn(C=>({attachedFilesMetadata:C.attachedFilesMetadata,clearAttachedFiles:C.clearAttachedFiles}))),b=Yl(C=>C.modelId),v=E.useMemo(()=>Object.values(d),[d]),x=E.useMemo(()=>v.filter(C=>C.renderer),[v]),w=E.useMemo(()=>v.filter(C=>C.triggerRenderer),[v]),S=E.useCallback(async C=>{var I,O;const T=((I=s==null?void 0:s.current)==null?void 0:I.getValue())??"",A=C!==void 0?C.trim():T.trim(),N=Nh.getState().attachedFilesMetadata;if(!(!A&&N.length===0)&&!(h||o)){l(!0);try{let B={},D={};for(const V of v){if(V.getParameters){const L=await V.getParameters();L&&(B={...B,...L})}if(V.getMetadata){const L=await V.getMetadata();L&&(D={...D,...L})}}N.length>0&&(D.attachedFiles=[...N]),!D.modelId&&b&&(D.modelId=b);const H=v.find(V=>V.id==="core-rules-tags");if(H&&D.activeRuleIds&&D.activeTagIds){const V=[],L=new Set(D.activeRuleIds);D.activeTagIds.forEach(te=>{H.getRulesForTag(te).forEach(W=>L.add(W.id))}),L.forEach(te=>{const W=H.getRuleById(te);W&&V.push({type:W.type,content:W.content,sourceRuleId:W.id})}),D.effectiveRulesContent=V}let P={id:qr(),content:A,parameters:B,metadata:D};Re.emit(sn.submitted,{turnData:P});const K=await U2(cy.PROMPT_TURN_FINALIZE,{turnData:P});if(K===!1){console.log("Prompt submission cancelled by middleware."),l(!1);return}const U=K&&typeof K=="object"?K.turnData:P;await t(U),y(),v.forEach(V=>{V.clearOnSubmit&&V.clearOnSubmit()}),(O=s.current)==null||O.clearValue(),u(!1)}catch(B){console.error("Error during prompt submission:",B),Te.error(`Failed to send message: ${B instanceof Error?B.message:String(B)}`)}finally{l(!1)}}},[s,h,o,v,t,y,b]);E.useEffect(()=>{a==="conversation"&&i&&requestAnimationFrame(()=>{var C;(C=s.current)==null||C.focus()})},[i,a,s]),E.useEffect(()=>{const C=()=>{requestAnimationFrame(()=>{var N;(N=s.current)==null||N.focus()})},T=N=>{s.current&&(s.current.setValue(N.text),u(N.text.trim().length>0))},A=async N=>{un.getState().status==="streaming"||o||await S(N.turnData.content)};return Re.on(sn.focusInputRequest,C),Re.on(sn.setInputTextRequest,T),Re.on(sn.submitPromptRequest,A),()=>{Re.off(sn.focusInputRequest,C),Re.off(sn.setInputTextRequest,T),Re.off(sn.submitPromptRequest,A)}},[s,S,o]);const k=E.useCallback(C=>{u(C.trim().length>0)},[]);return f.jsxs("div",{className:Ze("p-2 md:p-4 space-y-2 md:space-y-3",n),children:[x.length>0&&f.jsx(DB,{controls:x,area:"panel",className:"flex flex-wrap gap-1 md:gap-2 items-start mb-1 md:mb-2"}),f.jsxs("div",{className:"flex items-end gap-2",children:[f.jsx(e,{ref:s,onSubmit:S,disabled:h||o,placeholder:r,onValueChange:k,className:"flex-grow"}),f.jsx(ct,{type:"button",size:"icon",onClick:()=>S(void 0),disabled:h||o||!c&&m.length===0,className:"h-9 w-9 flex-shrink-0","aria-label":"Send message",children:o?f.jsx(Jn,{className:"h-4 w-4 animate-spin"}):f.jsx(Lge,{className:"h-4 w-4"})})]})," ",f.jsx(DB,{controls:w,area:"trigger",className:"flex items-center gap-1 flex-wrap flex-shrink-0 mt-1 md:mt-2"})]})};function Wt(e,t,{checkForDefaultPrevented:n=!0}={}){return function(s){if(e==null||e(s),n===!1||!s.defaultPrevented)return t==null?void 0:t(s)}}function Axe(e,t){const n=E.createContext(t),r=i=>{const{children:a,...o}=i,l=E.useMemo(()=>o,Object.values(o));return f.jsx(n.Provider,{value:l,children:a})};r.displayName=e+"Provider";function s(i){const a=E.useContext(n);if(a)return a;if(t!==void 0)return t;throw new Error(`\`${i}\` must be used within \`${e}\``)}return[r,s]}function Yi(e,t=[]){let n=[];function r(i,a){const o=E.createContext(a),l=n.length;n=[...n,a];const c=d=>{var x;const{scope:h,children:m,...y}=d,b=((x=h==null?void 0:h[e])==null?void 0:x[l])||o,v=E.useMemo(()=>y,Object.values(y));return f.jsx(b.Provider,{value:v,children:m})};c.displayName=i+"Provider";function u(d,h){var b;const m=((b=h==null?void 0:h[e])==null?void 0:b[l])||o,y=E.useContext(m);if(y)return y;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[c,u]}const s=()=>{const i=n.map(a=>E.createContext(a));return function(o){const l=(o==null?void 0:o[e])||i;return E.useMemo(()=>({[`__scope${e}`]:{...o,[e]:l}}),[o,l])}};return s.scopeName=e,[r,Rxe(s,...t)]}function Rxe(...e){const t=e[0];if(e.length===1)return t;const n=()=>{const r=e.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=r.reduce((o,{useScope:l,scopeName:c})=>{const d=l(i)[`__scope${c}`];return{...o,...d}},{});return E.useMemo(()=>({[`__scope${t.scopeName}`]:a}),[a])}};return n.scopeName=t.scopeName,n}function Nxe(e){const t=Mxe(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(jxe);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function Mxe(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=Oxe(s),o=Pxe(i,s.props);return s.type!==E.Fragment&&(o.ref=r?pl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Ixe=Symbol("radix.slottable");function jxe(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Ixe}function Pxe(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function Oxe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Dxe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],cr=Dxe.reduce((e,t)=>{const n=Nxe(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function qG(e,t){e&&dl.flushSync(()=>e.dispatchEvent(t))}function Es(e){const t=E.useRef(e);return E.useEffect(()=>{t.current=e}),E.useMemo(()=>(...n)=>{var r;return(r=t.current)==null?void 0:r.call(t,...n)},[])}function cO(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e);E.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return t.addEventListener("keydown",r,{capture:!0}),()=>t.removeEventListener("keydown",r,{capture:!0})},[n,t])}var Fxe="DismissableLayer",Sj="dismissableLayer.update",Lxe="dismissableLayer.pointerDownOutside",Bxe="dismissableLayer.focusOutside",O$,VG=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),OE=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=E.useContext(VG),[u,d]=E.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=E.useState({}),y=In(t,A=>d(A)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,k=w>=x,C=Uxe(A=>{const N=A.target,I=[...c.branches].some(O=>O.contains(N));!k||I||(s==null||s(A),a==null||a(A),A.defaultPrevented||o==null||o())},h),T=qxe(A=>{const N=A.target;[...c.branches].some(O=>O.contains(N))||(i==null||i(A),a==null||a(A),A.defaultPrevented||o==null||o())},h);return cO(A=>{w===c.layers.size-1&&(r==null||r(A),!A.defaultPrevented&&o&&(A.preventDefault(),o()))},h),E.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(O$=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),D$(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=O$)}},[u,h,n,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),D$())},[u,c]),E.useEffect(()=>{const A=()=>m({});return document.addEventListener(Sj,A),()=>document.removeEventListener(Sj,A)},[]),f.jsx(cr.div,{...l,ref:y,style:{pointerEvents:S?k?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,T.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,T.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,C.onPointerDownCapture)})});OE.displayName=Fxe;var $xe="DismissableLayerBranch",zxe=E.forwardRef((e,t)=>{const n=E.useContext(VG),r=E.useRef(null),s=In(t,r);return E.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(cr.div,{...e,ref:s})});zxe.displayName=$xe;function Uxe(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){WG(Lxe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function qxe(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1);return E.useEffect(()=>{const s=i=>{i.target&&!r.current&&WG(Bxe,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function D$(){const e=new CustomEvent(Sj);document.dispatchEvent(e)}function WG(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?qG(s,i):s.dispatchEvent(i)}var si=globalThis!=null&&globalThis.document?E.useLayoutEffect:()=>{},Vxe=sH[" useId ".trim().toString()]||(()=>{}),Wxe=0;function ca(e){const[t,n]=E.useState(Vxe());return si(()=>{n(r=>r??String(Wxe++))},[e]),t?`radix-${t}`:""}const Hxe=["top","right","bottom","left"],jh=Math.min,ul=Math.max,q2=Math.round,FS=Math.floor,Tu=e=>({x:e,y:e}),Gxe={left:"right",right:"left",bottom:"top",top:"bottom"},Kxe={start:"end",end:"start"};function Cj(e,t,n){return ul(e,jh(t,n))}function Kd(e,t){return typeof e=="function"?e(t):e}function Yd(e){return e.split("-")[0]}function Zy(e){return e.split("-")[1]}function uO(e){return e==="x"?"y":"x"}function dO(e){return e==="y"?"height":"width"}function Ph(e){return["top","bottom"].includes(Yd(e))?"y":"x"}function fO(e){return uO(Ph(e))}function Yxe(e,t,n){n===void 0&&(n=!1);const r=Zy(e),s=fO(e),i=dO(s);let a=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[i]>t.floating[i]&&(a=V2(a)),[a,V2(a)]}function Zxe(e){const t=V2(e);return[kj(e),t,kj(t)]}function kj(e){return e.replace(/start|end/g,t=>Kxe[t])}function Xxe(e,t,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(e){case"top":case"bottom":return n?t?s:r:t?r:s;case"left":case"right":return t?i:a;default:return[]}}function Jxe(e,t,n,r){const s=Zy(e);let i=Xxe(Yd(e),n==="start",r);return s&&(i=i.map(a=>a+"-"+s),t&&(i=i.concat(i.map(kj)))),i}function V2(e){return e.replace(/left|right|bottom|top/g,t=>Gxe[t])}function Qxe(e){return{top:0,right:0,bottom:0,left:0,...e}}function HG(e){return typeof e!="number"?Qxe(e):{top:e,right:e,bottom:e,left:e}}function W2(e){const{x:t,y:n,width:r,height:s}=e;return{width:r,height:s,top:n,left:t,right:t+r,bottom:n+s,x:t,y:n}}function F$(e,t,n){let{reference:r,floating:s}=e;const i=Ph(t),a=fO(t),o=dO(a),l=Yd(t),c=i==="y",u=r.x+r.width/2-s.width/2,d=r.y+r.height/2-s.height/2,h=r[o]/2-s[o]/2;let m;switch(l){case"top":m={x:u,y:r.y-s.height};break;case"bottom":m={x:u,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:d};break;case"left":m={x:r.x-s.width,y:d};break;default:m={x:r.x,y:r.y}}switch(Zy(t)){case"start":m[a]-=h*(n&&c?-1:1);break;case"end":m[a]+=h*(n&&c?-1:1);break}return m}const ewe=async(e,t,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:a}=n,o=i.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let c=await a.getElementRects({reference:e,floating:t,strategy:s}),{x:u,y:d}=F$(c,r,l),h=r,m={},y=0;for(let b=0;b<o.length;b++){const{name:v,fn:x}=o[b],{x:w,y:S,data:k,reset:C}=await x({x:u,y:d,initialPlacement:r,placement:h,strategy:s,middlewareData:m,rects:c,platform:a,elements:{reference:e,floating:t}});u=w??u,d=S??d,m={...m,[v]:{...m[v],...k}},C&&y<=50&&(y++,typeof C=="object"&&(C.placement&&(h=C.placement),C.rects&&(c=C.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:s}):C.rects),{x:u,y:d}=F$(c,h,l)),b=-1)}return{x:u,y:d,placement:h,strategy:s,middlewareData:m}};async function aw(e,t){var n;t===void 0&&(t={});const{x:r,y:s,platform:i,rects:a,elements:o,strategy:l}=e,{boundary:c="clippingAncestors",rootBoundary:u="viewport",elementContext:d="floating",altBoundary:h=!1,padding:m=0}=Kd(t,e),y=HG(m),v=o[h?d==="floating"?"reference":"floating":d],x=W2(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(v)))==null||n?v:v.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:c,rootBoundary:u,strategy:l})),w=d==="floating"?{x:r,y:s,width:a.floating.width,height:a.floating.height}:a.reference,S=await(i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating)),k=await(i.isElement==null?void 0:i.isElement(S))?await(i.getScale==null?void 0:i.getScale(S))||{x:1,y:1}:{x:1,y:1},C=W2(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:w,offsetParent:S,strategy:l}):w);return{top:(x.top-C.top+y.top)/k.y,bottom:(C.bottom-x.bottom+y.bottom)/k.y,left:(x.left-C.left+y.left)/k.x,right:(C.right-x.right+y.right)/k.x}}const twe=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:s,rects:i,platform:a,elements:o,middlewareData:l}=t,{element:c,padding:u=0}=Kd(e,t)||{};if(c==null)return{};const d=HG(u),h={x:n,y:r},m=fO(s),y=dO(m),b=await a.getDimensions(c),v=m==="y",x=v?"top":"left",w=v?"bottom":"right",S=v?"clientHeight":"clientWidth",k=i.reference[y]+i.reference[m]-h[m]-i.floating[y],C=h[m]-i.reference[m],T=await(a.getOffsetParent==null?void 0:a.getOffsetParent(c));let A=T?T[S]:0;(!A||!await(a.isElement==null?void 0:a.isElement(T)))&&(A=o.floating[S]||i.floating[y]);const N=k/2-C/2,I=A/2-b[y]/2-1,O=jh(d[x],I),B=jh(d[w],I),D=O,H=A-b[y]-B,P=A/2-b[y]/2+N,K=Cj(D,P,H),U=!l.arrow&&Zy(s)!=null&&P!==K&&i.reference[y]/2-(P<D?O:B)-b[y]/2<0,V=U?P<D?P-D:P-H:0;return{[m]:h[m]+V,data:{[m]:K,centerOffset:P-K-V,...U&&{alignmentOffset:V}},reset:U}}}),nwe=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:s,middlewareData:i,rects:a,initialPlacement:o,platform:l,elements:c}=t,{mainAxis:u=!0,crossAxis:d=!0,fallbackPlacements:h,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:b=!0,...v}=Kd(e,t);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const x=Yd(s),w=Ph(o),S=Yd(o)===o,k=await(l.isRTL==null?void 0:l.isRTL(c.floating)),C=h||(S||!b?[V2(o)]:Zxe(o)),T=y!=="none";!h&&T&&C.push(...Jxe(o,b,y,k));const A=[o,...C],N=await aw(t,v),I=[];let O=((r=i.flip)==null?void 0:r.overflows)||[];if(u&&I.push(N[x]),d){const P=Yxe(s,a,k);I.push(N[P[0]],N[P[1]])}if(O=[...O,{placement:s,overflows:I}],!I.every(P=>P<=0)){var B,D;const P=(((B=i.flip)==null?void 0:B.index)||0)+1,K=A[P];if(K)return{data:{index:P,overflows:O},reset:{placement:K}};let U=(D=O.filter(V=>V.overflows[0]<=0).sort((V,L)=>V.overflows[1]-L.overflows[1])[0])==null?void 0:D.placement;if(!U)switch(m){case"bestFit":{var H;const V=(H=O.filter(L=>{if(T){const te=Ph(L.placement);return te===w||te==="y"}return!0}).map(L=>[L.placement,L.overflows.filter(te=>te>0).reduce((te,W)=>te+W,0)]).sort((L,te)=>L[1]-te[1])[0])==null?void 0:H[0];V&&(U=V);break}case"initialPlacement":U=o;break}if(s!==U)return{reset:{placement:U}}}return{}}}};function L$(e,t){return{top:e.top-t.height,right:e.right-t.width,bottom:e.bottom-t.height,left:e.left-t.width}}function B$(e){return Hxe.some(t=>e[t]>=0)}const rwe=function(e){return e===void 0&&(e={}),{name:"hide",options:e,async fn(t){const{rects:n}=t,{strategy:r="referenceHidden",...s}=Kd(e,t);switch(r){case"referenceHidden":{const i=await aw(t,{...s,elementContext:"reference"}),a=L$(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:B$(a)}}}case"escaped":{const i=await aw(t,{...s,altBoundary:!0}),a=L$(i,n.floating);return{data:{escapedOffsets:a,escaped:B$(a)}}}default:return{}}}}};async function swe(e,t){const{placement:n,platform:r,elements:s}=e,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),a=Yd(n),o=Zy(n),l=Ph(n)==="y",c=["left","top"].includes(a)?-1:1,u=i&&l?-1:1,d=Kd(t,e);let{mainAxis:h,crossAxis:m,alignmentAxis:y}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof y=="number"&&(m=o==="end"?y*-1:y),l?{x:m*u,y:h*c}:{x:h*c,y:m*u}}const iwe=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:s,y:i,placement:a,middlewareData:o}=t,l=await swe(t,e);return a===((n=o.offset)==null?void 0:n.placement)&&(r=o.arrow)!=null&&r.alignmentOffset?{}:{x:s+l.x,y:i+l.y,data:{...l,placement:a}}}}},awe=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:s}=t,{mainAxis:i=!0,crossAxis:a=!1,limiter:o={fn:v=>{let{x,y:w}=v;return{x,y:w}}},...l}=Kd(e,t),c={x:n,y:r},u=await aw(t,l),d=Ph(Yd(s)),h=uO(d);let m=c[h],y=c[d];if(i){const v=h==="y"?"top":"left",x=h==="y"?"bottom":"right",w=m+u[v],S=m-u[x];m=Cj(w,m,S)}if(a){const v=d==="y"?"top":"left",x=d==="y"?"bottom":"right",w=y+u[v],S=y-u[x];y=Cj(w,y,S)}const b=o.fn({...t,[h]:m,[d]:y});return{...b,data:{x:b.x-n,y:b.y-r,enabled:{[h]:i,[d]:a}}}}}},owe=function(e){return e===void 0&&(e={}),{options:e,fn(t){const{x:n,y:r,placement:s,rects:i,middlewareData:a}=t,{offset:o=0,mainAxis:l=!0,crossAxis:c=!0}=Kd(e,t),u={x:n,y:r},d=Ph(s),h=uO(d);let m=u[h],y=u[d];const b=Kd(o,t),v=typeof b=="number"?{mainAxis:b,crossAxis:0}:{mainAxis:0,crossAxis:0,...b};if(l){const S=h==="y"?"height":"width",k=i.reference[h]-i.floating[S]+v.mainAxis,C=i.reference[h]+i.reference[S]-v.mainAxis;m<k?m=k:m>C&&(m=C)}if(c){var x,w;const S=h==="y"?"width":"height",k=["top","left"].includes(Yd(s)),C=i.reference[d]-i.floating[S]+(k&&((x=a.offset)==null?void 0:x[d])||0)+(k?0:v.crossAxis),T=i.reference[d]+i.reference[S]+(k?0:((w=a.offset)==null?void 0:w[d])||0)-(k?v.crossAxis:0);y<C?y=C:y>T&&(y=T)}return{[h]:m,[d]:y}}}},lwe=function(e){return e===void 0&&(e={}),{name:"size",options:e,async fn(t){var n,r;const{placement:s,rects:i,platform:a,elements:o}=t,{apply:l=()=>{},...c}=Kd(e,t),u=await aw(t,c),d=Yd(s),h=Zy(s),m=Ph(s)==="y",{width:y,height:b}=i.floating;let v,x;d==="top"||d==="bottom"?(v=d,x=h===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(x=d,v=h==="end"?"top":"bottom");const w=b-u.top-u.bottom,S=y-u.left-u.right,k=jh(b-u[v],w),C=jh(y-u[x],S),T=!t.middlewareData.shift;let A=k,N=C;if((n=t.middlewareData.shift)!=null&&n.enabled.x&&(N=S),(r=t.middlewareData.shift)!=null&&r.enabled.y&&(A=w),T&&!h){const O=ul(u.left,0),B=ul(u.right,0),D=ul(u.top,0),H=ul(u.bottom,0);m?N=y-2*(O!==0||B!==0?O+B:ul(u.left,u.right)):A=b-2*(D!==0||H!==0?D+H:ul(u.top,u.bottom))}await l({...t,availableWidth:N,availableHeight:A});const I=await a.getDimensions(o.floating);return y!==I.width||b!==I.height?{reset:{rects:!0}}:{}}}};function DE(){return typeof window<"u"}function Xy(e){return GG(e)?(e.nodeName||"").toLowerCase():"#document"}function fl(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function qu(e){var t;return(t=(GG(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function GG(e){return DE()?e instanceof Node||e instanceof fl(e).Node:!1}function Dc(e){return DE()?e instanceof Element||e instanceof fl(e).Element:!1}function Fu(e){return DE()?e instanceof HTMLElement||e instanceof fl(e).HTMLElement:!1}function $$(e){return!DE()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof fl(e).ShadowRoot}function w1(e){const{overflow:t,overflowX:n,overflowY:r,display:s}=Fc(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!["inline","contents"].includes(s)}function cwe(e){return["table","td","th"].includes(Xy(e))}function FE(e){return[":popover-open",":modal"].some(t=>{try{return e.matches(t)}catch{return!1}})}function hO(e){const t=pO(),n=Dc(e)?Fc(e):e;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function uwe(e){let t=Oh(e);for(;Fu(t)&&!uy(t);){if(hO(t))return t;if(FE(t))return null;t=Oh(t)}return null}function pO(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function uy(e){return["html","body","#document"].includes(Xy(e))}function Fc(e){return fl(e).getComputedStyle(e)}function LE(e){return Dc(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Oh(e){if(Xy(e)==="html")return e;const t=e.assignedSlot||e.parentNode||$$(e)&&e.host||qu(e);return $$(t)?t.host:t}function KG(e){const t=Oh(e);return uy(t)?e.ownerDocument?e.ownerDocument.body:e.body:Fu(t)&&w1(t)?t:KG(t)}function ow(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const s=KG(e),i=s===((r=e.ownerDocument)==null?void 0:r.body),a=fl(s);if(i){const o=Ej(a);return t.concat(a,a.visualViewport||[],w1(s)?s:[],o&&n?ow(o):[])}return t.concat(s,ow(s,[],n))}function Ej(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function YG(e){const t=Fc(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const s=Fu(e),i=s?e.offsetWidth:n,a=s?e.offsetHeight:r,o=q2(n)!==i||q2(r)!==a;return o&&(n=i,r=a),{width:n,height:r,$:o}}function mO(e){return Dc(e)?e:e.contextElement}function D0(e){const t=mO(e);if(!Fu(t))return Tu(1);const n=t.getBoundingClientRect(),{width:r,height:s,$:i}=YG(t);let a=(i?q2(n.width):n.width)/r,o=(i?q2(n.height):n.height)/s;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const dwe=Tu(0);function ZG(e){const t=fl(e);return!pO()||!t.visualViewport?dwe:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function fwe(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==fl(e)?!1:t}function Nm(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const s=e.getBoundingClientRect(),i=mO(e);let a=Tu(1);t&&(r?Dc(r)&&(a=D0(r)):a=D0(e));const o=fwe(i,n,r)?ZG(i):Tu(0);let l=(s.left+o.x)/a.x,c=(s.top+o.y)/a.y,u=s.width/a.x,d=s.height/a.y;if(i){const h=fl(i),m=r&&Dc(r)?fl(r):r;let y=h,b=Ej(y);for(;b&&r&&m!==y;){const v=D0(b),x=b.getBoundingClientRect(),w=Fc(b),S=x.left+(b.clientLeft+parseFloat(w.paddingLeft))*v.x,k=x.top+(b.clientTop+parseFloat(w.paddingTop))*v.y;l*=v.x,c*=v.y,u*=v.x,d*=v.y,l+=S,c+=k,y=fl(b),b=Ej(y)}}return W2({width:u,height:d,x:l,y:c})}function gO(e,t){const n=LE(e).scrollLeft;return t?t.left+n:Nm(qu(e)).left+n}function XG(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),s=r.left+t.scrollLeft-(n?0:gO(e,r)),i=r.top+t.scrollTop;return{x:s,y:i}}function hwe(e){let{elements:t,rect:n,offsetParent:r,strategy:s}=e;const i=s==="fixed",a=qu(r),o=t?FE(t.floating):!1;if(r===a||o&&i)return n;let l={scrollLeft:0,scrollTop:0},c=Tu(1);const u=Tu(0),d=Fu(r);if((d||!d&&!i)&&((Xy(r)!=="body"||w1(a))&&(l=LE(r)),Fu(r))){const m=Nm(r);c=D0(r),u.x=m.x+r.clientLeft,u.y=m.y+r.clientTop}const h=a&&!d&&!i?XG(a,l,!0):Tu(0);return{width:n.width*c.x,height:n.height*c.y,x:n.x*c.x-l.scrollLeft*c.x+u.x+h.x,y:n.y*c.y-l.scrollTop*c.y+u.y+h.y}}function pwe(e){return Array.from(e.getClientRects())}function mwe(e){const t=qu(e),n=LE(e),r=e.ownerDocument.body,s=ul(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),i=ul(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+gO(e);const o=-n.scrollTop;return Fc(r).direction==="rtl"&&(a+=ul(t.clientWidth,r.clientWidth)-s),{width:s,height:i,x:a,y:o}}function gwe(e,t){const n=fl(e),r=qu(e),s=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,o=0,l=0;if(s){i=s.width,a=s.height;const c=pO();(!c||c&&t==="fixed")&&(o=s.offsetLeft,l=s.offsetTop)}return{width:i,height:a,x:o,y:l}}function ywe(e,t){const n=Nm(e,!0,t==="fixed"),r=n.top+e.clientTop,s=n.left+e.clientLeft,i=Fu(e)?D0(e):Tu(1),a=e.clientWidth*i.x,o=e.clientHeight*i.y,l=s*i.x,c=r*i.y;return{width:a,height:o,x:l,y:c}}function z$(e,t,n){let r;if(t==="viewport")r=gwe(e,n);else if(t==="document")r=mwe(qu(e));else if(Dc(t))r=ywe(t,n);else{const s=ZG(e);r={x:t.x-s.x,y:t.y-s.y,width:t.width,height:t.height}}return W2(r)}function JG(e,t){const n=Oh(e);return n===t||!Dc(n)||uy(n)?!1:Fc(n).position==="fixed"||JG(n,t)}function bwe(e,t){const n=t.get(e);if(n)return n;let r=ow(e,[],!1).filter(o=>Dc(o)&&Xy(o)!=="body"),s=null;const i=Fc(e).position==="fixed";let a=i?Oh(e):e;for(;Dc(a)&&!uy(a);){const o=Fc(a),l=hO(a);!l&&o.position==="fixed"&&(s=null),(i?!l&&!s:!l&&o.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||w1(a)&&!l&&JG(e,a))?r=r.filter(u=>u!==a):s=o,a=Oh(a)}return t.set(e,r),r}function vwe(e){let{element:t,boundary:n,rootBoundary:r,strategy:s}=e;const a=[...n==="clippingAncestors"?FE(t)?[]:bwe(t,this._c):[].concat(n),r],o=a[0],l=a.reduce((c,u)=>{const d=z$(t,u,s);return c.top=ul(d.top,c.top),c.right=jh(d.right,c.right),c.bottom=jh(d.bottom,c.bottom),c.left=ul(d.left,c.left),c},z$(t,o,s));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function xwe(e){const{width:t,height:n}=YG(e);return{width:t,height:n}}function wwe(e,t,n){const r=Fu(t),s=qu(t),i=n==="fixed",a=Nm(e,!0,i,t);let o={scrollLeft:0,scrollTop:0};const l=Tu(0);if(r||!r&&!i)if((Xy(t)!=="body"||w1(s))&&(o=LE(t)),r){const h=Nm(t,!0,i,t);l.x=h.x+t.clientLeft,l.y=h.y+t.clientTop}else s&&(l.x=gO(s));const c=s&&!r&&!i?XG(s,o):Tu(0),u=a.left+o.scrollLeft-l.x-c.x,d=a.top+o.scrollTop-l.y-c.y;return{x:u,y:d,width:a.width,height:a.height}}function rM(e){return Fc(e).position==="static"}function U$(e,t){if(!Fu(e)||Fc(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return qu(e)===n&&(n=n.ownerDocument.body),n}function QG(e,t){const n=fl(e);if(FE(e))return n;if(!Fu(e)){let s=Oh(e);for(;s&&!uy(s);){if(Dc(s)&&!rM(s))return s;s=Oh(s)}return n}let r=U$(e,t);for(;r&&cwe(r)&&rM(r);)r=U$(r,t);return r&&uy(r)&&rM(r)&&!hO(r)?n:r||uwe(e)||n}const _we=async function(e){const t=this.getOffsetParent||QG,n=this.getDimensions,r=await n(e.floating);return{reference:wwe(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Swe(e){return Fc(e).direction==="rtl"}const Cwe={convertOffsetParentRelativeRectToViewportRelativeRect:hwe,getDocumentElement:qu,getClippingRect:vwe,getOffsetParent:QG,getElementRects:_we,getClientRects:pwe,getDimensions:xwe,getScale:D0,isElement:Dc,isRTL:Swe};function eK(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function kwe(e,t){let n=null,r;const s=qu(e);function i(){var o;clearTimeout(r),(o=n)==null||o.disconnect(),n=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),i();const c=e.getBoundingClientRect(),{left:u,top:d,width:h,height:m}=c;if(o||t(),!h||!m)return;const y=FS(d),b=FS(s.clientWidth-(u+h)),v=FS(s.clientHeight-(d+m)),x=FS(u),S={rootMargin:-y+"px "+-b+"px "+-v+"px "+-x+"px",threshold:ul(0,jh(1,l))||1};let k=!0;function C(T){const A=T[0].intersectionRatio;if(A!==l){if(!k)return a();A?a(!1,A):r=setTimeout(()=>{a(!1,1e-7)},1e3)}A===1&&!eK(c,e.getBoundingClientRect())&&a(),k=!1}try{n=new IntersectionObserver(C,{...S,root:s.ownerDocument})}catch{n=new IntersectionObserver(C,S)}n.observe(e)}return a(!0),i}function yO(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,c=mO(e),u=s||i?[...c?ow(c):[],...ow(t)]:[];u.forEach(x=>{s&&x.addEventListener("scroll",n,{passive:!0}),i&&x.addEventListener("resize",n)});const d=c&&o?kwe(c,n):null;let h=-1,m=null;a&&(m=new ResizeObserver(x=>{let[w]=x;w&&w.target===c&&m&&(m.unobserve(t),cancelAnimationFrame(h),h=requestAnimationFrame(()=>{var S;(S=m)==null||S.observe(t)})),n()}),c&&!l&&m.observe(c),m.observe(t));let y,b=l?Nm(e):null;l&&v();function v(){const x=Nm(e);b&&!eK(b,x)&&n(),b=x,y=requestAnimationFrame(v)}return n(),()=>{var x;u.forEach(w=>{s&&w.removeEventListener("scroll",n),i&&w.removeEventListener("resize",n)}),d==null||d(),(x=m)==null||x.disconnect(),m=null,l&&cancelAnimationFrame(y)}}const Ewe=iwe,Twe=awe,Awe=nwe,Rwe=lwe,Nwe=rwe,q$=twe,Mwe=owe,Iwe=(e,t,n)=>{const r=new Map,s={platform:Cwe,...n},i={...s.platform,_c:r};return ewe(e,t,{...s,platform:i})};var LC=typeof document<"u"?E.useLayoutEffect:E.useEffect;function H2(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(typeof e=="function"&&e.toString()===t.toString())return!0;let n,r,s;if(e&&t&&typeof e=="object"){if(Array.isArray(e)){if(n=e.length,n!==t.length)return!1;for(r=n;r--!==0;)if(!H2(e[r],t[r]))return!1;return!0}if(s=Object.keys(e),n=s.length,n!==Object.keys(t).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(t,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&e.$$typeof)&&!H2(e[i],t[i]))return!1}return!0}return e!==e&&t!==t}function tK(e){return typeof window>"u"?1:(e.ownerDocument.defaultView||window).devicePixelRatio||1}function V$(e,t){const n=tK(e);return Math.round(t*n)/n}function sM(e){const t=E.useRef(e);return LC(()=>{t.current=e}),t}function bO(e){e===void 0&&(e={});const{placement:t="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:a}={},transform:o=!0,whileElementsMounted:l,open:c}=e,[u,d]=E.useState({x:0,y:0,strategy:n,placement:t,middlewareData:{},isPositioned:!1}),[h,m]=E.useState(r);H2(h,r)||m(r);const[y,b]=E.useState(null),[v,x]=E.useState(null),w=E.useCallback(L=>{L!==T.current&&(T.current=L,b(L))},[]),S=E.useCallback(L=>{L!==A.current&&(A.current=L,x(L))},[]),k=i||y,C=a||v,T=E.useRef(null),A=E.useRef(null),N=E.useRef(u),I=l!=null,O=sM(l),B=sM(s),D=sM(c),H=E.useCallback(()=>{if(!T.current||!A.current)return;const L={placement:t,strategy:n,middleware:h};B.current&&(L.platform=B.current),Iwe(T.current,A.current,L).then(te=>{const W={...te,isPositioned:D.current!==!1};P.current&&!H2(N.current,W)&&(N.current=W,dl.flushSync(()=>{d(W)}))})},[h,t,n,B,D]);LC(()=>{c===!1&&N.current.isPositioned&&(N.current.isPositioned=!1,d(L=>({...L,isPositioned:!1})))},[c]);const P=E.useRef(!1);LC(()=>(P.current=!0,()=>{P.current=!1}),[]),LC(()=>{if(k&&(T.current=k),C&&(A.current=C),k&&C){if(O.current)return O.current(k,C,H);H()}},[k,C,H,O,I]);const K=E.useMemo(()=>({reference:T,floating:A,setReference:w,setFloating:S}),[w,S]),U=E.useMemo(()=>({reference:k,floating:C}),[k,C]),V=E.useMemo(()=>{const L={position:n,left:0,top:0};if(!U.floating)return L;const te=V$(U.floating,u.x),W=V$(U.floating,u.y);return o?{...L,transform:"translate("+te+"px, "+W+"px)",...tK(U.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:te,top:W}},[n,o,U.floating,u.x,u.y]);return E.useMemo(()=>({...u,update:H,refs:K,elements:U,floatingStyles:V}),[u,H,K,U,V])}const jwe=e=>{function t(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:e,fn(n){const{element:r,padding:s}=typeof e=="function"?e(n):e;return r&&t(r)?r.current!=null?q$({element:r.current,padding:s}).fn(n):{}:r?q$({element:r,padding:s}).fn(n):{}}}},vO=(e,t)=>({...Ewe(e),options:[e,t]}),xO=(e,t)=>({...Twe(e),options:[e,t]}),wO=(e,t)=>({...Mwe(e),options:[e,t]}),_O=(e,t)=>({...Awe(e),options:[e,t]}),SO=(e,t)=>({...Rwe(e),options:[e,t]}),CO=(e,t)=>({...Nwe(e),options:[e,t]}),kO=(e,t)=>({...jwe(e),options:[e,t]});var Pwe="Arrow",nK=E.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(cr.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});nK.displayName=Pwe;var Owe=nK;function Jy(e){const[t,n]=E.useState(void 0);return si(()=>{if(e){n({width:e.offsetWidth,height:e.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,o;if("borderBoxSize"in i){const l=i.borderBoxSize,c=Array.isArray(l)?l[0]:l;a=c.inlineSize,o=c.blockSize}else a=e.offsetWidth,o=e.offsetHeight;n({width:a,height:o})});return r.observe(e,{box:"border-box"}),()=>r.unobserve(e)}else n(void 0)},[e]),t}var EO="Popper",[rK,BE]=Yi(EO),[Dwe,sK]=rK(EO),iK=e=>{const{__scopePopper:t,children:n}=e,[r,s]=E.useState(null);return f.jsx(Dwe,{scope:t,anchor:r,onAnchorChange:s,children:n})};iK.displayName=EO;var aK="PopperAnchor",oK=E.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=sK(aK,n),a=E.useRef(null),o=In(t,a);return E.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(cr.div,{...s,ref:o})});oK.displayName=aK;var TO="PopperContent",[Fwe,Lwe]=rK(TO),lK=E.forwardRef((e,t)=>{var Fe,Se,Ce,qe,Qe,We;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=sK(TO,n),[x,w]=E.useState(null),S=In(t,je=>w(je)),[k,C]=E.useState(null),T=Jy(k),A=(T==null?void 0:T.width)??0,N=(T==null?void 0:T.height)??0,I=r+(i!=="center"?"-"+i:""),O=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},B=Array.isArray(c)?c:[c],D=B.length>0,H={padding:O,boundary:B.filter($we),altBoundary:D},{refs:P,floatingStyles:K,placement:U,isPositioned:V,middlewareData:L}=bO({strategy:"fixed",placement:I,whileElementsMounted:(...je)=>yO(...je,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[vO({mainAxis:s+N,alignmentAxis:a}),l&&xO({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?wO():void 0,...H}),l&&_O({...H}),SO({...H,apply:({elements:je,rects:Y,availableWidth:ye,availableHeight:Ie})=>{const{width:ce,height:oe}=Y.reference,se=je.floating.style;se.setProperty("--radix-popper-available-width",`${ye}px`),se.setProperty("--radix-popper-available-height",`${Ie}px`),se.setProperty("--radix-popper-anchor-width",`${ce}px`),se.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),k&&kO({element:k,padding:o}),zwe({arrowWidth:A,arrowHeight:N}),h&&CO({strategy:"referenceHidden",...H})]}),[te,W]=dK(U),Q=Es(y);si(()=>{V&&(Q==null||Q())},[V,Q]);const ee=(Fe=L.arrow)==null?void 0:Fe.x,re=(Se=L.arrow)==null?void 0:Se.y,pe=((Ce=L.arrow)==null?void 0:Ce.centerOffset)!==0,[de,Oe]=E.useState();return si(()=>{x&&Oe(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:P.setFloating,"data-radix-popper-content-wrapper":"",style:{...K,transform:V?K.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:de,"--radix-popper-transform-origin":[(qe=L.transformOrigin)==null?void 0:qe.x,(Qe=L.transformOrigin)==null?void 0:Qe.y].join(" "),...((We=L.hide)==null?void 0:We.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(Fwe,{scope:n,placedSide:te,onArrowChange:C,arrowX:ee,arrowY:re,shouldHideArrow:pe,children:f.jsx(cr.div,{"data-side":te,"data-align":W,...b,ref:S,style:{...b.style,animation:V?void 0:"none"}})})})});lK.displayName=TO;var cK="PopperArrow",Bwe={top:"bottom",right:"left",bottom:"top",left:"right"},uK=E.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=Lwe(cK,r),a=Bwe[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(Owe,{...s,ref:n,style:{...s.style,display:"block"}})})});uK.displayName=cK;function $we(e){return e!==null}var zwe=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=dK(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function dK(e){const[t,n="center"]=e.split("-");return[t,n]}var fK=iK,hK=oK,pK=lK,mK=uK,Uwe="Portal",$E=E.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=E.useState(!1);si(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?AE.createPortal(f.jsx(cr.div,{...r,ref:t}),a):null});$E.displayName=Uwe;function qwe(e,t){return E.useReducer((n,r)=>t[n][r]??n,e)}var fa=e=>{const{present:t,children:n}=e,r=Vwe(t),s=typeof n=="function"?n({present:r.isPresent}):E.Children.only(n),i=In(r.ref,Wwe(s));return typeof n=="function"||r.isPresent?E.cloneElement(s,{ref:i}):null};fa.displayName="Presence";function Vwe(e){const[t,n]=E.useState(),r=E.useRef(null),s=E.useRef(e),i=E.useRef("none"),a=e?"mounted":"unmounted",[o,l]=qwe(a,{mounted:{UNMOUNT:"unmounted",ANIMATION_OUT:"unmountSuspended"},unmountSuspended:{MOUNT:"mounted",ANIMATION_END:"unmounted"},unmounted:{MOUNT:"mounted"}});return E.useEffect(()=>{const c=LS(r.current);i.current=o==="mounted"?c:"none"},[o]),si(()=>{const c=r.current,u=s.current;if(u!==e){const h=i.current,m=LS(c);e?l("MOUNT"):m==="none"||(c==null?void 0:c.display)==="none"?l("UNMOUNT"):l(u&&h!==m?"ANIMATION_OUT":"UNMOUNT"),s.current=e}},[e,l]),si(()=>{if(t){let c;const u=t.ownerDocument.defaultView??window,d=m=>{const b=LS(r.current).includes(m.animationName);if(m.target===t&&b&&(l("ANIMATION_END"),!s.current)){const v=t.style.animationFillMode;t.style.animationFillMode="forwards",c=u.setTimeout(()=>{t.style.animationFillMode==="forwards"&&(t.style.animationFillMode=v)})}},h=m=>{m.target===t&&(i.current=LS(r.current))};return t.addEventListener("animationstart",h),t.addEventListener("animationcancel",d),t.addEventListener("animationend",d),()=>{u.clearTimeout(c),t.removeEventListener("animationstart",h),t.removeEventListener("animationcancel",d),t.removeEventListener("animationend",d)}}else l("ANIMATION_END")},[t,l]),{isPresent:["mounted","unmountSuspended"].includes(o),ref:E.useCallback(c=>{r.current=c?getComputedStyle(c):null,n(c)},[])}}function LS(e){return(e==null?void 0:e.animationName)||"none"}function Wwe(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var Hwe=Symbol("radix.slottable");function Gwe(e){const t=({children:n})=>f.jsx(f.Fragment,{children:n});return t.displayName=`${e}.Slottable`,t.__radixId=Hwe,t}var Kwe=sH[" useInsertionEffect ".trim().toString()]||si;function Lc({prop:e,defaultProp:t,onChange:n=()=>{},caller:r}){const[s,i,a]=Ywe({defaultProp:t,onChange:n}),o=e!==void 0,l=o?e:s;{const u=E.useRef(e!==void 0);E.useEffect(()=>{const d=u.current;d!==o&&console.warn(`${r} is changing from ${d?"controlled":"uncontrolled"} to ${o?"controlled":"uncontrolled"}. Components should not switch from controlled to uncontrolled (or vice versa). Decide between using a controlled or uncontrolled value for the lifetime of the component.`),u.current=o},[o,r])}const c=E.useCallback(u=>{var d;if(o){const h=Zwe(u)?u(e):u;h!==e&&((d=a.current)==null||d.call(a,h))}else i(u)},[o,e,i,a]);return[l,c]}function Ywe({defaultProp:e,onChange:t}){const[n,r]=E.useState(e),s=E.useRef(n),i=E.useRef(t);return Kwe(()=>{i.current=t},[t]),E.useEffect(()=>{var a;s.current!==n&&((a=i.current)==null||a.call(i,n),s.current=n)},[n,s]),[n,r,i]}function Zwe(e){return typeof e=="function"}var Xwe=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),Jwe="VisuallyHidden",gK=E.forwardRef((e,t)=>f.jsx(cr.span,{...e,ref:t,style:{...Xwe,...e.style}}));gK.displayName=Jwe;var Qwe=gK,[zE,Adt]=Yi("Tooltip",[BE]),UE=BE(),yK="TooltipProvider",e1e=700,Tj="tooltip.open",[t1e,AO]=zE(yK),bK=e=>{const{__scopeTooltip:t,delayDuration:n=e1e,skipDelayDuration:r=300,disableHoverableContent:s=!1,children:i}=e,a=E.useRef(!0),o=E.useRef(!1),l=E.useRef(0);return E.useEffect(()=>{const c=l.current;return()=>window.clearTimeout(c)},[]),f.jsx(t1e,{scope:t,isOpenDelayedRef:a,delayDuration:n,onOpen:E.useCallback(()=>{window.clearTimeout(l.current),a.current=!1},[]),onClose:E.useCallback(()=>{window.clearTimeout(l.current),l.current=window.setTimeout(()=>a.current=!0,r)},[r]),isPointerInTransitRef:o,onPointerInTransitChange:E.useCallback(c=>{o.current=c},[]),disableHoverableContent:s,children:i})};bK.displayName=yK;var lw="Tooltip",[n1e,_1]=zE(lw),vK=e=>{const{__scopeTooltip:t,children:n,open:r,defaultOpen:s,onOpenChange:i,disableHoverableContent:a,delayDuration:o}=e,l=AO(lw,e.__scopeTooltip),c=UE(t),[u,d]=E.useState(null),h=ca(),m=E.useRef(0),y=a??l.disableHoverableContent,b=o??l.delayDuration,v=E.useRef(!1),[x,w]=Lc({prop:r,defaultProp:s??!1,onChange:A=>{A?(l.onOpen(),document.dispatchEvent(new CustomEvent(Tj))):l.onClose(),i==null||i(A)},caller:lw}),S=E.useMemo(()=>x?v.current?"delayed-open":"instant-open":"closed",[x]),k=E.useCallback(()=>{window.clearTimeout(m.current),m.current=0,v.current=!1,w(!0)},[w]),C=E.useCallback(()=>{window.clearTimeout(m.current),m.current=0,w(!1)},[w]),T=E.useCallback(()=>{window.clearTimeout(m.current),m.current=window.setTimeout(()=>{v.current=!0,w(!0),m.current=0},b)},[b,w]);return E.useEffect(()=>()=>{m.current&&(window.clearTimeout(m.current),m.current=0)},[]),f.jsx(fK,{...c,children:f.jsx(n1e,{scope:t,contentId:h,open:x,stateAttribute:S,trigger:u,onTriggerChange:d,onTriggerEnter:E.useCallback(()=>{l.isOpenDelayedRef.current?T():k()},[l.isOpenDelayedRef,T,k]),onTriggerLeave:E.useCallback(()=>{y?C():(window.clearTimeout(m.current),m.current=0)},[C,y]),onOpen:k,onClose:C,disableHoverableContent:y,children:n})})};vK.displayName=lw;var Aj="TooltipTrigger",xK=E.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=_1(Aj,n),i=AO(Aj,n),a=UE(n),o=E.useRef(null),l=In(t,o,s.onTriggerChange),c=E.useRef(!1),u=E.useRef(!1),d=E.useCallback(()=>c.current=!1,[]);return E.useEffect(()=>()=>document.removeEventListener("pointerup",d),[d]),f.jsx(hK,{asChild:!0,...a,children:f.jsx(cr.button,{"aria-describedby":s.open?s.contentId:void 0,"data-state":s.stateAttribute,...r,ref:l,onPointerMove:Wt(e.onPointerMove,h=>{h.pointerType!=="touch"&&!u.current&&!i.isPointerInTransitRef.current&&(s.onTriggerEnter(),u.current=!0)}),onPointerLeave:Wt(e.onPointerLeave,()=>{s.onTriggerLeave(),u.current=!1}),onPointerDown:Wt(e.onPointerDown,()=>{s.open&&s.onClose(),c.current=!0,document.addEventListener("pointerup",d,{once:!0})}),onFocus:Wt(e.onFocus,()=>{c.current||s.onOpen()}),onBlur:Wt(e.onBlur,s.onClose),onClick:Wt(e.onClick,s.onClose)})})});xK.displayName=Aj;var RO="TooltipPortal",[r1e,s1e]=zE(RO,{forceMount:void 0}),wK=e=>{const{__scopeTooltip:t,forceMount:n,children:r,container:s}=e,i=_1(RO,t);return f.jsx(r1e,{scope:t,forceMount:n,children:f.jsx(fa,{present:n||i.open,children:f.jsx($E,{asChild:!0,container:s,children:r})})})};wK.displayName=RO;var dy="TooltipContent",_K=E.forwardRef((e,t)=>{const n=s1e(dy,e.__scopeTooltip),{forceMount:r=n.forceMount,side:s="top",...i}=e,a=_1(dy,e.__scopeTooltip);return f.jsx(fa,{present:r||a.open,children:a.disableHoverableContent?f.jsx(SK,{side:s,...i,ref:t}):f.jsx(i1e,{side:s,...i,ref:t})})}),i1e=E.forwardRef((e,t)=>{const n=_1(dy,e.__scopeTooltip),r=AO(dy,e.__scopeTooltip),s=E.useRef(null),i=In(t,s),[a,o]=E.useState(null),{trigger:l,onClose:c}=n,u=s.current,{onPointerInTransitChange:d}=r,h=E.useCallback(()=>{o(null),d(!1)},[d]),m=E.useCallback((y,b)=>{const v=y.currentTarget,x={x:y.clientX,y:y.clientY},w=c1e(x,v.getBoundingClientRect()),S=u1e(x,w),k=d1e(b.getBoundingClientRect()),C=h1e([...S,...k]);o(C),d(!0)},[d]);return E.useEffect(()=>()=>h(),[h]),E.useEffect(()=>{if(l&&u){const y=v=>m(v,u),b=v=>m(v,l);return l.addEventListener("pointerleave",y),u.addEventListener("pointerleave",b),()=>{l.removeEventListener("pointerleave",y),u.removeEventListener("pointerleave",b)}}},[l,u,m,h]),E.useEffect(()=>{if(a){const y=b=>{const v=b.target,x={x:b.clientX,y:b.clientY},w=(l==null?void 0:l.contains(v))||(u==null?void 0:u.contains(v)),S=!f1e(x,a);w?h():S&&(h(),c())};return document.addEventListener("pointermove",y),()=>document.removeEventListener("pointermove",y)}},[l,u,a,c,h]),f.jsx(SK,{...e,ref:i})}),[a1e,o1e]=zE(lw,{isInside:!1}),l1e=Gwe("TooltipContent"),SK=E.forwardRef((e,t)=>{const{__scopeTooltip:n,children:r,"aria-label":s,onEscapeKeyDown:i,onPointerDownOutside:a,...o}=e,l=_1(dy,n),c=UE(n),{onClose:u}=l;return E.useEffect(()=>(document.addEventListener(Tj,u),()=>document.removeEventListener(Tj,u)),[u]),E.useEffect(()=>{if(l.trigger){const d=h=>{const m=h.target;m!=null&&m.contains(l.trigger)&&u()};return window.addEventListener("scroll",d,{capture:!0}),()=>window.removeEventListener("scroll",d,{capture:!0})}},[l.trigger,u]),f.jsx(OE,{asChild:!0,disableOutsidePointerEvents:!1,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:d=>d.preventDefault(),onDismiss:u,children:f.jsxs(pK,{"data-state":l.stateAttribute,...c,...o,ref:t,style:{...o.style,"--radix-tooltip-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-tooltip-content-available-width":"var(--radix-popper-available-width)","--radix-tooltip-content-available-height":"var(--radix-popper-available-height)","--radix-tooltip-trigger-width":"var(--radix-popper-anchor-width)","--radix-tooltip-trigger-height":"var(--radix-popper-anchor-height)"},children:[f.jsx(l1e,{children:r}),f.jsx(a1e,{scope:n,isInside:!0,children:f.jsx(Qwe,{id:l.contentId,role:"tooltip",children:s||r})})]})})});_K.displayName=dy;var CK="TooltipArrow",kK=E.forwardRef((e,t)=>{const{__scopeTooltip:n,...r}=e,s=UE(n);return o1e(CK,n).isInside?null:f.jsx(mK,{...s,...r,ref:t})});kK.displayName=CK;function c1e(e,t){const n=Math.abs(t.top-e.y),r=Math.abs(t.bottom-e.y),s=Math.abs(t.right-e.x),i=Math.abs(t.left-e.x);switch(Math.min(n,r,s,i)){case i:return"left";case s:return"right";case n:return"top";case r:return"bottom";default:throw new Error("unreachable")}}function u1e(e,t,n=5){const r=[];switch(t){case"top":r.push({x:e.x-n,y:e.y+n},{x:e.x+n,y:e.y+n});break;case"bottom":r.push({x:e.x-n,y:e.y-n},{x:e.x+n,y:e.y-n});break;case"left":r.push({x:e.x+n,y:e.y-n},{x:e.x+n,y:e.y+n});break;case"right":r.push({x:e.x-n,y:e.y-n},{x:e.x-n,y:e.y+n});break}return r}function d1e(e){const{top:t,right:n,bottom:r,left:s}=e;return[{x:s,y:t},{x:n,y:t},{x:n,y:r},{x:s,y:r}]}function f1e(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const o=t[i],l=t[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(s=!s)}return s}function h1e(e){const t=e.slice();return t.sort((n,r)=>n.x<r.x?-1:n.x>r.x?1:n.y<r.y?-1:n.y>r.y?1:0),p1e(t)}function p1e(e){if(e.length<=1)return e.slice();const t=[];for(let r=0;r<e.length;r++){const s=e[r];for(;t.length>=2;){const i=t[t.length-1],a=t[t.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))t.pop();else break}t.push(s)}t.pop();const n=[];for(let r=e.length-1;r>=0;r--){const s=e[r];for(;n.length>=2;){const i=n[n.length-1],a=n[n.length-2];if((i.x-a.x)*(s.y-a.y)>=(i.y-a.y)*(s.x-a.x))n.pop();else break}n.push(s)}return n.pop(),t.length===1&&n.length===1&&t[0].x===n[0].x&&t[0].y===n[0].y?t:t.concat(n)}var m1e=bK,g1e=vK,y1e=xK,b1e=wK,v1e=_K,x1e=kK;function wr({delayDuration:e=0,...t}){return f.jsx(m1e,{"data-slot":"tooltip-provider",delayDuration:e,...t})}function _r({...e}){return f.jsx(wr,{children:f.jsx(g1e,{"data-slot":"tooltip",...e})})}function Sr({...e}){return f.jsx(y1e,{"data-slot":"tooltip-trigger",...e})}function Cr({className:e,sideOffset:t=0,children:n,...r}){return f.jsx(b1e,{children:f.jsxs(v1e,{"data-slot":"tooltip-content",sideOffset:t,className:Ze("bg-primary text-primary-foreground animate-in fade-in-0 zoom-in-95 data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=closed]:zoom-out-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-fit origin-(--radix-tooltip-content-transform-origin) rounded-md px-3 py-1.5 text-xs text-balance",e),...r,children:[n,f.jsx(x1e,{className:"bg-primary fill-primary z-50 size-2.5 translate-y-[calc(-50%_-_2px)] rotate-45 rounded-[2px]"})]})})}class w1e{static findRendererForLanguage(t,n){const r=Object.values(n);if(r.length===0)return null;const s=r.filter(o=>{var l;return(l=o.supportedLanguages)==null?void 0:l.includes(t||"")}),i=r.filter(o=>!o.supportedLanguages||o.supportedLanguages.length===0);return[...s,...i].sort((o,l)=>(l.priority||0)-(o.priority||0))[0]||null}static renderBlock(t){const n=Wi.getState().blockRenderers,r=this.findRendererForLanguage(t.lang,n);if(!r)return null;try{return r.renderer(t)}catch(s){return console.error(`[BlockRendererService] Error rendering block with renderer ${r.id}:`,s),null}}static getRegisteredRenderers(){return Wi.getState().blockRenderers}static hasRendererForLanguage(t){const n=Wi.getState().blockRenderers;return this.findRendererForLanguage(t,n)!==null}}const Qy=({lang:e,code:t,filepath:n,isStreaming:r=!1,interactionId:s})=>{const i=Wi(yn(l=>l.blockRenderers)),a=E.useMemo(()=>qr(),[]),o=E.useMemo(()=>{const l={lang:e,code:t,filepath:n,isStreaming:r,blockId:a,interactionId:s},c=w1e.findRendererForLanguage(e,i);if(!c){const u=e?`language-${e}`:"language-plaintext";return f.jsxs("div",{className:"code-block-container my-4 max-w-full",children:[f.jsx("div",{className:"code-block-header flex items-center justify-between px-3 py-2 border border-b-0 border-border bg-muted/50 rounded-t-lg",children:f.jsx("div",{className:"text-sm font-medium",children:e?e.toUpperCase():"CODE"})}),f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere border border-border rounded-b-lg bg-muted/20",children:f.jsx("code",{className:`${u} block p-4 font-mono text-sm leading-relaxed`,children:t})})]})}try{return c.renderer(l)}catch(u){return console.error(`[UniversalBlockRenderer] Error rendering block with renderer ${c.id}:`,u),f.jsxs("div",{className:"code-block-container my-4 max-w-full",children:[f.jsx("div",{className:"code-block-header flex items-center justify-between px-3 py-2 border border-b-0 border-border bg-muted/50 rounded-t-lg",children:f.jsxs("div",{className:"text-sm font-medium text-destructive",children:[e?e.toUpperCase():"CODE"," (Render Error)"]})}),f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere border border-border rounded-b-lg bg-muted/20",children:f.jsx("code",{className:"block p-4 font-mono text-sm leading-relaxed",children:t})})]})}},[e,t,n,r,a,i]);return f.jsx(f.Fragment,{children:o})};var vt;(function(e){e[e.EPERM=1]="EPERM",e[e.ENOENT=2]="ENOENT",e[e.EINTR=4]="EINTR",e[e.EIO=5]="EIO",e[e.ENXIO=6]="ENXIO",e[e.EBADF=9]="EBADF",e[e.EAGAIN=11]="EAGAIN",e[e.ENOMEM=12]="ENOMEM",e[e.EACCES=13]="EACCES",e[e.EFAULT=14]="EFAULT",e[e.ENOTBLK=15]="ENOTBLK",e[e.EBUSY=16]="EBUSY",e[e.EEXIST=17]="EEXIST",e[e.EXDEV=18]="EXDEV",e[e.ENODEV=19]="ENODEV",e[e.ENOTDIR=20]="ENOTDIR",e[e.EISDIR=21]="EISDIR",e[e.EINVAL=22]="EINVAL",e[e.ENFILE=23]="ENFILE",e[e.EMFILE=24]="EMFILE",e[e.ETXTBSY=26]="ETXTBSY",e[e.EFBIG=27]="EFBIG",e[e.ENOSPC=28]="ENOSPC",e[e.ESPIPE=29]="ESPIPE",e[e.EROFS=30]="EROFS",e[e.EMLINK=31]="EMLINK",e[e.EPIPE=32]="EPIPE",e[e.EDOM=33]="EDOM",e[e.ERANGE=34]="ERANGE",e[e.EDEADLK=35]="EDEADLK",e[e.ENAMETOOLONG=36]="ENAMETOOLONG",e[e.ENOLCK=37]="ENOLCK",e[e.ENOSYS=38]="ENOSYS",e[e.ENOTEMPTY=39]="ENOTEMPTY",e[e.ELOOP=40]="ELOOP",e[e.ENOMSG=42]="ENOMSG",e[e.EBADE=52]="EBADE",e[e.EBADR=53]="EBADR",e[e.EXFULL=54]="EXFULL",e[e.ENOANO=55]="ENOANO",e[e.EBADRQC=56]="EBADRQC",e[e.ENOSTR=60]="ENOSTR",e[e.ENODATA=61]="ENODATA",e[e.ETIME=62]="ETIME",e[e.ENOSR=63]="ENOSR",e[e.ENONET=64]="ENONET",e[e.EREMOTE=66]="EREMOTE",e[e.ENOLINK=67]="ENOLINK",e[e.ECOMM=70]="ECOMM",e[e.EPROTO=71]="EPROTO",e[e.EBADMSG=74]="EBADMSG",e[e.EOVERFLOW=75]="EOVERFLOW",e[e.EBADFD=77]="EBADFD",e[e.ESTRPIPE=86]="ESTRPIPE",e[e.ENOTSOCK=88]="ENOTSOCK",e[e.EDESTADDRREQ=89]="EDESTADDRREQ",e[e.EMSGSIZE=90]="EMSGSIZE",e[e.EPROTOTYPE=91]="EPROTOTYPE",e[e.ENOPROTOOPT=92]="ENOPROTOOPT",e[e.EPROTONOSUPPORT=93]="EPROTONOSUPPORT",e[e.ESOCKTNOSUPPORT=94]="ESOCKTNOSUPPORT",e[e.ENOTSUP=95]="ENOTSUP",e[e.ENETDOWN=100]="ENETDOWN",e[e.ENETUNREACH=101]="ENETUNREACH",e[e.ENETRESET=102]="ENETRESET",e[e.ETIMEDOUT=110]="ETIMEDOUT",e[e.ECONNREFUSED=111]="ECONNREFUSED",e[e.EHOSTDOWN=112]="EHOSTDOWN",e[e.EHOSTUNREACH=113]="EHOSTUNREACH",e[e.EALREADY=114]="EALREADY",e[e.EINPROGRESS=115]="EINPROGRESS",e[e.ESTALE=116]="ESTALE",e[e.EREMOTEIO=121]="EREMOTEIO",e[e.EDQUOT=122]="EDQUOT"})(vt||(vt={}));const W$={[vt.EPERM]:"Operation not permitted",[vt.ENOENT]:"No such file or directory",[vt.EINTR]:"Interrupted system call",[vt.EIO]:"Input/output error",[vt.ENXIO]:"No such device or address",[vt.EBADF]:"Bad file descriptor",[vt.EAGAIN]:"Resource temporarily unavailable",[vt.ENOMEM]:"Cannot allocate memory",[vt.EACCES]:"Permission denied",[vt.EFAULT]:"Bad address",[vt.ENOTBLK]:"Block device required",[vt.EBUSY]:"Resource busy or locked",[vt.EEXIST]:"File exists",[vt.EXDEV]:"Invalid cross-device link",[vt.ENODEV]:"No such device",[vt.ENOTDIR]:"File is not a directory",[vt.EISDIR]:"File is a directory",[vt.EINVAL]:"Invalid argument",[vt.ENFILE]:"Too many open files in system",[vt.EMFILE]:"Too many open files",[vt.ETXTBSY]:"Text file busy",[vt.EFBIG]:"File is too big",[vt.ENOSPC]:"No space left on disk",[vt.ESPIPE]:"Illegal seek",[vt.EROFS]:"Cannot modify a read-only file system",[vt.EMLINK]:"Too many links",[vt.EPIPE]:"Broken pipe",[vt.EDOM]:"Numerical argument out of domain",[vt.ERANGE]:"Numerical result out of range",[vt.EDEADLK]:"Resource deadlock would occur",[vt.ENAMETOOLONG]:"File name too long",[vt.ENOLCK]:"No locks available",[vt.ENOSYS]:"Function not implemented",[vt.ENOTEMPTY]:"Directory is not empty",[vt.ELOOP]:"Too many levels of symbolic links",[vt.ENOMSG]:"No message of desired type",[vt.EBADE]:"Invalid exchange",[vt.EBADR]:"Invalid request descriptor",[vt.EXFULL]:"Exchange full",[vt.ENOANO]:"No anode",[vt.EBADRQC]:"Invalid request code",[vt.ENOSTR]:"Device not a stream",[vt.ENODATA]:"No data available",[vt.ETIME]:"Timer expired",[vt.ENOSR]:"Out of streams resources",[vt.ENONET]:"Machine is not on the network",[vt.EREMOTE]:"Object is remote",[vt.ENOLINK]:"Link has been severed",[vt.ECOMM]:"Communication error on send",[vt.EPROTO]:"Protocol error",[vt.EBADMSG]:"Bad message",[vt.EOVERFLOW]:"Value too large for defined data type",[vt.EBADFD]:"File descriptor in bad state",[vt.ESTRPIPE]:"Streams pipe error",[vt.ENOTSOCK]:"Socket operation on non-socket",[vt.EDESTADDRREQ]:"Destination address required",[vt.EMSGSIZE]:"Message too long",[vt.EPROTOTYPE]:"Protocol wrong type for socket",[vt.ENOPROTOOPT]:"Protocol not available",[vt.EPROTONOSUPPORT]:"Protocol not supported",[vt.ESOCKTNOSUPPORT]:"Socket type not supported",[vt.ENOTSUP]:"Operation is not supported",[vt.ENETDOWN]:"Network is down",[vt.ENETUNREACH]:"Network is unreachable",[vt.ENETRESET]:"Network dropped connection on reset",[vt.ETIMEDOUT]:"Connection timed out",[vt.ECONNREFUSED]:"Connection refused",[vt.EHOSTDOWN]:"Host is down",[vt.EHOSTUNREACH]:"No route to host",[vt.EALREADY]:"Operation already in progress",[vt.EINPROGRESS]:"Operation now in progress",[vt.ESTALE]:"Stale file handle",[vt.EREMOTEIO]:"Remote I/O error",[vt.EDQUOT]:"Disk quota exceeded"};class Xe extends Error{static fromJSON(t){const n=new Xe(t.errno,t.message,t.path,t.syscall);return n.code=t.code,n.stack=t.stack,n}static With(t,n,r){return new Xe(vt[t],W$[vt[t]],n,r)}constructor(t,n=W$[t],r,s=""){super(n),this.errno=t,this.message=n,this.path=r,this.syscall=s,this.code=vt[t]}toString(){return this.code+": "+this.message+(this.path?`, '${this.path}'`:"")}toJSON(){return{errno:this.errno,code:this.code,path:this.path,stack:this.stack,message:this.message,syscall:this.syscall}}bufferSize(){return 4+JSON.stringify(this.toJSON()).length}}var iM={exports:{}},H$;function _1e(){return H$||(H$=1,function(e){var t=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(l,c,u){this.fn=l,this.context=c,this.once=u||!1}function i(l,c,u,d,h){if(typeof u!="function")throw new TypeError("The listener must be a function");var m=new s(u,d||l,h),y=n?n+c:c;return l._events[y]?l._events[y].fn?l._events[y]=[l._events[y],m]:l._events[y].push(m):(l._events[y]=m,l._eventsCount++),l}function a(l,c){--l._eventsCount===0?l._events=new r:delete l._events[c]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var c=[],u,d;if(this._eventsCount===0)return c;for(d in u=this._events)t.call(u,d)&&c.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?c.concat(Object.getOwnPropertySymbols(u)):c},o.prototype.listeners=function(c){var u=n?n+c:c,d=this._events[u];if(!d)return[];if(d.fn)return[d.fn];for(var h=0,m=d.length,y=new Array(m);h<m;h++)y[h]=d[h].fn;return y},o.prototype.listenerCount=function(c){var u=n?n+c:c,d=this._events[u];return d?d.fn?1:d.length:0},o.prototype.emit=function(c,u,d,h,m,y){var b=n?n+c:c;if(!this._events[b])return!1;var v=this._events[b],x=arguments.length,w,S;if(v.fn){switch(v.once&&this.removeListener(c,v.fn,void 0,!0),x){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,u),!0;case 3:return v.fn.call(v.context,u,d),!0;case 4:return v.fn.call(v.context,u,d,h),!0;case 5:return v.fn.call(v.context,u,d,h,m),!0;case 6:return v.fn.call(v.context,u,d,h,m,y),!0}for(S=1,w=new Array(x-1);S<x;S++)w[S-1]=arguments[S];v.fn.apply(v.context,w)}else{var k=v.length,C;for(S=0;S<k;S++)switch(v[S].once&&this.removeListener(c,v[S].fn,void 0,!0),x){case 1:v[S].fn.call(v[S].context);break;case 2:v[S].fn.call(v[S].context,u);break;case 3:v[S].fn.call(v[S].context,u,d);break;case 4:v[S].fn.call(v[S].context,u,d,h);break;default:if(!w)for(C=1,w=new Array(x-1);C<x;C++)w[C-1]=arguments[C];v[S].fn.apply(v[S].context,w)}}return!0},o.prototype.on=function(c,u,d){return i(this,c,u,d,!1)},o.prototype.once=function(c,u,d){return i(this,c,u,d,!0)},o.prototype.removeListener=function(c,u,d,h){var m=n?n+c:c;if(!this._events[m])return this;if(!u)return a(this,m),this;var y=this._events[m];if(y.fn)y.fn===u&&(!h||y.once)&&(!d||y.context===d)&&a(this,m);else{for(var b=0,v=[],x=y.length;b<x;b++)(y[b].fn!==u||h&&!y[b].once||d&&y[b].context!==d)&&v.push(y[b]);v.length?this._events[m]=v.length===1?v[0]:v:a(this,m)}return this},o.prototype.removeAllListeners=function(c){var u;return c?(u=n?n+c:c,this._events[u]&&a(this,u)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,e.exports=o}(iM)),iM.exports}var S1e=_1e();const NO=da(S1e);var QW;let C1e=class extends NO{constructor(n){super();ue(this,QW,"List");ue(this,"data",new Set);n&&this.push(...n)}toSet(){return new Set(this.data)}toArray(){return Array.from(this.data)}toJSON(){return JSON.stringify(Array.from(this.data))}toString(){return this.join(",")}_set(n,r,s=!1){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not set an element outside the bounds of the list");const i=Array.from(this.data);i.splice(n,+s,r),this.data=new Set(i),this.emit("update")}set(n,r){this._set(n,r,!0)}deleteAt(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not delete an element outside the bounds of the list");this.delete(Array.from(this.data).at(n))}insert(n,r=this.data.size){this._set(r,n,!1)}at(n){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not access an element outside the bounds of the list");return Array.from(this.data).at(n)}pop(){const n=Array.from(this.data).pop();return n!==void 0&&this.delete(n),n}push(...n){for(const r of n)this.add(r);return this.data.size}join(n){return Array.from(this.data).join(n)}splice(n,r,...s){if(Math.abs(n)>this.data.size)throw new ReferenceError("Can not splice elements outside the bounds of the list");const i=Array.from(this.data),a=i.splice(n,r,...s);return this.data=new Set(i),this.emit("update"),a}add(n){return this.data.add(n),this.emit("update"),this.emit("add",n),this}clear(){this.data.clear(),this.emit("update")}delete(n){const r=this.data.delete(n);return this.emit("update"),r}has(n){return this.data.has(n)}get size(){return this.data.size}entries(){return this.toArray().entries()}keys(){return this.toArray().keys()}values(){return this.data.values()}[(QW=Symbol.toStringTag,Symbol.iterator)](){return this.data[Symbol.iterator]()}};function G$(e=new Error){const t=setTimeout(()=>{throw e},5e3);return()=>clearTimeout(t)}function vs(e){throw e}const K$=Intl.NumberFormat("en",{notation:"compact"});K$.format.bind(K$);function Hm(e,...t){const n={};for(const r of t.flat())n[r]=e[r];return n}function k1e(e){try{return JSON.parse(e),!0}catch{return!1}}function Rj(e=0,t=1){return Math.round(Math.random()*(t-e)+e)}function MO(e){return e.at(0).toUpperCase()+e.slice(1)}const E1e=new TextEncoder;function nm(e){return E1e.encode(e)}const Y$=new TextDecoder;function IO(e){if(!e)return"";if(e.buffer instanceof ArrayBuffer&&!e.buffer.resizable)return Y$.decode(e);const t=new Uint8Array(e.byteLength);return t.set(e),Y$.decode(t)}function cw(e,t){if(e.byteLength>=t)return e;if(ArrayBuffer.isView(e)){const r=cw(e.buffer,t);return new e.constructor(r,e.byteOffset,t)}const n=typeof SharedArrayBuffer<"u"&&e instanceof SharedArrayBuffer;if(e.maxByteLength>t)return n?e.grow(t):e.resize(t),e;if(n){const r=new SharedArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}try{return e.transfer(t)}catch{const r=new ArrayBuffer(t);return new Uint8Array(r).set(new Uint8Array(e)),r}}function T1e(e){return e instanceof Uint8Array?e:ArrayBuffer.isView(e)?new Uint8Array(e.buffer,e.byteOffset,e.byteLength):new Uint8Array(e)}var A1e={};let R1e="process"in globalThis&&"env"in globalThis.process&&A1e.U_DEBUG=="true";function uw(...e){R1e&&console.debug("[U]",...e)}const Z$=["int8","uint8","int16","uint16","int32","uint32","int64","uint64","int128","uint128","float32","float64","float128"],N1e=[...Z$,...Z$.map(e=>MO(e)),"char"],jO=/^(u?int|float)(8|16|32|64|128)$/i;function EK(e){return e=="char"?"uint8":e.toLowerCase()}function PO(e){return jO.test(e.toString())}function Nj(e){return e=="char"||jO.test(e.toString().toLowerCase())}function M1e(e){if(!Nj(e))throw new TypeError("Not a valid primitive type: "+e)}const X$=BigInt("0xffffffffffffffff");Symbol.metadata??(Symbol.metadata=Symbol.for("Symbol.metadata"));Object.assign(Symbol,{size:Symbol("uSize"),serialize:Symbol("uSerialize"),deserialize:Symbol("uDeserialize")});function TK(e){return e.metadata??(e.metadata={}),e.metadata.structInit=[...e.metadata.structInit??[]],e.metadata.structInit}function I1e(e){return e!=null&&typeof e=="object"&&"struct"in e}function qE(e){Symbol.metadata in e||Object.defineProperty(e,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:Object.create(null)})}function Rc(e){return typeof e=="function"&&Symbol.metadata in e&&I1e(e[Symbol.metadata])}function S1(e){return e!=null&&typeof e=="object"&&Rc(e.constructor)}function AK(e){if(!S1(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct instance")}function OO(e){return S1(e)||Rc(e)}function RK(e){if(!OO(e))throw new TypeError((typeof e=="function"?e.name:typeof e=="object"&&e?e.constructor.name:e)+" is not a struct")}function DO(e){return typeof e=="object"&&e!=null&&Symbol.size in e}function qs(e){if(e==null)return 0;if(Array.isArray(e)){let s=0;for(let i=0;i<e.length;i++)s+=qs(e[i]);return s}if(typeof e=="string")return M1e(e),+EK(e).match(jO)[2]/8;if(DO(e))return e[Symbol.size];RK(e);const t=Rc(e)?e:e.constructor;qE(t);const{struct:n}=t[Symbol.metadata];let r=n.staticSize;if(Rc(e))return r;for(const s of n.members.values()){const i=e[s.name];if(S1(i)&&i.constructor[Symbol.metadata].struct.isDynamic){n.isUnion?r=Math.max(r,qs(i)):r+=qs(i);continue}if(typeof s.length!="string")continue;let a=0;for(let o=0;o<e[s.length];o++)a+=qs(OO(i[o])?i[o]:s.type);n.isUnion?r=Math.max(r,a):r+=a}return r}function j1e(e,t){var i;RK(e);const n=Rc(e)?e:e.constructor;qE(n);const{struct:r}=n[Symbol.metadata];if(Rc(e)||!r.isDynamic)return((i=r.members.get(t))==null?void 0:i.staticOffset)??vs(new Error("Struct does not have member: "+t));let s=0;for(const a of r.members.values()){if(a.name==t)return s;const o=e[a.name];s+=qs(OO(o)?o:a.type)}throw new Error("Struct does not have member: "+t)}function P1e(e,t){return Math.ceil(e/t)*t}function Gm(e={}){return function(n,r){const s=new Map;let i=0,a=!1;for(const{name:o,type:l,length:c}of TK(r)){if(!Nj(l)&&!Rc(l))throw new TypeError("Not a valid type: "+l);if(typeof c=="string"){const h=s.get(c);if(!h)throw new Error(`"${c}" is undefined or declared after "${o}"`);if(!PO(h.type))throw new Error(`"${c}" is not a number and cannot be used to count "${o}"`)}let u=`${typeof l=="string"?l:l.name} ${o}`;c!==void 0&&(u+=`[${c}]`),s.set(o,{name:o,staticOffset:e.isUnion?0:i,type:Nj(l)?EK(l):l,length:c,decl:u});const d=typeof c=="string"||Rc(l)&&l[Symbol.metadata].struct.isDynamic?0:qs(l)*(c||1);a||(a=Rc(l)?l[Symbol.metadata].struct.isDynamic:typeof c=="string"),i=e.isUnion?Math.max(i,d):i+d,i=P1e(i,e.align||1),uw("define",n.name+"."+o)}return r.metadata.struct={options:e,members:s,staticSize:i,isDynamic:a,isUnion:e.isUnion??!1},n}}function dw(e,t){return function(n,r){let s=r.name;if(typeof s=="symbol"&&(console.warn("Symbol used for struct member name will be coerced to string: "+s.toString()),s=s.toString()),!s)throw new ReferenceError("Invalid name for struct member");return TK(r).push({name:s,type:e,length:t}),n}}function NK(e,t){return t.length===void 0?-1:typeof t.length=="string"?e[t.length]:Number.isSafeInteger(t.length)&&t.length>=0?t.length:vs(new Error("Array lengths must be natural numbers"))}function xa(e){if(DO(e)&&typeof e[Symbol.serialize]=="function")return e[Symbol.serialize]();AK(e),qE(e.constructor);const{options:t,members:n}=e.constructor[Symbol.metadata].struct,r=qs(e),s=new Uint8Array(r),i=new DataView(s.buffer);uw("serialize",e.constructor.name);let a=0,o=0;for(const l of n.values()){const c=NK(e,l);uw("	",l.decl);for(let u=0;u<Math.abs(c);u++){let d=c!=-1?e[l.name][u]:e[l.name];if(typeof d=="string"&&(d=d.charCodeAt(0)),a=o,o+=S1(d)?qs(d):qs(l.type),!PO(l.type)){s.set(d?xa(d):new Uint8Array(qs(l.type)),a);continue}const h=`set${MO(l.type)}`;if(h=="setInt64"){i.setBigInt64(a,BigInt(d),!t.bigEndian);continue}if(h=="setUint64"){i.setBigUint64(a,BigInt(d),!t.bigEndian);continue}if(h=="setInt128"){i.setBigUint64(a+(t.bigEndian?8:0),d&X$,!t.bigEndian),i.setBigInt64(a+(t.bigEndian?0:8),d>>BigInt(64),!t.bigEndian);continue}if(h=="setUint128"){i.setBigUint64(a+(t.bigEndian?8:0),d&X$,!t.bigEndian),i.setBigUint64(a+(t.bigEndian?0:8),d>>BigInt(64),!t.bigEndian);continue}if(h=="setFloat128"){i.setFloat64(a+(t.bigEndian?8:0),Number(d),!t.bigEndian),i.setBigUint64(a+(t.bigEndian?0:8),BigInt(0),!t.bigEndian);continue}i[h](a,Number(d),!t.bigEndian)}}return s}function VE(e,t){const n=T1e(t);if(DO(e)&&typeof e[Symbol.deserialize]=="function")return e[Symbol.deserialize](n);AK(e),qE(e.constructor);const{options:r,members:s}=e.constructor[Symbol.metadata].struct,i=new DataView(n.buffer,n.byteOffset,n.byteLength);uw("deserialize",e.constructor.name);let a=0,o=0;for(const l of s.values()){const c=NK(e,l);uw("	",l.decl);for(let u=0;u<Math.abs(c);u++){let d=c!=-1?e[l.name]:e;const h=c!=-1?u:l.name,m=d[h]===null||d[h]===void 0,y=m&&Rc(l.type)&&l.type[Symbol.metadata].struct.isDynamic;if(a=o,!S1(d[h])&&!y&&(o+=qs(l.type)),typeof e[l.name]=="string"){e[l.name]=e[l.name].slice(0,u)+String.fromCharCode(i.getUint8(a))+e[l.name].slice(u+1);continue}if(!PO(l.type)){if(y&&Rc(l.type))d[h]??(d[h]=new l.type);else if(m)continue;VE(d[h],new Uint8Array(n.subarray(a))),o+=qs(d[h]);continue}c&&c!=-1&&(d||(d=[]));const b=`get${MO(l.type)}`;if(b=="getInt64"){d[h]=i.getBigInt64(a,!r.bigEndian);continue}if(b=="getUint64"){d[h]=i.getBigUint64(a,!r.bigEndian);continue}if(b=="getInt128"){d[h]=i.getBigInt64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getUint128"){d[h]=i.getBigUint64(a+(r.bigEndian?0:8),!r.bigEndian)<<BigInt(64)|i.getBigUint64(a+(r.bigEndian?8:0),!r.bigEndian);continue}if(b=="getFloat128"){d[h]=i.getFloat64(a+(r.bigEndian?8:0),!r.bigEndian);continue}d[h]=i[b](a,!r.bigEndian)}}}function O1e(e){function t(n,r){return typeof n=="number"||typeof n=="string"?dw(e,n):dw(e)(n,r)}return t}const tr=Object.fromEntries(N1e.map(e=>[e,O1e(e)]));function D1e(e){return{suid:e.uid,sgid:e.gid,euid:e.uid,egid:e.gid,groups:[],...e}}const qc={root:"/",pwd:"/",credentials:D1e({uid:0,gid:0}),descriptors:new Map};function MK(e,t){let n="",r=0,s=-1,i=0,a="\0";for(let o=0;o<=e.length;++o){if(o<e.length)a=e[o];else{if(a=="/")break;a="/"}if(a=="/"){if(!(s===o-1||i===1))if(i===2){if(n.length<2||r!==2||n.at(-1)!=="."||n.at(-2)!=="."){if(n.length>2){const l=n.lastIndexOf("/");l===-1?(n="",r=0):(n=n.slice(0,l),r=n.length-1-n.lastIndexOf("/")),s=o,i=0;continue}else if(n.length!==0){n="",r=0,s=o,i=0;continue}}t&&(n+=n.length>0?"/..":"..",r=2)}else n.length>0?n+="/"+e.slice(s+1,o):n=e.slice(s+1,o),r=o-s-1;s=o,i=0}else a==="."&&i!==-1?++i:i=-1}return n}function Zd(...e){var t;let n="";for(const s of[...e.reverse(),(t=this===null||this===void 0?void 0:this.pwd)!==null&&t!==void 0?t:qc.pwd])if(s!=null&&s.length&&(n=`${s}/${n}`,s.startsWith("/")))break;const r=n.startsWith("/");return n=MK(n,!r),r?`/${n}`:n.length?n:"/"}function F1e(e){if(!e.length)return".";const t=e.startsWith("/"),n=e.endsWith("/");return e=MK(e,!t),e.length?(n&&(e+="/"),t?`/${e}`:e):t?"/":n?"./":"."}function os(...e){if(!e.length)return".";const t=e.join("/");return t!=null&&t.length?F1e(t):"."}function IK(e,t){if(e===t||(e=Zd.call(this,e),t=Zd.call(this,t),e===t))return"";const n=1,r=e.length,s=r-n,i=1,a=t.length-i,o=s<a?s:a;let l=-1,c=0;for(;c<o;c++){const d=e[n+c];if(d!==t[i+c])break;d==="/"&&(l=c)}if(c===o)if(a>o){if(t[i+c]==="/")return t.slice(i+c+1);if(c===0)return t.slice(i+c)}else s>o&&(e[n+c]==="/"?l=c:c===0&&(l=0));let u="";for(c=n+l+1;c<=r;++c)(c===r||e[c]==="/")&&(u+=u.length===0?"..":"/..");return`${u}${t.slice(i+l)}`}function Xr(e){if(e.length===0)return".";const t=e[0]==="/";let n=-1,r=!0;for(let s=e.length-1;s>=1;--s)if(e[s]==="/"){if(!r){n=s;break}}else r=!1;return n===-1?t?"/":".":t&&n===1?"//":e.slice(0,n)}function fy(e,t){let n=0,r=-1,s=!0;for(let i=e.length-1;i>=0;--i)if(e[i]==="/"){if(!s){n=i+1;break}}else r===-1&&(s=!1,r=i+1);return r===-1?"":e.slice(n,r)}function du(e){const t=e.startsWith("/"),n={root:t?"/":"",dir:"",base:"",ext:"",name:""};if(e.length===0)return n;const r=t?1:0;let s=-1,i=0,a=-1,o=!0,l=e.length-1,c=0;for(;l>=r;--l){if(e[l]==="/"){if(!o){i=l+1;break}continue}a===-1&&(o=!1,a=l+1),e[l]==="."?s===-1?s=l:c!==1&&(c=1):s!==-1&&(c=-1)}if(a!==-1){const u=i===0&&t?1:i;s===-1||c===0||c===1&&s===a-1&&s===i+1?n.base=n.name=e.slice(u,a):(n.name=e.slice(u,s),n.base=e.slice(u,a),n.ext=e.slice(s,a))}return i>0?n.dir=e.slice(0,i-1):t&&(n.dir="/"),n}var Yn;(function(e){e[e.EMERG=0]="EMERG",e[e.ALERT=1]="ALERT",e[e.CRIT=2]="CRIT",e[e.ERR=3]="ERR",e[e.WARN=4]="WARN",e[e.NOTICE=5]="NOTICE",e[e.INFO=6]="INFO",e[e.DEBUG=7]="DEBUG"})(Yn||(Yn={}));Yn.EMERG+"",Yn.ALERT+"",Yn.CRIT+"",Yn.ERR+"",Yn.WARN+"",Yn.NOTICE+"",Yn.INFO+"",Yn.DEBUG+"";const L1e=new C1e;function B1e(e,t){const n={level:e,message:t,timestamp:new Date,elapsedMs:performance.now()};L1e.add(n),G1e(n)}function $1e(e,t){var n,r;if(!(e instanceof Xe))return e.toString();const s=e.code+": "+e.message;if(!e.path)return s;const i=typeof t.fs=="string"?t.fs:(r=(n=t.fs)===null||n===void 0?void 0:n._mountPoint)!==null&&r!==void 0?r:"<unknown>";return s+": "+os(i,e.path)}function ep(e){return function(t,n={}){return B1e(e,$1e(t,n)),t}}ep(Yn.EMERG);const z1e=ep(Yn.ALERT),WE=ep(Yn.CRIT),Ro=ep(Yn.ERR),Fa=ep(Yn.WARN),FO=ep(Yn.NOTICE),jK=ep(Yn.INFO),Nx=ep(Yn.DEBUG);function U1e(e,t){return`\x1B[${t}m${e}\x1B[0m`}function q1e(e,t){const n="["+(e.elapsedMs/1e3).toFixed(3).padStart(10)+"] ";switch(t){case"ansi":return[U1e(n,"2;37")];case"css":return["%c"+n,"opacity: 0.8; color: white;"];default:return[n]}}Yn.EMERG+"",Yn.ALERT+"",Yn.CRIT+"",Yn.ERR+"",Yn.WARN+"",Yn.NOTICE+"",Yn.INFO+"",Yn.DEBUG+"",Yn.EMERG+"",Yn.ALERT+"",Yn.CRIT+"",Yn.ERR+"",Yn.WARN+"",Yn.NOTICE+"",Yn.INFO+"",Yn.DEBUG+"";Yn.EMERG+"",Yn.ALERT+"",Yn.CRIT+"",Yn.ERR+"",Yn.WARN+"",Yn.NOTICE+"",Yn.INFO+"",Yn.DEBUG+"",Yn.EMERG+"",Yn.ALERT+"",Yn.CRIT+"",Yn.ERR+"",Yn.WARN+"",Yn.NOTICE+"",Yn.INFO+"",Yn.DEBUG+"";let V1e=e=>[...q1e(e),e.message];function W1e(e){const t=V1e(e);return typeof t=="string"?[t]:Array.from(t)}let H1e=console.error;function G1e(e){e.level>K1e||H1e(...W1e(e))}let K1e=Yn.ALERT;function LO(e){return e!=null&&typeof e=="object"&&"create"in e&&typeof e.create=="function"}function Y1e(e,t){return Object.defineProperty(t,"prototype",{value:void 0}),Object.defineProperty(t,"name",{value:e}),t}function Z1e(e,t){if(typeof t!="object"||t===null)throw Ro(new Xe(vt.EINVAL,"Invalid options"));for(const[n,r]of Object.entries(e.options)){const s=t==null?void 0:t[n];if(s==null){if(!r.required){Nx("Using default for option: "+n);continue}throw Ro(new Xe(vt.EINVAL,"Missing required option: "+n))}const i=(c,u=s)=>{var d;return typeof c=="function"?Symbol.hasInstance in c&&c.prototype?s instanceof c:c(s):typeof s===c||((d=s==null?void 0:s.constructor)===null||d===void 0?void 0:d.name)===c};if(Array.isArray(r.type)?r.type.some(c=>i(c)):i(r.type))continue;const a=typeof s=="object"&&"constructor"in s?s.constructor.name:typeof s,o=c=>typeof c=="function"?c.name!="type"?c.name:c.toString():c,l=Array.isArray(r.type)?`one of ${r.type.map(o).join(", ")}`:o(r.type);throw Ro(new Xe(vt.EINVAL,`Incorrect type for "${n}": ${a} (expected ${l})`))}}function PK(e){return e!=null&&typeof e=="object"&&"backend"in e&&LO(e.backend)}const BO=0,Hi=4,ci=2,BC=1,$O=1,X1e=2,J1e=4,OK=0,Da=1,Bd=2,HE=64,GE=128,Q1e=256,KE=512,Mm=1024,e_e=65536,t_e=262144,n_e=131072,YE=1052672,r_e=4096,s_e=32768,i_e=16384,a_e=2048,ks=61440,Km=49152,sf=40960,Nc=32768,Ym=24576,Ni=16384,Zm=8192,Xm=4096,C1=2048,k1=1024,o_e=512,l_e=448,DK=256,FK=128,LK=64,c_e=56,BK=32,$K=16,zK=8,u_e=7,UK=4,qK=2,VK=1,d_e=0,ho=4294967295,WK=Object.freeze(Object.defineProperty({__proto__:null,COPYFILE_EXCL:$O,COPYFILE_FICLONE:X1e,COPYFILE_FICLONE_FORCE:J1e,F_OK:BO,O_APPEND:Mm,O_CREAT:HE,O_DIRECT:i_e,O_DIRECTORY:e_e,O_DSYNC:r_e,O_EXCL:GE,O_NOATIME:t_e,O_NOCTTY:Q1e,O_NOFOLLOW:n_e,O_NONBLOCK:a_e,O_RDONLY:OK,O_RDWR:Bd,O_SYMLINK:s_e,O_SYNC:YE,O_TRUNC:KE,O_WRONLY:Da,R_OK:Hi,S_IFBLK:Ym,S_IFCHR:Zm,S_IFDIR:Ni,S_IFIFO:Xm,S_IFLNK:sf,S_IFMT:ks,S_IFREG:Nc,S_IFSOCK:Km,S_IRGRP:BK,S_IROTH:UK,S_IRUSR:DK,S_IRWXG:c_e,S_IRWXO:u_e,S_IRWXU:l_e,S_ISGID:k1,S_ISUID:C1,S_ISVTX:o_e,S_IWGRP:$K,S_IWOTH:qK,S_IWUSR:FK,S_IXGRP:zK,S_IXOTH:VK,S_IXUSR:LK,UV_FS_O_FILEMAP:d_e,W_OK:ci,X_OK:BC,size_max:ho},Symbol.toStringTag,{value:"Module"})),BS=BigInt(1e3);class HK{_convert(t){return this._isBigint?BigInt(t):Number(t)}get blocks(){return this._convert(Math.ceil(Number(this.size)/512))}set blocks(t){}get atime(){return new Date(Number(this.atimeMs))}set atime(t){this.atimeMs=this._convert(t.getTime())}get mtime(){return new Date(Number(this.mtimeMs))}set mtime(t){this.mtimeMs=this._convert(t.getTime())}get ctime(){return new Date(Number(this.ctimeMs))}set ctime(t){this.ctimeMs=this._convert(t.getTime())}get birthtime(){return new Date(Number(this.birthtimeMs))}set birthtime(t){this.birthtimeMs=this._convert(t.getTime())}constructor({atimeMs:t,mtimeMs:n,ctimeMs:r,birthtimeMs:s,uid:i,gid:a,size:o,mode:l,ino:c,...u}={}){this.dev=this._convert(0),this.ino=this._convert(0),this.rdev=this._convert(0),this.nlink=this._convert(1),this.blksize=this._convert(4096),this.uid=this._convert(0),this.gid=this._convert(0);const d=Date.now();this.atimeMs=this._convert(t??d),this.mtimeMs=this._convert(n??d),this.ctimeMs=this._convert(r??d),this.birthtimeMs=this._convert(s??d),this.uid=this._convert(i??0),this.gid=this._convert(a??0),this.size=this._convert(o??0),this.ino=this._convert(c??0),this.mode=this._convert(l??420&Nc),(this.mode&ks)==0&&(this.mode=this.mode|this._convert(Nc)),Object.assign(this,u)}isFile(){return(this.mode&ks)===Nc}isDirectory(){return(this.mode&ks)===Ni}isSymbolicLink(){return(this.mode&ks)===sf}isSocket(){return(this.mode&ks)===Km}isBlockDevice(){return(this.mode&ks)===Ym}isCharacterDevice(){return(this.mode&ks)===Zm}isFIFO(){return(this.mode&ks)===Xm}toJSON(){return Hm(this,Mj)}hasAccess(t,n){return hs(n,this._isBigint?new af(this):this,t)}get atimeNs(){return BigInt(this.atimeMs)*BS}get mtimeNs(){return BigInt(this.mtimeMs)*BS}get ctimeNs(){return BigInt(this.ctimeMs)*BS}get birthtimeNs(){return BigInt(this.birthtimeMs)*BS}}function GK(e,t,n){let r=!0;return!isNaN(t)&&t>=0&&t<ho?e.uid=t:r=!1,!isNaN(n)&&n>=0&&n<ho?e.gid=n:r=!1,r}class af extends HK{constructor(){super(...arguments),this._isBigint=!1}}class Jm extends HK{constructor(){super(...arguments),this._isBigint=!0}}function f_e(e,t){return e.size==t.size&&+e.atime==+t.atime&&+e.mtime==+t.mtime&&+e.ctime==+t.ctime&&e.mode==t.mode}class h_e{constructor(){this.type=525687744115,this.bsize=4096,this.blocks=0,this.bfree=0,this.bavail=0,this.files=ho,this.ffree=ho}}class p_e{constructor(){this.type=BigInt("0x7a656e6673"),this.bsize=BigInt(4096),this.blocks=BigInt(0),this.bfree=BigInt(0),this.bavail=BigInt(0),this.files=BigInt(ho),this.ffree=BigInt(ho)}}var Ps=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},Kn=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},zO=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};const rl=0,m_e=1024;let J$=(()=>{var e,t;let n=[Gm()],r,s=[],i,a,o=[],l=[],c,u=[],d=[],h,m=[],y=[],b,v=[],x=[];return i=class{get key(){return this._key}set key(w){this._key=w,this.keySize=w.length}get value(){return this._value.subarray(0,this.valueSize)}set value(w){this._value=w,this.valueSize=w.length}constructor(w,S){this.keySize=Kn(this,o,0),this.valueSize=(Kn(this,l),Kn(this,u,0)),this._key=(Kn(this,d),Kn(this,m,"")),this._value=(Kn(this,y),Kn(this,v,new Uint8Array(m_e))),Kn(this,x),w&&(this.key=w),S&&(this.value=S)}},zO(i,"Attribute"),(()=>{const w=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;a=[(e=tr).uint32.bind(e)],c=[(t=tr).uint32.bind(t)],h=[tr.char("keySize")],b=[tr.uint8("valueSize")],Ps(null,null,a,{kind:"field",name:"keySize",static:!1,private:!1,access:{has:S=>"keySize"in S,get:S=>S.keySize,set:(S,k)=>{S.keySize=k}},metadata:w},o,l),Ps(null,null,c,{kind:"field",name:"valueSize",static:!1,private:!1,access:{has:S=>"valueSize"in S,get:S=>S.valueSize,set:(S,k)=>{S.valueSize=k}},metadata:w},u,d),Ps(null,null,h,{kind:"field",name:"_key",static:!1,private:!1,access:{has:S=>"_key"in S,get:S=>S._key,set:(S,k)=>{S._key=k}},metadata:w},m,y),Ps(null,null,b,{kind:"field",name:"_value",static:!1,private:!1,access:{has:S=>"_value"in S,get:S=>S._value,set:(S,k)=>{S._value=k}},metadata:w},v,x),Ps(null,r={value:i},n,{kind:"class",name:i.name,metadata:w},null,s),i=r.value,w&&Object.defineProperty(i,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:w}),Kn(i,s)})(),i})(),Dh=(()=>{var e;let t=[Gm()],n,r=[],s,i,a=[],o=[],l,c=[],u=[];return s=class{has(d){return this.data.some(h=>h.key==d)}get(d){return this.data.find(h=>h.key==d)}set(d,h){const m=this.get(d);if(m){m.value=h;return}this.data.push(new J$(d,h)),this.size++}remove(d){const h=this.data.findIndex(m=>m.key==d);return h===-1?!1:(this.data.splice(h,1),this.size--,!0)}keys(){return this.data.map(d=>d.key)}values(){return this.data.map(d=>d.value)}entries(){return this.data.map(d=>[d.key,d.value])}constructor(){this.size=Kn(this,a,0),this.data=(Kn(this,o),Kn(this,c,[])),Kn(this,u)}},zO(s,"Attributes"),(()=>{const d=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;i=[(e=tr).uint32.bind(e)],l=[dw(J$,"size")],Ps(null,null,i,{kind:"field",name:"size",static:!1,private:!1,access:{has:h=>"size"in h,get:h=>h.size,set:(h,m)=>{h.size=m}},metadata:d},a,o),Ps(null,null,l,{kind:"field",name:"data",static:!1,private:!1,access:{has:h=>"data"in h,get:h=>h.data,set:(h,m)=>{h.data=m}},metadata:d},c,u),Ps(null,n={value:s},t,{kind:"class",name:s.name,metadata:d},null,r),s=n.value,d&&Object.defineProperty(s,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:d}),Kn(s,r)})(),s})();const Mj=["ino","data","size","mode","flags","nlink","uid","gid","atimeMs","birthtimeMs","mtimeMs","ctimeMs","version"],g_e=4;var No;(function(e){e[e.SecureRm=1]="SecureRm",e[e.Undelete=2]="Undelete",e[e.Compress=4]="Compress",e[e.Sync=8]="Sync",e[e.Immutable=16]="Immutable",e[e.Append=32]="Append",e[e.NoDump=64]="NoDump",e[e.NoAtime=128]="NoAtime",e[e.Dirty=256]="Dirty",e[e.CompressBlk=512]="CompressBlk",e[e.NoCompress=1024]="NoCompress",e[e.Encrypt=2048]="Encrypt",e[e.Btree=4096]="Btree",e[e.Index=4096]="Index",e[e.IMagic=8192]="IMagic",e[e.JournalData=16384]="JournalData",e[e.NoTail=32768]="NoTail",e[e.DirSync=65536]="DirSync",e[e.TopDir=131072]="TopDir",e[e.HugeFile=262144]="HugeFile",e[e.Extent=524288]="Extent",e[e.Verity=1048576]="Verity",e[e.EaInode=2097152]="EaInode",e[e.EofBlocks=4194304]="EofBlocks",e[e.NoCow=8388608]="NoCow",e[e.Dax=33554432]="Dax",e[e.InlineData=268435456]="InlineData",e[e.ProjInherit=536870912]="ProjInherit",e[e.CaseFold=1073741824]="CaseFold",e[e.Reserved=2147483648]="Reserved"})(No||(No={}));let Ti=(()=>{var e,t,n,r,s,i,a,o,l,c,u,d,h,m,y,b;let v=[Gm()],x,w=[],S,k,C=[],T=[],A,N=[],I=[],O,B=[],D=[],H,P=[],K=[],U,V=[],L=[],te,W=[],Q=[],ee,re=[],pe=[],de,Oe=[],Fe=[],Se,Ce=[],qe=[],Qe,We=[],je=[],Y,ye=[],Ie=[],ce,oe=[],se=[],Me,Be=[],Ae=[],lt,Tt=[],dt=[],Pt,qt=[],Ft=[],Ht,we=[],F=[],X,be=[],ke=[],ge,Ee=[],le=[];var ft=S=class{constructor(et){if(this.data=Kn(this,C,Rj(0,ho)),this.__data_old=(Kn(this,T),Kn(this,N,0)),this.size=(Kn(this,I),Kn(this,B,0)),this.mode=(Kn(this,D),Kn(this,P,0)),this.nlink=(Kn(this,K),Kn(this,V,1)),this.uid=(Kn(this,L),Kn(this,W,0)),this.gid=(Kn(this,Q),Kn(this,re,0)),this.atimeMs=(Kn(this,pe),Kn(this,Oe,Date.now())),this.birthtimeMs=(Kn(this,Fe),Kn(this,Ce,Date.now())),this.mtimeMs=(Kn(this,qe),Kn(this,We,Date.now())),this.ctimeMs=(Kn(this,je),Kn(this,ye,Date.now())),this.ino=(Kn(this,Ie),Kn(this,oe,Rj(0,ho))),this.__ino_old=(Kn(this,se),Kn(this,Be,0)),this.flags=(Kn(this,Ae),Kn(this,Tt,0)),this.__after_flags=(Kn(this,dt),Kn(this,qt,0)),this.version=(Kn(this,Ft),Kn(this,we,0)),this.__padding=(Kn(this,F),Kn(this,be,[])),this.attributes=(Kn(this,ke),Kn(this,Ee,new Dh)),Kn(this,le),!!et){if(!("byteLength"in et)){Object.assign(this,et);return}if(et.byteLength<qs(ft))throw WE(new Xe(vt.EIO,"Buffer is too small to create an inode"));VE(this,et)}}toString(){return`<Inode ${this.ino}>`}toJSON(){return{...Hm(this,Mj),attributes:this.attributes}}toStats(){return new af(this)}update(et){if(!et)return!1;let $=!1;for(const Ue of Mj)et[Ue]!==void 0&&(Ue=="ino"||Ue=="data"||this[Ue]!==et[Ue]&&(Ue=="atimeMs"&&this.flags&No.NoAtime||(this[Ue]=et[Ue],$=!0)));return et.attributes&&(this.attributes=et.attributes,$=!0),$&&(this.ctimeMs=Date.now()),$}};return zO(S,"Inode"),(()=>{const et=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;k=[(e=tr).uint32.bind(e)],A=[(t=tr).uint32.bind(t)],O=[(n=tr).uint32.bind(n)],H=[(r=tr).uint16.bind(r)],U=[(s=tr).uint32.bind(s)],te=[(i=tr).uint32.bind(i)],ee=[(a=tr).uint32.bind(a)],de=[(o=tr).float64.bind(o)],Se=[(l=tr).float64.bind(l)],Qe=[(c=tr).float64.bind(c)],Y=[(u=tr).float64.bind(u)],ce=[(d=tr).uint32.bind(d)],Me=[(h=tr).uint32.bind(h)],lt=[(m=tr).uint32.bind(m)],Pt=[(y=tr).uint16.bind(y)],Ht=[(b=tr).uint32.bind(b)],X=[tr.uint8(48)],ge=[dw(Dh)],Ps(null,null,k,{kind:"field",name:"data",static:!1,private:!1,access:{has:$=>"data"in $,get:$=>$.data,set:($,Ue)=>{$.data=Ue}},metadata:et},C,T),Ps(null,null,A,{kind:"field",name:"__data_old",static:!1,private:!1,access:{has:$=>"__data_old"in $,get:$=>$.__data_old,set:($,Ue)=>{$.__data_old=Ue}},metadata:et},N,I),Ps(null,null,O,{kind:"field",name:"size",static:!1,private:!1,access:{has:$=>"size"in $,get:$=>$.size,set:($,Ue)=>{$.size=Ue}},metadata:et},B,D),Ps(null,null,H,{kind:"field",name:"mode",static:!1,private:!1,access:{has:$=>"mode"in $,get:$=>$.mode,set:($,Ue)=>{$.mode=Ue}},metadata:et},P,K),Ps(null,null,U,{kind:"field",name:"nlink",static:!1,private:!1,access:{has:$=>"nlink"in $,get:$=>$.nlink,set:($,Ue)=>{$.nlink=Ue}},metadata:et},V,L),Ps(null,null,te,{kind:"field",name:"uid",static:!1,private:!1,access:{has:$=>"uid"in $,get:$=>$.uid,set:($,Ue)=>{$.uid=Ue}},metadata:et},W,Q),Ps(null,null,ee,{kind:"field",name:"gid",static:!1,private:!1,access:{has:$=>"gid"in $,get:$=>$.gid,set:($,Ue)=>{$.gid=Ue}},metadata:et},re,pe),Ps(null,null,de,{kind:"field",name:"atimeMs",static:!1,private:!1,access:{has:$=>"atimeMs"in $,get:$=>$.atimeMs,set:($,Ue)=>{$.atimeMs=Ue}},metadata:et},Oe,Fe),Ps(null,null,Se,{kind:"field",name:"birthtimeMs",static:!1,private:!1,access:{has:$=>"birthtimeMs"in $,get:$=>$.birthtimeMs,set:($,Ue)=>{$.birthtimeMs=Ue}},metadata:et},Ce,qe),Ps(null,null,Qe,{kind:"field",name:"mtimeMs",static:!1,private:!1,access:{has:$=>"mtimeMs"in $,get:$=>$.mtimeMs,set:($,Ue)=>{$.mtimeMs=Ue}},metadata:et},We,je),Ps(null,null,Y,{kind:"field",name:"ctimeMs",static:!1,private:!1,access:{has:$=>"ctimeMs"in $,get:$=>$.ctimeMs,set:($,Ue)=>{$.ctimeMs=Ue}},metadata:et},ye,Ie),Ps(null,null,ce,{kind:"field",name:"ino",static:!1,private:!1,access:{has:$=>"ino"in $,get:$=>$.ino,set:($,Ue)=>{$.ino=Ue}},metadata:et},oe,se),Ps(null,null,Me,{kind:"field",name:"__ino_old",static:!1,private:!1,access:{has:$=>"__ino_old"in $,get:$=>$.__ino_old,set:($,Ue)=>{$.__ino_old=Ue}},metadata:et},Be,Ae),Ps(null,null,lt,{kind:"field",name:"flags",static:!1,private:!1,access:{has:$=>"flags"in $,get:$=>$.flags,set:($,Ue)=>{$.flags=Ue}},metadata:et},Tt,dt),Ps(null,null,Pt,{kind:"field",name:"__after_flags",static:!1,private:!1,access:{has:$=>"__after_flags"in $,get:$=>$.__after_flags,set:($,Ue)=>{$.__after_flags=Ue}},metadata:et},qt,Ft),Ps(null,null,Ht,{kind:"field",name:"version",static:!1,private:!1,access:{has:$=>"version"in $,get:$=>$.version,set:($,Ue)=>{$.version=Ue}},metadata:et},we,F),Ps(null,null,X,{kind:"field",name:"__padding",static:!1,private:!1,access:{has:$=>"__padding"in $,get:$=>$.__padding,set:($,Ue)=>{$.__padding=Ue}},metadata:et},be,ke),Ps(null,null,ge,{kind:"field",name:"attributes",static:!1,private:!1,access:{has:$=>"attributes"in $,get:$=>$.attributes,set:($,Ue)=>{$.attributes=Ue}},metadata:et},Ee,le),Ps(null,x={value:S},v,{kind:"class",name:S.name,metadata:et},null,w),ft=S=x.value,et&&Object.defineProperty(S,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:et}),Kn(S,w)})(),ft=S})();function y_e(e){return(e.mode&ks)===Nc}function Bc(e){return(e.mode&ks)===Ni}function hy(e){return(e.mode&ks)===sf}function b_e(e){return(e.mode&ks)===Km}function fw(e){return(e.mode&ks)===Ym}function hw(e){return(e.mode&ks)===Zm}function v_e(e){return(e.mode&ks)===Xm}function hs(e,t,n){const r=(e==null?void 0:e.credentials)||qc.credentials;if(hy(t)||r.euid===0||r.egid===0)return!0;let s=0;return r.uid===t.uid&&(t.mode&DK&&(s|=Hi),t.mode&FK&&(s|=ci),t.mode&LK&&(s|=BC)),(r.gid===t.gid||r.groups.includes(Number(t.gid)))&&(t.mode&BK&&(s|=Hi),t.mode&$K&&(s|=ci),t.mode&zK&&(s|=BC)),t.mode&UK&&(s|=Hi),t.mode&qK&&(s|=ci),t.mode&VK&&(s|=BC),(s&n)===n}const Q$=1;class G2 extends Map{constructor(){super(...arguments),this.maxSize=ho}toJSON(){return{version:Q$,maxSize:this.maxSize,entries:Object.fromEntries([...this].map(([t,n])=>[t,n.toJSON()]))}}toString(){return JSON.stringify(this.toJSON())}get byteSize(){let t=this.size*qs(Ti);for(const n of this.values())t+=n.size;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.byteSize}}pathOf(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return n}getByID(t){var n;return(n=this.entryByID(t))===null||n===void 0?void 0:n.inode}entryByID(t){for(const[n,r]of this)if(r.ino==t||r.data==t)return{path:n,inode:r}}directoryEntries(t){const n=this.get(t);if(!n)throw Xe.With("ENOENT",t);if((n.mode&ks)!=Ni)throw Xe.With("ENOTDIR",t);const r={};for(const s of this.keys())Xr(s)==t&&s!=t&&(r[fy(s)]=this.get(s).ino);return r}_alloc(){return Math.max(...[...this.values()].flatMap(t=>[t.ino,t.data]))+1}directories(){const t=new Map;for(const[n,r]of this){if((r.mode&ks)!=Ni)continue;const s={};for(const i of this.keys())Xr(i)==n&&i!=n&&(s[fy(i)]=this.get(i).ino);t.set(n,s)}return t}fromJSON(t){var n;if(t.version!=Q$)throw new Xe(vt.EINVAL,"Index version mismatch");this.clear();for(const[r,s]of Object.entries(t.entries))(n=s.data)!==null&&n!==void 0||(s.data=Rj(1,ho)),r=="/"&&(s.ino=0),this.set(r,new Ti(s));return this}static parse(t){if(!k1e(t))throw new Xe(vt.EINVAL,"Invalid JSON");const n=JSON.parse(t),r=new G2;return r.fromJSON(n),r}}const aM=4096;let UO=class Ij{get uuid(){return this._uuid}constructor(t,n){this.type=t,this.name=n,this._uuid=crypto.randomUUID(),this.attributes=new Map,this.streamRead===Ij.prototype.streamRead&&this.attributes.set("default_stream_read"),this.streamWrite===Ij.prototype.streamWrite&&this.attributes.set("default_stream_write")}toString(){var t;return`${this.name} ${(t=this.label)!==null&&t!==void 0?t:""} (${this._mountPoint?"mounted on "+this._mountPoint:"unmounted"})`}usage(){return{totalSpace:0,freeSpace:0}}async ready(){}async exists(t){try{return await this.stat(t),!0}catch(n){return n.code!="ENOENT"}}existsSync(t){try{return this.statSync(t),!0}catch(n){return n.code!="ENOENT"}}streamRead(t,n){return new ReadableStream({start:async r=>{const{size:s}=await this.stat(t),{start:i=0,end:a=s}=n;for(let o=i;o<a;o+=aM){const l=o+aM>a?a-o:aM,c=new Uint8Array(l);await this.read(t,c,o,o+l).catch(r.error.bind(r)),r.enqueue(c)}r.close()},type:"bytes"})}streamWrite(t,n){var r;let s=(r=n.start)!==null&&r!==void 0?r:0;return new WritableStream({write:async(i,a)=>{let o=!1;const l=u=>{o=!0,a.error(u)},{size:c}=await this.stat(t);await this.write(t,i,s).catch(l),!o&&(s+=i.byteLength,await this.touch(t,{mtimeMs:Date.now(),size:Math.max(c,s)}).catch(l))}})}};function Ja(e){return JSON.parse(IO(e),(t,n)=>t==""?n:typeof n=="string"?BigInt(n).toString(16).slice(0,Math.min(n.length,8)):n)}function Ml(e){return nm(JSON.stringify(e))}function tp(e,t){if(typeof e=="number")return e;if(typeof e=="string"){const n=parseInt(e,8);if(!isNaN(n))return n}if(typeof t=="number")return t;throw new Xe(vt.EINVAL,"Invalid mode: "+(e==null?void 0:e.toString()))}function K2(e){if(e instanceof Date)return e.getTime();try{return Number(e)}catch{throw new Xe(vt.EINVAL,"Invalid time.")}}function Bn(e,t=!1){if(e instanceof URL){if(e.protocol!="file:")throw new Xe(vt.EINVAL,"URLs must use the file: protocol");e=e.pathname}if(e=e.toString(),e.startsWith("file://")&&(e=e.slice(7)),e.includes("\0"))throw new Xe(vt.EINVAL,"Path can not contain null character");if(e.length==0)throw new Xe(vt.EINVAL,"Path can not be empty");return e=e.replaceAll(/[/\\]+/g,"/"),t?e:Zd(e)}function $d(e,t="utf8",n,r=0){return typeof e!="object"||e===null?{encoding:typeof e=="string"?e:t??null,flag:n,mode:r}:{encoding:typeof(e==null?void 0:e.encoding)=="string"?e.encoding:t??null,flag:typeof(e==null?void 0:e.flag)=="string"?e.flag:n,mode:tp("mode"in e?e==null?void 0:e.mode:null,r)}}class x_e{constructor(t,n,r,s){ue(this,"id");ue(this,"_size");ue(this,"options");ue(this,"regions",[]);this.id=t,this._size=n,this.options=r,r.sparse??(r.sparse=!0),r.sparse||this.regions.push({offset:0,data:new Uint8Array(n),ranges:[]}),s==null||s.set(t,this)}get size(){return this._size}set size(t){if(t>=this._size){this._size=t;return}this._size=t;for(let n=this.regions.length-1;n>=0;n--){const r=this.regions[n];if(r.offset>=t){this.regions.splice(n,1);continue}const s=t-r.offset;r.data.byteLength>s&&(r.data=r.data.subarray(0,s)),r.ranges=r.ranges.filter(i=>i.start<t).map(i=>i.end>t?{start:i.start,end:t}:i)}}collect(){if(!this.options.sparse)return;const{regionGapThreshold:t=4095}=this.options;for(let n=0;n<this.regions.length-1;){const r=this.regions[n],s=this.regions[n+1];if(s.offset-(r.offset+r.data.byteLength)>t){n++;continue}r.ranges.push(...s.ranges),r.ranges.sort((i,a)=>i.start-a.start),r.ranges=r.ranges.reduce((i,a)=>(!i.length||i.at(-1).end<a.start?i.push(a):i.at(-1).end=Math.max(i.at(-1).end,a.end),i),[]),r.data=cw(r.data,s.offset+s.data.byteLength),r.data.set(s.data,s.offset-r.offset),this.regions.splice(n+1,1)}}missing(t,n){const r=[];for(const s of this.regions){if(s.offset>=n)break;for(const i of s.ranges)if(!(i.end<=t)&&(i.start>=n||(i.start>t&&r.push({start:t,end:Math.min(i.start,n)}),i.end>t&&(t=Math.max(t,i.end)),t>=n)))break;if(t>=n)break}return t<n&&r.push({start:t,end:n}),r}cached(t,n){const r=[];for(const i of this.regions){if(i.offset>=n)break;for(const a of i.ranges)if(!(a.end<=t)){if(a.start>=n)break;r.push({start:Math.max(t,a.start),end:Math.min(n,a.end)})}}r.sort((i,a)=>i.start-a.start);const s=[];for(const i of r){const a=s.at(-1);a&&i.start<=a.end?a.end=Math.max(a.end,i.end):s.push(i)}return s}regionAt(t){if(this.regions.length)for(const n of this.regions){if(n.offset>t)break;if(t>=n.offset&&t<n.offset+n.data.byteLength)return n}}add(t,n){const r=n+t.byteLength,s=this.regionAt(n);if(s)return s.data=cw(s.data,r),s.data.set(t,n),s.ranges.push({start:n,end:r}),s.ranges.sort((o,l)=>o.start-l.start),this.collect(),this;const i={data:t,offset:n,ranges:[{start:n,end:r}]},a=this.regions.findIndex(o=>o.offset>n);return a==-1?this.regions.push(i):this.regions.splice(a,0,i),this.collect(),this}}var oM,lM,cM;(oM=Promise.withResolvers)!==null&&oM!==void 0||(Promise.withResolvers=(Fa("Using a polyfill of Promise.withResolvers"),function(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}));(lM=Symbol.dispose)!==null&&lM!==void 0||(Symbol.dispose=(Fa("Using a polyfill of Symbol.dispose"),Symbol("Symbol.dispose")));(cM=Symbol.asyncDispose)!==null&&cM!==void 0||(Symbol.asyncDispose=(Fa("Using a polyfill of Symbol.asyncDispose"),Symbol("Symbol.asyncDispose")));class KK{constructor(t){this.store=t}}class w_e extends KK{async get(t,n,r){return this.getSync(t,n,r)}async set(t,n,r){return this.setSync(t,n,r)}async remove(t){return this.removeSync(t)}}class jj extends KK{constructor(){super(...arguments),this.asyncDone=Promise.resolve()}async(t){this.asyncDone=this.asyncDone.then(()=>t)}_cached(t,n){var r,s;(r=(s=this.store).cache)!==null&&r!==void 0||(s.cache=new Map);const i=this.store.cache.get(t);return i?(n&&(i.size=n.size),i):n?new x_e(t,n.size,{},this.store.cache):void 0}getSync(t,n,r){var s;const i=this._cached(t);if(!i)return;r??(r=i.size);const a=i.missing(n,r);for(const{start:l,end:c}of a)this.async(this.get(t,l,c));if(a.length)throw Ro(Xe.With("EAGAIN",(s=this.store._fs)===null||s===void 0?void 0:s._path(t)));const o=i.regionAt(n);if(!o){Fa("Missing cache region for "+t);return}return o.data.subarray(n-o.offset,r-o.offset)}setSync(t,n,r){this.async(this.set(t,n,r))}removeSync(t){var n;this.async(this.remove(t)),(n=this.store.cache)===null||n===void 0||n.delete(t)}}class __e{flag(t){var n,r;return(r=(n=this.raw.store.flags)===null||n===void 0?void 0:n.includes(t))!==null&&r!==void 0?r:!1}constructor(t,n){this.raw=t,this.fs=n,this.done=!1,this.originalData=new Map,this.modifiedKeys=new Set}keys(){return this.raw.keys()}async get(t,n=0,r){const s=await this.raw.get(t,n,r);return this.stash(t),s}getSync(t,n=0,r){const s=this.raw.getSync(t,n,r);return this.stash(t),s}async set(t,n,r=0){await this.markModified(t,r,n.byteLength),await this.raw.set(t,n,r)}setSync(t,n,r=0){this.markModifiedSync(t,r,n.byteLength),this.raw.setSync(t,n,r)}async remove(t){await this.markModified(t,0,void 0),await this.raw.remove(t)}removeSync(t){this.markModifiedSync(t,0,void 0),this.raw.removeSync(t)}commit(){return this.done=!0,Promise.resolve()}commitSync(){this.done=!0}async abort(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){await this.raw.remove(t),this.fs._remove(t);continue}for(const r of n.reverse())await this.raw.set(t,r.data,r.offset)}this.done=!0}}abortSync(){if(!this.done){for(const[t,n]of this.originalData)if(this.modifiedKeys.has(t)){if(n.some(r=>!r.data)){this.raw.removeSync(t),this.fs._remove(t);continue}for(const r of n.reverse())this.raw.setSync(t,r.data,r.offset)}this.done=!0}}async[Symbol.asyncDispose](){this.done||await this.abort()}[Symbol.dispose](){this.done||this.abortSync()}stash(t,n,r=0){this.originalData.has(t)||this.originalData.set(t,[]),this.originalData.get(t).push({data:n,offset:r})}async markModified(t,n,r){this.modifiedKeys.add(t);const s=r?n+r:void 0;try{this.stash(t,await this.raw.get(t,n,s),n)}catch(i){if(!(this.raw instanceof jj))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,s??n))this.stash(t,await this.raw.get(t,l.start,l.end),l.start)}}markModifiedSync(t,n,r){this.modifiedKeys.add(t);const s=r?n+r:void 0;try{this.stash(t,this.raw.getSync(t,n,s),n)}catch(i){if(!(this.raw instanceof jj))throw i;const o=this.raw._cached(t);if(!o)throw i;for(const l of o.cached(n,s??n))this.stash(t,this.raw.getSync(t,l.start,l.end),l.start)}}}var Is=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},js=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class YK extends UO{_path(t){var n;const[r]=(n=this._paths.get(t))!==null&&n!==void 0?n:[];return r}_add(t,n){this._paths.has(t)||this._paths.set(t,new Set),this._paths.get(t).add(n),this._ids.set(n,t)}_remove(t){var n;for(const r of(n=this._paths.get(t))!==null&&n!==void 0?n:[])this._ids.delete(r);this._paths.delete(t)}_move(t,n){const r=[];for(const[s,i]of this._ids){const a=IK(t,s);if(a.startsWith(".."))continue;let o=os(n,a);o.endsWith("/")&&(o=o.slice(0,-1)),r.push({oldKey:s,newKey:o,ino:i})}for(const{oldKey:s,newKey:i,ino:a}of r){this._ids.delete(s),this._ids.set(i,a);const o=this._paths.get(a);if(!o){Fa("Missing paths in table for ino "+a);continue}o.delete(s),o.add(i)}}async ready(){this._initialized||(this.checkRootSync(),await this.checkRoot(),await this._populate(),this._initialized=!0)}constructor(t){var n,r,s;super((n=t.type)!==null&&n!==void 0?n:1802921587,t.name),this.store=t,this._ids=new Map([["/",0]]),this._paths=new Map([[0,new Set("/")]]),this._initialized=!1,t._fs=this,this._uuid=(r=t.uuid)!==null&&r!==void 0?r:this.uuid,Nx(this.name+": supports features: "+((s=this.store.flags)===null||s===void 0?void 0:s.join(", ")))}usage(){var t,n;return((n=(t=this.store).usage)===null||n===void 0?void 0:n.call(t))||{totalSpace:0,freeSpace:0}}async loadIndex(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Is(n,this.transaction(),!0),s=t.directories();for(const[i,a]of t)this._add(a.ino,i),await r.set(a.ino,xa(a)),s.has(i)&&await r.set(a.data,Ml(s.get(i)));await r.commit()}catch(r){n.error=r,n.hasError=!0}finally{const r=js(n);r&&await r}}loadIndexSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Is(n,this.transaction(),!1),s=t.directories();for(const[i,a]of t)this._add(a.ino,i),r.setSync(a.ino,xa(a)),s.has(i)&&r.setSync(a.data,Ml(s.get(i)));r.commitSync()}catch(r){n.error=r,n.hasError=!0}finally{js(n)}}async createIndex(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new G2,s=Is(n,this.transaction(),!0),i=[["/",0]],a=G$(Xe.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),c=new Ti(await s.get(l));if(r.set(o,c),c.mode&Ni){const u=Ja((t=await s.get(c.data))!==null&&t!==void 0?t:vs(Xe.With("ENODATA",o)));for(const[d,h]of Object.entries(u))i.push([os(o,d),h])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{const r=js(n);r&&await r}}createIndexSync(){var t;const n={stack:[],error:void 0,hasError:!1};try{const r=new G2,s=Is(n,this.transaction(),!1),i=[["/",0]],a=G$(Xe.With("EDEADLK"));for(;i.length;){const[o,l]=i.shift(),c=new Ti(s.getSync(l));if(r.set(o,c),c.mode&Ni){const u=Ja((t=s.getSync(c.data))!==null&&t!==void 0?t:vs(Xe.With("ENODATA",o)));for(const[d,h]of Object.entries(u))i.push([os(o,d),h])}}return a(),r}catch(r){n.error=r,n.hasError=!0}finally{js(n)}}async rename(t,n){var r,s,i;const a={stack:[],error:void 0,hasError:!1};try{const o=Is(a,this.transaction(),!0),l=du(t),c=du(n),u=await this.findInode(o,l.dir,"rename"),d=Ja((r=await o.get(u.data))!==null&&r!==void 0?r:vs(Xe.With("ENODATA",l.dir,"rename")));if(!d[l.base])throw Xe.With("ENOENT",t,"rename");const h=d[l.base];if(h!=this._ids.get(t)&&Ro(`Ino mismatch while renaming ${t} to ${n}`),delete d[l.base],(c.dir+"/").startsWith(t+"/"))throw new Xe(vt.EBUSY,l.dir);const m=c.dir==l.dir,y=m?u:await this.findInode(o,c.dir,"rename"),b=m?d:Ja((s=await o.get(y.data))!==null&&s!==void 0?s:vs(Xe.With("ENODATA",c.dir,"rename")));if(b[c.base]){const v=new Ti((i=await o.get(b[c.base]))!==null&&i!==void 0?i:vs(Xe.With("ENOENT",n,"rename")));if(!v.toStats().isFile())throw Xe.With("EPERM",n,"rename");await o.remove(v.data),await o.remove(b[c.base])}b[c.base]=h,await o.set(u.data,Ml(d)),await o.set(y.data,Ml(b)),await o.commit(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{const o=js(a);o&&await o}}renameSync(t,n){var r,s,i;const a={stack:[],error:void 0,hasError:!1};try{const o=Is(a,this.transaction(),!1),l=du(t),c=du(n),u=this.findInodeSync(o,l.dir,"rename"),d=Ja((r=o.getSync(u.data))!==null&&r!==void 0?r:vs(Xe.With("ENODATA",l.dir,"rename")));if(!d[l.base])throw Xe.With("ENOENT",t,"rename");const h=d[l.base];if(h!=this._ids.get(t)&&Ro(`Ino mismatch while renaming ${t} to ${n}`),delete d[l.base],(c.dir+"/").startsWith(t+"/"))throw new Xe(vt.EBUSY,l.dir);const m=c.dir===l.dir,y=m?u:this.findInodeSync(o,c.dir,"rename"),b=m?d:Ja((s=o.getSync(y.data))!==null&&s!==void 0?s:vs(Xe.With("ENODATA",c.dir,"rename")));if(b[c.base]){const v=new Ti((i=o.getSync(b[c.base]))!==null&&i!==void 0?i:vs(Xe.With("ENOENT",n,"rename")));if(!v.toStats().isFile())throw Xe.With("EPERM",n,"rename");o.removeSync(v.data),o.removeSync(b[c.base])}b[c.base]=h,o.setSync(u.data,Ml(d)),o.setSync(y.data,Ml(b)),o.commitSync(),this._move(t,n)}catch(o){a.error=o,a.hasError=!0}finally{js(a)}}async stat(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Is(n,this.transaction(),!0);return await this.findInode(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{const r=js(n);r&&await r}}statSync(t){const n={stack:[],error:void 0,hasError:!1};try{const r=Is(n,this.transaction(),!1);return this.findInodeSync(r,t,"stat")}catch(r){n.error=r,n.hasError=!0}finally{js(n)}}async touch(t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Is(r,this.transaction(),!0),i=await this.findInode(s,t,"touch");i.update(n)&&(this._add(i.ino,t),s.setSync(i.ino,xa(i))),await s.commit()}catch(s){r.error=s,r.hasError=!0}finally{const s=js(r);s&&await s}}touchSync(t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=Is(r,this.transaction(),!1),i=this.findInodeSync(s,t,"touch");i.update(n)&&(this._add(i.ino,t),s.setSync(i.ino,xa(i))),s.commitSync()}catch(s){r.error=s,r.hasError=!0}finally{js(r)}}async createFile(t,n){return n.mode|=Nc,await this.commitNew(t,n,new Uint8Array,"createFile")}createFileSync(t,n){return n.mode|=Nc,this.commitNewSync(t,n,new Uint8Array,"createFile")}async unlink(t){return this.remove(t,!1)}unlinkSync(t){this.removeSync(t,!1)}async rmdir(t){if((await this.readdir(t)).length)throw Xe.With("ENOTEMPTY",t,"rmdir");await this.remove(t,!0)}rmdirSync(t){if(this.readdirSync(t).length)throw Xe.With("ENOTEMPTY",t,"rmdir");this.removeSync(t,!0)}async mkdir(t,n){return n.mode|=Ni,await this.commitNew(t,n,nm("{}"),"mkdir")}mkdirSync(t,n){return n.mode|=Ni,this.commitNewSync(t,n,nm("{}"),"mkdir")}async readdir(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const s=Is(r,this.transaction(),!0),i=await this.findInode(s,t,"readdir");return Object.keys(Ja((n=await s.get(i.data))!==null&&n!==void 0?n:vs(Xe.With("ENOENT",t,"readdir"))))}catch(s){r.error=s,r.hasError=!0}finally{const s=js(r);s&&await s}}readdirSync(t){var n;const r={stack:[],error:void 0,hasError:!1};try{const s=Is(r,this.transaction(),!1),i=this.findInodeSync(s,t,"readdir");return Object.keys(Ja((n=s.getSync(i.data))!==null&&n!==void 0?n:vs(Xe.With("ENOENT",t,"readdir"))))}catch(s){r.error=s,r.hasError=!0}finally{js(r)}}async sync(t,n,r){const s={stack:[],error:void 0,hasError:!1};try{const i=Is(s,this.transaction(),!0),a=await this.findInode(i,t,"sync");n&&await i.set(a.data,n),a.update(r)&&(this._add(a.ino,t),await i.set(a.ino,xa(a))),await i.commit()}catch(i){s.error=i,s.hasError=!0}finally{const i=js(s);i&&await i}}syncSync(t,n,r){const s={stack:[],error:void 0,hasError:!1};try{const i=Is(s,this.transaction(),!1),a=this.findInodeSync(i,t,"sync");n&&i.setSync(a.data,n),a.update(r)&&(this._add(a.ino,t),i.setSync(a.ino,xa(a))),i.commitSync()}catch(i){s.error=i,s.hasError=!0}finally{js(s)}}async link(t,n){var r;const s={stack:[],error:void 0,hasError:!1};try{const i=Is(s,this.transaction(),!0),a=Xr(n),o=await this.findInode(i,a,"link"),l=Ja((r=await i.get(o.data))!==null&&r!==void 0?r:vs(Xe.With("ENOENT",a,"link"))),c=await this.findInode(i,t,"link");c.nlink++,l[fy(n)]=c.ino,this._add(c.ino,n),await i.set(c.ino,xa(c)),await i.set(o.data,Ml(l)),await i.commit()}catch(i){s.error=i,s.hasError=!0}finally{const i=js(s);i&&await i}}linkSync(t,n){var r;const s={stack:[],error:void 0,hasError:!1};try{const i=Is(s,this.transaction(),!1),a=Xr(n),o=this.findInodeSync(i,a,"link"),l=Ja((r=i.getSync(o.data))!==null&&r!==void 0?r:vs(Xe.With("ENOENT",a,"link"))),c=this.findInodeSync(i,t,"link");c.nlink++,l[fy(n)]=c.ino,this._add(c.ino,n),i.setSync(c.ino,xa(c)),i.setSync(o.data,Ml(l)),i.commitSync()}catch(i){s.error=i,s.hasError=!0}finally{js(s)}}async read(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{const o=Is(a,this.transaction(),!0),l=await this.findInode(o,t,"read");if(l.size==0)return;const c=(i=await o.get(l.data,r,s))!==null&&i!==void 0?i:vs(Xe.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,s);u.byteLength>n.byteLength&&Ro(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{const o=js(a);o&&await o}}readSync(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{const o=Is(a,this.transaction(),!1),l=this.findInodeSync(o,t,"read");if(l.size==0)return;const c=(i=o.getSync(l.data,r,s))!==null&&i!==void 0?i:vs(Xe.With("ENODATA",t,"read")),u=o.flag("partial")?c:c.subarray(r,s);u.byteLength>n.byteLength&&Ro(`Trying to place ${u.byteLength} bytes into a ${n.byteLength} byte buffer on read`),n.set(u)}catch(o){a.error=o,a.hasError=!0}finally{js(a)}}async write(t,n,r){var s;const i={stack:[],error:void 0,hasError:!1};try{const a=Is(i,this.transaction(),!0),o=await this.findInode(a,t,"write");let l=n;a.flag("partial")||(l=cw((s=await a.get(o.data))!==null&&s!==void 0?s:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),await a.set(o.data,l,r),this._add(o.ino,t),await a.commit()}catch(a){i.error=a,i.hasError=!0}finally{const a=js(i);a&&await a}}writeSync(t,n,r){var s;const i={stack:[],error:void 0,hasError:!1};try{const a=Is(i,this.transaction(),!1),o=this.findInodeSync(a,t,"write");let l=n;a.flag("partial")||(l=cw((s=a.getSync(o.data))!==null&&s!==void 0?s:new Uint8Array,r+n.byteLength),l.set(n,r),r=0),a.setSync(o.data,l,r),this._add(o.ino,t),a.commitSync()}catch(a){i.error=a,i.hasError=!0}finally{js(i)}}transaction(){return new __e(this.store.transaction(),this)}async checkRoot(){const t={stack:[],error:void 0,hasError:!1};try{const n=Is(t,this.transaction(),!0);if(await n.get(rl))return;const r=new Ti({ino:rl,data:1,mode:511|Ni});await n.set(r.data,nm("{}")),this._add(rl,"/"),await n.set(rl,xa(r)),await n.commit()}catch(n){t.error=n,t.hasError=!0}finally{const n=js(t);n&&await n}}checkRootSync(){const t={stack:[],error:void 0,hasError:!1};try{const n=Is(t,this.transaction(),!1);if(n.getSync(rl))return;const r=new Ti({ino:rl,data:1,mode:511|Ni});n.setSync(r.data,nm("{}")),this._add(rl,"/"),n.setSync(rl,xa(r)),n.commitSync()}catch(n){t.error=n,t.hasError=!0}finally{js(t)}}async _populate(){const t={stack:[],error:void 0,hasError:!1};try{if(this._initialized){Fa("Attempted to populate tables after initialization");return}Nx("Populating tables with existing store metadata");const n=Is(t,this.transaction(),!0),r=await n.get(rl);if(!r){FO("Store does not have a root inode");const o=new Ti({ino:rl,data:1,mode:511|Ni});await n.set(o.data,nm("{}")),this._add(rl,"/"),await n.set(rl,xa(o)),await n.commit();return}if(r.length<qs(Ti)){WE("Store contains an invalid root inode. Refusing to populate tables");return}const s=new Set;let i=0;const a=[["/",rl]];for(;a.length>0;){i++;const[o,l]=a.shift();this._add(l,o);const c=await n.get(l);if(!c){Fa("Store is missing data for inode: "+l);continue}if(c.length<qs(Ti)){Fa(`Invalid inode size for ino ${l}: ${c.length}`);continue}const u=new Ti(c);if((u.mode&Ni)!=Ni||s.has(l))continue;s.add(l);const d=await n.get(u.data);if(!d){Fa("Store is missing directory data: "+u.data);continue}const h=Ja(d);for(const[m,y]of Object.entries(h))a.push([os(o,m),y])}Nx(`Added ${i} existing inode(s) from store`)}catch(n){t.error=n,t.hasError=!0}finally{const n=js(t);n&&await n}}async findInode(t,n,r){var s;const i=this._ids.get(n);if(i===void 0)throw Xe.With("ENOENT",n,r);return new Ti((s=await t.get(i))!==null&&s!==void 0?s:vs(Xe.With("ENOENT",n,r)))}findInodeSync(t,n,r){var s;const i=this._ids.get(n);if(i===void 0)throw Xe.With("ENOENT",n,r);return new Ti((s=t.getSync(i))!==null&&s!==void 0?s:vs(Xe.With("ENOENT",n,r)))}allocNew(t,n){var r;(r=this._lastID)!==null&&r!==void 0||(this._lastID=Math.max(...this._paths.keys())),this._lastID+=2;const s=this._lastID;if(s>ho)throw Ro(new Xe(vt.ENOSPC,"No IDs available",t,n),{fs:this});return this._add(s,t),s}async commitNew(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Xe.With("EEXIST",t,s);const o=Is(a,this.transaction(),!0),{dir:l,base:c}=du(t),u=await this.findInode(o,l,s),d=Ja((i=await o.get(u.data))!==null&&i!==void 0?i:vs(Xe.With("ENOENT",l,s)));if(d[c])throw Xe.With("EEXIST",t,s);const h=this.allocNew(t,s),m=new Ti({...n,ino:h,data:h+1,size:r.byteLength});return await o.set(m.ino,xa(m)),await o.set(m.data,r),d[c]=m.ino,await o.set(u.data,Ml(d)),await o.commit(),m}catch(o){a.error=o,a.hasError=!0}finally{const o=js(a);o&&await o}}commitNewSync(t,n,r,s){var i;const a={stack:[],error:void 0,hasError:!1};try{if(t=="/")throw Xe.With("EEXIST",t,s);const o=Is(a,this.transaction(),!1),{dir:l,base:c}=du(t),u=this.findInodeSync(o,l,s),d=Ja((i=o.getSync(u.data))!==null&&i!==void 0?i:vs(Xe.With("ENOENT",l,s)));if(d[c])throw Xe.With("EEXIST",t,s);const h=this.allocNew(t,s),m=new Ti({...n,ino:h,data:h+1,size:r.byteLength});return o.setSync(m.ino,xa(m)),o.setSync(m.data,r),d[c]=m.ino,o.setSync(u.data,Ml(d)),o.commitSync(),m}catch(o){a.error=o,a.hasError=!0}finally{js(a)}}async remove(t,n){var r,s;const i={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=Is(i,this.transaction(),!0),{dir:l,base:c}=du(t),u=await this.findInode(o,l,a),d=Ja((r=await o.get(u.data))!==null&&r!==void 0?r:vs(Xe.With("ENOENT",l,a)));if(!d[c])throw Xe.With("ENOENT",t,a);const h=d[c],m=new Ti((s=await o.get(h))!==null&&s!==void 0?s:vs(Xe.With("ENOENT",t,a)));if(delete d[c],!n&&Bc(m))throw Xe.With("EISDIR",t,a);await o.set(u.data,Ml(d)),m.nlink>1?(m.update({nlink:m.nlink-1}),await o.set(m.ino,xa(m))):(await o.remove(m.data),await o.remove(h),this._remove(h)),await o.commit()}catch(a){i.error=a,i.hasError=!0}finally{const a=js(i);a&&await a}}removeSync(t,n){var r,s;const i={stack:[],error:void 0,hasError:!1};try{const a=n?"rmdir":"unlink",o=Is(i,this.transaction(),!1),{dir:l,base:c}=du(t),u=this.findInodeSync(o,l,a),d=Ja((r=o.getSync(u.data))!==null&&r!==void 0?r:vs(Xe.With("ENOENT",l,a))),h=d[c];if(!h)throw Xe.With("ENOENT",t,a);const m=new Ti((s=o.getSync(h))!==null&&s!==void 0?s:vs(Xe.With("ENOENT",t,a)));if(delete d[c],!n&&Bc(m))throw Xe.With("EISDIR",t,a);o.setSync(u.data,Ml(d)),m.nlink>1?(m.update({nlink:m.nlink-1}),o.setSync(m.ino,xa(m))):(o.removeSync(m.data),o.removeSync(h),this._remove(h)),o.commitSync()}catch(a){i.error=a,i.hasError=!0}finally{js(i)}}}class S_e extends w_e{async keys(){return this.store.keys()}async get(t){var n,r,s;return await((s=(r=(n=this.store).getAsync)===null||r===void 0?void 0:r.call(n,t))!==null&&s!==void 0?s:this.store.get(t))}getSync(t){return this.store.get(t)}setSync(t,n){this.store.set(t,n)}removeSync(t){this.store.delete(t)}}class C_e extends Map{constructor(t=ho,n){super(),this.maxSize=t,this.label=n,this.flags=[],this.name="tmpfs"}async sync(){}transaction(){return new S_e(this)}get bytes(){let t=this.size*4;for(const n of this.values())t+=n.byteLength;return t}usage(){return{totalSpace:this.maxSize,freeSpace:this.maxSize-this.bytes}}}const k_e={name:"InMemory",options:{maxSize:{type:"number",required:!1},label:{type:"string",required:!1}},create({maxSize:e,label:t}){const n=new YK(new C_e(e,t));return n.checkRootSync(),n}},E_e=k_e;let Gi=!0;class e9 extends NO{get cursor(){return this._cursor}constructor(t,n,r,s=!1){super(),this.input=t,this.output=n,this.terminal=s,this.line="",this._cursor=0,this._buffer="",this._closed=!1,this._paused=!1,this._prompt="",this._history=[],this._historyIndex=-1,this._currentLine="",this._onData=i=>{if(!(this._paused||this._closed)){this._buffer+=typeof i=="string"?i:i.toString("utf8");for(let a=this._buffer.indexOf(`
`);a>=0;a=this._buffer.indexOf(`
`)){let o=this._buffer.substring(0,a);o.endsWith("\r")&&(o=o.substring(0,o.length-1)),this._buffer=this._buffer.substring(a+1),this.line=o,o.trim()&&!o.trim().match(/^\s*$/)&&this._history.at(-1)!=o&&(this._history.push(o),this._historyIndex=this._history.length,this.emit("history",this._history)),this.emit("line",o)}}},this.input.on("data",this._onData),this.input.on("end",this.close.bind(this)),this.input.on("close",this.close.bind(this))}close(){var t,n;if(!this._closed){if(this._closed=!0,(n=(t=this.input)===null||t===void 0?void 0:t.removeAllListeners)===null||n===void 0||n.call(t),this._buffer.length){const r=this._buffer;this._buffer="",this.line=r,this.emit("line",r)}this.emit("history",this._history),this.emit("close"),this.removeAllListeners()}}pause(){return this._paused?this:(this._paused=!0,"pause"in this.input&&this.input.pause(),this.emit("pause"),this)}resume(){return this._paused?(this._paused=!1,"resume"in this.input&&this.input.resume(),this.emit("resume"),this):this}setPrompt(t){this._prompt=t}getPrompt(){return this._prompt}prompt(t){if(!this.output)return;if(!t){this.output.write(this._prompt);return}const{cols:n}=this.getCursorPos();this.output.write(this._prompt),this._cursor=n}write(t,n){if(!this._closed){if(t){const r=typeof t=="string"?t:t.toString("utf8");this._onData(r)}if(!(!n||!this.terminal))switch((n.ctrl?"^":"")+n.name){case"^c":this.emit("SIGINT");break;case"^z":this.emit("SIGTSTP");break;case"^q":this.emit("SIGCONT");break;case"home":case"^a":if(!this.output)return;Il(this.output,-this._cursor,0),this._cursor=0,this._cursor=0;break;case"^e":case"end":{if(!this.output)return;const r=this.line.length-this._cursor;if(!r)return;Il(this.output,r,0),this._cursor=this.line.length,this._cursor=this.line.length;break}case"^k":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor);$S(this.output,1),this.line=r;break}case"^u":{if(!this.output||!this._cursor)return;const r=this.line.slice(this._cursor);$S(this.output,0),Il(this.output,0,0),this.output.write(this._prompt+r),this.line=r,this._cursor=0,this._cursor=0;break}case"^w":{if(!this.output||!this._cursor)return;let r=this._cursor-1;for(;r>=0&&this.line[r]===" ";)r--;for(;r>=0&&this.line[r]!==" ";)r--;const s=this.line.slice(0,r+1)+this.line.slice(this._cursor),i=r+1;this._renderLine(s),this._cursor=i,this._cursor=i,Il(this.output,-s.length,0),Il(this.output,i,0);break}case"^return":case"^enter":this._onData(`
`);break;case"return":case"enter":this._onData((t?typeof t=="string"?t:t.toString("utf8"):"")+`
`);break;case"up":case"down":{if(!this.output||!this._history.length)return;if(this._historyIndex===this._history.length&&(this._currentLine=this.line||""),n.name=="up"&&this._historyIndex>0)this._historyIndex--;else if(n.name=="down"&&this._historyIndex<this._history.length-1)this._historyIndex++;else if(n.name=="down"&&this._historyIndex==this._history.length-1){this._historyIndex=this._history.length,this._renderLine(this._currentLine);return}else return;const r=this._history[this._historyIndex];this._renderLine(r);break}case"left":case"right":{const r=n.name=="left"?-1:1;if(!this.output)return;const s=Math.max(0,Math.min(this.line.length,this._cursor+r));if(s==this._cursor)return;Il(this.output,r,0),this._cursor=s,this._cursor=s;break}case"backspace":{if(!this.output||!this._cursor)return;const r=this.line.slice(0,this._cursor-1)+this.line.slice(this._cursor);this._renderLine(r),this._cursor=--this._cursor,this._cursor>0&&(Il(this.output,-this._cursor,0),Il(this.output,this._cursor,0));break}case"delete":{if(!this.output||this._cursor>=this.line.length)return;const r=this.line.slice(0,this._cursor)+this.line.slice(this._cursor+1);$S(this.output,0),Il(this.output,0,0),this.output.write(this._prompt+r),this.line=r,Il(this.output,-r.length,0),Il(this.output,this._cursor,0);break}}}}_renderLine(t){this.output&&($S(this.output,0),Il(this.output,0,0),this.output.write(this._prompt+t),this.line=t,this._cursor=t.length,this._cursor=t.length)}question(t,n,r){const s=typeof n=="function"?n:r;if(this._closed||!this.output){s("");return}this.output.write(t),this.once("line",s)}getCursorPos(){return{rows:0,cols:this.cursor}}prependListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.on(t,n),r.forEach(this.on.bind(this,t)),this}prependOnceListener(t,n){const r=this.listeners(t);return this.removeAllListeners(t),this.once(t,n),r.forEach(this.on.bind(this,t)),this}setMaxListeners(){return Fa("Interface.prototype.setMaxListeners is not supported"),this}getMaxListeners(){return Fa("Interface.prototype.getMaxListeners is not supported"),10}[Symbol.asyncIterator](){let t=!1;return{next:async()=>{if(t)return{done:t,value:void 0};const{resolve:n,promise:r}=Promise.withResolvers();return this.once("line",s=>n({value:s,done:!1})),this.once("close",()=>{t=!0,n({value:void 0,done:t})}),r},return:async n=>t?{done:t,value:n}:(t=!0,this.close(),{done:t,value:n}),throw:async n=>{throw t||(t=!0,this.close()),n},[Symbol.asyncIterator](){return this},[Symbol.asyncDispose]:async()=>{t||(t=!0,this.close())}}}async[Symbol.asyncDispose](){if(this._closed)return;const{resolve:t,promise:n}=Promise.withResolvers();this.once("close",()=>t()),this.close(),await n}rawListeners(t){return this.listeners(t)}}function T_e(e,t,n,r){return"input"in e?new e9(e.input,e.output,e.completer,e.terminal):new e9(e,t,n,r)}function $S(e,t){return e.write(t>=0?"\r\x1B[K":"\x1B[K"),!0}function Il(e,t,n){if(!e.write)return!1;let r="";return t<0?r+=`\x1B[${-t}D`:t>0&&(r+=`\x1B[${t}C`),n<0?r+=`\x1B[${-n}A`:n>0&&(r+=`\x1B[${n}B`),r&&e.write(r),!0}class Y2{get position(){return this.flag&Mm?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n,r,s,i,a){this.context=t,this.path=n,this.fs=r,this.internalPath=s,this.flag=i,this.inode=a,this._position=0,this.dirty=!1,this.closed=!1}[Symbol.dispose](){this.close()}get _isSync(){return!!(this.flag&YE||this.inode.flags&No.Sync)}sync(){if(this.closed)throw Xe.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||this.fs.touchSync(this.internalPath,this.inode),this.dirty=!1)}datasync(){return this.sync()}close(){if(this.closed)throw Xe.With("EBADF",this.path,"close");this.sync(),this.dispose()}dispose(t){if(this.closed)throw Xe.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Xe.With("EBUSY",this.path,"dispose");this.closed=!0}stat(){if(this.closed)throw Xe.With("EBADF",this.path,"stat");return this.inode}truncate(t){if(this.closed)throw Xe.With("EBADF",this.path,"truncate");if(this.dirty=!0,!(this.flag&Da||this.flag&Bd))throw new Xe(vt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this.inode.ctimeMs=Date.now(),this._isSync&&this.sync()}write(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Xe.With("EBADF",this.path,"write");if(!(this.flag&Da||this.flag&Bd))throw new Xe(vt.EPERM,"File not opened with a writeable mode");if(this.inode.flags&No.Immutable)throw new Xe(vt.EPERM,"File is immutable",this.path,"write");this.dirty=!0;const i=s+r,a=t.subarray(n,n+r);return!hw(this.inode)&&!fw(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=s+a.byteLength,this.fs.writeSync(this.internalPath,a,s),this._isSync&&this.sync(),a.byteLength}read(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Xe.With("EBADF",this.path,"read");if(this.flag&Da)throw new Xe(vt.EPERM,"File not opened with a readable mode");this.inode.flags&No.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=s+r;!hw(this.inode)&&!fw(this.inode)&&i>this.inode.size&&(i=s+Math.max(this.inode.size-s,0)),this._position=i;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return this.fs.readSync(this.internalPath,a.subarray(n,n+r),s,i),this._isSync&&this.sync(),i-s}chmod(t){if(this.closed)throw Xe.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(t>ks?-61441:ks)|t,(this._isSync||t>ks)&&this.sync()}chown(t,n){if(this.closed)throw Xe.With("EBADF",this.path,"chown");this.dirty=!0,GK(this.inode,t,n),this._isSync&&this.sync()}utimes(t,n){if(this.closed)throw Xe.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=t,this.inode.mtimeMs=n,this._isSync&&this.sync()}streamRead(t){if(this.closed)throw Xe.With("EBADF",this.path,"streamRead");return this.fs.streamRead(this.internalPath,t)}streamWrite(t){if(this.closed)throw Xe.With("EBADF",this.path,"streamWrite");if(this.inode.flags&No.Immutable)throw new Xe(vt.EPERM,"File is immutable",this.path,"streamWrite");return this.fs.streamWrite(this.internalPath,t)}}function Z2(e){var t,n;const r=(n=(t=e.context)===null||t===void 0?void 0:t.descriptors)!==null&&n!==void 0?n:qc.descriptors,s=Math.max(r.size?Math.max(...r.keys())+1:0,4);return r.set(s,e),s}function Wa(e,t){var n;const s=((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:qc.descriptors).get(t);if(!s)throw new Xe(vt.EBADF);return s}function ZK(e,t){var n;return((n=e==null?void 0:e.descriptors)!==null&&n!==void 0?n:qc.descriptors).delete(t)}const A_e=/[rwasx]{1,2}\+?/;function zd(e){if(typeof e=="number")return e;if(!A_e.test(e))throw new Xe(vt.EINVAL,"Invalid flag string: "+e);return R_e(e)}function R_e(e){if(!e.includes("r")&&!e.includes("w")&&!e.includes("a"))throw new Xe(vt.EINVAL,"Invalid flag string: "+e);let t=e.includes("r")?OK:HE;return e.includes("w")&&(t|=KE),e.includes("a")&&(t|=Mm),e.includes("+")?t|=Bd:e.includes("r")||(t|=Da),e.includes("s")&&(t|=YE),e.includes("x")&&(t|=GE),t}function XK(e){let t=0;return e&Da||(t|=Hi),(e&Da||e&Bd)&&(t|=ci),t}const pw=new Map;qO("/",E_e.create({label:"root"}));function qO(e,t){if(e[0]!="/"&&(e="/"+e),e=Zd.call(this,e),pw.has(e))throw Ro(new Xe(vt.EINVAL,"Mount point is already in use: "+e));t._mountPoint=e,pw.set(e,t),jK(`Mounted ${t.name} on ${e}`),Nx(`${t.name} attributes: ${[...t.attributes].map(([n,r])=>r!=null?n+"="+r:n).join(", ")}`)}function JK(e){if(e[0]!="/"&&(e="/"+e),e=Zd.call(this,e),!pw.has(e)){Fa(e+" is already unmounted");return}pw.delete(e),FO("Unmounted "+e)}function Ir(e,t){const n=(t==null?void 0:t.root)||qc.root;e=Bn(os(n,e));const r=[...pw].sort((s,i)=>s[0].length>i[0].length?-1:1);for(const[s,i]of r)if(M_e(s,e))return e=e.slice(s.length>1?s.length:0),e===""&&(e=n),{fs:i,path:e,mountPoint:s,root:n};throw z1e(new Xe(vt.EIO,"No file system",e))}function uM(e,t){for(const[n,r]of Object.entries(t))e=e==null?void 0:e.replaceAll(n,r);return e}function ps(e,t){typeof e.stack=="string"&&(e.stack=uM(e.stack,t));try{e.message=uM(e.message,t)}catch{}return e.path&&(e.path=uM(e.path,t)),e}function QK(e,t){const n=e.usage(),r=n.blockSize||4096;return{type:(t?BigInt:Number)(e.type),bsize:(t?BigInt:Number)(r),ffree:(t?BigInt:Number)(n.freeNodes||ho),files:(t?BigInt:Number)(n.totalNodes||ho),bavail:(t?BigInt:Number)(n.freeSpace/r),bfree:(t?BigInt:Number)(n.freeSpace/r),blocks:(t?BigInt:Number)(n.totalSpace/r)}}function N_e(e){var t,n,r,s,i,a,o;const l=this!==null&&this!==void 0?this:qc;if(((t=l.credentials)===null||t===void 0?void 0:t.uid)!==0&&((n=l.credentials)===null||n===void 0?void 0:n.gid)!==0&&((r=l.credentials)===null||r===void 0?void 0:r.euid)!==0&&((s=l.credentials)===null||s===void 0?void 0:s.egid)!==0)throw new Xe(vt.EPERM,"Can not chroot() as non-root user");(i=l.root)!==null&&i!==void 0||(l.root="/");const c=os(l.root,e);for(const u of(o=(a=l.descriptors)===null||a===void 0?void 0:a.values())!==null&&o!==void 0?o:[]){if(!u.path.startsWith(l.root))throw Xe.With("EBUSY",u.path,"chroot");u.path=u.path.slice(l.root.length)}if(c.length>l.root.length)throw new Xe(vt.EPERM,"Can not chroot() outside of current root");l.root=c}function M_e(e,t){return e==="/"||e===t?!0:(e.endsWith("/")||(e+="/"),t.startsWith(e))}class eY extends NO{off(t,n,r,s){return super.off(t,n,r,s)}removeListener(t,n,r,s){return super.removeListener(t,n,r,s)}constructor(t,n){super(),this._context=t,this.path=n}setMaxListeners(){throw Xe.With("ENOSYS",this.path,"Watcher.setMaxListeners")}getMaxListeners(){throw Xe.With("ENOSYS",this.path,"Watcher.getMaxListeners")}prependListener(){throw Xe.With("ENOSYS",this.path,"Watcher.prependListener")}prependOnceListener(){throw Xe.With("ENOSYS",this.path,"Watcher.prependOnceListener")}rawListeners(){throw Xe.With("ENOSYS",this.path,"Watcher.rawListeners")}ref(){return this}unref(){return this}}class tY extends eY{constructor(t,n,r){super(t,n),this.options=r,this.realpath=t!=null&&t.root?os(t.root,n):n,j_e(this.realpath,this)}close(){super.emit("close"),P_e(this.realpath,this)}[Symbol.dispose](){this.close()}}class I_e extends eY{constructor(t,n,r){super(t,n),this.options=r,this.start()}onInterval(){try{const t=Fh(this.path);f_e(this.previous,t)||(this.emit("change",t,this.previous),this.previous=t)}catch(t){this.emit("error",t)}}start(){const t=this.options.interval||5e3;try{this.previous=Fh(this.path)}catch(n){this.emit("error",n);return}this.intervalId=setInterval(this.onInterval.bind(this),t),!this.options.persistent&&typeof this.intervalId=="object"&&this.intervalId.unref()}stop(){this.intervalId&&(clearInterval(this.intervalId),this.intervalId=void 0),this.removeAllListeners()}}const xh=new Map;function j_e(e,t){const n=Bn(e);xh.has(n)||xh.set(n,new Set),xh.get(n).add(t)}function P_e(e,t){const n=Bn(e);xh.has(n)&&(xh.get(n).delete(t),xh.get(n).size===0&&xh.delete(n))}function ka(e,t,n){var r;e&&(n=os((r=e.root)!==null&&r!==void 0?r:"/",n)),n=Bn(n);for(let s=n;s!="/";s=Xr(s)){const i=xh.get(s);if(i)for(const a of i)a.emit("change",t,IK.call(a._context,s,n)||fy(n))}}var E1=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},T1=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});function O_e(e,t){e=Bn(e),t=Bn(t);const n=Ir(e,this),r=Ir(t,this);if(!Fh.call(this,Xr(e)).hasAccess(ci,this))throw Xe.With("EACCES",e,"rename");try{if(n===r){n.fs.renameSync(n.path,r.path),ka(this,"rename",e.toString()),ka(this,"change",t.toString());return}KO.call(this,t,GO(e)),HO.call(this,e),ka(this,"rename",e.toString())}catch(s){throw ps(s,{[n.path]:e,[r.path]:t})}}function VO(e){e=Bn(e);try{const{fs:t,path:n}=Ir(np.call(this,e),this);return t.existsSync(n)}catch(t){if(t.errno==vt.ENOENT)return!1;throw t}}function Fh(e,t){e=Bn(e);const{fs:n,path:r}=Ir(np.call(this,e),this);try{const s=n.statSync(r);if(Gi&&!hs(this,s,Hi))throw Xe.With("EACCES",r,"stat");return t!=null&&t.bigint?new Jm(s):new af(s)}catch(s){throw ps(s,{[r]:e})}}function WO(e,t){e=Bn(e);const{fs:n,path:r}=Ir(e,this);try{const s=n.statSync(r);if(Gi&&!hs(this,s,Hi))throw Xe.With("EACCES",r,"lstat");return t!=null&&t.bigint?new Jm(s):new af(s)}catch(s){throw ps(s,{[r]:e})}}function D_e(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{const r=E1(n,Qm.call(this,e,{flag:"r+"}),!1);if(t||(t=0),t<0)throw new Xe(vt.EINVAL);r.truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{T1(n)}}function HO(e){e=Bn(e);const{fs:t,path:n}=Ir(e,this);try{if(Gi&&!hs(this,t.statSync(n),ci))throw Xe.With("EACCES",n,"unlink");t.unlinkSync(n),ka(this,"rename",e.toString())}catch(r){throw ps(r,{[n]:e})}}function Qm(e,t){var n;e=Bn(e);const r=tp(t.mode,420),s=zd(t.flag);e=t.preserveSymlinks?e:np.call(this,e);const{fs:i,path:a}=Ir(e,this);let o;try{o=i.statSync(a)}catch{}if(!o){if(!(s&HE))throw Xe.With("ENOENT",e,"_open");const c=i.statSync(Xr(a));if(!hs(this,c,ci))throw Xe.With("EACCES",Xr(e),"_open");if(!Bc(c))throw Xe.With("ENOTDIR",Xr(e),"_open");if(!t.allowDirectory&&r&Ni)throw Xe.With("EISDIR",e,"_open");if(!hs(this,c,ci))throw Xe.With("EACCES",Xr(a),"_open");const{euid:u,egid:d}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:qc.credentials,h=i.createFileSync(a,{mode:r,uid:c.mode&C1?c.uid:u,gid:c.mode&k1?c.gid:d});return new Y2(this,e,i,a,s,h)}if(!hs(this,o,r)||!hs(this,o,XK(s)))throw Xe.With("EACCES",e,"_open");if(s&GE)throw Xe.With("EEXIST",e,"_open");const l=new Y2(this,e,i,a,s,o);if(s&KE&&l.truncate(0),!t.allowDirectory&&o.mode&Ni)throw Xe.With("EISDIR",e,"_open");return l}function ZE(e,t,n=BO){return Z2(Qm.call(this,e,{flag:t,mode:n}))}function XE(e,t,n){return Z2(Qm.call(this,e,{flag:t,mode:n,preserveSymlinks:!0}))}function nY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=E1(r,typeof e=="number"?Wa(this,e):Qm.call(this,e.toString(),{flag:t,mode:420,preserveSymlinks:n}),!1),{size:i}=s.stat(),a=new Uint8Array(i);return s.read(a,0,i,0),a}catch(s){r.error=s,r.hasError=!0}finally{T1(r)}}function GO(e,t={}){const n=$d(t,null,"r",420);if(zd(n.flag)&Da)throw new Xe(vt.EINVAL,"Flag passed to readFile must allow for reading");const s=Ds.from(nY.call(this,e,n.flag,!1));return n.encoding?s.toString(n.encoding):s}function KO(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const s=$d(n,"utf8","w+",420),i=zd(s.flag);if(!(i&Da||i&Bd))throw new Xe(vt.EINVAL,"Flag passed to writeFile must allow for writing");if(typeof t!="string"&&!s.encoding)throw new Xe(vt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Ds.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);if(!a)throw new Xe(vt.EINVAL,"Data not specified");E1(r,typeof e=="number"?Wa(this,e):Qm.call(this,e.toString(),{flag:i,mode:s.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength,0),ka(this,"change",e.toString())}catch(s){r.error=s,r.hasError=!0}finally{T1(r)}}function F_e(e,t,n={}){const r={stack:[],error:void 0,hasError:!1};try{const s=$d(n,"utf8","a+",420),i=zd(s.flag);if(!(i&Mm))throw new Xe(vt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!s.encoding)throw new Xe(vt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Ds.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);E1(r,Qm.call(this,typeof e=="number"?Wa(this,e).path:e.toString(),{flag:i,mode:s.mode,preserveSymlinks:!0}),!1).write(a,0,a.byteLength)}catch(s){r.error=s,r.hasError=!0}finally{T1(r)}}function L_e(e,t){const n=Wa(this,e).stat();return t!=null&&t.bigint?new Jm(n):new af(n)}function eg(e){Wa(this,e).close(),ZK(this,e)}function B_e(e,t=0){if(t||(t=0),t<0)throw new Xe(vt.EINVAL);Wa(this,e).truncate(t)}function $_e(e){Wa(this,e).sync()}function z_e(e){Wa(this,e).datasync()}function U_e(e,t,n,r,s){let i,a,o,l;if(typeof t=="string"){l=typeof n=="number"?n:null;const d=typeof r=="string"?r:"utf8";a=0,i=Ds.from(t,d),o=i.byteLength}else i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n,o=r,l=typeof s=="number"?s:null;const c=Wa(this,e);l??(l=c.position);const u=c.write(i,a,o,l);return ka(this,"change",c.path),u}function q_e(e,t,n,r,s){const i=Wa(this,e),a=typeof n=="object"?n.offset:n;return typeof n=="object"&&(r=n.length,s=n.position),s=Number(s),isNaN(s)&&(s=i.position),i.read(t,a,r,s)}function YO(e,t,n){Wa(this,e).chown(t,n)}function ZO(e,t){const n=tp(t,-1);if(n<0)throw new Xe(vt.EINVAL,"Invalid mode.");Wa(this,e).chmod(n)}function XO(e,t,n){Wa(this,e).utimes(K2(t),K2(n))}function rY(e){e=Bn(e);const{fs:t,path:n}=Ir(np.call(this,e),this);try{const r=t.statSync(n);if(!Bc(r))throw Xe.With("ENOTDIR",n,"rmdir");if(Gi&&!hs(this,r,ci))throw Xe.With("EACCES",n,"rmdir");t.rmdirSync(n),ka(this,"rename",e.toString())}catch(r){throw ps(r,{[n]:e})}}function JO(e,t){var n,r;const{euid:s,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:qc.credentials;t=typeof t=="object"?t:{mode:t};const a=tp(t==null?void 0:t.mode,511);e=np.call(this,e);const{fs:o,path:l,root:c}=Ir(e,this),u={[l]:e},d=(h,m)=>{if(!hs(this,m,ci))throw Xe.With("EACCES",Xr(h),"mkdir");const y=o.mkdirSync(h,{mode:a,uid:m.mode&C1?m.uid:s,gid:m.mode&k1?m.gid:i});return ka(this,"rename",h),y};try{if(!(t!=null&&t.recursive)){d(l,o.statSync(Xr(l)));return}const h=[];for(let y=l,b=e;!o.existsSync(y);y=Xr(y),b=Xr(b))h.unshift(y),u[y]=b;if(!h.length)return;const m=[o.statSync(Xr(h[0]))];for(const[y,b]of h.entries())m.push(d(b,m[y]));return c.length==1?h[0]:(r=h[0])===null||r===void 0?void 0:r.slice(c.length)}catch(h){throw ps(h,u)}}function eb(e,t){t=typeof t=="object"?t:{encoding:t},e=Bn(e);const{fs:n,path:r}=Ir(np.call(this,e),this);let s;try{const a=n.statSync(r);if(Gi&&!hs(this,a,Hi))throw Xe.With("EACCES",r,"readdir");if(!Bc(a))throw Xe.With("ENOTDIR",r,"readdir");s=n.readdirSync(r)}catch(a){throw ps(a,{[r]:e})}const i=[];for(const a of s){let o;try{o=n.statSync(os(r,a))}catch{continue}if(t!=null&&t.withFileTypes?i.push(new mw(a,o)):(t==null?void 0:t.encoding)=="buffer"?i.push(Ds.from(a)):i.push(a),!(!Bc(o)||!(t!=null&&t.recursive)))for(const l of eb.call(this,os(e,a),t))l instanceof mw?(l.path=os(a,l.path),i.push(l)):Ds.isBuffer(l)?i.push(Ds.from(os(a,IO(l)))):i.push(os(a,l))}return i}function V_e(e,t){if(e=Bn(e),!Fh(Xr(e)).hasAccess(Hi,this))throw Xe.With("EACCES",Xr(e),"link");if(t=Bn(t),!Fh(Xr(t)).hasAccess(ci,this))throw Xe.With("EACCES",Xr(t),"link");const{fs:n,path:r}=Ir(e,this),s=Ir(t,this);if(n!=s.fs)throw Xe.With("EXDEV",t,"link");try{if(Gi&&!hs(this,n.statSync(r),Hi))throw Xe.With("EACCES",r,"link");return n.linkSync(r,s.path)}catch(i){throw ps(i,{[r]:e,[s.path]:t})}}function W_e(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Xe(vt.EINVAL,"Invalid type: "+n);t=Bn(t);const s=E1(r,Qm.call(this,t,{flag:"wx",mode:420}),!1);s.write(nm(Bn(e,!0))),s.chmod(sf)}catch(s){r.error=s,r.hasError=!0}finally{T1(r)}}function Pj(e,t){const n=Ds.from(nY.call(this,e,"r",!0)),r=typeof t=="object"?t==null?void 0:t.encoding:t;return r=="buffer"?n:n.toString(r??"utf-8")}function H_e(e,t,n){const r=ZE.call(this,e,"r+");YO.call(this,r,t,n),eg.call(this,r)}function G_e(e,t,n){const r=XE.call(this,e,"r+");YO.call(this,r,t,n),eg.call(this,r)}function K_e(e,t){const n=ZE.call(this,e,"r+");ZO.call(this,n,t),eg.call(this,n)}function Y_e(e,t){const n=XE.call(this,e,"r+");ZO.call(this,n,t),eg.call(this,n)}function sY(e,t,n){const r=ZE.call(this,e,"r+");XO.call(this,r,t,n),eg.call(this,r)}function Z_e(e,t,n){const r=XE.call(this,e,"r+");XO.call(this,r,t,n),eg.call(this,r)}function Oj(e,t,n){try{const l=Ir(t,e),c=l.fs.statSync(l.path);if(!hy(c))return{...l,fullPath:t,stats:c};const u=Zd.call(e,Xr(t),Pj.call(e,t).toString());return Oj(e,u)}catch{}const{base:r,dir:s}=du(t),i=s=="/"?"/":np.call(e,s),a=os(i,r),o=Ir(a,e);try{const l=o.fs.statSync(o.path);if(!hy(l))return{...o,fullPath:a,stats:l};const c=Zd.call(e,i,Pj.call(e,a).toString());return Oj(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw ps(l,{[o.path]:a})}}function np(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=Bn(e);const{fullPath:s}=Oj(this,e);if(r=="utf8"||r=="utf-8")return s;const i=Ds.from(s,"utf-8");return r=="buffer"?i:i.toString(r)}function X_e(e,t=384){if(!hs(this,Fh.call(this,e),t))throw new Xe(vt.EACCES)}function iY(e,t){e=Bn(e);let n;try{n=WO.bind(this)(e)}catch(r){if(r.code!="ENOENT"||!(t!=null&&t.force))throw r}if(n)switch(n.mode&ks){case Ni:if(t!=null&&t.recursive)for(const r of eb.call(this,e))iY.call(this,os(e,r),t);rY.call(this,e);break;case Nc:case sf:case Ym:case Zm:HO.call(this,e);break;case Xm:case Km:default:throw new Xe(vt.EPERM,"File type not supported",e,"rm")}}function J_e(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",s="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return JO.call(this,s),n=="buffer"?Ds.from(s):s}function aY(e,t,n){if(e=Bn(e),t=Bn(t),n&&n&$O&&VO(t))throw new Xe(vt.EEXIST,"Destination file already exists",t,"copyFile");KO.call(this,t,GO(e)),ka(this,"rename",t.toString())}function Q_e(e,t,n){const r=Wa(this,e);let s=0;for(const i of t)s+=r.read(i,0,i.byteLength,n+s);return s}function eSe(e,t,n){const r=Wa(this,e);let s=0;for(const i of t)s+=r.write(new Uint8Array(i.buffer),0,i.byteLength,n+s);return s}function tSe(e,t){return e=Bn(e),new QO(e,this)}function oY(e,t,n){e=Bn(e),t=Bn(t);const r=WO.call(this,e);if(n!=null&&n.errorOnExist&&VO.call(this,t))throw new Xe(vt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&ks){case Ni:if(!(n!=null&&n.recursive))throw new Xe(vt.EISDIR,e+" is a directory (not copied)",e,"cp");JO.call(this,t,{recursive:!0});for(const s of eb.call(this,e,{withFileTypes:!0}))n.filter&&!n.filter(os(e,s.name),os(t,s.name))||oY.call(this,os(e,s.name),os(t,s.name),n);break;case Nc:case sf:aY.call(this,e,t);break;case Ym:case Zm:case Xm:case Km:default:throw new Xe(vt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&sY.call(this,t,r.atime,r.mtime)}function nSe(e,t){e=Bn(e);const{fs:n}=Ir(e,this);return QK(n,t==null?void 0:t.bigint)}function rSe(e,t={}){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:s=()=>!1}=t,i=e.map(l=>(l=l.replace(/([.?+^$(){}|[\]/])/g,"\\$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${l}$`))),a=[];function o(l){const c=eb(l,{withFileTypes:r,encoding:"utf8"});for(const u of c){const d=r?u.path:l+"/"+u;s(r?u:d)||(Fh(d).isDirectory()&&i.some(h=>h.source.includes(".*"))&&o(d),i.some(h=>h.test(d.replace(/^\/+/g,"")))&&a.push(r?u.path:d.replace(/^\/+/g,"")))}}return o(n),a}class mw{get name(){return fy(this.path)}constructor(t,n){this.path=t,this.stats=n}get parentPath(){return this.path}isFile(){return y_e(this.stats)}isDirectory(){return Bc(this.stats)}isBlockDevice(){return fw(this.stats)}isCharacterDevice(){return hw(this.stats)}isSymbolicLink(){return hy(this.stats)}isFIFO(){return v_e(this.stats)}isSocket(){return b_e(this.stats)}}class QO{checkClosed(){if(this.closed)throw new Xe(vt.EBADF,"Can not use closed Dir")}constructor(t,n){this.path=t,this.context=n,this.closed=!1}close(t){if(this.closed=!0,!t)return Promise.resolve();t()}closeSync(){this.closed=!0}async _read(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=await ng.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}read(t){if(!t)return this._read();this._read().then(n=>t(void 0,n))}readSync(){var t,n;return this.checkClosed(),(t=this._entries)!==null&&t!==void 0||(this._entries=eb.call(this.context,this.path,{withFileTypes:!0})),this._entries.length&&(n=this._entries.shift())!==null&&n!==void 0?n:null}async next(){const t=await this._read();return t?{done:!1,value:t}:(await this.close(),{done:!0,value:void 0})}[Symbol.asyncIterator](){return this}[Symbol.asyncDispose](){return Promise.resolve()}}var dM={exports:{}},fM={exports:{}},hM={},t9;function rp(){return t9||(t9=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});var t={},n={};n.byteLength=u,n.toByteArray=h,n.fromByteArray=b;for(var r=[],s=[],i=typeof Uint8Array<"u"?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,l=a.length;o<l;++o)r[o]=a[o],s[a.charCodeAt(o)]=o;s[45]=62,s[95]=63;function c(w){var S=w.length;if(S%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var k=w.indexOf("=");k===-1&&(k=S);var C=k===S?0:4-k%4;return[k,C]}function u(w){var S=c(w),k=S[0],C=S[1];return(k+C)*3/4-C}function d(w,S,k){return(S+k)*3/4-k}function h(w){var S,k=c(w),C=k[0],T=k[1],A=new i(d(w,C,T)),N=0,I=T>0?C-4:C,O;for(O=0;O<I;O+=4)S=s[w.charCodeAt(O)]<<18|s[w.charCodeAt(O+1)]<<12|s[w.charCodeAt(O+2)]<<6|s[w.charCodeAt(O+3)],A[N++]=S>>16&255,A[N++]=S>>8&255,A[N++]=S&255;return T===2&&(S=s[w.charCodeAt(O)]<<2|s[w.charCodeAt(O+1)]>>4,A[N++]=S&255),T===1&&(S=s[w.charCodeAt(O)]<<10|s[w.charCodeAt(O+1)]<<4|s[w.charCodeAt(O+2)]>>2,A[N++]=S>>8&255,A[N++]=S&255),A}function m(w){return r[w>>18&63]+r[w>>12&63]+r[w>>6&63]+r[w&63]}function y(w,S,k){for(var C,T=[],A=S;A<k;A+=3)C=(w[A]<<16&16711680)+(w[A+1]<<8&65280)+(w[A+2]&255),T.push(m(C));return T.join("")}function b(w){for(var S,k=w.length,C=k%3,T=[],A=16383,N=0,I=k-C;N<I;N+=A)T.push(y(w,N,N+A>I?I:N+A));return C===1?(S=w[k-1],T.push(r[S>>2]+r[S<<4&63]+"==")):C===2&&(S=(w[k-2]<<8)+w[k-1],T.push(r[S>>10]+r[S>>4&63]+r[S<<2&63]+"=")),T.join("")}var v={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */v.read=function(w,S,k,C,T){var A,N,I=T*8-C-1,O=(1<<I)-1,B=O>>1,D=-7,H=k?T-1:0,P=k?-1:1,K=w[S+H];for(H+=P,A=K&(1<<-D)-1,K>>=-D,D+=I;D>0;A=A*256+w[S+H],H+=P,D-=8);for(N=A&(1<<-D)-1,A>>=-D,D+=C;D>0;N=N*256+w[S+H],H+=P,D-=8);if(A===0)A=1-B;else{if(A===O)return N?NaN:(K?-1:1)*(1/0);N=N+Math.pow(2,C),A=A-B}return(K?-1:1)*N*Math.pow(2,A-C)},v.write=function(w,S,k,C,T,A){var N,I,O,B=A*8-T-1,D=(1<<B)-1,H=D>>1,P=T===23?Math.pow(2,-24)-Math.pow(2,-77):0,K=C?0:A-1,U=C?1:-1,V=S<0||S===0&&1/S<0?1:0;for(S=Math.abs(S),isNaN(S)||S===1/0?(I=isNaN(S)?1:0,N=D):(N=Math.floor(Math.log(S)/Math.LN2),S*(O=Math.pow(2,-N))<1&&(N--,O*=2),N+H>=1?S+=P/O:S+=P*Math.pow(2,1-H),S*O>=2&&(N++,O/=2),N+H>=D?(I=0,N=D):N+H>=1?(I=(S*O-1)*Math.pow(2,T),N=N+H):(I=S*Math.pow(2,H-1)*Math.pow(2,T),N=0));T>=8;w[k+K]=I&255,K+=U,I/=256,T-=8);for(N=N<<T|I,B+=T;B>0;w[k+K]=N&255,K+=U,N/=256,B-=8);w[k+K-U]|=V*128};/*!
 * The buffer module from node.js, for the browser.
 *
 * @author   Feross Aboukhadijeh <https://feross.org>
 * @license  MIT
 */(function(w){const S=n,k=v,C=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;w.Buffer=D,w.SlowBuffer=re,w.INSPECT_MAX_BYTES=50;const T=2147483647;w.kMaxLength=T;const{Uint8Array:A,ArrayBuffer:N,SharedArrayBuffer:I}=globalThis;D.TYPED_ARRAY_SUPPORT=O(),!D.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function O(){try{const Z=new A(1),G={foo:function(){return 42}};return Object.setPrototypeOf(G,A.prototype),Object.setPrototypeOf(Z,G),Z.foo()===42}catch{return!1}}Object.defineProperty(D.prototype,"parent",{enumerable:!0,get:function(){if(D.isBuffer(this))return this.buffer}}),Object.defineProperty(D.prototype,"offset",{enumerable:!0,get:function(){if(D.isBuffer(this))return this.byteOffset}});function B(Z){if(Z>T)throw new RangeError('The value "'+Z+'" is invalid for option "size"');const G=new A(Z);return Object.setPrototypeOf(G,D.prototype),G}function D(Z,G,J){if(typeof Z=="number"){if(typeof G=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return U(Z)}return H(Z,G,J)}D.poolSize=8192;function H(Z,G,J){if(typeof Z=="string")return V(Z,G);if(N.isView(Z))return te(Z);if(Z==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Z);if(ve(Z,N)||Z&&ve(Z.buffer,N)||typeof I<"u"&&(ve(Z,I)||Z&&ve(Z.buffer,I)))return W(Z,G,J);if(typeof Z=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');const xe=Z.valueOf&&Z.valueOf();if(xe!=null&&xe!==Z)return D.from(xe,G,J);const De=Q(Z);if(De)return De;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof Z[Symbol.toPrimitive]=="function")return D.from(Z[Symbol.toPrimitive]("string"),G,J);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof Z)}D.from=function(Z,G,J){return H(Z,G,J)},Object.setPrototypeOf(D.prototype,A.prototype),Object.setPrototypeOf(D,A);function P(Z){if(typeof Z!="number")throw new TypeError('"size" argument must be of type number');if(Z<0)throw new RangeError('The value "'+Z+'" is invalid for option "size"')}function K(Z,G,J){return P(Z),Z<=0?B(Z):G!==void 0?typeof J=="string"?B(Z).fill(G,J):B(Z).fill(G):B(Z)}D.alloc=function(Z,G,J){return K(Z,G,J)};function U(Z){return P(Z),B(Z<0?0:ee(Z)|0)}D.allocUnsafe=function(Z){return U(Z)},D.allocUnsafeSlow=function(Z){return U(Z)};function V(Z,G){if((typeof G!="string"||G==="")&&(G="utf8"),!D.isEncoding(G))throw new TypeError("Unknown encoding: "+G);const J=pe(Z,G)|0;let xe=B(J);const De=xe.write(Z,G);return De!==J&&(xe=xe.slice(0,De)),xe}function L(Z){const G=Z.length<0?0:ee(Z.length)|0,J=B(G);for(let xe=0;xe<G;xe+=1)J[xe]=Z[xe]&255;return J}function te(Z){if(ve(Z,A)){const G=new A(Z);return W(G.buffer,G.byteOffset,G.byteLength)}return L(Z)}function W(Z,G,J){if(G<0||Z.byteLength<G)throw new RangeError('"offset" is outside of buffer bounds');if(Z.byteLength<G+(J||0))throw new RangeError('"length" is outside of buffer bounds');let xe;return G===void 0&&J===void 0?xe=new A(Z):J===void 0?xe=new A(Z,G):xe=new A(Z,G,J),Object.setPrototypeOf(xe,D.prototype),xe}function Q(Z){if(D.isBuffer(Z)){const G=ee(Z.length)|0,J=B(G);return J.length===0||Z.copy(J,0,0,G),J}if(Z.length!==void 0)return typeof Z.length!="number"||_e(Z.length)?B(0):L(Z);if(Z.type==="Buffer"&&Array.isArray(Z.data))return L(Z.data)}function ee(Z){if(Z>=T)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+T.toString(16)+" bytes");return Z|0}function re(Z){return+Z!=Z&&(Z=0),D.alloc(+Z)}D.isBuffer=function(G){return G!=null&&G._isBuffer===!0&&G!==D.prototype},D.compare=function(G,J){if(ve(G,A)&&(G=D.from(G,G.offset,G.byteLength)),ve(J,A)&&(J=D.from(J,J.offset,J.byteLength)),!D.isBuffer(G)||!D.isBuffer(J))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(G===J)return 0;let xe=G.length,De=J.length;for(let He=0,wt=Math.min(xe,De);He<wt;++He)if(G[He]!==J[He]){xe=G[He],De=J[He];break}return xe<De?-1:De<xe?1:0},D.isEncoding=function(G){switch(String(G).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},D.concat=function(G,J){if(!Array.isArray(G))throw new TypeError('"list" argument must be an Array of Buffers');if(G.length===0)return D.alloc(0);let xe;if(J===void 0)for(J=0,xe=0;xe<G.length;++xe)J+=G[xe].length;const De=D.allocUnsafe(J);let He=0;for(xe=0;xe<G.length;++xe){let wt=G[xe];if(ve(wt,A))He+wt.length>De.length?(D.isBuffer(wt)||(wt=D.from(wt)),wt.copy(De,He)):A.prototype.set.call(De,wt,He);else if(D.isBuffer(wt))wt.copy(De,He);else throw new TypeError('"list" argument must be an Array of Buffers');He+=wt.length}return De};function pe(Z,G){if(D.isBuffer(Z))return Z.length;if(N.isView(Z)||ve(Z,N))return Z.byteLength;if(typeof Z!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof Z);const J=Z.length,xe=arguments.length>2&&arguments[2]===!0;if(!xe&&J===0)return 0;let De=!1;for(;;)switch(G){case"ascii":case"latin1":case"binary":return J;case"utf8":case"utf-8":return ft(Z).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return J*2;case"hex":return J>>>1;case"base64":return Ue(Z).length;default:if(De)return xe?-1:ft(Z).length;G=(""+G).toLowerCase(),De=!0}}D.byteLength=pe;function de(Z,G,J){let xe=!1;if((G===void 0||G<0)&&(G=0),G>this.length||((J===void 0||J>this.length)&&(J=this.length),J<=0)||(J>>>=0,G>>>=0,J<=G))return"";for(Z||(Z="utf8");;)switch(Z){case"hex":return Me(this,G,J);case"utf8":case"utf-8":return ye(this,G,J);case"ascii":return oe(this,G,J);case"latin1":case"binary":return se(this,G,J);case"base64":return Y(this,G,J);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Be(this,G,J);default:if(xe)throw new TypeError("Unknown encoding: "+Z);Z=(Z+"").toLowerCase(),xe=!0}}D.prototype._isBuffer=!0;function Oe(Z,G,J){const xe=Z[G];Z[G]=Z[J],Z[J]=xe}D.prototype.swap16=function(){const G=this.length;if(G%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let J=0;J<G;J+=2)Oe(this,J,J+1);return this},D.prototype.swap32=function(){const G=this.length;if(G%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let J=0;J<G;J+=4)Oe(this,J,J+3),Oe(this,J+1,J+2);return this},D.prototype.swap64=function(){const G=this.length;if(G%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let J=0;J<G;J+=8)Oe(this,J,J+7),Oe(this,J+1,J+6),Oe(this,J+2,J+5),Oe(this,J+3,J+4);return this},D.prototype.toString=function(){const G=this.length;return G===0?"":arguments.length===0?ye(this,0,G):de.apply(this,arguments)},D.prototype.toLocaleString=D.prototype.toString,D.prototype.equals=function(G){if(!D.isBuffer(G))throw new TypeError("Argument must be a Buffer");return this===G?!0:D.compare(this,G)===0},D.prototype.inspect=function(){let G="";const J=w.INSPECT_MAX_BYTES;return G=this.toString("hex",0,J).replace(/(.{2})/g,"$1 ").trim(),this.length>J&&(G+=" ... "),"<Buffer "+G+">"},C&&(D.prototype[C]=D.prototype.inspect),D.prototype.compare=function(G,J,xe,De,He){if(ve(G,A)&&(G=D.from(G,G.offset,G.byteLength)),!D.isBuffer(G))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof G);if(J===void 0&&(J=0),xe===void 0&&(xe=G?G.length:0),De===void 0&&(De=0),He===void 0&&(He=this.length),J<0||xe>G.length||De<0||He>this.length)throw new RangeError("out of range index");if(De>=He&&J>=xe)return 0;if(De>=He)return-1;if(J>=xe)return 1;if(J>>>=0,xe>>>=0,De>>>=0,He>>>=0,this===G)return 0;let wt=He-De,Qt=xe-J;const On=Math.min(wt,Qt),Zt=this.slice(De,He),nn=G.slice(J,xe);for(let fn=0;fn<On;++fn)if(Zt[fn]!==nn[fn]){wt=Zt[fn],Qt=nn[fn];break}return wt<Qt?-1:Qt<wt?1:0};function Fe(Z,G,J,xe,De){if(Z.length===0)return-1;if(typeof J=="string"?(xe=J,J=0):J>2147483647?J=2147483647:J<-2147483648&&(J=-2147483648),J=+J,_e(J)&&(J=De?0:Z.length-1),J<0&&(J=Z.length+J),J>=Z.length){if(De)return-1;J=Z.length-1}else if(J<0)if(De)J=0;else return-1;if(typeof G=="string"&&(G=D.from(G,xe)),D.isBuffer(G))return G.length===0?-1:Se(Z,G,J,xe,De);if(typeof G=="number")return G=G&255,typeof A.prototype.indexOf=="function"?De?A.prototype.indexOf.call(Z,G,J):A.prototype.lastIndexOf.call(Z,G,J):Se(Z,[G],J,xe,De);throw new TypeError("val must be string, number or Buffer")}function Se(Z,G,J,xe,De){let He=1,wt=Z.length,Qt=G.length;if(xe!==void 0&&(xe=String(xe).toLowerCase(),xe==="ucs2"||xe==="ucs-2"||xe==="utf16le"||xe==="utf-16le")){if(Z.length<2||G.length<2)return-1;He=2,wt/=2,Qt/=2,J/=2}function On(nn,fn){return He===1?nn[fn]:nn.readUInt16BE(fn*He)}let Zt;if(De){let nn=-1;for(Zt=J;Zt<wt;Zt++)if(On(Z,Zt)===On(G,nn===-1?0:Zt-nn)){if(nn===-1&&(nn=Zt),Zt-nn+1===Qt)return nn*He}else nn!==-1&&(Zt-=Zt-nn),nn=-1}else for(J+Qt>wt&&(J=wt-Qt),Zt=J;Zt>=0;Zt--){let nn=!0;for(let fn=0;fn<Qt;fn++)if(On(Z,Zt+fn)!==On(G,fn)){nn=!1;break}if(nn)return Zt}return-1}D.prototype.includes=function(G,J,xe){return this.indexOf(G,J,xe)!==-1},D.prototype.indexOf=function(G,J,xe){return Fe(this,G,J,xe,!0)},D.prototype.lastIndexOf=function(G,J,xe){return Fe(this,G,J,xe,!1)};function Ce(Z,G,J,xe){J=Number(J)||0;const De=Z.length-J;xe?(xe=Number(xe),xe>De&&(xe=De)):xe=De;const He=G.length;xe>He/2&&(xe=He/2);let wt;for(wt=0;wt<xe;++wt){const Qt=parseInt(G.substr(wt*2,2),16);if(_e(Qt))return wt;Z[J+wt]=Qt}return wt}function qe(Z,G,J,xe){return tt(ft(G,Z.length-J),Z,J,xe)}function Qe(Z,G,J,xe){return tt(et(G),Z,J,xe)}function We(Z,G,J,xe){return tt(Ue(G),Z,J,xe)}function je(Z,G,J,xe){return tt($(G,Z.length-J),Z,J,xe)}D.prototype.write=function(G,J,xe,De){if(J===void 0)De="utf8",xe=this.length,J=0;else if(xe===void 0&&typeof J=="string")De=J,xe=this.length,J=0;else if(isFinite(J))J=J>>>0,isFinite(xe)?(xe=xe>>>0,De===void 0&&(De="utf8")):(De=xe,xe=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");const He=this.length-J;if((xe===void 0||xe>He)&&(xe=He),G.length>0&&(xe<0||J<0)||J>this.length)throw new RangeError("Attempt to write outside buffer bounds");De||(De="utf8");let wt=!1;for(;;)switch(De){case"hex":return Ce(this,G,J,xe);case"utf8":case"utf-8":return qe(this,G,J,xe);case"ascii":case"latin1":case"binary":return Qe(this,G,J,xe);case"base64":return We(this,G,J,xe);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return je(this,G,J,xe);default:if(wt)throw new TypeError("Unknown encoding: "+De);De=(""+De).toLowerCase(),wt=!0}},D.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Y(Z,G,J){return G===0&&J===Z.length?S.fromByteArray(Z):S.fromByteArray(Z.slice(G,J))}function ye(Z,G,J){J=Math.min(Z.length,J);const xe=[];let De=G;for(;De<J;){const He=Z[De];let wt=null,Qt=He>239?4:He>223?3:He>191?2:1;if(De+Qt<=J){let On,Zt,nn,fn;switch(Qt){case 1:He<128&&(wt=He);break;case 2:On=Z[De+1],(On&192)===128&&(fn=(He&31)<<6|On&63,fn>127&&(wt=fn));break;case 3:On=Z[De+1],Zt=Z[De+2],(On&192)===128&&(Zt&192)===128&&(fn=(He&15)<<12|(On&63)<<6|Zt&63,fn>2047&&(fn<55296||fn>57343)&&(wt=fn));break;case 4:On=Z[De+1],Zt=Z[De+2],nn=Z[De+3],(On&192)===128&&(Zt&192)===128&&(nn&192)===128&&(fn=(He&15)<<18|(On&63)<<12|(Zt&63)<<6|nn&63,fn>65535&&fn<1114112&&(wt=fn))}}wt===null?(wt=65533,Qt=1):wt>65535&&(wt-=65536,xe.push(wt>>>10&1023|55296),wt=56320|wt&1023),xe.push(wt),De+=Qt}return ce(xe)}const Ie=4096;function ce(Z){const G=Z.length;if(G<=Ie)return String.fromCharCode.apply(String,Z);let J="",xe=0;for(;xe<G;)J+=String.fromCharCode.apply(String,Z.slice(xe,xe+=Ie));return J}function oe(Z,G,J){let xe="";J=Math.min(Z.length,J);for(let De=G;De<J;++De)xe+=String.fromCharCode(Z[De]&127);return xe}function se(Z,G,J){let xe="";J=Math.min(Z.length,J);for(let De=G;De<J;++De)xe+=String.fromCharCode(Z[De]);return xe}function Me(Z,G,J){const xe=Z.length;(!G||G<0)&&(G=0),(!J||J<0||J>xe)&&(J=xe);let De="";for(let He=G;He<J;++He)De+=ze[Z[He]];return De}function Be(Z,G,J){const xe=Z.slice(G,J);let De="";for(let He=0;He<xe.length-1;He+=2)De+=String.fromCharCode(xe[He]+xe[He+1]*256);return De}D.prototype.slice=function(G,J){const xe=this.length;G=~~G,J=J===void 0?xe:~~J,G<0?(G+=xe,G<0&&(G=0)):G>xe&&(G=xe),J<0?(J+=xe,J<0&&(J=0)):J>xe&&(J=xe),J<G&&(J=G);const De=this.subarray(G,J);return Object.setPrototypeOf(De,D.prototype),De};function Ae(Z,G,J){if(Z%1!==0||Z<0)throw new RangeError("offset is not uint");if(Z+G>J)throw new RangeError("Trying to access beyond buffer length")}D.prototype.readUintLE=D.prototype.readUIntLE=function(G,J,xe){G=G>>>0,J=J>>>0,xe||Ae(G,J,this.length);let De=this[G],He=1,wt=0;for(;++wt<J&&(He*=256);)De+=this[G+wt]*He;return De},D.prototype.readUintBE=D.prototype.readUIntBE=function(G,J,xe){G=G>>>0,J=J>>>0,xe||Ae(G,J,this.length);let De=this[G+--J],He=1;for(;J>0&&(He*=256);)De+=this[G+--J]*He;return De},D.prototype.readUint8=D.prototype.readUInt8=function(G,J){return G=G>>>0,J||Ae(G,1,this.length),this[G]},D.prototype.readUint16LE=D.prototype.readUInt16LE=function(G,J){return G=G>>>0,J||Ae(G,2,this.length),this[G]|this[G+1]<<8},D.prototype.readUint16BE=D.prototype.readUInt16BE=function(G,J){return G=G>>>0,J||Ae(G,2,this.length),this[G]<<8|this[G+1]},D.prototype.readUint32LE=D.prototype.readUInt32LE=function(G,J){return G=G>>>0,J||Ae(G,4,this.length),(this[G]|this[G+1]<<8|this[G+2]<<16)+this[G+3]*16777216},D.prototype.readUint32BE=D.prototype.readUInt32BE=function(G,J){return G=G>>>0,J||Ae(G,4,this.length),this[G]*16777216+(this[G+1]<<16|this[G+2]<<8|this[G+3])},D.prototype.readBigUInt64LE=Ct(function(G){G=G>>>0,ke(G,"offset");const J=this[G],xe=this[G+7];(J===void 0||xe===void 0)&&ge(G,this.length-8);const De=J+this[++G]*2**8+this[++G]*2**16+this[++G]*2**24,He=this[++G]+this[++G]*2**8+this[++G]*2**16+xe*2**24;return BigInt(De)+(BigInt(He)<<BigInt(32))}),D.prototype.readBigUInt64BE=Ct(function(G){G=G>>>0,ke(G,"offset");const J=this[G],xe=this[G+7];(J===void 0||xe===void 0)&&ge(G,this.length-8);const De=J*2**24+this[++G]*2**16+this[++G]*2**8+this[++G],He=this[++G]*2**24+this[++G]*2**16+this[++G]*2**8+xe;return(BigInt(De)<<BigInt(32))+BigInt(He)}),D.prototype.readIntLE=function(G,J,xe){G=G>>>0,J=J>>>0,xe||Ae(G,J,this.length);let De=this[G],He=1,wt=0;for(;++wt<J&&(He*=256);)De+=this[G+wt]*He;return He*=128,De>=He&&(De-=Math.pow(2,8*J)),De},D.prototype.readIntBE=function(G,J,xe){G=G>>>0,J=J>>>0,xe||Ae(G,J,this.length);let De=J,He=1,wt=this[G+--De];for(;De>0&&(He*=256);)wt+=this[G+--De]*He;return He*=128,wt>=He&&(wt-=Math.pow(2,8*J)),wt},D.prototype.readInt8=function(G,J){return G=G>>>0,J||Ae(G,1,this.length),this[G]&128?(255-this[G]+1)*-1:this[G]},D.prototype.readInt16LE=function(G,J){G=G>>>0,J||Ae(G,2,this.length);const xe=this[G]|this[G+1]<<8;return xe&32768?xe|4294901760:xe},D.prototype.readInt16BE=function(G,J){G=G>>>0,J||Ae(G,2,this.length);const xe=this[G+1]|this[G]<<8;return xe&32768?xe|4294901760:xe},D.prototype.readInt32LE=function(G,J){return G=G>>>0,J||Ae(G,4,this.length),this[G]|this[G+1]<<8|this[G+2]<<16|this[G+3]<<24},D.prototype.readInt32BE=function(G,J){return G=G>>>0,J||Ae(G,4,this.length),this[G]<<24|this[G+1]<<16|this[G+2]<<8|this[G+3]},D.prototype.readBigInt64LE=Ct(function(G){G=G>>>0,ke(G,"offset");const J=this[G],xe=this[G+7];(J===void 0||xe===void 0)&&ge(G,this.length-8);const De=this[G+4]+this[G+5]*2**8+this[G+6]*2**16+(xe<<24);return(BigInt(De)<<BigInt(32))+BigInt(J+this[++G]*2**8+this[++G]*2**16+this[++G]*2**24)}),D.prototype.readBigInt64BE=Ct(function(G){G=G>>>0,ke(G,"offset");const J=this[G],xe=this[G+7];(J===void 0||xe===void 0)&&ge(G,this.length-8);const De=(J<<24)+this[++G]*2**16+this[++G]*2**8+this[++G];return(BigInt(De)<<BigInt(32))+BigInt(this[++G]*2**24+this[++G]*2**16+this[++G]*2**8+xe)}),D.prototype.readFloatLE=function(G,J){return G=G>>>0,J||Ae(G,4,this.length),k.read(this,G,!0,23,4)},D.prototype.readFloatBE=function(G,J){return G=G>>>0,J||Ae(G,4,this.length),k.read(this,G,!1,23,4)},D.prototype.readDoubleLE=function(G,J){return G=G>>>0,J||Ae(G,8,this.length),k.read(this,G,!0,52,8)},D.prototype.readDoubleBE=function(G,J){return G=G>>>0,J||Ae(G,8,this.length),k.read(this,G,!1,52,8)};function lt(Z,G,J,xe,De,He){if(!D.isBuffer(Z))throw new TypeError('"buffer" argument must be a Buffer instance');if(G>De||G<He)throw new RangeError('"value" argument is out of bounds');if(J+xe>Z.length)throw new RangeError("Index out of range")}D.prototype.writeUintLE=D.prototype.writeUIntLE=function(G,J,xe,De){if(G=+G,J=J>>>0,xe=xe>>>0,!De){const Qt=Math.pow(2,8*xe)-1;lt(this,G,J,xe,Qt,0)}let He=1,wt=0;for(this[J]=G&255;++wt<xe&&(He*=256);)this[J+wt]=G/He&255;return J+xe},D.prototype.writeUintBE=D.prototype.writeUIntBE=function(G,J,xe,De){if(G=+G,J=J>>>0,xe=xe>>>0,!De){const Qt=Math.pow(2,8*xe)-1;lt(this,G,J,xe,Qt,0)}let He=xe-1,wt=1;for(this[J+He]=G&255;--He>=0&&(wt*=256);)this[J+He]=G/wt&255;return J+xe},D.prototype.writeUint8=D.prototype.writeUInt8=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,1,255,0),this[J]=G&255,J+1},D.prototype.writeUint16LE=D.prototype.writeUInt16LE=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,2,65535,0),this[J]=G&255,this[J+1]=G>>>8,J+2},D.prototype.writeUint16BE=D.prototype.writeUInt16BE=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,2,65535,0),this[J]=G>>>8,this[J+1]=G&255,J+2},D.prototype.writeUint32LE=D.prototype.writeUInt32LE=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,4,4294967295,0),this[J+3]=G>>>24,this[J+2]=G>>>16,this[J+1]=G>>>8,this[J]=G&255,J+4},D.prototype.writeUint32BE=D.prototype.writeUInt32BE=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,4,4294967295,0),this[J]=G>>>24,this[J+1]=G>>>16,this[J+2]=G>>>8,this[J+3]=G&255,J+4};function Tt(Z,G,J,xe,De){be(G,xe,De,Z,J,7);let He=Number(G&BigInt(4294967295));Z[J++]=He,He=He>>8,Z[J++]=He,He=He>>8,Z[J++]=He,He=He>>8,Z[J++]=He;let wt=Number(G>>BigInt(32)&BigInt(4294967295));return Z[J++]=wt,wt=wt>>8,Z[J++]=wt,wt=wt>>8,Z[J++]=wt,wt=wt>>8,Z[J++]=wt,J}function dt(Z,G,J,xe,De){be(G,xe,De,Z,J,7);let He=Number(G&BigInt(4294967295));Z[J+7]=He,He=He>>8,Z[J+6]=He,He=He>>8,Z[J+5]=He,He=He>>8,Z[J+4]=He;let wt=Number(G>>BigInt(32)&BigInt(4294967295));return Z[J+3]=wt,wt=wt>>8,Z[J+2]=wt,wt=wt>>8,Z[J+1]=wt,wt=wt>>8,Z[J]=wt,J+8}D.prototype.writeBigUInt64LE=Ct(function(G,J=0){return Tt(this,G,J,BigInt(0),BigInt("0xffffffffffffffff"))}),D.prototype.writeBigUInt64BE=Ct(function(G,J=0){return dt(this,G,J,BigInt(0),BigInt("0xffffffffffffffff"))}),D.prototype.writeIntLE=function(G,J,xe,De){if(G=+G,J=J>>>0,!De){const On=Math.pow(2,8*xe-1);lt(this,G,J,xe,On-1,-On)}let He=0,wt=1,Qt=0;for(this[J]=G&255;++He<xe&&(wt*=256);)G<0&&Qt===0&&this[J+He-1]!==0&&(Qt=1),this[J+He]=(G/wt>>0)-Qt&255;return J+xe},D.prototype.writeIntBE=function(G,J,xe,De){if(G=+G,J=J>>>0,!De){const On=Math.pow(2,8*xe-1);lt(this,G,J,xe,On-1,-On)}let He=xe-1,wt=1,Qt=0;for(this[J+He]=G&255;--He>=0&&(wt*=256);)G<0&&Qt===0&&this[J+He+1]!==0&&(Qt=1),this[J+He]=(G/wt>>0)-Qt&255;return J+xe},D.prototype.writeInt8=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,1,127,-128),G<0&&(G=255+G+1),this[J]=G&255,J+1},D.prototype.writeInt16LE=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,2,32767,-32768),this[J]=G&255,this[J+1]=G>>>8,J+2},D.prototype.writeInt16BE=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,2,32767,-32768),this[J]=G>>>8,this[J+1]=G&255,J+2},D.prototype.writeInt32LE=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,4,2147483647,-2147483648),this[J]=G&255,this[J+1]=G>>>8,this[J+2]=G>>>16,this[J+3]=G>>>24,J+4},D.prototype.writeInt32BE=function(G,J,xe){return G=+G,J=J>>>0,xe||lt(this,G,J,4,2147483647,-2147483648),G<0&&(G=4294967295+G+1),this[J]=G>>>24,this[J+1]=G>>>16,this[J+2]=G>>>8,this[J+3]=G&255,J+4},D.prototype.writeBigInt64LE=Ct(function(G,J=0){return Tt(this,G,J,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))}),D.prototype.writeBigInt64BE=Ct(function(G,J=0){return dt(this,G,J,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function Pt(Z,G,J,xe,De,He){if(J+xe>Z.length)throw new RangeError("Index out of range");if(J<0)throw new RangeError("Index out of range")}function qt(Z,G,J,xe,De){return G=+G,J=J>>>0,De||Pt(Z,G,J,4),k.write(Z,G,J,xe,23,4),J+4}D.prototype.writeFloatLE=function(G,J,xe){return qt(this,G,J,!0,xe)},D.prototype.writeFloatBE=function(G,J,xe){return qt(this,G,J,!1,xe)};function Ft(Z,G,J,xe,De){return G=+G,J=J>>>0,De||Pt(Z,G,J,8),k.write(Z,G,J,xe,52,8),J+8}D.prototype.writeDoubleLE=function(G,J,xe){return Ft(this,G,J,!0,xe)},D.prototype.writeDoubleBE=function(G,J,xe){return Ft(this,G,J,!1,xe)},D.prototype.copy=function(G,J,xe,De){if(!D.isBuffer(G))throw new TypeError("argument should be a Buffer");if(xe||(xe=0),!De&&De!==0&&(De=this.length),J>=G.length&&(J=G.length),J||(J=0),De>0&&De<xe&&(De=xe),De===xe||G.length===0||this.length===0)return 0;if(J<0)throw new RangeError("targetStart out of bounds");if(xe<0||xe>=this.length)throw new RangeError("Index out of range");if(De<0)throw new RangeError("sourceEnd out of bounds");De>this.length&&(De=this.length),G.length-J<De-xe&&(De=G.length-J+xe);const He=De-xe;return this===G&&typeof A.prototype.copyWithin=="function"?this.copyWithin(J,xe,De):A.prototype.set.call(G,this.subarray(xe,De),J),He},D.prototype.fill=function(G,J,xe,De){if(typeof G=="string"){if(typeof J=="string"?(De=J,J=0,xe=this.length):typeof xe=="string"&&(De=xe,xe=this.length),De!==void 0&&typeof De!="string")throw new TypeError("encoding must be a string");if(typeof De=="string"&&!D.isEncoding(De))throw new TypeError("Unknown encoding: "+De);if(G.length===1){const wt=G.charCodeAt(0);(De==="utf8"&&wt<128||De==="latin1")&&(G=wt)}}else typeof G=="number"?G=G&255:typeof G=="boolean"&&(G=Number(G));if(J<0||this.length<J||this.length<xe)throw new RangeError("Out of range index");if(xe<=J)return this;J=J>>>0,xe=xe===void 0?this.length:xe>>>0,G||(G=0);let He;if(typeof G=="number")for(He=J;He<xe;++He)this[He]=G;else{const wt=D.isBuffer(G)?G:D.from(G,De),Qt=wt.length;if(Qt===0)throw new TypeError('The value "'+G+'" is invalid for argument "value"');for(He=0;He<xe-J;++He)this[He+J]=wt[He%Qt]}return this};const Ht={};function we(Z,G,J){Ht[Z]=class extends J{constructor(){super(),Object.defineProperty(this,"message",{value:G.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${Z}]`,this.stack,delete this.name}get code(){return Z}set code(De){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:De,writable:!0})}toString(){return`${this.name} [${Z}]: ${this.message}`}}}we("ERR_BUFFER_OUT_OF_BOUNDS",function(Z){return Z?`${Z} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError),we("ERR_INVALID_ARG_TYPE",function(Z,G){return`The "${Z}" argument must be of type number. Received type ${typeof G}`},TypeError),we("ERR_OUT_OF_RANGE",function(Z,G,J){let xe=`The value of "${Z}" is out of range.`,De=J;return Number.isInteger(J)&&Math.abs(J)>2**32?De=F(String(J)):typeof J=="bigint"&&(De=String(J),(J>BigInt(2)**BigInt(32)||J<-(BigInt(2)**BigInt(32)))&&(De=F(De)),De+="n"),xe+=` It must be ${G}. Received ${De}`,xe},RangeError);function F(Z){let G="",J=Z.length;const xe=Z[0]==="-"?1:0;for(;J>=xe+4;J-=3)G=`_${Z.slice(J-3,J)}${G}`;return`${Z.slice(0,J)}${G}`}function X(Z,G,J){ke(G,"offset"),(Z[G]===void 0||Z[G+J]===void 0)&&ge(G,Z.length-(J+1))}function be(Z,G,J,xe,De,He){if(Z>J||Z<G){const wt=typeof G=="bigint"?"n":"";let Qt;throw G===0||G===BigInt(0)?Qt=`>= 0${wt} and < 2${wt} ** ${(He+1)*8}${wt}`:Qt=`>= -(2${wt} ** ${(He+1)*8-1}${wt}) and < 2 ** ${(He+1)*8-1}${wt}`,new Ht.ERR_OUT_OF_RANGE("value",Qt,Z)}X(xe,De,He)}function ke(Z,G){if(typeof Z!="number")throw new Ht.ERR_INVALID_ARG_TYPE(G,"number",Z)}function ge(Z,G,J){throw Math.floor(Z)!==Z?(ke(Z,J),new Ht.ERR_OUT_OF_RANGE("offset","an integer",Z)):G<0?new Ht.ERR_BUFFER_OUT_OF_BOUNDS:new Ht.ERR_OUT_OF_RANGE("offset",`>= 0 and <= ${G}`,Z)}const Ee=/[^+/0-9A-Za-z-_]/g;function le(Z){if(Z=Z.split("=")[0],Z=Z.trim().replace(Ee,""),Z.length<2)return"";for(;Z.length%4!==0;)Z=Z+"=";return Z}function ft(Z,G){G=G||1/0;let J;const xe=Z.length;let De=null;const He=[];for(let wt=0;wt<xe;++wt){if(J=Z.charCodeAt(wt),J>55295&&J<57344){if(!De){if(J>56319){(G-=3)>-1&&He.push(239,191,189);continue}else if(wt+1===xe){(G-=3)>-1&&He.push(239,191,189);continue}De=J;continue}if(J<56320){(G-=3)>-1&&He.push(239,191,189),De=J;continue}J=(De-55296<<10|J-56320)+65536}else De&&(G-=3)>-1&&He.push(239,191,189);if(De=null,J<128){if((G-=1)<0)break;He.push(J)}else if(J<2048){if((G-=2)<0)break;He.push(J>>6|192,J&63|128)}else if(J<65536){if((G-=3)<0)break;He.push(J>>12|224,J>>6&63|128,J&63|128)}else if(J<1114112){if((G-=4)<0)break;He.push(J>>18|240,J>>12&63|128,J>>6&63|128,J&63|128)}else throw new Error("Invalid code point")}return He}function et(Z){const G=[];for(let J=0;J<Z.length;++J)G.push(Z.charCodeAt(J)&255);return G}function $(Z,G){let J,xe,De;const He=[];for(let wt=0;wt<Z.length&&!((G-=2)<0);++wt)J=Z.charCodeAt(wt),xe=J>>8,De=J%256,He.push(De),He.push(xe);return He}function Ue(Z){return S.toByteArray(le(Z))}function tt(Z,G,J,xe){let De;for(De=0;De<xe&&!(De+J>=G.length||De>=Z.length);++De)G[De+J]=Z[De];return De}function ve(Z,G){return Z instanceof G||Z!=null&&Z.constructor!=null&&Z.constructor.name!=null&&Z.constructor.name===G.name}function _e(Z){return Z!==Z}const ze=function(){const Z="0123456789abcdef",G=new Array(256);for(let J=0;J<16;++J){const xe=J*16;for(let De=0;De<16;++De)G[xe+De]=Z[J]+Z[De]}return G}();function Ct(Z){return typeof BigInt>"u"?fe:Z}function fe(){throw new Error("BigInt not supported")}})(t);const x=t.Buffer;e.Blob=t.Blob,e.BlobOptions=t.BlobOptions,e.Buffer=t.Buffer,e.File=t.File,e.FileOptions=t.FileOptions,e.INSPECT_MAX_BYTES=t.INSPECT_MAX_BYTES,e.SlowBuffer=t.SlowBuffer,e.TranscodeEncoding=t.TranscodeEncoding,e.atob=t.atob,e.btoa=t.btoa,e.constants=t.constants,e.default=x,e.isAscii=t.isAscii,e.isUtf8=t.isUtf8,e.kMaxLength=t.kMaxLength,e.kStringMaxLength=t.kStringMaxLength,e.resolveObjectURL=t.resolveObjectURL,e.transcode=t.transcode}(hM)),hM}var pM,n9;function ni(){if(n9)return pM;n9=1;class e extends Error{constructor(n){if(!Array.isArray(n))throw new TypeError(`Expected input to be an Array, got ${typeof n}`);let r="";for(let s=0;s<n.length;s++)r+=`    ${n[s].stack}
`;super(r),this.name="AggregateError",this.errors=n}}return pM={AggregateError:e,ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,n){return t.includes(n)},ArrayPrototypeIndexOf(t,n){return t.indexOf(n)},ArrayPrototypeJoin(t,n){return t.join(n)},ArrayPrototypeMap(t,n){return t.map(n)},ArrayPrototypePop(t,n){return t.pop(n)},ArrayPrototypePush(t,n){return t.push(n)},ArrayPrototypeSlice(t,n,r){return t.slice(n,r)},Error,FunctionPrototypeCall(t,n,...r){return t.call(n,...r)},FunctionPrototypeSymbolHasInstance(t,n){return Function.prototype[Symbol.hasInstance].call(t,n)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,n){return Object.defineProperties(t,n)},ObjectDefineProperty(t,n,r){return Object.defineProperty(t,n,r)},ObjectGetOwnPropertyDescriptor(t,n){return Object.getOwnPropertyDescriptor(t,n)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,n){return Object.setPrototypeOf(t,n)},Promise,PromisePrototypeCatch(t,n){return t.catch(n)},PromisePrototypeThen(t,n,r){return t.then(n,r)},PromiseReject(t){return Promise.reject(t)},PromiseResolve(t){return Promise.resolve(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,n){return t.test(n)},SafeSet:Set,String,StringPrototypeSlice(t,n,r){return t.slice(n,r)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(t,n,r){return t.set(n,r)},Boolean,Uint8Array},pM}var mM={exports:{}},gM,r9;function lY(){return r9||(r9=1,gM={format(e,...t){return e.replace(/%([sdifj])/g,function(...[n,r]){const s=t.shift();return r==="f"?s.toFixed(6):r==="j"?JSON.stringify(s):r==="s"&&typeof s=="object"?`${s.constructor!==Object?s.constructor.name:""} {}`.trim():s.toString()})},inspect(e){switch(typeof e){case"string":if(e.includes("'"))if(e.includes('"')){if(!e.includes("`")&&!e.includes("${"))return`\`${e}\``}else return`"${e}"`;return`'${e}'`;case"number":return isNaN(e)?"NaN":Object.is(e,-0)?String(e):e;case"bigint":return`${String(e)}n`;case"boolean":case"undefined":return String(e);case"object":return"{}"}}}),gM}var yM,s9;function go(){if(s9)return yM;s9=1;const{format:e,inspect:t}=lY(),{AggregateError:n}=ni(),r=globalThis.AggregateError||n,s=Symbol("kIsNodeError"),i=["string","function","number","object","Function","Object","boolean","bigint","symbol"],a=/^([A-Z][a-z0-9]*)+$/,o="__node_internal_",l={};function c(v,x){if(!v)throw new l.ERR_INTERNAL_ASSERTION(x)}function u(v){let x="",w=v.length;const S=v[0]==="-"?1:0;for(;w>=S+4;w-=3)x=`_${v.slice(w-3,w)}${x}`;return`${v.slice(0,w)}${x}`}function d(v,x,w){if(typeof x=="function")return c(x.length<=w.length,`Code: ${v}; The provided arguments length (${w.length}) does not match the required ones (${x.length}).`),x(...w);const S=(x.match(/%[dfijoOs]/g)||[]).length;return c(S===w.length,`Code: ${v}; The provided arguments length (${w.length}) does not match the required ones (${S}).`),w.length===0?x:e(x,...w)}function h(v,x,w){w||(w=Error);class S extends w{constructor(...C){super(d(v,x,C))}toString(){return`${this.name} [${v}]: ${this.message}`}}Object.defineProperties(S.prototype,{name:{value:w.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${v}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),S.prototype.code=v,S.prototype[s]=!0,l[v]=S}function m(v){const x=o+v.name;return Object.defineProperty(v,"name",{value:x}),v}function y(v,x){if(v&&x&&v!==x){if(Array.isArray(x.errors))return x.errors.push(v),x;const w=new r([x,v],x.message);return w.code=x.code,w}return v||x}class b extends Error{constructor(x="The operation was aborted",w=void 0){if(w!==void 0&&typeof w!="object")throw new l.ERR_INVALID_ARG_TYPE("options","Object",w);super(x,w),this.code="ABORT_ERR",this.name="AbortError"}}return h("ERR_ASSERTION","%s",Error),h("ERR_INVALID_ARG_TYPE",(v,x,w)=>{c(typeof v=="string","'name' must be a string"),Array.isArray(x)||(x=[x]);let S="The ";v.endsWith(" argument")?S+=`${v} `:S+=`"${v}" ${v.includes(".")?"property":"argument"} `,S+="must be ";const k=[],C=[],T=[];for(const N of x)c(typeof N=="string","All expected entries have to be of type string"),i.includes(N)?k.push(N.toLowerCase()):a.test(N)?C.push(N):(c(N!=="object",'The value "object" should be written as "Object"'),T.push(N));if(C.length>0){const N=k.indexOf("object");N!==-1&&(k.splice(k,N,1),C.push("Object"))}if(k.length>0){switch(k.length){case 1:S+=`of type ${k[0]}`;break;case 2:S+=`one of type ${k[0]} or ${k[1]}`;break;default:{const N=k.pop();S+=`one of type ${k.join(", ")}, or ${N}`}}(C.length>0||T.length>0)&&(S+=" or ")}if(C.length>0){switch(C.length){case 1:S+=`an instance of ${C[0]}`;break;case 2:S+=`an instance of ${C[0]} or ${C[1]}`;break;default:{const N=C.pop();S+=`an instance of ${C.join(", ")}, or ${N}`}}T.length>0&&(S+=" or ")}switch(T.length){case 0:break;case 1:T[0].toLowerCase()!==T[0]&&(S+="an "),S+=`${T[0]}`;break;case 2:S+=`one of ${T[0]} or ${T[1]}`;break;default:{const N=T.pop();S+=`one of ${T.join(", ")}, or ${N}`}}if(w==null)S+=`. Received ${w}`;else if(typeof w=="function"&&w.name)S+=`. Received function ${w.name}`;else if(typeof w=="object"){var A;if((A=w.constructor)!==null&&A!==void 0&&A.name)S+=`. Received an instance of ${w.constructor.name}`;else{const N=t(w,{depth:-1});S+=`. Received ${N}`}}else{let N=t(w,{colors:!1});N.length>25&&(N=`${N.slice(0,25)}...`),S+=`. Received type ${typeof w} (${N})`}return S},TypeError),h("ERR_INVALID_ARG_VALUE",(v,x,w="is invalid")=>{let S=t(x);return S.length>128&&(S=S.slice(0,128)+"..."),`The ${v.includes(".")?"property":"argument"} '${v}' ${w}. Received ${S}`},TypeError),h("ERR_INVALID_RETURN_VALUE",(v,x,w)=>{var S;const k=w!=null&&(S=w.constructor)!==null&&S!==void 0&&S.name?`instance of ${w.constructor.name}`:`type ${typeof w}`;return`Expected ${v} to be returned from the "${x}" function but got ${k}.`},TypeError),h("ERR_MISSING_ARGS",(...v)=>{c(v.length>0,"At least one arg needs to be specified");let x;const w=v.length;switch(v=(Array.isArray(v)?v:[v]).map(S=>`"${S}"`).join(" or "),w){case 1:x+=`The ${v[0]} argument`;break;case 2:x+=`The ${v[0]} and ${v[1]} arguments`;break;default:{const S=v.pop();x+=`The ${v.join(", ")}, and ${S} arguments`}break}return`${x} must be specified`},TypeError),h("ERR_OUT_OF_RANGE",(v,x,w)=>{c(x,'Missing "range" argument');let S;if(Number.isInteger(w)&&Math.abs(w)>2**32)S=u(String(w));else if(typeof w=="bigint"){S=String(w);const k=BigInt(2)**BigInt(32);(w>k||w<-k)&&(S=u(S)),S+="n"}else S=t(w);return`The value of "${v}" is out of range. It must be ${x}. Received ${S}`},RangeError),h("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error),h("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error),h("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error),h("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error),h("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error),h("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError),h("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error),h("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error),h("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error),h("ERR_STREAM_WRITE_AFTER_END","write after end",Error),h("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError),yM={AbortError:b,aggregateTwoErrors:m(y),hideStackFrames:m,codes:l},yM}var $v={exports:{}},i9;function gw(){if(i9)return $v.exports;i9=1;const{AbortController:e,AbortSignal:t}=typeof self<"u"?self:typeof window<"u"?window:void 0;return $v.exports=e,$v.exports.AbortSignal=t,$v.exports.default=e,$v.exports}var zS={exports:{}},a9;function JE(){if(a9)return zS.exports;a9=1;var e=typeof Reflect=="object"?Reflect:null,t=e&&typeof e.apply=="function"?e.apply:function(C,T,A){return Function.prototype.apply.call(C,T,A)},n;e&&typeof e.ownKeys=="function"?n=e.ownKeys:Object.getOwnPropertySymbols?n=function(C){return Object.getOwnPropertyNames(C).concat(Object.getOwnPropertySymbols(C))}:n=function(C){return Object.getOwnPropertyNames(C)};function r(k){console&&console.warn&&console.warn(k)}var s=Number.isNaN||function(C){return C!==C};function i(){i.init.call(this)}zS.exports=i,zS.exports.once=x,i.EventEmitter=i,i.prototype._events=void 0,i.prototype._eventsCount=0,i.prototype._maxListeners=void 0;var a=10;function o(k){if(typeof k!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof k)}Object.defineProperty(i,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(k){if(typeof k!="number"||k<0||s(k))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+k+".");a=k}}),i.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},i.prototype.setMaxListeners=function(C){if(typeof C!="number"||C<0||s(C))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+C+".");return this._maxListeners=C,this};function l(k){return k._maxListeners===void 0?i.defaultMaxListeners:k._maxListeners}i.prototype.getMaxListeners=function(){return l(this)},i.prototype.emit=function(C){for(var T=[],A=1;A<arguments.length;A++)T.push(arguments[A]);var N=C==="error",I=this._events;if(I!==void 0)N=N&&I.error===void 0;else if(!N)return!1;if(N){var O;if(T.length>0&&(O=T[0]),O instanceof Error)throw O;var B=new Error("Unhandled error."+(O?" ("+O.message+")":""));throw B.context=O,B}var D=I[C];if(D===void 0)return!1;if(typeof D=="function")t(D,this,T);else for(var H=D.length,P=y(D,H),A=0;A<H;++A)t(P[A],this,T);return!0};function c(k,C,T,A){var N,I,O;if(o(T),I=k._events,I===void 0?(I=k._events=Object.create(null),k._eventsCount=0):(I.newListener!==void 0&&(k.emit("newListener",C,T.listener?T.listener:T),I=k._events),O=I[C]),O===void 0)O=I[C]=T,++k._eventsCount;else if(typeof O=="function"?O=I[C]=A?[T,O]:[O,T]:A?O.unshift(T):O.push(T),N=l(k),N>0&&O.length>N&&!O.warned){O.warned=!0;var B=new Error("Possible EventEmitter memory leak detected. "+O.length+" "+String(C)+" listeners added. Use emitter.setMaxListeners() to increase limit");B.name="MaxListenersExceededWarning",B.emitter=k,B.type=C,B.count=O.length,r(B)}return k}i.prototype.addListener=function(C,T){return c(this,C,T,!1)},i.prototype.on=i.prototype.addListener,i.prototype.prependListener=function(C,T){return c(this,C,T,!0)};function u(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(k,C,T){var A={fired:!1,wrapFn:void 0,target:k,type:C,listener:T},N=u.bind(A);return N.listener=T,A.wrapFn=N,N}i.prototype.once=function(C,T){return o(T),this.on(C,d(this,C,T)),this},i.prototype.prependOnceListener=function(C,T){return o(T),this.prependListener(C,d(this,C,T)),this},i.prototype.removeListener=function(C,T){var A,N,I,O,B;if(o(T),N=this._events,N===void 0)return this;if(A=N[C],A===void 0)return this;if(A===T||A.listener===T)--this._eventsCount===0?this._events=Object.create(null):(delete N[C],N.removeListener&&this.emit("removeListener",C,A.listener||T));else if(typeof A!="function"){for(I=-1,O=A.length-1;O>=0;O--)if(A[O]===T||A[O].listener===T){B=A[O].listener,I=O;break}if(I<0)return this;I===0?A.shift():b(A,I),A.length===1&&(N[C]=A[0]),N.removeListener!==void 0&&this.emit("removeListener",C,B||T)}return this},i.prototype.off=i.prototype.removeListener,i.prototype.removeAllListeners=function(C){var T,A,N;if(A=this._events,A===void 0)return this;if(A.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):A[C]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete A[C]),this;if(arguments.length===0){var I=Object.keys(A),O;for(N=0;N<I.length;++N)O=I[N],O!=="removeListener"&&this.removeAllListeners(O);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(T=A[C],typeof T=="function")this.removeListener(C,T);else if(T!==void 0)for(N=T.length-1;N>=0;N--)this.removeListener(C,T[N]);return this};function h(k,C,T){var A=k._events;if(A===void 0)return[];var N=A[C];return N===void 0?[]:typeof N=="function"?T?[N.listener||N]:[N]:T?v(N):y(N,N.length)}i.prototype.listeners=function(C){return h(this,C,!0)},i.prototype.rawListeners=function(C){return h(this,C,!1)},i.listenerCount=function(k,C){return typeof k.listenerCount=="function"?k.listenerCount(C):m.call(k,C)},i.prototype.listenerCount=m;function m(k){var C=this._events;if(C!==void 0){var T=C[k];if(typeof T=="function")return 1;if(T!==void 0)return T.length}return 0}i.prototype.eventNames=function(){return this._eventsCount>0?n(this._events):[]};function y(k,C){for(var T=new Array(C),A=0;A<C;++A)T[A]=k[A];return T}function b(k,C){for(;C+1<k.length;C++)k[C]=k[C+1];k.pop()}function v(k){for(var C=new Array(k.length),T=0;T<C.length;++T)C[T]=k[T].listener||k[T];return C}function x(k,C){return new Promise(function(T,A){function N(O){k.removeListener(C,I),A(O)}function I(){typeof k.removeListener=="function"&&k.removeListener("error",N),T([].slice.call(arguments))}S(k,C,I,{once:!0}),C!=="error"&&w(k,N,{once:!0})})}function w(k,C,T){typeof k.on=="function"&&S(k,"error",C,T)}function S(k,C,T,A){if(typeof k.on=="function")A.once?k.once(C,T):k.on(C,T);else if(typeof k.addEventListener=="function")k.addEventListener(C,function N(I){A.once&&k.removeEventListener(C,N),T(I)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof k)}return zS.exports}var o9;function Oo(){return o9||(o9=1,function(e){const t=rp(),{format:n,inspect:r}=lY(),{codes:{ERR_INVALID_ARG_TYPE:s}}=go(),{kResistStopPropagation:i,AggregateError:a,SymbolDispose:o}=ni(),l=globalThis.AbortSignal||gw().AbortSignal,c=globalThis.AbortController||gw().AbortController,u=Object.getPrototypeOf(async function(){}).constructor,d=globalThis.Blob||t.Blob,h=typeof d<"u"?function(v){return v instanceof d}:function(v){return!1},m=(b,v)=>{if(b!==void 0&&(b===null||typeof b!="object"||!("aborted"in b)))throw new s(v,"AbortSignal",b)},y=(b,v)=>{if(typeof b!="function")throw new s(v,"Function",b)};e.exports={AggregateError:a,kEmptyObject:Object.freeze({}),once(b){let v=!1;return function(...x){v||(v=!0,b.apply(this,x))}},createDeferredPromise:function(){let b,v;return{promise:new Promise((w,S)=>{b=w,v=S}),resolve:b,reject:v}},promisify(b){return new Promise((v,x)=>{b((w,...S)=>w?x(w):v(...S))})},debuglog(){return function(){}},format:n,inspect:r,types:{isAsyncFunction(b){return b instanceof u},isArrayBufferView(b){return ArrayBuffer.isView(b)}},isBlob:h,deprecate(b,v){return b},addAbortListener:JE().addAbortListener||function(v,x){if(v===void 0)throw new s("signal","AbortSignal",v);m(v,"signal"),y(x,"listener");let w;return v.aborted?queueMicrotask(()=>x()):(v.addEventListener("abort",x,{__proto__:null,once:!0,[i]:!0}),w=()=>{v.removeEventListener("abort",x)}),{__proto__:null,[o](){var S;(S=w)===null||S===void 0||S()}}},AbortSignalAny:l.any||function(v){if(v.length===1)return v[0];const x=new c,w=()=>x.abort();return v.forEach(S=>{m(S,"signals"),S.addEventListener("abort",w,{once:!0})}),x.signal.addEventListener("abort",()=>{v.forEach(S=>S.removeEventListener("abort",w))},{once:!0}),x.signal}},e.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")}(mM)),mM.exports}var US={},bM,l9;function A1(){if(l9)return bM;l9=1;const{ArrayIsArray:e,ArrayPrototypeIncludes:t,ArrayPrototypeJoin:n,ArrayPrototypeMap:r,NumberIsInteger:s,NumberIsNaN:i,NumberMAX_SAFE_INTEGER:a,NumberMIN_SAFE_INTEGER:o,NumberParseInt:l,ObjectPrototypeHasOwnProperty:c,RegExpPrototypeExec:u,String:d,StringPrototypeToUpperCase:h,StringPrototypeTrim:m}=ni(),{hideStackFrames:y,codes:{ERR_SOCKET_BAD_PORT:b,ERR_INVALID_ARG_TYPE:v,ERR_INVALID_ARG_VALUE:x,ERR_OUT_OF_RANGE:w,ERR_UNKNOWN_SIGNAL:S}}=go(),{normalizeEncoding:k}=Oo(),{isAsyncFunction:C,isArrayBufferView:T}=Oo().types,A={};function N(se){return se===(se|0)}function I(se){return se===se>>>0}const O=/^[0-7]+$/,B="must be a 32-bit unsigned integer or an octal string";function D(se,Me,Be){if(typeof se>"u"&&(se=Be),typeof se=="string"){if(u(O,se)===null)throw new x(Me,se,B);se=l(se,8)}return K(se,Me),se}const H=y((se,Me,Be=o,Ae=a)=>{if(typeof se!="number")throw new v(Me,"number",se);if(!s(se))throw new w(Me,"an integer",se);if(se<Be||se>Ae)throw new w(Me,`>= ${Be} && <= ${Ae}`,se)}),P=y((se,Me,Be=-2147483648,Ae=2147483647)=>{if(typeof se!="number")throw new v(Me,"number",se);if(!s(se))throw new w(Me,"an integer",se);if(se<Be||se>Ae)throw new w(Me,`>= ${Be} && <= ${Ae}`,se)}),K=y((se,Me,Be=!1)=>{if(typeof se!="number")throw new v(Me,"number",se);if(!s(se))throw new w(Me,"an integer",se);const Ae=Be?1:0,lt=4294967295;if(se<Ae||se>lt)throw new w(Me,`>= ${Ae} && <= ${lt}`,se)});function U(se,Me){if(typeof se!="string")throw new v(Me,"string",se)}function V(se,Me,Be=void 0,Ae){if(typeof se!="number")throw new v(Me,"number",se);if(Be!=null&&se<Be||Ae!=null&&se>Ae||(Be!=null||Ae!=null)&&i(se))throw new w(Me,`${Be!=null?`>= ${Be}`:""}${Be!=null&&Ae!=null?" && ":""}${Ae!=null?`<= ${Ae}`:""}`,se)}const L=y((se,Me,Be)=>{if(!t(Be,se)){const lt="must be one of: "+n(r(Be,Tt=>typeof Tt=="string"?`'${Tt}'`:d(Tt)),", ");throw new x(Me,se,lt)}});function te(se,Me){if(typeof se!="boolean")throw new v(Me,"boolean",se)}function W(se,Me,Be){return se==null||!c(se,Me)?Be:se[Me]}const Q=y((se,Me,Be=null)=>{const Ae=W(Be,"allowArray",!1),lt=W(Be,"allowFunction",!1);if(!W(Be,"nullable",!1)&&se===null||!Ae&&e(se)||typeof se!="object"&&(!lt||typeof se!="function"))throw new v(Me,"Object",se)}),ee=y((se,Me)=>{if(se!=null&&typeof se!="object"&&typeof se!="function")throw new v(Me,"a dictionary",se)}),re=y((se,Me,Be=0)=>{if(!e(se))throw new v(Me,"Array",se);if(se.length<Be){const Ae=`must be longer than ${Be}`;throw new x(Me,se,Ae)}});function pe(se,Me){re(se,Me);for(let Be=0;Be<se.length;Be++)U(se[Be],`${Me}[${Be}]`)}function de(se,Me){re(se,Me);for(let Be=0;Be<se.length;Be++)te(se[Be],`${Me}[${Be}]`)}function Oe(se,Me){re(se,Me);for(let Be=0;Be<se.length;Be++){const Ae=se[Be],lt=`${Me}[${Be}]`;if(Ae==null)throw new v(lt,"AbortSignal",Ae);Qe(Ae,lt)}}function Fe(se,Me="signal"){if(U(se,Me),A[se]===void 0)throw A[h(se)]!==void 0?new S(se+" (signals must use all capital letters)"):new S(se)}const Se=y((se,Me="buffer")=>{if(!T(se))throw new v(Me,["Buffer","TypedArray","DataView"],se)});function Ce(se,Me){const Be=k(Me),Ae=se.length;if(Be==="hex"&&Ae%2!==0)throw new x("encoding",Me,`is invalid for data of length ${Ae}`)}function qe(se,Me="Port",Be=!0){if(typeof se!="number"&&typeof se!="string"||typeof se=="string"&&m(se).length===0||+se!==+se>>>0||se>65535||se===0&&!Be)throw new b(Me,se,Be);return se|0}const Qe=y((se,Me)=>{if(se!==void 0&&(se===null||typeof se!="object"||!("aborted"in se)))throw new v(Me,"AbortSignal",se)}),We=y((se,Me)=>{if(typeof se!="function")throw new v(Me,"Function",se)}),je=y((se,Me)=>{if(typeof se!="function"||C(se))throw new v(Me,"Function",se)}),Y=y((se,Me)=>{if(se!==void 0)throw new v(Me,"undefined",se)});function ye(se,Me,Be){if(!t(Be,se))throw new v(Me,`('${n(Be,"|")}')`,se)}const Ie=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function ce(se,Me){if(typeof se>"u"||!u(Ie,se))throw new x(Me,se,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function oe(se){if(typeof se=="string")return ce(se,"hints"),se;if(e(se)){const Me=se.length;let Be="";if(Me===0)return Be;for(let Ae=0;Ae<Me;Ae++){const lt=se[Ae];ce(lt,"hints"),Be+=lt,Ae!==Me-1&&(Be+=", ")}return Be}throw new x("hints",se,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}return bM={isInt32:N,isUint32:I,parseFileMode:D,validateArray:re,validateStringArray:pe,validateBooleanArray:de,validateAbortSignalArray:Oe,validateBoolean:te,validateBuffer:Se,validateDictionary:ee,validateEncoding:Ce,validateFunction:We,validateInt32:P,validateInteger:H,validateNumber:V,validateObject:Q,validateOneOf:L,validatePlainFunction:je,validatePort:qe,validateSignalName:Fe,validateString:U,validateUint32:K,validateUndefined:Y,validateUnion:ye,validateAbortSignal:Qe,validateLinkHeaderValue:oe},bM}var qS={exports:{}},vM={},c9;function tg(){return c9||(c9=1,function(e){Object.defineProperties(e,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}});function t(k){return k&&k.__esModule&&Object.prototype.hasOwnProperty.call(k,"default")?k.default:k}var n={exports:{}},r=n.exports={},s,i;function a(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?s=setTimeout:s=a}catch{s=a}try{typeof clearTimeout=="function"?i=clearTimeout:i=o}catch{i=o}})();function l(k){if(s===setTimeout)return setTimeout(k,0);if((s===a||!s)&&setTimeout)return s=setTimeout,setTimeout(k,0);try{return s(k,0)}catch{try{return s.call(null,k,0)}catch{return s.call(this,k,0)}}}function c(k){if(i===clearTimeout)return clearTimeout(k);if((i===o||!i)&&clearTimeout)return i=clearTimeout,clearTimeout(k);try{return i(k)}catch{try{return i.call(null,k)}catch{return i.call(this,k)}}}var u=[],d=!1,h,m=-1;function y(){!d||!h||(d=!1,h.length?u=h.concat(u):m=-1,u.length&&b())}function b(){if(!d){var k=l(y);d=!0;for(var C=u.length;C;){for(h=u,u=[];++m<C;)h&&h[m].run();m=-1,C=u.length}h=null,d=!1,c(k)}}r.nextTick=function(k){var C=new Array(arguments.length-1);if(arguments.length>1)for(var T=1;T<arguments.length;T++)C[T-1]=arguments[T];u.push(new v(k,C)),u.length===1&&!d&&l(b)};function v(k,C){this.fun=k,this.array=C}v.prototype.run=function(){this.fun.apply(null,this.array)},r.title="browser",r.browser=!0,r.env={},r.argv=[],r.version="",r.versions={};function x(){}r.on=x,r.addListener=x,r.once=x,r.off=x,r.removeListener=x,r.removeAllListeners=x,r.emit=x,r.prependListener=x,r.prependOnceListener=x,r.listeners=function(k){return[]},r.binding=function(k){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(k){throw new Error("process.chdir is not supported")},r.umask=function(){return 0};var w=n.exports;const S=t(w);e.default=S,e.process=S}(vM)),vM}var xM,u9;function of(){if(u9)return xM;u9=1;const{SymbolAsyncIterator:e,SymbolIterator:t,SymbolFor:n}=ni(),r=n("nodejs.stream.destroyed"),s=n("nodejs.stream.errored"),i=n("nodejs.stream.readable"),a=n("nodejs.stream.writable"),o=n("nodejs.stream.disturbed"),l=n("nodejs.webstream.isClosedPromise"),c=n("nodejs.webstream.controllerErrorFunction");function u(W,Q=!1){var ee;return!!(W&&typeof W.pipe=="function"&&typeof W.on=="function"&&(!Q||typeof W.pause=="function"&&typeof W.resume=="function")&&(!W._writableState||((ee=W._readableState)===null||ee===void 0?void 0:ee.readable)!==!1)&&(!W._writableState||W._readableState))}function d(W){var Q;return!!(W&&typeof W.write=="function"&&typeof W.on=="function"&&(!W._readableState||((Q=W._writableState)===null||Q===void 0?void 0:Q.writable)!==!1))}function h(W){return!!(W&&typeof W.pipe=="function"&&W._readableState&&typeof W.on=="function"&&typeof W.write=="function")}function m(W){return W&&(W._readableState||W._writableState||typeof W.write=="function"&&typeof W.on=="function"||typeof W.pipe=="function"&&typeof W.on=="function")}function y(W){return!!(W&&!m(W)&&typeof W.pipeThrough=="function"&&typeof W.getReader=="function"&&typeof W.cancel=="function")}function b(W){return!!(W&&!m(W)&&typeof W.getWriter=="function"&&typeof W.abort=="function")}function v(W){return!!(W&&!m(W)&&typeof W.readable=="object"&&typeof W.writable=="object")}function x(W){return y(W)||b(W)||v(W)}function w(W,Q){return W==null?!1:Q===!0?typeof W[e]=="function":Q===!1?typeof W[t]=="function":typeof W[e]=="function"||typeof W[t]=="function"}function S(W){if(!m(W))return null;const Q=W._writableState,ee=W._readableState,re=Q||ee;return!!(W.destroyed||W[r]||re!=null&&re.destroyed)}function k(W){if(!d(W))return null;if(W.writableEnded===!0)return!0;const Q=W._writableState;return Q!=null&&Q.errored?!1:typeof(Q==null?void 0:Q.ended)!="boolean"?null:Q.ended}function C(W,Q){if(!d(W))return null;if(W.writableFinished===!0)return!0;const ee=W._writableState;return ee!=null&&ee.errored?!1:typeof(ee==null?void 0:ee.finished)!="boolean"?null:!!(ee.finished||Q===!1&&ee.ended===!0&&ee.length===0)}function T(W){if(!u(W))return null;if(W.readableEnded===!0)return!0;const Q=W._readableState;return!Q||Q.errored?!1:typeof(Q==null?void 0:Q.ended)!="boolean"?null:Q.ended}function A(W,Q){if(!u(W))return null;const ee=W._readableState;return ee!=null&&ee.errored?!1:typeof(ee==null?void 0:ee.endEmitted)!="boolean"?null:!!(ee.endEmitted||Q===!1&&ee.ended===!0&&ee.length===0)}function N(W){return W&&W[i]!=null?W[i]:typeof(W==null?void 0:W.readable)!="boolean"?null:S(W)?!1:u(W)&&W.readable&&!A(W)}function I(W){return W&&W[a]!=null?W[a]:typeof(W==null?void 0:W.writable)!="boolean"?null:S(W)?!1:d(W)&&W.writable&&!k(W)}function O(W,Q){return m(W)?S(W)?!0:!((Q==null?void 0:Q.readable)!==!1&&N(W)||(Q==null?void 0:Q.writable)!==!1&&I(W)):null}function B(W){var Q,ee;return m(W)?W.writableErrored?W.writableErrored:(Q=(ee=W._writableState)===null||ee===void 0?void 0:ee.errored)!==null&&Q!==void 0?Q:null:null}function D(W){var Q,ee;return m(W)?W.readableErrored?W.readableErrored:(Q=(ee=W._readableState)===null||ee===void 0?void 0:ee.errored)!==null&&Q!==void 0?Q:null:null}function H(W){if(!m(W))return null;if(typeof W.closed=="boolean")return W.closed;const Q=W._writableState,ee=W._readableState;return typeof(Q==null?void 0:Q.closed)=="boolean"||typeof(ee==null?void 0:ee.closed)=="boolean"?(Q==null?void 0:Q.closed)||(ee==null?void 0:ee.closed):typeof W._closed=="boolean"&&P(W)?W._closed:null}function P(W){return typeof W._closed=="boolean"&&typeof W._defaultKeepAlive=="boolean"&&typeof W._removedConnection=="boolean"&&typeof W._removedContLen=="boolean"}function K(W){return typeof W._sent100=="boolean"&&P(W)}function U(W){var Q;return typeof W._consuming=="boolean"&&typeof W._dumped=="boolean"&&((Q=W.req)===null||Q===void 0?void 0:Q.upgradeOrConnect)===void 0}function V(W){if(!m(W))return null;const Q=W._writableState,ee=W._readableState,re=Q||ee;return!re&&K(W)||!!(re&&re.autoDestroy&&re.emitClose&&re.closed===!1)}function L(W){var Q;return!!(W&&((Q=W[o])!==null&&Q!==void 0?Q:W.readableDidRead||W.readableAborted))}function te(W){var Q,ee,re,pe,de,Oe,Fe,Se,Ce,qe;return!!(W&&((Q=(ee=(re=(pe=(de=(Oe=W[s])!==null&&Oe!==void 0?Oe:W.readableErrored)!==null&&de!==void 0?de:W.writableErrored)!==null&&pe!==void 0?pe:(Fe=W._readableState)===null||Fe===void 0?void 0:Fe.errorEmitted)!==null&&re!==void 0?re:(Se=W._writableState)===null||Se===void 0?void 0:Se.errorEmitted)!==null&&ee!==void 0?ee:(Ce=W._readableState)===null||Ce===void 0?void 0:Ce.errored)!==null&&Q!==void 0?Q:!((qe=W._writableState)===null||qe===void 0)&&qe.errored))}return xM={isDestroyed:S,kIsDestroyed:r,isDisturbed:L,kIsDisturbed:o,isErrored:te,kIsErrored:s,isReadable:N,kIsReadable:i,kIsClosedPromise:l,kControllerErrorFunction:c,kIsWritable:a,isClosed:H,isDuplexNodeStream:h,isFinished:O,isIterable:w,isReadableNodeStream:u,isReadableStream:y,isReadableEnded:T,isReadableFinished:A,isReadableErrored:D,isNodeStream:m,isWebStream:x,isWritable:I,isWritableNodeStream:d,isWritableStream:b,isWritableEnded:k,isWritableFinished:C,isWritableErrored:B,isServerRequest:U,isServerResponse:K,willEmitClose:V,isTransformStream:v},xM}var d9;function sp(){if(d9)return qS.exports;d9=1;const e=tg(),{AbortError:t,codes:n}=go(),{ERR_INVALID_ARG_TYPE:r,ERR_STREAM_PREMATURE_CLOSE:s}=n,{kEmptyObject:i,once:a}=Oo(),{validateAbortSignal:o,validateFunction:l,validateObject:c,validateBoolean:u}=A1(),{Promise:d,PromisePrototypeThen:h,SymbolDispose:m}=ni(),{isClosed:y,isReadable:b,isReadableNodeStream:v,isReadableStream:x,isReadableFinished:w,isReadableErrored:S,isWritable:k,isWritableNodeStream:C,isWritableStream:T,isWritableFinished:A,isWritableErrored:N,isNodeStream:I,willEmitClose:O,kIsClosedPromise:B}=of();let D;function H(L){return L.setHeader&&typeof L.abort=="function"}const P=()=>{};function K(L,te,W){var Q,ee;if(arguments.length===2?(W=te,te=i):te==null?te=i:c(te,"options"),l(W,"callback"),o(te.signal,"options.signal"),W=a(W),x(L)||T(L))return U(L,te,W);if(!I(L))throw new r("stream",["ReadableStream","WritableStream","Stream"],L);const re=(Q=te.readable)!==null&&Q!==void 0?Q:v(L),pe=(ee=te.writable)!==null&&ee!==void 0?ee:C(L),de=L._writableState,Oe=L._readableState,Fe=()=>{L.writable||qe()};let Se=O(L)&&v(L)===re&&C(L)===pe,Ce=A(L,!1);const qe=()=>{Ce=!0,L.destroyed&&(Se=!1),!(Se&&(!L.readable||re))&&(!re||Qe)&&W.call(L)};let Qe=w(L,!1);const We=()=>{Qe=!0,L.destroyed&&(Se=!1),!(Se&&(!L.writable||pe))&&(!pe||Ce)&&W.call(L)},je=se=>{W.call(L,se)};let Y=y(L);const ye=()=>{Y=!0;const se=N(L)||S(L);if(se&&typeof se!="boolean")return W.call(L,se);if(re&&!Qe&&v(L,!0)&&!w(L,!1))return W.call(L,new s);if(pe&&!Ce&&!A(L,!1))return W.call(L,new s);W.call(L)},Ie=()=>{Y=!0;const se=N(L)||S(L);if(se&&typeof se!="boolean")return W.call(L,se);W.call(L)},ce=()=>{L.req.on("finish",qe)};H(L)?(L.on("complete",qe),Se||L.on("abort",ye),L.req?ce():L.on("request",ce)):pe&&!de&&(L.on("end",Fe),L.on("close",Fe)),!Se&&typeof L.aborted=="boolean"&&L.on("aborted",ye),L.on("end",We),L.on("finish",qe),te.error!==!1&&L.on("error",je),L.on("close",ye),Y?e.nextTick(ye):de!=null&&de.errorEmitted||Oe!=null&&Oe.errorEmitted?Se||e.nextTick(Ie):(!re&&(!Se||b(L))&&(Ce||k(L)===!1)||!pe&&(!Se||k(L))&&(Qe||b(L)===!1)||Oe&&L.req&&L.aborted)&&e.nextTick(Ie);const oe=()=>{W=P,L.removeListener("aborted",ye),L.removeListener("complete",qe),L.removeListener("abort",ye),L.removeListener("request",ce),L.req&&L.req.removeListener("finish",qe),L.removeListener("end",Fe),L.removeListener("close",Fe),L.removeListener("finish",qe),L.removeListener("end",We),L.removeListener("error",je),L.removeListener("close",ye)};if(te.signal&&!Y){const se=()=>{const Me=W;oe(),Me.call(L,new t(void 0,{cause:te.signal.reason}))};if(te.signal.aborted)e.nextTick(se);else{D=D||Oo().addAbortListener;const Me=D(te.signal,se),Be=W;W=a((...Ae)=>{Me[m](),Be.apply(L,Ae)})}}return oe}function U(L,te,W){let Q=!1,ee=P;if(te.signal)if(ee=()=>{Q=!0,W.call(L,new t(void 0,{cause:te.signal.reason}))},te.signal.aborted)e.nextTick(ee);else{D=D||Oo().addAbortListener;const pe=D(te.signal,ee),de=W;W=a((...Oe)=>{pe[m](),de.apply(L,Oe)})}const re=(...pe)=>{Q||e.nextTick(()=>W.apply(L,pe))};return h(L[B].promise,re,re),P}function V(L,te){var W;let Q=!1;return te===null&&(te=i),(W=te)!==null&&W!==void 0&&W.cleanup&&(u(te.cleanup,"cleanup"),Q=te.cleanup),new d((ee,re)=>{const pe=K(L,te,de=>{Q&&pe(),de?re(de):ee()})})}return qS.exports=K,qS.exports.finished=V,qS.exports}var wM,f9;function tb(){if(f9)return wM;f9=1;const e=tg(),{aggregateTwoErrors:t,codes:{ERR_MULTIPLE_CALLBACK:n},AbortError:r}=go(),{Symbol:s}=ni(),{kIsDestroyed:i,isDestroyed:a,isFinished:o,isServerRequest:l}=of(),c=s("kDestroy"),u=s("kConstruct");function d(O,B,D){O&&(O.stack,B&&!B.errored&&(B.errored=O),D&&!D.errored&&(D.errored=O))}function h(O,B){const D=this._readableState,H=this._writableState,P=H||D;return H!=null&&H.destroyed||D!=null&&D.destroyed?(typeof B=="function"&&B(),this):(d(O,H,D),H&&(H.destroyed=!0),D&&(D.destroyed=!0),P.constructed?m(this,O,B):this.once(c,function(K){m(this,t(K,O),B)}),this)}function m(O,B,D){let H=!1;function P(K){if(H)return;H=!0;const U=O._readableState,V=O._writableState;d(K,V,U),V&&(V.closed=!0),U&&(U.closed=!0),typeof D=="function"&&D(K),K?e.nextTick(y,O,K):e.nextTick(b,O)}try{O._destroy(B||null,P)}catch(K){P(K)}}function y(O,B){v(O,B),b(O)}function b(O){const B=O._readableState,D=O._writableState;D&&(D.closeEmitted=!0),B&&(B.closeEmitted=!0),(D!=null&&D.emitClose||B!=null&&B.emitClose)&&O.emit("close")}function v(O,B){const D=O._readableState,H=O._writableState;H!=null&&H.errorEmitted||D!=null&&D.errorEmitted||(H&&(H.errorEmitted=!0),D&&(D.errorEmitted=!0),O.emit("error",B))}function x(){const O=this._readableState,B=this._writableState;O&&(O.constructed=!0,O.closed=!1,O.closeEmitted=!1,O.destroyed=!1,O.errored=null,O.errorEmitted=!1,O.reading=!1,O.ended=O.readable===!1,O.endEmitted=O.readable===!1),B&&(B.constructed=!0,B.destroyed=!1,B.closed=!1,B.closeEmitted=!1,B.errored=null,B.errorEmitted=!1,B.finalCalled=!1,B.prefinished=!1,B.ended=B.writable===!1,B.ending=B.writable===!1,B.finished=B.writable===!1)}function w(O,B,D){const H=O._readableState,P=O._writableState;if(P!=null&&P.destroyed||H!=null&&H.destroyed)return this;H!=null&&H.autoDestroy||P!=null&&P.autoDestroy?O.destroy(B):B&&(B.stack,P&&!P.errored&&(P.errored=B),H&&!H.errored&&(H.errored=B),D?e.nextTick(v,O,B):v(O,B))}function S(O,B){if(typeof O._construct!="function")return;const D=O._readableState,H=O._writableState;D&&(D.constructed=!1),H&&(H.constructed=!1),O.once(u,B),!(O.listenerCount(u)>1)&&e.nextTick(k,O)}function k(O){let B=!1;function D(H){if(B){w(O,H??new n);return}B=!0;const P=O._readableState,K=O._writableState,U=K||P;P&&(P.constructed=!0),K&&(K.constructed=!0),U.destroyed?O.emit(c,H):H?w(O,H,!0):e.nextTick(C,O)}try{O._construct(H=>{e.nextTick(D,H)})}catch(H){e.nextTick(D,H)}}function C(O){O.emit(u)}function T(O){return(O==null?void 0:O.setHeader)&&typeof O.abort=="function"}function A(O){O.emit("close")}function N(O,B){O.emit("error",B),e.nextTick(A,O)}function I(O,B){!O||a(O)||(!B&&!o(O)&&(B=new r),l(O)?(O.socket=null,O.destroy(B)):T(O)?O.abort():T(O.req)?O.req.abort():typeof O.destroy=="function"?O.destroy(B):typeof O.close=="function"?O.close():B?e.nextTick(N,O,B):e.nextTick(A,O),O.destroyed||(O[i]=!0))}return wM={construct:S,destroyer:I,destroy:h,undestroy:x,errorOrDestroy:w},wM}var _M,h9;function eD(){if(h9)return _M;h9=1;const{ArrayIsArray:e,ObjectSetPrototypeOf:t}=ni(),{EventEmitter:n}=JE();function r(i){n.call(this,i)}t(r.prototype,n.prototype),t(r,n),r.prototype.pipe=function(i,a){const o=this;function l(b){i.writable&&i.write(b)===!1&&o.pause&&o.pause()}o.on("data",l);function c(){o.readable&&o.resume&&o.resume()}i.on("drain",c),!i._isStdio&&(!a||a.end!==!1)&&(o.on("end",d),o.on("close",h));let u=!1;function d(){u||(u=!0,i.end())}function h(){u||(u=!0,typeof i.destroy=="function"&&i.destroy())}function m(b){y(),n.listenerCount(this,"error")===0&&this.emit("error",b)}s(o,"error",m),s(i,"error",m);function y(){o.removeListener("data",l),i.removeListener("drain",c),o.removeListener("end",d),o.removeListener("close",h),o.removeListener("error",m),i.removeListener("error",m),o.removeListener("end",y),o.removeListener("close",y),i.removeListener("close",y)}return o.on("end",y),o.on("close",y),i.on("close",y),i.emit("pipe",o),i};function s(i,a,o){if(typeof i.prependListener=="function")return i.prependListener(a,o);!i._events||!i._events[a]?i.on(a,o):e(i._events[a])?i._events[a].unshift(o):i._events[a]=[o,i._events[a]]}return _M={Stream:r,prependListener:s},_M}var SM={exports:{}},p9;function QE(){return p9||(p9=1,function(e){const{SymbolDispose:t}=ni(),{AbortError:n,codes:r}=go(),{isNodeStream:s,isWebStream:i,kControllerErrorFunction:a}=of(),o=sp(),{ERR_INVALID_ARG_TYPE:l}=r;let c;const u=(d,h)=>{if(typeof d!="object"||!("aborted"in d))throw new l(h,"AbortSignal",d)};e.exports.addAbortSignal=function(h,m){if(u(h,"signal"),!s(m)&&!i(m))throw new l("stream",["ReadableStream","WritableStream","Stream"],m);return e.exports.addAbortSignalNoValidate(h,m)},e.exports.addAbortSignalNoValidate=function(d,h){if(typeof d!="object"||!("aborted"in d))return h;const m=s(h)?()=>{h.destroy(new n(void 0,{cause:d.reason}))}:()=>{h[a](new n(void 0,{cause:d.reason}))};if(d.aborted)m();else{c=c||Oo().addAbortListener;const y=c(d,m);o(h,y[t])}return h}}(SM)),SM.exports}var CM,m9;function sSe(){if(m9)return CM;m9=1;const{StringPrototypeSlice:e,SymbolIterator:t,TypedArrayPrototypeSet:n,Uint8Array:r}=ni(),{Buffer:s}=rp(),{inspect:i}=Oo();return CM=class{constructor(){this.head=null,this.tail=null,this.length=0}push(o){const l={data:o,next:null};this.length>0?this.tail.next=l:this.head=l,this.tail=l,++this.length}unshift(o){const l={data:o,next:this.head};this.length===0&&(this.tail=l),this.head=l,++this.length}shift(){if(this.length===0)return;const o=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,o}clear(){this.head=this.tail=null,this.length=0}join(o){if(this.length===0)return"";let l=this.head,c=""+l.data;for(;(l=l.next)!==null;)c+=o+l.data;return c}concat(o){if(this.length===0)return s.alloc(0);const l=s.allocUnsafe(o>>>0);let c=this.head,u=0;for(;c;)n(l,c.data,u),u+=c.data.length,c=c.next;return l}consume(o,l){const c=this.head.data;if(o<c.length){const u=c.slice(0,o);return this.head.data=c.slice(o),u}return o===c.length?this.shift():l?this._getString(o):this._getBuffer(o)}first(){return this.head.data}*[t](){for(let o=this.head;o;o=o.next)yield o.data}_getString(o){let l="",c=this.head,u=0;do{const d=c.data;if(o>d.length)l+=d,o-=d.length;else{o===d.length?(l+=d,++u,c.next?this.head=c.next:this.head=this.tail=null):(l+=e(d,0,o),this.head=c,c.data=e(d,o));break}++u}while((c=c.next)!==null);return this.length-=u,l}_getBuffer(o){const l=s.allocUnsafe(o),c=o;let u=this.head,d=0;do{const h=u.data;if(o>h.length)n(l,h,c-o),o-=h.length;else{o===h.length?(n(l,h,c-o),++d,u.next?this.head=u.next:this.head=this.tail=null):(n(l,new r(h.buffer,h.byteOffset,o),c-o),this.head=u,u.data=h.slice(o));break}++d}while((u=u.next)!==null);return this.length-=d,l}[Symbol.for("nodejs.util.inspect.custom")](o,l){return i(this,{...l,depth:0,customInspect:!1})}},CM}var kM,g9;function eT(){if(g9)return kM;g9=1;const{MathFloor:e,NumberIsInteger:t}=ni(),{validateInteger:n}=A1(),{ERR_INVALID_ARG_VALUE:r}=go().codes;let s=16*1024,i=16;function a(u,d,h){return u.highWaterMark!=null?u.highWaterMark:d?u[h]:null}function o(u){return u?i:s}function l(u,d){n(d,"value",0),u?i=d:s=d}function c(u,d,h,m){const y=a(d,m,h);if(y!=null){if(!t(y)||y<0){const b=m?`options.${h}`:"options.highWaterMark";throw new r(b,y)}return e(y)}return o(u.objectMode)}return kM={getHighWaterMark:c,getDefaultHighWaterMark:o,setDefaultHighWaterMark:l},kM}var EM={},VS={exports:{}},y9;function tD(){return y9||(y9=1,function(e,t){var n=rp(),r=n.Buffer;function s(a,o){for(var l in a)o[l]=a[l]}r.from&&r.alloc&&r.allocUnsafe&&r.allocUnsafeSlow?e.exports=n:(s(n,t),t.Buffer=i);function i(a,o,l){return r(a,o,l)}s(r,i),i.from=function(a,o,l){if(typeof a=="number")throw new TypeError("Argument must not be a number");return r(a,o,l)},i.alloc=function(a,o,l){if(typeof a!="number")throw new TypeError("Argument must be a number");var c=r(a);return o!==void 0?typeof l=="string"?c.fill(o,l):c.fill(o):c.fill(0),c},i.allocUnsafe=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return r(a)},i.allocUnsafeSlow=function(a){if(typeof a!="number")throw new TypeError("Argument must be a number");return n.SlowBuffer(a)}}(VS,VS.exports)),VS.exports}var b9;function iSe(){if(b9)return EM;b9=1;var e=tD().Buffer,t=e.isEncoding||function(x){switch(x=""+x,x&&x.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function n(x){if(!x)return"utf8";for(var w;;)switch(x){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return x;default:if(w)return;x=(""+x).toLowerCase(),w=!0}}function r(x){var w=n(x);if(typeof w!="string"&&(e.isEncoding===t||!t(x)))throw new Error("Unknown encoding: "+x);return w||x}EM.StringDecoder=s;function s(x){this.encoding=r(x);var w;switch(this.encoding){case"utf16le":this.text=d,this.end=h,w=4;break;case"utf8":this.fillLast=l,w=4;break;case"base64":this.text=m,this.end=y,w=3;break;default:this.write=b,this.end=v;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=e.allocUnsafe(w)}s.prototype.write=function(x){if(x.length===0)return"";var w,S;if(this.lastNeed){if(w=this.fillLast(x),w===void 0)return"";S=this.lastNeed,this.lastNeed=0}else S=0;return S<x.length?w?w+this.text(x,S):this.text(x,S):w||""},s.prototype.end=u,s.prototype.text=c,s.prototype.fillLast=function(x){if(this.lastNeed<=x.length)return x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,this.lastTotal-this.lastNeed,0,x.length),this.lastNeed-=x.length};function i(x){return x<=127?0:x>>5===6?2:x>>4===14?3:x>>3===30?4:x>>6===2?-1:-2}function a(x,w,S){var k=w.length-1;if(k<S)return 0;var C=i(w[k]);return C>=0?(C>0&&(x.lastNeed=C-1),C):--k<S||C===-2?0:(C=i(w[k]),C>=0?(C>0&&(x.lastNeed=C-2),C):--k<S||C===-2?0:(C=i(w[k]),C>=0?(C>0&&(C===2?C=0:x.lastNeed=C-3),C):0))}function o(x,w,S){if((w[0]&192)!==128)return x.lastNeed=0,"";if(x.lastNeed>1&&w.length>1){if((w[1]&192)!==128)return x.lastNeed=1,"";if(x.lastNeed>2&&w.length>2&&(w[2]&192)!==128)return x.lastNeed=2,""}}function l(x){var w=this.lastTotal-this.lastNeed,S=o(this,x);if(S!==void 0)return S;if(this.lastNeed<=x.length)return x.copy(this.lastChar,w,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);x.copy(this.lastChar,w,0,x.length),this.lastNeed-=x.length}function c(x,w){var S=a(this,x,w);if(!this.lastNeed)return x.toString("utf8",w);this.lastTotal=S;var k=x.length-(S-this.lastNeed);return x.copy(this.lastChar,0,k),x.toString("utf8",w,k)}function u(x){var w=x&&x.length?this.write(x):"";return this.lastNeed?w+"":w}function d(x,w){if((x.length-w)%2===0){var S=x.toString("utf16le",w);if(S){var k=S.charCodeAt(S.length-1);if(k>=55296&&k<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1],S.slice(0,-1)}return S}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=x[x.length-1],x.toString("utf16le",w,x.length-1)}function h(x){var w=x&&x.length?this.write(x):"";if(this.lastNeed){var S=this.lastTotal-this.lastNeed;return w+this.lastChar.toString("utf16le",0,S)}return w}function m(x,w){var S=(x.length-w)%3;return S===0?x.toString("base64",w):(this.lastNeed=3-S,this.lastTotal=3,S===1?this.lastChar[0]=x[x.length-1]:(this.lastChar[0]=x[x.length-2],this.lastChar[1]=x[x.length-1]),x.toString("base64",w,x.length-S))}function y(x){var w=x&&x.length?this.write(x):"";return this.lastNeed?w+this.lastChar.toString("base64",0,3-this.lastNeed):w}function b(x){return x.toString(this.encoding)}function v(x){return x&&x.length?this.write(x):""}return EM}var TM,v9;function cY(){if(v9)return TM;v9=1;const e=tg(),{PromisePrototypeThen:t,SymbolAsyncIterator:n,SymbolIterator:r}=ni(),{Buffer:s}=rp(),{ERR_INVALID_ARG_TYPE:i,ERR_STREAM_NULL_VALUES:a}=go().codes;function o(l,c,u){let d;if(typeof c=="string"||c instanceof s)return new l({objectMode:!0,...u,read(){this.push(c),this.push(null)}});let h;if(c&&c[n])h=!0,d=c[n]();else if(c&&c[r])h=!1,d=c[r]();else throw new i("iterable",["Iterable"],c);const m=new l({objectMode:!0,highWaterMark:1,...u});let y=!1;m._read=function(){y||(y=!0,v())},m._destroy=function(x,w){t(b(x),()=>e.nextTick(w,x),S=>e.nextTick(w,S||x))};async function b(x){const w=x!=null,S=typeof d.throw=="function";if(w&&S){const{value:k,done:C}=await d.throw(x);if(await k,C)return}if(typeof d.return=="function"){const{value:k}=await d.return();await k}}async function v(){for(;;){try{const{value:x,done:w}=h?await d.next():d.next();if(w)m.push(null);else{const S=x&&typeof x.then=="function"?await x:x;if(S===null)throw y=!1,new a;if(m.push(S))continue;y=!1}}catch(x){m.destroy(x)}break}}return m}return TM=o,TM}var AM,x9;function tT(){if(x9)return AM;x9=1;const e=tg(),{ArrayPrototypeIndexOf:t,NumberIsInteger:n,NumberIsNaN:r,NumberParseInt:s,ObjectDefineProperties:i,ObjectKeys:a,ObjectSetPrototypeOf:o,Promise:l,SafeSet:c,SymbolAsyncDispose:u,SymbolAsyncIterator:d,Symbol:h}=ni();AM=Ae,Ae.ReadableState=Be;const{EventEmitter:m}=JE(),{Stream:y,prependListener:b}=eD(),{Buffer:v}=rp(),{addAbortSignal:x}=QE(),w=sp();let S=Oo().debuglog("stream",fe=>{S=fe});const k=sSe(),C=tb(),{getHighWaterMark:T,getDefaultHighWaterMark:A}=eT(),{aggregateTwoErrors:N,codes:{ERR_INVALID_ARG_TYPE:I,ERR_METHOD_NOT_IMPLEMENTED:O,ERR_OUT_OF_RANGE:B,ERR_STREAM_PUSH_AFTER_EOF:D,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:H},AbortError:P}=go(),{validateObject:K}=A1(),U=h("kPaused"),{StringDecoder:V}=iSe(),L=cY();o(Ae.prototype,y.prototype),o(Ae,y);const te=()=>{},{errorOrDestroy:W}=C,Q=1,ee=2,re=4,pe=8,de=16,Oe=32,Fe=64,Se=128,Ce=256,qe=512,Qe=1024,We=2048,je=4096,Y=8192,ye=16384,Ie=32768,ce=65536,oe=1<<17,se=1<<18;function Me(fe){return{enumerable:!1,get(){return(this.state&fe)!==0},set(Z){Z?this.state|=fe:this.state&=~fe}}}i(Be.prototype,{objectMode:Me(Q),ended:Me(ee),endEmitted:Me(re),reading:Me(pe),constructed:Me(de),sync:Me(Oe),needReadable:Me(Fe),emittedReadable:Me(Se),readableListening:Me(Ce),resumeScheduled:Me(qe),errorEmitted:Me(Qe),emitClose:Me(We),autoDestroy:Me(je),destroyed:Me(Y),closed:Me(ye),closeEmitted:Me(Ie),multiAwaitDrain:Me(ce),readingMore:Me(oe),dataEmitted:Me(se)});function Be(fe,Z,G){typeof G!="boolean"&&(G=Z instanceof Xd()),this.state=We|je|de|Oe,fe&&fe.objectMode&&(this.state|=Q),G&&fe&&fe.readableObjectMode&&(this.state|=Q),this.highWaterMark=fe?T(this,fe,"readableHighWaterMark",G):A(!1),this.buffer=new k,this.length=0,this.pipes=[],this.flowing=null,this[U]=null,fe&&fe.emitClose===!1&&(this.state&=-2049),fe&&fe.autoDestroy===!1&&(this.state&=-4097),this.errored=null,this.defaultEncoding=fe&&fe.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,fe&&fe.encoding&&(this.decoder=new V(fe.encoding),this.encoding=fe.encoding)}function Ae(fe){if(!(this instanceof Ae))return new Ae(fe);const Z=this instanceof Xd();this._readableState=new Be(fe,this,Z),fe&&(typeof fe.read=="function"&&(this._read=fe.read),typeof fe.destroy=="function"&&(this._destroy=fe.destroy),typeof fe.construct=="function"&&(this._construct=fe.construct),fe.signal&&!Z&&x(fe.signal,this)),y.call(this,fe),C.construct(this,()=>{this._readableState.needReadable&&F(this,this._readableState)})}Ae.prototype.destroy=C.destroy,Ae.prototype._undestroy=C.undestroy,Ae.prototype._destroy=function(fe,Z){Z(fe)},Ae.prototype[m.captureRejectionSymbol]=function(fe){this.destroy(fe)},Ae.prototype[u]=function(){let fe;return this.destroyed||(fe=this.readableEnded?null:new P,this.destroy(fe)),new l((Z,G)=>w(this,J=>J&&J!==fe?G(J):Z(null)))},Ae.prototype.push=function(fe,Z){return lt(this,fe,Z,!1)},Ae.prototype.unshift=function(fe,Z){return lt(this,fe,Z,!0)};function lt(fe,Z,G,J){S("readableAddChunk",Z);const xe=fe._readableState;let De;if((xe.state&Q)===0&&(typeof Z=="string"?(G=G||xe.defaultEncoding,xe.encoding!==G&&(J&&xe.encoding?Z=v.from(Z,G).toString(xe.encoding):(Z=v.from(Z,G),G=""))):Z instanceof v?G="":y._isUint8Array(Z)?(Z=y._uint8ArrayToBuffer(Z),G=""):Z!=null&&(De=new I("chunk",["string","Buffer","Uint8Array"],Z))),De)W(fe,De);else if(Z===null)xe.state&=-9,Ft(fe,xe);else if((xe.state&Q)!==0||Z&&Z.length>0)if(J)if((xe.state&re)!==0)W(fe,new H);else{if(xe.destroyed||xe.errored)return!1;Tt(fe,xe,Z,!0)}else if(xe.ended)W(fe,new D);else{if(xe.destroyed||xe.errored)return!1;xe.state&=-9,xe.decoder&&!G?(Z=xe.decoder.write(Z),xe.objectMode||Z.length!==0?Tt(fe,xe,Z,!1):F(fe,xe)):Tt(fe,xe,Z,!1)}else J||(xe.state&=-9,F(fe,xe));return!xe.ended&&(xe.length<xe.highWaterMark||xe.length===0)}function Tt(fe,Z,G,J){Z.flowing&&Z.length===0&&!Z.sync&&fe.listenerCount("data")>0?((Z.state&ce)!==0?Z.awaitDrainWriters.clear():Z.awaitDrainWriters=null,Z.dataEmitted=!0,fe.emit("data",G)):(Z.length+=Z.objectMode?1:G.length,J?Z.buffer.unshift(G):Z.buffer.push(G),(Z.state&Fe)!==0&&Ht(fe)),F(fe,Z)}Ae.prototype.isPaused=function(){const fe=this._readableState;return fe[U]===!0||fe.flowing===!1},Ae.prototype.setEncoding=function(fe){const Z=new V(fe);this._readableState.decoder=Z,this._readableState.encoding=this._readableState.decoder.encoding;const G=this._readableState.buffer;let J="";for(const xe of G)J+=Z.write(xe);return G.clear(),J!==""&&G.push(J),this._readableState.length=J.length,this};const dt=1073741824;function Pt(fe){if(fe>dt)throw new B("size","<= 1GiB",fe);return fe--,fe|=fe>>>1,fe|=fe>>>2,fe|=fe>>>4,fe|=fe>>>8,fe|=fe>>>16,fe++,fe}function qt(fe,Z){return fe<=0||Z.length===0&&Z.ended?0:(Z.state&Q)!==0?1:r(fe)?Z.flowing&&Z.length?Z.buffer.first().length:Z.length:fe<=Z.length?fe:Z.ended?Z.length:0}Ae.prototype.read=function(fe){S("read",fe),fe===void 0?fe=NaN:n(fe)||(fe=s(fe,10));const Z=this._readableState,G=fe;if(fe>Z.highWaterMark&&(Z.highWaterMark=Pt(fe)),fe!==0&&(Z.state&=-129),fe===0&&Z.needReadable&&((Z.highWaterMark!==0?Z.length>=Z.highWaterMark:Z.length>0)||Z.ended))return S("read: emitReadable",Z.length,Z.ended),Z.length===0&&Z.ended?tt(this):Ht(this),null;if(fe=qt(fe,Z),fe===0&&Z.ended)return Z.length===0&&tt(this),null;let J=(Z.state&Fe)!==0;if(S("need readable",J),(Z.length===0||Z.length-fe<Z.highWaterMark)&&(J=!0,S("length less than watermark",J)),Z.ended||Z.reading||Z.destroyed||Z.errored||!Z.constructed)J=!1,S("reading, ended or constructing",J);else if(J){S("do read"),Z.state|=pe|Oe,Z.length===0&&(Z.state|=Fe);try{this._read(Z.highWaterMark)}catch(De){W(this,De)}Z.state&=-33,Z.reading||(fe=qt(G,Z))}let xe;return fe>0?xe=Ue(fe,Z):xe=null,xe===null?(Z.needReadable=Z.length<=Z.highWaterMark,fe=0):(Z.length-=fe,Z.multiAwaitDrain?Z.awaitDrainWriters.clear():Z.awaitDrainWriters=null),Z.length===0&&(Z.ended||(Z.needReadable=!0),G!==fe&&Z.ended&&tt(this)),xe!==null&&!Z.errorEmitted&&!Z.closeEmitted&&(Z.dataEmitted=!0,this.emit("data",xe)),xe};function Ft(fe,Z){if(S("onEofChunk"),!Z.ended){if(Z.decoder){const G=Z.decoder.end();G&&G.length&&(Z.buffer.push(G),Z.length+=Z.objectMode?1:G.length)}Z.ended=!0,Z.sync?Ht(fe):(Z.needReadable=!1,Z.emittedReadable=!0,we(fe))}}function Ht(fe){const Z=fe._readableState;S("emitReadable",Z.needReadable,Z.emittedReadable),Z.needReadable=!1,Z.emittedReadable||(S("emitReadable",Z.flowing),Z.emittedReadable=!0,e.nextTick(we,fe))}function we(fe){const Z=fe._readableState;S("emitReadable_",Z.destroyed,Z.length,Z.ended),!Z.destroyed&&!Z.errored&&(Z.length||Z.ended)&&(fe.emit("readable"),Z.emittedReadable=!1),Z.needReadable=!Z.flowing&&!Z.ended&&Z.length<=Z.highWaterMark,ft(fe)}function F(fe,Z){!Z.readingMore&&Z.constructed&&(Z.readingMore=!0,e.nextTick(X,fe,Z))}function X(fe,Z){for(;!Z.reading&&!Z.ended&&(Z.length<Z.highWaterMark||Z.flowing&&Z.length===0);){const G=Z.length;if(S("maybeReadMore read 0"),fe.read(0),G===Z.length)break}Z.readingMore=!1}Ae.prototype._read=function(fe){throw new O("_read()")},Ae.prototype.pipe=function(fe,Z){const G=this,J=this._readableState;J.pipes.length===1&&(J.multiAwaitDrain||(J.multiAwaitDrain=!0,J.awaitDrainWriters=new c(J.awaitDrainWriters?[J.awaitDrainWriters]:[]))),J.pipes.push(fe),S("pipe count=%d opts=%j",J.pipes.length,Z);const De=(!Z||Z.end!==!1)&&fe!==e.stdout&&fe!==e.stderr?wt:ss;J.endEmitted?e.nextTick(De):G.once("end",De),fe.on("unpipe",He);function He(kr,mn){S("onunpipe"),kr===G&&mn&&mn.hasUnpiped===!1&&(mn.hasUnpiped=!0,Zt())}function wt(){S("onend"),fe.end()}let Qt,On=!1;function Zt(){S("cleanup"),fe.removeListener("close",Mr),fe.removeListener("finish",rs),Qt&&fe.removeListener("drain",Qt),fe.removeListener("error",br),fe.removeListener("unpipe",He),G.removeListener("end",wt),G.removeListener("end",ss),G.removeListener("data",fn),On=!0,Qt&&J.awaitDrainWriters&&(!fe._writableState||fe._writableState.needDrain)&&Qt()}function nn(){On||(J.pipes.length===1&&J.pipes[0]===fe?(S("false write response, pause",0),J.awaitDrainWriters=fe,J.multiAwaitDrain=!1):J.pipes.length>1&&J.pipes.includes(fe)&&(S("false write response, pause",J.awaitDrainWriters.size),J.awaitDrainWriters.add(fe)),G.pause()),Qt||(Qt=be(G,fe),fe.on("drain",Qt))}G.on("data",fn);function fn(kr){S("ondata");const mn=fe.write(kr);S("dest.write",mn),mn===!1&&nn()}function br(kr){if(S("onerror",kr),ss(),fe.removeListener("error",br),fe.listenerCount("error")===0){const mn=fe._writableState||fe._readableState;mn&&!mn.errorEmitted?W(fe,kr):fe.emit("error",kr)}}b(fe,"error",br);function Mr(){fe.removeListener("finish",rs),ss()}fe.once("close",Mr);function rs(){S("onfinish"),fe.removeListener("close",Mr),ss()}fe.once("finish",rs);function ss(){S("unpipe"),G.unpipe(fe)}return fe.emit("pipe",G),fe.writableNeedDrain===!0?nn():J.flowing||(S("pipe resume"),G.resume()),fe};function be(fe,Z){return function(){const J=fe._readableState;J.awaitDrainWriters===Z?(S("pipeOnDrain",1),J.awaitDrainWriters=null):J.multiAwaitDrain&&(S("pipeOnDrain",J.awaitDrainWriters.size),J.awaitDrainWriters.delete(Z)),(!J.awaitDrainWriters||J.awaitDrainWriters.size===0)&&fe.listenerCount("data")&&fe.resume()}}Ae.prototype.unpipe=function(fe){const Z=this._readableState,G={hasUnpiped:!1};if(Z.pipes.length===0)return this;if(!fe){const xe=Z.pipes;Z.pipes=[],this.pause();for(let De=0;De<xe.length;De++)xe[De].emit("unpipe",this,{hasUnpiped:!1});return this}const J=t(Z.pipes,fe);return J===-1?this:(Z.pipes.splice(J,1),Z.pipes.length===0&&this.pause(),fe.emit("unpipe",this,G),this)},Ae.prototype.on=function(fe,Z){const G=y.prototype.on.call(this,fe,Z),J=this._readableState;return fe==="data"?(J.readableListening=this.listenerCount("readable")>0,J.flowing!==!1&&this.resume()):fe==="readable"&&!J.endEmitted&&!J.readableListening&&(J.readableListening=J.needReadable=!0,J.flowing=!1,J.emittedReadable=!1,S("on readable",J.length,J.reading),J.length?Ht(this):J.reading||e.nextTick(ge,this)),G},Ae.prototype.addListener=Ae.prototype.on,Ae.prototype.removeListener=function(fe,Z){const G=y.prototype.removeListener.call(this,fe,Z);return fe==="readable"&&e.nextTick(ke,this),G},Ae.prototype.off=Ae.prototype.removeListener,Ae.prototype.removeAllListeners=function(fe){const Z=y.prototype.removeAllListeners.apply(this,arguments);return(fe==="readable"||fe===void 0)&&e.nextTick(ke,this),Z};function ke(fe){const Z=fe._readableState;Z.readableListening=fe.listenerCount("readable")>0,Z.resumeScheduled&&Z[U]===!1?Z.flowing=!0:fe.listenerCount("data")>0?fe.resume():Z.readableListening||(Z.flowing=null)}function ge(fe){S("readable nexttick read 0"),fe.read(0)}Ae.prototype.resume=function(){const fe=this._readableState;return fe.flowing||(S("resume"),fe.flowing=!fe.readableListening,Ee(this,fe)),fe[U]=!1,this};function Ee(fe,Z){Z.resumeScheduled||(Z.resumeScheduled=!0,e.nextTick(le,fe,Z))}function le(fe,Z){S("resume",Z.reading),Z.reading||fe.read(0),Z.resumeScheduled=!1,fe.emit("resume"),ft(fe),Z.flowing&&!Z.reading&&fe.read(0)}Ae.prototype.pause=function(){return S("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(S("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[U]=!0,this};function ft(fe){const Z=fe._readableState;for(S("flow",Z.flowing);Z.flowing&&fe.read()!==null;);}Ae.prototype.wrap=function(fe){let Z=!1;fe.on("data",J=>{!this.push(J)&&fe.pause&&(Z=!0,fe.pause())}),fe.on("end",()=>{this.push(null)}),fe.on("error",J=>{W(this,J)}),fe.on("close",()=>{this.destroy()}),fe.on("destroy",()=>{this.destroy()}),this._read=()=>{Z&&fe.resume&&(Z=!1,fe.resume())};const G=a(fe);for(let J=1;J<G.length;J++){const xe=G[J];this[xe]===void 0&&typeof fe[xe]=="function"&&(this[xe]=fe[xe].bind(fe))}return this},Ae.prototype[d]=function(){return et(this)},Ae.prototype.iterator=function(fe){return fe!==void 0&&K(fe,"options"),et(this,fe)};function et(fe,Z){typeof fe.read!="function"&&(fe=Ae.wrap(fe,{objectMode:!0}));const G=$(fe,Z);return G.stream=fe,G}async function*$(fe,Z){let G=te;function J(He){this===fe?(G(),G=te):G=He}fe.on("readable",J);let xe;const De=w(fe,{writable:!1},He=>{xe=He?N(xe,He):null,G(),G=te});try{for(;;){const He=fe.destroyed?null:fe.read();if(He!==null)yield He;else{if(xe)throw xe;if(xe===null)return;await new l(J)}}}catch(He){throw xe=N(xe,He),xe}finally{(xe||(Z==null?void 0:Z.destroyOnReturn)!==!1)&&(xe===void 0||fe._readableState.autoDestroy)?C.destroyer(fe,null):(fe.off("readable",J),De())}}i(Ae.prototype,{readable:{__proto__:null,get(){const fe=this._readableState;return!!fe&&fe.readable!==!1&&!fe.destroyed&&!fe.errorEmitted&&!fe.endEmitted},set(fe){this._readableState&&(this._readableState.readable=!!fe)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(fe){this._readableState&&(this._readableState.flowing=fe)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(fe){this._readableState&&(this._readableState.destroyed=fe)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}}),i(Be.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[U]!==!1},set(fe){this[U]=!!fe}}}),Ae._fromList=Ue;function Ue(fe,Z){if(Z.length===0)return null;let G;return Z.objectMode?G=Z.buffer.shift():!fe||fe>=Z.length?(Z.decoder?G=Z.buffer.join(""):Z.buffer.length===1?G=Z.buffer.first():G=Z.buffer.concat(Z.length),Z.buffer.clear()):G=Z.buffer.consume(fe,Z.decoder),G}function tt(fe){const Z=fe._readableState;S("endReadable",Z.endEmitted),Z.endEmitted||(Z.ended=!0,e.nextTick(ve,Z,fe))}function ve(fe,Z){if(S("endReadableNT",fe.endEmitted,fe.length),!fe.errored&&!fe.closeEmitted&&!fe.endEmitted&&fe.length===0){if(fe.endEmitted=!0,Z.emit("end"),Z.writable&&Z.allowHalfOpen===!1)e.nextTick(_e,Z);else if(fe.autoDestroy){const G=Z._writableState;(!G||G.autoDestroy&&(G.finished||G.writable===!1))&&Z.destroy()}}}function _e(fe){fe.writable&&!fe.writableEnded&&!fe.destroyed&&fe.end()}Ae.from=function(fe,Z){return L(Ae,fe,Z)};let ze;function Ct(){return ze===void 0&&(ze={}),ze}return Ae.fromWeb=function(fe,Z){return Ct().newStreamReadableFromReadableStream(fe,Z)},Ae.toWeb=function(fe,Z){return Ct().newReadableStreamFromStreamReadable(fe,Z)},Ae.wrap=function(fe,Z){var G,J;return new Ae({objectMode:(G=(J=fe.readableObjectMode)!==null&&J!==void 0?J:fe.objectMode)!==null&&G!==void 0?G:!0,...Z,destroy(xe,De){C.destroyer(fe,xe),De(xe)}}).wrap(fe)},AM}var RM,w9;function nD(){if(w9)return RM;w9=1;const e=tg(),{ArrayPrototypeSlice:t,Error:n,FunctionPrototypeSymbolHasInstance:r,ObjectDefineProperty:s,ObjectDefineProperties:i,ObjectSetPrototypeOf:a,StringPrototypeToLowerCase:o,Symbol:l,SymbolHasInstance:c}=ni();RM=K,K.WritableState=H;const{EventEmitter:u}=JE(),d=eD().Stream,{Buffer:h}=rp(),m=tb(),{addAbortSignal:y}=QE(),{getHighWaterMark:b,getDefaultHighWaterMark:v}=eT(),{ERR_INVALID_ARG_TYPE:x,ERR_METHOD_NOT_IMPLEMENTED:w,ERR_MULTIPLE_CALLBACK:S,ERR_STREAM_CANNOT_PIPE:k,ERR_STREAM_DESTROYED:C,ERR_STREAM_ALREADY_FINISHED:T,ERR_STREAM_NULL_VALUES:A,ERR_STREAM_WRITE_AFTER_END:N,ERR_UNKNOWN_ENCODING:I}=go().codes,{errorOrDestroy:O}=m;a(K.prototype,d.prototype),a(K,d);function B(){}const D=l("kOnFinished");function H(je,Y,ye){typeof ye!="boolean"&&(ye=Y instanceof Xd()),this.objectMode=!!(je&&je.objectMode),ye&&(this.objectMode=this.objectMode||!!(je&&je.writableObjectMode)),this.highWaterMark=je?b(this,je,"writableHighWaterMark",ye):v(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;const Ie=!!(je&&je.decodeStrings===!1);this.decodeStrings=!Ie,this.defaultEncoding=je&&je.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=W.bind(void 0,Y),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,P(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!je||je.emitClose!==!1,this.autoDestroy=!je||je.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[D]=[]}function P(je){je.buffered=[],je.bufferedIndex=0,je.allBuffers=!0,je.allNoop=!0}H.prototype.getBuffer=function(){return t(this.buffered,this.bufferedIndex)},s(H.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function K(je){const Y=this instanceof Xd();if(!Y&&!r(K,this))return new K(je);this._writableState=new H(je,this,Y),je&&(typeof je.write=="function"&&(this._write=je.write),typeof je.writev=="function"&&(this._writev=je.writev),typeof je.destroy=="function"&&(this._destroy=je.destroy),typeof je.final=="function"&&(this._final=je.final),typeof je.construct=="function"&&(this._construct=je.construct),je.signal&&y(je.signal,this)),d.call(this,je),m.construct(this,()=>{const ye=this._writableState;ye.writing||pe(this,ye),Se(this,ye)})}s(K,c,{__proto__:null,value:function(je){return r(this,je)?!0:this!==K?!1:je&&je._writableState instanceof H}}),K.prototype.pipe=function(){O(this,new k)};function U(je,Y,ye,Ie){const ce=je._writableState;if(typeof ye=="function")Ie=ye,ye=ce.defaultEncoding;else{if(!ye)ye=ce.defaultEncoding;else if(ye!=="buffer"&&!h.isEncoding(ye))throw new I(ye);typeof Ie!="function"&&(Ie=B)}if(Y===null)throw new A;if(!ce.objectMode)if(typeof Y=="string")ce.decodeStrings!==!1&&(Y=h.from(Y,ye),ye="buffer");else if(Y instanceof h)ye="buffer";else if(d._isUint8Array(Y))Y=d._uint8ArrayToBuffer(Y),ye="buffer";else throw new x("chunk",["string","Buffer","Uint8Array"],Y);let oe;return ce.ending?oe=new N:ce.destroyed&&(oe=new C("write")),oe?(e.nextTick(Ie,oe),O(je,oe,!0),oe):(ce.pendingcb++,V(je,ce,Y,ye,Ie))}K.prototype.write=function(je,Y,ye){return U(this,je,Y,ye)===!0},K.prototype.cork=function(){this._writableState.corked++},K.prototype.uncork=function(){const je=this._writableState;je.corked&&(je.corked--,je.writing||pe(this,je))},K.prototype.setDefaultEncoding=function(Y){if(typeof Y=="string"&&(Y=o(Y)),!h.isEncoding(Y))throw new I(Y);return this._writableState.defaultEncoding=Y,this};function V(je,Y,ye,Ie,ce){const oe=Y.objectMode?1:ye.length;Y.length+=oe;const se=Y.length<Y.highWaterMark;return se||(Y.needDrain=!0),Y.writing||Y.corked||Y.errored||!Y.constructed?(Y.buffered.push({chunk:ye,encoding:Ie,callback:ce}),Y.allBuffers&&Ie!=="buffer"&&(Y.allBuffers=!1),Y.allNoop&&ce!==B&&(Y.allNoop=!1)):(Y.writelen=oe,Y.writecb=ce,Y.writing=!0,Y.sync=!0,je._write(ye,Ie,Y.onwrite),Y.sync=!1),se&&!Y.errored&&!Y.destroyed}function L(je,Y,ye,Ie,ce,oe,se){Y.writelen=Ie,Y.writecb=se,Y.writing=!0,Y.sync=!0,Y.destroyed?Y.onwrite(new C("write")):ye?je._writev(ce,Y.onwrite):je._write(ce,oe,Y.onwrite),Y.sync=!1}function te(je,Y,ye,Ie){--Y.pendingcb,Ie(ye),re(Y),O(je,ye)}function W(je,Y){const ye=je._writableState,Ie=ye.sync,ce=ye.writecb;if(typeof ce!="function"){O(je,new S);return}ye.writing=!1,ye.writecb=null,ye.length-=ye.writelen,ye.writelen=0,Y?(Y.stack,ye.errored||(ye.errored=Y),je._readableState&&!je._readableState.errored&&(je._readableState.errored=Y),Ie?e.nextTick(te,je,ye,Y,ce):te(je,ye,Y,ce)):(ye.buffered.length>ye.bufferedIndex&&pe(je,ye),Ie?ye.afterWriteTickInfo!==null&&ye.afterWriteTickInfo.cb===ce?ye.afterWriteTickInfo.count++:(ye.afterWriteTickInfo={count:1,cb:ce,stream:je,state:ye},e.nextTick(Q,ye.afterWriteTickInfo)):ee(je,ye,1,ce))}function Q({stream:je,state:Y,count:ye,cb:Ie}){return Y.afterWriteTickInfo=null,ee(je,Y,ye,Ie)}function ee(je,Y,ye,Ie){for(!Y.ending&&!je.destroyed&&Y.length===0&&Y.needDrain&&(Y.needDrain=!1,je.emit("drain"));ye-- >0;)Y.pendingcb--,Ie();Y.destroyed&&re(Y),Se(je,Y)}function re(je){if(je.writing)return;for(let ce=je.bufferedIndex;ce<je.buffered.length;++ce){var Y;const{chunk:oe,callback:se}=je.buffered[ce],Me=je.objectMode?1:oe.length;je.length-=Me,se((Y=je.errored)!==null&&Y!==void 0?Y:new C("write"))}const ye=je[D].splice(0);for(let ce=0;ce<ye.length;ce++){var Ie;ye[ce]((Ie=je.errored)!==null&&Ie!==void 0?Ie:new C("end"))}P(je)}function pe(je,Y){if(Y.corked||Y.bufferProcessing||Y.destroyed||!Y.constructed)return;const{buffered:ye,bufferedIndex:Ie,objectMode:ce}=Y,oe=ye.length-Ie;if(!oe)return;let se=Ie;if(Y.bufferProcessing=!0,oe>1&&je._writev){Y.pendingcb-=oe-1;const Me=Y.allNoop?B:Ae=>{for(let lt=se;lt<ye.length;++lt)ye[lt].callback(Ae)},Be=Y.allNoop&&se===0?ye:t(ye,se);Be.allBuffers=Y.allBuffers,L(je,Y,!0,Y.length,Be,"",Me),P(Y)}else{do{const{chunk:Me,encoding:Be,callback:Ae}=ye[se];ye[se++]=null;const lt=ce?1:Me.length;L(je,Y,!1,lt,Me,Be,Ae)}while(se<ye.length&&!Y.writing);se===ye.length?P(Y):se>256?(ye.splice(0,se),Y.bufferedIndex=0):Y.bufferedIndex=se}Y.bufferProcessing=!1}K.prototype._write=function(je,Y,ye){if(this._writev)this._writev([{chunk:je,encoding:Y}],ye);else throw new w("_write()")},K.prototype._writev=null,K.prototype.end=function(je,Y,ye){const Ie=this._writableState;typeof je=="function"?(ye=je,je=null,Y=null):typeof Y=="function"&&(ye=Y,Y=null);let ce;if(je!=null){const oe=U(this,je,Y);oe instanceof n&&(ce=oe)}return Ie.corked&&(Ie.corked=1,this.uncork()),ce||(!Ie.errored&&!Ie.ending?(Ie.ending=!0,Se(this,Ie,!0),Ie.ended=!0):Ie.finished?ce=new T("end"):Ie.destroyed&&(ce=new C("end"))),typeof ye=="function"&&(ce||Ie.finished?e.nextTick(ye,ce):Ie[D].push(ye)),this};function de(je){return je.ending&&!je.destroyed&&je.constructed&&je.length===0&&!je.errored&&je.buffered.length===0&&!je.finished&&!je.writing&&!je.errorEmitted&&!je.closeEmitted}function Oe(je,Y){let ye=!1;function Ie(ce){if(ye){O(je,ce??S());return}if(ye=!0,Y.pendingcb--,ce){const oe=Y[D].splice(0);for(let se=0;se<oe.length;se++)oe[se](ce);O(je,ce,Y.sync)}else de(Y)&&(Y.prefinished=!0,je.emit("prefinish"),Y.pendingcb++,e.nextTick(Ce,je,Y))}Y.sync=!0,Y.pendingcb++;try{je._final(Ie)}catch(ce){Ie(ce)}Y.sync=!1}function Fe(je,Y){!Y.prefinished&&!Y.finalCalled&&(typeof je._final=="function"&&!Y.destroyed?(Y.finalCalled=!0,Oe(je,Y)):(Y.prefinished=!0,je.emit("prefinish")))}function Se(je,Y,ye){de(Y)&&(Fe(je,Y),Y.pendingcb===0&&(ye?(Y.pendingcb++,e.nextTick((Ie,ce)=>{de(ce)?Ce(Ie,ce):ce.pendingcb--},je,Y)):de(Y)&&(Y.pendingcb++,Ce(je,Y))))}function Ce(je,Y){Y.pendingcb--,Y.finished=!0;const ye=Y[D].splice(0);for(let Ie=0;Ie<ye.length;Ie++)ye[Ie]();if(je.emit("finish"),Y.autoDestroy){const Ie=je._readableState;(!Ie||Ie.autoDestroy&&(Ie.endEmitted||Ie.readable===!1))&&je.destroy()}}i(K.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(je){this._writableState&&(this._writableState.destroyed=je)}},writable:{__proto__:null,get(){const je=this._writableState;return!!je&&je.writable!==!1&&!je.destroyed&&!je.errored&&!je.ending&&!je.ended},set(je){this._writableState&&(this._writableState.writable=!!je)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){const je=this._writableState;return je?!je.destroyed&&!je.ending&&je.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});const qe=m.destroy;K.prototype.destroy=function(je,Y){const ye=this._writableState;return!ye.destroyed&&(ye.bufferedIndex<ye.buffered.length||ye[D].length)&&e.nextTick(re,ye),qe.call(this,je,Y),this},K.prototype._undestroy=m.undestroy,K.prototype._destroy=function(je,Y){Y(je)},K.prototype[u.captureRejectionSymbol]=function(je){this.destroy(je)};let Qe;function We(){return Qe===void 0&&(Qe={}),Qe}return K.fromWeb=function(je,Y){return We().newStreamWritableFromWritableStream(je,Y)},K.toWeb=function(je){return We().newWritableStreamFromStreamWritable(je)},RM}var NM,_9;function aSe(){if(_9)return NM;_9=1;const e=tg(),t=rp(),{isReadable:n,isWritable:r,isIterable:s,isNodeStream:i,isReadableNodeStream:a,isWritableNodeStream:o,isDuplexNodeStream:l,isReadableStream:c,isWritableStream:u}=of(),d=sp(),{AbortError:h,codes:{ERR_INVALID_ARG_TYPE:m,ERR_INVALID_RETURN_VALUE:y}}=go(),{destroyer:b}=tb(),v=Xd(),x=tT(),w=nD(),{createDeferredPromise:S}=Oo(),k=cY(),C=globalThis.Blob||t.Blob,T=typeof C<"u"?function(H){return H instanceof C}:function(H){return!1},A=globalThis.AbortController||gw().AbortController,{FunctionPrototypeCall:N}=ni();class I extends v{constructor(H){super(H),(H==null?void 0:H.readable)===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),(H==null?void 0:H.writable)===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}}NM=function D(H,P){if(l(H))return H;if(a(H))return B({readable:H});if(o(H))return B({writable:H});if(i(H))return B({writable:!1,readable:!1});if(c(H))return B({readable:x.fromWeb(H)});if(u(H))return B({writable:w.fromWeb(H)});if(typeof H=="function"){const{value:U,write:V,final:L,destroy:te}=O(H);if(s(U))return k(I,U,{objectMode:!0,write:V,final:L,destroy:te});const W=U==null?void 0:U.then;if(typeof W=="function"){let Q;const ee=N(W,U,re=>{if(re!=null)throw new y("nully","body",re)},re=>{b(Q,re)});return Q=new I({objectMode:!0,readable:!1,write:V,final(re){L(async()=>{try{await ee,e.nextTick(re,null)}catch(pe){e.nextTick(re,pe)}})},destroy:te})}throw new y("Iterable, AsyncIterable or AsyncFunction",P,U)}if(T(H))return D(H.arrayBuffer());if(s(H))return k(I,H,{objectMode:!0,writable:!1});if(c(H==null?void 0:H.readable)&&u(H==null?void 0:H.writable))return I.fromWeb(H);if(typeof(H==null?void 0:H.writable)=="object"||typeof(H==null?void 0:H.readable)=="object"){const U=H!=null&&H.readable?a(H==null?void 0:H.readable)?H==null?void 0:H.readable:D(H.readable):void 0,V=H!=null&&H.writable?o(H==null?void 0:H.writable)?H==null?void 0:H.writable:D(H.writable):void 0;return B({readable:U,writable:V})}const K=H==null?void 0:H.then;if(typeof K=="function"){let U;return N(K,H,V=>{V!=null&&U.push(V),U.push(null)},V=>{b(U,V)}),U=new I({objectMode:!0,writable:!1,read(){}})}throw new m(P,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],H)};function O(D){let{promise:H,resolve:P}=S();const K=new A,U=K.signal;return{value:D(async function*(){for(;;){const L=H;H=null;const{chunk:te,done:W,cb:Q}=await L;if(e.nextTick(Q),W)return;if(U.aborted)throw new h(void 0,{cause:U.reason});({promise:H,resolve:P}=S()),yield te}}(),{signal:U}),write(L,te,W){const Q=P;P=null,Q({chunk:L,done:!1,cb:W})},final(L){const te=P;P=null,te({done:!0,cb:L})},destroy(L,te){K.abort(),te(L)}}}function B(D){const H=D.readable&&typeof D.readable.read!="function"?x.wrap(D.readable):D.readable,P=D.writable;let K=!!n(H),U=!!r(P),V,L,te,W,Q;function ee(re){const pe=W;W=null,pe?pe(re):re&&Q.destroy(re)}return Q=new I({readableObjectMode:!!(H!=null&&H.readableObjectMode),writableObjectMode:!!(P!=null&&P.writableObjectMode),readable:K,writable:U}),U&&(d(P,re=>{U=!1,re&&b(H,re),ee(re)}),Q._write=function(re,pe,de){P.write(re,pe)?de():V=de},Q._final=function(re){P.end(),L=re},P.on("drain",function(){if(V){const re=V;V=null,re()}}),P.on("finish",function(){if(L){const re=L;L=null,re()}})),K&&(d(H,re=>{K=!1,re&&b(H,re),ee(re)}),H.on("readable",function(){if(te){const re=te;te=null,re()}}),H.on("end",function(){Q.push(null)}),Q._read=function(){for(;;){const re=H.read();if(re===null){te=Q._read;return}if(!Q.push(re))return}}),Q._destroy=function(re,pe){!re&&W!==null&&(re=new h),te=null,V=null,L=null,W===null?pe(re):(W=pe,b(P,re),b(H,re))},Q}return NM}var MM,S9;function Xd(){if(S9)return MM;S9=1;const{ObjectDefineProperties:e,ObjectGetOwnPropertyDescriptor:t,ObjectKeys:n,ObjectSetPrototypeOf:r}=ni();MM=a;const s=tT(),i=nD();r(a.prototype,s.prototype),r(a,s);{const u=n(i.prototype);for(let d=0;d<u.length;d++){const h=u[d];a.prototype[h]||(a.prototype[h]=i.prototype[h])}}function a(u){if(!(this instanceof a))return new a(u);s.call(this,u),i.call(this,u),u?(this.allowHalfOpen=u.allowHalfOpen!==!1,u.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),u.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}e(a.prototype,{writable:{__proto__:null,...t(i.prototype,"writable")},writableHighWaterMark:{__proto__:null,...t(i.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...t(i.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...t(i.prototype,"writableBuffer")},writableLength:{__proto__:null,...t(i.prototype,"writableLength")},writableFinished:{__proto__:null,...t(i.prototype,"writableFinished")},writableCorked:{__proto__:null,...t(i.prototype,"writableCorked")},writableEnded:{__proto__:null,...t(i.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...t(i.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(u){this._readableState&&this._writableState&&(this._readableState.destroyed=u,this._writableState.destroyed=u)}}});let o;function l(){return o===void 0&&(o={}),o}a.fromWeb=function(u,d){return l().newStreamDuplexFromReadableWritablePair(u,d)},a.toWeb=function(u){return l().newReadableWritablePairFromDuplex(u)};let c;return a.from=function(u){return c||(c=aSe()),c(u,"body")},MM}var IM,C9;function uY(){if(C9)return IM;C9=1;const{ObjectSetPrototypeOf:e,Symbol:t}=ni();IM=a;const{ERR_METHOD_NOT_IMPLEMENTED:n}=go().codes,r=Xd(),{getHighWaterMark:s}=eT();e(a.prototype,r.prototype),e(a,r);const i=t("kCallback");function a(c){if(!(this instanceof a))return new a(c);const u=c?s(this,c,"readableHighWaterMark",!0):null;u===0&&(c={...c,highWaterMark:null,readableHighWaterMark:u,writableHighWaterMark:c.writableHighWaterMark||0}),r.call(this,c),this._readableState.sync=!1,this[i]=null,c&&(typeof c.transform=="function"&&(this._transform=c.transform),typeof c.flush=="function"&&(this._flush=c.flush)),this.on("prefinish",l)}function o(c){typeof this._flush=="function"&&!this.destroyed?this._flush((u,d)=>{if(u){c?c(u):this.destroy(u);return}d!=null&&this.push(d),this.push(null),c&&c()}):(this.push(null),c&&c())}function l(){this._final!==o&&o.call(this)}return a.prototype._final=o,a.prototype._transform=function(c,u,d){throw new n("_transform()")},a.prototype._write=function(c,u,d){const h=this._readableState,m=this._writableState,y=h.length;this._transform(c,u,(b,v)=>{if(b){d(b);return}v!=null&&this.push(v),m.ended||y===h.length||h.length<h.highWaterMark?d():this[i]=d})},a.prototype._read=function(){if(this[i]){const c=this[i];this[i]=null,c()}},IM}var jM,k9;function dY(){if(k9)return jM;k9=1;const{ObjectSetPrototypeOf:e}=ni();jM=n;const t=uY();e(n.prototype,t.prototype),e(n,t);function n(r){if(!(this instanceof n))return new n(r);t.call(this,r)}return n.prototype._transform=function(r,s,i){i(null,r)},jM}var PM,E9;function rD(){if(E9)return PM;E9=1;const e=tg(),{ArrayIsArray:t,Promise:n,SymbolAsyncIterator:r,SymbolDispose:s}=ni(),i=sp(),{once:a}=Oo(),o=tb(),l=Xd(),{aggregateTwoErrors:c,codes:{ERR_INVALID_ARG_TYPE:u,ERR_INVALID_RETURN_VALUE:d,ERR_MISSING_ARGS:h,ERR_STREAM_DESTROYED:m,ERR_STREAM_PREMATURE_CLOSE:y},AbortError:b}=go(),{validateFunction:v,validateAbortSignal:x}=A1(),{isIterable:w,isReadable:S,isReadableNodeStream:k,isNodeStream:C,isTransformStream:T,isWebStream:A,isReadableStream:N,isReadableFinished:I}=of(),O=globalThis.AbortController||gw().AbortController;let B,D,H;function P(re,pe,de){let Oe=!1;re.on("close",()=>{Oe=!0});const Fe=i(re,{readable:pe,writable:de},Se=>{Oe=!Se});return{destroy:Se=>{Oe||(Oe=!0,o.destroyer(re,Se||new m("pipe")))},cleanup:Fe}}function K(re){return v(re[re.length-1],"streams[stream.length - 1]"),re.pop()}function U(re){if(w(re))return re;if(k(re))return V(re);throw new u("val",["Readable","Iterable","AsyncIterable"],re)}async function*V(re){D||(D=tT()),yield*D.prototype[r].call(re)}async function L(re,pe,de,{end:Oe}){let Fe,Se=null;const Ce=We=>{if(We&&(Fe=We),Se){const je=Se;Se=null,je()}},qe=()=>new n((We,je)=>{Fe?je(Fe):Se=()=>{Fe?je(Fe):We()}});pe.on("drain",Ce);const Qe=i(pe,{readable:!1},Ce);try{pe.writableNeedDrain&&await qe();for await(const We of re)pe.write(We)||await qe();Oe&&(pe.end(),await qe()),de()}catch(We){de(Fe!==We?c(Fe,We):We)}finally{Qe(),pe.off("drain",Ce)}}async function te(re,pe,de,{end:Oe}){T(pe)&&(pe=pe.writable);const Fe=pe.getWriter();try{for await(const Se of re)await Fe.ready,Fe.write(Se).catch(()=>{});await Fe.ready,Oe&&await Fe.close(),de()}catch(Se){try{await Fe.abort(Se),de(Se)}catch(Ce){de(Ce)}}}function W(...re){return Q(re,a(K(re)))}function Q(re,pe,de){if(re.length===1&&t(re[0])&&(re=re[0]),re.length<2)throw new h("streams");const Oe=new O,Fe=Oe.signal,Se=de==null?void 0:de.signal,Ce=[];x(Se,"options.signal");function qe(){ce(new b)}H=H||Oo().addAbortListener;let Qe;Se&&(Qe=H(Se,qe));let We,je;const Y=[];let ye=0;function Ie(Be){ce(Be,--ye===0)}function ce(Be,Ae){var lt;if(Be&&(!We||We.code==="ERR_STREAM_PREMATURE_CLOSE")&&(We=Be),!(!We&&!Ae)){for(;Y.length;)Y.shift()(We);(lt=Qe)===null||lt===void 0||lt[s](),Oe.abort(),Ae&&(We||Ce.forEach(Tt=>Tt()),e.nextTick(pe,We,je))}}let oe;for(let Be=0;Be<re.length;Be++){const Ae=re[Be],lt=Be<re.length-1,Tt=Be>0,dt=lt||(de==null?void 0:de.end)!==!1,Pt=Be===re.length-1;if(C(Ae)){let qt=function(Ft){Ft&&Ft.name!=="AbortError"&&Ft.code!=="ERR_STREAM_PREMATURE_CLOSE"&&Ie(Ft)};if(dt){const{destroy:Ft,cleanup:Ht}=P(Ae,lt,Tt);Y.push(Ft),S(Ae)&&Pt&&Ce.push(Ht)}Ae.on("error",qt),S(Ae)&&Pt&&Ce.push(()=>{Ae.removeListener("error",qt)})}if(Be===0)if(typeof Ae=="function"){if(oe=Ae({signal:Fe}),!w(oe))throw new d("Iterable, AsyncIterable or Stream","source",oe)}else w(Ae)||k(Ae)||T(Ae)?oe=Ae:oe=l.from(Ae);else if(typeof Ae=="function"){if(T(oe)){var se;oe=U((se=oe)===null||se===void 0?void 0:se.readable)}else oe=U(oe);if(oe=Ae(oe,{signal:Fe}),lt){if(!w(oe,!0))throw new d("AsyncIterable",`transform[${Be-1}]`,oe)}else{var Me;B||(B=dY());const qt=new B({objectMode:!0}),Ft=(Me=oe)===null||Me===void 0?void 0:Me.then;if(typeof Ft=="function")ye++,Ft.call(oe,F=>{je=F,F!=null&&qt.write(F),dt&&qt.end(),e.nextTick(Ie)},F=>{qt.destroy(F),e.nextTick(Ie,F)});else if(w(oe,!0))ye++,L(oe,qt,Ie,{end:dt});else if(N(oe)||T(oe)){const F=oe.readable||oe;ye++,L(F,qt,Ie,{end:dt})}else throw new d("AsyncIterable or Promise","destination",oe);oe=qt;const{destroy:Ht,cleanup:we}=P(oe,!1,!0);Y.push(Ht),Pt&&Ce.push(we)}}else if(C(Ae)){if(k(oe)){ye+=2;const qt=ee(oe,Ae,Ie,{end:dt});S(Ae)&&Pt&&Ce.push(qt)}else if(T(oe)||N(oe)){const qt=oe.readable||oe;ye++,L(qt,Ae,Ie,{end:dt})}else if(w(oe))ye++,L(oe,Ae,Ie,{end:dt});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],oe);oe=Ae}else if(A(Ae)){if(k(oe))ye++,te(U(oe),Ae,Ie,{end:dt});else if(N(oe)||w(oe))ye++,te(oe,Ae,Ie,{end:dt});else if(T(oe))ye++,te(oe.readable,Ae,Ie,{end:dt});else throw new u("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],oe);oe=Ae}else oe=l.from(Ae)}return(Fe!=null&&Fe.aborted||Se!=null&&Se.aborted)&&e.nextTick(qe),oe}function ee(re,pe,de,{end:Oe}){let Fe=!1;if(pe.on("close",()=>{Fe||de(new y)}),re.pipe(pe,{end:!1}),Oe){let Se=function(){Fe=!0,pe.end()};I(re)?e.nextTick(Se):re.once("end",Se)}else de();return i(re,{readable:!0,writable:!1},Se=>{const Ce=re._readableState;Se&&Se.code==="ERR_STREAM_PREMATURE_CLOSE"&&Ce&&Ce.ended&&!Ce.errored&&!Ce.errorEmitted?re.once("end",de).once("error",de):de(Se)}),i(pe,{readable:!1,writable:!0},de)}return PM={pipelineImpl:Q,pipeline:W},PM}var OM,T9;function fY(){if(T9)return OM;T9=1;const{pipeline:e}=rD(),t=Xd(),{destroyer:n}=tb(),{isNodeStream:r,isReadable:s,isWritable:i,isWebStream:a,isTransformStream:o,isWritableStream:l,isReadableStream:c}=of(),{AbortError:u,codes:{ERR_INVALID_ARG_VALUE:d,ERR_MISSING_ARGS:h}}=go(),m=sp();return OM=function(...b){if(b.length===0)throw new h("streams");if(b.length===1)return t.from(b[0]);const v=[...b];if(typeof b[0]=="function"&&(b[0]=t.from(b[0])),typeof b[b.length-1]=="function"){const B=b.length-1;b[B]=t.from(b[B])}for(let B=0;B<b.length;++B)if(!(!r(b[B])&&!a(b[B]))){if(B<b.length-1&&!(s(b[B])||c(b[B])||o(b[B])))throw new d(`streams[${B}]`,v[B],"must be readable");if(B>0&&!(i(b[B])||l(b[B])||o(b[B])))throw new d(`streams[${B}]`,v[B],"must be writable")}let x,w,S,k,C;function T(B){const D=k;k=null,D?D(B):B?C.destroy(B):!O&&!I&&C.destroy()}const A=b[0],N=e(b,T),I=!!(i(A)||l(A)||o(A)),O=!!(s(N)||c(N)||o(N));if(C=new t({writableObjectMode:!!(A!=null&&A.writableObjectMode),readableObjectMode:!!(N!=null&&N.readableObjectMode),writable:I,readable:O}),I){if(r(A))C._write=function(D,H,P){A.write(D,H)?P():x=P},C._final=function(D){A.end(),w=D},A.on("drain",function(){if(x){const D=x;x=null,D()}});else if(a(A)){const H=(o(A)?A.writable:A).getWriter();C._write=async function(P,K,U){try{await H.ready,H.write(P).catch(()=>{}),U()}catch(V){U(V)}},C._final=async function(P){try{await H.ready,H.close().catch(()=>{}),w=P}catch(K){P(K)}}}const B=o(N)?N.readable:N;m(B,()=>{if(w){const D=w;w=null,D()}})}if(O){if(r(N))N.on("readable",function(){if(S){const B=S;S=null,B()}}),N.on("end",function(){C.push(null)}),C._read=function(){for(;;){const B=N.read();if(B===null){S=C._read;return}if(!C.push(B))return}};else if(a(N)){const D=(o(N)?N.readable:N).getReader();C._read=async function(){for(;;)try{const{value:H,done:P}=await D.read();if(!C.push(H))return;if(P){C.push(null);return}}catch{return}}}}return C._destroy=function(B,D){!B&&k!==null&&(B=new u),S=null,x=null,w=null,k===null?D(B):(k=D,r(N)&&n(N,B))},C},OM}var A9;function oSe(){if(A9)return US;A9=1;const e=globalThis.AbortController||gw().AbortController,{codes:{ERR_INVALID_ARG_VALUE:t,ERR_INVALID_ARG_TYPE:n,ERR_MISSING_ARGS:r,ERR_OUT_OF_RANGE:s},AbortError:i}=go(),{validateAbortSignal:a,validateInteger:o,validateObject:l}=A1(),c=ni().Symbol("kWeak"),u=ni().Symbol("kResistStopPropagation"),{finished:d}=sp(),h=fY(),{addAbortSignalNoValidate:m}=QE(),{isWritable:y,isNodeStream:b}=of(),{deprecate:v}=Oo(),{ArrayPrototypePush:x,Boolean:w,MathFloor:S,Number:k,NumberIsNaN:C,Promise:T,PromiseReject:A,PromiseResolve:N,PromisePrototypeThen:I,Symbol:O}=ni(),B=O("kEmpty"),D=O("kEof");function H(Se,Ce){if(Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),b(Se)&&!y(Se))throw new t("stream",Se,"must be writable");const qe=h(this,Se);return Ce!=null&&Ce.signal&&m(Ce.signal,qe),qe}function P(Se,Ce){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal");let qe=1;(Ce==null?void 0:Ce.concurrency)!=null&&(qe=S(Ce.concurrency));let Qe=qe-1;return(Ce==null?void 0:Ce.highWaterMark)!=null&&(Qe=S(Ce.highWaterMark)),o(qe,"options.concurrency",1),o(Qe,"options.highWaterMark",0),Qe+=qe,(async function*(){const je=Oo().AbortSignalAny([Ce==null?void 0:Ce.signal].filter(w)),Y=this,ye=[],Ie={signal:je};let ce,oe,se=!1,Me=0;function Be(){se=!0,Ae()}function Ae(){Me-=1,lt()}function lt(){oe&&!se&&Me<qe&&ye.length<Qe&&(oe(),oe=null)}async function Tt(){try{for await(let dt of Y){if(se)return;if(je.aborted)throw new i;try{if(dt=Se(dt,Ie),dt===B)continue;dt=N(dt)}catch(Pt){dt=A(Pt)}Me+=1,I(dt,Ae,Be),ye.push(dt),ce&&(ce(),ce=null),!se&&(ye.length>=Qe||Me>=qe)&&await new T(Pt=>{oe=Pt})}ye.push(D)}catch(dt){const Pt=A(dt);I(Pt,Ae,Be),ye.push(Pt)}finally{se=!0,ce&&(ce(),ce=null)}}Tt();try{for(;;){for(;ye.length>0;){const dt=await ye[0];if(dt===D)return;if(je.aborted)throw new i;dt!==B&&(yield dt),ye.shift(),lt()}await new T(dt=>{ce=dt})}}finally{se=!0,oe&&(oe(),oe=null)}}).call(this)}function K(Se=void 0){return Se!=null&&l(Se,"options"),(Se==null?void 0:Se.signal)!=null&&a(Se.signal,"options.signal"),(async function*(){let qe=0;for await(const We of this){var Qe;if(Se!=null&&(Qe=Se.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i({cause:Se.signal.reason});yield[qe++,We]}}).call(this)}async function U(Se,Ce=void 0){for await(const qe of W.call(this,Se,Ce))return!0;return!1}async function V(Se,Ce=void 0){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);return!await U.call(this,async(...qe)=>!await Se(...qe),Ce)}async function L(Se,Ce){for await(const qe of W.call(this,Se,Ce))return qe}async function te(Se,Ce){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);async function qe(Qe,We){return await Se(Qe,We),B}for await(const Qe of P.call(this,qe,Ce));}function W(Se,Ce){if(typeof Se!="function")throw new n("fn",["Function","AsyncFunction"],Se);async function qe(Qe,We){return await Se(Qe,We)?Qe:B}return P.call(this,qe,Ce)}class Q extends r{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}}async function ee(Se,Ce,qe){var Qe;if(typeof Se!="function")throw new n("reducer",["Function","AsyncFunction"],Se);qe!=null&&l(qe,"options"),(qe==null?void 0:qe.signal)!=null&&a(qe.signal,"options.signal");let We=arguments.length>1;if(qe!=null&&(Qe=qe.signal)!==null&&Qe!==void 0&&Qe.aborted){const ce=new i(void 0,{cause:qe.signal.reason});throw this.once("error",()=>{}),await d(this.destroy(ce)),ce}const je=new e,Y=je.signal;if(qe!=null&&qe.signal){const ce={once:!0,[c]:this,[u]:!0};qe.signal.addEventListener("abort",()=>je.abort(),ce)}let ye=!1;try{for await(const ce of this){var Ie;if(ye=!0,qe!=null&&(Ie=qe.signal)!==null&&Ie!==void 0&&Ie.aborted)throw new i;We?Ce=await Se(Ce,ce,{signal:Y}):(Ce=ce,We=!0)}if(!ye&&!We)throw new Q}finally{je.abort()}return Ce}async function re(Se){Se!=null&&l(Se,"options"),(Se==null?void 0:Se.signal)!=null&&a(Se.signal,"options.signal");const Ce=[];for await(const Qe of this){var qe;if(Se!=null&&(qe=Se.signal)!==null&&qe!==void 0&&qe.aborted)throw new i(void 0,{cause:Se.signal.reason});x(Ce,Qe)}return Ce}function pe(Se,Ce){const qe=P.call(this,Se,Ce);return(async function*(){for await(const We of qe)yield*We}).call(this)}function de(Se){if(Se=k(Se),C(Se))return 0;if(Se<0)throw new s("number",">= 0",Se);return Se}function Oe(Se,Ce=void 0){return Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),Se=de(Se),(async function*(){var Qe;if(Ce!=null&&(Qe=Ce.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i;for await(const je of this){var We;if(Ce!=null&&(We=Ce.signal)!==null&&We!==void 0&&We.aborted)throw new i;Se--<=0&&(yield je)}}).call(this)}function Fe(Se,Ce=void 0){return Ce!=null&&l(Ce,"options"),(Ce==null?void 0:Ce.signal)!=null&&a(Ce.signal,"options.signal"),Se=de(Se),(async function*(){var Qe;if(Ce!=null&&(Qe=Ce.signal)!==null&&Qe!==void 0&&Qe.aborted)throw new i;for await(const je of this){var We;if(Ce!=null&&(We=Ce.signal)!==null&&We!==void 0&&We.aborted)throw new i;if(Se-- >0&&(yield je),Se<=0)return}}).call(this)}return US.streamReturningOperators={asIndexedPairs:v(K,"readable.asIndexedPairs will be removed in a future version."),drop:Oe,filter:W,flatMap:pe,map:P,take:Fe,compose:H},US.promiseReturningOperators={every:V,forEach:te,reduce:ee,toArray:re,some:U,find:L},US}var DM,R9;function hY(){if(R9)return DM;R9=1;const{ArrayPrototypePop:e,Promise:t}=ni(),{isIterable:n,isNodeStream:r,isWebStream:s}=of(),{pipelineImpl:i}=rD(),{finished:a}=sp();pY();function o(...l){return new t((c,u)=>{let d,h;const m=l[l.length-1];if(m&&typeof m=="object"&&!r(m)&&!n(m)&&!s(m)){const y=e(l);d=y.signal,h=y.end}i(l,(y,b)=>{y?u(y):c(b)},{signal:d,end:h})})}return DM={finished:a,pipeline:o},DM}var N9;function pY(){if(N9)return fM.exports;N9=1;const{Buffer:e}=rp(),{ObjectDefineProperty:t,ObjectKeys:n,ReflectApply:r}=ni(),{promisify:{custom:s}}=Oo(),{streamReturningOperators:i,promiseReturningOperators:a}=oSe(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:o}}=go(),l=fY(),{setDefaultHighWaterMark:c,getDefaultHighWaterMark:u}=eT(),{pipeline:d}=rD(),{destroyer:h}=tb(),m=sp(),y=hY(),b=of(),v=fM.exports=eD().Stream;v.isDestroyed=b.isDestroyed,v.isDisturbed=b.isDisturbed,v.isErrored=b.isErrored,v.isReadable=b.isReadable,v.isWritable=b.isWritable,v.Readable=tT();for(const w of n(i)){let k=function(...C){if(new.target)throw o();return v.Readable.from(r(S,this,C))};const S=i[w];t(k,"name",{__proto__:null,value:S.name}),t(k,"length",{__proto__:null,value:S.length}),t(v.Readable.prototype,w,{__proto__:null,value:k,enumerable:!1,configurable:!0,writable:!0})}for(const w of n(a)){let k=function(...C){if(new.target)throw o();return r(S,this,C)};const S=a[w];t(k,"name",{__proto__:null,value:S.name}),t(k,"length",{__proto__:null,value:S.length}),t(v.Readable.prototype,w,{__proto__:null,value:k,enumerable:!1,configurable:!0,writable:!0})}v.Writable=nD(),v.Duplex=Xd(),v.Transform=uY(),v.PassThrough=dY(),v.pipeline=d;const{addAbortSignal:x}=QE();return v.addAbortSignal=x,v.finished=m,v.destroy=h,v.compose=l,v.setDefaultHighWaterMark=c,v.getDefaultHighWaterMark=u,t(v,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return y}}),t(d,s,{__proto__:null,enumerable:!0,get(){return y.pipeline}}),t(m,s,{__proto__:null,enumerable:!0,get(){return y.finished}}),v.Stream=v,v._isUint8Array=function(S){return S instanceof Uint8Array},v._uint8ArrayToBuffer=function(S){return e.from(S.buffer,S.byteOffset,S.byteLength)},fM.exports}var M9;function lSe(){return M9||(M9=1,function(e){const t=pY(),n=hY(),r=t.Readable.destroy;e.exports=t.Readable,e.exports._uint8ArrayToBuffer=t._uint8ArrayToBuffer,e.exports._isUint8Array=t._isUint8Array,e.exports.isDisturbed=t.isDisturbed,e.exports.isErrored=t.isErrored,e.exports.isReadable=t.isReadable,e.exports.Readable=t.Readable,e.exports.Writable=t.Writable,e.exports.Duplex=t.Duplex,e.exports.Transform=t.Transform,e.exports.PassThrough=t.PassThrough,e.exports.addAbortSignal=t.addAbortSignal,e.exports.finished=t.finished,e.exports.destroy=t.destroy,e.exports.destroy=r,e.exports.pipeline=t.pipeline,e.exports.compose=t.compose,Object.defineProperty(t,"promises",{configurable:!0,enumerable:!0,get(){return n}}),e.exports.Stream=t.Stream,e.exports.default=e.exports}(dM)),dM.exports}var mY=lSe();class sD extends mY.Readable{constructor(t={},n){var r;super({...t,encoding:(r=t.encoding)!==null&&r!==void 0?r:void 0}),this.pending=!0,this._path="<unknown>",this._bytesRead=0,this.ready=Promise.resolve(n).then(s=>{this._path=s.path;const i=s.readableWebStream({start:t.start,end:t.end});this.reader=i.getReader(),this.pending=!1}).catch(s=>{this.destroy(s)})}async _read(){try{if(await this.ready,!this.reader)return;const{done:t,value:n}=await this.reader.read();if(t){this.push(null);return}this._bytesRead+=n.byteLength,this.push(n)}catch(t){this.destroy(new Xe(vt.EIO,t.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Xe(vt.EIO,n.toString()))}}get path(){return this._path}get bytesRead(){return this._bytesRead}wrap(t){return super.wrap(t),this}}class iD extends mY.Writable{constructor(t={},n){super(t),this.pending=!0,this._path="<unknown>",this._bytesWritten=0,this.ready=Promise.resolve(n).then(r=>{this._path=r.path;const s=r.writableWebStream({start:t.start});this.writer=s.getWriter(),this.pending=!1}).catch(r=>this.destroy(r))}async _write(t,n,r){if(await this.ready,!this.writer)return r(Fa(new Xe(vt.EAGAIN,"Underlying writable stream not ready",this._path)));if(n!="buffer")return r(Fa(new Xe(vt.ENOTSUP,"Unsupported encoding for stream",this._path)));const s=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);try{await this.writer.write(s),this._bytesWritten+=t.byteLength,r()}catch(i){r(new Xe(vt.EIO,i.toString()))}}async _final(t){if(await this.ready,!this.writer)return t();try{await this.writer.close(),t()}catch(n){t(new Xe(vt.EIO,n.toString()))}}close(t=()=>null){try{this.destroy(),this.emit("close"),t(null)}catch(n){t(new Xe(vt.EIO,n.toString()))}}get path(){return this._path}get bytesWritten(){return this._bytesWritten}}var tc=function(e,t,n){if(t!=null){if(typeof t!="object"&&typeof t!="function")throw new TypeError("Object expected.");var r,s;if(n){if(!Symbol.asyncDispose)throw new TypeError("Symbol.asyncDispose is not defined.");r=t[Symbol.asyncDispose]}if(r===void 0){if(!Symbol.dispose)throw new TypeError("Symbol.dispose is not defined.");r=t[Symbol.dispose],n&&(s=r)}if(typeof r!="function")throw new TypeError("Object not disposable.");s&&(r=function(){try{s.call(this)}catch(i){return Promise.reject(i)}}),e.stack.push({value:t,dispose:r,async:n})}else n&&e.stack.push({async:!0});return t},nc=function(e){return function(t){function n(a){t.error=t.hasError?new e(a,t.error,"An error was suppressed during disposal."):a,t.hasError=!0}var r,s=0;function i(){for(;r=t.stack.pop();)try{if(!r.async&&s===1)return s=0,t.stack.push(r),Promise.resolve().then(i);if(r.dispose){var a=r.dispose.call(r.value);if(r.async)return s|=2,Promise.resolve(a).then(i,function(o){return n(o),i()})}else s|=1}catch(o){n(o)}if(s===1)return t.hasError?Promise.reject(t.error):Promise.resolve();if(t.hasError)throw t.error}return i()}}(typeof SuppressedError=="function"?SuppressedError:function(e,t,n){var r=new Error(n);return r.name="SuppressedError",r.error=e,r.suppressed=t,r});class za{get position(){return this.flag&Mm?this.inode.size:this._position}set position(t){this._position=t}constructor(t,n){this.context=t,this.fd=n,this._position=0,this.dirty=!1,this.closed=!1;const r=Wa(t,n);Object.assign(this,Hm(r,"path","fs","internalPath","flag","inode"))}get _isSync(){return!!(this.flag&YE||this.inode.flags&No.Sync)}_emitChange(){ka(this.context,"change",this.path)}async chown(t,n){if(this.closed)throw Xe.With("EBADF",this.path,"chown");this.dirty=!0,GK(this.inode,t,n),this._isSync&&await this.sync(),this._emitChange()}async chmod(t){const n=tp(t,-1);if(n<0)throw new Xe(vt.EINVAL,"Invalid mode");if(this.closed)throw Xe.With("EBADF",this.path,"chmod");this.dirty=!0,this.inode.mode=this.inode.mode&(n>ks?-61441:ks)|n,(this._isSync||n>ks)&&await this.sync(),this._emitChange()}datasync(){return this.sync()}async sync(){if(this.closed)throw Xe.With("EBADF",this.path,"sync");this.dirty&&(this.fs.attributes.has("no_write")||await this.fs.touch(this.internalPath,this.inode),this.dirty=!1)}async truncate(t=0){if(this.closed)throw Xe.With("EBADF",this.path,"truncate");if(t<0)throw new Xe(vt.EINVAL);if(this.dirty=!0,!(this.flag&Da||this.flag&Bd))throw new Xe(vt.EPERM,"File not opened with a writeable mode",this.path,"truncate");this.inode.mtimeMs=Date.now(),this.inode.size=t,this._isSync&&await this.sync(),this._emitChange()}async utimes(t,n){if(this.closed)throw Xe.With("EBADF",this.path,"utimes");this.dirty=!0,this.inode.atimeMs=K2(t),this.inode.mtimeMs=K2(n),this._isSync&&await this.sync(),this._emitChange()}async appendFile(t,n={}){const r=$d(n,"utf8","a",420);if(!(zd(r.flag)&Mm))throw new Xe(vt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!r.encoding)throw new Xe(vt.EINVAL,"Encoding not specified");const i=typeof t=="string"?Ds.from(t,r.encoding):t;await this._write(i,0,i.length),this._emitChange()}async _read(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Xe.With("EBADF",this.path,"read");if(this.flag&Da)throw new Xe(vt.EPERM,"File not opened with a readable mode");this.inode.flags&No.NoAtime||(this.dirty=!0,this.inode.atimeMs=Date.now());let i=s+r;!hw(this.inode)&&!fw(this.inode)&&i>this.inode.size&&(i=s+Math.max(this.inode.size-s,0)),this._position=i;const a=new Uint8Array(t.buffer,t.byteOffset,t.byteLength);return await this.fs.read(this.internalPath,a.subarray(n,n+r),s,i),this._isSync&&await this.sync(),{bytesRead:i-s,buffer:t}}async read(t,n,r,s){typeof n=="object"&&n!=null&&(s=n.position,r=n.length,n=n.offset),!ArrayBuffer.isView(t)&&typeof t=="object"&&(s=t.position,r=t.length,n=t.offset,t=t.buffer);const i=Number.isSafeInteger(s)?s:this.position;return t||(t=new Uint8Array(this.inode.size)),n??(n=0),this._read(t,n,r??t.byteLength-n,i)}async readFile(t){const n=$d(t,null,"r",292);if(zd(n.flag)&Da)throw new Xe(vt.EINVAL,"Flag passed must allow for reading",this.path,"readFile");const{size:s}=await this.stat(),{buffer:i}=await this._read(new Uint8Array(s),0,s,0),a=Ds.from(i);return n.encoding?a.toString(n.encoding):a}readableWebStream(t={}){if(this.closed)throw Xe.With("EBADF",this.path,"readableWebStream");return this.fs.streamRead(this.internalPath,t)}writableWebStream(t={}){if(this.closed)throw Xe.With("EBADF",this.path,"writableWebStream");if(this.inode.flags&No.Immutable)throw new Xe(vt.EPERM,"File is immutable",this.path,"writableWebStream");return this.fs.streamWrite(this.internalPath,t)}readLines(t){if(this.closed||this.flag&Da)throw Xe.With("EBADF",this.path,"readLines");return T_e({input:this.createReadStream(t),crlfDelay:1/0})}[Symbol.asyncDispose](){return this.close()}async stat(t){if(this.closed)throw Xe.With("EBADF",this.path,"stat");if(!hs(this.context,this.inode,Hi))throw Xe.With("EACCES",this.path,"stat");return t!=null&&t.bigint?new Jm(this.inode):new af(this.inode)}async _write(t,n=0,r=t.byteLength-n,s=this.position){if(this.closed)throw Xe.With("EBADF",this.path,"write");if(this.inode.flags&No.Immutable)throw new Xe(vt.EPERM,"File is immutable",this.path,"write");if(!(this.flag&Da||this.flag&Bd))throw new Xe(vt.EPERM,"File not opened with a writeable mode",this.path,"write");this.dirty=!0;const i=s+r,a=t.subarray(n,n+r);return!hw(this.inode)&&!fw(this.inode)&&i>this.inode.size&&(this.inode.size=i),this.inode.mtimeMs=Date.now(),this.inode.ctimeMs=Date.now(),this._position=s+a.byteLength,await this.fs.write(this.internalPath,a,s),this._isSync&&await this.sync(),a.byteLength}async write(t,n,r,s){let i,a,o;typeof n=="object"&&n!=null&&(r=n.length,s=n.position,n=n.offset),typeof t=="string"?(s=typeof n=="number"?n:null,a=0,i=Ds.from(t,typeof r=="string"?r:"utf8"),o=i.length):(i=new Uint8Array(t.buffer,t.byteOffset,t.byteLength),a=n??0,o=typeof r=="number"?r:i.byteLength,s=typeof s=="number"?s:null),s??(s=this.position);const l=await this._write(i,a,o,s);return this._emitChange(),{buffer:t,bytesWritten:l}}async writeFile(t,n={}){const r=$d(n,"utf8","w",420),s=zd(r.flag);if(!(s&Da||s&Bd))throw new Xe(vt.EINVAL,"Flag passed must allow for writing",this.path,"writeFile");if(typeof t!="string"&&!r.encoding)throw new Xe(vt.EINVAL,"Encoding not specified");const i=typeof t=="string"?Ds.from(t,r.encoding):t;await this._write(i,0,i.length,0),this._emitChange()}async close(){if(this.closed)throw Xe.With("EBADF",this.path,"close");await this.sync(),this.dispose(),ZK(this.context,this.fd)}dispose(t){if(this.closed)throw Xe.With("EBADF",this.path,"dispose");if(this.dirty&&!t)throw Xe.With("EBUSY",this.path,"dispose");this.closed=!0}async writev(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const s of t)r+=(await this.write(s)).bytesWritten;return{bytesWritten:r,buffers:t}}async readv(t,n){typeof n=="number"&&(this.position=n);let r=0;for(const s of t)r+=(await this.read(s)).bytesRead;return{bytesRead:r,buffers:t}}createReadStream(t={}){if(this.closed||this.flag&Da)throw Xe.With("EBADF",this.path,"createReadStream");return new sD(t,this)}createWriteStream(t={}){if(this.closed)throw Xe.With("EBADF",this.path,"createWriteStream");if(this.inode.flags&No.Immutable)throw new Xe(vt.EPERM,"File is immutable",this.path,"createWriteStream");return new iD(t,this)}}async function gY(e,t){e=Bn(e),t=Bn(t);const n=Ir(e,this),r=Ir(t,this);if(!(await nb.call(this,Xr(e))).hasAccess(ci,this))throw Xe.With("EACCES",e,"rename");try{if(n.mountPoint==r.mountPoint){await n.fs.rename(n.path,r.path),ka(this,"rename",e.toString()),ka(this,"change",t.toString());return}await iT.call(this,t,await sT(e)),await rT.call(this,e),ka(this,"rename",e.toString())}catch(s){throw ps(s,{[n.path]:e,[r.path]:t})}}async function R1(e){try{const{fs:t,path:n}=Ir(await ip.call(this,e),this);return await t.exists(n)}catch(t){if(t instanceof Xe&&t.code=="ENOENT")return!1;throw t}}async function nb(e,t){e=Bn(e);const{fs:n,path:r}=Ir(await ip.call(this,e),this);try{const s=await n.stat(r);if(Gi&&!hs(this,s,Hi))throw Xe.With("EACCES",r,"stat");return t!=null&&t.bigint?new Jm(s):new af(s)}catch(s){throw ps(s,{[r]:e})}}async function nT(e,t){e=Bn(e);const{fs:n,path:r}=Ir(e,this);try{const s=await n.stat(r);if(Gi&&!hs(this,s,Hi))throw Xe.With("EACCES",r,"lstat");return t!=null&&t.bigint?new Jm(s):new af(s)}catch(s){throw ps(s,{[r]:e})}}async function yY(e,t=0){const n={stack:[],error:void 0,hasError:!1};try{await tc(n,await rc.call(this,e,"r+"),!0).truncate(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=nc(n);r&&await r}}async function rT(e){e=Bn(e);const{fs:t,path:n}=Ir(e,this);try{if(Gi&&!hs(this,await t.stat(n),ci))throw Xe.With("EACCES",n,"unlink");await t.unlink(n),ka(this,"rename",e.toString())}catch(r){throw ps(r,{[n]:e})}}async function rb(e,t,n){var r;t=Bn(t);const s=tp(n.mode,420),i=zd(n.flag),{fullPath:a,fs:o,path:l,stats:c}=await J2(e,t.toString(),n.preserveSymlinks);if(!c){if(!(i&HE))throw Xe.With("ENOENT",a,"_open");const d=await o.stat(Xr(l));if(!hs(e,d,ci))throw Xe.With("EACCES",Xr(a),"_open");if(!Bc(d))throw Xe.With("ENOTDIR",Xr(a),"_open");const{euid:h,egid:m}=(r=e==null?void 0:e.credentials)!==null&&r!==void 0?r:qc.credentials,y=await o.createFile(l,{mode:s,uid:d.mode&C1?d.uid:h,gid:d.mode&k1?d.gid:m});return new za(e,Z2(new Y2(e,t,o,l,i,y)))}if(!hs(e,c,XK(i)))throw Xe.With("EACCES",a,"_open");if(i&GE)throw Xe.With("EEXIST",a,"_open");const u=new za(e,Z2(new Y2(e,t,o,l,i,c)));return i&KE&&await u.truncate(0),u}async function rc(e,t="r",n=420){return await rb(this,e,{flag:t,mode:n})}async function sT(e,t){const n={stack:[],error:void 0,hasError:!1};try{const r=$d(t,null,"r",292);return await tc(n,typeof e=="object"&&"fd"in e?e:await rc.call(this,e,r.flag,r.mode),!0).readFile(r)}catch(r){n.error=r,n.hasError=!0}finally{const r=nc(n);r&&await r}}async function iT(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=$d(n,"utf8","w+",420),i=tc(r,e instanceof za?e:await rc.call(this,e.toString(),s.flag,s.mode),!0),a=typeof t=="string"?t:t instanceof DataView?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t;if(typeof a!="string"&&!(a instanceof Uint8Array))throw new Xe(vt.EINVAL,'The "data" argument must be of type string or an instance of Buffer, TypedArray, or DataView. Received '+typeof t,i.path,"writeFile");await i.writeFile(a,s)}catch(s){r.error=s,r.hasError=!0}finally{const s=nc(r);s&&await s}}async function bY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{const s=$d(n,"utf8","a",420);if(!(zd(s.flag)&Mm))throw new Xe(vt.EINVAL,"Flag passed to appendFile must allow for appending");if(typeof t!="string"&&!s.encoding)throw new Xe(vt.EINVAL,"Encoding not specified");const a=typeof t=="string"?Ds.from(t,s.encoding):new Uint8Array(t.buffer,t.byteOffset,t.byteLength);await tc(r,typeof e=="object"&&"fd"in e?e:await rc.call(this,e,s.flag,s.mode),!0).appendFile(a,s)}catch(s){r.error=s,r.hasError=!0}finally{const s=nc(r);s&&await s}}async function aD(e){e=await ip.call(this,e);const{fs:t,path:n}=Ir(e,this);try{const r=await t.stat(n);if(!r)throw Xe.With("ENOENT",e,"rmdir");if(!Bc(r))throw Xe.With("ENOTDIR",n,"rmdir");if(Gi&&!hs(this,r,ci))throw Xe.With("EACCES",n,"rmdir");await t.rmdir(n),ka(this,"rename",e.toString())}catch(r){throw ps(r,{[n]:e})}}async function aT(e,t){var n,r;const{euid:s,egid:i}=(n=this===null||this===void 0?void 0:this.credentials)!==null&&n!==void 0?n:qc.credentials;t=typeof t=="object"?t:{mode:t};const a=tp(t==null?void 0:t.mode,511);e=await ip.call(this,e);const{fs:o,path:l,root:c}=Ir(e,this),u={[l]:e},d=async(h,m)=>{if(!hs(this,m,ci))throw Xe.With("EACCES",Xr(h),"mkdir");const y=await o.mkdir(h,{mode:a,uid:m.mode&C1?m.uid:s,gid:m.mode&k1?m.gid:i});return ka(this,"rename",h),y};try{if(!(t!=null&&t.recursive)){await d(l,await o.stat(Xr(l)));return}const h=[];for(let y=l,b=e;!await o.exists(y);y=Xr(y),b=Xr(b))h.unshift(y),u[y]=b;if(!h.length)return;const m=[await o.stat(Xr(h[0]))];for(const[y,b]of h.entries())m.push(await d(b,m[y]));return c.length==1?h[0]:(r=h[0])===null||r===void 0?void 0:r.slice(c.length)}catch(h){throw ps(h,u)}}async function ng(e,t){t=typeof t=="object"?t:{encoding:t},e=await ip.call(this,e);const{fs:n,path:r}=Ir(e,this),s=await n.stat(r).catch(l=>vs(ps(l,{[r]:e})));if(!s)throw Xe.With("ENOENT",e,"readdir");if(!hs(this,s,Hi))throw Xe.With("EACCES",e,"readdir");if(!Bc(s))throw Xe.With("ENOTDIR",e,"readdir");const i=await n.readdir(r).catch(l=>vs(ps(l,{[r]:e}))),a=[],o=async l=>{let c;if(!((t!=null&&t.recursive||t!=null&&t.withFileTypes)&&(c=await n.stat(os(r,l)).catch(u=>{if(u.code!="ENOENT")throw ps(u,{[r]:e})}),!c))&&(t!=null&&t.withFileTypes?a.push(new mw(l,c)):(t==null?void 0:t.encoding)=="buffer"?a.push(Ds.from(l)):a.push(l),!(!(t!=null&&t.recursive)||!Bc(c))))for(const u of await ng.call(this,os(e,l),t))u instanceof mw?(u.path=os(l,u.path),a.push(u)):Ds.isBuffer(u)?a.push(Ds.from(os(l,IO(u)))):a.push(os(l,u))};return await Promise.all(i.map(o)),a}async function vY(e,t){e=Bn(e),t=Bn(t);const{fs:n,path:r}=Ir(e,this),s=Ir(t,this);if(n!=s.fs)throw Xe.With("EXDEV",t,"link");try{if(Gi&&!hs(this,await n.stat(Xr(r)),Hi))throw Xe.With("EACCES",Xr(r),"link");if(Gi&&!(await nb.call(this,Xr(t))).hasAccess(ci,this))throw Xe.With("EACCES",Xr(t),"link");if(Gi&&!hs(this,await n.stat(r),Hi))throw Xe.With("EACCES",r,"link");return await n.link(r,s.path)}catch(i){throw ps(i,{[s.path]:t,[r]:e})}}async function xY(e,t,n="file"){const r={stack:[],error:void 0,hasError:!1};try{if(!["file","dir","junction"].includes(n))throw new Xe(vt.EINVAL,"Invalid symlink type: "+n);if(t=Bn(t),await R1.call(this,t))throw Xe.With("EEXIST",t,"symlink");const s=tc(r,await rb(this,t,{flag:"w+",mode:420,preserveSymlinks:!0}),!0);await s.writeFile(Bn(e,!0)),await s.chmod(sf)}catch(s){r.error=s,r.hasError=!0}finally{const s=nc(r);s&&await s}}async function X2(e,t){const n={stack:[],error:void 0,hasError:!1};try{const s=await tc(n,await rb(this,Bn(e),{flag:"r",mode:420,preserveSymlinks:!0}),!0).readFile(),i=typeof t=="object"?t==null?void 0:t.encoding:t;return i=="buffer"?s:s.toString(i??"utf-8")}catch(r){n.error=r,n.hasError=!0}finally{const r=nc(n);r&&await r}}async function wY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await tc(r,await rc.call(this,e,"r+"),!0).chown(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=nc(r);s&&await s}}async function _Y(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await tc(r,await rb(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chown(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=nc(r);s&&await s}}async function SY(e,t){const n={stack:[],error:void 0,hasError:!1};try{await tc(n,await rc.call(this,e,"r+"),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=nc(n);r&&await r}}async function CY(e,t){const n={stack:[],error:void 0,hasError:!1};try{await tc(n,await rb(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).chmod(t)}catch(r){n.error=r,n.hasError=!0}finally{const r=nc(n);r&&await r}}async function oD(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await tc(r,await rc.call(this,e,"r+"),!0).utimes(t,n)}catch(s){r.error=s,r.hasError=!0}finally{const s=nc(r);s&&await s}}async function kY(e,t,n){const r={stack:[],error:void 0,hasError:!1};try{await tc(r,await rb(this,e,{flag:"r+",mode:420,preserveSymlinks:!0,allowDirectory:!0}),!0).utimes(new Date(t),new Date(n))}catch(s){r.error=s,r.hasError=!0}finally{const s=nc(r);s&&await s}}async function J2(e,t,n){if(n){const l=Ir(t,e),c=await l.fs.stat(l.path).catch(()=>{});return{...l,fullPath:t,stats:c}}try{const l=Ir(t,e),c=await l.fs.stat(l.path);if(!hy(c))return{...l,fullPath:t,stats:c};const u=Zd.call(e,Xr(t),(await X2.call(e,t)).toString());return await J2(e,u)}catch{}const{base:r,dir:s}=du(t),i=s=="/"?"/":await ip.call(e,s),a=os(i,r),o=Ir(a,e);try{const l=await o.fs.stat(o.path);if(!hy(l))return{...o,fullPath:a,stats:l};const c=Zd.call(e,i,(await X2.call(e,a)).toString());return await J2(e,c)}catch(l){if(l.code=="ENOENT")return{...o,fullPath:t};throw ps(l,{[o.path]:a})}}async function ip(e,t){var n;const r=typeof t=="string"?t:(n=t==null?void 0:t.encoding)!==null&&n!==void 0?n:"utf8";e=Bn(e);const{fullPath:s}=await J2(this,e);if(r=="utf8"||r=="utf-8")return s;const i=Ds.from(s,"utf-8");return r=="buffer"?i:i.toString(r)}function cSe(e,t={}){const n=new tY(this,e.toString(),typeof t!="string"?t:{encoding:t}),r=[];let s=!1;n.on("change",(a,o)=>{var l;(l=r.shift())===null||l===void 0||l({value:{eventType:a,filename:o},done:!1})});function i(){s=!0,n.close();for(const a of r)a({value:null,done:s});return r.length=0,Promise.resolve({value:null,done:!0})}return{async next(){if(s)return Promise.resolve({value:null,done:s});const{promise:a,resolve:o}=Promise.withResolvers();return r.push(o),a},return:i,throw:i,async[Symbol.asyncDispose](){await i()},[Symbol.asyncIterator](){return this}}}async function EY(e,t=BO){if(!(await nb.call(this,e)).hasAccess(t,this))throw new Xe(vt.EACCES)}async function lD(e,t){e=Bn(e);const n=await nT.call(this,e).catch(r=>{if(!(r.code=="ENOENT"&&(t!=null&&t.force)))throw r});if(n)switch(n.mode&ks){case Ni:if(t!=null&&t.recursive)for(const r of await ng.call(this,e))await lD.call(this,os(e,r),t);await aD.call(this,e);break;case Nc:case sf:case Ym:case Zm:await rT.call(this,e);break;case Xm:case Km:default:throw new Xe(vt.EPERM,"File type not supported",e,"rm")}}async function TY(e,t){const n=typeof t=="object"?t==null?void 0:t.encoding:t||"utf8",s="/tmp/"+`${e}${Date.now()}-${Math.random().toString(36).slice(2)}`;return await aT.call(this,s),n=="buffer"?Ds.from(s):s}async function cD(e,t,n){if(e=Bn(e),t=Bn(t),n&&n&$O&&await R1.call(this,t))throw new Xe(vt.EEXIST,"Destination file already exists",t,"copyFile");await iT.call(this,t,await sT.call(this,e)),ka(this,"rename",t.toString())}function AY(e,t){return e=Bn(e),Promise.resolve(new QO(e,this))}async function uD(e,t,n){e=Bn(e),t=Bn(t);const r=await nT.call(this,e);if(n!=null&&n.errorOnExist&&await R1.call(this,t))throw new Xe(vt.EEXIST,"Destination file or directory already exists",t,"cp");switch(r.mode&ks){case Ni:{if(!(n!=null&&n.recursive))throw new Xe(vt.EISDIR,e+" is a directory (not copied)",e,"cp");const[s]=await Promise.all([ng.call(this,e,{withFileTypes:!0}),aT.call(this,t,{recursive:!0})]),i=async a=>{n.filter&&!n.filter(os(e,a.name),os(t,a.name))||await uD.call(this,os(e,a.name),os(t,a.name),n)};await Promise.all(s.map(i));break}case Nc:case sf:await cD.call(this,e,t);break;case Ym:case Zm:case Xm:case Km:default:throw new Xe(vt.EPERM,"File type not supported",e,"rm")}n!=null&&n.preserveTimestamps&&await oD.call(this,t,r.atime,r.mtime)}async function RY(e,t){e=Bn(e);const{fs:n}=Ir(e,this);return Promise.resolve(QK(n,t==null?void 0:t.bigint))}function NY(e,t){e=Array.isArray(e)?e:[e];const{cwd:n="/",withFileTypes:r=!1,exclude:s=()=>!1}=t||{},i=e.map(o=>(o=o.replace(/([.?+^$(){}|[\]/])/g,"$1").replace(/\*\*/g,".*").replace(/\*/g,"[^/]*").replace(/\?/g,"."),new RegExp(`^${o}$`)));async function*a(o){const l=await ng(o,{withFileTypes:r,encoding:"utf8"});for(const c of l){const u=r?c.path:o+"/"+c;s(r?c:u)||((await nb(u)).isDirectory()&&i.some(d=>d.source.includes(".*"))&&(yield*a(u)),i.some(d=>d.test(u.replace(/^\/+/g,"")))&&(yield r?c:u.replace(/^\/+/g,"")))}}return a(n)}const uSe=Object.freeze(Object.defineProperty({__proto__:null,FileHandle:za,access:EY,appendFile:bY,chmod:SY,chown:wY,constants:WK,copyFile:cD,cp:uD,exists:R1,glob:NY,lchmod:CY,lchown:_Y,link:vY,lstat:nT,lutimes:kY,mkdir:aT,mkdtemp:TY,open:rc,opendir:AY,readFile:sT,readdir:ng,readlink:X2,realpath:ip,rename:gY,rm:lD,rmdir:aD,stat:nb,statfs:RY,symlink:xY,truncate:yY,unlink:rT,utimes:oD,watch:cSe,writeFile:iT},Symbol.toStringTag,{value:"Module"})),yr=()=>{};async function dSe(e){const t=[];for await(const n of e)t.push(n);return t}function fSe(e,t,n=yr){gY.call(this,e,t).then(()=>n()).catch(n)}function hSe(e,t=yr){R1.call(this,e).then(t).catch(()=>t(!1))}function pSe(e,t,n=yr){n=typeof t=="function"?t:n,nb.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function mSe(e,t,n=yr){n=typeof t=="function"?t:n,nT.call(this,e,typeof t!="function"?t:{}).then(r=>n(void 0,r)).catch(n)}function gSe(e,t=0,n=yr){n=typeof t=="function"?t:n;const r=typeof t=="number"?t:0;yY.call(this,e,r).then(()=>n()).catch(n)}function ySe(e,t=yr){rT.call(this,e).then(()=>t()).catch(t)}function bSe(e,t,n,r=yr){const s=tp(n,420);r=typeof n=="function"?n:r,rc.call(this,e,t,s).then(i=>r(void 0,i.fd)).catch(r)}function vSe(e,t,n=yr){n=typeof t=="function"?t:n,sT.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function xSe(e,t,n,r=yr){r=typeof n=="function"?n:r,iT.call(this,e,t,typeof n!="function"?n:null).then(()=>r(void 0)).catch(r)}function wSe(e,t,n,r=yr){const s=typeof n!="function"?n:void 0;r=typeof n=="function"?n:r,bY.call(this,e,t,s).then(()=>r()).catch(r)}function _Se(e,t,n=yr){n=typeof t=="function"?t:n,new za(this,e).stat().then(r=>n(void 0,typeof t=="object"&&(t!=null&&t.bigint)?new Jm(r):r)).catch(n)}function SSe(e,t=yr){new za(this,e).close().then(()=>t()).catch(t)}function CSe(e,t,n=yr){const r=typeof t=="number"?t:0;n=typeof t=="function"?t:n;const s=new za(this,e);if(r<0)throw new Xe(vt.EINVAL);s.truncate(r).then(()=>n()).catch(n)}function kSe(e,t=yr){new za(this,e).sync().then(()=>t()).catch(t)}function ESe(e,t=yr){new za(this,e).datasync().then(()=>t()).catch(t)}function TSe(e,t,n,r,s,i=yr){let a,o,l,c,u;const d=new za(this,e);if(typeof t=="string"){switch(u="utf8",typeof n){case"function":i=n;break;case"number":c=n,u=typeof r=="string"?r:"utf8",i=typeof s=="function"?s:i;break;default:i=typeof r=="function"?r:typeof s=="function"?s:i,i(new Xe(vt.EINVAL,"Invalid arguments"));return}a=Ds.from(t),o=0,l=a.length;const h=i;d.write(a,o,l,c).then(({bytesWritten:m})=>h(void 0,m,a.toString(u))).catch(h)}else{a=Ds.from(t.buffer),o=n,l=r,c=typeof s=="number"?s:null;const h=typeof s=="function"?s:i;d.write(a,o,l,c).then(({bytesWritten:m})=>h(void 0,m,a)).catch(h)}}function ASe(e,t,n,r,s,i=yr){new za(this,e).read(t,n,r,s).then(({bytesRead:a,buffer:o})=>i(void 0,a,o)).catch(i)}function RSe(e,t,n,r=yr){new za(this,e).chown(t,n).then(()=>r()).catch(r)}function NSe(e,t,n){new za(this,e).chmod(t).then(()=>n()).catch(n)}function MSe(e,t,n,r=yr){new za(this,e).utimes(t,n).then(()=>r()).catch(r)}function ISe(e,t=yr){aD.call(this,e).then(()=>t()).catch(t)}function jSe(e,t,n=yr){aT.call(this,e,t).then(()=>n()).catch(n)}function PSe(e,t,n=yr){n=typeof t=="function"?t:n;const r=typeof t!="function"?t:{};ng.call(this,e,r).then(s=>n(void 0,s)).catch(n)}function OSe(e,t,n=yr){vY.call(this,e,t).then(()=>n()).catch(n)}function DSe(e,t,n,r=yr){const s=typeof n=="string"?n:"file";r=typeof n=="function"?n:r,xY.call(this,e,t,s).then(()=>r()).catch(r)}function FSe(e,t,n=yr){n=typeof t=="function"?t:n,X2.call(this,e).then(r=>n(void 0,r)).catch(n)}function LSe(e,t,n,r=yr){wY.call(this,e,t,n).then(()=>r()).catch(r)}function BSe(e,t,n,r=yr){_Y.call(this,e,t,n).then(()=>r()).catch(r)}function $Se(e,t,n=yr){SY.call(this,e,t).then(()=>n()).catch(n)}function zSe(e,t,n=yr){CY.call(this,e,t).then(()=>n()).catch(n)}function USe(e,t,n,r=yr){oD.call(this,e,t,n).then(()=>r()).catch(r)}function qSe(e,t,n,r=yr){kY.call(this,e,t,n).then(()=>r()).catch(r)}function VSe(e,t,n=yr){n=typeof t=="function"?t:n,ip.call(this,e,typeof t=="function"?null:t).then(r=>n(void 0,r)).catch(n)}function WSe(e,t,n=yr){const r=typeof t=="number"?t:Hi;n=typeof t=="function"?t:n,EY.call(this,e,r).then(()=>n()).catch(n)}const _0=new Map;function HSe(e,t,n){const r=Bn(e),s=typeof t!="function"?t:{};if(typeof t=="function"&&(n=t),!n)throw new Xe(vt.EINVAL,"No listener specified",e.toString(),"watchFile");if(_0.has(r)){const a=_0.get(r);a&&a.listeners.add(n);return}const i=new I_e(this,r,s);i.on("change",(a,o)=>{const l=_0.get(r);if(l)for(const c of l.listeners)c(a,o)}),_0.set(r,{watcher:i,listeners:new Set})}function GSe(e,t=yr){const n=Bn(e),r=_0.get(n);r&&(t&&t!==yr?r.listeners.delete(t):r.listeners.clear(),r.listeners.size===0&&(r.watcher.stop(),_0.delete(n)))}function KSe(e,t,n){const r=new tY(this,Bn(e),typeof t=="object"?t:{});return n=typeof t=="function"?t:n,r.on("change",n||yr),r}function YSe(e,t){t=typeof t=="object"?t:{encoding:t};const n=rc.call(this,e,"r",t==null?void 0:t.mode);return new sD({...t,autoClose:!0},n)}function ZSe(e,t){t=typeof t=="object"?t:{encoding:t};const n=rc.call(this,e,"w",t==null?void 0:t.mode);return new iD(t,n)}function XSe(e,t,n=yr){n=typeof t=="function"?t:n,lD.call(this,e,typeof t=="function"?void 0:t).then(()=>n(void 0)).catch(n)}function JSe(e,t,n=yr){n=typeof t=="function"?t:n,TY.call(this,e,typeof t!="function"?t:null).then(r=>n(void 0,r)).catch(n)}function QSe(e,t,n,r=yr){r=typeof n=="function"?n:r,cD.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function eCe(e,t,n,r=yr){r=typeof n=="function"?n:r,new za(this,e).readv(t,typeof n=="function"?void 0:n).then(({buffers:s,bytesRead:i})=>r(void 0,i,s)).catch(r)}function tCe(e,t,n,r=yr){r=typeof n=="function"?n:r,new za(this,e).writev(t,typeof n=="function"?void 0:n).then(({buffers:s,bytesWritten:i})=>r(void 0,i,s)).catch(r)}function nCe(e,t,n=yr){n=typeof t=="function"?t:n,AY.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}function rCe(e,t,n,r=yr){r=typeof n=="function"?n:r,uD.call(this,e,t,typeof n=="function"?void 0:n).then(()=>r(void 0)).catch(r)}function sCe(e,t,n=yr){n=typeof t=="function"?t:n,RY.call(this,e,typeof t=="function"?void 0:t).then(r=>n(void 0,r)).catch(n)}async function iCe(e,t){const n=await rc.call(this,e.toString(),"r"),r=await n.readFile();return await n.close(),new Blob([r],t)}function aCe(e,t,n=yr){n=typeof t=="function"?t:n;const r=NY.call(this,e,typeof t=="function"?void 0:t);dSe(r).then(s=>{var i;return n(null,(i=s)!==null&&i!==void 0?i:[])}).catch(s=>n(s))}var Up=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},sl=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},oCe=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})},Q2;(function(e){e[e.RealTime=1]="RealTime",e[e.PreAlloc=2]="PreAlloc",e[e.Immutable=8]="Immutable",e[e.Append=16]="Append",e[e.Sync=32]="Sync",e[e.NoAtime=64]="NoAtime",e[e.NoDump=128]="NoDump",e[e.RtInherit=256]="RtInherit",e[e.ProjInherit=512]="ProjInherit",e[e.NoSymlinks=1024]="NoSymlinks",e[e.ExtSize=2048]="ExtSize",e[e.ExtSzInherit=4096]="ExtSzInherit",e[e.NoDefrag=8192]="NoDefrag",e[e.FileStream=16384]="FileStream",e[e.Dax=32768]="Dax",e[e.CowExtSize=65536]="CowExtSize",e[e.HasAttr=2147483648]="HasAttr"})(Q2||(Q2={}));let MY=(()=>{var e,t,n,r,s;let i=[Gm()],a,o=[],l,c,u=[],d=[],h,m=[],y=[],b,v=[],x=[],w,S=[],k=[],C,T=[],A=[],N,I=[],O=[];return l=class{constructor(B=vs(new Xe(vt.EINVAL,"fsxattr must be initialized with an inode"))){this.xflags=sl(this,u,0),this.extsize=(sl(this,d),sl(this,m,0)),this.nextents=(sl(this,y),sl(this,v,0)),this.projid=(sl(this,x),sl(this,S,0)),this.cowextsize=(sl(this,k),sl(this,T,0)),this.pad=(sl(this,A),sl(this,I,[])),sl(this,O),this.extsize=B.size,this.nextents=1,this.projid=B.uid,this.cowextsize=B.size;for(const D of Object.keys(No))B.flags&No[D]&&D in Q2&&(this.xflags|=Q2[D])}},oCe(l,"fsxattr"),(()=>{const B=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;c=[(e=tr).uint32.bind(e)],h=[(t=tr).uint32.bind(t)],b=[(n=tr).uint32.bind(n)],w=[(r=tr).uint32.bind(r)],C=[(s=tr).uint32.bind(s)],N=[tr.char(8)],Up(null,null,c,{kind:"field",name:"xflags",static:!1,private:!1,access:{has:D=>"xflags"in D,get:D=>D.xflags,set:(D,H)=>{D.xflags=H}},metadata:B},u,d),Up(null,null,h,{kind:"field",name:"extsize",static:!1,private:!1,access:{has:D=>"extsize"in D,get:D=>D.extsize,set:(D,H)=>{D.extsize=H}},metadata:B},m,y),Up(null,null,b,{kind:"field",name:"nextents",static:!1,private:!1,access:{has:D=>"nextents"in D,get:D=>D.nextents,set:(D,H)=>{D.nextents=H}},metadata:B},v,x),Up(null,null,w,{kind:"field",name:"projid",static:!1,private:!1,access:{has:D=>"projid"in D,get:D=>D.projid,set:(D,H)=>{D.projid=H}},metadata:B},S,k),Up(null,null,C,{kind:"field",name:"cowextsize",static:!1,private:!1,access:{has:D=>"cowextsize"in D,get:D=>D.cowextsize,set:(D,H)=>{D.cowextsize=H}},metadata:B},T,A),Up(null,null,N,{kind:"field",name:"pad",static:!1,private:!1,access:{has:D=>"pad"in D,get:D=>D.pad,set:(D,H)=>{D.pad=H}},metadata:B},I,O),Up(null,a={value:l},i,{kind:"class",name:l.name,metadata:B},null,o),l=a.value,B&&Object.defineProperty(l,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:B}),sl(l,o)})(),l})();var Us;(function(e){e[e.GetFlags=2148034049]="GetFlags",e[e.SetFlags=1074292226]="SetFlags",e[e.GetVersion=2148038145]="GetVersion",e[e.SetVersion=1074296322]="SetVersion",e[e.Fiemap=3223348747]="Fiemap",e[e.GetXattr=2149341215]="GetXattr",e[e.SetXattr=1075599392]="SetXattr",e[e.GetLabel=2164298801]="GetLabel",e[e.SetLabel=1090556978]="SetLabel",e[e.GetUUID=2148603136]="GetUUID",e[e.GetSysfsPath=2155943169]="GetSysfsPath"})(Us||(Us={}));var _c;(function(e){e[e.GetFlags=2147771905]="GetFlags",e[e.SetFlags=1074030082]="SetFlags",e[e.GetVersion=2147776001]="GetVersion",e[e.SetVersion=1074034178]="SetVersion"})(_c||(_c={}));async function lCe(e,t,...n){e=Bn(e);const{fs:r,path:s}=Ir(e,this);try{const i=new Ti(await r.stat(s));switch(t){case Us.GetFlags:case _c.GetFlags:return i.flags;case Us.SetFlags:case _c.SetFlags:i.flags=n[0],await r.touch(s,i);return;case Us.GetVersion:case _c.GetVersion:return i.version;case Us.SetVersion:case _c.SetVersion:i.version=n[0],await r.touch(s,i);return;case Us.Fiemap:break;case Us.GetXattr:return new MY(i);case Us.SetXattr:break;case Us.GetLabel:return r.label;case Us.SetLabel:r.label=n[0];return;case Us.GetUUID:return r.uuid;case Us.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw ps(i,{[s]:e})}throw new Xe(vt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}function cCe(e,t,...n){e=Bn(e);const{fs:r,path:s}=Ir(e,this);try{const i=new Ti(r.statSync(s));switch(t){case Us.GetFlags:case _c.GetFlags:return i.flags;case Us.SetFlags:case _c.SetFlags:i.flags=n[0],r.touchSync(s,i);return;case Us.GetVersion:case _c.GetVersion:return i.version;case Us.SetVersion:case _c.SetVersion:i.version=n[0],r.touchSync(s,i);return;case Us.Fiemap:break;case Us.GetXattr:return new MY(i);case Us.SetXattr:break;case Us.GetLabel:return r.label;case Us.SetLabel:r.label=n[0];return;case Us.GetUUID:return r.uuid;case Us.GetSysfsPath:return`/sys/fs/${r.name}/${r.uuid}`}}catch(i){throw ps(i,{[s]:e})}throw new Xe(vt.ENOTSUP,"Unsupported command: "+t,e,"ioctl")}const uCe=[];function sb(e,t,n,r){if(!t.startsWith("user.")&&!uCe.includes(t))throw new Xe(vt.EPERM,"Only attributes in the user namespace are supported",n,r)}async function dCe(e,t,n={}){var r;e=Bn(e);const{fs:s,path:i}=Ir(e,this);sb(this,t,e,"xattr.get");try{const a=await s.stat(i);if(Gi&&!hs(this,a,Hi))throw Xe.With("EACCES",i,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new Dh);const o=a.attributes.get(t);if(!o)throw Xe.With("ENODATA",i,"xattr.get");const l=Ds.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw ps(a,{[i]:e})}}function fCe(e,t,n={}){var r;e=Bn(e),sb(this,t,e,"xattr.get");const{fs:s,path:i}=Ir(e,this);try{const a=s.statSync(i);if(Gi&&!hs(this,a,Hi))throw Xe.With("EACCES",i,"xattr.get");(r=a.attributes)!==null&&r!==void 0||(a.attributes=new Dh);const o=a.attributes.get(t);if(!o)throw Xe.With("ENODATA",i,"xattr.get");const l=Ds.from(o.value);return n.encoding=="buffer"||!n.encoding?l:l.toString(n.encoding)}catch(a){throw ps(a,{[i]:e})}}async function hCe(e,t,n,r={}){var s;e=Bn(e);const{fs:i,path:a}=Ir(e,this);sb(this,t,e,"xattr.set");try{const o=await i.stat(a);if(Gi&&!hs(this,o,ci))throw Xe.With("EACCES",a,"xattr.set");(s=o.attributes)!==null&&s!==void 0||(o.attributes=new Dh);const l=o.attributes.get(t);if(r.create&&l)throw Xe.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Xe.With("ENODATA",a,"xattr.set");o.attributes.set(t,Ds.from(n)),await i.touch(a,Hm(o,"attributes"))}catch(o){throw ps(o,{[a]:e})}}function pCe(e,t,n,r={}){var s;e=Bn(e);const{fs:i,path:a}=Ir(e,this);sb(this,t,e,"xattr.set");try{const o=i.statSync(a);if(Gi&&!hs(this,o,ci))throw Xe.With("EACCES",a,"xattr.set");(s=o.attributes)!==null&&s!==void 0||(o.attributes=new Dh);const l=o.attributes.get(t);if(r.create&&l)throw Xe.With("EEXIST",a,"xattr.set");if(r.replace&&!l)throw Xe.With("ENODATA",a,"xattr.set");o.attributes.set(t,Ds.from(n)),i.touchSync(a,Hm(o,"attributes"))}catch(o){throw ps(o,{[a]:e})}}async function mCe(e,t){var n;e=Bn(e);const{fs:r,path:s}=Ir(e,this);sb(this,t,e,"xattr.remove");try{const i=await r.stat(s);if(Gi&&!hs(this,i,ci))throw Xe.With("EACCES",s,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new Dh),!i.attributes.get(t))throw Xe.With("ENODATA",s,"xattr.remove");i.attributes.remove(t),await r.touch(s,Hm(i,"attributes"))}catch(i){throw ps(i,{[s]:e})}}function gCe(e,t){var n;e=Bn(e);const{fs:r,path:s}=Ir(e,this);sb(this,t,e,"xattr.remove");try{const i=r.statSync(s);if(Gi&&!hs(this,i,ci))throw Xe.With("EACCES",s,"xattr.remove");if((n=i.attributes)!==null&&n!==void 0||(i.attributes=new Dh),!i.attributes.get(t))throw Xe.With("ENODATA",s,"xattr.remove");i.attributes.remove(t),r.touchSync(s,Hm(i,"attributes"))}catch(i){throw ps(i,{[s]:e})}}async function yCe(e){e=Bn(e);const{fs:t,path:n}=Ir(e,this);try{const r=await t.stat(n);return r.attributes?r.attributes.keys():[]}catch(r){throw ps(r,{[n]:e})}}function bCe(e){e=Bn(e);const{fs:t,path:n}=Ir(e,this);try{const r=t.statSync(n);return r.attributes?r.attributes.keys():[]}catch(r){throw ps(r,{[n]:e})}}const vCe=Object.freeze(Object.defineProperty({__proto__:null,get:dCe,getSync:fCe,list:yCe,listSync:bCe,remove:mCe,removeSync:gCe,set:hCe,setSync:pCe},Symbol.toStringTag,{value:"Module"})),ha=Object.freeze(Object.defineProperty({__proto__:null,BigIntStatsFs:p_e,Dir:QO,Dirent:mw,get IOC(){return Us},get IOC32(){return _c},ReadStream:sD,Stats:af,StatsFs:h_e,WriteStream:iD,access:WSe,accessSync:X_e,appendFile:wSe,appendFileSync:F_e,chmod:$Se,chmodSync:K_e,chown:LSe,chownSync:H_e,chroot:N_e,close:SSe,closeSync:eg,constants:WK,copyFile:QSe,copyFileSync:aY,cp:rCe,cpSync:oY,createReadStream:YSe,createWriteStream:ZSe,exists:hSe,existsSync:VO,fchmod:NSe,fchmodSync:ZO,fchown:RSe,fchownSync:YO,fdatasync:ESe,fdatasyncSync:z_e,fstat:_Se,fstatSync:L_e,fsync:kSe,fsyncSync:$_e,ftruncate:CSe,ftruncateSync:B_e,futimes:MSe,futimesSync:XO,glob:aCe,globSync:rSe,ioctl:lCe,ioctlSync:cCe,lchmod:zSe,lchmodSync:Y_e,lchown:BSe,lchownSync:G_e,link:OSe,linkSync:V_e,lopenSync:XE,lstat:mSe,lstatSync:WO,lutimes:qSe,lutimesSync:Z_e,mkdir:jSe,mkdirSync:JO,mkdtemp:JSe,mkdtempSync:J_e,mount:qO,open:bSe,openAsBlob:iCe,openSync:ZE,opendir:nCe,opendirSync:tSe,promises:uSe,read:ASe,readFile:vSe,readFileSync:GO,readSync:q_e,readdir:PSe,readdirSync:eb,readlink:FSe,readlinkSync:Pj,readv:eCe,readvSync:Q_e,realpath:VSe,realpathSync:np,rename:fSe,renameSync:O_e,rm:XSe,rmSync:iY,rmdir:ISe,rmdirSync:rY,stat:pSe,statSync:Fh,statfs:sCe,statfsSync:nSe,symlink:DSe,symlinkSync:W_e,truncate:gSe,truncateSync:D_e,umount:JK,unlink:ySe,unlinkSync:HO,unwatchFile:GSe,utimes:USe,utimesSync:sY,watch:KSe,watchFile:HSe,write:TSe,writeFile:xSe,writeFileSync:KO,writeSync:U_e,writev:tCe,writevSync:eSe,xattr:vCe},Symbol.toStringTag,{value:"Module"}));function I9(e){return PK(e)||LO(e)||e instanceof UO}async function IY(e,t=0){if(typeof e!="object"||e==null)throw Ro(new Xe(vt.EINVAL,"Invalid options on mount configuration"));if(!I9(e))throw Ro(new Xe(vt.EINVAL,"Invalid mount configuration"));if(e instanceof UO)return await e.ready(),e;LO(e)&&(e={backend:e});for(const[s,i]of Object.entries(e))if(s!="backend"&&I9(i)){if(jK("Resolving nested mount configuration: "+s),t>10)throw Ro(new Xe(vt.EINVAL,"Invalid configuration, too deep and possibly infinite"));e[s]=await IY(i,++t)}const{backend:n}=e;if(typeof n.isAvailable=="function"&&!await n.isAvailable(e))throw Ro(new Xe(vt.EPERM,"Backend not available: "+n.name));Z1e(n,e);const r=await n.create(e);return e.disableAsyncCache&&r.attributes.set("no_async"),await r.ready(),r}async function xCe(e){if(!PK(e))throw new TypeError("Invalid single mount point configuration");const t=await IY(e);JK("/"),qO("/",t)}const wCe=["delete"];Math.max(...wCe.map(e=>e.length));Y1e("RPCPort",e=>typeof(e==null?void 0:e.postMessage)=="function");const jY=new Uint32Array(256);for(let e=0;e<256;e++){let t=e;for(let n=0;n<8;n++)t=t&1?2197175160^t>>>1:t>>>1;jY[e]=t}function _Ce(e){let t=4294967295;for(let n=0;n<e.length;n++)t=t>>>8^jY[(t^e[n])&255];return(t^4294967295)>>>0}var zs=function(e,t,n,r,s,i){function a(x){if(x!==void 0&&typeof x!="function")throw new TypeError("Function expected");return x}for(var o=r.kind,l=o==="getter"?"get":o==="setter"?"set":"value",c=!t&&e?r.static?e:e.prototype:null,u=t||(c?Object.getOwnPropertyDescriptor(c,r.name):{}),d,h=!1,m=n.length-1;m>=0;m--){var y={};for(var b in r)y[b]=b==="access"?{}:r[b];for(var b in r.access)y.access[b]=r.access[b];y.addInitializer=function(x){if(h)throw new TypeError("Cannot add initializers after decoration has completed");i.push(a(x||null))};var v=(0,n[m])(o==="accessor"?{get:u.get,set:u.set}:u[l],y);if(o==="accessor"){if(v===void 0)continue;if(v===null||typeof v!="object")throw new TypeError("Object expected");(d=a(v.get))&&(u.get=d),(d=a(v.set))&&(u.set=d),(d=a(v.init))&&s.unshift(d)}else(d=a(v))&&(o==="field"?s.unshift(d):u[l]=d)}c&&Object.defineProperty(c,r.name,u),h=!0},ur=function(e,t,n){for(var r=arguments.length>2,s=0;s<t.length;s++)n=r?t[s].call(e,n):t[s].call(e);return r?n:void 0},dD=function(e,t,n){return typeof t=="symbol"&&(t=t.description?"[".concat(t.description,"]"):""),Object.defineProperty(e,"name",{configurable:!0,value:n?"".concat(n," ",t):t})};let j9=(()=>{var e,t,n,r;let s=[Gm()],i,a=[],o,l,c=[],u=[],d,h=[],m=[],y,b=[],v=[],x,w=[],S=[];return o=class{constructor(){this.id=ur(this,c,0),this.offset_=(ur(this,u),ur(this,h,0)),this.offset=(ur(this,m),ur(this,b,0)),this.size=(ur(this,v),ur(this,w,0)),ur(this,S)}},dD(o,"MetadataEntry"),(()=>{const k=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=tr).uint32.bind(e)],d=[(t=tr).uint32.bind(t)],y=[(n=tr).uint32.bind(n)],x=[(r=tr).uint32.bind(r)],zs(null,null,l,{kind:"field",name:"id",static:!1,private:!1,access:{has:C=>"id"in C,get:C=>C.id,set:(C,T)=>{C.id=T}},metadata:k},c,u),zs(null,null,d,{kind:"field",name:"offset_",static:!1,private:!1,access:{has:C=>"offset_"in C,get:C=>C.offset_,set:(C,T)=>{C.offset_=T}},metadata:k},h,m),zs(null,null,y,{kind:"field",name:"offset",static:!1,private:!1,access:{has:C=>"offset"in C,get:C=>C.offset,set:(C,T)=>{C.offset=T}},metadata:k},b,v),zs(null,null,x,{kind:"field",name:"size",static:!1,private:!1,access:{has:C=>"size"in C,get:C=>C.size,set:(C,T)=>{C.size=T}},metadata:k},w,S),zs(null,i={value:o},s,{kind:"class",name:o.name,metadata:k},null,a),o=i.value,k&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:k}),ur(o,a)})(),o})();const P9=255;let qp=(()=>{var e,t,n,r;let s=[Gm()],i,a=[],o,l,c=[],u=[],d,h=[],m=[],y,b=[],v=[],x,w=[],S=[],k,C=[],T=[];var A=o=class{constructor(N=vs(new Xe(vt.EINVAL,"Metadata block must be initialized with a superblock")),I=0){if(this.superblock=N,this.offset=I,this.checksum=ur(this,c,0),this.timestamp=(ur(this,u),ur(this,h,Date.now())),this.previous_offset_=(ur(this,m),ur(this,b,0)),this.previous_offset=(ur(this,v),ur(this,w,0)),this._previous=ur(this,S),this.entries=ur(this,C,Array.from({length:P9},()=>new j9)),ur(this,T),this.superblock=N,this.offset=I,!!I&&(VE(this,N.store._buffer.subarray(I,I+qs(A))),!PY(this)))throw WE(new Xe(vt.EIO,"SingleBuffer: Checksum mismatch for metadata block at 0x"+I.toString(16)))}get previous(){var N;if(this.previous_offset)return(N=this._previous)!==null&&N!==void 0||(this._previous=new A(this.superblock,this.previous_offset)),this._previous}};return dD(o,"MetadataBlock"),(()=>{const N=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;l=[(e=tr).uint32.bind(e)],d=[(t=tr).uint32.bind(t)],y=[(n=tr).uint32.bind(n)],x=[(r=tr).uint32.bind(r)],k=[dw(j9,P9)],zs(null,null,l,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:I=>"checksum"in I,get:I=>I.checksum,set:(I,O)=>{I.checksum=O}},metadata:N},c,u),zs(null,null,d,{kind:"field",name:"timestamp",static:!1,private:!1,access:{has:I=>"timestamp"in I,get:I=>I.timestamp,set:(I,O)=>{I.timestamp=O}},metadata:N},h,m),zs(null,null,y,{kind:"field",name:"previous_offset_",static:!1,private:!1,access:{has:I=>"previous_offset_"in I,get:I=>I.previous_offset_,set:(I,O)=>{I.previous_offset_=O}},metadata:N},b,v),zs(null,null,x,{kind:"field",name:"previous_offset",static:!1,private:!1,access:{has:I=>"previous_offset"in I,get:I=>I.previous_offset,set:(I,O)=>{I.previous_offset=O}},metadata:N},w,S),zs(null,null,k,{kind:"field",name:"entries",static:!1,private:!1,access:{has:I=>"entries"in I,get:I=>I.entries,set:(I,O)=>{I.entries=O}},metadata:N},C,T),zs(null,i={value:o},s,{kind:"class",name:o.name,metadata:N},null,a),A=o=i.value,N&&Object.defineProperty(o,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:N}),ur(o,a)})(),A=o})();const O9=2049864546;(()=>{var e,t,n,r,s,i,a,o,l,c,u;let d=[Gm()],h,m=[],y,b,v=[],x=[],w,S=[],k=[],C,T=[],A=[],N,I=[],O=[],B,D=[],H=[],P,K=[],U=[],V,L=[],te=[],W,Q=[],ee=[],re,pe=[],de=[],Oe,Fe=[],Se=[],Ce,qe=[],Qe=[],We,je=[],Y=[],ye,Ie=[],ce=[];var oe=y=class{constructor(se=vs(new Xe(vt.EINVAL,"Super block must be initialized with a store"))){if(this.store=se,this.checksum=ur(this,v,0),this.magic=(ur(this,x),ur(this,S,O9)),this.version=(ur(this,k),ur(this,T,1)),this.inode_format=(ur(this,A),ur(this,I,g_e)),this.flags=(ur(this,O),ur(this,D,0)),this.used_bytes=(ur(this,H),ur(this,K,BigInt(0))),this.total_bytes=(ur(this,U),ur(this,L,BigInt(0))),this.uuid=(ur(this,te),ur(this,Q,BigInt(0))),this.metadata_block_size=(ur(this,ee),ur(this,pe,qs(qp))),this.metadata_offset_=(ur(this,de),ur(this,Fe,0)),this.metadata_offset=(ur(this,Se),ur(this,qe,0)),this.metadata=ur(this,Qe),this.label=ur(this,je,""),this._padding=(ur(this,Y),ur(this,Ie,new Array(132).fill(0))),ur(this,ce),this.store=se,se._view.getUint32(j1e(oe,"magic"),!0)!=O9){Fa("SingleBuffer: Invalid magic value, assuming this is a fresh super block"),this.metadata=new qp(this),this.metadata.offset=qs(oe),this.metadata_offset=this.metadata.offset,this.used_bytes=BigInt(qs(oe)+qs(qp)),this.total_bytes=BigInt(se._buffer.byteLength),se._write(this),se._write(this.metadata);return}if(VE(this,se._buffer.subarray(0,qs(oe))),!PY(this))throw WE(new Xe(vt.EIO,"SingleBuffer: Checksum mismatch for super block!"));this.metadata=new qp(this,this.metadata_offset)}rotateMetadata(){const se=new qp(this);return se.offset=Number(this.used_bytes),se.previous_offset=this.metadata_offset,this.metadata=se,this.metadata_offset=se.offset,this.store._write(se),this.used_bytes+=BigInt(qs(qp)),this.store._write(this),se}isUnused(se,Me){if(!Me)return!0;if(se+Me>this.total_bytes||se<qs(oe))return!1;for(let Be=this.metadata;Be;Be=Be.previous){if(se<Be.offset+qs(qp)&&se+Me>Be.offset)return!1;for(const Ae of Be.entries)if(Ae.offset&&(se>=Ae.offset&&se<Ae.offset+Ae.size||se+Me>Ae.offset&&se+Me<=Ae.offset+Ae.size||se<=Ae.offset&&se+Me>=Ae.offset+Ae.size))return!1}return!0}};return dD(y,"SuperBlock"),(()=>{const se=typeof Symbol=="function"&&Symbol.metadata?Object.create(null):void 0;b=[(e=tr).uint32.bind(e)],w=[(t=tr).uint32.bind(t)],C=[(n=tr).uint16.bind(n)],N=[(r=tr).uint16.bind(r)],B=[(s=tr).uint32.bind(s)],P=[(i=tr).uint64.bind(i)],V=[(a=tr).uint64.bind(a)],W=[(o=tr).uint128.bind(o)],re=[(l=tr).uint32.bind(l)],Oe=[(c=tr).uint32.bind(c)],Ce=[(u=tr).uint32.bind(u)],We=[tr.char(64)],ye=[tr.char(132)],zs(null,null,b,{kind:"field",name:"checksum",static:!1,private:!1,access:{has:Me=>"checksum"in Me,get:Me=>Me.checksum,set:(Me,Be)=>{Me.checksum=Be}},metadata:se},v,x),zs(null,null,w,{kind:"field",name:"magic",static:!1,private:!1,access:{has:Me=>"magic"in Me,get:Me=>Me.magic,set:(Me,Be)=>{Me.magic=Be}},metadata:se},S,k),zs(null,null,C,{kind:"field",name:"version",static:!1,private:!1,access:{has:Me=>"version"in Me,get:Me=>Me.version,set:(Me,Be)=>{Me.version=Be}},metadata:se},T,A),zs(null,null,N,{kind:"field",name:"inode_format",static:!1,private:!1,access:{has:Me=>"inode_format"in Me,get:Me=>Me.inode_format,set:(Me,Be)=>{Me.inode_format=Be}},metadata:se},I,O),zs(null,null,B,{kind:"field",name:"flags",static:!1,private:!1,access:{has:Me=>"flags"in Me,get:Me=>Me.flags,set:(Me,Be)=>{Me.flags=Be}},metadata:se},D,H),zs(null,null,P,{kind:"field",name:"used_bytes",static:!1,private:!1,access:{has:Me=>"used_bytes"in Me,get:Me=>Me.used_bytes,set:(Me,Be)=>{Me.used_bytes=Be}},metadata:se},K,U),zs(null,null,V,{kind:"field",name:"total_bytes",static:!1,private:!1,access:{has:Me=>"total_bytes"in Me,get:Me=>Me.total_bytes,set:(Me,Be)=>{Me.total_bytes=Be}},metadata:se},L,te),zs(null,null,W,{kind:"field",name:"uuid",static:!1,private:!1,access:{has:Me=>"uuid"in Me,get:Me=>Me.uuid,set:(Me,Be)=>{Me.uuid=Be}},metadata:se},Q,ee),zs(null,null,re,{kind:"field",name:"metadata_block_size",static:!1,private:!1,access:{has:Me=>"metadata_block_size"in Me,get:Me=>Me.metadata_block_size,set:(Me,Be)=>{Me.metadata_block_size=Be}},metadata:se},pe,de),zs(null,null,Oe,{kind:"field",name:"metadata_offset_",static:!1,private:!1,access:{has:Me=>"metadata_offset_"in Me,get:Me=>Me.metadata_offset_,set:(Me,Be)=>{Me.metadata_offset_=Be}},metadata:se},Fe,Se),zs(null,null,Ce,{kind:"field",name:"metadata_offset",static:!1,private:!1,access:{has:Me=>"metadata_offset"in Me,get:Me=>Me.metadata_offset,set:(Me,Be)=>{Me.metadata_offset=Be}},metadata:se},qe,Qe),zs(null,null,We,{kind:"field",name:"label",static:!1,private:!1,access:{has:Me=>"label"in Me,get:Me=>Me.label,set:(Me,Be)=>{Me.label=Be}},metadata:se},je,Y),zs(null,null,ye,{kind:"field",name:"_padding",static:!1,private:!1,access:{has:Me=>"_padding"in Me,get:Me=>Me._padding,set:(Me,Be)=>{Me._padding=Be}},metadata:se},Ie,ce),zs(null,h={value:y},d,{kind:"class",name:y.name,metadata:se},null,m),oe=y=h.value,se&&Object.defineProperty(y,Symbol.metadata,{enumerable:!0,configurable:!0,writable:!0,value:se}),ur(y,m)})(),oe=y})();function PY(e){const t=xa(e),n=_Ce(t.subarray(4));return e.checksum===n}globalThis.__zenfs__=ha;function SCe(e){switch(e.name){case"TypeMismatchError":return"EPERM";case"IndexSizeError":case"HierarchyRequestError":case"InvalidCharacterError":case"InvalidStateError":case"SyntaxError":case"NamespaceError":case"ConstraintError":case"VersionError":case"URLMismatchError":case"InvalidNodeTypeError":return"EINVAL";case"WrongDocumentError":return"EXDEV";case"NoModificationAllowedError":case"InvalidModificationError":case"InvalidAccessError":case"SecurityError":case"NotAllowedError":return"EACCES";case"NotFoundError":return"ENOENT";case"NotSupportedError":return"ENOTSUP";case"InUseAttributeError":return"EBUSY";case"NetworkError":return"ENETDOWN";case"AbortError":return"EINTR";case"QuotaExceededError":return"ENOSPC";case"TimeoutError":return"ETIMEDOUT";case"ReadOnlyError":return"EROFS";case"DataCloneError":case"EncodingError":case"NotReadableError":case"DataError":case"TransactionInactiveError":case"OperationError":case"UnknownError":default:return"EIO"}}function Dj(e,t,n){if(e instanceof Xe)return e;const r=e instanceof DOMException?vt[SCe(e)]:vt.EIO,s=new Xe(r,e.message,t,n);return s.stack=e.stack,s.cause=e.cause,s}function S0(e){return new Promise((t,n)=>{e.onsuccess=()=>t(e.result),e.onerror=r=>{r.preventDefault(),n(Dj(e.error))}})}class CCe extends jj{constructor(t,n){super(n),this.tx=t,this.store=n,this._idb=t.objectStore(n.name)}async keys(){return(await S0(this._idb.getAllKeys())).filter(t=>typeof t=="string").map(t=>Number(t))}async get(t){const n=await S0(this._idb.get(t.toString()));return n&&this._cached(t,{size:n.byteLength}).add(n,0),n}async set(t,n){this._cached(t,{size:n.byteLength}).add(n,0),await S0(this._idb.put(n,t.toString()))}remove(t){return this.store.cache.delete(t),S0(this._idb.delete(t.toString()))}async commit(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.oncomplete=()=>n(),this.tx.onerror=()=>r(Dj(this.tx.error)),this.tx.commit(),t}async abort(){const{promise:t,resolve:n,reject:r}=Promise.withResolvers();return this.tx.onabort=()=>n(),this.tx.onerror=()=>r(Dj(this.tx.error)),this.tx.abort(),t}}async function kCe(e,t=globalThis.indexedDB){const n=t.open(e);return n.onupgradeneeded=()=>{const r=n.result;r.objectStoreNames.contains(e)&&(Fa("Found unexpected object store: "+e),r.deleteObjectStore(e)),r.createObjectStore(e)},await S0(n)}class ECe{constructor(t){this.db=t,this.cache=new Map}sync(){return Promise.resolve()}get name(){return this.db.name}transaction(){const t=this.db.transaction(this.name,"readwrite");return new CCe(t,this)}}const TCe={name:"IndexedDB",options:{storeName:{type:"string",required:!1},idbFactory:{type:"object",required:!1}},async isAvailable({idbFactory:e=globalThis.indexedDB}){try{if(!(e instanceof IDBFactory))return!1;const t=e.open("__zenfs_test");return await S0(t),!0}catch{return!1}finally{e==null||e.deleteDatabase("__zenfs_test")}},async create(e){const t=await kCe(e.storeName||"zenfs",e.idbFactory),n=new ECe(t),r=new YK(n);if(e!=null&&e.disableAsyncCache)return FO("Async preloading disabled for IndexedDB"),r;const s=n.transaction();for(const i of await s.keys())await s.get(i);return r}},ACe=TCe,hn={vfsKeyChanged:"vfs.key.changed",nodesUpdated:"vfs.nodes.updated",selectionChanged:"vfs.selection.changed",loadingStateChanged:"vfs.loading.state.changed",fsInstanceChanged:"vfs.instance.changed",vfsEnabledChanged:"vfs.enabled.changed",fileWritten:"vfs.sdk.fileWritten",fileRead:"vfs.sdk.fileRead",fileDeleted:"vfs.sdk.fileDeleted",setVfsKeyRequest:"vfs.set.vfs.key.request",initializeVFSRequest:"vfs.initialize.vfs.request",fetchNodesRequest:"vfs.fetch.nodes.request",setCurrentPathRequest:"vfs.set.current.path.request",createDirectoryRequest:"vfs.create.directory.request",uploadFilesRequest:"vfs.upload.files.request",deleteNodesRequest:"vfs.delete.nodes.request",renameNodeRequest:"vfs.rename.node.request",downloadFileRequest:"vfs.download.file.request",selectFileRequest:"vfs.select.file.request",deselectFileRequest:"vfs.deselect.file.request",clearSelectionRequest:"vfs.clear.selection.request",setEnableVfsRequest:"vfs.set.enable.vfs.request"};function WS(e){throw new Error('Could not dynamically require "'+e+'". Please configure the dynamicRequireTargets or/and ignoreDynamicRequires option of @rollup/plugin-commonjs appropriately for this require call to work.')}var FM={exports:{}},D9;function RCe(){return D9||(D9=1,function(e,t){(function(n){e.exports=n()})(function(){return function n(r,s,i){function a(c,u){if(!s[c]){if(!r[c]){var d=typeof WS=="function"&&WS;if(!u&&d)return d(c,!0);if(o)return o(c,!0);var h=new Error("Cannot find module '"+c+"'");throw h.code="MODULE_NOT_FOUND",h}var m=s[c]={exports:{}};r[c][0].call(m.exports,function(y){var b=r[c][1][y];return a(b||y)},m,m.exports,n,r,s,i)}return s[c].exports}for(var o=typeof WS=="function"&&WS,l=0;l<i.length;l++)a(i[l]);return a}({1:[function(n,r,s){var i=n("./utils"),a=n("./support"),o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";s.encode=function(l){for(var c,u,d,h,m,y,b,v=[],x=0,w=l.length,S=w,k=i.getTypeOf(l)!=="string";x<l.length;)S=w-x,d=k?(c=l[x++],u=x<w?l[x++]:0,x<w?l[x++]:0):(c=l.charCodeAt(x++),u=x<w?l.charCodeAt(x++):0,x<w?l.charCodeAt(x++):0),h=c>>2,m=(3&c)<<4|u>>4,y=1<S?(15&u)<<2|d>>6:64,b=2<S?63&d:64,v.push(o.charAt(h)+o.charAt(m)+o.charAt(y)+o.charAt(b));return v.join("")},s.decode=function(l){var c,u,d,h,m,y,b=0,v=0,x="data:";if(l.substr(0,x.length)===x)throw new Error("Invalid base64 input, it looks like a data url.");var w,S=3*(l=l.replace(/[^A-Za-z0-9+/=]/g,"")).length/4;if(l.charAt(l.length-1)===o.charAt(64)&&S--,l.charAt(l.length-2)===o.charAt(64)&&S--,S%1!=0)throw new Error("Invalid base64 input, bad content length.");for(w=a.uint8array?new Uint8Array(0|S):new Array(0|S);b<l.length;)c=o.indexOf(l.charAt(b++))<<2|(h=o.indexOf(l.charAt(b++)))>>4,u=(15&h)<<4|(m=o.indexOf(l.charAt(b++)))>>2,d=(3&m)<<6|(y=o.indexOf(l.charAt(b++))),w[v++]=c,m!==64&&(w[v++]=u),y!==64&&(w[v++]=d);return w}},{"./support":30,"./utils":32}],2:[function(n,r,s){var i=n("./external"),a=n("./stream/DataWorker"),o=n("./stream/Crc32Probe"),l=n("./stream/DataLengthProbe");function c(u,d,h,m,y){this.compressedSize=u,this.uncompressedSize=d,this.crc32=h,this.compression=m,this.compressedContent=y}c.prototype={getContentWorker:function(){var u=new a(i.Promise.resolve(this.compressedContent)).pipe(this.compression.uncompressWorker()).pipe(new l("data_length")),d=this;return u.on("end",function(){if(this.streamInfo.data_length!==d.uncompressedSize)throw new Error("Bug : uncompressed data size mismatch")}),u},getCompressedWorker:function(){return new a(i.Promise.resolve(this.compressedContent)).withStreamInfo("compressedSize",this.compressedSize).withStreamInfo("uncompressedSize",this.uncompressedSize).withStreamInfo("crc32",this.crc32).withStreamInfo("compression",this.compression)}},c.createWorkerFrom=function(u,d,h){return u.pipe(new o).pipe(new l("uncompressedSize")).pipe(d.compressWorker(h)).pipe(new l("compressedSize")).withStreamInfo("compression",d)},r.exports=c},{"./external":6,"./stream/Crc32Probe":25,"./stream/DataLengthProbe":26,"./stream/DataWorker":27}],3:[function(n,r,s){var i=n("./stream/GenericWorker");s.STORE={magic:"\0\0",compressWorker:function(){return new i("STORE compression")},uncompressWorker:function(){return new i("STORE decompression")}},s.DEFLATE=n("./flate")},{"./flate":7,"./stream/GenericWorker":28}],4:[function(n,r,s){var i=n("./utils"),a=function(){for(var o,l=[],c=0;c<256;c++){o=c;for(var u=0;u<8;u++)o=1&o?3988292384^o>>>1:o>>>1;l[c]=o}return l}();r.exports=function(o,l){return o!==void 0&&o.length?i.getTypeOf(o)!=="string"?function(c,u,d,h){var m=a,y=h+d;c^=-1;for(var b=h;b<y;b++)c=c>>>8^m[255&(c^u[b])];return-1^c}(0|l,o,o.length,0):function(c,u,d,h){var m=a,y=h+d;c^=-1;for(var b=h;b<y;b++)c=c>>>8^m[255&(c^u.charCodeAt(b))];return-1^c}(0|l,o,o.length,0):0}},{"./utils":32}],5:[function(n,r,s){s.base64=!1,s.binary=!1,s.dir=!1,s.createFolders=!0,s.date=null,s.compression=null,s.compressionOptions=null,s.comment=null,s.unixPermissions=null,s.dosPermissions=null},{}],6:[function(n,r,s){var i=null;i=typeof Promise<"u"?Promise:n("lie"),r.exports={Promise:i}},{lie:37}],7:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Uint32Array<"u",a=n("pako"),o=n("./utils"),l=n("./stream/GenericWorker"),c=i?"uint8array":"array";function u(d,h){l.call(this,"FlateWorker/"+d),this._pako=null,this._pakoAction=d,this._pakoOptions=h,this.meta={}}s.magic="\b\0",o.inherits(u,l),u.prototype.processChunk=function(d){this.meta=d.meta,this._pako===null&&this._createPako(),this._pako.push(o.transformTo(c,d.data),!1)},u.prototype.flush=function(){l.prototype.flush.call(this),this._pako===null&&this._createPako(),this._pako.push([],!0)},u.prototype.cleanUp=function(){l.prototype.cleanUp.call(this),this._pako=null},u.prototype._createPako=function(){this._pako=new a[this._pakoAction]({raw:!0,level:this._pakoOptions.level||-1});var d=this;this._pako.onData=function(h){d.push({data:h,meta:d.meta})}},s.compressWorker=function(d){return new u("Deflate",d)},s.uncompressWorker=function(){return new u("Inflate",{})}},{"./stream/GenericWorker":28,"./utils":32,pako:38}],8:[function(n,r,s){function i(m,y){var b,v="";for(b=0;b<y;b++)v+=String.fromCharCode(255&m),m>>>=8;return v}function a(m,y,b,v,x,w){var S,k,C=m.file,T=m.compression,A=w!==c.utf8encode,N=o.transformTo("string",w(C.name)),I=o.transformTo("string",c.utf8encode(C.name)),O=C.comment,B=o.transformTo("string",w(O)),D=o.transformTo("string",c.utf8encode(O)),H=I.length!==C.name.length,P=D.length!==O.length,K="",U="",V="",L=C.dir,te=C.date,W={crc32:0,compressedSize:0,uncompressedSize:0};y&&!b||(W.crc32=m.crc32,W.compressedSize=m.compressedSize,W.uncompressedSize=m.uncompressedSize);var Q=0;y&&(Q|=8),A||!H&&!P||(Q|=2048);var ee=0,re=0;L&&(ee|=16),x==="UNIX"?(re=798,ee|=function(de,Oe){var Fe=de;return de||(Fe=Oe?16893:33204),(65535&Fe)<<16}(C.unixPermissions,L)):(re=20,ee|=function(de){return 63&(de||0)}(C.dosPermissions)),S=te.getUTCHours(),S<<=6,S|=te.getUTCMinutes(),S<<=5,S|=te.getUTCSeconds()/2,k=te.getUTCFullYear()-1980,k<<=4,k|=te.getUTCMonth()+1,k<<=5,k|=te.getUTCDate(),H&&(U=i(1,1)+i(u(N),4)+I,K+="up"+i(U.length,2)+U),P&&(V=i(1,1)+i(u(B),4)+D,K+="uc"+i(V.length,2)+V);var pe="";return pe+=`
\0`,pe+=i(Q,2),pe+=T.magic,pe+=i(S,2),pe+=i(k,2),pe+=i(W.crc32,4),pe+=i(W.compressedSize,4),pe+=i(W.uncompressedSize,4),pe+=i(N.length,2),pe+=i(K.length,2),{fileRecord:d.LOCAL_FILE_HEADER+pe+N+K,dirRecord:d.CENTRAL_FILE_HEADER+i(re,2)+pe+i(B.length,2)+"\0\0\0\0"+i(ee,4)+i(v,4)+N+K+B}}var o=n("../utils"),l=n("../stream/GenericWorker"),c=n("../utf8"),u=n("../crc32"),d=n("../signature");function h(m,y,b,v){l.call(this,"ZipFileWorker"),this.bytesWritten=0,this.zipComment=y,this.zipPlatform=b,this.encodeFileName=v,this.streamFiles=m,this.accumulate=!1,this.contentBuffer=[],this.dirRecords=[],this.currentSourceOffset=0,this.entriesCount=0,this.currentFile=null,this._sources=[]}o.inherits(h,l),h.prototype.push=function(m){var y=m.meta.percent||0,b=this.entriesCount,v=this._sources.length;this.accumulate?this.contentBuffer.push(m):(this.bytesWritten+=m.data.length,l.prototype.push.call(this,{data:m.data,meta:{currentFile:this.currentFile,percent:b?(y+100*(b-v-1))/b:100}}))},h.prototype.openedSource=function(m){this.currentSourceOffset=this.bytesWritten,this.currentFile=m.file.name;var y=this.streamFiles&&!m.file.dir;if(y){var b=a(m,y,!1,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);this.push({data:b.fileRecord,meta:{percent:0}})}else this.accumulate=!0},h.prototype.closedSource=function(m){this.accumulate=!1;var y=this.streamFiles&&!m.file.dir,b=a(m,y,!0,this.currentSourceOffset,this.zipPlatform,this.encodeFileName);if(this.dirRecords.push(b.dirRecord),y)this.push({data:function(v){return d.DATA_DESCRIPTOR+i(v.crc32,4)+i(v.compressedSize,4)+i(v.uncompressedSize,4)}(m),meta:{percent:100}});else for(this.push({data:b.fileRecord,meta:{percent:0}});this.contentBuffer.length;)this.push(this.contentBuffer.shift());this.currentFile=null},h.prototype.flush=function(){for(var m=this.bytesWritten,y=0;y<this.dirRecords.length;y++)this.push({data:this.dirRecords[y],meta:{percent:100}});var b=this.bytesWritten-m,v=function(x,w,S,k,C){var T=o.transformTo("string",C(k));return d.CENTRAL_DIRECTORY_END+"\0\0\0\0"+i(x,2)+i(x,2)+i(w,4)+i(S,4)+i(T.length,2)+T}(this.dirRecords.length,b,m,this.zipComment,this.encodeFileName);this.push({data:v,meta:{percent:100}})},h.prototype.prepareNextSource=function(){this.previous=this._sources.shift(),this.openedSource(this.previous.streamInfo),this.isPaused?this.previous.pause():this.previous.resume()},h.prototype.registerPrevious=function(m){this._sources.push(m);var y=this;return m.on("data",function(b){y.processChunk(b)}),m.on("end",function(){y.closedSource(y.previous.streamInfo),y._sources.length?y.prepareNextSource():y.end()}),m.on("error",function(b){y.error(b)}),this},h.prototype.resume=function(){return!!l.prototype.resume.call(this)&&(!this.previous&&this._sources.length?(this.prepareNextSource(),!0):this.previous||this._sources.length||this.generatedError?void 0:(this.end(),!0))},h.prototype.error=function(m){var y=this._sources;if(!l.prototype.error.call(this,m))return!1;for(var b=0;b<y.length;b++)try{y[b].error(m)}catch{}return!0},h.prototype.lock=function(){l.prototype.lock.call(this);for(var m=this._sources,y=0;y<m.length;y++)m[y].lock()},r.exports=h},{"../crc32":4,"../signature":23,"../stream/GenericWorker":28,"../utf8":31,"../utils":32}],9:[function(n,r,s){var i=n("../compressions"),a=n("./ZipFileWorker");s.generateWorker=function(o,l,c){var u=new a(l.streamFiles,c,l.platform,l.encodeFileName),d=0;try{o.forEach(function(h,m){d++;var y=function(w,S){var k=w||S,C=i[k];if(!C)throw new Error(k+" is not a valid compression method !");return C}(m.options.compression,l.compression),b=m.options.compressionOptions||l.compressionOptions||{},v=m.dir,x=m.date;m._compressWorker(y,b).withStreamInfo("file",{name:h,dir:v,date:x,comment:m.comment||"",unixPermissions:m.unixPermissions,dosPermissions:m.dosPermissions}).pipe(u)}),u.entriesCount=d}catch(h){u.error(h)}return u}},{"../compressions":3,"./ZipFileWorker":8}],10:[function(n,r,s){function i(){if(!(this instanceof i))return new i;if(arguments.length)throw new Error("The constructor with parameters has been removed in JSZip 3.0, please check the upgrade guide.");this.files=Object.create(null),this.comment=null,this.root="",this.clone=function(){var a=new i;for(var o in this)typeof this[o]!="function"&&(a[o]=this[o]);return a}}(i.prototype=n("./object")).loadAsync=n("./load"),i.support=n("./support"),i.defaults=n("./defaults"),i.version="3.10.1",i.loadAsync=function(a,o){return new i().loadAsync(a,o)},i.external=n("./external"),r.exports=i},{"./defaults":5,"./external":6,"./load":11,"./object":15,"./support":30}],11:[function(n,r,s){var i=n("./utils"),a=n("./external"),o=n("./utf8"),l=n("./zipEntries"),c=n("./stream/Crc32Probe"),u=n("./nodejsUtils");function d(h){return new a.Promise(function(m,y){var b=h.decompressed.getContentWorker().pipe(new c);b.on("error",function(v){y(v)}).on("end",function(){b.streamInfo.crc32!==h.decompressed.crc32?y(new Error("Corrupted zip : CRC32 mismatch")):m()}).resume()})}r.exports=function(h,m){var y=this;return m=i.extend(m||{},{base64:!1,checkCRC32:!1,optimizedBinaryString:!1,createFolders:!1,decodeFileName:o.utf8decode}),u.isNode&&u.isStream(h)?a.Promise.reject(new Error("JSZip can't accept a stream when loading a zip file.")):i.prepareContent("the loaded zip file",h,!0,m.optimizedBinaryString,m.base64).then(function(b){var v=new l(m);return v.load(b),v}).then(function(b){var v=[a.Promise.resolve(b)],x=b.files;if(m.checkCRC32)for(var w=0;w<x.length;w++)v.push(d(x[w]));return a.Promise.all(v)}).then(function(b){for(var v=b.shift(),x=v.files,w=0;w<x.length;w++){var S=x[w],k=S.fileNameStr,C=i.resolve(S.fileNameStr);y.file(C,S.decompressed,{binary:!0,optimizedBinaryString:!0,date:S.date,dir:S.dir,comment:S.fileCommentStr.length?S.fileCommentStr:null,unixPermissions:S.unixPermissions,dosPermissions:S.dosPermissions,createFolders:m.createFolders}),S.dir||(y.file(C).unsafeOriginalName=k)}return v.zipComment.length&&(y.comment=v.zipComment),y})}},{"./external":6,"./nodejsUtils":14,"./stream/Crc32Probe":25,"./utf8":31,"./utils":32,"./zipEntries":33}],12:[function(n,r,s){var i=n("../utils"),a=n("../stream/GenericWorker");function o(l,c){a.call(this,"Nodejs stream input adapter for "+l),this._upstreamEnded=!1,this._bindStream(c)}i.inherits(o,a),o.prototype._bindStream=function(l){var c=this;(this._stream=l).pause(),l.on("data",function(u){c.push({data:u,meta:{percent:0}})}).on("error",function(u){c.isPaused?this.generatedError=u:c.error(u)}).on("end",function(){c.isPaused?c._upstreamEnded=!0:c.end()})},o.prototype.pause=function(){return!!a.prototype.pause.call(this)&&(this._stream.pause(),!0)},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(this._upstreamEnded?this.end():this._stream.resume(),!0)},r.exports=o},{"../stream/GenericWorker":28,"../utils":32}],13:[function(n,r,s){var i=n("readable-stream").Readable;function a(o,l,c){i.call(this,l),this._helper=o;var u=this;o.on("data",function(d,h){u.push(d)||u._helper.pause(),c&&c(h)}).on("error",function(d){u.emit("error",d)}).on("end",function(){u.push(null)})}n("../utils").inherits(a,i),a.prototype._read=function(){this._helper.resume()},r.exports=a},{"../utils":32,"readable-stream":16}],14:[function(n,r,s){r.exports={isNode:typeof cn<"u",newBufferFrom:function(i,a){if(cn.from&&cn.from!==Uint8Array.from)return cn.from(i,a);if(typeof i=="number")throw new Error('The "data" argument must not be a number');return new cn(i,a)},allocBuffer:function(i){if(cn.alloc)return cn.alloc(i);var a=new cn(i);return a.fill(0),a},isBuffer:function(i){return cn.isBuffer(i)},isStream:function(i){return i&&typeof i.on=="function"&&typeof i.pause=="function"&&typeof i.resume=="function"}}},{}],15:[function(n,r,s){function i(C,T,A){var N,I=o.getTypeOf(T),O=o.extend(A||{},u);O.date=O.date||new Date,O.compression!==null&&(O.compression=O.compression.toUpperCase()),typeof O.unixPermissions=="string"&&(O.unixPermissions=parseInt(O.unixPermissions,8)),O.unixPermissions&&16384&O.unixPermissions&&(O.dir=!0),O.dosPermissions&&16&O.dosPermissions&&(O.dir=!0),O.dir&&(C=x(C)),O.createFolders&&(N=v(C))&&w.call(this,N,!0);var B=I==="string"&&O.binary===!1&&O.base64===!1;A&&A.binary!==void 0||(O.binary=!B),(T instanceof d&&T.uncompressedSize===0||O.dir||!T||T.length===0)&&(O.base64=!1,O.binary=!0,T="",O.compression="STORE",I="string");var D=null;D=T instanceof d||T instanceof l?T:y.isNode&&y.isStream(T)?new b(C,T):o.prepareContent(C,T,O.binary,O.optimizedBinaryString,O.base64);var H=new h(C,D,O);this.files[C]=H}var a=n("./utf8"),o=n("./utils"),l=n("./stream/GenericWorker"),c=n("./stream/StreamHelper"),u=n("./defaults"),d=n("./compressedObject"),h=n("./zipObject"),m=n("./generate"),y=n("./nodejsUtils"),b=n("./nodejs/NodejsStreamInputAdapter"),v=function(C){C.slice(-1)==="/"&&(C=C.substring(0,C.length-1));var T=C.lastIndexOf("/");return 0<T?C.substring(0,T):""},x=function(C){return C.slice(-1)!=="/"&&(C+="/"),C},w=function(C,T){return T=T!==void 0?T:u.createFolders,C=x(C),this.files[C]||i.call(this,C,null,{dir:!0,createFolders:T}),this.files[C]};function S(C){return Object.prototype.toString.call(C)==="[object RegExp]"}var k={load:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},forEach:function(C){var T,A,N;for(T in this.files)N=this.files[T],(A=T.slice(this.root.length,T.length))&&T.slice(0,this.root.length)===this.root&&C(A,N)},filter:function(C){var T=[];return this.forEach(function(A,N){C(A,N)&&T.push(N)}),T},file:function(C,T,A){if(arguments.length!==1)return C=this.root+C,i.call(this,C,T,A),this;if(S(C)){var N=C;return this.filter(function(O,B){return!B.dir&&N.test(O)})}var I=this.files[this.root+C];return I&&!I.dir?I:null},folder:function(C){if(!C)return this;if(S(C))return this.filter(function(I,O){return O.dir&&C.test(I)});var T=this.root+C,A=w.call(this,T),N=this.clone();return N.root=A.name,N},remove:function(C){C=this.root+C;var T=this.files[C];if(T||(C.slice(-1)!=="/"&&(C+="/"),T=this.files[C]),T&&!T.dir)delete this.files[C];else for(var A=this.filter(function(I,O){return O.name.slice(0,C.length)===C}),N=0;N<A.length;N++)delete this.files[A[N].name];return this},generate:function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},generateInternalStream:function(C){var T,A={};try{if((A=o.extend(C||{},{streamFiles:!1,compression:"STORE",compressionOptions:null,type:"",platform:"DOS",comment:null,mimeType:"application/zip",encodeFileName:a.utf8encode})).type=A.type.toLowerCase(),A.compression=A.compression.toUpperCase(),A.type==="binarystring"&&(A.type="string"),!A.type)throw new Error("No output type specified.");o.checkSupport(A.type),A.platform!=="darwin"&&A.platform!=="freebsd"&&A.platform!=="linux"&&A.platform!=="sunos"||(A.platform="UNIX"),A.platform==="win32"&&(A.platform="DOS");var N=A.comment||this.comment||"";T=m.generateWorker(this,A,N)}catch(I){(T=new l("error")).error(I)}return new c(T,A.type||"string",A.mimeType)},generateAsync:function(C,T){return this.generateInternalStream(C).accumulate(T)},generateNodeStream:function(C,T){return(C=C||{}).type||(C.type="nodebuffer"),this.generateInternalStream(C).toNodejsStream(T)}};r.exports=k},{"./compressedObject":2,"./defaults":5,"./generate":9,"./nodejs/NodejsStreamInputAdapter":12,"./nodejsUtils":14,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31,"./utils":32,"./zipObject":35}],16:[function(n,r,s){r.exports=n("stream")},{stream:void 0}],17:[function(n,r,s){var i=n("./DataReader");function a(o){i.call(this,o);for(var l=0;l<this.data.length;l++)o[l]=255&o[l]}n("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data[this.zero+o]},a.prototype.lastIndexOfSignature=function(o){for(var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.length-4;0<=h;--h)if(this.data[h]===l&&this.data[h+1]===c&&this.data[h+2]===u&&this.data[h+3]===d)return h-this.zero;return-1},a.prototype.readAndCheckSignature=function(o){var l=o.charCodeAt(0),c=o.charCodeAt(1),u=o.charCodeAt(2),d=o.charCodeAt(3),h=this.readData(4);return l===h[0]&&c===h[1]&&u===h[2]&&d===h[3]},a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return[];var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],18:[function(n,r,s){var i=n("../utils");function a(o){this.data=o,this.length=o.length,this.index=0,this.zero=0}a.prototype={checkOffset:function(o){this.checkIndex(this.index+o)},checkIndex:function(o){if(this.length<this.zero+o||o<0)throw new Error("End of data reached (data length = "+this.length+", asked index = "+o+"). Corrupted zip ?")},setIndex:function(o){this.checkIndex(o),this.index=o},skip:function(o){this.setIndex(this.index+o)},byteAt:function(){},readInt:function(o){var l,c=0;for(this.checkOffset(o),l=this.index+o-1;l>=this.index;l--)c=(c<<8)+this.byteAt(l);return this.index+=o,c},readString:function(o){return i.transformTo("string",this.readData(o))},readData:function(){},lastIndexOfSignature:function(){},readAndCheckSignature:function(){},readDate:function(){var o=this.readInt(4);return new Date(Date.UTC(1980+(o>>25&127),(o>>21&15)-1,o>>16&31,o>>11&31,o>>5&63,(31&o)<<1))}},r.exports=a},{"../utils":32}],19:[function(n,r,s){var i=n("./Uint8ArrayReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./Uint8ArrayReader":21}],20:[function(n,r,s){var i=n("./DataReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.byteAt=function(o){return this.data.charCodeAt(this.zero+o)},a.prototype.lastIndexOfSignature=function(o){return this.data.lastIndexOf(o)-this.zero},a.prototype.readAndCheckSignature=function(o){return o===this.readData(4)},a.prototype.readData=function(o){this.checkOffset(o);var l=this.data.slice(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./DataReader":18}],21:[function(n,r,s){var i=n("./ArrayReader");function a(o){i.call(this,o)}n("../utils").inherits(a,i),a.prototype.readData=function(o){if(this.checkOffset(o),o===0)return new Uint8Array(0);var l=this.data.subarray(this.zero+this.index,this.zero+this.index+o);return this.index+=o,l},r.exports=a},{"../utils":32,"./ArrayReader":17}],22:[function(n,r,s){var i=n("../utils"),a=n("../support"),o=n("./ArrayReader"),l=n("./StringReader"),c=n("./NodeBufferReader"),u=n("./Uint8ArrayReader");r.exports=function(d){var h=i.getTypeOf(d);return i.checkSupport(h),h!=="string"||a.uint8array?h==="nodebuffer"?new c(d):a.uint8array?new u(i.transformTo("uint8array",d)):new o(i.transformTo("array",d)):new l(d)}},{"../support":30,"../utils":32,"./ArrayReader":17,"./NodeBufferReader":19,"./StringReader":20,"./Uint8ArrayReader":21}],23:[function(n,r,s){s.LOCAL_FILE_HEADER="PK",s.CENTRAL_FILE_HEADER="PK",s.CENTRAL_DIRECTORY_END="PK",s.ZIP64_CENTRAL_DIRECTORY_LOCATOR="PK\x07",s.ZIP64_CENTRAL_DIRECTORY_END="PK",s.DATA_DESCRIPTOR="PK\x07\b"},{}],24:[function(n,r,s){var i=n("./GenericWorker"),a=n("../utils");function o(l){i.call(this,"ConvertWorker to "+l),this.destType=l}a.inherits(o,i),o.prototype.processChunk=function(l){this.push({data:a.transformTo(this.destType,l.data),meta:l.meta})},r.exports=o},{"../utils":32,"./GenericWorker":28}],25:[function(n,r,s){var i=n("./GenericWorker"),a=n("../crc32");function o(){i.call(this,"Crc32Probe"),this.withStreamInfo("crc32",0)}n("../utils").inherits(o,i),o.prototype.processChunk=function(l){this.streamInfo.crc32=a(l.data,this.streamInfo.crc32||0),this.push(l)},r.exports=o},{"../crc32":4,"../utils":32,"./GenericWorker":28}],26:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataLengthProbe for "+l),this.propName=l,this.withStreamInfo(l,0)}i.inherits(o,a),o.prototype.processChunk=function(l){if(l){var c=this.streamInfo[this.propName]||0;this.streamInfo[this.propName]=c+l.data.length}a.prototype.processChunk.call(this,l)},r.exports=o},{"../utils":32,"./GenericWorker":28}],27:[function(n,r,s){var i=n("../utils"),a=n("./GenericWorker");function o(l){a.call(this,"DataWorker");var c=this;this.dataIsReady=!1,this.index=0,this.max=0,this.data=null,this.type="",this._tickScheduled=!1,l.then(function(u){c.dataIsReady=!0,c.data=u,c.max=u&&u.length||0,c.type=i.getTypeOf(u),c.isPaused||c._tickAndRepeat()},function(u){c.error(u)})}i.inherits(o,a),o.prototype.cleanUp=function(){a.prototype.cleanUp.call(this),this.data=null},o.prototype.resume=function(){return!!a.prototype.resume.call(this)&&(!this._tickScheduled&&this.dataIsReady&&(this._tickScheduled=!0,i.delay(this._tickAndRepeat,[],this)),!0)},o.prototype._tickAndRepeat=function(){this._tickScheduled=!1,this.isPaused||this.isFinished||(this._tick(),this.isFinished||(i.delay(this._tickAndRepeat,[],this),this._tickScheduled=!0))},o.prototype._tick=function(){if(this.isPaused||this.isFinished)return!1;var l=null,c=Math.min(this.max,this.index+16384);if(this.index>=this.max)return this.end();switch(this.type){case"string":l=this.data.substring(this.index,c);break;case"uint8array":l=this.data.subarray(this.index,c);break;case"array":case"nodebuffer":l=this.data.slice(this.index,c)}return this.index=c,this.push({data:l,meta:{percent:this.max?this.index/this.max*100:0}})},r.exports=o},{"../utils":32,"./GenericWorker":28}],28:[function(n,r,s){function i(a){this.name=a||"default",this.streamInfo={},this.generatedError=null,this.extraStreamInfo={},this.isPaused=!0,this.isFinished=!1,this.isLocked=!1,this._listeners={data:[],end:[],error:[]},this.previous=null}i.prototype={push:function(a){this.emit("data",a)},end:function(){if(this.isFinished)return!1;this.flush();try{this.emit("end"),this.cleanUp(),this.isFinished=!0}catch(a){this.emit("error",a)}return!0},error:function(a){return!this.isFinished&&(this.isPaused?this.generatedError=a:(this.isFinished=!0,this.emit("error",a),this.previous&&this.previous.error(a),this.cleanUp()),!0)},on:function(a,o){return this._listeners[a].push(o),this},cleanUp:function(){this.streamInfo=this.generatedError=this.extraStreamInfo=null,this._listeners=[]},emit:function(a,o){if(this._listeners[a])for(var l=0;l<this._listeners[a].length;l++)this._listeners[a][l].call(this,o)},pipe:function(a){return a.registerPrevious(this)},registerPrevious:function(a){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.streamInfo=a.streamInfo,this.mergeStreamInfo(),this.previous=a;var o=this;return a.on("data",function(l){o.processChunk(l)}),a.on("end",function(){o.end()}),a.on("error",function(l){o.error(l)}),this},pause:function(){return!this.isPaused&&!this.isFinished&&(this.isPaused=!0,this.previous&&this.previous.pause(),!0)},resume:function(){if(!this.isPaused||this.isFinished)return!1;var a=this.isPaused=!1;return this.generatedError&&(this.error(this.generatedError),a=!0),this.previous&&this.previous.resume(),!a},flush:function(){},processChunk:function(a){this.push(a)},withStreamInfo:function(a,o){return this.extraStreamInfo[a]=o,this.mergeStreamInfo(),this},mergeStreamInfo:function(){for(var a in this.extraStreamInfo)Object.prototype.hasOwnProperty.call(this.extraStreamInfo,a)&&(this.streamInfo[a]=this.extraStreamInfo[a])},lock:function(){if(this.isLocked)throw new Error("The stream '"+this+"' has already been used.");this.isLocked=!0,this.previous&&this.previous.lock()},toString:function(){var a="Worker "+this.name;return this.previous?this.previous+" -> "+a:a}},r.exports=i},{}],29:[function(n,r,s){var i=n("../utils"),a=n("./ConvertWorker"),o=n("./GenericWorker"),l=n("../base64"),c=n("../support"),u=n("../external"),d=null;if(c.nodestream)try{d=n("../nodejs/NodejsStreamOutputAdapter")}catch{}function h(y,b){return new u.Promise(function(v,x){var w=[],S=y._internalType,k=y._outputType,C=y._mimeType;y.on("data",function(T,A){w.push(T),b&&b(A)}).on("error",function(T){w=[],x(T)}).on("end",function(){try{var T=function(A,N,I){switch(A){case"blob":return i.newBlob(i.transformTo("arraybuffer",N),I);case"base64":return l.encode(N);default:return i.transformTo(A,N)}}(k,function(A,N){var I,O=0,B=null,D=0;for(I=0;I<N.length;I++)D+=N[I].length;switch(A){case"string":return N.join("");case"array":return Array.prototype.concat.apply([],N);case"uint8array":for(B=new Uint8Array(D),I=0;I<N.length;I++)B.set(N[I],O),O+=N[I].length;return B;case"nodebuffer":return cn.concat(N);default:throw new Error("concat : unsupported type '"+A+"'")}}(S,w),C);v(T)}catch(A){x(A)}w=[]}).resume()})}function m(y,b,v){var x=b;switch(b){case"blob":case"arraybuffer":x="uint8array";break;case"base64":x="string"}try{this._internalType=x,this._outputType=b,this._mimeType=v,i.checkSupport(x),this._worker=y.pipe(new a(x)),y.lock()}catch(w){this._worker=new o("error"),this._worker.error(w)}}m.prototype={accumulate:function(y){return h(this,y)},on:function(y,b){var v=this;return y==="data"?this._worker.on(y,function(x){b.call(v,x.data,x.meta)}):this._worker.on(y,function(){i.delay(b,arguments,v)}),this},resume:function(){return i.delay(this._worker.resume,[],this._worker),this},pause:function(){return this._worker.pause(),this},toNodejsStream:function(y){if(i.checkSupport("nodestream"),this._outputType!=="nodebuffer")throw new Error(this._outputType+" is not supported by this method");return new d(this,{objectMode:this._outputType!=="nodebuffer"},y)}},r.exports=m},{"../base64":1,"../external":6,"../nodejs/NodejsStreamOutputAdapter":13,"../support":30,"../utils":32,"./ConvertWorker":24,"./GenericWorker":28}],30:[function(n,r,s){if(s.base64=!0,s.array=!0,s.string=!0,s.arraybuffer=typeof ArrayBuffer<"u"&&typeof Uint8Array<"u",s.nodebuffer=typeof cn<"u",s.uint8array=typeof Uint8Array<"u",typeof ArrayBuffer>"u")s.blob=!1;else{var i=new ArrayBuffer(0);try{s.blob=new Blob([i],{type:"application/zip"}).size===0}catch{try{var a=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);a.append(i),s.blob=a.getBlob("application/zip").size===0}catch{s.blob=!1}}}try{s.nodestream=!!n("readable-stream").Readable}catch{s.nodestream=!1}},{"readable-stream":16}],31:[function(n,r,s){for(var i=n("./utils"),a=n("./support"),o=n("./nodejsUtils"),l=n("./stream/GenericWorker"),c=new Array(256),u=0;u<256;u++)c[u]=252<=u?6:248<=u?5:240<=u?4:224<=u?3:192<=u?2:1;c[254]=c[254]=1;function d(){l.call(this,"utf-8 decode"),this.leftOver=null}function h(){l.call(this,"utf-8 encode")}s.utf8encode=function(m){return a.nodebuffer?o.newBufferFrom(m,"utf-8"):function(y){var b,v,x,w,S,k=y.length,C=0;for(w=0;w<k;w++)(64512&(v=y.charCodeAt(w)))==55296&&w+1<k&&(64512&(x=y.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),w++),C+=v<128?1:v<2048?2:v<65536?3:4;for(b=a.uint8array?new Uint8Array(C):new Array(C),w=S=0;S<C;w++)(64512&(v=y.charCodeAt(w)))==55296&&w+1<k&&(64512&(x=y.charCodeAt(w+1)))==56320&&(v=65536+(v-55296<<10)+(x-56320),w++),v<128?b[S++]=v:(v<2048?b[S++]=192|v>>>6:(v<65536?b[S++]=224|v>>>12:(b[S++]=240|v>>>18,b[S++]=128|v>>>12&63),b[S++]=128|v>>>6&63),b[S++]=128|63&v);return b}(m)},s.utf8decode=function(m){return a.nodebuffer?i.transformTo("nodebuffer",m).toString("utf-8"):function(y){var b,v,x,w,S=y.length,k=new Array(2*S);for(b=v=0;b<S;)if((x=y[b++])<128)k[v++]=x;else if(4<(w=c[x]))k[v++]=65533,b+=w-1;else{for(x&=w===2?31:w===3?15:7;1<w&&b<S;)x=x<<6|63&y[b++],w--;1<w?k[v++]=65533:x<65536?k[v++]=x:(x-=65536,k[v++]=55296|x>>10&1023,k[v++]=56320|1023&x)}return k.length!==v&&(k.subarray?k=k.subarray(0,v):k.length=v),i.applyFromCharCode(k)}(m=i.transformTo(a.uint8array?"uint8array":"array",m))},i.inherits(d,l),d.prototype.processChunk=function(m){var y=i.transformTo(a.uint8array?"uint8array":"array",m.data);if(this.leftOver&&this.leftOver.length){if(a.uint8array){var b=y;(y=new Uint8Array(b.length+this.leftOver.length)).set(this.leftOver,0),y.set(b,this.leftOver.length)}else y=this.leftOver.concat(y);this.leftOver=null}var v=function(w,S){var k;for((S=S||w.length)>w.length&&(S=w.length),k=S-1;0<=k&&(192&w[k])==128;)k--;return k<0||k===0?S:k+c[w[k]]>S?k:S}(y),x=y;v!==y.length&&(a.uint8array?(x=y.subarray(0,v),this.leftOver=y.subarray(v,y.length)):(x=y.slice(0,v),this.leftOver=y.slice(v,y.length))),this.push({data:s.utf8decode(x),meta:m.meta})},d.prototype.flush=function(){this.leftOver&&this.leftOver.length&&(this.push({data:s.utf8decode(this.leftOver),meta:{}}),this.leftOver=null)},s.Utf8DecodeWorker=d,i.inherits(h,l),h.prototype.processChunk=function(m){this.push({data:s.utf8encode(m.data),meta:m.meta})},s.Utf8EncodeWorker=h},{"./nodejsUtils":14,"./stream/GenericWorker":28,"./support":30,"./utils":32}],32:[function(n,r,s){var i=n("./support"),a=n("./base64"),o=n("./nodejsUtils"),l=n("./external");function c(b){return b}function u(b,v){for(var x=0;x<b.length;++x)v[x]=255&b.charCodeAt(x);return v}n("setimmediate"),s.newBlob=function(b,v){s.checkSupport("blob");try{return new Blob([b],{type:v})}catch{try{var x=new(self.BlobBuilder||self.WebKitBlobBuilder||self.MozBlobBuilder||self.MSBlobBuilder);return x.append(b),x.getBlob(v)}catch{throw new Error("Bug : can't construct the Blob.")}}};var d={stringifyByChunk:function(b,v,x){var w=[],S=0,k=b.length;if(k<=x)return String.fromCharCode.apply(null,b);for(;S<k;)v==="array"||v==="nodebuffer"?w.push(String.fromCharCode.apply(null,b.slice(S,Math.min(S+x,k)))):w.push(String.fromCharCode.apply(null,b.subarray(S,Math.min(S+x,k)))),S+=x;return w.join("")},stringifyByChar:function(b){for(var v="",x=0;x<b.length;x++)v+=String.fromCharCode(b[x]);return v},applyCanBeUsed:{uint8array:function(){try{return i.uint8array&&String.fromCharCode.apply(null,new Uint8Array(1)).length===1}catch{return!1}}(),nodebuffer:function(){try{return i.nodebuffer&&String.fromCharCode.apply(null,o.allocBuffer(1)).length===1}catch{return!1}}()}};function h(b){var v=65536,x=s.getTypeOf(b),w=!0;if(x==="uint8array"?w=d.applyCanBeUsed.uint8array:x==="nodebuffer"&&(w=d.applyCanBeUsed.nodebuffer),w)for(;1<v;)try{return d.stringifyByChunk(b,x,v)}catch{v=Math.floor(v/2)}return d.stringifyByChar(b)}function m(b,v){for(var x=0;x<b.length;x++)v[x]=b[x];return v}s.applyFromCharCode=h;var y={};y.string={string:c,array:function(b){return u(b,new Array(b.length))},arraybuffer:function(b){return y.string.uint8array(b).buffer},uint8array:function(b){return u(b,new Uint8Array(b.length))},nodebuffer:function(b){return u(b,o.allocBuffer(b.length))}},y.array={string:h,array:c,arraybuffer:function(b){return new Uint8Array(b).buffer},uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(b)}},y.arraybuffer={string:function(b){return h(new Uint8Array(b))},array:function(b){return m(new Uint8Array(b),new Array(b.byteLength))},arraybuffer:c,uint8array:function(b){return new Uint8Array(b)},nodebuffer:function(b){return o.newBufferFrom(new Uint8Array(b))}},y.uint8array={string:h,array:function(b){return m(b,new Array(b.length))},arraybuffer:function(b){return b.buffer},uint8array:c,nodebuffer:function(b){return o.newBufferFrom(b)}},y.nodebuffer={string:h,array:function(b){return m(b,new Array(b.length))},arraybuffer:function(b){return y.nodebuffer.uint8array(b).buffer},uint8array:function(b){return m(b,new Uint8Array(b.length))},nodebuffer:c},s.transformTo=function(b,v){if(v=v||"",!b)return v;s.checkSupport(b);var x=s.getTypeOf(v);return y[x][b](v)},s.resolve=function(b){for(var v=b.split("/"),x=[],w=0;w<v.length;w++){var S=v[w];S==="."||S===""&&w!==0&&w!==v.length-1||(S===".."?x.pop():x.push(S))}return x.join("/")},s.getTypeOf=function(b){return typeof b=="string"?"string":Object.prototype.toString.call(b)==="[object Array]"?"array":i.nodebuffer&&o.isBuffer(b)?"nodebuffer":i.uint8array&&b instanceof Uint8Array?"uint8array":i.arraybuffer&&b instanceof ArrayBuffer?"arraybuffer":void 0},s.checkSupport=function(b){if(!i[b.toLowerCase()])throw new Error(b+" is not supported by this platform")},s.MAX_VALUE_16BITS=65535,s.MAX_VALUE_32BITS=-1,s.pretty=function(b){var v,x,w="";for(x=0;x<(b||"").length;x++)w+="\\x"+((v=b.charCodeAt(x))<16?"0":"")+v.toString(16).toUpperCase();return w},s.delay=function(b,v,x){setImmediate(function(){b.apply(x||null,v||[])})},s.inherits=function(b,v){function x(){}x.prototype=v.prototype,b.prototype=new x},s.extend=function(){var b,v,x={};for(b=0;b<arguments.length;b++)for(v in arguments[b])Object.prototype.hasOwnProperty.call(arguments[b],v)&&x[v]===void 0&&(x[v]=arguments[b][v]);return x},s.prepareContent=function(b,v,x,w,S){return l.Promise.resolve(v).then(function(k){return i.blob&&(k instanceof Blob||["[object File]","[object Blob]"].indexOf(Object.prototype.toString.call(k))!==-1)&&typeof FileReader<"u"?new l.Promise(function(C,T){var A=new FileReader;A.onload=function(N){C(N.target.result)},A.onerror=function(N){T(N.target.error)},A.readAsArrayBuffer(k)}):k}).then(function(k){var C=s.getTypeOf(k);return C?(C==="arraybuffer"?k=s.transformTo("uint8array",k):C==="string"&&(S?k=a.decode(k):x&&w!==!0&&(k=function(T){return u(T,i.uint8array?new Uint8Array(T.length):new Array(T.length))}(k))),k):l.Promise.reject(new Error("Can't read the data of '"+b+"'. Is it in a supported JavaScript type (String, Blob, ArrayBuffer, etc) ?"))})}},{"./base64":1,"./external":6,"./nodejsUtils":14,"./support":30,setimmediate:54}],33:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),o=n("./signature"),l=n("./zipEntry"),c=n("./support");function u(d){this.files=[],this.loadOptions=d}u.prototype={checkSignature:function(d){if(!this.reader.readAndCheckSignature(d)){this.reader.index-=4;var h=this.reader.readString(4);throw new Error("Corrupted zip or bug: unexpected signature ("+a.pretty(h)+", expected "+a.pretty(d)+")")}},isSignature:function(d,h){var m=this.reader.index;this.reader.setIndex(d);var y=this.reader.readString(4)===h;return this.reader.setIndex(m),y},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2),this.diskWithCentralDirStart=this.reader.readInt(2),this.centralDirRecordsOnThisDisk=this.reader.readInt(2),this.centralDirRecords=this.reader.readInt(2),this.centralDirSize=this.reader.readInt(4),this.centralDirOffset=this.reader.readInt(4),this.zipCommentLength=this.reader.readInt(2);var d=this.reader.readData(this.zipCommentLength),h=c.uint8array?"uint8array":"array",m=a.transformTo(h,d);this.zipComment=this.loadOptions.decodeFileName(m)},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8),this.reader.skip(4),this.diskNumber=this.reader.readInt(4),this.diskWithCentralDirStart=this.reader.readInt(4),this.centralDirRecordsOnThisDisk=this.reader.readInt(8),this.centralDirRecords=this.reader.readInt(8),this.centralDirSize=this.reader.readInt(8),this.centralDirOffset=this.reader.readInt(8),this.zip64ExtensibleData={};for(var d,h,m,y=this.zip64EndOfCentralSize-44;0<y;)d=this.reader.readInt(2),h=this.reader.readInt(4),m=this.reader.readData(h),this.zip64ExtensibleData[d]={id:d,length:h,value:m}},readBlockZip64EndOfCentralLocator:function(){if(this.diskWithZip64CentralDirStart=this.reader.readInt(4),this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8),this.disksCount=this.reader.readInt(4),1<this.disksCount)throw new Error("Multi-volumes zip are not supported")},readLocalFiles:function(){var d,h;for(d=0;d<this.files.length;d++)h=this.files[d],this.reader.setIndex(h.localHeaderOffset),this.checkSignature(o.LOCAL_FILE_HEADER),h.readLocalPart(this.reader),h.handleUTF8(),h.processAttributes()},readCentralDir:function(){var d;for(this.reader.setIndex(this.centralDirOffset);this.reader.readAndCheckSignature(o.CENTRAL_FILE_HEADER);)(d=new l({zip64:this.zip64},this.loadOptions)).readCentralPart(this.reader),this.files.push(d);if(this.centralDirRecords!==this.files.length&&this.centralDirRecords!==0&&this.files.length===0)throw new Error("Corrupted zip or bug: expected "+this.centralDirRecords+" records in central dir, got "+this.files.length)},readEndOfCentral:function(){var d=this.reader.lastIndexOfSignature(o.CENTRAL_DIRECTORY_END);if(d<0)throw this.isSignature(0,o.LOCAL_FILE_HEADER)?new Error("Corrupted zip: can't find end of central directory"):new Error("Can't find end of central directory : is this a zip file ? If it is, see https://stuk.github.io/jszip/documentation/howto/read_zip.html");this.reader.setIndex(d);var h=d;if(this.checkSignature(o.CENTRAL_DIRECTORY_END),this.readBlockEndOfCentral(),this.diskNumber===a.MAX_VALUE_16BITS||this.diskWithCentralDirStart===a.MAX_VALUE_16BITS||this.centralDirRecordsOnThisDisk===a.MAX_VALUE_16BITS||this.centralDirRecords===a.MAX_VALUE_16BITS||this.centralDirSize===a.MAX_VALUE_32BITS||this.centralDirOffset===a.MAX_VALUE_32BITS){if(this.zip64=!0,(d=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR))<0)throw new Error("Corrupted zip: can't find the ZIP64 end of central directory locator");if(this.reader.setIndex(d),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_LOCATOR),this.readBlockZip64EndOfCentralLocator(),!this.isSignature(this.relativeOffsetEndOfZip64CentralDir,o.ZIP64_CENTRAL_DIRECTORY_END)&&(this.relativeOffsetEndOfZip64CentralDir=this.reader.lastIndexOfSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.relativeOffsetEndOfZip64CentralDir<0))throw new Error("Corrupted zip: can't find the ZIP64 end of central directory");this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir),this.checkSignature(o.ZIP64_CENTRAL_DIRECTORY_END),this.readBlockZip64EndOfCentral()}var m=this.centralDirOffset+this.centralDirSize;this.zip64&&(m+=20,m+=12+this.zip64EndOfCentralSize);var y=h-m;if(0<y)this.isSignature(h,o.CENTRAL_FILE_HEADER)||(this.reader.zero=y);else if(y<0)throw new Error("Corrupted zip: missing "+Math.abs(y)+" bytes.")},prepareReader:function(d){this.reader=i(d)},load:function(d){this.prepareReader(d),this.readEndOfCentral(),this.readCentralDir(),this.readLocalFiles()}},r.exports=u},{"./reader/readerFor":22,"./signature":23,"./support":30,"./utils":32,"./zipEntry":34}],34:[function(n,r,s){var i=n("./reader/readerFor"),a=n("./utils"),o=n("./compressedObject"),l=n("./crc32"),c=n("./utf8"),u=n("./compressions"),d=n("./support");function h(m,y){this.options=m,this.loadOptions=y}h.prototype={isEncrypted:function(){return(1&this.bitFlag)==1},useUTF8:function(){return(2048&this.bitFlag)==2048},readLocalPart:function(m){var y,b;if(m.skip(22),this.fileNameLength=m.readInt(2),b=m.readInt(2),this.fileName=m.readData(this.fileNameLength),m.skip(b),this.compressedSize===-1||this.uncompressedSize===-1)throw new Error("Bug or corrupted zip : didn't get enough information from the central directory (compressedSize === -1 || uncompressedSize === -1)");if((y=function(v){for(var x in u)if(Object.prototype.hasOwnProperty.call(u,x)&&u[x].magic===v)return u[x];return null}(this.compressionMethod))===null)throw new Error("Corrupted zip : compression "+a.pretty(this.compressionMethod)+" unknown (inner file : "+a.transformTo("string",this.fileName)+")");this.decompressed=new o(this.compressedSize,this.uncompressedSize,this.crc32,y,m.readData(this.compressedSize))},readCentralPart:function(m){this.versionMadeBy=m.readInt(2),m.skip(2),this.bitFlag=m.readInt(2),this.compressionMethod=m.readString(2),this.date=m.readDate(),this.crc32=m.readInt(4),this.compressedSize=m.readInt(4),this.uncompressedSize=m.readInt(4);var y=m.readInt(2);if(this.extraFieldsLength=m.readInt(2),this.fileCommentLength=m.readInt(2),this.diskNumberStart=m.readInt(2),this.internalFileAttributes=m.readInt(2),this.externalFileAttributes=m.readInt(4),this.localHeaderOffset=m.readInt(4),this.isEncrypted())throw new Error("Encrypted zip are not supported");m.skip(y),this.readExtraFields(m),this.parseZIP64ExtraField(m),this.fileComment=m.readData(this.fileCommentLength)},processAttributes:function(){this.unixPermissions=null,this.dosPermissions=null;var m=this.versionMadeBy>>8;this.dir=!!(16&this.externalFileAttributes),m==0&&(this.dosPermissions=63&this.externalFileAttributes),m==3&&(this.unixPermissions=this.externalFileAttributes>>16&65535),this.dir||this.fileNameStr.slice(-1)!=="/"||(this.dir=!0)},parseZIP64ExtraField:function(){if(this.extraFields[1]){var m=i(this.extraFields[1].value);this.uncompressedSize===a.MAX_VALUE_32BITS&&(this.uncompressedSize=m.readInt(8)),this.compressedSize===a.MAX_VALUE_32BITS&&(this.compressedSize=m.readInt(8)),this.localHeaderOffset===a.MAX_VALUE_32BITS&&(this.localHeaderOffset=m.readInt(8)),this.diskNumberStart===a.MAX_VALUE_32BITS&&(this.diskNumberStart=m.readInt(4))}},readExtraFields:function(m){var y,b,v,x=m.index+this.extraFieldsLength;for(this.extraFields||(this.extraFields={});m.index+4<x;)y=m.readInt(2),b=m.readInt(2),v=m.readData(b),this.extraFields[y]={id:y,length:b,value:v};m.setIndex(x)},handleUTF8:function(){var m=d.uint8array?"uint8array":"array";if(this.useUTF8())this.fileNameStr=c.utf8decode(this.fileName),this.fileCommentStr=c.utf8decode(this.fileComment);else{var y=this.findExtraFieldUnicodePath();if(y!==null)this.fileNameStr=y;else{var b=a.transformTo(m,this.fileName);this.fileNameStr=this.loadOptions.decodeFileName(b)}var v=this.findExtraFieldUnicodeComment();if(v!==null)this.fileCommentStr=v;else{var x=a.transformTo(m,this.fileComment);this.fileCommentStr=this.loadOptions.decodeFileName(x)}}},findExtraFieldUnicodePath:function(){var m=this.extraFields[28789];if(m){var y=i(m.value);return y.readInt(1)!==1||l(this.fileName)!==y.readInt(4)?null:c.utf8decode(y.readData(m.length-5))}return null},findExtraFieldUnicodeComment:function(){var m=this.extraFields[25461];if(m){var y=i(m.value);return y.readInt(1)!==1||l(this.fileComment)!==y.readInt(4)?null:c.utf8decode(y.readData(m.length-5))}return null}},r.exports=h},{"./compressedObject":2,"./compressions":3,"./crc32":4,"./reader/readerFor":22,"./support":30,"./utf8":31,"./utils":32}],35:[function(n,r,s){function i(y,b,v){this.name=y,this.dir=v.dir,this.date=v.date,this.comment=v.comment,this.unixPermissions=v.unixPermissions,this.dosPermissions=v.dosPermissions,this._data=b,this._dataBinary=v.binary,this.options={compression:v.compression,compressionOptions:v.compressionOptions}}var a=n("./stream/StreamHelper"),o=n("./stream/DataWorker"),l=n("./utf8"),c=n("./compressedObject"),u=n("./stream/GenericWorker");i.prototype={internalStream:function(y){var b=null,v="string";try{if(!y)throw new Error("No output type specified.");var x=(v=y.toLowerCase())==="string"||v==="text";v!=="binarystring"&&v!=="text"||(v="string"),b=this._decompressWorker();var w=!this._dataBinary;w&&!x&&(b=b.pipe(new l.Utf8EncodeWorker)),!w&&x&&(b=b.pipe(new l.Utf8DecodeWorker))}catch(S){(b=new u("error")).error(S)}return new a(b,v,"")},async:function(y,b){return this.internalStream(y).accumulate(b)},nodeStream:function(y,b){return this.internalStream(y||"nodebuffer").toNodejsStream(b)},_compressWorker:function(y,b){if(this._data instanceof c&&this._data.compression.magic===y.magic)return this._data.getCompressedWorker();var v=this._decompressWorker();return this._dataBinary||(v=v.pipe(new l.Utf8EncodeWorker)),c.createWorkerFrom(v,y,b)},_decompressWorker:function(){return this._data instanceof c?this._data.getContentWorker():this._data instanceof u?this._data:new o(this._data)}};for(var d=["asText","asBinary","asNodeBuffer","asUint8Array","asArrayBuffer"],h=function(){throw new Error("This method has been removed in JSZip 3.0, please check the upgrade guide.")},m=0;m<d.length;m++)i.prototype[d[m]]=h;r.exports=i},{"./compressedObject":2,"./stream/DataWorker":27,"./stream/GenericWorker":28,"./stream/StreamHelper":29,"./utf8":31}],36:[function(n,r,s){(function(i){var a,o,l=i.MutationObserver||i.WebKitMutationObserver;if(l){var c=0,u=new l(y),d=i.document.createTextNode("");u.observe(d,{characterData:!0}),a=function(){d.data=c=++c%2}}else if(i.setImmediate||i.MessageChannel===void 0)a="document"in i&&"onreadystatechange"in i.document.createElement("script")?function(){var b=i.document.createElement("script");b.onreadystatechange=function(){y(),b.onreadystatechange=null,b.parentNode.removeChild(b),b=null},i.document.documentElement.appendChild(b)}:function(){setTimeout(y,0)};else{var h=new i.MessageChannel;h.port1.onmessage=y,a=function(){h.port2.postMessage(0)}}var m=[];function y(){var b,v;o=!0;for(var x=m.length;x;){for(v=m,m=[],b=-1;++b<x;)v[b]();x=m.length}o=!1}r.exports=function(b){m.push(b)!==1||o||a()}}).call(this,typeof im<"u"?im:typeof self<"u"?self:typeof window<"u"?window:{})},{}],37:[function(n,r,s){var i=n("immediate");function a(){}var o={},l=["REJECTED"],c=["FULFILLED"],u=["PENDING"];function d(x){if(typeof x!="function")throw new TypeError("resolver must be a function");this.state=u,this.queue=[],this.outcome=void 0,x!==a&&b(this,x)}function h(x,w,S){this.promise=x,typeof w=="function"&&(this.onFulfilled=w,this.callFulfilled=this.otherCallFulfilled),typeof S=="function"&&(this.onRejected=S,this.callRejected=this.otherCallRejected)}function m(x,w,S){i(function(){var k;try{k=w(S)}catch(C){return o.reject(x,C)}k===x?o.reject(x,new TypeError("Cannot resolve promise with itself")):o.resolve(x,k)})}function y(x){var w=x&&x.then;if(x&&(typeof x=="object"||typeof x=="function")&&typeof w=="function")return function(){w.apply(x,arguments)}}function b(x,w){var S=!1;function k(A){S||(S=!0,o.reject(x,A))}function C(A){S||(S=!0,o.resolve(x,A))}var T=v(function(){w(C,k)});T.status==="error"&&k(T.value)}function v(x,w){var S={};try{S.value=x(w),S.status="success"}catch(k){S.status="error",S.value=k}return S}(r.exports=d).prototype.finally=function(x){if(typeof x!="function")return this;var w=this.constructor;return this.then(function(S){return w.resolve(x()).then(function(){return S})},function(S){return w.resolve(x()).then(function(){throw S})})},d.prototype.catch=function(x){return this.then(null,x)},d.prototype.then=function(x,w){if(typeof x!="function"&&this.state===c||typeof w!="function"&&this.state===l)return this;var S=new this.constructor(a);return this.state!==u?m(S,this.state===c?x:w,this.outcome):this.queue.push(new h(S,x,w)),S},h.prototype.callFulfilled=function(x){o.resolve(this.promise,x)},h.prototype.otherCallFulfilled=function(x){m(this.promise,this.onFulfilled,x)},h.prototype.callRejected=function(x){o.reject(this.promise,x)},h.prototype.otherCallRejected=function(x){m(this.promise,this.onRejected,x)},o.resolve=function(x,w){var S=v(y,w);if(S.status==="error")return o.reject(x,S.value);var k=S.value;if(k)b(x,k);else{x.state=c,x.outcome=w;for(var C=-1,T=x.queue.length;++C<T;)x.queue[C].callFulfilled(w)}return x},o.reject=function(x,w){x.state=l,x.outcome=w;for(var S=-1,k=x.queue.length;++S<k;)x.queue[S].callRejected(w);return x},d.resolve=function(x){return x instanceof this?x:o.resolve(new this(a),x)},d.reject=function(x){var w=new this(a);return o.reject(w,x)},d.all=function(x){var w=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,k=!1;if(!S)return this.resolve([]);for(var C=new Array(S),T=0,A=-1,N=new this(a);++A<S;)I(x[A],A);return N;function I(O,B){w.resolve(O).then(function(D){C[B]=D,++T!==S||k||(k=!0,o.resolve(N,C))},function(D){k||(k=!0,o.reject(N,D))})}},d.race=function(x){var w=this;if(Object.prototype.toString.call(x)!=="[object Array]")return this.reject(new TypeError("must be an array"));var S=x.length,k=!1;if(!S)return this.resolve([]);for(var C=-1,T=new this(a);++C<S;)A=x[C],w.resolve(A).then(function(N){k||(k=!0,o.resolve(T,N))},function(N){k||(k=!0,o.reject(T,N))});var A;return T}},{immediate:36}],38:[function(n,r,s){var i={};(0,n("./lib/utils/common").assign)(i,n("./lib/deflate"),n("./lib/inflate"),n("./lib/zlib/constants")),r.exports=i},{"./lib/deflate":39,"./lib/inflate":40,"./lib/utils/common":41,"./lib/zlib/constants":44}],39:[function(n,r,s){var i=n("./zlib/deflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/messages"),c=n("./zlib/zstream"),u=Object.prototype.toString,d=0,h=-1,m=0,y=8;function b(x){if(!(this instanceof b))return new b(x);this.options=a.assign({level:h,method:y,chunkSize:16384,windowBits:15,memLevel:8,strategy:m,to:""},x||{});var w=this.options;w.raw&&0<w.windowBits?w.windowBits=-w.windowBits:w.gzip&&0<w.windowBits&&w.windowBits<16&&(w.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new c,this.strm.avail_out=0;var S=i.deflateInit2(this.strm,w.level,w.method,w.windowBits,w.memLevel,w.strategy);if(S!==d)throw new Error(l[S]);if(w.header&&i.deflateSetHeader(this.strm,w.header),w.dictionary){var k;if(k=typeof w.dictionary=="string"?o.string2buf(w.dictionary):u.call(w.dictionary)==="[object ArrayBuffer]"?new Uint8Array(w.dictionary):w.dictionary,(S=i.deflateSetDictionary(this.strm,k))!==d)throw new Error(l[S]);this._dict_set=!0}}function v(x,w){var S=new b(w);if(S.push(x,!0),S.err)throw S.msg||l[S.err];return S.result}b.prototype.push=function(x,w){var S,k,C=this.strm,T=this.options.chunkSize;if(this.ended)return!1;k=w===~~w?w:w===!0?4:0,typeof x=="string"?C.input=o.string2buf(x):u.call(x)==="[object ArrayBuffer]"?C.input=new Uint8Array(x):C.input=x,C.next_in=0,C.avail_in=C.input.length;do{if(C.avail_out===0&&(C.output=new a.Buf8(T),C.next_out=0,C.avail_out=T),(S=i.deflate(C,k))!==1&&S!==d)return this.onEnd(S),!(this.ended=!0);C.avail_out!==0&&(C.avail_in!==0||k!==4&&k!==2)||(this.options.to==="string"?this.onData(o.buf2binstring(a.shrinkBuf(C.output,C.next_out))):this.onData(a.shrinkBuf(C.output,C.next_out)))}while((0<C.avail_in||C.avail_out===0)&&S!==1);return k===4?(S=i.deflateEnd(this.strm),this.onEnd(S),this.ended=!0,S===d):k!==2||(this.onEnd(d),!(C.avail_out=0))},b.prototype.onData=function(x){this.chunks.push(x)},b.prototype.onEnd=function(x){x===d&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=x,this.msg=this.strm.msg},s.Deflate=b,s.deflate=v,s.deflateRaw=function(x,w){return(w=w||{}).raw=!0,v(x,w)},s.gzip=function(x,w){return(w=w||{}).gzip=!0,v(x,w)}},{"./utils/common":41,"./utils/strings":42,"./zlib/deflate":46,"./zlib/messages":51,"./zlib/zstream":53}],40:[function(n,r,s){var i=n("./zlib/inflate"),a=n("./utils/common"),o=n("./utils/strings"),l=n("./zlib/constants"),c=n("./zlib/messages"),u=n("./zlib/zstream"),d=n("./zlib/gzheader"),h=Object.prototype.toString;function m(b){if(!(this instanceof m))return new m(b);this.options=a.assign({chunkSize:16384,windowBits:0,to:""},b||{});var v=this.options;v.raw&&0<=v.windowBits&&v.windowBits<16&&(v.windowBits=-v.windowBits,v.windowBits===0&&(v.windowBits=-15)),!(0<=v.windowBits&&v.windowBits<16)||b&&b.windowBits||(v.windowBits+=32),15<v.windowBits&&v.windowBits<48&&(15&v.windowBits)==0&&(v.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new u,this.strm.avail_out=0;var x=i.inflateInit2(this.strm,v.windowBits);if(x!==l.Z_OK)throw new Error(c[x]);this.header=new d,i.inflateGetHeader(this.strm,this.header)}function y(b,v){var x=new m(v);if(x.push(b,!0),x.err)throw x.msg||c[x.err];return x.result}m.prototype.push=function(b,v){var x,w,S,k,C,T,A=this.strm,N=this.options.chunkSize,I=this.options.dictionary,O=!1;if(this.ended)return!1;w=v===~~v?v:v===!0?l.Z_FINISH:l.Z_NO_FLUSH,typeof b=="string"?A.input=o.binstring2buf(b):h.call(b)==="[object ArrayBuffer]"?A.input=new Uint8Array(b):A.input=b,A.next_in=0,A.avail_in=A.input.length;do{if(A.avail_out===0&&(A.output=new a.Buf8(N),A.next_out=0,A.avail_out=N),(x=i.inflate(A,l.Z_NO_FLUSH))===l.Z_NEED_DICT&&I&&(T=typeof I=="string"?o.string2buf(I):h.call(I)==="[object ArrayBuffer]"?new Uint8Array(I):I,x=i.inflateSetDictionary(this.strm,T)),x===l.Z_BUF_ERROR&&O===!0&&(x=l.Z_OK,O=!1),x!==l.Z_STREAM_END&&x!==l.Z_OK)return this.onEnd(x),!(this.ended=!0);A.next_out&&(A.avail_out!==0&&x!==l.Z_STREAM_END&&(A.avail_in!==0||w!==l.Z_FINISH&&w!==l.Z_SYNC_FLUSH)||(this.options.to==="string"?(S=o.utf8border(A.output,A.next_out),k=A.next_out-S,C=o.buf2string(A.output,S),A.next_out=k,A.avail_out=N-k,k&&a.arraySet(A.output,A.output,S,k,0),this.onData(C)):this.onData(a.shrinkBuf(A.output,A.next_out)))),A.avail_in===0&&A.avail_out===0&&(O=!0)}while((0<A.avail_in||A.avail_out===0)&&x!==l.Z_STREAM_END);return x===l.Z_STREAM_END&&(w=l.Z_FINISH),w===l.Z_FINISH?(x=i.inflateEnd(this.strm),this.onEnd(x),this.ended=!0,x===l.Z_OK):w!==l.Z_SYNC_FLUSH||(this.onEnd(l.Z_OK),!(A.avail_out=0))},m.prototype.onData=function(b){this.chunks.push(b)},m.prototype.onEnd=function(b){b===l.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=a.flattenChunks(this.chunks)),this.chunks=[],this.err=b,this.msg=this.strm.msg},s.Inflate=m,s.inflate=y,s.inflateRaw=function(b,v){return(v=v||{}).raw=!0,y(b,v)},s.ungzip=y},{"./utils/common":41,"./utils/strings":42,"./zlib/constants":44,"./zlib/gzheader":47,"./zlib/inflate":49,"./zlib/messages":51,"./zlib/zstream":53}],41:[function(n,r,s){var i=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";s.assign=function(l){for(var c=Array.prototype.slice.call(arguments,1);c.length;){var u=c.shift();if(u){if(typeof u!="object")throw new TypeError(u+"must be non-object");for(var d in u)u.hasOwnProperty(d)&&(l[d]=u[d])}}return l},s.shrinkBuf=function(l,c){return l.length===c?l:l.subarray?l.subarray(0,c):(l.length=c,l)};var a={arraySet:function(l,c,u,d,h){if(c.subarray&&l.subarray)l.set(c.subarray(u,u+d),h);else for(var m=0;m<d;m++)l[h+m]=c[u+m]},flattenChunks:function(l){var c,u,d,h,m,y;for(c=d=0,u=l.length;c<u;c++)d+=l[c].length;for(y=new Uint8Array(d),c=h=0,u=l.length;c<u;c++)m=l[c],y.set(m,h),h+=m.length;return y}},o={arraySet:function(l,c,u,d,h){for(var m=0;m<d;m++)l[h+m]=c[u+m]},flattenChunks:function(l){return[].concat.apply([],l)}};s.setTyped=function(l){l?(s.Buf8=Uint8Array,s.Buf16=Uint16Array,s.Buf32=Int32Array,s.assign(s,a)):(s.Buf8=Array,s.Buf16=Array,s.Buf32=Array,s.assign(s,o))},s.setTyped(i)},{}],42:[function(n,r,s){var i=n("./common"),a=!0,o=!0;try{String.fromCharCode.apply(null,[0])}catch{a=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{o=!1}for(var l=new i.Buf8(256),c=0;c<256;c++)l[c]=252<=c?6:248<=c?5:240<=c?4:224<=c?3:192<=c?2:1;function u(d,h){if(h<65537&&(d.subarray&&o||!d.subarray&&a))return String.fromCharCode.apply(null,i.shrinkBuf(d,h));for(var m="",y=0;y<h;y++)m+=String.fromCharCode(d[y]);return m}l[254]=l[254]=1,s.string2buf=function(d){var h,m,y,b,v,x=d.length,w=0;for(b=0;b<x;b++)(64512&(m=d.charCodeAt(b)))==55296&&b+1<x&&(64512&(y=d.charCodeAt(b+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),b++),w+=m<128?1:m<2048?2:m<65536?3:4;for(h=new i.Buf8(w),b=v=0;v<w;b++)(64512&(m=d.charCodeAt(b)))==55296&&b+1<x&&(64512&(y=d.charCodeAt(b+1)))==56320&&(m=65536+(m-55296<<10)+(y-56320),b++),m<128?h[v++]=m:(m<2048?h[v++]=192|m>>>6:(m<65536?h[v++]=224|m>>>12:(h[v++]=240|m>>>18,h[v++]=128|m>>>12&63),h[v++]=128|m>>>6&63),h[v++]=128|63&m);return h},s.buf2binstring=function(d){return u(d,d.length)},s.binstring2buf=function(d){for(var h=new i.Buf8(d.length),m=0,y=h.length;m<y;m++)h[m]=d.charCodeAt(m);return h},s.buf2string=function(d,h){var m,y,b,v,x=h||d.length,w=new Array(2*x);for(m=y=0;m<x;)if((b=d[m++])<128)w[y++]=b;else if(4<(v=l[b]))w[y++]=65533,m+=v-1;else{for(b&=v===2?31:v===3?15:7;1<v&&m<x;)b=b<<6|63&d[m++],v--;1<v?w[y++]=65533:b<65536?w[y++]=b:(b-=65536,w[y++]=55296|b>>10&1023,w[y++]=56320|1023&b)}return u(w,y)},s.utf8border=function(d,h){var m;for((h=h||d.length)>d.length&&(h=d.length),m=h-1;0<=m&&(192&d[m])==128;)m--;return m<0||m===0?h:m+l[d[m]]>h?m:h}},{"./common":41}],43:[function(n,r,s){r.exports=function(i,a,o,l){for(var c=65535&i|0,u=i>>>16&65535|0,d=0;o!==0;){for(o-=d=2e3<o?2e3:o;u=u+(c=c+a[l++]|0)|0,--d;);c%=65521,u%=65521}return c|u<<16|0}},{}],44:[function(n,r,s){r.exports={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}},{}],45:[function(n,r,s){var i=function(){for(var a,o=[],l=0;l<256;l++){a=l;for(var c=0;c<8;c++)a=1&a?3988292384^a>>>1:a>>>1;o[l]=a}return o}();r.exports=function(a,o,l,c){var u=i,d=c+l;a^=-1;for(var h=c;h<d;h++)a=a>>>8^u[255&(a^o[h])];return-1^a}},{}],46:[function(n,r,s){var i,a=n("../utils/common"),o=n("./trees"),l=n("./adler32"),c=n("./crc32"),u=n("./messages"),d=0,h=4,m=0,y=-2,b=-1,v=4,x=2,w=8,S=9,k=286,C=30,T=19,A=2*k+1,N=15,I=3,O=258,B=O+I+1,D=42,H=113,P=1,K=2,U=3,V=4;function L(Y,ye){return Y.msg=u[ye],ye}function te(Y){return(Y<<1)-(4<Y?9:0)}function W(Y){for(var ye=Y.length;0<=--ye;)Y[ye]=0}function Q(Y){var ye=Y.state,Ie=ye.pending;Ie>Y.avail_out&&(Ie=Y.avail_out),Ie!==0&&(a.arraySet(Y.output,ye.pending_buf,ye.pending_out,Ie,Y.next_out),Y.next_out+=Ie,ye.pending_out+=Ie,Y.total_out+=Ie,Y.avail_out-=Ie,ye.pending-=Ie,ye.pending===0&&(ye.pending_out=0))}function ee(Y,ye){o._tr_flush_block(Y,0<=Y.block_start?Y.block_start:-1,Y.strstart-Y.block_start,ye),Y.block_start=Y.strstart,Q(Y.strm)}function re(Y,ye){Y.pending_buf[Y.pending++]=ye}function pe(Y,ye){Y.pending_buf[Y.pending++]=ye>>>8&255,Y.pending_buf[Y.pending++]=255&ye}function de(Y,ye){var Ie,ce,oe=Y.max_chain_length,se=Y.strstart,Me=Y.prev_length,Be=Y.nice_match,Ae=Y.strstart>Y.w_size-B?Y.strstart-(Y.w_size-B):0,lt=Y.window,Tt=Y.w_mask,dt=Y.prev,Pt=Y.strstart+O,qt=lt[se+Me-1],Ft=lt[se+Me];Y.prev_length>=Y.good_match&&(oe>>=2),Be>Y.lookahead&&(Be=Y.lookahead);do if(lt[(Ie=ye)+Me]===Ft&&lt[Ie+Me-1]===qt&&lt[Ie]===lt[se]&&lt[++Ie]===lt[se+1]){se+=2,Ie++;do;while(lt[++se]===lt[++Ie]&&lt[++se]===lt[++Ie]&&lt[++se]===lt[++Ie]&&lt[++se]===lt[++Ie]&&lt[++se]===lt[++Ie]&&lt[++se]===lt[++Ie]&&lt[++se]===lt[++Ie]&&lt[++se]===lt[++Ie]&&se<Pt);if(ce=O-(Pt-se),se=Pt-O,Me<ce){if(Y.match_start=ye,Be<=(Me=ce))break;qt=lt[se+Me-1],Ft=lt[se+Me]}}while((ye=dt[ye&Tt])>Ae&&--oe!=0);return Me<=Y.lookahead?Me:Y.lookahead}function Oe(Y){var ye,Ie,ce,oe,se,Me,Be,Ae,lt,Tt,dt=Y.w_size;do{if(oe=Y.window_size-Y.lookahead-Y.strstart,Y.strstart>=dt+(dt-B)){for(a.arraySet(Y.window,Y.window,dt,dt,0),Y.match_start-=dt,Y.strstart-=dt,Y.block_start-=dt,ye=Ie=Y.hash_size;ce=Y.head[--ye],Y.head[ye]=dt<=ce?ce-dt:0,--Ie;);for(ye=Ie=dt;ce=Y.prev[--ye],Y.prev[ye]=dt<=ce?ce-dt:0,--Ie;);oe+=dt}if(Y.strm.avail_in===0)break;if(Me=Y.strm,Be=Y.window,Ae=Y.strstart+Y.lookahead,lt=oe,Tt=void 0,Tt=Me.avail_in,lt<Tt&&(Tt=lt),Ie=Tt===0?0:(Me.avail_in-=Tt,a.arraySet(Be,Me.input,Me.next_in,Tt,Ae),Me.state.wrap===1?Me.adler=l(Me.adler,Be,Tt,Ae):Me.state.wrap===2&&(Me.adler=c(Me.adler,Be,Tt,Ae)),Me.next_in+=Tt,Me.total_in+=Tt,Tt),Y.lookahead+=Ie,Y.lookahead+Y.insert>=I)for(se=Y.strstart-Y.insert,Y.ins_h=Y.window[se],Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[se+1])&Y.hash_mask;Y.insert&&(Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[se+I-1])&Y.hash_mask,Y.prev[se&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=se,se++,Y.insert--,!(Y.lookahead+Y.insert<I)););}while(Y.lookahead<B&&Y.strm.avail_in!==0)}function Fe(Y,ye){for(var Ie,ce;;){if(Y.lookahead<B){if(Oe(Y),Y.lookahead<B&&ye===d)return P;if(Y.lookahead===0)break}if(Ie=0,Y.lookahead>=I&&(Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[Y.strstart+I-1])&Y.hash_mask,Ie=Y.prev[Y.strstart&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=Y.strstart),Ie!==0&&Y.strstart-Ie<=Y.w_size-B&&(Y.match_length=de(Y,Ie)),Y.match_length>=I)if(ce=o._tr_tally(Y,Y.strstart-Y.match_start,Y.match_length-I),Y.lookahead-=Y.match_length,Y.match_length<=Y.max_lazy_match&&Y.lookahead>=I){for(Y.match_length--;Y.strstart++,Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[Y.strstart+I-1])&Y.hash_mask,Ie=Y.prev[Y.strstart&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=Y.strstart,--Y.match_length!=0;);Y.strstart++}else Y.strstart+=Y.match_length,Y.match_length=0,Y.ins_h=Y.window[Y.strstart],Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[Y.strstart+1])&Y.hash_mask;else ce=o._tr_tally(Y,0,Y.window[Y.strstart]),Y.lookahead--,Y.strstart++;if(ce&&(ee(Y,!1),Y.strm.avail_out===0))return P}return Y.insert=Y.strstart<I-1?Y.strstart:I-1,ye===h?(ee(Y,!0),Y.strm.avail_out===0?U:V):Y.last_lit&&(ee(Y,!1),Y.strm.avail_out===0)?P:K}function Se(Y,ye){for(var Ie,ce,oe;;){if(Y.lookahead<B){if(Oe(Y),Y.lookahead<B&&ye===d)return P;if(Y.lookahead===0)break}if(Ie=0,Y.lookahead>=I&&(Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[Y.strstart+I-1])&Y.hash_mask,Ie=Y.prev[Y.strstart&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=Y.strstart),Y.prev_length=Y.match_length,Y.prev_match=Y.match_start,Y.match_length=I-1,Ie!==0&&Y.prev_length<Y.max_lazy_match&&Y.strstart-Ie<=Y.w_size-B&&(Y.match_length=de(Y,Ie),Y.match_length<=5&&(Y.strategy===1||Y.match_length===I&&4096<Y.strstart-Y.match_start)&&(Y.match_length=I-1)),Y.prev_length>=I&&Y.match_length<=Y.prev_length){for(oe=Y.strstart+Y.lookahead-I,ce=o._tr_tally(Y,Y.strstart-1-Y.prev_match,Y.prev_length-I),Y.lookahead-=Y.prev_length-1,Y.prev_length-=2;++Y.strstart<=oe&&(Y.ins_h=(Y.ins_h<<Y.hash_shift^Y.window[Y.strstart+I-1])&Y.hash_mask,Ie=Y.prev[Y.strstart&Y.w_mask]=Y.head[Y.ins_h],Y.head[Y.ins_h]=Y.strstart),--Y.prev_length!=0;);if(Y.match_available=0,Y.match_length=I-1,Y.strstart++,ce&&(ee(Y,!1),Y.strm.avail_out===0))return P}else if(Y.match_available){if((ce=o._tr_tally(Y,0,Y.window[Y.strstart-1]))&&ee(Y,!1),Y.strstart++,Y.lookahead--,Y.strm.avail_out===0)return P}else Y.match_available=1,Y.strstart++,Y.lookahead--}return Y.match_available&&(ce=o._tr_tally(Y,0,Y.window[Y.strstart-1]),Y.match_available=0),Y.insert=Y.strstart<I-1?Y.strstart:I-1,ye===h?(ee(Y,!0),Y.strm.avail_out===0?U:V):Y.last_lit&&(ee(Y,!1),Y.strm.avail_out===0)?P:K}function Ce(Y,ye,Ie,ce,oe){this.good_length=Y,this.max_lazy=ye,this.nice_length=Ie,this.max_chain=ce,this.func=oe}function qe(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=w,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new a.Buf16(2*A),this.dyn_dtree=new a.Buf16(2*(2*C+1)),this.bl_tree=new a.Buf16(2*(2*T+1)),W(this.dyn_ltree),W(this.dyn_dtree),W(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new a.Buf16(N+1),this.heap=new a.Buf16(2*k+1),W(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new a.Buf16(2*k+1),W(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function Qe(Y){var ye;return Y&&Y.state?(Y.total_in=Y.total_out=0,Y.data_type=x,(ye=Y.state).pending=0,ye.pending_out=0,ye.wrap<0&&(ye.wrap=-ye.wrap),ye.status=ye.wrap?D:H,Y.adler=ye.wrap===2?0:1,ye.last_flush=d,o._tr_init(ye),m):L(Y,y)}function We(Y){var ye=Qe(Y);return ye===m&&function(Ie){Ie.window_size=2*Ie.w_size,W(Ie.head),Ie.max_lazy_match=i[Ie.level].max_lazy,Ie.good_match=i[Ie.level].good_length,Ie.nice_match=i[Ie.level].nice_length,Ie.max_chain_length=i[Ie.level].max_chain,Ie.strstart=0,Ie.block_start=0,Ie.lookahead=0,Ie.insert=0,Ie.match_length=Ie.prev_length=I-1,Ie.match_available=0,Ie.ins_h=0}(Y.state),ye}function je(Y,ye,Ie,ce,oe,se){if(!Y)return y;var Me=1;if(ye===b&&(ye=6),ce<0?(Me=0,ce=-ce):15<ce&&(Me=2,ce-=16),oe<1||S<oe||Ie!==w||ce<8||15<ce||ye<0||9<ye||se<0||v<se)return L(Y,y);ce===8&&(ce=9);var Be=new qe;return(Y.state=Be).strm=Y,Be.wrap=Me,Be.gzhead=null,Be.w_bits=ce,Be.w_size=1<<Be.w_bits,Be.w_mask=Be.w_size-1,Be.hash_bits=oe+7,Be.hash_size=1<<Be.hash_bits,Be.hash_mask=Be.hash_size-1,Be.hash_shift=~~((Be.hash_bits+I-1)/I),Be.window=new a.Buf8(2*Be.w_size),Be.head=new a.Buf16(Be.hash_size),Be.prev=new a.Buf16(Be.w_size),Be.lit_bufsize=1<<oe+6,Be.pending_buf_size=4*Be.lit_bufsize,Be.pending_buf=new a.Buf8(Be.pending_buf_size),Be.d_buf=1*Be.lit_bufsize,Be.l_buf=3*Be.lit_bufsize,Be.level=ye,Be.strategy=se,Be.method=Ie,We(Y)}i=[new Ce(0,0,0,0,function(Y,ye){var Ie=65535;for(Ie>Y.pending_buf_size-5&&(Ie=Y.pending_buf_size-5);;){if(Y.lookahead<=1){if(Oe(Y),Y.lookahead===0&&ye===d)return P;if(Y.lookahead===0)break}Y.strstart+=Y.lookahead,Y.lookahead=0;var ce=Y.block_start+Ie;if((Y.strstart===0||Y.strstart>=ce)&&(Y.lookahead=Y.strstart-ce,Y.strstart=ce,ee(Y,!1),Y.strm.avail_out===0)||Y.strstart-Y.block_start>=Y.w_size-B&&(ee(Y,!1),Y.strm.avail_out===0))return P}return Y.insert=0,ye===h?(ee(Y,!0),Y.strm.avail_out===0?U:V):(Y.strstart>Y.block_start&&(ee(Y,!1),Y.strm.avail_out),P)}),new Ce(4,4,8,4,Fe),new Ce(4,5,16,8,Fe),new Ce(4,6,32,32,Fe),new Ce(4,4,16,16,Se),new Ce(8,16,32,32,Se),new Ce(8,16,128,128,Se),new Ce(8,32,128,256,Se),new Ce(32,128,258,1024,Se),new Ce(32,258,258,4096,Se)],s.deflateInit=function(Y,ye){return je(Y,ye,w,15,8,0)},s.deflateInit2=je,s.deflateReset=We,s.deflateResetKeep=Qe,s.deflateSetHeader=function(Y,ye){return Y&&Y.state?Y.state.wrap!==2?y:(Y.state.gzhead=ye,m):y},s.deflate=function(Y,ye){var Ie,ce,oe,se;if(!Y||!Y.state||5<ye||ye<0)return Y?L(Y,y):y;if(ce=Y.state,!Y.output||!Y.input&&Y.avail_in!==0||ce.status===666&&ye!==h)return L(Y,Y.avail_out===0?-5:y);if(ce.strm=Y,Ie=ce.last_flush,ce.last_flush=ye,ce.status===D)if(ce.wrap===2)Y.adler=0,re(ce,31),re(ce,139),re(ce,8),ce.gzhead?(re(ce,(ce.gzhead.text?1:0)+(ce.gzhead.hcrc?2:0)+(ce.gzhead.extra?4:0)+(ce.gzhead.name?8:0)+(ce.gzhead.comment?16:0)),re(ce,255&ce.gzhead.time),re(ce,ce.gzhead.time>>8&255),re(ce,ce.gzhead.time>>16&255),re(ce,ce.gzhead.time>>24&255),re(ce,ce.level===9?2:2<=ce.strategy||ce.level<2?4:0),re(ce,255&ce.gzhead.os),ce.gzhead.extra&&ce.gzhead.extra.length&&(re(ce,255&ce.gzhead.extra.length),re(ce,ce.gzhead.extra.length>>8&255)),ce.gzhead.hcrc&&(Y.adler=c(Y.adler,ce.pending_buf,ce.pending,0)),ce.gzindex=0,ce.status=69):(re(ce,0),re(ce,0),re(ce,0),re(ce,0),re(ce,0),re(ce,ce.level===9?2:2<=ce.strategy||ce.level<2?4:0),re(ce,3),ce.status=H);else{var Me=w+(ce.w_bits-8<<4)<<8;Me|=(2<=ce.strategy||ce.level<2?0:ce.level<6?1:ce.level===6?2:3)<<6,ce.strstart!==0&&(Me|=32),Me+=31-Me%31,ce.status=H,pe(ce,Me),ce.strstart!==0&&(pe(ce,Y.adler>>>16),pe(ce,65535&Y.adler)),Y.adler=1}if(ce.status===69)if(ce.gzhead.extra){for(oe=ce.pending;ce.gzindex<(65535&ce.gzhead.extra.length)&&(ce.pending!==ce.pending_buf_size||(ce.gzhead.hcrc&&ce.pending>oe&&(Y.adler=c(Y.adler,ce.pending_buf,ce.pending-oe,oe)),Q(Y),oe=ce.pending,ce.pending!==ce.pending_buf_size));)re(ce,255&ce.gzhead.extra[ce.gzindex]),ce.gzindex++;ce.gzhead.hcrc&&ce.pending>oe&&(Y.adler=c(Y.adler,ce.pending_buf,ce.pending-oe,oe)),ce.gzindex===ce.gzhead.extra.length&&(ce.gzindex=0,ce.status=73)}else ce.status=73;if(ce.status===73)if(ce.gzhead.name){oe=ce.pending;do{if(ce.pending===ce.pending_buf_size&&(ce.gzhead.hcrc&&ce.pending>oe&&(Y.adler=c(Y.adler,ce.pending_buf,ce.pending-oe,oe)),Q(Y),oe=ce.pending,ce.pending===ce.pending_buf_size)){se=1;break}se=ce.gzindex<ce.gzhead.name.length?255&ce.gzhead.name.charCodeAt(ce.gzindex++):0,re(ce,se)}while(se!==0);ce.gzhead.hcrc&&ce.pending>oe&&(Y.adler=c(Y.adler,ce.pending_buf,ce.pending-oe,oe)),se===0&&(ce.gzindex=0,ce.status=91)}else ce.status=91;if(ce.status===91)if(ce.gzhead.comment){oe=ce.pending;do{if(ce.pending===ce.pending_buf_size&&(ce.gzhead.hcrc&&ce.pending>oe&&(Y.adler=c(Y.adler,ce.pending_buf,ce.pending-oe,oe)),Q(Y),oe=ce.pending,ce.pending===ce.pending_buf_size)){se=1;break}se=ce.gzindex<ce.gzhead.comment.length?255&ce.gzhead.comment.charCodeAt(ce.gzindex++):0,re(ce,se)}while(se!==0);ce.gzhead.hcrc&&ce.pending>oe&&(Y.adler=c(Y.adler,ce.pending_buf,ce.pending-oe,oe)),se===0&&(ce.status=103)}else ce.status=103;if(ce.status===103&&(ce.gzhead.hcrc?(ce.pending+2>ce.pending_buf_size&&Q(Y),ce.pending+2<=ce.pending_buf_size&&(re(ce,255&Y.adler),re(ce,Y.adler>>8&255),Y.adler=0,ce.status=H)):ce.status=H),ce.pending!==0){if(Q(Y),Y.avail_out===0)return ce.last_flush=-1,m}else if(Y.avail_in===0&&te(ye)<=te(Ie)&&ye!==h)return L(Y,-5);if(ce.status===666&&Y.avail_in!==0)return L(Y,-5);if(Y.avail_in!==0||ce.lookahead!==0||ye!==d&&ce.status!==666){var Be=ce.strategy===2?function(Ae,lt){for(var Tt;;){if(Ae.lookahead===0&&(Oe(Ae),Ae.lookahead===0)){if(lt===d)return P;break}if(Ae.match_length=0,Tt=o._tr_tally(Ae,0,Ae.window[Ae.strstart]),Ae.lookahead--,Ae.strstart++,Tt&&(ee(Ae,!1),Ae.strm.avail_out===0))return P}return Ae.insert=0,lt===h?(ee(Ae,!0),Ae.strm.avail_out===0?U:V):Ae.last_lit&&(ee(Ae,!1),Ae.strm.avail_out===0)?P:K}(ce,ye):ce.strategy===3?function(Ae,lt){for(var Tt,dt,Pt,qt,Ft=Ae.window;;){if(Ae.lookahead<=O){if(Oe(Ae),Ae.lookahead<=O&&lt===d)return P;if(Ae.lookahead===0)break}if(Ae.match_length=0,Ae.lookahead>=I&&0<Ae.strstart&&(dt=Ft[Pt=Ae.strstart-1])===Ft[++Pt]&&dt===Ft[++Pt]&&dt===Ft[++Pt]){qt=Ae.strstart+O;do;while(dt===Ft[++Pt]&&dt===Ft[++Pt]&&dt===Ft[++Pt]&&dt===Ft[++Pt]&&dt===Ft[++Pt]&&dt===Ft[++Pt]&&dt===Ft[++Pt]&&dt===Ft[++Pt]&&Pt<qt);Ae.match_length=O-(qt-Pt),Ae.match_length>Ae.lookahead&&(Ae.match_length=Ae.lookahead)}if(Ae.match_length>=I?(Tt=o._tr_tally(Ae,1,Ae.match_length-I),Ae.lookahead-=Ae.match_length,Ae.strstart+=Ae.match_length,Ae.match_length=0):(Tt=o._tr_tally(Ae,0,Ae.window[Ae.strstart]),Ae.lookahead--,Ae.strstart++),Tt&&(ee(Ae,!1),Ae.strm.avail_out===0))return P}return Ae.insert=0,lt===h?(ee(Ae,!0),Ae.strm.avail_out===0?U:V):Ae.last_lit&&(ee(Ae,!1),Ae.strm.avail_out===0)?P:K}(ce,ye):i[ce.level].func(ce,ye);if(Be!==U&&Be!==V||(ce.status=666),Be===P||Be===U)return Y.avail_out===0&&(ce.last_flush=-1),m;if(Be===K&&(ye===1?o._tr_align(ce):ye!==5&&(o._tr_stored_block(ce,0,0,!1),ye===3&&(W(ce.head),ce.lookahead===0&&(ce.strstart=0,ce.block_start=0,ce.insert=0))),Q(Y),Y.avail_out===0))return ce.last_flush=-1,m}return ye!==h?m:ce.wrap<=0?1:(ce.wrap===2?(re(ce,255&Y.adler),re(ce,Y.adler>>8&255),re(ce,Y.adler>>16&255),re(ce,Y.adler>>24&255),re(ce,255&Y.total_in),re(ce,Y.total_in>>8&255),re(ce,Y.total_in>>16&255),re(ce,Y.total_in>>24&255)):(pe(ce,Y.adler>>>16),pe(ce,65535&Y.adler)),Q(Y),0<ce.wrap&&(ce.wrap=-ce.wrap),ce.pending!==0?m:1)},s.deflateEnd=function(Y){var ye;return Y&&Y.state?(ye=Y.state.status)!==D&&ye!==69&&ye!==73&&ye!==91&&ye!==103&&ye!==H&&ye!==666?L(Y,y):(Y.state=null,ye===H?L(Y,-3):m):y},s.deflateSetDictionary=function(Y,ye){var Ie,ce,oe,se,Me,Be,Ae,lt,Tt=ye.length;if(!Y||!Y.state||(se=(Ie=Y.state).wrap)===2||se===1&&Ie.status!==D||Ie.lookahead)return y;for(se===1&&(Y.adler=l(Y.adler,ye,Tt,0)),Ie.wrap=0,Tt>=Ie.w_size&&(se===0&&(W(Ie.head),Ie.strstart=0,Ie.block_start=0,Ie.insert=0),lt=new a.Buf8(Ie.w_size),a.arraySet(lt,ye,Tt-Ie.w_size,Ie.w_size,0),ye=lt,Tt=Ie.w_size),Me=Y.avail_in,Be=Y.next_in,Ae=Y.input,Y.avail_in=Tt,Y.next_in=0,Y.input=ye,Oe(Ie);Ie.lookahead>=I;){for(ce=Ie.strstart,oe=Ie.lookahead-(I-1);Ie.ins_h=(Ie.ins_h<<Ie.hash_shift^Ie.window[ce+I-1])&Ie.hash_mask,Ie.prev[ce&Ie.w_mask]=Ie.head[Ie.ins_h],Ie.head[Ie.ins_h]=ce,ce++,--oe;);Ie.strstart=ce,Ie.lookahead=I-1,Oe(Ie)}return Ie.strstart+=Ie.lookahead,Ie.block_start=Ie.strstart,Ie.insert=Ie.lookahead,Ie.lookahead=0,Ie.match_length=Ie.prev_length=I-1,Ie.match_available=0,Y.next_in=Be,Y.input=Ae,Y.avail_in=Me,Ie.wrap=se,m},s.deflateInfo="pako deflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./messages":51,"./trees":52}],47:[function(n,r,s){r.exports=function(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}},{}],48:[function(n,r,s){r.exports=function(i,a){var o,l,c,u,d,h,m,y,b,v,x,w,S,k,C,T,A,N,I,O,B,D,H,P,K;o=i.state,l=i.next_in,P=i.input,c=l+(i.avail_in-5),u=i.next_out,K=i.output,d=u-(a-i.avail_out),h=u+(i.avail_out-257),m=o.dmax,y=o.wsize,b=o.whave,v=o.wnext,x=o.window,w=o.hold,S=o.bits,k=o.lencode,C=o.distcode,T=(1<<o.lenbits)-1,A=(1<<o.distbits)-1;e:do{S<15&&(w+=P[l++]<<S,S+=8,w+=P[l++]<<S,S+=8),N=k[w&T];t:for(;;){if(w>>>=I=N>>>24,S-=I,(I=N>>>16&255)===0)K[u++]=65535&N;else{if(!(16&I)){if((64&I)==0){N=k[(65535&N)+(w&(1<<I)-1)];continue t}if(32&I){o.mode=12;break e}i.msg="invalid literal/length code",o.mode=30;break e}O=65535&N,(I&=15)&&(S<I&&(w+=P[l++]<<S,S+=8),O+=w&(1<<I)-1,w>>>=I,S-=I),S<15&&(w+=P[l++]<<S,S+=8,w+=P[l++]<<S,S+=8),N=C[w&A];n:for(;;){if(w>>>=I=N>>>24,S-=I,!(16&(I=N>>>16&255))){if((64&I)==0){N=C[(65535&N)+(w&(1<<I)-1)];continue n}i.msg="invalid distance code",o.mode=30;break e}if(B=65535&N,S<(I&=15)&&(w+=P[l++]<<S,(S+=8)<I&&(w+=P[l++]<<S,S+=8)),m<(B+=w&(1<<I)-1)){i.msg="invalid distance too far back",o.mode=30;break e}if(w>>>=I,S-=I,(I=u-d)<B){if(b<(I=B-I)&&o.sane){i.msg="invalid distance too far back",o.mode=30;break e}if(H=x,(D=0)===v){if(D+=y-I,I<O){for(O-=I;K[u++]=x[D++],--I;);D=u-B,H=K}}else if(v<I){if(D+=y+v-I,(I-=v)<O){for(O-=I;K[u++]=x[D++],--I;);if(D=0,v<O){for(O-=I=v;K[u++]=x[D++],--I;);D=u-B,H=K}}}else if(D+=v-I,I<O){for(O-=I;K[u++]=x[D++],--I;);D=u-B,H=K}for(;2<O;)K[u++]=H[D++],K[u++]=H[D++],K[u++]=H[D++],O-=3;O&&(K[u++]=H[D++],1<O&&(K[u++]=H[D++]))}else{for(D=u-B;K[u++]=K[D++],K[u++]=K[D++],K[u++]=K[D++],2<(O-=3););O&&(K[u++]=K[D++],1<O&&(K[u++]=K[D++]))}break}}break}}while(l<c&&u<h);l-=O=S>>3,w&=(1<<(S-=O<<3))-1,i.next_in=l,i.next_out=u,i.avail_in=l<c?c-l+5:5-(l-c),i.avail_out=u<h?h-u+257:257-(u-h),o.hold=w,o.bits=S}},{}],49:[function(n,r,s){var i=n("../utils/common"),a=n("./adler32"),o=n("./crc32"),l=n("./inffast"),c=n("./inftrees"),u=1,d=2,h=0,m=-2,y=1,b=852,v=592;function x(D){return(D>>>24&255)+(D>>>8&65280)+((65280&D)<<8)+((255&D)<<24)}function w(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new i.Buf16(320),this.work=new i.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function S(D){var H;return D&&D.state?(H=D.state,D.total_in=D.total_out=H.total=0,D.msg="",H.wrap&&(D.adler=1&H.wrap),H.mode=y,H.last=0,H.havedict=0,H.dmax=32768,H.head=null,H.hold=0,H.bits=0,H.lencode=H.lendyn=new i.Buf32(b),H.distcode=H.distdyn=new i.Buf32(v),H.sane=1,H.back=-1,h):m}function k(D){var H;return D&&D.state?((H=D.state).wsize=0,H.whave=0,H.wnext=0,S(D)):m}function C(D,H){var P,K;return D&&D.state?(K=D.state,H<0?(P=0,H=-H):(P=1+(H>>4),H<48&&(H&=15)),H&&(H<8||15<H)?m:(K.window!==null&&K.wbits!==H&&(K.window=null),K.wrap=P,K.wbits=H,k(D))):m}function T(D,H){var P,K;return D?(K=new w,(D.state=K).window=null,(P=C(D,H))!==h&&(D.state=null),P):m}var A,N,I=!0;function O(D){if(I){var H;for(A=new i.Buf32(512),N=new i.Buf32(32),H=0;H<144;)D.lens[H++]=8;for(;H<256;)D.lens[H++]=9;for(;H<280;)D.lens[H++]=7;for(;H<288;)D.lens[H++]=8;for(c(u,D.lens,0,288,A,0,D.work,{bits:9}),H=0;H<32;)D.lens[H++]=5;c(d,D.lens,0,32,N,0,D.work,{bits:5}),I=!1}D.lencode=A,D.lenbits=9,D.distcode=N,D.distbits=5}function B(D,H,P,K){var U,V=D.state;return V.window===null&&(V.wsize=1<<V.wbits,V.wnext=0,V.whave=0,V.window=new i.Buf8(V.wsize)),K>=V.wsize?(i.arraySet(V.window,H,P-V.wsize,V.wsize,0),V.wnext=0,V.whave=V.wsize):(K<(U=V.wsize-V.wnext)&&(U=K),i.arraySet(V.window,H,P-K,U,V.wnext),(K-=U)?(i.arraySet(V.window,H,P-K,K,0),V.wnext=K,V.whave=V.wsize):(V.wnext+=U,V.wnext===V.wsize&&(V.wnext=0),V.whave<V.wsize&&(V.whave+=U))),0}s.inflateReset=k,s.inflateReset2=C,s.inflateResetKeep=S,s.inflateInit=function(D){return T(D,15)},s.inflateInit2=T,s.inflate=function(D,H){var P,K,U,V,L,te,W,Q,ee,re,pe,de,Oe,Fe,Se,Ce,qe,Qe,We,je,Y,ye,Ie,ce,oe=0,se=new i.Buf8(4),Me=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!D||!D.state||!D.output||!D.input&&D.avail_in!==0)return m;(P=D.state).mode===12&&(P.mode=13),L=D.next_out,U=D.output,W=D.avail_out,V=D.next_in,K=D.input,te=D.avail_in,Q=P.hold,ee=P.bits,re=te,pe=W,ye=h;e:for(;;)switch(P.mode){case y:if(P.wrap===0){P.mode=13;break}for(;ee<16;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}if(2&P.wrap&&Q===35615){se[P.check=0]=255&Q,se[1]=Q>>>8&255,P.check=o(P.check,se,2,0),ee=Q=0,P.mode=2;break}if(P.flags=0,P.head&&(P.head.done=!1),!(1&P.wrap)||(((255&Q)<<8)+(Q>>8))%31){D.msg="incorrect header check",P.mode=30;break}if((15&Q)!=8){D.msg="unknown compression method",P.mode=30;break}if(ee-=4,Y=8+(15&(Q>>>=4)),P.wbits===0)P.wbits=Y;else if(Y>P.wbits){D.msg="invalid window size",P.mode=30;break}P.dmax=1<<Y,D.adler=P.check=1,P.mode=512&Q?10:12,ee=Q=0;break;case 2:for(;ee<16;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}if(P.flags=Q,(255&P.flags)!=8){D.msg="unknown compression method",P.mode=30;break}if(57344&P.flags){D.msg="unknown header flags set",P.mode=30;break}P.head&&(P.head.text=Q>>8&1),512&P.flags&&(se[0]=255&Q,se[1]=Q>>>8&255,P.check=o(P.check,se,2,0)),ee=Q=0,P.mode=3;case 3:for(;ee<32;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}P.head&&(P.head.time=Q),512&P.flags&&(se[0]=255&Q,se[1]=Q>>>8&255,se[2]=Q>>>16&255,se[3]=Q>>>24&255,P.check=o(P.check,se,4,0)),ee=Q=0,P.mode=4;case 4:for(;ee<16;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}P.head&&(P.head.xflags=255&Q,P.head.os=Q>>8),512&P.flags&&(se[0]=255&Q,se[1]=Q>>>8&255,P.check=o(P.check,se,2,0)),ee=Q=0,P.mode=5;case 5:if(1024&P.flags){for(;ee<16;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}P.length=Q,P.head&&(P.head.extra_len=Q),512&P.flags&&(se[0]=255&Q,se[1]=Q>>>8&255,P.check=o(P.check,se,2,0)),ee=Q=0}else P.head&&(P.head.extra=null);P.mode=6;case 6:if(1024&P.flags&&(te<(de=P.length)&&(de=te),de&&(P.head&&(Y=P.head.extra_len-P.length,P.head.extra||(P.head.extra=new Array(P.head.extra_len)),i.arraySet(P.head.extra,K,V,de,Y)),512&P.flags&&(P.check=o(P.check,K,de,V)),te-=de,V+=de,P.length-=de),P.length))break e;P.length=0,P.mode=7;case 7:if(2048&P.flags){if(te===0)break e;for(de=0;Y=K[V+de++],P.head&&Y&&P.length<65536&&(P.head.name+=String.fromCharCode(Y)),Y&&de<te;);if(512&P.flags&&(P.check=o(P.check,K,de,V)),te-=de,V+=de,Y)break e}else P.head&&(P.head.name=null);P.length=0,P.mode=8;case 8:if(4096&P.flags){if(te===0)break e;for(de=0;Y=K[V+de++],P.head&&Y&&P.length<65536&&(P.head.comment+=String.fromCharCode(Y)),Y&&de<te;);if(512&P.flags&&(P.check=o(P.check,K,de,V)),te-=de,V+=de,Y)break e}else P.head&&(P.head.comment=null);P.mode=9;case 9:if(512&P.flags){for(;ee<16;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}if(Q!==(65535&P.check)){D.msg="header crc mismatch",P.mode=30;break}ee=Q=0}P.head&&(P.head.hcrc=P.flags>>9&1,P.head.done=!0),D.adler=P.check=0,P.mode=12;break;case 10:for(;ee<32;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}D.adler=P.check=x(Q),ee=Q=0,P.mode=11;case 11:if(P.havedict===0)return D.next_out=L,D.avail_out=W,D.next_in=V,D.avail_in=te,P.hold=Q,P.bits=ee,2;D.adler=P.check=1,P.mode=12;case 12:if(H===5||H===6)break e;case 13:if(P.last){Q>>>=7&ee,ee-=7&ee,P.mode=27;break}for(;ee<3;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}switch(P.last=1&Q,ee-=1,3&(Q>>>=1)){case 0:P.mode=14;break;case 1:if(O(P),P.mode=20,H!==6)break;Q>>>=2,ee-=2;break e;case 2:P.mode=17;break;case 3:D.msg="invalid block type",P.mode=30}Q>>>=2,ee-=2;break;case 14:for(Q>>>=7&ee,ee-=7&ee;ee<32;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}if((65535&Q)!=(Q>>>16^65535)){D.msg="invalid stored block lengths",P.mode=30;break}if(P.length=65535&Q,ee=Q=0,P.mode=15,H===6)break e;case 15:P.mode=16;case 16:if(de=P.length){if(te<de&&(de=te),W<de&&(de=W),de===0)break e;i.arraySet(U,K,V,de,L),te-=de,V+=de,W-=de,L+=de,P.length-=de;break}P.mode=12;break;case 17:for(;ee<14;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}if(P.nlen=257+(31&Q),Q>>>=5,ee-=5,P.ndist=1+(31&Q),Q>>>=5,ee-=5,P.ncode=4+(15&Q),Q>>>=4,ee-=4,286<P.nlen||30<P.ndist){D.msg="too many length or distance symbols",P.mode=30;break}P.have=0,P.mode=18;case 18:for(;P.have<P.ncode;){for(;ee<3;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}P.lens[Me[P.have++]]=7&Q,Q>>>=3,ee-=3}for(;P.have<19;)P.lens[Me[P.have++]]=0;if(P.lencode=P.lendyn,P.lenbits=7,Ie={bits:P.lenbits},ye=c(0,P.lens,0,19,P.lencode,0,P.work,Ie),P.lenbits=Ie.bits,ye){D.msg="invalid code lengths set",P.mode=30;break}P.have=0,P.mode=19;case 19:for(;P.have<P.nlen+P.ndist;){for(;Ce=(oe=P.lencode[Q&(1<<P.lenbits)-1])>>>16&255,qe=65535&oe,!((Se=oe>>>24)<=ee);){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}if(qe<16)Q>>>=Se,ee-=Se,P.lens[P.have++]=qe;else{if(qe===16){for(ce=Se+2;ee<ce;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}if(Q>>>=Se,ee-=Se,P.have===0){D.msg="invalid bit length repeat",P.mode=30;break}Y=P.lens[P.have-1],de=3+(3&Q),Q>>>=2,ee-=2}else if(qe===17){for(ce=Se+3;ee<ce;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}ee-=Se,Y=0,de=3+(7&(Q>>>=Se)),Q>>>=3,ee-=3}else{for(ce=Se+7;ee<ce;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}ee-=Se,Y=0,de=11+(127&(Q>>>=Se)),Q>>>=7,ee-=7}if(P.have+de>P.nlen+P.ndist){D.msg="invalid bit length repeat",P.mode=30;break}for(;de--;)P.lens[P.have++]=Y}}if(P.mode===30)break;if(P.lens[256]===0){D.msg="invalid code -- missing end-of-block",P.mode=30;break}if(P.lenbits=9,Ie={bits:P.lenbits},ye=c(u,P.lens,0,P.nlen,P.lencode,0,P.work,Ie),P.lenbits=Ie.bits,ye){D.msg="invalid literal/lengths set",P.mode=30;break}if(P.distbits=6,P.distcode=P.distdyn,Ie={bits:P.distbits},ye=c(d,P.lens,P.nlen,P.ndist,P.distcode,0,P.work,Ie),P.distbits=Ie.bits,ye){D.msg="invalid distances set",P.mode=30;break}if(P.mode=20,H===6)break e;case 20:P.mode=21;case 21:if(6<=te&&258<=W){D.next_out=L,D.avail_out=W,D.next_in=V,D.avail_in=te,P.hold=Q,P.bits=ee,l(D,pe),L=D.next_out,U=D.output,W=D.avail_out,V=D.next_in,K=D.input,te=D.avail_in,Q=P.hold,ee=P.bits,P.mode===12&&(P.back=-1);break}for(P.back=0;Ce=(oe=P.lencode[Q&(1<<P.lenbits)-1])>>>16&255,qe=65535&oe,!((Se=oe>>>24)<=ee);){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}if(Ce&&(240&Ce)==0){for(Qe=Se,We=Ce,je=qe;Ce=(oe=P.lencode[je+((Q&(1<<Qe+We)-1)>>Qe)])>>>16&255,qe=65535&oe,!(Qe+(Se=oe>>>24)<=ee);){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}Q>>>=Qe,ee-=Qe,P.back+=Qe}if(Q>>>=Se,ee-=Se,P.back+=Se,P.length=qe,Ce===0){P.mode=26;break}if(32&Ce){P.back=-1,P.mode=12;break}if(64&Ce){D.msg="invalid literal/length code",P.mode=30;break}P.extra=15&Ce,P.mode=22;case 22:if(P.extra){for(ce=P.extra;ee<ce;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}P.length+=Q&(1<<P.extra)-1,Q>>>=P.extra,ee-=P.extra,P.back+=P.extra}P.was=P.length,P.mode=23;case 23:for(;Ce=(oe=P.distcode[Q&(1<<P.distbits)-1])>>>16&255,qe=65535&oe,!((Se=oe>>>24)<=ee);){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}if((240&Ce)==0){for(Qe=Se,We=Ce,je=qe;Ce=(oe=P.distcode[je+((Q&(1<<Qe+We)-1)>>Qe)])>>>16&255,qe=65535&oe,!(Qe+(Se=oe>>>24)<=ee);){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}Q>>>=Qe,ee-=Qe,P.back+=Qe}if(Q>>>=Se,ee-=Se,P.back+=Se,64&Ce){D.msg="invalid distance code",P.mode=30;break}P.offset=qe,P.extra=15&Ce,P.mode=24;case 24:if(P.extra){for(ce=P.extra;ee<ce;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}P.offset+=Q&(1<<P.extra)-1,Q>>>=P.extra,ee-=P.extra,P.back+=P.extra}if(P.offset>P.dmax){D.msg="invalid distance too far back",P.mode=30;break}P.mode=25;case 25:if(W===0)break e;if(de=pe-W,P.offset>de){if((de=P.offset-de)>P.whave&&P.sane){D.msg="invalid distance too far back",P.mode=30;break}Oe=de>P.wnext?(de-=P.wnext,P.wsize-de):P.wnext-de,de>P.length&&(de=P.length),Fe=P.window}else Fe=U,Oe=L-P.offset,de=P.length;for(W<de&&(de=W),W-=de,P.length-=de;U[L++]=Fe[Oe++],--de;);P.length===0&&(P.mode=21);break;case 26:if(W===0)break e;U[L++]=P.length,W--,P.mode=21;break;case 27:if(P.wrap){for(;ee<32;){if(te===0)break e;te--,Q|=K[V++]<<ee,ee+=8}if(pe-=W,D.total_out+=pe,P.total+=pe,pe&&(D.adler=P.check=P.flags?o(P.check,U,pe,L-pe):a(P.check,U,pe,L-pe)),pe=W,(P.flags?Q:x(Q))!==P.check){D.msg="incorrect data check",P.mode=30;break}ee=Q=0}P.mode=28;case 28:if(P.wrap&&P.flags){for(;ee<32;){if(te===0)break e;te--,Q+=K[V++]<<ee,ee+=8}if(Q!==(4294967295&P.total)){D.msg="incorrect length check",P.mode=30;break}ee=Q=0}P.mode=29;case 29:ye=1;break e;case 30:ye=-3;break e;case 31:return-4;case 32:default:return m}return D.next_out=L,D.avail_out=W,D.next_in=V,D.avail_in=te,P.hold=Q,P.bits=ee,(P.wsize||pe!==D.avail_out&&P.mode<30&&(P.mode<27||H!==4))&&B(D,D.output,D.next_out,pe-D.avail_out)?(P.mode=31,-4):(re-=D.avail_in,pe-=D.avail_out,D.total_in+=re,D.total_out+=pe,P.total+=pe,P.wrap&&pe&&(D.adler=P.check=P.flags?o(P.check,U,pe,D.next_out-pe):a(P.check,U,pe,D.next_out-pe)),D.data_type=P.bits+(P.last?64:0)+(P.mode===12?128:0)+(P.mode===20||P.mode===15?256:0),(re==0&&pe===0||H===4)&&ye===h&&(ye=-5),ye)},s.inflateEnd=function(D){if(!D||!D.state)return m;var H=D.state;return H.window&&(H.window=null),D.state=null,h},s.inflateGetHeader=function(D,H){var P;return D&&D.state?(2&(P=D.state).wrap)==0?m:((P.head=H).done=!1,h):m},s.inflateSetDictionary=function(D,H){var P,K=H.length;return D&&D.state?(P=D.state).wrap!==0&&P.mode!==11?m:P.mode===11&&a(1,H,K,0)!==P.check?-3:B(D,H,K,K)?(P.mode=31,-4):(P.havedict=1,h):m},s.inflateInfo="pako inflate (from Nodeca project)"},{"../utils/common":41,"./adler32":43,"./crc32":45,"./inffast":48,"./inftrees":50}],50:[function(n,r,s){var i=n("../utils/common"),a=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],o=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],l=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],c=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];r.exports=function(u,d,h,m,y,b,v,x){var w,S,k,C,T,A,N,I,O,B=x.bits,D=0,H=0,P=0,K=0,U=0,V=0,L=0,te=0,W=0,Q=0,ee=null,re=0,pe=new i.Buf16(16),de=new i.Buf16(16),Oe=null,Fe=0;for(D=0;D<=15;D++)pe[D]=0;for(H=0;H<m;H++)pe[d[h+H]]++;for(U=B,K=15;1<=K&&pe[K]===0;K--);if(K<U&&(U=K),K===0)return y[b++]=20971520,y[b++]=20971520,x.bits=1,0;for(P=1;P<K&&pe[P]===0;P++);for(U<P&&(U=P),D=te=1;D<=15;D++)if(te<<=1,(te-=pe[D])<0)return-1;if(0<te&&(u===0||K!==1))return-1;for(de[1]=0,D=1;D<15;D++)de[D+1]=de[D]+pe[D];for(H=0;H<m;H++)d[h+H]!==0&&(v[de[d[h+H]]++]=H);if(A=u===0?(ee=Oe=v,19):u===1?(ee=a,re-=257,Oe=o,Fe-=257,256):(ee=l,Oe=c,-1),D=P,T=b,L=H=Q=0,k=-1,C=(W=1<<(V=U))-1,u===1&&852<W||u===2&&592<W)return 1;for(;;){for(N=D-L,O=v[H]<A?(I=0,v[H]):v[H]>A?(I=Oe[Fe+v[H]],ee[re+v[H]]):(I=96,0),w=1<<D-L,P=S=1<<V;y[T+(Q>>L)+(S-=w)]=N<<24|I<<16|O|0,S!==0;);for(w=1<<D-1;Q&w;)w>>=1;if(w!==0?(Q&=w-1,Q+=w):Q=0,H++,--pe[D]==0){if(D===K)break;D=d[h+v[H]]}if(U<D&&(Q&C)!==k){for(L===0&&(L=U),T+=P,te=1<<(V=D-L);V+L<K&&!((te-=pe[V+L])<=0);)V++,te<<=1;if(W+=1<<V,u===1&&852<W||u===2&&592<W)return 1;y[k=Q&C]=U<<24|V<<16|T-b|0}}return Q!==0&&(y[T+Q]=D-L<<24|64<<16|0),x.bits=U,0}},{"../utils/common":41}],51:[function(n,r,s){r.exports={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}},{}],52:[function(n,r,s){var i=n("../utils/common"),a=0,o=1;function l(oe){for(var se=oe.length;0<=--se;)oe[se]=0}var c=0,u=29,d=256,h=d+1+u,m=30,y=19,b=2*h+1,v=15,x=16,w=7,S=256,k=16,C=17,T=18,A=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],N=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],I=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],O=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],B=new Array(2*(h+2));l(B);var D=new Array(2*m);l(D);var H=new Array(512);l(H);var P=new Array(256);l(P);var K=new Array(u);l(K);var U,V,L,te=new Array(m);function W(oe,se,Me,Be,Ae){this.static_tree=oe,this.extra_bits=se,this.extra_base=Me,this.elems=Be,this.max_length=Ae,this.has_stree=oe&&oe.length}function Q(oe,se){this.dyn_tree=oe,this.max_code=0,this.stat_desc=se}function ee(oe){return oe<256?H[oe]:H[256+(oe>>>7)]}function re(oe,se){oe.pending_buf[oe.pending++]=255&se,oe.pending_buf[oe.pending++]=se>>>8&255}function pe(oe,se,Me){oe.bi_valid>x-Me?(oe.bi_buf|=se<<oe.bi_valid&65535,re(oe,oe.bi_buf),oe.bi_buf=se>>x-oe.bi_valid,oe.bi_valid+=Me-x):(oe.bi_buf|=se<<oe.bi_valid&65535,oe.bi_valid+=Me)}function de(oe,se,Me){pe(oe,Me[2*se],Me[2*se+1])}function Oe(oe,se){for(var Me=0;Me|=1&oe,oe>>>=1,Me<<=1,0<--se;);return Me>>>1}function Fe(oe,se,Me){var Be,Ae,lt=new Array(v+1),Tt=0;for(Be=1;Be<=v;Be++)lt[Be]=Tt=Tt+Me[Be-1]<<1;for(Ae=0;Ae<=se;Ae++){var dt=oe[2*Ae+1];dt!==0&&(oe[2*Ae]=Oe(lt[dt]++,dt))}}function Se(oe){var se;for(se=0;se<h;se++)oe.dyn_ltree[2*se]=0;for(se=0;se<m;se++)oe.dyn_dtree[2*se]=0;for(se=0;se<y;se++)oe.bl_tree[2*se]=0;oe.dyn_ltree[2*S]=1,oe.opt_len=oe.static_len=0,oe.last_lit=oe.matches=0}function Ce(oe){8<oe.bi_valid?re(oe,oe.bi_buf):0<oe.bi_valid&&(oe.pending_buf[oe.pending++]=oe.bi_buf),oe.bi_buf=0,oe.bi_valid=0}function qe(oe,se,Me,Be){var Ae=2*se,lt=2*Me;return oe[Ae]<oe[lt]||oe[Ae]===oe[lt]&&Be[se]<=Be[Me]}function Qe(oe,se,Me){for(var Be=oe.heap[Me],Ae=Me<<1;Ae<=oe.heap_len&&(Ae<oe.heap_len&&qe(se,oe.heap[Ae+1],oe.heap[Ae],oe.depth)&&Ae++,!qe(se,Be,oe.heap[Ae],oe.depth));)oe.heap[Me]=oe.heap[Ae],Me=Ae,Ae<<=1;oe.heap[Me]=Be}function We(oe,se,Me){var Be,Ae,lt,Tt,dt=0;if(oe.last_lit!==0)for(;Be=oe.pending_buf[oe.d_buf+2*dt]<<8|oe.pending_buf[oe.d_buf+2*dt+1],Ae=oe.pending_buf[oe.l_buf+dt],dt++,Be===0?de(oe,Ae,se):(de(oe,(lt=P[Ae])+d+1,se),(Tt=A[lt])!==0&&pe(oe,Ae-=K[lt],Tt),de(oe,lt=ee(--Be),Me),(Tt=N[lt])!==0&&pe(oe,Be-=te[lt],Tt)),dt<oe.last_lit;);de(oe,S,se)}function je(oe,se){var Me,Be,Ae,lt=se.dyn_tree,Tt=se.stat_desc.static_tree,dt=se.stat_desc.has_stree,Pt=se.stat_desc.elems,qt=-1;for(oe.heap_len=0,oe.heap_max=b,Me=0;Me<Pt;Me++)lt[2*Me]!==0?(oe.heap[++oe.heap_len]=qt=Me,oe.depth[Me]=0):lt[2*Me+1]=0;for(;oe.heap_len<2;)lt[2*(Ae=oe.heap[++oe.heap_len]=qt<2?++qt:0)]=1,oe.depth[Ae]=0,oe.opt_len--,dt&&(oe.static_len-=Tt[2*Ae+1]);for(se.max_code=qt,Me=oe.heap_len>>1;1<=Me;Me--)Qe(oe,lt,Me);for(Ae=Pt;Me=oe.heap[1],oe.heap[1]=oe.heap[oe.heap_len--],Qe(oe,lt,1),Be=oe.heap[1],oe.heap[--oe.heap_max]=Me,oe.heap[--oe.heap_max]=Be,lt[2*Ae]=lt[2*Me]+lt[2*Be],oe.depth[Ae]=(oe.depth[Me]>=oe.depth[Be]?oe.depth[Me]:oe.depth[Be])+1,lt[2*Me+1]=lt[2*Be+1]=Ae,oe.heap[1]=Ae++,Qe(oe,lt,1),2<=oe.heap_len;);oe.heap[--oe.heap_max]=oe.heap[1],function(Ft,Ht){var we,F,X,be,ke,ge,Ee=Ht.dyn_tree,le=Ht.max_code,ft=Ht.stat_desc.static_tree,et=Ht.stat_desc.has_stree,$=Ht.stat_desc.extra_bits,Ue=Ht.stat_desc.extra_base,tt=Ht.stat_desc.max_length,ve=0;for(be=0;be<=v;be++)Ft.bl_count[be]=0;for(Ee[2*Ft.heap[Ft.heap_max]+1]=0,we=Ft.heap_max+1;we<b;we++)tt<(be=Ee[2*Ee[2*(F=Ft.heap[we])+1]+1]+1)&&(be=tt,ve++),Ee[2*F+1]=be,le<F||(Ft.bl_count[be]++,ke=0,Ue<=F&&(ke=$[F-Ue]),ge=Ee[2*F],Ft.opt_len+=ge*(be+ke),et&&(Ft.static_len+=ge*(ft[2*F+1]+ke)));if(ve!==0){do{for(be=tt-1;Ft.bl_count[be]===0;)be--;Ft.bl_count[be]--,Ft.bl_count[be+1]+=2,Ft.bl_count[tt]--,ve-=2}while(0<ve);for(be=tt;be!==0;be--)for(F=Ft.bl_count[be];F!==0;)le<(X=Ft.heap[--we])||(Ee[2*X+1]!==be&&(Ft.opt_len+=(be-Ee[2*X+1])*Ee[2*X],Ee[2*X+1]=be),F--)}}(oe,se),Fe(lt,qt,oe.bl_count)}function Y(oe,se,Me){var Be,Ae,lt=-1,Tt=se[1],dt=0,Pt=7,qt=4;for(Tt===0&&(Pt=138,qt=3),se[2*(Me+1)+1]=65535,Be=0;Be<=Me;Be++)Ae=Tt,Tt=se[2*(Be+1)+1],++dt<Pt&&Ae===Tt||(dt<qt?oe.bl_tree[2*Ae]+=dt:Ae!==0?(Ae!==lt&&oe.bl_tree[2*Ae]++,oe.bl_tree[2*k]++):dt<=10?oe.bl_tree[2*C]++:oe.bl_tree[2*T]++,lt=Ae,qt=(dt=0)===Tt?(Pt=138,3):Ae===Tt?(Pt=6,3):(Pt=7,4))}function ye(oe,se,Me){var Be,Ae,lt=-1,Tt=se[1],dt=0,Pt=7,qt=4;for(Tt===0&&(Pt=138,qt=3),Be=0;Be<=Me;Be++)if(Ae=Tt,Tt=se[2*(Be+1)+1],!(++dt<Pt&&Ae===Tt)){if(dt<qt)for(;de(oe,Ae,oe.bl_tree),--dt!=0;);else Ae!==0?(Ae!==lt&&(de(oe,Ae,oe.bl_tree),dt--),de(oe,k,oe.bl_tree),pe(oe,dt-3,2)):dt<=10?(de(oe,C,oe.bl_tree),pe(oe,dt-3,3)):(de(oe,T,oe.bl_tree),pe(oe,dt-11,7));lt=Ae,qt=(dt=0)===Tt?(Pt=138,3):Ae===Tt?(Pt=6,3):(Pt=7,4)}}l(te);var Ie=!1;function ce(oe,se,Me,Be){pe(oe,(c<<1)+(Be?1:0),3),function(Ae,lt,Tt,dt){Ce(Ae),re(Ae,Tt),re(Ae,~Tt),i.arraySet(Ae.pending_buf,Ae.window,lt,Tt,Ae.pending),Ae.pending+=Tt}(oe,se,Me)}s._tr_init=function(oe){Ie||(function(){var se,Me,Be,Ae,lt,Tt=new Array(v+1);for(Ae=Be=0;Ae<u-1;Ae++)for(K[Ae]=Be,se=0;se<1<<A[Ae];se++)P[Be++]=Ae;for(P[Be-1]=Ae,Ae=lt=0;Ae<16;Ae++)for(te[Ae]=lt,se=0;se<1<<N[Ae];se++)H[lt++]=Ae;for(lt>>=7;Ae<m;Ae++)for(te[Ae]=lt<<7,se=0;se<1<<N[Ae]-7;se++)H[256+lt++]=Ae;for(Me=0;Me<=v;Me++)Tt[Me]=0;for(se=0;se<=143;)B[2*se+1]=8,se++,Tt[8]++;for(;se<=255;)B[2*se+1]=9,se++,Tt[9]++;for(;se<=279;)B[2*se+1]=7,se++,Tt[7]++;for(;se<=287;)B[2*se+1]=8,se++,Tt[8]++;for(Fe(B,h+1,Tt),se=0;se<m;se++)D[2*se+1]=5,D[2*se]=Oe(se,5);U=new W(B,A,d+1,h,v),V=new W(D,N,0,m,v),L=new W(new Array(0),I,0,y,w)}(),Ie=!0),oe.l_desc=new Q(oe.dyn_ltree,U),oe.d_desc=new Q(oe.dyn_dtree,V),oe.bl_desc=new Q(oe.bl_tree,L),oe.bi_buf=0,oe.bi_valid=0,Se(oe)},s._tr_stored_block=ce,s._tr_flush_block=function(oe,se,Me,Be){var Ae,lt,Tt=0;0<oe.level?(oe.strm.data_type===2&&(oe.strm.data_type=function(dt){var Pt,qt=4093624447;for(Pt=0;Pt<=31;Pt++,qt>>>=1)if(1&qt&&dt.dyn_ltree[2*Pt]!==0)return a;if(dt.dyn_ltree[18]!==0||dt.dyn_ltree[20]!==0||dt.dyn_ltree[26]!==0)return o;for(Pt=32;Pt<d;Pt++)if(dt.dyn_ltree[2*Pt]!==0)return o;return a}(oe)),je(oe,oe.l_desc),je(oe,oe.d_desc),Tt=function(dt){var Pt;for(Y(dt,dt.dyn_ltree,dt.l_desc.max_code),Y(dt,dt.dyn_dtree,dt.d_desc.max_code),je(dt,dt.bl_desc),Pt=y-1;3<=Pt&&dt.bl_tree[2*O[Pt]+1]===0;Pt--);return dt.opt_len+=3*(Pt+1)+5+5+4,Pt}(oe),Ae=oe.opt_len+3+7>>>3,(lt=oe.static_len+3+7>>>3)<=Ae&&(Ae=lt)):Ae=lt=Me+5,Me+4<=Ae&&se!==-1?ce(oe,se,Me,Be):oe.strategy===4||lt===Ae?(pe(oe,2+(Be?1:0),3),We(oe,B,D)):(pe(oe,4+(Be?1:0),3),function(dt,Pt,qt,Ft){var Ht;for(pe(dt,Pt-257,5),pe(dt,qt-1,5),pe(dt,Ft-4,4),Ht=0;Ht<Ft;Ht++)pe(dt,dt.bl_tree[2*O[Ht]+1],3);ye(dt,dt.dyn_ltree,Pt-1),ye(dt,dt.dyn_dtree,qt-1)}(oe,oe.l_desc.max_code+1,oe.d_desc.max_code+1,Tt+1),We(oe,oe.dyn_ltree,oe.dyn_dtree)),Se(oe),Be&&Ce(oe)},s._tr_tally=function(oe,se,Me){return oe.pending_buf[oe.d_buf+2*oe.last_lit]=se>>>8&255,oe.pending_buf[oe.d_buf+2*oe.last_lit+1]=255&se,oe.pending_buf[oe.l_buf+oe.last_lit]=255&Me,oe.last_lit++,se===0?oe.dyn_ltree[2*Me]++:(oe.matches++,se--,oe.dyn_ltree[2*(P[Me]+d+1)]++,oe.dyn_dtree[2*ee(se)]++),oe.last_lit===oe.lit_bufsize-1},s._tr_align=function(oe){pe(oe,2,3),de(oe,S,B),function(se){se.bi_valid===16?(re(se,se.bi_buf),se.bi_buf=0,se.bi_valid=0):8<=se.bi_valid&&(se.pending_buf[se.pending++]=255&se.bi_buf,se.bi_buf>>=8,se.bi_valid-=8)}(oe)}},{"../utils/common":41}],53:[function(n,r,s){r.exports=function(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}},{}],54:[function(n,r,s){(function(i){(function(a,o){if(!a.setImmediate){var l,c,u,d,h=1,m={},y=!1,b=a.document,v=Object.getPrototypeOf&&Object.getPrototypeOf(a);v=v&&v.setTimeout?v:a,l={}.toString.call(a.process)==="[object process]"?function(k){Mi.nextTick(function(){w(k)})}:function(){if(a.postMessage&&!a.importScripts){var k=!0,C=a.onmessage;return a.onmessage=function(){k=!1},a.postMessage("","*"),a.onmessage=C,k}}()?(d="setImmediate$"+Math.random()+"$",a.addEventListener?a.addEventListener("message",S,!1):a.attachEvent("onmessage",S),function(k){a.postMessage(d+k,"*")}):a.MessageChannel?((u=new MessageChannel).port1.onmessage=function(k){w(k.data)},function(k){u.port2.postMessage(k)}):b&&"onreadystatechange"in b.createElement("script")?(c=b.documentElement,function(k){var C=b.createElement("script");C.onreadystatechange=function(){w(k),C.onreadystatechange=null,c.removeChild(C),C=null},c.appendChild(C)}):function(k){setTimeout(w,0,k)},v.setImmediate=function(k){typeof k!="function"&&(k=new Function(""+k));for(var C=new Array(arguments.length-1),T=0;T<C.length;T++)C[T]=arguments[T+1];var A={callback:k,args:C};return m[h]=A,l(h),h++},v.clearImmediate=x}function x(k){delete m[k]}function w(k){if(y)setTimeout(w,0,k);else{var C=m[k];if(C){y=!0;try{(function(T){var A=T.callback,N=T.args;switch(N.length){case 0:A();break;case 1:A(N[0]);break;case 2:A(N[0],N[1]);break;case 3:A(N[0],N[1],N[2]);break;default:A.apply(o,N)}})(C)}finally{x(k),y=!1}}}}function S(k){k.source===a&&typeof k.data=="string"&&k.data.indexOf(d)===0&&w(+k.data.slice(d.length))}})(typeof self>"u"?i===void 0?this:i:self)}).call(this,typeof im<"u"?im:typeof self<"u"?self:typeof window<"u"?window:{})},{}]},{},[10])(10)})}(FM)),FM.exports}var NCe=RCe();const fD=da(NCe),yw=(e,t=2)=>{if(e===0)return"0 Bytes";const n=1024,r=t<0?0:t,s=["Bytes","KB","MB","GB","TB","PB","EB","ZB","YB"],i=Math.floor(Math.log(e)/Math.log(n));return parseFloat((e/Math.pow(n,i)).toFixed(r))+" "+s[i]},Ur=e=>{let t=e.replace(/\/+/g,"/");return t.startsWith("/")||(t="/"+t),t!=="/"&&t.endsWith("/")&&(t=t.slice(0,-1)),t},Lu=(...e)=>Ur(e.map(t=>t.trim()).filter(Boolean).join("/")),oT=e=>{const t=Ur(e);if(t==="/")return"/";const n=t.lastIndexOf("/");return n===-1||n===0?"/":t.substring(0,n)},vi=e=>{const t=Ur(e);return t==="/"?"":t.substring(t.lastIndexOf("/")+1)},Fj=(e,t)=>Ur(e==="/"?`/${t}`:`${e}/${t}`);var LM,F9;function MCe(){if(F9)return LM;F9=1;var e=function(t){if(t=t||{},this.Promise=t.Promise||Promise,this.queues=Object.create(null),this.domainReentrant=t.domainReentrant||!1,this.domainReentrant){if(typeof Mi>"u"||typeof Mi.domain>"u")throw new Error("Domain-reentrant locks require `process.domain` to exist. Please flip `opts.domainReentrant = false`, use a NodeJS version that still implements Domain, or install a browser polyfill.");this.domains=Object.create(null)}this.timeout=t.timeout||e.DEFAULT_TIMEOUT,this.maxOccupationTime=t.maxOccupationTime||e.DEFAULT_MAX_OCCUPATION_TIME,this.maxExecutionTime=t.maxExecutionTime||e.DEFAULT_MAX_EXECUTION_TIME,t.maxPending===1/0||Number.isInteger(t.maxPending)&&t.maxPending>=0?this.maxPending=t.maxPending:this.maxPending=e.DEFAULT_MAX_PENDING};return e.DEFAULT_TIMEOUT=0,e.DEFAULT_MAX_OCCUPATION_TIME=0,e.DEFAULT_MAX_EXECUTION_TIME=0,e.DEFAULT_MAX_PENDING=1e3,e.prototype.acquire=function(t,n,r,s){if(Array.isArray(t))return this._acquireBatch(t,n,r,s);if(typeof n!="function")throw new Error("You must pass a function to execute");var i=null,a=null,o=null;typeof r!="function"&&(s=r,r=null,o=new this.Promise(function(S,k){i=S,a=k})),s=s||{};var l=!1,c=null,u=null,d=null,h=this,m=function(S,k,C){u&&(clearTimeout(u),u=null),d&&(clearTimeout(d),d=null),S&&(h.queues[t]&&h.queues[t].length===0&&delete h.queues[t],h.domainReentrant&&delete h.domains[t]),l||(o?k?a(k):i(C):typeof r=="function"&&r(k,C),l=!0),S&&h.queues[t]&&h.queues[t].length>0&&h.queues[t].shift()()},y=function(S){if(l)return m(S);c&&(clearTimeout(c),c=null),h.domainReentrant&&S&&(h.domains[t]=Mi.domain);var k=s.maxExecutionTime||h.maxExecutionTime;if(k&&(d=setTimeout(function(){h.queues[t]&&m(S,new Error("Maximum execution time is exceeded "+t))},k)),n.length===1){var C=!1;try{n(function(T,A){C||(C=!0,m(S,T,A))})}catch(T){C||(C=!0,m(S,T))}}else h._promiseTry(function(){return n()}).then(function(T){m(S,void 0,T)},function(T){m(S,T)})};h.domainReentrant&&Mi.domain&&(y=Mi.domain.bind(y));var b=s.maxPending||h.maxPending;if(!h.queues[t])h.queues[t]=[],y(!0);else if(h.domainReentrant&&Mi.domain&&Mi.domain===h.domains[t])y(!1);else if(h.queues[t].length>=b)m(!1,new Error("Too many pending tasks in queue "+t));else{var v=function(){y(!0)};s.skipQueue?h.queues[t].unshift(v):h.queues[t].push(v);var x=s.timeout||h.timeout;x&&(c=setTimeout(function(){c=null,m(!1,new Error("async-lock timed out in queue "+t))},x))}var w=s.maxOccupationTime||h.maxOccupationTime;if(w&&(u=setTimeout(function(){h.queues[t]&&m(!1,new Error("Maximum occupation time is exceeded in queue "+t))},w)),o)return o},e.prototype._acquireBatch=function(t,n,r,s){typeof r!="function"&&(s=r,r=null);var i=this,a=function(l,c){return function(u){i.acquire(l,c,u,s)}},o=t.reduceRight(function(l,c){return a(c,l)},n);if(typeof r=="function")o(r);else return new this.Promise(function(l,c){o.length===1?o(function(u,d){u?c(u):l(d)}):l(o())})},e.prototype.isBusy=function(t){return t?!!this.queues[t]:Object.keys(this.queues).length>0},e.prototype._promiseTry=function(t){try{return this.Promise.resolve(t())}catch(n){return this.Promise.reject(n)}},LM=e,LM}var BM,L9;function ICe(){return L9||(L9=1,BM=MCe()),BM}var jCe=ICe();const bw=da(jCe);var HS={exports:{}},B9;function PCe(){return B9||(B9=1,typeof Object.create=="function"?HS.exports=function(t,n){n&&(t.super_=n,t.prototype=Object.create(n.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}))}:HS.exports=function(t,n){if(n){t.super_=n;var r=function(){};r.prototype=n.prototype,t.prototype=new r,t.prototype.constructor=t}}),HS.exports}var $M,$9;function OCe(){if($9)return $M;$9=1;var e=tD().Buffer;function t(n,r){this._block=e.alloc(n),this._finalSize=r,this._blockSize=n,this._len=0}return t.prototype.update=function(n,r){typeof n=="string"&&(r=r||"utf8",n=e.from(n,r));for(var s=this._block,i=this._blockSize,a=n.length,o=this._len,l=0;l<a;){for(var c=o%i,u=Math.min(a-l,i-c),d=0;d<u;d++)s[c+d]=n[l+d];o+=u,l+=u,o%i===0&&this._update(s)}return this._len+=a,this},t.prototype.digest=function(n){var r=this._len%this._blockSize;this._block[r]=128,this._block.fill(0,r+1),r>=this._finalSize&&(this._update(this._block),this._block.fill(0));var s=this._len*8;if(s<=4294967295)this._block.writeUInt32BE(s,this._blockSize-4);else{var i=(s&4294967295)>>>0,a=(s-i)/4294967296;this._block.writeUInt32BE(a,this._blockSize-8),this._block.writeUInt32BE(i,this._blockSize-4)}this._update(this._block);var o=this._hash();return n?o.toString(n):o},t.prototype._update=function(){throw new Error("_update must be implemented by subclass")},$M=t,$M}var zM,z9;function DCe(){if(z9)return zM;z9=1;var e=PCe(),t=OCe(),n=tD().Buffer,r=[1518500249,1859775393,-1894007588,-899497514],s=new Array(80);function i(){this.init(),this._w=s,t.call(this,64,56)}e(i,t),i.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function a(u){return u<<1|u>>>31}function o(u){return u<<5|u>>>27}function l(u){return u<<30|u>>>2}function c(u,d,h,m){return u===0?d&h|~d&m:u===2?d&h|d&m|h&m:d^h^m}return i.prototype._update=function(u){for(var d=this._w,h=this._a|0,m=this._b|0,y=this._c|0,b=this._d|0,v=this._e|0,x=0;x<16;++x)d[x]=u.readInt32BE(x*4);for(;x<80;++x)d[x]=a(d[x-3]^d[x-8]^d[x-14]^d[x-16]);for(var w=0;w<80;++w){var S=~~(w/20),k=o(h)+c(S,m,y,b)+v+d[w]+r[S]|0;v=b,b=y,y=l(m),m=h,h=k}this._a=h+this._a|0,this._b=m+this._b|0,this._c=y+this._c|0,this._d=b+this._d|0,this._e=v+this._e|0},i.prototype._hash=function(){var u=n.allocUnsafe(20);return u.writeInt32BE(this._a|0,0),u.writeInt32BE(this._b|0,4),u.writeInt32BE(this._c|0,8),u.writeInt32BE(this._d|0,12),u.writeInt32BE(this._e|0,16),u},zM=i,zM}var FCe=DCe();const OY=da(FCe);var UM,U9;function LCe(){if(U9)return UM;U9=1;function e(s){if(typeof s!="string")throw new TypeError("Path must be a string. Received "+JSON.stringify(s))}function t(s,i){for(var a="",o=0,l=-1,c=0,u,d=0;d<=s.length;++d){if(d<s.length)u=s.charCodeAt(d);else{if(u===47)break;u=47}if(u===47){if(!(l===d-1||c===1))if(l!==d-1&&c===2){if(a.length<2||o!==2||a.charCodeAt(a.length-1)!==46||a.charCodeAt(a.length-2)!==46){if(a.length>2){var h=a.lastIndexOf("/");if(h!==a.length-1){h===-1?(a="",o=0):(a=a.slice(0,h),o=a.length-1-a.lastIndexOf("/")),l=d,c=0;continue}}else if(a.length===2||a.length===1){a="",o=0,l=d,c=0;continue}}i&&(a.length>0?a+="/..":a="..",o=2)}else a.length>0?a+="/"+s.slice(l+1,d):a=s.slice(l+1,d),o=d-l-1;l=d,c=0}else u===46&&c!==-1?++c:c=-1}return a}function n(s,i){var a=i.dir||i.root,o=i.base||(i.name||"")+(i.ext||"");return a?a===i.root?a+o:a+s+o:o}var r={resolve:function(){for(var i="",a=!1,o,l=arguments.length-1;l>=-1&&!a;l--){var c;l>=0?c=arguments[l]:(o===void 0&&(o=Mi.cwd()),c=o),e(c),c.length!==0&&(i=c+"/"+i,a=c.charCodeAt(0)===47)}return i=t(i,!a),a?i.length>0?"/"+i:"/":i.length>0?i:"."},normalize:function(i){if(e(i),i.length===0)return".";var a=i.charCodeAt(0)===47,o=i.charCodeAt(i.length-1)===47;return i=t(i,!a),i.length===0&&!a&&(i="."),i.length>0&&o&&(i+="/"),a?"/"+i:i},isAbsolute:function(i){return e(i),i.length>0&&i.charCodeAt(0)===47},join:function(){if(arguments.length===0)return".";for(var i,a=0;a<arguments.length;++a){var o=arguments[a];e(o),o.length>0&&(i===void 0?i=o:i+="/"+o)}return i===void 0?".":r.normalize(i)},relative:function(i,a){if(e(i),e(a),i===a||(i=r.resolve(i),a=r.resolve(a),i===a))return"";for(var o=1;o<i.length&&i.charCodeAt(o)===47;++o);for(var l=i.length,c=l-o,u=1;u<a.length&&a.charCodeAt(u)===47;++u);for(var d=a.length,h=d-u,m=c<h?c:h,y=-1,b=0;b<=m;++b){if(b===m){if(h>m){if(a.charCodeAt(u+b)===47)return a.slice(u+b+1);if(b===0)return a.slice(u+b)}else c>m&&(i.charCodeAt(o+b)===47?y=b:b===0&&(y=0));break}var v=i.charCodeAt(o+b),x=a.charCodeAt(u+b);if(v!==x)break;v===47&&(y=b)}var w="";for(b=o+y+1;b<=l;++b)(b===l||i.charCodeAt(b)===47)&&(w.length===0?w+="..":w+="/..");return w.length>0?w+a.slice(u+y):(u+=y,a.charCodeAt(u)===47&&++u,a.slice(u))},_makeLong:function(i){return i},dirname:function(i){if(e(i),i.length===0)return".";for(var a=i.charCodeAt(0),o=a===47,l=-1,c=!0,u=i.length-1;u>=1;--u)if(a=i.charCodeAt(u),a===47){if(!c){l=u;break}}else c=!1;return l===-1?o?"/":".":o&&l===1?"//":i.slice(0,l)},basename:function(i,a){if(a!==void 0&&typeof a!="string")throw new TypeError('"ext" argument must be a string');e(i);var o=0,l=-1,c=!0,u;if(a!==void 0&&a.length>0&&a.length<=i.length){if(a.length===i.length&&a===i)return"";var d=a.length-1,h=-1;for(u=i.length-1;u>=0;--u){var m=i.charCodeAt(u);if(m===47){if(!c){o=u+1;break}}else h===-1&&(c=!1,h=u+1),d>=0&&(m===a.charCodeAt(d)?--d===-1&&(l=u):(d=-1,l=h))}return o===l?l=h:l===-1&&(l=i.length),i.slice(o,l)}else{for(u=i.length-1;u>=0;--u)if(i.charCodeAt(u)===47){if(!c){o=u+1;break}}else l===-1&&(c=!1,l=u+1);return l===-1?"":i.slice(o,l)}},extname:function(i){e(i);for(var a=-1,o=0,l=-1,c=!0,u=0,d=i.length-1;d>=0;--d){var h=i.charCodeAt(d);if(h===47){if(!c){o=d+1;break}continue}l===-1&&(c=!1,l=d+1),h===46?a===-1?a=d:u!==1&&(u=1):a!==-1&&(u=-1)}return a===-1||l===-1||u===0||u===1&&a===l-1&&a===o+1?"":i.slice(a,l)},format:function(i){if(i===null||typeof i!="object")throw new TypeError('The "pathObject" argument must be of type Object. Received type '+typeof i);return n("/",i)},parse:function(i){e(i);var a={root:"",dir:"",base:"",ext:"",name:""};if(i.length===0)return a;var o=i.charCodeAt(0),l=o===47,c;l?(a.root="/",c=1):c=0;for(var u=-1,d=0,h=-1,m=!0,y=i.length-1,b=0;y>=c;--y){if(o=i.charCodeAt(y),o===47){if(!m){d=y+1;break}continue}h===-1&&(m=!1,h=y+1),o===46?u===-1?u=y:b!==1&&(b=1):u!==-1&&(b=-1)}return u===-1||h===-1||b===0||b===1&&u===h-1&&u===d+1?h!==-1&&(d===0&&l?a.base=a.name=i.slice(1,h):a.base=a.name=i.slice(d,h)):(d===0&&l?(a.name=i.slice(1,u),a.base=i.slice(1,h)):(a.name=i.slice(d,u),a.base=i.slice(d,h)),a.ext=i.slice(u,h)),d>0?a.dir=i.slice(0,d-1):l&&(a.dir="/"),a},sep:"/",delimiter:":",win32:null,posix:null};return r.posix=r,UM=r,UM}var $t=LCe(),qM={};/*! crc32.js (C) 2014-present SheetJS -- http://sheetjs.com */var q9;function BCe(){return q9||(q9=1,function(e){(function(t){t(typeof DO_NOT_EXPORT_CRC>"u"?e:{})})(function(t){t.version="1.2.2";function n(){for(var N=0,I=new Array(256),O=0;O!=256;++O)N=O,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,N=N&1?-306674912^N>>>1:N>>>1,I[O]=N;return typeof Int32Array<"u"?new Int32Array(I):I}var r=n();function s(N){var I=0,O=0,B=0,D=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(B=0;B!=256;++B)D[B]=N[B];for(B=0;B!=256;++B)for(O=N[B],I=256+B;I<4096;I+=256)O=D[I]=O>>>8^N[O&255];var H=[];for(B=1;B!=16;++B)H[B-1]=typeof Int32Array<"u"?D.subarray(B*256,B*256+256):D.slice(B*256,B*256+256);return H}var i=s(r),a=i[0],o=i[1],l=i[2],c=i[3],u=i[4],d=i[5],h=i[6],m=i[7],y=i[8],b=i[9],v=i[10],x=i[11],w=i[12],S=i[13],k=i[14];function C(N,I){for(var O=I^-1,B=0,D=N.length;B<D;)O=O>>>8^r[(O^N.charCodeAt(B++))&255];return~O}function T(N,I){for(var O=I^-1,B=N.length-15,D=0;D<B;)O=k[N[D++]^O&255]^S[N[D++]^O>>8&255]^w[N[D++]^O>>16&255]^x[N[D++]^O>>>24]^v[N[D++]]^b[N[D++]]^y[N[D++]]^m[N[D++]]^h[N[D++]]^d[N[D++]]^u[N[D++]]^c[N[D++]]^l[N[D++]]^o[N[D++]]^a[N[D++]]^r[N[D++]];for(B+=15;D<B;)O=O>>>8^r[(O^N[D++])&255];return~O}function A(N,I){for(var O=I^-1,B=0,D=N.length,H=0,P=0;B<D;)H=N.charCodeAt(B++),H<128?O=O>>>8^r[(O^H)&255]:H<2048?(O=O>>>8^r[(O^(192|H>>6&31))&255],O=O>>>8^r[(O^(128|H&63))&255]):H>=55296&&H<57344?(H=(H&1023)+64,P=N.charCodeAt(B++)&1023,O=O>>>8^r[(O^(240|H>>8&7))&255],O=O>>>8^r[(O^(128|H>>2&63))&255],O=O>>>8^r[(O^(128|P>>6&15|(H&3)<<4))&255],O=O>>>8^r[(O^(128|P&63))&255]):(O=O>>>8^r[(O^(224|H>>12&15))&255],O=O>>>8^r[(O^(128|H>>6&63))&255],O=O>>>8^r[(O^(128|H&63))&255]);return~O}t.table=r,t.bstr=C,t.buf=T,t.str=A})}(qM)),qM}var $Ce=BCe();const zCe=da($Ce);var VM={},V9;function ap(){return V9||(V9=1,function(e){var t=typeof Uint8Array<"u"&&typeof Uint16Array<"u"&&typeof Int32Array<"u";function n(i,a){return Object.prototype.hasOwnProperty.call(i,a)}e.assign=function(i){for(var a=Array.prototype.slice.call(arguments,1);a.length;){var o=a.shift();if(o){if(typeof o!="object")throw new TypeError(o+"must be non-object");for(var l in o)n(o,l)&&(i[l]=o[l])}}return i},e.shrinkBuf=function(i,a){return i.length===a?i:i.subarray?i.subarray(0,a):(i.length=a,i)};var r={arraySet:function(i,a,o,l,c){if(a.subarray&&i.subarray){i.set(a.subarray(o,o+l),c);return}for(var u=0;u<l;u++)i[c+u]=a[o+u]},flattenChunks:function(i){var a,o,l,c,u,d;for(l=0,a=0,o=i.length;a<o;a++)l+=i[a].length;for(d=new Uint8Array(l),c=0,a=0,o=i.length;a<o;a++)u=i[a],d.set(u,c),c+=u.length;return d}},s={arraySet:function(i,a,o,l,c){for(var u=0;u<l;u++)i[c+u]=a[o+u]},flattenChunks:function(i){return[].concat.apply([],i)}};e.setTyped=function(i){i?(e.Buf8=Uint8Array,e.Buf16=Uint16Array,e.Buf32=Int32Array,e.assign(e,r)):(e.Buf8=Array,e.Buf16=Array,e.Buf32=Array,e.assign(e,s))},e.setTyped(t)}(VM)),VM}var r0={},hc={},Vp={},W9;function UCe(){if(W9)return Vp;W9=1;var e=ap(),t=4,n=0,r=1,s=2;function i(F){for(var X=F.length;--X>=0;)F[X]=0}var a=0,o=1,l=2,c=3,u=258,d=29,h=256,m=h+1+d,y=30,b=19,v=2*m+1,x=15,w=16,S=7,k=256,C=16,T=17,A=18,N=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0],I=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],O=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7],B=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],D=512,H=new Array((m+2)*2);i(H);var P=new Array(y*2);i(P);var K=new Array(D);i(K);var U=new Array(u-c+1);i(U);var V=new Array(d);i(V);var L=new Array(y);i(L);function te(F,X,be,ke,ge){this.static_tree=F,this.extra_bits=X,this.extra_base=be,this.elems=ke,this.max_length=ge,this.has_stree=F&&F.length}var W,Q,ee;function re(F,X){this.dyn_tree=F,this.max_code=0,this.stat_desc=X}function pe(F){return F<256?K[F]:K[256+(F>>>7)]}function de(F,X){F.pending_buf[F.pending++]=X&255,F.pending_buf[F.pending++]=X>>>8&255}function Oe(F,X,be){F.bi_valid>w-be?(F.bi_buf|=X<<F.bi_valid&65535,de(F,F.bi_buf),F.bi_buf=X>>w-F.bi_valid,F.bi_valid+=be-w):(F.bi_buf|=X<<F.bi_valid&65535,F.bi_valid+=be)}function Fe(F,X,be){Oe(F,be[X*2],be[X*2+1])}function Se(F,X){var be=0;do be|=F&1,F>>>=1,be<<=1;while(--X>0);return be>>>1}function Ce(F){F.bi_valid===16?(de(F,F.bi_buf),F.bi_buf=0,F.bi_valid=0):F.bi_valid>=8&&(F.pending_buf[F.pending++]=F.bi_buf&255,F.bi_buf>>=8,F.bi_valid-=8)}function qe(F,X){var be=X.dyn_tree,ke=X.max_code,ge=X.stat_desc.static_tree,Ee=X.stat_desc.has_stree,le=X.stat_desc.extra_bits,ft=X.stat_desc.extra_base,et=X.stat_desc.max_length,$,Ue,tt,ve,_e,ze,Ct=0;for(ve=0;ve<=x;ve++)F.bl_count[ve]=0;for(be[F.heap[F.heap_max]*2+1]=0,$=F.heap_max+1;$<v;$++)Ue=F.heap[$],ve=be[be[Ue*2+1]*2+1]+1,ve>et&&(ve=et,Ct++),be[Ue*2+1]=ve,!(Ue>ke)&&(F.bl_count[ve]++,_e=0,Ue>=ft&&(_e=le[Ue-ft]),ze=be[Ue*2],F.opt_len+=ze*(ve+_e),Ee&&(F.static_len+=ze*(ge[Ue*2+1]+_e)));if(Ct!==0){do{for(ve=et-1;F.bl_count[ve]===0;)ve--;F.bl_count[ve]--,F.bl_count[ve+1]+=2,F.bl_count[et]--,Ct-=2}while(Ct>0);for(ve=et;ve!==0;ve--)for(Ue=F.bl_count[ve];Ue!==0;)tt=F.heap[--$],!(tt>ke)&&(be[tt*2+1]!==ve&&(F.opt_len+=(ve-be[tt*2+1])*be[tt*2],be[tt*2+1]=ve),Ue--)}}function Qe(F,X,be){var ke=new Array(x+1),ge=0,Ee,le;for(Ee=1;Ee<=x;Ee++)ke[Ee]=ge=ge+be[Ee-1]<<1;for(le=0;le<=X;le++){var ft=F[le*2+1];ft!==0&&(F[le*2]=Se(ke[ft]++,ft))}}function We(){var F,X,be,ke,ge,Ee=new Array(x+1);for(be=0,ke=0;ke<d-1;ke++)for(V[ke]=be,F=0;F<1<<N[ke];F++)U[be++]=ke;for(U[be-1]=ke,ge=0,ke=0;ke<16;ke++)for(L[ke]=ge,F=0;F<1<<I[ke];F++)K[ge++]=ke;for(ge>>=7;ke<y;ke++)for(L[ke]=ge<<7,F=0;F<1<<I[ke]-7;F++)K[256+ge++]=ke;for(X=0;X<=x;X++)Ee[X]=0;for(F=0;F<=143;)H[F*2+1]=8,F++,Ee[8]++;for(;F<=255;)H[F*2+1]=9,F++,Ee[9]++;for(;F<=279;)H[F*2+1]=7,F++,Ee[7]++;for(;F<=287;)H[F*2+1]=8,F++,Ee[8]++;for(Qe(H,m+1,Ee),F=0;F<y;F++)P[F*2+1]=5,P[F*2]=Se(F,5);W=new te(H,N,h+1,m,x),Q=new te(P,I,0,y,x),ee=new te(new Array(0),O,0,b,S)}function je(F){var X;for(X=0;X<m;X++)F.dyn_ltree[X*2]=0;for(X=0;X<y;X++)F.dyn_dtree[X*2]=0;for(X=0;X<b;X++)F.bl_tree[X*2]=0;F.dyn_ltree[k*2]=1,F.opt_len=F.static_len=0,F.last_lit=F.matches=0}function Y(F){F.bi_valid>8?de(F,F.bi_buf):F.bi_valid>0&&(F.pending_buf[F.pending++]=F.bi_buf),F.bi_buf=0,F.bi_valid=0}function ye(F,X,be,ke){Y(F),de(F,be),de(F,~be),e.arraySet(F.pending_buf,F.window,X,be,F.pending),F.pending+=be}function Ie(F,X,be,ke){var ge=X*2,Ee=be*2;return F[ge]<F[Ee]||F[ge]===F[Ee]&&ke[X]<=ke[be]}function ce(F,X,be){for(var ke=F.heap[be],ge=be<<1;ge<=F.heap_len&&(ge<F.heap_len&&Ie(X,F.heap[ge+1],F.heap[ge],F.depth)&&ge++,!Ie(X,ke,F.heap[ge],F.depth));)F.heap[be]=F.heap[ge],be=ge,ge<<=1;F.heap[be]=ke}function oe(F,X,be){var ke,ge,Ee=0,le,ft;if(F.last_lit!==0)do ke=F.pending_buf[F.d_buf+Ee*2]<<8|F.pending_buf[F.d_buf+Ee*2+1],ge=F.pending_buf[F.l_buf+Ee],Ee++,ke===0?Fe(F,ge,X):(le=U[ge],Fe(F,le+h+1,X),ft=N[le],ft!==0&&(ge-=V[le],Oe(F,ge,ft)),ke--,le=pe(ke),Fe(F,le,be),ft=I[le],ft!==0&&(ke-=L[le],Oe(F,ke,ft)));while(Ee<F.last_lit);Fe(F,k,X)}function se(F,X){var be=X.dyn_tree,ke=X.stat_desc.static_tree,ge=X.stat_desc.has_stree,Ee=X.stat_desc.elems,le,ft,et=-1,$;for(F.heap_len=0,F.heap_max=v,le=0;le<Ee;le++)be[le*2]!==0?(F.heap[++F.heap_len]=et=le,F.depth[le]=0):be[le*2+1]=0;for(;F.heap_len<2;)$=F.heap[++F.heap_len]=et<2?++et:0,be[$*2]=1,F.depth[$]=0,F.opt_len--,ge&&(F.static_len-=ke[$*2+1]);for(X.max_code=et,le=F.heap_len>>1;le>=1;le--)ce(F,be,le);$=Ee;do le=F.heap[1],F.heap[1]=F.heap[F.heap_len--],ce(F,be,1),ft=F.heap[1],F.heap[--F.heap_max]=le,F.heap[--F.heap_max]=ft,be[$*2]=be[le*2]+be[ft*2],F.depth[$]=(F.depth[le]>=F.depth[ft]?F.depth[le]:F.depth[ft])+1,be[le*2+1]=be[ft*2+1]=$,F.heap[1]=$++,ce(F,be,1);while(F.heap_len>=2);F.heap[--F.heap_max]=F.heap[1],qe(F,X),Qe(be,et,F.bl_count)}function Me(F,X,be){var ke,ge=-1,Ee,le=X[0*2+1],ft=0,et=7,$=4;for(le===0&&(et=138,$=3),X[(be+1)*2+1]=65535,ke=0;ke<=be;ke++)Ee=le,le=X[(ke+1)*2+1],!(++ft<et&&Ee===le)&&(ft<$?F.bl_tree[Ee*2]+=ft:Ee!==0?(Ee!==ge&&F.bl_tree[Ee*2]++,F.bl_tree[C*2]++):ft<=10?F.bl_tree[T*2]++:F.bl_tree[A*2]++,ft=0,ge=Ee,le===0?(et=138,$=3):Ee===le?(et=6,$=3):(et=7,$=4))}function Be(F,X,be){var ke,ge=-1,Ee,le=X[0*2+1],ft=0,et=7,$=4;for(le===0&&(et=138,$=3),ke=0;ke<=be;ke++)if(Ee=le,le=X[(ke+1)*2+1],!(++ft<et&&Ee===le)){if(ft<$)do Fe(F,Ee,F.bl_tree);while(--ft!==0);else Ee!==0?(Ee!==ge&&(Fe(F,Ee,F.bl_tree),ft--),Fe(F,C,F.bl_tree),Oe(F,ft-3,2)):ft<=10?(Fe(F,T,F.bl_tree),Oe(F,ft-3,3)):(Fe(F,A,F.bl_tree),Oe(F,ft-11,7));ft=0,ge=Ee,le===0?(et=138,$=3):Ee===le?(et=6,$=3):(et=7,$=4)}}function Ae(F){var X;for(Me(F,F.dyn_ltree,F.l_desc.max_code),Me(F,F.dyn_dtree,F.d_desc.max_code),se(F,F.bl_desc),X=b-1;X>=3&&F.bl_tree[B[X]*2+1]===0;X--);return F.opt_len+=3*(X+1)+5+5+4,X}function lt(F,X,be,ke){var ge;for(Oe(F,X-257,5),Oe(F,be-1,5),Oe(F,ke-4,4),ge=0;ge<ke;ge++)Oe(F,F.bl_tree[B[ge]*2+1],3);Be(F,F.dyn_ltree,X-1),Be(F,F.dyn_dtree,be-1)}function Tt(F){var X=4093624447,be;for(be=0;be<=31;be++,X>>>=1)if(X&1&&F.dyn_ltree[be*2]!==0)return n;if(F.dyn_ltree[9*2]!==0||F.dyn_ltree[10*2]!==0||F.dyn_ltree[13*2]!==0)return r;for(be=32;be<h;be++)if(F.dyn_ltree[be*2]!==0)return r;return n}var dt=!1;function Pt(F){dt||(We(),dt=!0),F.l_desc=new re(F.dyn_ltree,W),F.d_desc=new re(F.dyn_dtree,Q),F.bl_desc=new re(F.bl_tree,ee),F.bi_buf=0,F.bi_valid=0,je(F)}function qt(F,X,be,ke){Oe(F,(a<<1)+(ke?1:0),3),ye(F,X,be)}function Ft(F){Oe(F,o<<1,3),Fe(F,k,H),Ce(F)}function Ht(F,X,be,ke){var ge,Ee,le=0;F.level>0?(F.strm.data_type===s&&(F.strm.data_type=Tt(F)),se(F,F.l_desc),se(F,F.d_desc),le=Ae(F),ge=F.opt_len+3+7>>>3,Ee=F.static_len+3+7>>>3,Ee<=ge&&(ge=Ee)):ge=Ee=be+5,be+4<=ge&&X!==-1?qt(F,X,be,ke):F.strategy===t||Ee===ge?(Oe(F,(o<<1)+(ke?1:0),3),oe(F,H,P)):(Oe(F,(l<<1)+(ke?1:0),3),lt(F,F.l_desc.max_code+1,F.d_desc.max_code+1,le+1),oe(F,F.dyn_ltree,F.dyn_dtree)),je(F),ke&&Y(F)}function we(F,X,be){return F.pending_buf[F.d_buf+F.last_lit*2]=X>>>8&255,F.pending_buf[F.d_buf+F.last_lit*2+1]=X&255,F.pending_buf[F.l_buf+F.last_lit]=be&255,F.last_lit++,X===0?F.dyn_ltree[be*2]++:(F.matches++,X--,F.dyn_ltree[(U[be]+h+1)*2]++,F.dyn_dtree[pe(X)*2]++),F.last_lit===F.lit_bufsize-1}return Vp._tr_init=Pt,Vp._tr_stored_block=qt,Vp._tr_flush_block=Ht,Vp._tr_tally=we,Vp._tr_align=Ft,Vp}var WM,H9;function DY(){if(H9)return WM;H9=1;function e(t,n,r,s){for(var i=t&65535|0,a=t>>>16&65535|0,o=0;r!==0;){o=r>2e3?2e3:r,r-=o;do i=i+n[s++]|0,a=a+i|0;while(--o);i%=65521,a%=65521}return i|a<<16|0}return WM=e,WM}var HM,G9;function FY(){if(G9)return HM;G9=1;function e(){for(var r,s=[],i=0;i<256;i++){r=i;for(var a=0;a<8;a++)r=r&1?3988292384^r>>>1:r>>>1;s[i]=r}return s}var t=e();function n(r,s,i,a){var o=t,l=a+i;r^=-1;for(var c=a;c<l;c++)r=r>>>8^o[(r^s[c])&255];return r^-1}return HM=n,HM}var GM,K9;function hD(){return K9||(K9=1,GM={2:"need dictionary",1:"stream end",0:"","-1":"file error","-2":"stream error","-3":"data error","-4":"insufficient memory","-5":"buffer error","-6":"incompatible version"}),GM}var Y9;function qCe(){if(Y9)return hc;Y9=1;var e=ap(),t=UCe(),n=DY(),r=FY(),s=hD(),i=0,a=1,o=3,l=4,c=5,u=0,d=1,h=-2,m=-3,y=-5,b=-1,v=1,x=2,w=3,S=4,k=0,C=2,T=8,A=9,N=15,I=8,O=29,B=256,D=B+1+O,H=30,P=19,K=2*D+1,U=15,V=3,L=258,te=L+V+1,W=32,Q=42,ee=69,re=73,pe=91,de=103,Oe=113,Fe=666,Se=1,Ce=2,qe=3,Qe=4,We=3;function je($,Ue){return $.msg=s[Ue],Ue}function Y($){return($<<1)-($>4?9:0)}function ye($){for(var Ue=$.length;--Ue>=0;)$[Ue]=0}function Ie($){var Ue=$.state,tt=Ue.pending;tt>$.avail_out&&(tt=$.avail_out),tt!==0&&(e.arraySet($.output,Ue.pending_buf,Ue.pending_out,tt,$.next_out),$.next_out+=tt,Ue.pending_out+=tt,$.total_out+=tt,$.avail_out-=tt,Ue.pending-=tt,Ue.pending===0&&(Ue.pending_out=0))}function ce($,Ue){t._tr_flush_block($,$.block_start>=0?$.block_start:-1,$.strstart-$.block_start,Ue),$.block_start=$.strstart,Ie($.strm)}function oe($,Ue){$.pending_buf[$.pending++]=Ue}function se($,Ue){$.pending_buf[$.pending++]=Ue>>>8&255,$.pending_buf[$.pending++]=Ue&255}function Me($,Ue,tt,ve){var _e=$.avail_in;return _e>ve&&(_e=ve),_e===0?0:($.avail_in-=_e,e.arraySet(Ue,$.input,$.next_in,_e,tt),$.state.wrap===1?$.adler=n($.adler,Ue,_e,tt):$.state.wrap===2&&($.adler=r($.adler,Ue,_e,tt)),$.next_in+=_e,$.total_in+=_e,_e)}function Be($,Ue){var tt=$.max_chain_length,ve=$.strstart,_e,ze,Ct=$.prev_length,fe=$.nice_match,Z=$.strstart>$.w_size-te?$.strstart-($.w_size-te):0,G=$.window,J=$.w_mask,xe=$.prev,De=$.strstart+L,He=G[ve+Ct-1],wt=G[ve+Ct];$.prev_length>=$.good_match&&(tt>>=2),fe>$.lookahead&&(fe=$.lookahead);do if(_e=Ue,!(G[_e+Ct]!==wt||G[_e+Ct-1]!==He||G[_e]!==G[ve]||G[++_e]!==G[ve+1])){ve+=2,_e++;do;while(G[++ve]===G[++_e]&&G[++ve]===G[++_e]&&G[++ve]===G[++_e]&&G[++ve]===G[++_e]&&G[++ve]===G[++_e]&&G[++ve]===G[++_e]&&G[++ve]===G[++_e]&&G[++ve]===G[++_e]&&ve<De);if(ze=L-(De-ve),ve=De-L,ze>Ct){if($.match_start=Ue,Ct=ze,ze>=fe)break;He=G[ve+Ct-1],wt=G[ve+Ct]}}while((Ue=xe[Ue&J])>Z&&--tt!==0);return Ct<=$.lookahead?Ct:$.lookahead}function Ae($){var Ue=$.w_size,tt,ve,_e,ze,Ct;do{if(ze=$.window_size-$.lookahead-$.strstart,$.strstart>=Ue+(Ue-te)){e.arraySet($.window,$.window,Ue,Ue,0),$.match_start-=Ue,$.strstart-=Ue,$.block_start-=Ue,ve=$.hash_size,tt=ve;do _e=$.head[--tt],$.head[tt]=_e>=Ue?_e-Ue:0;while(--ve);ve=Ue,tt=ve;do _e=$.prev[--tt],$.prev[tt]=_e>=Ue?_e-Ue:0;while(--ve);ze+=Ue}if($.strm.avail_in===0)break;if(ve=Me($.strm,$.window,$.strstart+$.lookahead,ze),$.lookahead+=ve,$.lookahead+$.insert>=V)for(Ct=$.strstart-$.insert,$.ins_h=$.window[Ct],$.ins_h=($.ins_h<<$.hash_shift^$.window[Ct+1])&$.hash_mask;$.insert&&($.ins_h=($.ins_h<<$.hash_shift^$.window[Ct+V-1])&$.hash_mask,$.prev[Ct&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=Ct,Ct++,$.insert--,!($.lookahead+$.insert<V)););}while($.lookahead<te&&$.strm.avail_in!==0)}function lt($,Ue){var tt=65535;for(tt>$.pending_buf_size-5&&(tt=$.pending_buf_size-5);;){if($.lookahead<=1){if(Ae($),$.lookahead===0&&Ue===i)return Se;if($.lookahead===0)break}$.strstart+=$.lookahead,$.lookahead=0;var ve=$.block_start+tt;if(($.strstart===0||$.strstart>=ve)&&($.lookahead=$.strstart-ve,$.strstart=ve,ce($,!1),$.strm.avail_out===0)||$.strstart-$.block_start>=$.w_size-te&&(ce($,!1),$.strm.avail_out===0))return Se}return $.insert=0,Ue===l?(ce($,!0),$.strm.avail_out===0?qe:Qe):($.strstart>$.block_start&&(ce($,!1),$.strm.avail_out===0),Se)}function Tt($,Ue){for(var tt,ve;;){if($.lookahead<te){if(Ae($),$.lookahead<te&&Ue===i)return Se;if($.lookahead===0)break}if(tt=0,$.lookahead>=V&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+V-1])&$.hash_mask,tt=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart),tt!==0&&$.strstart-tt<=$.w_size-te&&($.match_length=Be($,tt)),$.match_length>=V)if(ve=t._tr_tally($,$.strstart-$.match_start,$.match_length-V),$.lookahead-=$.match_length,$.match_length<=$.max_lazy_match&&$.lookahead>=V){$.match_length--;do $.strstart++,$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+V-1])&$.hash_mask,tt=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart;while(--$.match_length!==0);$.strstart++}else $.strstart+=$.match_length,$.match_length=0,$.ins_h=$.window[$.strstart],$.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+1])&$.hash_mask;else ve=t._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++;if(ve&&(ce($,!1),$.strm.avail_out===0))return Se}return $.insert=$.strstart<V-1?$.strstart:V-1,Ue===l?(ce($,!0),$.strm.avail_out===0?qe:Qe):$.last_lit&&(ce($,!1),$.strm.avail_out===0)?Se:Ce}function dt($,Ue){for(var tt,ve,_e;;){if($.lookahead<te){if(Ae($),$.lookahead<te&&Ue===i)return Se;if($.lookahead===0)break}if(tt=0,$.lookahead>=V&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+V-1])&$.hash_mask,tt=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart),$.prev_length=$.match_length,$.prev_match=$.match_start,$.match_length=V-1,tt!==0&&$.prev_length<$.max_lazy_match&&$.strstart-tt<=$.w_size-te&&($.match_length=Be($,tt),$.match_length<=5&&($.strategy===v||$.match_length===V&&$.strstart-$.match_start>4096)&&($.match_length=V-1)),$.prev_length>=V&&$.match_length<=$.prev_length){_e=$.strstart+$.lookahead-V,ve=t._tr_tally($,$.strstart-1-$.prev_match,$.prev_length-V),$.lookahead-=$.prev_length-1,$.prev_length-=2;do++$.strstart<=_e&&($.ins_h=($.ins_h<<$.hash_shift^$.window[$.strstart+V-1])&$.hash_mask,tt=$.prev[$.strstart&$.w_mask]=$.head[$.ins_h],$.head[$.ins_h]=$.strstart);while(--$.prev_length!==0);if($.match_available=0,$.match_length=V-1,$.strstart++,ve&&(ce($,!1),$.strm.avail_out===0))return Se}else if($.match_available){if(ve=t._tr_tally($,0,$.window[$.strstart-1]),ve&&ce($,!1),$.strstart++,$.lookahead--,$.strm.avail_out===0)return Se}else $.match_available=1,$.strstart++,$.lookahead--}return $.match_available&&(ve=t._tr_tally($,0,$.window[$.strstart-1]),$.match_available=0),$.insert=$.strstart<V-1?$.strstart:V-1,Ue===l?(ce($,!0),$.strm.avail_out===0?qe:Qe):$.last_lit&&(ce($,!1),$.strm.avail_out===0)?Se:Ce}function Pt($,Ue){for(var tt,ve,_e,ze,Ct=$.window;;){if($.lookahead<=L){if(Ae($),$.lookahead<=L&&Ue===i)return Se;if($.lookahead===0)break}if($.match_length=0,$.lookahead>=V&&$.strstart>0&&(_e=$.strstart-1,ve=Ct[_e],ve===Ct[++_e]&&ve===Ct[++_e]&&ve===Ct[++_e])){ze=$.strstart+L;do;while(ve===Ct[++_e]&&ve===Ct[++_e]&&ve===Ct[++_e]&&ve===Ct[++_e]&&ve===Ct[++_e]&&ve===Ct[++_e]&&ve===Ct[++_e]&&ve===Ct[++_e]&&_e<ze);$.match_length=L-(ze-_e),$.match_length>$.lookahead&&($.match_length=$.lookahead)}if($.match_length>=V?(tt=t._tr_tally($,1,$.match_length-V),$.lookahead-=$.match_length,$.strstart+=$.match_length,$.match_length=0):(tt=t._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++),tt&&(ce($,!1),$.strm.avail_out===0))return Se}return $.insert=0,Ue===l?(ce($,!0),$.strm.avail_out===0?qe:Qe):$.last_lit&&(ce($,!1),$.strm.avail_out===0)?Se:Ce}function qt($,Ue){for(var tt;;){if($.lookahead===0&&(Ae($),$.lookahead===0)){if(Ue===i)return Se;break}if($.match_length=0,tt=t._tr_tally($,0,$.window[$.strstart]),$.lookahead--,$.strstart++,tt&&(ce($,!1),$.strm.avail_out===0))return Se}return $.insert=0,Ue===l?(ce($,!0),$.strm.avail_out===0?qe:Qe):$.last_lit&&(ce($,!1),$.strm.avail_out===0)?Se:Ce}function Ft($,Ue,tt,ve,_e){this.good_length=$,this.max_lazy=Ue,this.nice_length=tt,this.max_chain=ve,this.func=_e}var Ht;Ht=[new Ft(0,0,0,0,lt),new Ft(4,4,8,4,Tt),new Ft(4,5,16,8,Tt),new Ft(4,6,32,32,Tt),new Ft(4,4,16,16,dt),new Ft(8,16,32,32,dt),new Ft(8,16,128,128,dt),new Ft(8,32,128,256,dt),new Ft(32,128,258,1024,dt),new Ft(32,258,258,4096,dt)];function we($){$.window_size=2*$.w_size,ye($.head),$.max_lazy_match=Ht[$.level].max_lazy,$.good_match=Ht[$.level].good_length,$.nice_match=Ht[$.level].nice_length,$.max_chain_length=Ht[$.level].max_chain,$.strstart=0,$.block_start=0,$.lookahead=0,$.insert=0,$.match_length=$.prev_length=V-1,$.match_available=0,$.ins_h=0}function F(){this.strm=null,this.status=0,this.pending_buf=null,this.pending_buf_size=0,this.pending_out=0,this.pending=0,this.wrap=0,this.gzhead=null,this.gzindex=0,this.method=T,this.last_flush=-1,this.w_size=0,this.w_bits=0,this.w_mask=0,this.window=null,this.window_size=0,this.prev=null,this.head=null,this.ins_h=0,this.hash_size=0,this.hash_bits=0,this.hash_mask=0,this.hash_shift=0,this.block_start=0,this.match_length=0,this.prev_match=0,this.match_available=0,this.strstart=0,this.match_start=0,this.lookahead=0,this.prev_length=0,this.max_chain_length=0,this.max_lazy_match=0,this.level=0,this.strategy=0,this.good_match=0,this.nice_match=0,this.dyn_ltree=new e.Buf16(K*2),this.dyn_dtree=new e.Buf16((2*H+1)*2),this.bl_tree=new e.Buf16((2*P+1)*2),ye(this.dyn_ltree),ye(this.dyn_dtree),ye(this.bl_tree),this.l_desc=null,this.d_desc=null,this.bl_desc=null,this.bl_count=new e.Buf16(U+1),this.heap=new e.Buf16(2*D+1),ye(this.heap),this.heap_len=0,this.heap_max=0,this.depth=new e.Buf16(2*D+1),ye(this.depth),this.l_buf=0,this.lit_bufsize=0,this.last_lit=0,this.d_buf=0,this.opt_len=0,this.static_len=0,this.matches=0,this.insert=0,this.bi_buf=0,this.bi_valid=0}function X($){var Ue;return!$||!$.state?je($,h):($.total_in=$.total_out=0,$.data_type=C,Ue=$.state,Ue.pending=0,Ue.pending_out=0,Ue.wrap<0&&(Ue.wrap=-Ue.wrap),Ue.status=Ue.wrap?Q:Oe,$.adler=Ue.wrap===2?0:1,Ue.last_flush=i,t._tr_init(Ue),u)}function be($){var Ue=X($);return Ue===u&&we($.state),Ue}function ke($,Ue){return!$||!$.state||$.state.wrap!==2?h:($.state.gzhead=Ue,u)}function ge($,Ue,tt,ve,_e,ze){if(!$)return h;var Ct=1;if(Ue===b&&(Ue=6),ve<0?(Ct=0,ve=-ve):ve>15&&(Ct=2,ve-=16),_e<1||_e>A||tt!==T||ve<8||ve>15||Ue<0||Ue>9||ze<0||ze>S)return je($,h);ve===8&&(ve=9);var fe=new F;return $.state=fe,fe.strm=$,fe.wrap=Ct,fe.gzhead=null,fe.w_bits=ve,fe.w_size=1<<fe.w_bits,fe.w_mask=fe.w_size-1,fe.hash_bits=_e+7,fe.hash_size=1<<fe.hash_bits,fe.hash_mask=fe.hash_size-1,fe.hash_shift=~~((fe.hash_bits+V-1)/V),fe.window=new e.Buf8(fe.w_size*2),fe.head=new e.Buf16(fe.hash_size),fe.prev=new e.Buf16(fe.w_size),fe.lit_bufsize=1<<_e+6,fe.pending_buf_size=fe.lit_bufsize*4,fe.pending_buf=new e.Buf8(fe.pending_buf_size),fe.d_buf=1*fe.lit_bufsize,fe.l_buf=3*fe.lit_bufsize,fe.level=Ue,fe.strategy=ze,fe.method=tt,be($)}function Ee($,Ue){return ge($,Ue,T,N,I,k)}function le($,Ue){var tt,ve,_e,ze;if(!$||!$.state||Ue>c||Ue<0)return $?je($,h):h;if(ve=$.state,!$.output||!$.input&&$.avail_in!==0||ve.status===Fe&&Ue!==l)return je($,$.avail_out===0?y:h);if(ve.strm=$,tt=ve.last_flush,ve.last_flush=Ue,ve.status===Q)if(ve.wrap===2)$.adler=0,oe(ve,31),oe(ve,139),oe(ve,8),ve.gzhead?(oe(ve,(ve.gzhead.text?1:0)+(ve.gzhead.hcrc?2:0)+(ve.gzhead.extra?4:0)+(ve.gzhead.name?8:0)+(ve.gzhead.comment?16:0)),oe(ve,ve.gzhead.time&255),oe(ve,ve.gzhead.time>>8&255),oe(ve,ve.gzhead.time>>16&255),oe(ve,ve.gzhead.time>>24&255),oe(ve,ve.level===9?2:ve.strategy>=x||ve.level<2?4:0),oe(ve,ve.gzhead.os&255),ve.gzhead.extra&&ve.gzhead.extra.length&&(oe(ve,ve.gzhead.extra.length&255),oe(ve,ve.gzhead.extra.length>>8&255)),ve.gzhead.hcrc&&($.adler=r($.adler,ve.pending_buf,ve.pending,0)),ve.gzindex=0,ve.status=ee):(oe(ve,0),oe(ve,0),oe(ve,0),oe(ve,0),oe(ve,0),oe(ve,ve.level===9?2:ve.strategy>=x||ve.level<2?4:0),oe(ve,We),ve.status=Oe);else{var Ct=T+(ve.w_bits-8<<4)<<8,fe=-1;ve.strategy>=x||ve.level<2?fe=0:ve.level<6?fe=1:ve.level===6?fe=2:fe=3,Ct|=fe<<6,ve.strstart!==0&&(Ct|=W),Ct+=31-Ct%31,ve.status=Oe,se(ve,Ct),ve.strstart!==0&&(se(ve,$.adler>>>16),se(ve,$.adler&65535)),$.adler=1}if(ve.status===ee)if(ve.gzhead.extra){for(_e=ve.pending;ve.gzindex<(ve.gzhead.extra.length&65535)&&!(ve.pending===ve.pending_buf_size&&(ve.gzhead.hcrc&&ve.pending>_e&&($.adler=r($.adler,ve.pending_buf,ve.pending-_e,_e)),Ie($),_e=ve.pending,ve.pending===ve.pending_buf_size));)oe(ve,ve.gzhead.extra[ve.gzindex]&255),ve.gzindex++;ve.gzhead.hcrc&&ve.pending>_e&&($.adler=r($.adler,ve.pending_buf,ve.pending-_e,_e)),ve.gzindex===ve.gzhead.extra.length&&(ve.gzindex=0,ve.status=re)}else ve.status=re;if(ve.status===re)if(ve.gzhead.name){_e=ve.pending;do{if(ve.pending===ve.pending_buf_size&&(ve.gzhead.hcrc&&ve.pending>_e&&($.adler=r($.adler,ve.pending_buf,ve.pending-_e,_e)),Ie($),_e=ve.pending,ve.pending===ve.pending_buf_size)){ze=1;break}ve.gzindex<ve.gzhead.name.length?ze=ve.gzhead.name.charCodeAt(ve.gzindex++)&255:ze=0,oe(ve,ze)}while(ze!==0);ve.gzhead.hcrc&&ve.pending>_e&&($.adler=r($.adler,ve.pending_buf,ve.pending-_e,_e)),ze===0&&(ve.gzindex=0,ve.status=pe)}else ve.status=pe;if(ve.status===pe)if(ve.gzhead.comment){_e=ve.pending;do{if(ve.pending===ve.pending_buf_size&&(ve.gzhead.hcrc&&ve.pending>_e&&($.adler=r($.adler,ve.pending_buf,ve.pending-_e,_e)),Ie($),_e=ve.pending,ve.pending===ve.pending_buf_size)){ze=1;break}ve.gzindex<ve.gzhead.comment.length?ze=ve.gzhead.comment.charCodeAt(ve.gzindex++)&255:ze=0,oe(ve,ze)}while(ze!==0);ve.gzhead.hcrc&&ve.pending>_e&&($.adler=r($.adler,ve.pending_buf,ve.pending-_e,_e)),ze===0&&(ve.status=de)}else ve.status=de;if(ve.status===de&&(ve.gzhead.hcrc?(ve.pending+2>ve.pending_buf_size&&Ie($),ve.pending+2<=ve.pending_buf_size&&(oe(ve,$.adler&255),oe(ve,$.adler>>8&255),$.adler=0,ve.status=Oe)):ve.status=Oe),ve.pending!==0){if(Ie($),$.avail_out===0)return ve.last_flush=-1,u}else if($.avail_in===0&&Y(Ue)<=Y(tt)&&Ue!==l)return je($,y);if(ve.status===Fe&&$.avail_in!==0)return je($,y);if($.avail_in!==0||ve.lookahead!==0||Ue!==i&&ve.status!==Fe){var Z=ve.strategy===x?qt(ve,Ue):ve.strategy===w?Pt(ve,Ue):Ht[ve.level].func(ve,Ue);if((Z===qe||Z===Qe)&&(ve.status=Fe),Z===Se||Z===qe)return $.avail_out===0&&(ve.last_flush=-1),u;if(Z===Ce&&(Ue===a?t._tr_align(ve):Ue!==c&&(t._tr_stored_block(ve,0,0,!1),Ue===o&&(ye(ve.head),ve.lookahead===0&&(ve.strstart=0,ve.block_start=0,ve.insert=0))),Ie($),$.avail_out===0))return ve.last_flush=-1,u}return Ue!==l?u:ve.wrap<=0?d:(ve.wrap===2?(oe(ve,$.adler&255),oe(ve,$.adler>>8&255),oe(ve,$.adler>>16&255),oe(ve,$.adler>>24&255),oe(ve,$.total_in&255),oe(ve,$.total_in>>8&255),oe(ve,$.total_in>>16&255),oe(ve,$.total_in>>24&255)):(se(ve,$.adler>>>16),se(ve,$.adler&65535)),Ie($),ve.wrap>0&&(ve.wrap=-ve.wrap),ve.pending!==0?u:d)}function ft($){var Ue;return!$||!$.state?h:(Ue=$.state.status,Ue!==Q&&Ue!==ee&&Ue!==re&&Ue!==pe&&Ue!==de&&Ue!==Oe&&Ue!==Fe?je($,h):($.state=null,Ue===Oe?je($,m):u))}function et($,Ue){var tt=Ue.length,ve,_e,ze,Ct,fe,Z,G,J;if(!$||!$.state||(ve=$.state,Ct=ve.wrap,Ct===2||Ct===1&&ve.status!==Q||ve.lookahead))return h;for(Ct===1&&($.adler=n($.adler,Ue,tt,0)),ve.wrap=0,tt>=ve.w_size&&(Ct===0&&(ye(ve.head),ve.strstart=0,ve.block_start=0,ve.insert=0),J=new e.Buf8(ve.w_size),e.arraySet(J,Ue,tt-ve.w_size,ve.w_size,0),Ue=J,tt=ve.w_size),fe=$.avail_in,Z=$.next_in,G=$.input,$.avail_in=tt,$.next_in=0,$.input=Ue,Ae(ve);ve.lookahead>=V;){_e=ve.strstart,ze=ve.lookahead-(V-1);do ve.ins_h=(ve.ins_h<<ve.hash_shift^ve.window[_e+V-1])&ve.hash_mask,ve.prev[_e&ve.w_mask]=ve.head[ve.ins_h],ve.head[ve.ins_h]=_e,_e++;while(--ze);ve.strstart=_e,ve.lookahead=V-1,Ae(ve)}return ve.strstart+=ve.lookahead,ve.block_start=ve.strstart,ve.insert=ve.lookahead,ve.lookahead=0,ve.match_length=ve.prev_length=V-1,ve.match_available=0,$.next_in=Z,$.input=G,$.avail_in=fe,ve.wrap=Ct,u}return hc.deflateInit=Ee,hc.deflateInit2=ge,hc.deflateReset=be,hc.deflateResetKeep=X,hc.deflateSetHeader=ke,hc.deflate=le,hc.deflateEnd=ft,hc.deflateSetDictionary=et,hc.deflateInfo="pako deflate (from Nodeca project)",hc}var Wp={},Z9;function LY(){if(Z9)return Wp;Z9=1;var e=ap(),t=!0,n=!0;try{String.fromCharCode.apply(null,[0])}catch{t=!1}try{String.fromCharCode.apply(null,new Uint8Array(1))}catch{n=!1}for(var r=new e.Buf8(256),s=0;s<256;s++)r[s]=s>=252?6:s>=248?5:s>=240?4:s>=224?3:s>=192?2:1;r[254]=r[254]=1,Wp.string2buf=function(a){var o,l,c,u,d,h=a.length,m=0;for(u=0;u<h;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<h&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),m+=l<128?1:l<2048?2:l<65536?3:4;for(o=new e.Buf8(m),d=0,u=0;d<m;u++)l=a.charCodeAt(u),(l&64512)===55296&&u+1<h&&(c=a.charCodeAt(u+1),(c&64512)===56320&&(l=65536+(l-55296<<10)+(c-56320),u++)),l<128?o[d++]=l:l<2048?(o[d++]=192|l>>>6,o[d++]=128|l&63):l<65536?(o[d++]=224|l>>>12,o[d++]=128|l>>>6&63,o[d++]=128|l&63):(o[d++]=240|l>>>18,o[d++]=128|l>>>12&63,o[d++]=128|l>>>6&63,o[d++]=128|l&63);return o};function i(a,o){if(o<65534&&(a.subarray&&n||!a.subarray&&t))return String.fromCharCode.apply(null,e.shrinkBuf(a,o));for(var l="",c=0;c<o;c++)l+=String.fromCharCode(a[c]);return l}return Wp.buf2binstring=function(a){return i(a,a.length)},Wp.binstring2buf=function(a){for(var o=new e.Buf8(a.length),l=0,c=o.length;l<c;l++)o[l]=a.charCodeAt(l);return o},Wp.buf2string=function(a,o){var l,c,u,d,h=o||a.length,m=new Array(h*2);for(c=0,l=0;l<h;){if(u=a[l++],u<128){m[c++]=u;continue}if(d=r[u],d>4){m[c++]=65533,l+=d-1;continue}for(u&=d===2?31:d===3?15:7;d>1&&l<h;)u=u<<6|a[l++]&63,d--;if(d>1){m[c++]=65533;continue}u<65536?m[c++]=u:(u-=65536,m[c++]=55296|u>>10&1023,m[c++]=56320|u&1023)}return i(m,c)},Wp.utf8border=function(a,o){var l;for(o=o||a.length,o>a.length&&(o=a.length),l=o-1;l>=0&&(a[l]&192)===128;)l--;return l<0||l===0?o:l+r[a[l]]>o?l:o},Wp}var KM,X9;function BY(){if(X9)return KM;X9=1;function e(){this.input=null,this.next_in=0,this.avail_in=0,this.total_in=0,this.output=null,this.next_out=0,this.avail_out=0,this.total_out=0,this.msg="",this.state=null,this.data_type=2,this.adler=0}return KM=e,KM}var J9;function VCe(){if(J9)return r0;J9=1;var e=qCe(),t=ap(),n=LY(),r=hD(),s=BY(),i=Object.prototype.toString,a=0,o=4,l=0,c=1,u=2,d=-1,h=0,m=8;function y(w){if(!(this instanceof y))return new y(w);this.options=t.assign({level:d,method:m,chunkSize:16384,windowBits:15,memLevel:8,strategy:h,to:""},w||{});var S=this.options;S.raw&&S.windowBits>0?S.windowBits=-S.windowBits:S.gzip&&S.windowBits>0&&S.windowBits<16&&(S.windowBits+=16),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new s,this.strm.avail_out=0;var k=e.deflateInit2(this.strm,S.level,S.method,S.windowBits,S.memLevel,S.strategy);if(k!==l)throw new Error(r[k]);if(S.header&&e.deflateSetHeader(this.strm,S.header),S.dictionary){var C;if(typeof S.dictionary=="string"?C=n.string2buf(S.dictionary):i.call(S.dictionary)==="[object ArrayBuffer]"?C=new Uint8Array(S.dictionary):C=S.dictionary,k=e.deflateSetDictionary(this.strm,C),k!==l)throw new Error(r[k]);this._dict_set=!0}}y.prototype.push=function(w,S){var k=this.strm,C=this.options.chunkSize,T,A;if(this.ended)return!1;A=S===~~S?S:S===!0?o:a,typeof w=="string"?k.input=n.string2buf(w):i.call(w)==="[object ArrayBuffer]"?k.input=new Uint8Array(w):k.input=w,k.next_in=0,k.avail_in=k.input.length;do{if(k.avail_out===0&&(k.output=new t.Buf8(C),k.next_out=0,k.avail_out=C),T=e.deflate(k,A),T!==c&&T!==l)return this.onEnd(T),this.ended=!0,!1;(k.avail_out===0||k.avail_in===0&&(A===o||A===u))&&(this.options.to==="string"?this.onData(n.buf2binstring(t.shrinkBuf(k.output,k.next_out))):this.onData(t.shrinkBuf(k.output,k.next_out)))}while((k.avail_in>0||k.avail_out===0)&&T!==c);return A===o?(T=e.deflateEnd(this.strm),this.onEnd(T),this.ended=!0,T===l):(A===u&&(this.onEnd(l),k.avail_out=0),!0)},y.prototype.onData=function(w){this.chunks.push(w)},y.prototype.onEnd=function(w){w===l&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=w,this.msg=this.strm.msg};function b(w,S){var k=new y(S);if(k.push(w,!0),k.err)throw k.msg||r[k.err];return k.result}function v(w,S){return S=S||{},S.raw=!0,b(w,S)}function x(w,S){return S=S||{},S.gzip=!0,b(w,S)}return r0.Deflate=y,r0.deflate=b,r0.deflateRaw=v,r0.gzip=x,r0}var s0={},jl={},YM,Q9;function WCe(){if(Q9)return YM;Q9=1;var e=30,t=12;return YM=function(r,s){var i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C,T,A,N,I,O,B,D,H;i=r.state,a=r.next_in,D=r.input,o=a+(r.avail_in-5),l=r.next_out,H=r.output,c=l-(s-r.avail_out),u=l+(r.avail_out-257),d=i.dmax,h=i.wsize,m=i.whave,y=i.wnext,b=i.window,v=i.hold,x=i.bits,w=i.lencode,S=i.distcode,k=(1<<i.lenbits)-1,C=(1<<i.distbits)-1;e:do{x<15&&(v+=D[a++]<<x,x+=8,v+=D[a++]<<x,x+=8),T=w[v&k];t:for(;;){if(A=T>>>24,v>>>=A,x-=A,A=T>>>16&255,A===0)H[l++]=T&65535;else if(A&16){N=T&65535,A&=15,A&&(x<A&&(v+=D[a++]<<x,x+=8),N+=v&(1<<A)-1,v>>>=A,x-=A),x<15&&(v+=D[a++]<<x,x+=8,v+=D[a++]<<x,x+=8),T=S[v&C];n:for(;;){if(A=T>>>24,v>>>=A,x-=A,A=T>>>16&255,A&16){if(I=T&65535,A&=15,x<A&&(v+=D[a++]<<x,x+=8,x<A&&(v+=D[a++]<<x,x+=8)),I+=v&(1<<A)-1,I>d){r.msg="invalid distance too far back",i.mode=e;break e}if(v>>>=A,x-=A,A=l-c,I>A){if(A=I-A,A>m&&i.sane){r.msg="invalid distance too far back",i.mode=e;break e}if(O=0,B=b,y===0){if(O+=h-A,A<N){N-=A;do H[l++]=b[O++];while(--A);O=l-I,B=H}}else if(y<A){if(O+=h+y-A,A-=y,A<N){N-=A;do H[l++]=b[O++];while(--A);if(O=0,y<N){A=y,N-=A;do H[l++]=b[O++];while(--A);O=l-I,B=H}}}else if(O+=y-A,A<N){N-=A;do H[l++]=b[O++];while(--A);O=l-I,B=H}for(;N>2;)H[l++]=B[O++],H[l++]=B[O++],H[l++]=B[O++],N-=3;N&&(H[l++]=B[O++],N>1&&(H[l++]=B[O++]))}else{O=l-I;do H[l++]=H[O++],H[l++]=H[O++],H[l++]=H[O++],N-=3;while(N>2);N&&(H[l++]=H[O++],N>1&&(H[l++]=H[O++]))}}else if((A&64)===0){T=S[(T&65535)+(v&(1<<A)-1)];continue n}else{r.msg="invalid distance code",i.mode=e;break e}break}}else if((A&64)===0){T=w[(T&65535)+(v&(1<<A)-1)];continue t}else if(A&32){i.mode=t;break e}else{r.msg="invalid literal/length code",i.mode=e;break e}break}}while(a<o&&l<u);N=x>>3,a-=N,x-=N<<3,v&=(1<<x)-1,r.next_in=a,r.next_out=l,r.avail_in=a<o?5+(o-a):5-(a-o),r.avail_out=l<u?257+(u-l):257-(l-u),i.hold=v,i.bits=x},YM}var ZM,ez;function HCe(){if(ez)return ZM;ez=1;var e=ap(),t=15,n=852,r=592,s=0,i=1,a=2,o=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0],l=[16,16,16,16,16,16,16,16,17,17,17,17,18,18,18,18,19,19,19,19,20,20,20,20,21,21,21,21,16,72,78],c=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577,0,0],u=[16,16,16,16,17,17,18,18,19,19,20,20,21,21,22,22,23,23,24,24,25,25,26,26,27,27,28,28,29,29,64,64];return ZM=function(h,m,y,b,v,x,w,S){var k=S.bits,C=0,T=0,A=0,N=0,I=0,O=0,B=0,D=0,H=0,P=0,K,U,V,L,te,W=null,Q=0,ee,re=new e.Buf16(t+1),pe=new e.Buf16(t+1),de=null,Oe=0,Fe,Se,Ce;for(C=0;C<=t;C++)re[C]=0;for(T=0;T<b;T++)re[m[y+T]]++;for(I=k,N=t;N>=1&&re[N]===0;N--);if(I>N&&(I=N),N===0)return v[x++]=1<<24|64<<16|0,v[x++]=1<<24|64<<16|0,S.bits=1,0;for(A=1;A<N&&re[A]===0;A++);for(I<A&&(I=A),D=1,C=1;C<=t;C++)if(D<<=1,D-=re[C],D<0)return-1;if(D>0&&(h===s||N!==1))return-1;for(pe[1]=0,C=1;C<t;C++)pe[C+1]=pe[C]+re[C];for(T=0;T<b;T++)m[y+T]!==0&&(w[pe[m[y+T]]++]=T);if(h===s?(W=de=w,ee=19):h===i?(W=o,Q-=257,de=l,Oe-=257,ee=256):(W=c,de=u,ee=-1),P=0,T=0,C=A,te=x,O=I,B=0,V=-1,H=1<<I,L=H-1,h===i&&H>n||h===a&&H>r)return 1;for(;;){Fe=C-B,w[T]<ee?(Se=0,Ce=w[T]):w[T]>ee?(Se=de[Oe+w[T]],Ce=W[Q+w[T]]):(Se=96,Ce=0),K=1<<C-B,U=1<<O,A=U;do U-=K,v[te+(P>>B)+U]=Fe<<24|Se<<16|Ce|0;while(U!==0);for(K=1<<C-1;P&K;)K>>=1;if(K!==0?(P&=K-1,P+=K):P=0,T++,--re[C]===0){if(C===N)break;C=m[y+w[T]]}if(C>I&&(P&L)!==V){for(B===0&&(B=I),te+=A,O=C-B,D=1<<O;O+B<N&&(D-=re[O+B],!(D<=0));)O++,D<<=1;if(H+=1<<O,h===i&&H>n||h===a&&H>r)return 1;V=P&L,v[V]=I<<24|O<<16|te-x|0}}return P!==0&&(v[te+P]=C-B<<24|64<<16|0),S.bits=I,0},ZM}var tz;function GCe(){if(tz)return jl;tz=1;var e=ap(),t=DY(),n=FY(),r=WCe(),s=HCe(),i=0,a=1,o=2,l=4,c=5,u=6,d=0,h=1,m=2,y=-2,b=-3,v=-4,x=-5,w=8,S=1,k=2,C=3,T=4,A=5,N=6,I=7,O=8,B=9,D=10,H=11,P=12,K=13,U=14,V=15,L=16,te=17,W=18,Q=19,ee=20,re=21,pe=22,de=23,Oe=24,Fe=25,Se=26,Ce=27,qe=28,Qe=29,We=30,je=31,Y=32,ye=852,Ie=592,ce=15,oe=ce;function se(ge){return(ge>>>24&255)+(ge>>>8&65280)+((ge&65280)<<8)+((ge&255)<<24)}function Me(){this.mode=0,this.last=!1,this.wrap=0,this.havedict=!1,this.flags=0,this.dmax=0,this.check=0,this.total=0,this.head=null,this.wbits=0,this.wsize=0,this.whave=0,this.wnext=0,this.window=null,this.hold=0,this.bits=0,this.length=0,this.offset=0,this.extra=0,this.lencode=null,this.distcode=null,this.lenbits=0,this.distbits=0,this.ncode=0,this.nlen=0,this.ndist=0,this.have=0,this.next=null,this.lens=new e.Buf16(320),this.work=new e.Buf16(288),this.lendyn=null,this.distdyn=null,this.sane=0,this.back=0,this.was=0}function Be(ge){var Ee;return!ge||!ge.state?y:(Ee=ge.state,ge.total_in=ge.total_out=Ee.total=0,ge.msg="",Ee.wrap&&(ge.adler=Ee.wrap&1),Ee.mode=S,Ee.last=0,Ee.havedict=0,Ee.dmax=32768,Ee.head=null,Ee.hold=0,Ee.bits=0,Ee.lencode=Ee.lendyn=new e.Buf32(ye),Ee.distcode=Ee.distdyn=new e.Buf32(Ie),Ee.sane=1,Ee.back=-1,d)}function Ae(ge){var Ee;return!ge||!ge.state?y:(Ee=ge.state,Ee.wsize=0,Ee.whave=0,Ee.wnext=0,Be(ge))}function lt(ge,Ee){var le,ft;return!ge||!ge.state||(ft=ge.state,Ee<0?(le=0,Ee=-Ee):(le=(Ee>>4)+1,Ee<48&&(Ee&=15)),Ee&&(Ee<8||Ee>15))?y:(ft.window!==null&&ft.wbits!==Ee&&(ft.window=null),ft.wrap=le,ft.wbits=Ee,Ae(ge))}function Tt(ge,Ee){var le,ft;return ge?(ft=new Me,ge.state=ft,ft.window=null,le=lt(ge,Ee),le!==d&&(ge.state=null),le):y}function dt(ge){return Tt(ge,oe)}var Pt=!0,qt,Ft;function Ht(ge){if(Pt){var Ee;for(qt=new e.Buf32(512),Ft=new e.Buf32(32),Ee=0;Ee<144;)ge.lens[Ee++]=8;for(;Ee<256;)ge.lens[Ee++]=9;for(;Ee<280;)ge.lens[Ee++]=7;for(;Ee<288;)ge.lens[Ee++]=8;for(s(a,ge.lens,0,288,qt,0,ge.work,{bits:9}),Ee=0;Ee<32;)ge.lens[Ee++]=5;s(o,ge.lens,0,32,Ft,0,ge.work,{bits:5}),Pt=!1}ge.lencode=qt,ge.lenbits=9,ge.distcode=Ft,ge.distbits=5}function we(ge,Ee,le,ft){var et,$=ge.state;return $.window===null&&($.wsize=1<<$.wbits,$.wnext=0,$.whave=0,$.window=new e.Buf8($.wsize)),ft>=$.wsize?(e.arraySet($.window,Ee,le-$.wsize,$.wsize,0),$.wnext=0,$.whave=$.wsize):(et=$.wsize-$.wnext,et>ft&&(et=ft),e.arraySet($.window,Ee,le-ft,et,$.wnext),ft-=et,ft?(e.arraySet($.window,Ee,le-ft,ft,0),$.wnext=ft,$.whave=$.wsize):($.wnext+=et,$.wnext===$.wsize&&($.wnext=0),$.whave<$.wsize&&($.whave+=et))),0}function F(ge,Ee){var le,ft,et,$,Ue,tt,ve,_e,ze,Ct,fe,Z,G,J,xe=0,De,He,wt,Qt,On,Zt,nn,fn,br=new e.Buf8(4),Mr,rs,ss=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15];if(!ge||!ge.state||!ge.output||!ge.input&&ge.avail_in!==0)return y;le=ge.state,le.mode===P&&(le.mode=K),Ue=ge.next_out,et=ge.output,ve=ge.avail_out,$=ge.next_in,ft=ge.input,tt=ge.avail_in,_e=le.hold,ze=le.bits,Ct=tt,fe=ve,fn=d;e:for(;;)switch(le.mode){case S:if(le.wrap===0){le.mode=K;break}for(;ze<16;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}if(le.wrap&2&&_e===35615){le.check=0,br[0]=_e&255,br[1]=_e>>>8&255,le.check=n(le.check,br,2,0),_e=0,ze=0,le.mode=k;break}if(le.flags=0,le.head&&(le.head.done=!1),!(le.wrap&1)||(((_e&255)<<8)+(_e>>8))%31){ge.msg="incorrect header check",le.mode=We;break}if((_e&15)!==w){ge.msg="unknown compression method",le.mode=We;break}if(_e>>>=4,ze-=4,nn=(_e&15)+8,le.wbits===0)le.wbits=nn;else if(nn>le.wbits){ge.msg="invalid window size",le.mode=We;break}le.dmax=1<<nn,ge.adler=le.check=1,le.mode=_e&512?D:P,_e=0,ze=0;break;case k:for(;ze<16;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}if(le.flags=_e,(le.flags&255)!==w){ge.msg="unknown compression method",le.mode=We;break}if(le.flags&57344){ge.msg="unknown header flags set",le.mode=We;break}le.head&&(le.head.text=_e>>8&1),le.flags&512&&(br[0]=_e&255,br[1]=_e>>>8&255,le.check=n(le.check,br,2,0)),_e=0,ze=0,le.mode=C;case C:for(;ze<32;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}le.head&&(le.head.time=_e),le.flags&512&&(br[0]=_e&255,br[1]=_e>>>8&255,br[2]=_e>>>16&255,br[3]=_e>>>24&255,le.check=n(le.check,br,4,0)),_e=0,ze=0,le.mode=T;case T:for(;ze<16;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}le.head&&(le.head.xflags=_e&255,le.head.os=_e>>8),le.flags&512&&(br[0]=_e&255,br[1]=_e>>>8&255,le.check=n(le.check,br,2,0)),_e=0,ze=0,le.mode=A;case A:if(le.flags&1024){for(;ze<16;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}le.length=_e,le.head&&(le.head.extra_len=_e),le.flags&512&&(br[0]=_e&255,br[1]=_e>>>8&255,le.check=n(le.check,br,2,0)),_e=0,ze=0}else le.head&&(le.head.extra=null);le.mode=N;case N:if(le.flags&1024&&(Z=le.length,Z>tt&&(Z=tt),Z&&(le.head&&(nn=le.head.extra_len-le.length,le.head.extra||(le.head.extra=new Array(le.head.extra_len)),e.arraySet(le.head.extra,ft,$,Z,nn)),le.flags&512&&(le.check=n(le.check,ft,Z,$)),tt-=Z,$+=Z,le.length-=Z),le.length))break e;le.length=0,le.mode=I;case I:if(le.flags&2048){if(tt===0)break e;Z=0;do nn=ft[$+Z++],le.head&&nn&&le.length<65536&&(le.head.name+=String.fromCharCode(nn));while(nn&&Z<tt);if(le.flags&512&&(le.check=n(le.check,ft,Z,$)),tt-=Z,$+=Z,nn)break e}else le.head&&(le.head.name=null);le.length=0,le.mode=O;case O:if(le.flags&4096){if(tt===0)break e;Z=0;do nn=ft[$+Z++],le.head&&nn&&le.length<65536&&(le.head.comment+=String.fromCharCode(nn));while(nn&&Z<tt);if(le.flags&512&&(le.check=n(le.check,ft,Z,$)),tt-=Z,$+=Z,nn)break e}else le.head&&(le.head.comment=null);le.mode=B;case B:if(le.flags&512){for(;ze<16;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}if(_e!==(le.check&65535)){ge.msg="header crc mismatch",le.mode=We;break}_e=0,ze=0}le.head&&(le.head.hcrc=le.flags>>9&1,le.head.done=!0),ge.adler=le.check=0,le.mode=P;break;case D:for(;ze<32;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}ge.adler=le.check=se(_e),_e=0,ze=0,le.mode=H;case H:if(le.havedict===0)return ge.next_out=Ue,ge.avail_out=ve,ge.next_in=$,ge.avail_in=tt,le.hold=_e,le.bits=ze,m;ge.adler=le.check=1,le.mode=P;case P:if(Ee===c||Ee===u)break e;case K:if(le.last){_e>>>=ze&7,ze-=ze&7,le.mode=Ce;break}for(;ze<3;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}switch(le.last=_e&1,_e>>>=1,ze-=1,_e&3){case 0:le.mode=U;break;case 1:if(Ht(le),le.mode=ee,Ee===u){_e>>>=2,ze-=2;break e}break;case 2:le.mode=te;break;case 3:ge.msg="invalid block type",le.mode=We}_e>>>=2,ze-=2;break;case U:for(_e>>>=ze&7,ze-=ze&7;ze<32;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}if((_e&65535)!==(_e>>>16^65535)){ge.msg="invalid stored block lengths",le.mode=We;break}if(le.length=_e&65535,_e=0,ze=0,le.mode=V,Ee===u)break e;case V:le.mode=L;case L:if(Z=le.length,Z){if(Z>tt&&(Z=tt),Z>ve&&(Z=ve),Z===0)break e;e.arraySet(et,ft,$,Z,Ue),tt-=Z,$+=Z,ve-=Z,Ue+=Z,le.length-=Z;break}le.mode=P;break;case te:for(;ze<14;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}if(le.nlen=(_e&31)+257,_e>>>=5,ze-=5,le.ndist=(_e&31)+1,_e>>>=5,ze-=5,le.ncode=(_e&15)+4,_e>>>=4,ze-=4,le.nlen>286||le.ndist>30){ge.msg="too many length or distance symbols",le.mode=We;break}le.have=0,le.mode=W;case W:for(;le.have<le.ncode;){for(;ze<3;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}le.lens[ss[le.have++]]=_e&7,_e>>>=3,ze-=3}for(;le.have<19;)le.lens[ss[le.have++]]=0;if(le.lencode=le.lendyn,le.lenbits=7,Mr={bits:le.lenbits},fn=s(i,le.lens,0,19,le.lencode,0,le.work,Mr),le.lenbits=Mr.bits,fn){ge.msg="invalid code lengths set",le.mode=We;break}le.have=0,le.mode=Q;case Q:for(;le.have<le.nlen+le.ndist;){for(;xe=le.lencode[_e&(1<<le.lenbits)-1],De=xe>>>24,He=xe>>>16&255,wt=xe&65535,!(De<=ze);){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}if(wt<16)_e>>>=De,ze-=De,le.lens[le.have++]=wt;else{if(wt===16){for(rs=De+2;ze<rs;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}if(_e>>>=De,ze-=De,le.have===0){ge.msg="invalid bit length repeat",le.mode=We;break}nn=le.lens[le.have-1],Z=3+(_e&3),_e>>>=2,ze-=2}else if(wt===17){for(rs=De+3;ze<rs;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}_e>>>=De,ze-=De,nn=0,Z=3+(_e&7),_e>>>=3,ze-=3}else{for(rs=De+7;ze<rs;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}_e>>>=De,ze-=De,nn=0,Z=11+(_e&127),_e>>>=7,ze-=7}if(le.have+Z>le.nlen+le.ndist){ge.msg="invalid bit length repeat",le.mode=We;break}for(;Z--;)le.lens[le.have++]=nn}}if(le.mode===We)break;if(le.lens[256]===0){ge.msg="invalid code -- missing end-of-block",le.mode=We;break}if(le.lenbits=9,Mr={bits:le.lenbits},fn=s(a,le.lens,0,le.nlen,le.lencode,0,le.work,Mr),le.lenbits=Mr.bits,fn){ge.msg="invalid literal/lengths set",le.mode=We;break}if(le.distbits=6,le.distcode=le.distdyn,Mr={bits:le.distbits},fn=s(o,le.lens,le.nlen,le.ndist,le.distcode,0,le.work,Mr),le.distbits=Mr.bits,fn){ge.msg="invalid distances set",le.mode=We;break}if(le.mode=ee,Ee===u)break e;case ee:le.mode=re;case re:if(tt>=6&&ve>=258){ge.next_out=Ue,ge.avail_out=ve,ge.next_in=$,ge.avail_in=tt,le.hold=_e,le.bits=ze,r(ge,fe),Ue=ge.next_out,et=ge.output,ve=ge.avail_out,$=ge.next_in,ft=ge.input,tt=ge.avail_in,_e=le.hold,ze=le.bits,le.mode===P&&(le.back=-1);break}for(le.back=0;xe=le.lencode[_e&(1<<le.lenbits)-1],De=xe>>>24,He=xe>>>16&255,wt=xe&65535,!(De<=ze);){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}if(He&&(He&240)===0){for(Qt=De,On=He,Zt=wt;xe=le.lencode[Zt+((_e&(1<<Qt+On)-1)>>Qt)],De=xe>>>24,He=xe>>>16&255,wt=xe&65535,!(Qt+De<=ze);){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}_e>>>=Qt,ze-=Qt,le.back+=Qt}if(_e>>>=De,ze-=De,le.back+=De,le.length=wt,He===0){le.mode=Se;break}if(He&32){le.back=-1,le.mode=P;break}if(He&64){ge.msg="invalid literal/length code",le.mode=We;break}le.extra=He&15,le.mode=pe;case pe:if(le.extra){for(rs=le.extra;ze<rs;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}le.length+=_e&(1<<le.extra)-1,_e>>>=le.extra,ze-=le.extra,le.back+=le.extra}le.was=le.length,le.mode=de;case de:for(;xe=le.distcode[_e&(1<<le.distbits)-1],De=xe>>>24,He=xe>>>16&255,wt=xe&65535,!(De<=ze);){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}if((He&240)===0){for(Qt=De,On=He,Zt=wt;xe=le.distcode[Zt+((_e&(1<<Qt+On)-1)>>Qt)],De=xe>>>24,He=xe>>>16&255,wt=xe&65535,!(Qt+De<=ze);){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}_e>>>=Qt,ze-=Qt,le.back+=Qt}if(_e>>>=De,ze-=De,le.back+=De,He&64){ge.msg="invalid distance code",le.mode=We;break}le.offset=wt,le.extra=He&15,le.mode=Oe;case Oe:if(le.extra){for(rs=le.extra;ze<rs;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}le.offset+=_e&(1<<le.extra)-1,_e>>>=le.extra,ze-=le.extra,le.back+=le.extra}if(le.offset>le.dmax){ge.msg="invalid distance too far back",le.mode=We;break}le.mode=Fe;case Fe:if(ve===0)break e;if(Z=fe-ve,le.offset>Z){if(Z=le.offset-Z,Z>le.whave&&le.sane){ge.msg="invalid distance too far back",le.mode=We;break}Z>le.wnext?(Z-=le.wnext,G=le.wsize-Z):G=le.wnext-Z,Z>le.length&&(Z=le.length),J=le.window}else J=et,G=Ue-le.offset,Z=le.length;Z>ve&&(Z=ve),ve-=Z,le.length-=Z;do et[Ue++]=J[G++];while(--Z);le.length===0&&(le.mode=re);break;case Se:if(ve===0)break e;et[Ue++]=le.length,ve--,le.mode=re;break;case Ce:if(le.wrap){for(;ze<32;){if(tt===0)break e;tt--,_e|=ft[$++]<<ze,ze+=8}if(fe-=ve,ge.total_out+=fe,le.total+=fe,fe&&(ge.adler=le.check=le.flags?n(le.check,et,fe,Ue-fe):t(le.check,et,fe,Ue-fe)),fe=ve,(le.flags?_e:se(_e))!==le.check){ge.msg="incorrect data check",le.mode=We;break}_e=0,ze=0}le.mode=qe;case qe:if(le.wrap&&le.flags){for(;ze<32;){if(tt===0)break e;tt--,_e+=ft[$++]<<ze,ze+=8}if(_e!==(le.total&4294967295)){ge.msg="incorrect length check",le.mode=We;break}_e=0,ze=0}le.mode=Qe;case Qe:fn=h;break e;case We:fn=b;break e;case je:return v;case Y:default:return y}return ge.next_out=Ue,ge.avail_out=ve,ge.next_in=$,ge.avail_in=tt,le.hold=_e,le.bits=ze,(le.wsize||fe!==ge.avail_out&&le.mode<We&&(le.mode<Ce||Ee!==l))&&we(ge,ge.output,ge.next_out,fe-ge.avail_out),Ct-=ge.avail_in,fe-=ge.avail_out,ge.total_in+=Ct,ge.total_out+=fe,le.total+=fe,le.wrap&&fe&&(ge.adler=le.check=le.flags?n(le.check,et,fe,ge.next_out-fe):t(le.check,et,fe,ge.next_out-fe)),ge.data_type=le.bits+(le.last?64:0)+(le.mode===P?128:0)+(le.mode===ee||le.mode===V?256:0),(Ct===0&&fe===0||Ee===l)&&fn===d&&(fn=x),fn}function X(ge){if(!ge||!ge.state)return y;var Ee=ge.state;return Ee.window&&(Ee.window=null),ge.state=null,d}function be(ge,Ee){var le;return!ge||!ge.state||(le=ge.state,(le.wrap&2)===0)?y:(le.head=Ee,Ee.done=!1,d)}function ke(ge,Ee){var le=Ee.length,ft,et,$;return!ge||!ge.state||(ft=ge.state,ft.wrap!==0&&ft.mode!==H)?y:ft.mode===H&&(et=1,et=t(et,Ee,le,0),et!==ft.check)?b:($=we(ge,Ee,le,le),$?(ft.mode=je,v):(ft.havedict=1,d))}return jl.inflateReset=Ae,jl.inflateReset2=lt,jl.inflateResetKeep=Be,jl.inflateInit=dt,jl.inflateInit2=Tt,jl.inflate=F,jl.inflateEnd=X,jl.inflateGetHeader=be,jl.inflateSetDictionary=ke,jl.inflateInfo="pako inflate (from Nodeca project)",jl}var XM,nz;function $Y(){return nz||(nz=1,XM={Z_NO_FLUSH:0,Z_PARTIAL_FLUSH:1,Z_SYNC_FLUSH:2,Z_FULL_FLUSH:3,Z_FINISH:4,Z_BLOCK:5,Z_TREES:6,Z_OK:0,Z_STREAM_END:1,Z_NEED_DICT:2,Z_ERRNO:-1,Z_STREAM_ERROR:-2,Z_DATA_ERROR:-3,Z_BUF_ERROR:-5,Z_NO_COMPRESSION:0,Z_BEST_SPEED:1,Z_BEST_COMPRESSION:9,Z_DEFAULT_COMPRESSION:-1,Z_FILTERED:1,Z_HUFFMAN_ONLY:2,Z_RLE:3,Z_FIXED:4,Z_DEFAULT_STRATEGY:0,Z_BINARY:0,Z_TEXT:1,Z_UNKNOWN:2,Z_DEFLATED:8}),XM}var JM,rz;function KCe(){if(rz)return JM;rz=1;function e(){this.text=0,this.time=0,this.xflags=0,this.os=0,this.extra=null,this.extra_len=0,this.name="",this.comment="",this.hcrc=0,this.done=!1}return JM=e,JM}var sz;function YCe(){if(sz)return s0;sz=1;var e=GCe(),t=ap(),n=LY(),r=$Y(),s=hD(),i=BY(),a=KCe(),o=Object.prototype.toString;function l(d){if(!(this instanceof l))return new l(d);this.options=t.assign({chunkSize:16384,windowBits:0,to:""},d||{});var h=this.options;h.raw&&h.windowBits>=0&&h.windowBits<16&&(h.windowBits=-h.windowBits,h.windowBits===0&&(h.windowBits=-15)),h.windowBits>=0&&h.windowBits<16&&!(d&&d.windowBits)&&(h.windowBits+=32),h.windowBits>15&&h.windowBits<48&&(h.windowBits&15)===0&&(h.windowBits|=15),this.err=0,this.msg="",this.ended=!1,this.chunks=[],this.strm=new i,this.strm.avail_out=0;var m=e.inflateInit2(this.strm,h.windowBits);if(m!==r.Z_OK)throw new Error(s[m]);if(this.header=new a,e.inflateGetHeader(this.strm,this.header),h.dictionary&&(typeof h.dictionary=="string"?h.dictionary=n.string2buf(h.dictionary):o.call(h.dictionary)==="[object ArrayBuffer]"&&(h.dictionary=new Uint8Array(h.dictionary)),h.raw&&(m=e.inflateSetDictionary(this.strm,h.dictionary),m!==r.Z_OK)))throw new Error(s[m])}l.prototype.push=function(d,h){var m=this.strm,y=this.options.chunkSize,b=this.options.dictionary,v,x,w,S,k,C=!1;if(this.ended)return!1;x=h===~~h?h:h===!0?r.Z_FINISH:r.Z_NO_FLUSH,typeof d=="string"?m.input=n.binstring2buf(d):o.call(d)==="[object ArrayBuffer]"?m.input=new Uint8Array(d):m.input=d,m.next_in=0,m.avail_in=m.input.length;do{if(m.avail_out===0&&(m.output=new t.Buf8(y),m.next_out=0,m.avail_out=y),v=e.inflate(m,r.Z_NO_FLUSH),v===r.Z_NEED_DICT&&b&&(v=e.inflateSetDictionary(this.strm,b)),v===r.Z_BUF_ERROR&&C===!0&&(v=r.Z_OK,C=!1),v!==r.Z_STREAM_END&&v!==r.Z_OK)return this.onEnd(v),this.ended=!0,!1;m.next_out&&(m.avail_out===0||v===r.Z_STREAM_END||m.avail_in===0&&(x===r.Z_FINISH||x===r.Z_SYNC_FLUSH))&&(this.options.to==="string"?(w=n.utf8border(m.output,m.next_out),S=m.next_out-w,k=n.buf2string(m.output,w),m.next_out=S,m.avail_out=y-S,S&&t.arraySet(m.output,m.output,w,S,0),this.onData(k)):this.onData(t.shrinkBuf(m.output,m.next_out))),m.avail_in===0&&m.avail_out===0&&(C=!0)}while((m.avail_in>0||m.avail_out===0)&&v!==r.Z_STREAM_END);return v===r.Z_STREAM_END&&(x=r.Z_FINISH),x===r.Z_FINISH?(v=e.inflateEnd(this.strm),this.onEnd(v),this.ended=!0,v===r.Z_OK):(x===r.Z_SYNC_FLUSH&&(this.onEnd(r.Z_OK),m.avail_out=0),!0)},l.prototype.onData=function(d){this.chunks.push(d)},l.prototype.onEnd=function(d){d===r.Z_OK&&(this.options.to==="string"?this.result=this.chunks.join(""):this.result=t.flattenChunks(this.chunks)),this.chunks=[],this.err=d,this.msg=this.strm.msg};function c(d,h){var m=new l(h);if(m.push(d,!0),m.err)throw m.msg||s[m.err];return m.result}function u(d,h){return h=h||{},h.raw=!0,c(d,h)}return s0.Inflate=l,s0.inflate=c,s0.inflateRaw=u,s0.ungzip=c,s0}var QM,iz;function ZCe(){if(iz)return QM;iz=1;var e=ap().assign,t=VCe(),n=YCe(),r=$Y(),s={};return e(s,t,n,r),QM=s,QM}var XCe=ZCe();const pD=da(XCe);var eI,az;function JCe(){if(az)return eI;az=1;const e=(t,n)=>function(...r){const s=n.promiseModule;return new s((i,a)=>{n.multiArgs?r.push((...o)=>{n.errorFirst?o[0]?a(o):(o.shift(),i(o)):i(o)}):n.errorFirst?r.push((o,l)=>{o?a(o):i(l)}):r.push(i),t.apply(this,r)})};return eI=(t,n)=>{n=Object.assign({exclude:[/.+(Sync|Stream)$/],errorFirst:!0,promiseModule:Promise},n);const r=typeof t;if(!(t!==null&&(r==="object"||r==="function")))throw new TypeError(`Expected \`input\` to be a \`Function\` or \`Object\`, got \`${t===null?"null":r}\``);const s=a=>{const o=l=>typeof l=="string"?a===l:l.test(a);return n.include?n.include.some(o):!n.exclude.some(o)};let i;r==="function"?i=function(...a){return n.excludeMain?t(...a):e(t,n).apply(this,a)}:i=Object.create(Object.getPrototypeOf(t));for(const a in t){const o=t[a];i[a]=typeof o=="function"&&s(a)?e(o,n):o}return i},eI}var QCe=JCe();const tI=da(QCe);var nI,oz;function e2e(){if(oz)return nI;oz=1;var e={};function t(V){return Array.isArray(V)?V:[V]}const n="",r=" ",s="\\",i=/^\s+$/,a=/(?:[^\\]|^)\\$/,o=/^\\!/,l=/^\\#/,c=/\r?\n/g,u=/^\.*\/|^\.+$/,d="/";let h="node-ignore";typeof Symbol<"u"&&(h=Symbol.for("node-ignore"));const m=h,y=(V,L,te)=>Object.defineProperty(V,L,{value:te}),b=/([0-z])-([0-z])/g,v=()=>!1,x=V=>V.replace(b,(L,te,W)=>te.charCodeAt(0)<=W.charCodeAt(0)?L:n),w=V=>{const{length:L}=V;return V.slice(0,L-L%2)},S=[[/^\uFEFF/,()=>n],[/((?:\\\\)*?)(\\?\s+)$/,(V,L,te)=>L+(te.indexOf("\\")===0?r:n)],[/(\\+?)\s/g,(V,L)=>{const{length:te}=L;return L.slice(0,te-te%2)+r}],[/[\\$.|*+(){^]/g,V=>`\\${V}`],[/(?!\\)\?/g,()=>"[^/]"],[/^\//,()=>"^"],[/\//g,()=>"\\/"],[/^\^*\\\*\\\*\\\//,()=>"^(?:.*\\/)?"],[/^(?=[^^])/,function(){return/\/(?!$)/.test(this)?"^":"(?:^|\\/)"}],[/\\\/\\\*\\\*(?=\\\/|$)/g,(V,L,te)=>L+6<te.length?"(?:\\/[^\\/]+)*":"\\/.+"],[/(^|[^\\]+)(\\\*)+(?=.+)/g,(V,L,te)=>{const W=te.replace(/\\\*/g,"[^\\/]*");return L+W}],[/\\\\\\(?=[$.|*+(){^])/g,()=>s],[/\\\\/g,()=>s],[/(\\)?\[([^\]/]*?)(\\*)($|\])/g,(V,L,te,W,Q)=>L===s?`\\[${te}${w(W)}${Q}`:Q==="]"&&W.length%2===0?`[${x(te)}${W}]`:"[]"],[/(?:[^*])$/,V=>/\/$/.test(V)?`${V}$`:`${V}(?=$|\\/$)`],[/(\^|\\\/)?\\\*$/,(V,L)=>`${L?`${L}[^/]+`:"[^/]*"}(?=$|\\/$)`]],k=Object.create(null),C=(V,L)=>{let te=k[V];return te||(te=S.reduce((W,[Q,ee])=>W.replace(Q,ee.bind(V)),V),k[V]=te),L?new RegExp(te,"i"):new RegExp(te)},T=V=>typeof V=="string",A=V=>V&&T(V)&&!i.test(V)&&!a.test(V)&&V.indexOf("#")!==0,N=V=>V.split(c);class I{constructor(L,te,W,Q){this.origin=L,this.pattern=te,this.negative=W,this.regex=Q}}const O=(V,L)=>{const te=V;let W=!1;V.indexOf("!")===0&&(W=!0,V=V.substr(1)),V=V.replace(o,"!").replace(l,"#");const Q=C(V,L);return new I(te,V,W,Q)},B=(V,L)=>{throw new L(V)},D=(V,L,te)=>T(V)?V?D.isNotRelative(V)?te(`path should be a \`path.relative()\`d string, but got "${L}"`,RangeError):!0:te("path must not be empty",TypeError):te(`path must be a string, but got \`${L}\``,TypeError),H=V=>u.test(V);D.isNotRelative=H,D.convert=V=>V;class P{constructor({ignorecase:L=!0,ignoreCase:te=L,allowRelativePaths:W=!1}={}){y(this,m,!0),this._rules=[],this._ignoreCase=te,this._allowRelativePaths=W,this._initCache()}_initCache(){this._ignoreCache=Object.create(null),this._testCache=Object.create(null)}_addPattern(L){if(L&&L[m]){this._rules=this._rules.concat(L._rules),this._added=!0;return}if(A(L)){const te=O(L,this._ignoreCase);this._added=!0,this._rules.push(te)}}add(L){return this._added=!1,t(T(L)?N(L):L).forEach(this._addPattern,this),this._added&&this._initCache(),this}addPattern(L){return this.add(L)}_testOne(L,te){let W=!1,Q=!1;return this._rules.forEach(ee=>{const{negative:re}=ee;if(Q===re&&W!==Q||re&&!W&&!Q&&!te)return;ee.regex.test(L)&&(W=!re,Q=re)}),{ignored:W,unignored:Q}}_test(L,te,W,Q){const ee=L&&D.convert(L);return D(ee,L,this._allowRelativePaths?v:B),this._t(ee,te,W,Q)}_t(L,te,W,Q){if(L in te)return te[L];if(Q||(Q=L.split(d)),Q.pop(),!Q.length)return te[L]=this._testOne(L,W);const ee=this._t(Q.join(d)+d,te,W,Q);return te[L]=ee.ignored?ee:this._testOne(L,W)}ignores(L){return this._test(L,this._ignoreCache,!1).ignored}createFilter(){return L=>!this.ignores(L)}filter(L){return t(L).filter(this.createFilter())}test(L){return this._test(L,this._testCache,!0)}}const K=V=>new P(V),U=V=>D(V&&D.convert(V),V,v);if(K.isPathValid=U,K.default=K,nI=K,typeof Mi<"u"&&(e&&e.IGNORE_TEST_WIN32||Mi.platform==="win32")){const V=te=>/^\\\\\?\\/.test(te)||/["<>|\u0000-\u001F]+/u.test(te)?te:te.replace(/\\/g,"/");D.convert=V;const L=/^[a-z]:\//i;D.isNotRelative=te=>L.test(te)||H(te)}return nI}var t2e=e2e();const n2e=da(t2e);var rI,lz;function r2e(){if(lz)return rI;lz=1;function e(r){return r.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")}function t(r,s,i){return s=s instanceof RegExp?s:new RegExp(e(s),"g"),r.replace(s,i)}var n={clean:function(s){if(typeof s!="string")throw new Error("Expected a string, received: "+s);return s=t(s,"./","/"),s=t(s,"..","."),s=t(s," ","-"),s=t(s,/^[~^:?*\\\-]/g,""),s=t(s,/[~^:?*\\]/g,"-"),s=t(s,/[~^:?*\\\-]$/g,""),s=t(s,"@{","-"),s=t(s,/\.$/g,""),s=t(s,/\/$/g,""),s=t(s,/\.lock$/g,""),s}};return rI=n,rI}var s2e=r2e();const wu=da(s2e);var sI,cz;function i2e(){return cz||(cz=1,sI=function(e,t){var n=e,r=t,s=n.length,i=r.length,a=!1,o=null,l=s+1,c=[],u=[],d=[],h="",m=-1,y=0,b=1,v,x,w=function(){s>=i&&(v=n,x=s,n=r,r=v,s=i,i=x,a=!0,l=s+1)},S=function(A,N,I){return{x:A,y:N,k:I}},k=function(A,N){return{elem:A,t:N}},C=function(A,N,I){var O,B,D;for(N>I?O=c[A-1+l]:O=c[A+1+l],D=Math.max(N,I),B=D-A;B<s&&D<i&&n[B]===r[D];)++B,++D;return c[A+l]=u.length,u[u.length]=new S(B,D,O),D},T=function(A){var N,I,O;for(N=I=0,O=A.length-1;O>=0;--O)for(;N<A[O].x||I<A[O].y;)A[O].y-A[O].x>I-N?(a?d[d.length]=new k(r[I],m):d[d.length]=new k(r[I],b),++I):A[O].y-A[O].x<I-N?(a?d[d.length]=new k(n[N],b):d[d.length]=new k(n[N],m),++N):(d[d.length]=new k(n[N],y),h+=n[N],++N,++I)};return w(),{SES_DELETE:-1,SES_COMMON:0,SES_ADD:1,editdistance:function(){return o},getlcs:function(){return h},getses:function(){return d},compose:function(){var A,N,I,O,B,D,H,P;for(A=i-s,N=s+i+3,I={},H=0;H<N;++H)I[H]=-1,c[H]=-1;O=-1;do{for(++O,P=-O;P<=A-1;++P)I[P+l]=C(P,I[P-1+l]+1,I[P+1+l]);for(P=A+O;P>=A+1;--P)I[P+l]=C(P,I[P-1+l]+1,I[P+1+l]);I[A+l]=C(A,I[A-1+l]+1,I[A+1+l])}while(I[A+l]!==i);for(o=A+2*O,B=c[A+l],D=[];B!==-1;)D[D.length]=new S(u[B].x,u[B].y,null),B=u[B].k;T(D)}}}),sI}var iI,uz;function a2e(){if(uz)return iI;uz=1;var e=i2e();function t(i,a){var o=new e(i,a);o.compose();for(var l=o.getses(),c,u,d=i.length-1,h=a.length-1,m=l.length-1;m>=0;--m)l[m].t===o.SES_COMMON?(u?(u.chain={file1index:d,file2index:h,chain:null},u=u.chain):(c={file1index:d,file2index:h,chain:null},u=c),d--,h--):l[m].t===o.SES_DELETE?d--:l[m].t===o.SES_ADD&&h--;var y={file1index:-1,file2index:-1,chain:null};return u?(u.chain=y,c):y}function n(i,a){for(var o=[],l=i.length,c=a.length,u=t(i,a);u!==null;u=u.chain){var d=l-u.file1index-1,h=c-u.file2index-1;l=u.file1index,c=u.file2index,(d||h)&&o.push({file1:[l+1,d],file2:[c+1,h]})}return o.reverse(),o}function r(i,a,o){var l,c=n(a,i),u=n(a,o),d=[];function h(L,te){d.push([L.file1[0],te,L.file1[1],L.file2[0],L.file2[1]])}for(l=0;l<c.length;l++)h(c[l],0);for(l=0;l<u.length;l++)h(u[l],2);d.sort(function(L,te){return L[0]-te[0]});var m=[],y=0;function b(L){L>y&&(m.push([1,y,L-y]),y=L)}for(var v=0;v<d.length;v++){for(var x=v,w=d[v],S=w[0],k=S+w[2];v<d.length-1;){var C=d[v+1],T=C[0];if(T>k)break;k=Math.max(k,T+C[2]),v++}if(b(S),x==v)w[4]>0&&m.push([w[1],w[3],w[4]]);else{var A={0:[i.length,-1,a.length,-1],2:[o.length,-1,a.length,-1]};for(l=x;l<=v;l++){w=d[l];var N=w[1],I=A[N],O=w[0],B=O+w[2],D=w[3],H=D+w[4];I[0]=Math.min(D,I[0]),I[1]=Math.max(H,I[1]),I[2]=Math.min(O,I[2]),I[3]=Math.max(B,I[3])}var P=A[0][0]+(S-A[0][2]),K=A[0][1]+(k-A[0][3]),U=A[2][0]+(S-A[2][2]),V=A[2][1]+(k-A[2][3]);m.push([-1,P,K-P,S,k-S,U,V-U])}y=k}return b(a.length),m}function s(i,a,o){var l=[],c=[i,a,o],u=r(i,a,o),d=[];function h(){d.length&&l.push({ok:d}),d=[]}function m(w){for(var S=0;S<w.length;S++)d.push(w[S])}function y(w){if(w[2]!=w[6])return!0;for(var S=w[1],k=w[5],C=0;C<w[2];C++)if(i[C+S]!=o[C+k])return!0;return!1}for(var b=0;b<u.length;b++){var v=u[b],x=v[0];x==-1?y(v)?(h(),l.push({conflict:{a:i.slice(v[1],v[1]+v[2]),aIndex:v[1],o:a.slice(v[3],v[3]+v[4]),oIndex:v[3],b:o.slice(v[5],v[5]+v[6]),bIndex:v[5]}})):m(c[0].slice(v[1],v[1]+v[2])):m(c[x].slice(v[1],v[1]+v[2]))}return h(),l}return iI=s,iI}var o2e=a2e();const l2e=da(o2e);class Qr extends Error{constructor(t){super(t),this.caller=""}toJSON(){return{code:this.code,data:this.data,caller:this.caller,message:this.message,stack:this.stack}}fromJSON(t){const n=new Qr(t.message);return n.code=t.code,n.data=t.data,n.caller=t.caller,n.stack=t.stack,n}get isIsomorphicGitError(){return!0}}class N1 extends Qr{constructor(t){super(`Modifying the index is not possible because you have unmerged files: ${t.toString}. Fix them up in the work tree, and then use 'git add/rm as appropriate to mark resolution and make a commit.`),this.code=this.name=N1.code,this.data={filepaths:t}}}N1.code="UnmergedPathsError";class xr extends Qr{constructor(t){super(`An internal error caused this command to fail. Please file a bug report at https://github.com/isomorphic-git/isomorphic-git/issues with this error message: ${t}`),this.code=this.name=xr.code,this.data={message:t}}}xr.code="InternalError";class ib extends Qr{constructor(t){super(`The filepath "${t}" contains unsafe character sequences`),this.code=this.name=ib.code,this.data={filepath:t}}}ib.code="UnsafeFilepathError";class bu{constructor(t){this.buffer=t,this._start=0}eof(){return this._start>=this.buffer.length}tell(){return this._start}seek(t){this._start=t}slice(t){const n=this.buffer.slice(this._start,this._start+t);return this._start+=t,n}toString(t,n){const r=this.buffer.toString(t,this._start,this._start+n);return this._start+=n,r}write(t,n,r){const s=this.buffer.write(t,this._start,n,r);return this._start+=n,s}copy(t,n,r){const s=t.copy(this.buffer,this._start,n,r);return this._start+=s,s}readUInt8(){const t=this.buffer.readUInt8(this._start);return this._start+=1,t}writeUInt8(t){const n=this.buffer.writeUInt8(t,this._start);return this._start+=1,n}readUInt16BE(){const t=this.buffer.readUInt16BE(this._start);return this._start+=2,t}writeUInt16BE(t){const n=this.buffer.writeUInt16BE(t,this._start);return this._start+=2,n}readUInt32BE(){const t=this.buffer.readUInt32BE(this._start);return this._start+=4,t}writeUInt32BE(t){const n=this.buffer.writeUInt32BE(t,this._start);return this._start+=4,n}}function lT(e,t){return-(e<t)||+(e>t)}function zY(e,t){return lT(e.path,t.path)}function UY(e){let t=e>0?e>>12:0;t!==4&&t!==8&&t!==10&&t!==14&&(t=8);let n=e&511;return n&73?n=493:n=420,t!==8&&(n=0),(t<<12)+n}const iu=2**32;function dz(e,t,n,r){if(e!==void 0&&t!==void 0)return[e,t];n===void 0&&(n=r.valueOf());const s=Math.floor(n/1e3),i=(n-s*1e3)*1e6;return[s,i]}function py(e){const[t,n]=dz(e.ctimeSeconds,e.ctimeNanoseconds,e.ctimeMs,e.ctime),[r,s]=dz(e.mtimeSeconds,e.mtimeNanoseconds,e.mtimeMs,e.mtime);return{ctimeSeconds:t%iu,ctimeNanoseconds:n%iu,mtimeSeconds:r%iu,mtimeNanoseconds:s%iu,dev:e.dev%iu,ino:e.ino%iu,mode:UY(e.mode%iu),uid:e.uid%iu,gid:e.gid%iu,size:e.size>-1?e.size%iu:0}}function c2e(e){let t="";for(const n of new Uint8Array(e))n<16&&(t+="0"),t+=n.toString(16);return t}let aI=null;async function Jd(e){return aI===null&&(aI=await d2e()),aI?qY(e):u2e(e)}function u2e(e){return new OY().update(e).digest("hex")}async function qY(e){const t=await crypto.subtle.digest("SHA-1",e);return c2e(t)}async function d2e(){try{if(await qY(new Uint8Array([]))==="da39a3ee5e6b4b0d3255bfef95601890afd80709")return!0}catch{}return!1}function f2e(e){return{assumeValid:!!(e&32768),extended:!!(e&16384),stage:(e&12288)>>12,nameLength:e&4095}}function h2e(e){const t=e.flags;return t.extended=!1,t.nameLength=Math.min(cn.from(e.path).length,4095),(t.assumeValid?32768:0)+(t.extended?16384:0)+((t.stage&3)<<12)+(t.nameLength&4095)}class rm{constructor(t,n){this._dirty=!1,this._unmergedPaths=n||new Set,this._entries=t||new Map}_addEntry(t){if(t.flags.stage===0)t.stages=[t],this._entries.set(t.path,t),this._unmergedPaths.delete(t.path);else{let n=this._entries.get(t.path);n||(this._entries.set(t.path,t),n=t),n.stages[t.flags.stage]=t,this._unmergedPaths.add(t.path)}}static async from(t){if(cn.isBuffer(t))return rm.fromBuffer(t);if(t===null)return new rm(null);throw new xr("invalid type passed to GitIndex.from")}static async fromBuffer(t){if(t.length===0)throw new xr("Index file is empty (.git/index)");const n=new rm,r=new bu(t),s=r.toString("utf8",4);if(s!=="DIRC")throw new xr(`Invalid dircache magic file number: ${s}`);const i=await Jd(t.slice(0,-20)),a=t.slice(-20).toString("hex");if(a!==i)throw new xr(`Invalid checksum in GitIndex buffer: expected ${a} but saw ${i}`);const o=r.readUInt32BE();if(o!==2)throw new xr(`Unsupported dircache version: ${o}`);const l=r.readUInt32BE();let c=0;for(;!r.eof()&&c<l;){const u={};u.ctimeSeconds=r.readUInt32BE(),u.ctimeNanoseconds=r.readUInt32BE(),u.mtimeSeconds=r.readUInt32BE(),u.mtimeNanoseconds=r.readUInt32BE(),u.dev=r.readUInt32BE(),u.ino=r.readUInt32BE(),u.mode=r.readUInt32BE(),u.uid=r.readUInt32BE(),u.gid=r.readUInt32BE(),u.size=r.readUInt32BE(),u.oid=r.slice(20).toString("hex");const d=r.readUInt16BE();u.flags=f2e(d);const h=t.indexOf(0,r.tell()+1)-r.tell();if(h<1)throw new xr(`Got a path length of: ${h}`);if(u.path=r.toString("utf8",h),u.path.includes("..\\")||u.path.includes("../"))throw new ib(u.path);let m=8-(r.tell()-12)%8;for(m===0&&(m=8);m--;){const y=r.readUInt8();if(y!==0)throw new xr(`Expected 1-8 null characters but got '${y}' after ${u.path}`);if(r.eof())throw new xr("Unexpected end of file")}u.stages=[],n._addEntry(u),c++}return n}get unmergedPaths(){return[...this._unmergedPaths]}get entries(){return[...this._entries.values()].sort(zY)}get entriesMap(){return this._entries}get entriesFlat(){return[...this.entries].flatMap(t=>t.stages.length>1?t.stages.filter(n=>n):t)}*[Symbol.iterator](){for(const t of this.entries)yield t}insert({filepath:t,stats:n,oid:r,stage:s=0}){n||(n={ctimeSeconds:0,ctimeNanoseconds:0,mtimeSeconds:0,mtimeNanoseconds:0,dev:0,ino:0,mode:0,uid:0,gid:0,size:0}),n=py(n);const i=cn.from(t),a={ctimeSeconds:n.ctimeSeconds,ctimeNanoseconds:n.ctimeNanoseconds,mtimeSeconds:n.mtimeSeconds,mtimeNanoseconds:n.mtimeNanoseconds,dev:n.dev,ino:n.ino,mode:n.mode||33188,uid:n.uid,gid:n.gid,size:n.size,path:t,oid:r,flags:{assumeValid:!1,extended:!1,stage:s,nameLength:i.length<4095?i.length:4095},stages:[]};this._addEntry(a),this._dirty=!0}delete({filepath:t}){if(this._entries.has(t))this._entries.delete(t);else for(const n of this._entries.keys())n.startsWith(t+"/")&&this._entries.delete(n);this._unmergedPaths.has(t)&&this._unmergedPaths.delete(t),this._dirty=!0}clear(){this._entries.clear(),this._dirty=!0}has({filepath:t}){return this._entries.has(t)}render(){return this.entries.map(t=>`${t.mode.toString(8)} ${t.oid}    ${t.path}`).join(`
`)}static async _entryToBuffer(t){const n=cn.from(t.path),r=Math.ceil((62+n.length+1)/8)*8,s=cn.alloc(r),i=new bu(s),a=py(t);return i.writeUInt32BE(a.ctimeSeconds),i.writeUInt32BE(a.ctimeNanoseconds),i.writeUInt32BE(a.mtimeSeconds),i.writeUInt32BE(a.mtimeNanoseconds),i.writeUInt32BE(a.dev),i.writeUInt32BE(a.ino),i.writeUInt32BE(a.mode),i.writeUInt32BE(a.uid),i.writeUInt32BE(a.gid),i.writeUInt32BE(a.size),i.write(t.oid,20,"hex"),i.writeUInt16BE(h2e(t)),i.write(t.path,n.length,"utf8"),s}async toObject(){const t=cn.alloc(12),n=new bu(t);n.write("DIRC",4,"utf8"),n.writeUInt32BE(2),n.writeUInt32BE(this.entriesFlat.length);let r=[];for(const o of this.entries)if(r.push(rm._entryToBuffer(o)),o.stages.length>1)for(const l of o.stages)l&&l!==o&&r.push(rm._entryToBuffer(l));r=await Promise.all(r);const s=cn.concat(r),i=cn.concat([t,s]),a=await Jd(i);return cn.concat([i,cn.from(a,"hex")])}}function ek(e,t,n=!0,r=!0){const s=py(e),i=py(t);return n&&s.mode!==i.mode||s.mtimeSeconds!==i.mtimeSeconds||s.ctimeSeconds!==i.ctimeSeconds||s.uid!==i.uid||s.gid!==i.gid||r&&s.ino!==i.ino||s.size!==i.size}let oI=null;const lI=Symbol("IndexCache");function p2e(){return{map:new Map,stats:new Map}}async function m2e(e,t,n){const[r,s]=await Promise.all([e.lstat(t),e.read(t)]),i=await rm.from(s);n.map.set(t,i),n.stats.set(t,r)}async function g2e(e,t,n){const r=n.stats.get(t);if(r===void 0)return!0;if(r===null)return!1;const s=await e.lstat(t);return s===null?!1:ek(r,s)}class ua{static async acquire({fs:t,gitdir:n,cache:r,allowUnmerged:s=!0},i){r[lI]||(r[lI]=p2e());const a=`${n}/index`;oI===null&&(oI=new bw({maxPending:1/0}));let o,l=[];return await oI.acquire(a,async()=>{const c=r[lI];await g2e(t,a,c)&&await m2e(t,a,c);const u=c.map.get(a);if(l=u.unmergedPaths,l.length&&!s)throw new N1(l);if(o=await i(u),u._dirty){const d=await u.toObject();await t.write(a,d),c.stats.set(a,await t.lstat(a)),u._dirty=!1}}),o}}function tk(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t>-1&&(e=e.slice(t+1)),e}function my(e){const t=Math.max(e.lastIndexOf("/"),e.lastIndexOf("\\"));return t===-1?".":t===0?"/":e.slice(0,t)}function VY(e){const t=new Map,n=function(s){if(!t.has(s)){const i={type:"tree",fullpath:s,basename:tk(s),metadata:{},children:[]};t.set(s,i),i.parent=n(my(s)),i.parent&&i.parent!==i&&i.parent.children.push(i)}return t.get(s)},r=function(s,i){if(!t.has(s)){const a={type:"blob",fullpath:s,basename:tk(s),metadata:i,parent:n(my(s)),children:[]};a.parent&&a.parent.children.push(a),t.set(s,a)}return t.get(s)};n(".");for(const s of e)r(s.path,s);return t}function y2e(e){switch(e){case 16384:return"tree";case 33188:return"blob";case 33261:return"blob";case 40960:return"blob";case 57344:return"commit"}throw new xr(`Unexpected GitTree entry mode: ${e.toString(8)}`)}class b2e{constructor({fs:t,gitdir:n,cache:r}){this.treePromise=ua.acquire({fs:t,gitdir:n,cache:r},async function(i){return VY(i.entries)});const s=this;this.ConstructEntry=class{constructor(a){this._fullpath=a,this._type=!1,this._mode=!1,this._stat=!1,this._oid=!1}async type(){return s.type(this)}async mode(){return s.mode(this)}async stat(){return s.stat(this)}async content(){return s.content(this)}async oid(){return s.oid(this)}}}async readdir(t){const n=t._fullpath,s=(await this.treePromise).get(n);if(!s||s.type==="blob")return null;if(s.type!=="tree")throw new Error(`ENOTDIR: not a directory, scandir '${n}'`);const i=s.children.map(a=>a.fullpath);return i.sort(lT),i}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const r=(await this.treePromise).get(t._fullpath);if(!r)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);const s=r.type==="tree"?{}:py(r.metadata);t._type=r.type==="tree"?"tree":y2e(s.mode),t._mode=s.mode,r.type==="tree"?t._stat=void 0:t._stat=s}return t._stat}async content(t){}async oid(t){if(t._oid===!1){const r=(await this.treePromise).get(t._fullpath);t._oid=r.metadata.oid}return t._oid}}const cT=Symbol("GitWalkSymbol");function ab(){const e=Object.create(null);return Object.defineProperty(e,cT,{value:function({fs:t,gitdir:n,cache:r}){return new b2e({fs:t,gitdir:n,cache:r})}}),Object.freeze(e),e}class As extends Qr{constructor(t){super(`Could not find ${t}.`),this.code=this.name=As.code,this.data={what:t}}}As.code="NotFoundError";class yo extends Qr{constructor(t,n,r,s){super(`Object ${t} ${s?`at ${s}`:""}was anticipated to be a ${r} but it is a ${n}.`),this.code=this.name=yo.code,this.data={oid:t,actual:n,expected:r,filepath:s}}}yo.code="ObjectTypeError";class Lh extends Qr{constructor(t){super(`Expected a 40-char hex object id but saw "${t}".`),this.code=this.name=Lh.code,this.data={value:t}}}Lh.code="InvalidOidError";class M1 extends Qr{constructor(t){super(`Could not find a fetch refspec for remote "${t}". Make sure the config file has an entry like the following:
[remote "${t}"]
	fetch = +refs/heads/*:refs/remotes/origin/*
`),this.code=this.name=M1.code,this.data={remote:t}}}M1.code="NoRefspecError";class nk{constructor(t){if(this.refs=new Map,this.parsedConfig=[],t){let n=null;this.parsedConfig=t.trim().split(`
`).map(r=>{if(/^\s*#/.test(r))return{line:r,comment:!0};const s=r.indexOf(" ");if(r.startsWith("^")){const i=r.slice(1);return this.refs.set(n+"^{}",i),{line:r,ref:n,peeled:i}}else{const i=r.slice(0,s);return n=r.slice(s+1),this.refs.set(n,i),{line:r,ref:n,oid:i}}})}return this}static from(t){return new nk(t)}delete(t){this.parsedConfig=this.parsedConfig.filter(n=>n.ref!==t),this.refs.delete(t)}toString(){return this.parsedConfig.map(({line:t})=>t).join(`
`)+`
`}}class rk{constructor({remotePath:t,localPath:n,force:r,matchPrefix:s}){Object.assign(this,{remotePath:t,localPath:n,force:r,matchPrefix:s})}static from(t){const[n,r,s,i,a]=t.match(/^(\+?)(.*?)(\*?):(.*?)(\*?)$/).slice(1),o=n==="+",l=s==="*";if(l!==(a==="*"))throw new xr("Invalid refspec");return new rk({remotePath:r,localPath:i,force:o,matchPrefix:l})}translate(t){if(this.matchPrefix){if(t.startsWith(this.remotePath))return this.localPath+t.replace(this.remotePath,"")}else if(t===this.remotePath)return this.localPath;return null}reverseTranslate(t){if(this.matchPrefix){if(t.startsWith(this.localPath))return this.remotePath+t.replace(this.localPath,"")}else if(t===this.localPath)return this.remotePath;return null}}class mD{constructor(t=[]){this.rules=t}static from(t){const n=[];for(const r of t)n.push(rk.from(r));return new mD(n)}add(t){const n=rk.from(t);this.rules.push(n)}translate(t){const n=[];for(const r of this.rules)for(const s of t){const i=r.translate(s);i&&n.push([s,i])}return n}translateOne(t){let n=null;for(const r of this.rules){const s=r.translate(t);s&&(n=s)}return n}localNamespaces(){return this.rules.filter(t=>t.matchPrefix).map(t=>t.localPath.replace(/\/$/,""))}}function v2e(e,t){const n=e.replace(/\^\{\}$/,""),r=t.replace(/\^\{\}$/,""),s=-(n<r)||+(n>r);return s===0?e.endsWith("^{}")?1:-1:s}const x2e=e=>{if(typeof e=="number")return e;e=e.toLowerCase();let t=parseInt(e);return e.endsWith("k")&&(t*=1024),e.endsWith("m")&&(t*=1024*1024),e.endsWith("g")&&(t*=1024*1024*1024),t},zv=e=>{if(typeof e=="boolean")return e;if(e=e.trim().toLowerCase(),e==="true"||e==="yes"||e==="on")return!0;if(e==="false"||e==="no"||e==="off")return!1;throw Error(`Expected 'true', 'false', 'yes', 'no', 'on', or 'off', but got ${e}`)},fz={core:{filemode:zv,bare:zv,logallrefupdates:zv,symlinks:zv,ignorecase:zv,bigFileThreshold:x2e}},w2e=/^\[([A-Za-z0-9-.]+)(?: "(.*)")?\]$/,_2e=/^[A-Za-z0-9-.]+$/,S2e=/^([A-Za-z][A-Za-z-]*)(?: *= *(.*))?$/,C2e=/^[A-Za-z][A-Za-z-]*$/,k2e=/^(.*?)( *[#;].*)$/,E2e=e=>{const t=w2e.exec(e);if(t!=null){const[n,r]=t.slice(1);return[n,r]}return null},T2e=e=>{const t=S2e.exec(e);if(t!=null){const[n,r="true"]=t.slice(1),s=A2e(r),i=R2e(s);return[n,i]}return null},A2e=e=>{const t=k2e.exec(e);if(t==null)return e;const[n,r]=t.slice(1);return hz(n)&&hz(r)?`${n}${r}`:n},hz=e=>(e.match(/(?:^|[^\\])"/g)||[]).length%2!==0,R2e=e=>e.split("").reduce((t,n,r,s)=>{const i=n==='"'&&s[r-1]!=="\\",a=n==="\\"&&s[r+1]==='"';return i||a?t:t+n},""),pz=e=>e!=null?e.toLowerCase():null,Lj=(e,t,n)=>[pz(e),t,pz(n)].filter(r=>r!=null).join("."),mz=e=>{const t=e.split("."),n=t.shift(),r=t.pop(),s=t.length?t.join("."):void 0;return{section:n,subsection:s,name:r,path:Lj(n,s,r),sectionPath:Lj(n,s,null),isSection:!!n}},N2e=(e,t)=>e.reduce((n,r,s)=>t(r)?s:n,-1);class gD{constructor(t){let n=null,r=null;this.parsedConfig=t?t.split(`
`).map(s=>{let i=null,a=null;const o=s.trim(),l=E2e(o),c=l!=null;if(c)[n,r]=l;else{const d=T2e(o);d!=null&&([i,a]=d)}const u=Lj(n,r,i);return{line:s,isSection:c,section:n,subsection:r,name:i,value:a,path:u}}):[]}static from(t){return new gD(t)}async get(t,n=!1){const r=mz(t).path,s=this.parsedConfig.filter(i=>i.path===r).map(({section:i,name:a,value:o})=>{const l=fz[i]&&fz[i][a];return l?l(o):o});return n?s:s.pop()}async getall(t){return this.get(t,!0)}async getSubsections(t){return this.parsedConfig.filter(n=>n.isSection&&n.section===t).map(n=>n.subsection)}async deleteSection(t,n){this.parsedConfig=this.parsedConfig.filter(r=>!(r.section===t&&r.subsection===n))}async append(t,n){return this.set(t,n,!0)}async set(t,n,r=!1){const{section:s,subsection:i,name:a,path:o,sectionPath:l,isSection:c}=mz(t),u=N2e(this.parsedConfig,d=>d.path===o);if(n==null)u!==-1&&this.parsedConfig.splice(u,1);else if(u!==-1){const d=this.parsedConfig[u],h=Object.assign({},d,{name:a,value:n,modified:!0});r?this.parsedConfig.splice(u+1,0,h):this.parsedConfig[u]=h}else{const d=this.parsedConfig.findIndex(m=>m.path===l),h={section:s,subsection:i,name:a,value:n,modified:!0,path:o};if(_2e.test(s)&&C2e.test(a))if(d>=0)this.parsedConfig.splice(d+1,0,h);else{const m={isSection:c,section:s,subsection:i,modified:!0,path:l};this.parsedConfig.push(m,h)}}}toString(){return this.parsedConfig.map(({line:t,section:n,subsection:r,name:s,value:i,modified:a=!1})=>a?s!=null&&i!=null?typeof i=="string"&&/[#;]/.test(i)?`	${s} = "${i}"`:`	${s} = ${i}`:r!=null?`[${n} "${r}"]`:`[${n}]`:t).join(`
`)}}class Oi{static async get({fs:t,gitdir:n}){const r=await t.read(`${n}/config`,{encoding:"utf8"});return gD.from(r)}static async save({fs:t,gitdir:n,config:r}){await t.write(`${n}/config`,r.toString(),{encoding:"utf8"})}}const GS=e=>[`${e}`,`refs/${e}`,`refs/tags/${e}`,`refs/heads/${e}`,`refs/remotes/${e}`,`refs/remotes/${e}/HEAD`],M2e=["config","description","index","shallow","commondir"];let cI;async function oh(e,t){return cI===void 0&&(cI=new bw),cI.acquire(e,t)}class Yt{static async updateRemoteRefs({fs:t,gitdir:n,remote:r,refs:s,symrefs:i,tags:a,refspecs:o=void 0,prune:l=!1,pruneTags:c=!1}){for(const v of s.values())if(!v.match(/[0-9a-f]{40}/))throw new Lh(v);const u=await Oi.get({fs:t,gitdir:n});if(!o){if(o=await u.getall(`remote.${r}.fetch`),o.length===0)throw new M1(r);o.unshift(`+HEAD:refs/remotes/${r}/HEAD`)}const d=mD.from(o),h=new Map;if(c){const v=await Yt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"});await Yt.deleteRefs({fs:t,gitdir:n,refs:v.map(x=>`refs/tags/${x}`)})}if(a){for(const v of s.keys())if(v.startsWith("refs/tags")&&!v.endsWith("^{}")&&!await Yt.exists({fs:t,gitdir:n,ref:v})){const x=s.get(v);h.set(v,x)}}const m=d.translate([...s.keys()]);for(const[v,x]of m){const w=s.get(v);h.set(x,w)}const y=d.translate([...i.keys()]);for(const[v,x]of y){const w=i.get(v),S=d.translateOne(w);S&&h.set(x,`ref: ${S}`)}const b=[];if(l){for(const v of d.localNamespaces()){const x=(await Yt.listRefs({fs:t,gitdir:n,filepath:v})).map(w=>`${v}/${w}`);for(const w of x)h.has(w)||b.push(w)}b.length>0&&await Yt.deleteRefs({fs:t,gitdir:n,refs:b})}for(const[v,x]of h)await oh(v,async()=>t.write($t.join(n,v),`${x.trim()}
`,"utf8"));return{pruned:b}}static async writeRef({fs:t,gitdir:n,ref:r,value:s}){if(!s.match(/[0-9a-f]{40}/))throw new Lh(s);await oh(r,async()=>t.write($t.join(n,r),`${s.trim()}
`,"utf8"))}static async writeSymbolicRef({fs:t,gitdir:n,ref:r,value:s}){await oh(r,async()=>t.write($t.join(n,r),`ref: ${s.trim()}
`,"utf8"))}static async deleteRef({fs:t,gitdir:n,ref:r}){return Yt.deleteRefs({fs:t,gitdir:n,refs:[r]})}static async deleteRefs({fs:t,gitdir:n,refs:r}){await Promise.all(r.map(o=>t.rm($t.join(n,o))));let s=await oh("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));const i=nk.from(s),a=i.refs.size;for(const o of r)i.refs.has(o)&&i.delete(o);i.refs.size<a&&(s=i.toString(),await oh("packed-refs",async()=>t.write(`${n}/packed-refs`,s,{encoding:"utf8"})))}static async resolve({fs:t,gitdir:n,ref:r,depth:s=void 0}){if(s!==void 0&&(s--,s===-1))return r;if(r.startsWith("ref: "))return r=r.slice(5),Yt.resolve({fs:t,gitdir:n,ref:r,depth:s});if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const i=await Yt.packedRefs({fs:t,gitdir:n}),a=GS(r).filter(o=>!M2e.includes(o));for(const o of a){const l=await oh(o,async()=>await t.read(`${n}/${o}`,{encoding:"utf8"})||i.get(o));if(l)return Yt.resolve({fs:t,gitdir:n,ref:l.trim(),depth:s})}throw new As(r)}static async exists({fs:t,gitdir:n,ref:r}){try{return await Yt.expand({fs:t,gitdir:n,ref:r}),!0}catch{return!1}}static async expand({fs:t,gitdir:n,ref:r}){if(r.length===40&&/[0-9a-f]{40}/.test(r))return r;const s=await Yt.packedRefs({fs:t,gitdir:n}),i=GS(r);for(const a of i)if(await oh(a,async()=>t.exists(`${n}/${a}`))||s.has(a))return a;throw new As(r)}static async expandAgainstMap({ref:t,map:n}){const r=GS(t);for(const s of r)if(await n.has(s))return s;throw new As(t)}static resolveAgainstMap({ref:t,fullref:n=t,depth:r=void 0,map:s}){if(r!==void 0&&(r--,r===-1))return{fullref:n,oid:t};if(t.startsWith("ref: "))return t=t.slice(5),Yt.resolveAgainstMap({ref:t,fullref:n,depth:r,map:s});if(t.length===40&&/[0-9a-f]{40}/.test(t))return{fullref:n,oid:t};const i=GS(t);for(const a of i){const o=s.get(a);if(o)return Yt.resolveAgainstMap({ref:o.trim(),fullref:a,depth:r,map:s})}throw new As(t)}static async packedRefs({fs:t,gitdir:n}){const r=await oh("packed-refs",async()=>t.read(`${n}/packed-refs`,{encoding:"utf8"}));return nk.from(r).refs}static async listRefs({fs:t,gitdir:n,filepath:r}){const s=Yt.packedRefs({fs:t,gitdir:n});let i=null;try{i=await t.readdirDeep(`${n}/${r}`),i=i.map(a=>a.replace(`${n}/${r}/`,""))}catch{i=[]}for(let a of(await s).keys())a.startsWith(r)&&(a=a.replace(r+"/",""),i.includes(a)||i.push(a));return i.sort(v2e),i}static async listBranches({fs:t,gitdir:n,remote:r}){return r?Yt.listRefs({fs:t,gitdir:n,filepath:`refs/remotes/${r}`}):Yt.listRefs({fs:t,gitdir:n,filepath:"refs/heads"})}static async listTags({fs:t,gitdir:n}){return(await Yt.listRefs({fs:t,gitdir:n,filepath:"refs/tags"})).filter(s=>!s.endsWith("^{}"))}}function I2e(e,t){return lT(gz(e),gz(t))}function gz(e){return e.mode==="040000"?e.path+"/":e.path}function WY(e){switch(e){case"040000":return"tree";case"100644":return"blob";case"100755":return"blob";case"120000":return"blob";case"160000":return"commit"}throw new xr(`Unexpected GitTree entry mode: ${e}`)}function j2e(e){const t=[];let n=0;for(;n<e.length;){const r=e.indexOf(32,n);if(r===-1)throw new xr(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next space character.`);const s=e.indexOf(0,n);if(s===-1)throw new xr(`GitTree: Error parsing buffer at byte location ${n}: Could not find the next null character.`);let i=e.slice(n,r).toString("utf8");i==="40000"&&(i="040000");const a=WY(i),o=e.slice(r+1,s).toString("utf8");if(o.includes("\\")||o.includes("/"))throw new ib(o);const l=e.slice(s+1,s+21).toString("hex");n=s+21,t.push({mode:i,path:o,oid:l,type:a})}return t}function P2e(e){if(typeof e=="number"&&(e=e.toString(8)),e.match(/^0?4.*/))return"040000";if(e.match(/^1006.*/))return"100644";if(e.match(/^1007.*/))return"100755";if(e.match(/^120.*/))return"120000";if(e.match(/^160.*/))return"160000";throw new xr(`Could not understand file mode: ${e}`)}function O2e(e){return!e.oid&&e.sha&&(e.oid=e.sha),e.mode=P2e(e.mode),e.type||(e.type=WY(e.mode)),e}class Uo{constructor(t){if(cn.isBuffer(t))this._entries=j2e(t);else if(Array.isArray(t))this._entries=t.map(O2e);else throw new xr("invalid type passed to GitTree constructor");this._entries.sort(zY)}static from(t){return new Uo(t)}render(){return this._entries.map(t=>`${t.mode} ${t.type} ${t.oid}    ${t.path}`).join(`
`)}toObject(){const t=[...this._entries];return t.sort(I2e),cn.concat(t.map(n=>{const r=cn.from(n.mode.replace(/^0/,"")),s=cn.from(" "),i=cn.from(n.path,"utf8"),a=cn.from([0]),o=cn.from(n.oid,"hex");return cn.concat([r,s,i,a,o])}))}entries(){return this._entries}*[Symbol.iterator](){for(const t of this._entries)yield t}}class ob{static wrap({type:t,object:n}){return cn.concat([cn.from(`${t} ${n.byteLength.toString()}\0`),cn.from(n)])}static unwrap(t){const n=t.indexOf(32),r=t.indexOf(0),s=t.slice(0,n).toString("utf8"),i=t.slice(n+1,r).toString("utf8"),a=t.length-(r+1);if(parseInt(i)!==a)throw new xr(`Length mismatch: expected ${i} bytes but got ${a} instead.`);return{type:s,object:cn.from(t.slice(r+1))}}}async function HY({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`,s=await e.read(`${t}/${r}`);return s?{object:s,format:"deflated",source:r}:null}function D2e(e,t){const n=new bu(e),r=yz(n);if(r!==t.byteLength)throw new xr(`applyDelta expected source buffer to be ${r} bytes but the provided buffer was ${t.length} bytes`);const s=yz(n);let i;const a=vz(n,t);if(a.byteLength===s)i=a;else{i=cn.alloc(s);const o=new bu(i);for(o.copy(a);!n.eof();)o.copy(vz(n,t));const l=o.tell();if(s!==l)throw new xr(`applyDelta expected target buffer to be ${s} bytes but the resulting buffer was ${l} bytes`)}return i}function yz(e){let t=0,n=0,r=null;do r=e.readUInt8(),t|=(r&127)<<n,n+=7;while(r&128);return t}function bz(e,t,n){let r=0,s=0;for(;n--;)t&1&&(r|=e.readUInt8()<<s),t>>=1,s+=8;return r}function vz(e,t){const n=e.readUInt8(),r=128,s=15,i=112;if(n&r){const a=bz(e,n&s,4);let o=bz(e,(n&i)>>4,3);return o===0&&(o=65536),t.slice(a,a+o)}else return e.slice(n)}function F2e(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function GY(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:F2e(e)}class KY{constructor(t){if(typeof cn>"u")throw new Error("Missing Buffer dependency");this.stream=GY(t),this.buffer=null,this.cursor=0,this.undoCursor=0,this.started=!1,this._ended=!1,this._discardedBytes=0}eof(){return this._ended&&this.cursor===this.buffer.length}tell(){return this._discardedBytes+this.cursor}async byte(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(1),this.buffer[this.undoCursor]}async chunk(){if(!this.eof()&&(this.started||await this._init(),!(this.cursor===this.buffer.length&&(await this._loadnext(),this._ended))))return this._moveCursor(this.buffer.length),this.buffer.slice(this.undoCursor,this.cursor)}async read(t){if(!this.eof())return this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t),this.buffer.slice(this.undoCursor,this.cursor)}async skip(t){this.eof()||(this.started||await this._init(),this.cursor+t>this.buffer.length&&(this._trim(),await this._accumulate(t)),this._moveCursor(t))}async undo(){this.cursor=this.undoCursor}async _next(){this.started=!0;let{done:t,value:n}=await this.stream.next();return t&&(this._ended=!0,!n)?cn.alloc(0):(n&&(n=cn.from(n)),n)}_trim(){this.buffer=this.buffer.slice(this.undoCursor),this.cursor-=this.undoCursor,this._discardedBytes+=this.undoCursor,this.undoCursor=0}_moveCursor(t){this.undoCursor=this.cursor,this.cursor+=t,this.cursor>this.buffer.length&&(this.cursor=this.buffer.length)}async _accumulate(t){if(this._ended)return;const n=[this.buffer];for(;this.cursor+t>L2e(n);){const r=await this._next();if(this._ended)break;n.push(r)}this.buffer=cn.concat(n)}async _loadnext(){this._discardedBytes+=this.buffer.length,this.undoCursor=0,this.cursor=0,this.buffer=await this._next()}async _init(){this.buffer=await this._next()}}function L2e(e){return e.reduce((t,n)=>t+n.length,0)}async function B2e(e,t){const n=new KY(e);let r=await n.read(4);if(r=r.toString("utf8"),r!=="PACK")throw new xr(`Invalid PACK header '${r}'`);let s=await n.read(4);if(s=s.readUInt32BE(0),s!==2)throw new xr(`Invalid packfile version: ${s}`);let i=await n.read(4);if(i=i.readUInt32BE(0),!(i<1))for(;!n.eof()&&i--;){const a=n.tell(),{type:o,length:l,ofs:c,reference:u}=await $2e(n),d=new pD.Inflate;for(;!d.result;){const h=await n.chunk();if(!h)break;if(d.push(h,!1),d.err)throw new xr(`Pako error: ${d.msg}`);if(d.result){if(d.result.length!==l)throw new xr("Inflated object size is different from that stated in packfile.");await n.undo(),await n.read(h.length-d.strm.avail_in);const m=n.tell();await t({data:d.result,type:o,num:i,offset:a,end:m,reference:u,ofs:c})}}}}async function $2e(e){let t=await e.byte();const n=t>>4&7;let r=t&15;if(t&128){let a=4;do t=await e.byte(),r|=(t&127)<<a,a+=7;while(t&128)}let s,i;if(n===6){let a=0;s=0;const o=[];do t=await e.byte(),s|=(t&127)<<a,a+=7,o.push(t);while(t&128);i=cn.from(o)}return n===7&&(i=await e.read(20)),{type:n,length:r,ofs:s,reference:i}}async function YY(e){return pD.inflate(e)}function z2e(e){const t=[];let n=0,r=0;do{n=e.readUInt8();const s=n&127;t.push(s),r=n&128}while(r);return t.reduce((s,i)=>s+1<<7|i,-1)}function U2e(e,t){let n=t,r=4,s=null;do s=e.readUInt8(),n|=(s&127)<<r,r+=7;while(s&128);return n}class gy{constructor(t){Object.assign(this,t),this.offsetCache={}}static async fromIdx({idx:t,getExternalRefDelta:n}){const r=new bu(t);if(r.slice(4).toString("hex")!=="ff744f63")return;const i=r.readUInt32BE();if(i!==2)throw new xr(`Unable to read version ${i} packfile IDX. (Only version 2 supported)`);if(t.byteLength>2048*1024*1024)throw new xr("To keep implementation simple, I haven't implemented the layer 5 feature needed to support packfiles > 2GB in size.");r.seek(r.tell()+4*255);const a=r.readUInt32BE(),o=[];for(let u=0;u<a;u++){const d=r.slice(20).toString("hex");o[u]=d}r.seek(r.tell()+4*a);const l=new Map;for(let u=0;u<a;u++)l.set(o[u],r.readUInt32BE());const c=r.slice(20).toString("hex");return new gy({hashes:o,crcs:{},offsets:l,packfileSha:c,getExternalRefDelta:n})}static async fromPack({pack:t,getExternalRefDelta:n,onProgress:r}){const s={1:"commit",2:"tree",3:"blob",4:"tag",6:"ofs-delta",7:"ref-delta"},i={},a=t.slice(-20).toString("hex"),o=[],l={},c=new Map;let u=null,d=null;await B2e([t],async({data:v,type:x,reference:w,offset:S,num:k})=>{u===null&&(u=k);const C=Math.floor((u-k)*100/u);C!==d&&r&&await r({phase:"Receiving objects",loaded:u-k,total:u}),d=C,x=s[x],["commit","tree","blob","tag"].includes(x)?i[S]={type:x,offset:S}:x==="ofs-delta"?i[S]={type:x,offset:S}:x==="ref-delta"&&(i[S]={type:x,offset:S})});const h=Object.keys(i).map(Number);for(const[v,x]of h.entries()){const w=v+1===h.length?t.byteLength-20:h[v+1],S=i[x],k=zCe.buf(t.slice(x,w))>>>0;S.end=w,S.crc=k}const m=new gy({pack:Promise.resolve(t),packfileSha:a,crcs:l,hashes:o,offsets:c,getExternalRefDelta:n});d=null;let y=0;const b=[0,0,0,0,0,0,0,0,0,0,0,0];for(let v in i){v=Number(v);const x=Math.floor(y*100/u);x!==d&&r&&await r({phase:"Resolving deltas",loaded:y,total:u}),y++,d=x;const w=i[v];if(!w.oid)try{m.readDepth=0,m.externalReadDepth=0;const{type:S,object:k}=await m.readSlice({start:v});b[m.readDepth]+=1;const C=await Jd(ob.wrap({type:S,object:k}));w.oid=C,o.push(C),c.set(C,v),l[C]=w.crc}catch{continue}}return o.sort(),m}async toBuffer(){const t=[],n=(c,u)=>{t.push(cn.from(c,u))};n("ff744f63","hex"),n("00000002","hex");const r=new bu(cn.alloc(256*4));for(let c=0;c<256;c++){let u=0;for(const d of this.hashes)parseInt(d.slice(0,2),16)<=c&&u++;r.writeUInt32BE(u)}t.push(r.buffer);for(const c of this.hashes)n(c,"hex");const s=new bu(cn.alloc(this.hashes.length*4));for(const c of this.hashes)s.writeUInt32BE(this.crcs[c]);t.push(s.buffer);const i=new bu(cn.alloc(this.hashes.length*4));for(const c of this.hashes)i.writeUInt32BE(this.offsets.get(c));t.push(i.buffer),n(this.packfileSha,"hex");const a=cn.concat(t),o=await Jd(a),l=cn.alloc(20);return l.write(o,"hex"),cn.concat([a,l])}async load({pack:t}){this.pack=t}async unload(){this.pack=null}async read({oid:t}){if(!this.offsets.get(t)){if(this.getExternalRefDelta)return this.externalReadDepth++,this.getExternalRefDelta(t);throw new xr(`Could not read object ${t} from packfile`)}const n=this.offsets.get(t);return this.readSlice({start:n})}async readSlice({start:t}){if(this.offsetCache[t])return Object.assign({},this.offsetCache[t]);this.readDepth++;const n={16:"commit",32:"tree",48:"blob",64:"tag",96:"ofs_delta",112:"ref_delta"};if(!this.pack)throw new xr("Tried to read from a GitPackIndex with no packfile loaded into memory");const r=(await this.pack).slice(t),s=new bu(r),i=s.readUInt8(),a=i&112;let o=n[a];if(o===void 0)throw new xr("Unrecognized type: 0b"+a.toString(2));const l=i&15;let c=l;i&128&&(c=U2e(s,l));let d=null,h=null;if(o==="ofs_delta"){const y=z2e(s),b=t-y;({object:d,type:o}=await this.readSlice({start:b}))}if(o==="ref_delta"){const y=s.slice(20).toString("hex");({object:d,type:o}=await this.read({oid:y}))}const m=r.slice(s.tell());if(h=cn.from(await YY(m)),h.byteLength!==c)throw new xr(`Packfile told us object would have length ${c} but it had length ${h.byteLength}`);return d&&(h=cn.from(D2e(h,d))),this.readDepth>3&&(this.offsetCache[t]={type:o,object:h}),{type:o,format:"content",object:h}}}const KS=Symbol("PackfileCache");async function q2e({fs:e,filename:t,getExternalRefDelta:n,emitter:r,emitterPrefix:s}){const i=await e.read(t);return gy.fromIdx({idx:i,getExternalRefDelta:n})}function yD({fs:e,cache:t,filename:n,getExternalRefDelta:r,emitter:s,emitterPrefix:i}){t[KS]||(t[KS]=new Map);let a=t[KS].get(n);return a||(a=q2e({fs:e,filename:n,getExternalRefDelta:r,emitter:s,emitterPrefix:i}),t[KS].set(n,a)),a}async function V2e({fs:e,cache:t,gitdir:n,oid:r,format:s="content",getExternalRefDelta:i}){let a=await e.readdir($t.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await yD({fs:e,cache:t,filename:l,getExternalRefDelta:i});if(c.error)throw new xr(c.error);if(c.offsets.has(r)){if(!c.pack){const d=l.replace(/idx$/,"pack");c.pack=e.read(d)}const u=await c.read({oid:r,getExternalRefDelta:i});return u.format="content",u.source=`objects/pack/${o.replace(/idx$/,"pack")}`,u}}return null}async function Xs({fs:e,cache:t,gitdir:n,oid:r,format:s="content"}){const i=u=>Xs({fs:e,cache:t,gitdir:n,oid:u});let a;if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904"&&(a={format:"wrapped",object:cn.from("tree 0\0")}),a||(a=await HY({fs:e,gitdir:n,oid:r})),!a){if(a=await V2e({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i}),!a)throw new As(r);return a}if(s==="deflated"||(a.format==="deflated"&&(a.object=cn.from(await YY(a.object)),a.format="wrapped"),s==="wrapped"))return a;const o=await Jd(a.object);if(o!==r)throw new xr(`SHA check failed! Expected ${r}, computed ${o}`);const{object:l,type:c}=ob.unwrap(a.object);if(a.type=c,a.object=l,a.format="content",s==="content")return a;throw new xr(`invalid requested format "${s}"`)}class Vc extends Qr{constructor(t,n,r=!0){super(`Failed to create ${t} at ${n} because it already exists.${r?` (Hint: use 'force: true' parameter to overwrite existing ${t}.)`:""}`),this.code=this.name=Vc.code,this.data={noun:t,where:n,canForce:r}}}Vc.code="AlreadyExistsError";class I1 extends Qr{constructor(t,n,r){super(`Found multiple ${t} matching "${n}" (${r.join(", ")}). Use a longer abbreviation length to disambiguate them.`),this.code=this.name=I1.code,this.data={nouns:t,short:n,matches:r}}}I1.code="AmbiguousError";class j1 extends Qr{constructor(t){super(`Your local changes to the following files would be overwritten by checkout: ${t.join(", ")}`),this.code=this.name=j1.code,this.data={filepaths:t}}}j1.code="CheckoutConflictError";class P1 extends Qr{constructor(t,n){super(`Failed to checkout "${t}" because commit ${n} is not available locally. Do a git fetch to make the branch available locally.`),this.code=this.name=P1.code,this.data={ref:t,oid:n}}}P1.code="CommitNotFetchedError";class O1 extends Qr{constructor(){super("Empty response from git server."),this.code=this.name=O1.code,this.data={}}}O1.code="EmptyServerResponseError";class D1 extends Qr{constructor(){super("A simple fast-forward merge was not possible."),this.code=this.name=D1.code,this.data={}}}D1.code="FastForwardError";class F1 extends Qr{constructor(t,n){super(`One or more branches were not updated: ${t}`),this.code=this.name=F1.code,this.data={prettyDetails:t,result:n}}}F1.code="GitPushError";class yy extends Qr{constructor(t,n,r){super(`HTTP Error: ${t} ${n}`),this.code=this.name=yy.code,this.data={statusCode:t,statusMessage:n,response:r}}}yy.code="HttpError";class Bh extends Qr{constructor(t){let n="invalid filepath";t==="leading-slash"||t==="trailing-slash"?n='"filepath" parameter should not include leading or trailing directory separators because these can cause problems on some platforms.':t==="directory"&&(n='"filepath" should not be a directory.'),super(n),this.code=this.name=Bh.code,this.data={reason:t}}}Bh.code="InvalidFilepathError";class $c extends Qr{constructor(t,n){super(`"${t}" would be an invalid git reference. (Hint: a valid alternative would be "${n}".)`),this.code=this.name=$c.code,this.data={ref:t,suggestion:n}}}$c.code="InvalidRefNameError";class L1 extends Qr{constructor(t){super(`Maximum search depth of ${t} exceeded.`),this.code=this.name=L1.code,this.data={depth:t}}}L1.code="MaxDepthError";class lb extends Qr{constructor(){super("Merges with conflicts are not supported yet."),this.code=this.name=lb.code,this.data={}}}lb.code="MergeNotSupportedError";class cb extends Qr{constructor(t,n,r,s){super(`Automatic merge failed with one or more merge conflicts in the following files: ${t.toString()}. Fix conflicts then commit the result.`),this.code=this.name=cb.code,this.data={filepaths:t,bothModified:n,deleteByUs:r,deleteByTheirs:s}}}cb.code="MergeConflictError";class Ua extends Qr{constructor(t){super(`No name was provided for ${t} in the argument or in the .git/config file.`),this.code=this.name=Ua.code,this.data={role:t}}}Ua.code="MissingNameError";class Do extends Qr{constructor(t){super(`The function requires a "${t}" parameter but none was provided.`),this.code=this.name=Do.code,this.data={parameter:t}}}Do.code="MissingParameterError";class B1 extends Qr{constructor(t){super('There are multiple errors that were thrown by the method. Please refer to the "errors" property to see more'),this.code=this.name=B1.code,this.data={errors:t},this.errors=t}}B1.code="MultipleGitError";class rg extends Qr{constructor(t,n){super(`Expected "${t}" but received "${n}".`),this.code=this.name=rg.code,this.data={expected:t,actual:n}}}rg.code="ParseError";class by extends Qr{constructor(t){let n="";t==="not-fast-forward"?n=" because it was not a simple fast-forward":t==="tag-exists"&&(n=" because tag already exists"),super(`Push rejected${n}. Use "force: true" to override.`),this.code=this.name=by.code,this.data={reason:t}}}by.code="PushRejectedError";class wh extends Qr{constructor(t,n){super(`Remote does not support the "${t}" so the "${n}" parameter cannot be used.`),this.code=this.name=wh.code,this.data={capability:t,parameter:n}}}wh.code="RemoteCapabilityError";class $1 extends Qr{constructor(t,n){super(`Remote did not reply using the "smart" HTTP protocol. Expected "001e# service=git-upload-pack" but received: ${t}`),this.code=this.name=$1.code,this.data={preview:t,response:n}}}$1.code="SmartHttpError";class z1 extends Qr{constructor(t,n,r){super(`Git remote "${t}" uses an unrecognized transport protocol: "${n}"`),this.code=this.name=z1.code,this.data={url:t,transport:n,suggestion:r}}}z1.code="UnknownTransportError";class U1 extends Qr{constructor(t){super(`Cannot parse remote URL: "${t}"`),this.code=this.name=U1.code,this.data={url:t}}}U1.code="UrlParseError";class ub extends Qr{constructor(){super("The operation was canceled."),this.code=this.name=ub.code,this.data={}}}ub.code="UserCanceledError";class q1 extends Qr{constructor(t){super(`Could not merge index: Entry for '${t}' is not up to date. Either reset the index entry to HEAD, or stage your unstaged changes.`),this.code=this.name=q1.code,this.data={filepath:t}}}q1.code="IndexResetError";class V1 extends Qr{constructor(t){super(`"${t}" does not point to any commit. You're maybe working on a repository with no commits yet. `),this.code=this.name=V1.code,this.data={ref:t}}}V1.code="NoCommitError";var W2e=Object.freeze({__proto__:null,AlreadyExistsError:Vc,AmbiguousError:I1,CheckoutConflictError:j1,CommitNotFetchedError:P1,EmptyServerResponseError:O1,FastForwardError:D1,GitPushError:F1,HttpError:yy,InternalError:xr,InvalidFilepathError:Bh,InvalidOidError:Lh,InvalidRefNameError:$c,MaxDepthError:L1,MergeNotSupportedError:lb,MergeConflictError:cb,MissingNameError:Ua,MissingParameterError:Do,MultipleGitError:B1,NoRefspecError:M1,NotFoundError:As,ObjectTypeError:yo,ParseError:rg,PushRejectedError:by,RemoteCapabilityError:wh,SmartHttpError:$1,UnknownTransportError:z1,UnsafeFilepathError:ib,UrlParseError:U1,UserCanceledError:ub,UnmergedPathsError:N1,IndexResetError:q1,NoCommitError:V1});function Bj({name:e,email:t,timestamp:n,timezoneOffset:r}){return r=H2e(r),`${e} <${t}> ${n} ${r}`}function H2e(e){const t=G2e(K2e(e));e=Math.abs(e);const n=Math.floor(e/60);e-=n*60;let r=String(n),s=String(e);return r.length<2&&(r="0"+r),s.length<2&&(s="0"+s),(t===-1?"-":"+")+r+s}function G2e(e){return Math.sign(e)||(Object.is(e,-0)?-1:1)}function K2e(e){return e===0?e:-e}function Rd(e){return e=e.replace(/\r/g,""),e=e.replace(/^\n+/,""),e=e.replace(/\n+$/,"")+`
`,e}function sk(e){const[,t,n,r,s]=e.match(/^(.*) <(.*)> (.*) (.*)$/);return{name:t,email:n,timestamp:Number(r),timezoneOffset:Y2e(s)}}function Y2e(e){let[,t,n,r]=e.match(/(\+|-)(\d\d)(\d\d)/);return r=(t==="+"?1:-1)*(Number(n)*60+Number(r)),Z2e(r)}function Z2e(e){return e===0?e:-e}class ao{constructor(t){if(typeof t=="string")this._tag=t;else if(cn.isBuffer(t))this._tag=t.toString("utf8");else if(typeof t=="object")this._tag=ao.render(t);else throw new xr("invalid type passed to GitAnnotatedTag constructor")}static from(t){return new ao(t)}static render(t){return`object ${t.object}
type ${t.type}
tag ${t.tag}
tagger ${Bj(t.tagger)}

${t.message}
${t.gpgsig?t.gpgsig:""}`}justHeaders(){return this._tag.slice(0,this._tag.indexOf(`

`))}message(){const t=this.withoutSignature();return t.slice(t.indexOf(`

`)+2)}parse(){return Object.assign(this.headers(),{message:this.message(),gpgsig:this.gpgsig()})}render(){return this._tag}headers(){const t=this.justHeaders().split(`
`),n=[];for(const s of t)s[0]===" "?n[n.length-1]+=`
`+s.slice(1):n.push(s);const r={};for(const s of n){const i=s.slice(0,s.indexOf(" ")),a=s.slice(s.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(a):r[i]=a}return r.tagger&&(r.tagger=sk(r.tagger)),r.committer&&(r.committer=sk(r.committer)),r}withoutSignature(){const t=Rd(this._tag);return t.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1?t:t.slice(0,t.lastIndexOf(`
-----BEGIN PGP SIGNATURE-----`))}gpgsig(){if(this._tag.indexOf(`
-----BEGIN PGP SIGNATURE-----`)===-1)return;const t=this._tag.slice(this._tag.indexOf("-----BEGIN PGP SIGNATURE-----"),this._tag.indexOf("-----END PGP SIGNATURE-----")+27);return Rd(t)}payload(){return this.withoutSignature()+`
`}toObject(){return cn.from(this._tag,"utf8")}static async sign(t,n,r){const s=t.payload();let{signature:i}=await n({payload:s,secretKey:r});i=Rd(i);const a=s+i;return ao.from(a)}}function uI(e){return e.trim().split(`
`).map(t=>" "+t).join(`
`)+`
`}function X2e(e){return e.split(`
`).map(t=>t.replace(/^ /,"")).join(`
`)}class Zs{constructor(t){if(typeof t=="string")this._commit=t;else if(cn.isBuffer(t))this._commit=t.toString("utf8");else if(typeof t=="object")this._commit=Zs.render(t);else throw new xr("invalid type passed to GitCommit constructor")}static fromPayloadSignature({payload:t,signature:n}){const r=Zs.justHeaders(t),s=Zs.justMessage(t),i=Rd(r+`
gpgsig`+uI(n)+`
`+s);return new Zs(i)}static from(t){return new Zs(t)}toObject(){return cn.from(this._commit,"utf8")}headers(){return this.parseHeaders()}message(){return Zs.justMessage(this._commit)}parse(){return Object.assign({message:this.message()},this.headers())}static justMessage(t){return Rd(t.slice(t.indexOf(`

`)+2))}static justHeaders(t){return t.slice(0,t.indexOf(`

`))}parseHeaders(){const t=Zs.justHeaders(this._commit).split(`
`),n=[];for(const s of t)s[0]===" "?n[n.length-1]+=`
`+s.slice(1):n.push(s);const r={parent:[]};for(const s of n){const i=s.slice(0,s.indexOf(" ")),a=s.slice(s.indexOf(" ")+1);Array.isArray(r[i])?r[i].push(a):r[i]=a}return r.author&&(r.author=sk(r.author)),r.committer&&(r.committer=sk(r.committer)),r}static renderHeaders(t){let n="";if(t.tree?n+=`tree ${t.tree}
`:n+=`tree 4b825dc642cb6eb9a060e54bf8d69288fbee4904
`,t.parent){if(t.parent.length===void 0)throw new xr("commit 'parent' property should be an array");for(const i of t.parent)n+=`parent ${i}
`}const r=t.author;n+=`author ${Bj(r)}
`;const s=t.committer||t.author;return n+=`committer ${Bj(s)}
`,t.gpgsig&&(n+="gpgsig"+uI(t.gpgsig)),n}static render(t){return Zs.renderHeaders(t)+`
`+Rd(t.message)}render(){return this._commit}withoutSignature(){const t=Rd(this._commit);if(t.indexOf(`
gpgsig`)===-1)return t;const n=t.slice(0,t.indexOf(`
gpgsig`)),r=t.slice(t.indexOf(`-----END PGP SIGNATURE-----
`)+28);return Rd(n+`
`+r)}isolateSignature(){const t=this._commit.slice(this._commit.indexOf("-----BEGIN PGP SIGNATURE-----"),this._commit.indexOf("-----END PGP SIGNATURE-----")+27);return X2e(t)}static async sign(t,n,r){const s=t.withoutSignature(),i=Zs.justMessage(t._commit);let{signature:a}=await n({payload:s,secretKey:r});a=Rd(a);const l=Zs.justHeaders(t._commit)+`
gpgsig`+uI(a)+`
`+i;return Zs.from(l)}}async function vy({fs:e,cache:t,gitdir:n,oid:r}){if(r==="4b825dc642cb6eb9a060e54bf8d69288fbee4904")return{tree:Uo.from([]),oid:r};const{type:s,object:i}=await Xs({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=ao.from(i).parse().object,vy({fs:e,cache:t,gitdir:n,oid:r});if(s==="commit")return r=Zs.from(i).parse().tree,vy({fs:e,cache:t,gitdir:n,oid:r});if(s!=="tree")throw new yo(r,s,"tree");return{tree:Uo.from(i),oid:r}}class J2e{constructor({fs:t,gitdir:n,ref:r,cache:s}){this.fs=t,this.cache=s,this.gitdir=n,this.mapPromise=(async()=>{const a=new Map;let o;try{o=await Yt.resolve({fs:t,gitdir:n,ref:r})}catch(c){c instanceof As&&(o="4b825dc642cb6eb9a060e54bf8d69288fbee4904")}const l=await vy({fs:t,cache:this.cache,gitdir:n,oid:o});return l.type="tree",l.mode="40000",a.set(".",l),a})();const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,cache:s,gitdir:i}=this,a=await this.mapPromise,o=a.get(n);if(!o)throw new Error(`No obj for ${n}`);const l=o.oid;if(!l)throw new Error(`No oid for obj ${JSON.stringify(o)}`);if(o.type!=="tree")return null;const{type:c,object:u}=await Xs({fs:r,cache:s,gitdir:i,oid:l});if(c!==o.type)throw new yo(l,c,o.type);const d=Uo.from(u);for(const h of d)a.set($t.join(n,h.path),h);return d.entries().map(h=>$t.join(n,h.path))}async type(t){if(t._type===!1){const n=await this.mapPromise,{type:r}=n.get(t._fullpath);t._type=r}return t._type}async mode(t){if(t._mode===!1){const n=await this.mapPromise,{mode:r}=n.get(t._fullpath);t._mode=UY(parseInt(r,8))}return t._mode}async stat(t){}async content(t){if(t._content===!1){const n=await this.mapPromise,{fs:r,cache:s,gitdir:i}=this,o=n.get(t._fullpath).oid,{type:l,object:c}=await Xs({fs:r,cache:s,gitdir:i,oid:o});l!=="blob"?t._content=void 0:t._content=new Uint8Array(c)}return t._content}async oid(t){if(t._oid===!1){const r=(await this.mapPromise).get(t._fullpath);t._oid=r.oid}return t._oid}}function Wl({ref:e="HEAD"}={}){const t=Object.create(null);return Object.defineProperty(t,cT,{value:function({fs:n,gitdir:r,cache:s}){return new J2e({fs:n,gitdir:r,ref:e,cache:s})}}),Object.freeze(t),t}class Q2e{constructor({fs:t,dir:n,gitdir:r,cache:s}){this.fs=t,this.cache=s,this.dir=n,this.gitdir=r,this.config=null;const i=this;this.ConstructEntry=class{constructor(o){this._fullpath=o,this._type=!1,this._mode=!1,this._stat=!1,this._content=!1,this._oid=!1}async type(){return i.type(this)}async mode(){return i.mode(this)}async stat(){return i.stat(this)}async content(){return i.content(this)}async oid(){return i.oid(this)}}}async readdir(t){const n=t._fullpath,{fs:r,dir:s}=this,i=await r.readdir($t.join(s,n));return i===null?null:i.map(a=>$t.join(n,a))}async type(t){return t._type===!1&&await t.stat(),t._type}async mode(t){return t._mode===!1&&await t.stat(),t._mode}async stat(t){if(t._stat===!1){const{fs:n,dir:r}=this;let s=await n.lstat(`${r}/${t._fullpath}`);if(!s)throw new Error(`ENOENT: no such file or directory, lstat '${t._fullpath}'`);let i=s.isDirectory()?"tree":"blob";i==="blob"&&!s.isFile()&&!s.isSymbolicLink()&&(i="special"),t._type=i,s=py(s),t._mode=s.mode,s.size===-1&&t._actualSize&&(s.size=t._actualSize),t._stat=s}return t._stat}async content(t){if(t._content===!1){const{fs:n,dir:r,gitdir:s}=this;if(await t.type()==="tree")t._content=void 0;else{const a=await(await this._getGitConfig(n,s)).get("core.autocrlf"),o=await n.read(`${r}/${t._fullpath}`,{autocrlf:a});t._actualSize=o.length,t._stat&&t._stat.size===-1&&(t._stat.size=t._actualSize),t._content=new Uint8Array(o)}}return t._content}async oid(t){if(t._oid===!1){const n=this,{fs:r,gitdir:s,cache:i}=this;let a;await ua.acquire({fs:r,gitdir:s,cache:i},async function(o){const l=o.entriesMap.get(t._fullpath),c=await t.stat(),d=await(await n._getGitConfig(r,s)).get("core.filemode"),h=typeof Mi<"u"?Mi.platform!=="win32":!0;if(!l||ek(c,l,d,h)){const m=await t.content();m===void 0?a=void 0:(a=await Jd(ob.wrap({type:"blob",object:m})),l&&a===l.oid&&(!d||c.mode===l.mode)&&ek(c,l,d,h)&&o.insert({filepath:t._fullpath,stats:c,oid:a}))}else a=l.oid}),t._oid=a}return t._oid}async _getGitConfig(t,n){return this.config?this.config:(this.config=await Oi.get({fs:t,gitdir:n}),this.config)}}function W1(){const e=Object.create(null);return Object.defineProperty(e,cT,{value:function({fs:t,dir:n,gitdir:r,cache:s}){return new Q2e({fs:t,dir:n,gitdir:r,cache:s})}}),Object.freeze(e),e}function eke(e,t){const n=t-e;return Array.from({length:n},(r,s)=>e+s)}const ZY=typeof Array.prototype.flat>"u"?e=>e.reduce((t,n)=>t.concat(n),[]):e=>e.flat();class tke{constructor(){this.value=null}consider(t){t!=null&&(this.value===null?this.value=t:t<this.value&&(this.value=t))}reset(){this.value=null}}function*nke(e){const t=new tke;let n;const r=[],s=e.length;for(let i=0;i<s;i++)r[i]=e[i].next().value,r[i]!==void 0&&t.consider(r[i]);if(t.value!==null)for(;;){const i=[];n=t.value,t.reset();for(let a=0;a<s;a++)r[a]!==void 0&&r[a]===n?(i[a]=r[a],r[a]=e[a].next().value):i[a]=null,r[a]!==void 0&&t.consider(r[a]);if(yield i,t.value===null)return}}async function $h({fs:e,cache:t,dir:n,gitdir:r,trees:s,map:i=async(l,c)=>c,reduce:a=async(l,c)=>{const u=ZY(c);return l!==void 0&&u.unshift(l),u},iterate:o=(l,c)=>Promise.all([...c].map(l))}){const l=s.map(m=>m[cT]({fs:e,dir:n,gitdir:r,cache:t})),c=new Array(l.length).fill("."),u=eke(0,l.length),d=async m=>{u.map(v=>{const x=m[v];m[v]=x&&new l[v].ConstructEntry(x)});const b=(await Promise.all(u.map(v=>{const x=m[v];return x?l[v].readdir(x):[]}))).map(v=>(v===null?[]:v)[Symbol.iterator]());return{entries:m,children:nke(b)}},h=async m=>{const{entries:y,children:b}=await d(m),v=y.find(w=>w&&w._fullpath)._fullpath,x=await i(v,y);if(x!==null){let w=await o(h,b);return w=w.filter(S=>S!==void 0),a(x,w)}};return h(c)}async function $j(e,t){const n=await e.readdir(t);n==null?await e.rm(t):n.length?await Promise.all(n.map(r=>{const s=$t.join(t,r);return e.lstat(s).then(i=>{if(i)return i.isDirectory()?$j(e,s):e.rm(s)})})).then(()=>e.rmdir(t)):await e.rmdir(t)}function rke(e){return ske(e)&&xz(e.then)&&xz(e.catch)}function ske(e){return e&&typeof e=="object"}function xz(e){return typeof e=="function"}function wz(e){return rke((n=>{try{return n.readFile().catch(r=>r)}catch(r){return r}})(e))}const _z=["readFile","writeFile","mkdir","rmdir","unlink","stat","lstat","readdir","readlink","symlink"];function Sz(e,t){if(wz(t))for(const n of _z)e[`_${n}`]=t[n].bind(t);else for(const n of _z)e[`_${n}`]=tI(t[n].bind(t));wz(t)?t.rm?e._rm=t.rm.bind(t):t.rmdir.length>1?e._rm=t.rmdir.bind(t):e._rm=$j.bind(null,e):t.rm?e._rm=tI(t.rm.bind(t)):t.rmdir.length>2?e._rm=tI(t.rmdir.bind(t)):e._rm=$j.bind(null,e)}class Tn{constructor(t){if(typeof t._original_unwrapped_fs<"u")return t;const n=Object.getOwnPropertyDescriptor(t,"promises");n&&n.enumerable?Sz(this,t.promises):Sz(this,t),this._original_unwrapped_fs=t}async exists(t,n={}){try{return await this._stat(t),!0}catch(r){if(r.code==="ENOENT"||r.code==="ENOTDIR"||(r.code||"").includes("ENS"))return!1;throw console.log('Unhandled error in "FileSystem.exists()" function',r),r}}async read(t,n={}){try{let r=await this._readFile(t,n);if(n.autocrlf==="true")try{r=new TextDecoder("utf8",{fatal:!0}).decode(r),r=r.replace(/\r\n/g,`
`),r=new TextEncoder().encode(r)}catch{}return typeof r!="string"&&(r=cn.from(r)),r}catch{return null}}async write(t,n,r={}){try{await this._writeFile(t,n,r);return}catch{await this.mkdir(my(t)),await this._writeFile(t,n,r)}}async mkdir(t,n=!1){try{await this._mkdir(t);return}catch(r){if(r===null||r.code==="EEXIST")return;if(n)throw r;if(r.code==="ENOENT"){const s=my(t);if(s==="."||s==="/"||s===t)throw r;await this.mkdir(s),await this.mkdir(t,!0)}}}async rm(t){try{await this._unlink(t)}catch(n){if(n.code!=="ENOENT")throw n}}async rmdir(t,n){try{n&&n.recursive?await this._rm(t,n):await this._rmdir(t)}catch(r){if(r.code!=="ENOENT")throw r}}async readdir(t){try{const n=await this._readdir(t);return n.sort(lT),n}catch(n){return n.code==="ENOTDIR"?null:[]}}async readdirDeep(t){const n=await this._readdir(t);return(await Promise.all(n.map(async s=>{const i=t+"/"+s;return(await this._stat(i)).isDirectory()?this.readdirDeep(i):i}))).reduce((s,i)=>s.concat(i),[])}async lstat(t){try{return await this._lstat(t)}catch(n){if(n.code==="ENOENT"||(n.code||"").includes("ENS"))return null;throw n}}async readlink(t,n={encoding:"buffer"}){try{const r=await this._readlink(t,n);return cn.isBuffer(r)?r:cn.from(r)}catch(r){if(r.code==="ENOENT"||(r.code||"").includes("ENS"))return null;throw r}}async writelink(t,n){return this._symlink(n.toString("utf8"),t)}}function ut(e,t){if(t===void 0)throw new Do(e)}async function ik(e,t){return!e&&!t?!1:e&&!t||!e&&t?!0:!(await e.type()==="tree"&&await t.type()==="tree"||await e.type()===await t.type()&&await e.mode()===await t.mode()&&await e.oid()===await t.oid())}async function ike({fs:e,dir:t,gitdir:n=$t.join(t,".git"),commit:r="HEAD",cache:s={}}){try{ut("fs",e),ut("dir",t),ut("gitdir",n);const i=new Tn(e),a=[Wl({ref:r}),W1(),ab()];let o=[];await ua.acquire({fs:i,gitdir:n,cache:s},async function(c){o=c.unmergedPaths});const l=await $h({fs:i,cache:s,dir:t,gitdir:n,trees:a,map:async function(c,[u,d,h]){const m=!await ik(d,h),y=o.includes(c),b=!await ik(h,u);if(m||y)return u?{path:c,mode:await u.mode(),oid:await u.oid(),type:await u.type(),content:await u.content()}:void 0;if(b)return!1;throw new q1(c)}});await ua.acquire({fs:i,gitdir:n,cache:s},async function(c){for(const u of l)if(u!==!1){if(!u){await i.rmdir(`${t}/${u.path}`,{recursive:!0}),c.delete({filepath:u.path});continue}if(u.type==="blob"){const d=new TextDecoder().decode(u.content);await i.write(`${t}/${u.path}`,d,{mode:u.mode}),c.insert({filepath:u.path,oid:u.oid,stage:0})}}})}catch(i){throw i.caller="git.abortMerge",i}}class db{static async isIgnored({fs:t,dir:n,gitdir:r=$t.join(n,".git"),filepath:s}){if(tk(s)===".git")return!0;if(s===".")return!1;let i="";const a=$t.join(r,"info","exclude");await t.exists(a)&&(i=await t.read(a,"utf8"));const o=[{gitignore:$t.join(n,".gitignore"),filepath:s}],l=s.split("/").filter(Boolean);for(let u=1;u<l.length;u++){const d=l.slice(0,u).join("/"),h=l.slice(u).join("/");o.push({gitignore:$t.join(n,d,".gitignore"),filepath:h})}let c=!1;for(const u of o){let d;try{d=await t.read(u.gitignore,"utf8")}catch(y){if(y.code==="NOENT")continue}const h=n2e().add(i);h.add(d);const m=my(u.filepath);if(m!=="."&&h.ignores(m))return!0;c?c=!h.test(u.filepath).unignored:c=h.test(u.filepath).ignored}return c}}async function ake({fs:e,gitdir:t,object:n,format:r,oid:s}){const i=`objects/${s.slice(0,2)}/${s.slice(2)}`,a=`${t}/${i}`;await e.exists(a)||await e.write(a,n)}let dI=null;async function XY(e){return dI===null&&(dI=lke()),dI?oke(e):pD.deflate(e)}async function oke(e){const t=new CompressionStream("deflate"),n=new Blob([e]).stream().pipeThrough(t);return new Uint8Array(await new Response(n).arrayBuffer())}function lke(){try{return new CompressionStream("deflate").writable.close(),new Blob([]).stream().cancel(),!0}catch{return!1}}async function Go({fs:e,gitdir:t,type:n,object:r,format:s="content",oid:i=void 0,dryRun:a=!1}){return s!=="deflated"&&(s!=="wrapped"&&(r=ob.wrap({type:n,object:r})),i=await Jd(r),r=cn.from(await XY(r))),a||await ake({fs:e,gitdir:t,object:r,format:"deflated",oid:i}),i}function JY(e){let t;for(;~(t=e.indexOf(92));)e[t]=47;return e}async function cke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,cache:s={},force:i=!1,parallel:a=!0}){try{ut("fs",e),ut("dir",t),ut("gitdir",n),ut("filepath",r);const o=new Tn(e);await ua.acquire({fs:o,gitdir:n,cache:s},async l=>{const u=await(await Oi.get({fs:o,gitdir:n})).get("core.autocrlf");return zj({dir:t,gitdir:n,fs:o,filepath:r,index:l,force:i,parallel:a,autocrlf:u})})}catch(o){throw o.caller="git.add",o}}async function zj({dir:e,gitdir:t,fs:n,filepath:r,index:s,force:i,parallel:a,autocrlf:o}){r=Array.isArray(r)?r:[r];const l=r.map(async h=>{if(!i&&await db.isIgnored({fs:n,dir:e,gitdir:t,filepath:h}))return;const m=await n.lstat($t.join(e,h));if(!m)throw new As(h);if(m.isDirectory()){const y=await n.readdir($t.join(e,h));if(a){const b=y.map(v=>zj({dir:e,gitdir:t,fs:n,filepath:[$t.join(h,v)],index:s,force:i,parallel:a,autocrlf:o}));await Promise.all(b)}else for(const b of y)await zj({dir:e,gitdir:t,fs:n,filepath:[$t.join(h,b)],index:s,force:i,parallel:a,autocrlf:o})}else{const y=m.isSymbolicLink()?await n.readlink($t.join(e,h)).then(JY):await n.read($t.join(e,h),{autocrlf:o});if(y===null)throw new As(h);const b=await Go({fs:n,gitdir:t,type:"blob",object:y});s.insert({filepath:h,stats:m,oid:b})}}),c=await Promise.allSettled(l),u=c.filter(h=>h.status==="rejected").map(h=>h.reason);if(u.length>1)throw new B1(u);if(u.length===1)throw u[0];return c.filter(h=>h.status==="fulfilled"&&h.value).map(h=>h.value)}async function vw({fs:e,gitdir:t,path:n}){return(await Oi.get({fs:e,gitdir:t})).get(n)}function QY(e,...t){for(const n of t)if(n)for(const r of Object.keys(n)){const s=n[r];s!==void 0&&(e[r]=s)}return e}async function zh({fs:e,gitdir:t,author:n,commit:r}){const s=Math.floor(Date.now()/1e3),i={name:await vw({fs:e,gitdir:t,path:"user.name"}),email:await vw({fs:e,gitdir:t,path:"user.email"})||"",timestamp:s,timezoneOffset:new Date(s*1e3).getTimezoneOffset()},a=QY({},i,r?r.author:void 0,n);if(a.name!==void 0)return a}async function xy({fs:e,gitdir:t,author:n,committer:r,commit:s}){const i=Math.floor(Date.now()/1e3),a={name:await vw({fs:e,gitdir:t,path:"user.name"}),email:await vw({fs:e,gitdir:t,path:"user.email"})||"",timestamp:i,timezoneOffset:new Date(i*1e3).getTimezoneOffset()},o=QY({},a,s?s.committer:void 0,n,r);if(o.name!==void 0)return o}async function eZ({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Xs({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=ao.from(i).parse().object,eZ({fs:e,cache:t,gitdir:n,oid:r});if(s!=="commit")throw new yo(r,s,"commit");return{commit:Zs.from(i),oid:r}}async function wy({fs:e,cache:t,gitdir:n,oid:r}){const{commit:s,oid:i}=await eZ({fs:e,cache:t,gitdir:n,oid:r});return{oid:i,commit:s.parse(),payload:s.withoutSignature()}}async function uT({fs:e,cache:t,onSign:n,gitdir:r,message:s,author:i,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:d,parent:h,tree:m}){let y=!1;d||(d=await Yt.resolve({fs:e,gitdir:r,ref:"HEAD",depth:2}));let b,v;try{b=await Yt.resolve({fs:e,gitdir:r,ref:d}),v=await wy({fs:e,gitdir:r,oid:b,cache:{}})}catch{y=!0}if(l&&y)throw new V1(d);const x=l?await zh({fs:e,gitdir:r,author:i,commit:v.commit}):await zh({fs:e,gitdir:r,author:i});if(!x)throw new Ua("author");const w=l?await xy({fs:e,gitdir:r,author:x,committer:a,commit:v.commit}):await xy({fs:e,gitdir:r,author:x,committer:a});if(!w)throw new Ua("committer");return ua.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async function(S){const C=VY(S.entries).get(".");if(m||(m=await tZ({fs:e,gitdir:r,inode:C,dryRun:c})),h?h=await Promise.all(h.map(N=>Yt.resolve({fs:e,gitdir:r,ref:N}))):l?h=v.commit.parent:h=b?[b]:[],!s)if(l)s=v.commit.message;else throw new Do("message");let T=Zs.from({tree:m,parent:h,author:x,committer:w,message:s});o&&(T=await Zs.sign(T,n,o));const A=await Go({fs:e,gitdir:r,type:"commit",object:T.toObject(),dryRun:c});return!u&&!c&&await Yt.writeRef({fs:e,gitdir:r,ref:d,value:A}),A})}async function tZ({fs:e,gitdir:t,inode:n,dryRun:r}){const s=n.children;for(const l of s)l.type==="tree"&&(l.metadata.mode="040000",l.metadata.oid=await tZ({fs:e,gitdir:t,inode:l,dryRun:r}));const i=s.map(l=>({mode:l.metadata.mode,path:l.basename,oid:l.metadata.oid,type:l.type})),a=Uo.from(i);return await Go({fs:e,gitdir:t,type:"tree",object:a.toObject(),dryRun:r})}async function H1({fs:e,cache:t,gitdir:n,oid:r,filepath:s}){if(s.startsWith("/"))throw new Bh("leading-slash");if(s.endsWith("/"))throw new Bh("trailing-slash");const i=r,a=await vy({fs:e,cache:t,gitdir:n,oid:r}),o=a.tree;if(s==="")r=a.oid;else{const l=s.split("/");r=await nZ({fs:e,cache:t,gitdir:n,tree:o,pathArray:l,oid:i,filepath:s})}return r}async function nZ({fs:e,cache:t,gitdir:n,tree:r,pathArray:s,oid:i,filepath:a}){const o=s.shift();for(const l of r)if(l.path===o){if(s.length===0)return l.oid;{const{type:c,object:u}=await Xs({fs:e,cache:t,gitdir:n,oid:l.oid});if(c!=="tree")throw new yo(i,c,"tree",a);return r=Uo.from(u),nZ({fs:e,cache:t,gitdir:n,tree:r,pathArray:s,oid:i,filepath:a})}}throw new As(`file or directory found at "${i}:${a}"`)}async function fb({fs:e,cache:t,gitdir:n,oid:r,filepath:s=void 0}){s!==void 0&&(r=await H1({fs:e,cache:t,gitdir:n,oid:r,filepath:s}));const{tree:i,oid:a}=await vy({fs:e,cache:t,gitdir:n,oid:r});return{oid:a,tree:i.entries()}}async function G1({fs:e,gitdir:t,tree:n}){const r=Uo.from(n).toObject();return await Go({fs:e,gitdir:t,type:"tree",object:r,format:"content"})}async function uke({fs:e,cache:t,onSign:n,gitdir:r,ref:s,oid:i,note:a,force:o,author:l,committer:c,signingKey:u}){let d;try{d=await Yt.resolve({gitdir:r,fs:e,ref:s})}catch(x){if(!(x instanceof As))throw x}let m=(await fb({fs:e,cache:t,gitdir:r,oid:d||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;if(o)m=m.filter(x=>x.path!==i);else for(const x of m)if(x.path===i)throw new Vc("note",i);typeof a=="string"&&(a=cn.from(a,"utf8"));const y=await Go({fs:e,gitdir:r,type:"blob",object:a,format:"content"});m.push({mode:"100644",path:i,oid:y,type:"blob"});const b=await G1({fs:e,gitdir:r,tree:m});return await uT({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tree:b,parent:d&&[d],message:`Note added by 'isomorphic-git addNote'
`,author:l,committer:c,signingKey:u})}async function dke({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ref:s="refs/notes/commits",oid:i,note:a,force:o,author:l,committer:c,signingKey:u,cache:d={}}){try{ut("fs",e),ut("gitdir",r),ut("oid",i),ut("note",a),u&&ut("onSign",t);const h=new Tn(e),m=await zh({fs:h,gitdir:r,author:l});if(!m)throw new Ua("author");const y=await xy({fs:h,gitdir:r,author:m,committer:c});if(!y)throw new Ua("committer");return await uke({fs:new Tn(h),cache:d,onSign:t,gitdir:r,ref:s,oid:i,note:a,force:o,author:m,committer:y,signingKey:u})}catch(h){throw h.caller="git.addNote",h}}async function rZ({fs:e,gitdir:t,remote:n,url:r,force:s}){if(n!==wu.clean(n))throw new $c(n,wu.clean(n));const i=await Oi.get({fs:e,gitdir:t});if(!s&&(await i.getSubsections("remote")).includes(n)&&r!==await i.get(`remote.${n}.url`))throw new Vc("remote",n);await i.set(`remote.${n}.url`,r),await i.set(`remote.${n}.fetch`,`+refs/heads/*:refs/remotes/${n}/*`),await Oi.save({fs:e,gitdir:t,config:i})}async function fke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),remote:r,url:s,force:i=!1}){try{return ut("fs",e),ut("gitdir",n),ut("remote",r),ut("url",s),await rZ({fs:new Tn(e),gitdir:n,remote:r,url:s,force:i})}catch(a){throw a.caller="git.addRemote",a}}async function hke({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tagger:i,message:a=s,gpgsig:o,object:l,signingKey:c,force:u=!1}){if(s=s.startsWith("refs/tags/")?s:`refs/tags/${s}`,!u&&await Yt.exists({fs:e,gitdir:r,ref:s}))throw new Vc("tag",s);const d=await Yt.resolve({fs:e,gitdir:r,ref:l||"HEAD"}),{type:h}=await Xs({fs:e,cache:t,gitdir:r,oid:d});let m=ao.from({object:d,type:h,tag:s.replace("refs/tags/",""),tagger:i,message:a,gpgsig:o});c&&(m=await ao.sign(m,n,c));const y=await Go({fs:e,gitdir:r,type:"tag",object:m.toObject()});await Yt.writeRef({fs:e,gitdir:r,ref:s,value:y})}async function pke({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ref:s,tagger:i,message:a=s,gpgsig:o,object:l,signingKey:c,force:u=!1,cache:d={}}){try{ut("fs",e),ut("gitdir",r),ut("ref",s),c&&ut("onSign",t);const h=new Tn(e),m=await zh({fs:h,gitdir:r,author:i});if(!m)throw new Ua("tagger");return await hke({fs:h,cache:d,onSign:t,gitdir:r,ref:s,tagger:m,message:a,gpgsig:o,object:l,signingKey:c,force:u})}catch(h){throw h.caller="git.annotatedTag",h}}async function mke({fs:e,gitdir:t,ref:n,object:r,checkout:s=!1,force:i=!1}){if(n!==wu.clean(n))throw new $c(n,wu.clean(n));const a=`refs/heads/${n}`;if(!i&&await Yt.exists({fs:e,gitdir:t,ref:a}))throw new Vc("branch",n,!1);let o;try{o=await Yt.resolve({fs:e,gitdir:t,ref:r||"HEAD"})}catch{}o&&await Yt.writeRef({fs:e,gitdir:t,ref:a,value:o}),s&&await Yt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function gke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,object:s,checkout:i=!1,force:a=!1}){try{return ut("fs",e),ut("gitdir",n),ut("ref",r),await mke({fs:new Tn(e),gitdir:n,ref:r,object:s,checkout:i,force:a})}catch(o){throw o.caller="git.branch",o}}const sZ=(e,t)=>e==="."||t==null||t.length===0||t==="."?!0:t.length>=e.length?t.startsWith(e):e.startsWith(t);async function bD({fs:e,cache:t,onProgress:n,onPostCheckout:r,dir:s,gitdir:i,remote:a,ref:o,filepaths:l,noCheckout:c,noUpdateHead:u,dryRun:d,force:h,track:m=!0}){let y;if(r)try{y=await Yt.resolve({fs:e,gitdir:i,ref:"HEAD"})}catch{y="0000000000000000000000000000000000000000"}let b;try{b=await Yt.resolve({fs:e,gitdir:i,ref:o})}catch(v){if(o==="HEAD")throw v;const x=`${a}/${o}`;if(b=await Yt.resolve({fs:e,gitdir:i,ref:x}),m){const w=await Oi.get({fs:e,gitdir:i});await w.set(`branch.${o}.remote`,a),await w.set(`branch.${o}.merge`,`refs/heads/${o}`),await Oi.save({fs:e,gitdir:i,config:w})}await Yt.writeRef({fs:e,gitdir:i,ref:`refs/heads/${o}`,value:b})}if(!c){let v;try{v=await yke({fs:e,cache:t,onProgress:n,dir:s,gitdir:i,ref:o,force:h,filepaths:l})}catch(C){throw C instanceof As&&C.data.what===b?new P1(o,b):C}const x=v.filter(([C])=>C==="conflict").map(([C,T])=>T);if(x.length>0)throw new j1(x);const w=v.filter(([C])=>C==="error").map(([C,T])=>T);if(w.length>0)throw new xr(w.join(", "));if(d){r&&await r({previousHead:y,newHead:b,type:l!=null&&l.length>0?"file":"branch"});return}let S=0;const k=v.length;await ua.acquire({fs:e,gitdir:i,cache:t},async function(C){await Promise.all(v.filter(([T])=>T==="delete"||T==="delete-index").map(async function([T,A]){const N=`${s}/${A}`;T==="delete"&&await e.rm(N),C.delete({filepath:A}),n&&await n({phase:"Updating workdir",loaded:++S,total:k})}))}),await ua.acquire({fs:e,gitdir:i,cache:t},async function(C){for(const[T,A]of v)if(T==="rmdir"||T==="rmdir-index"){const N=`${s}/${A}`;try{T==="rmdir-index"&&C.delete({filepath:A}),await e.rmdir(N),n&&await n({phase:"Updating workdir",loaded:++S,total:k})}catch(I){if(I.code==="ENOTEMPTY")console.log(`Did not delete ${A} because directory is not empty`);else throw I}}}),await Promise.all(v.filter(([C])=>C==="mkdir"||C==="mkdir-index").map(async function([C,T]){const A=`${s}/${T}`;await e.mkdir(A),n&&await n({phase:"Updating workdir",loaded:++S,total:k})})),await ua.acquire({fs:e,gitdir:i,cache:t},async function(C){await Promise.all(v.filter(([T])=>T==="create"||T==="create-index"||T==="update"||T==="mkdir-index").map(async function([T,A,N,I,O]){const B=`${s}/${A}`;try{if(T!=="create-index"&&T!=="mkdir-index"){const{object:H}=await Xs({fs:e,cache:t,gitdir:i,oid:N});if(O&&await e.rm(B),I===33188)await e.write(B,H);else if(I===33261)await e.write(B,H,{mode:511});else if(I===40960)await e.writelink(B,H);else throw new xr(`Invalid mode 0o${I.toString(8)} detected in blob ${N}`)}const D=await e.lstat(B);I===33261&&(D.mode=493),T==="mkdir-index"&&(D.mode=57344),C.insert({filepath:A,stats:D,oid:N}),n&&await n({phase:"Updating workdir",loaded:++S,total:k})}catch(D){console.log(D)}}))}),r&&await r({previousHead:y,newHead:b,type:l!=null&&l.length>0?"file":"branch"})}if(!u){const v=await Yt.expand({fs:e,gitdir:i,ref:o});v.startsWith("refs/heads")?await Yt.writeSymbolicRef({fs:e,gitdir:i,ref:"HEAD",value:v}):await Yt.writeRef({fs:e,gitdir:i,ref:"HEAD",value:b})}}async function yke({fs:e,cache:t,onProgress:n,dir:r,gitdir:s,ref:i,force:a,filepaths:o}){let l=0;return $h({fs:e,cache:t,dir:r,gitdir:s,trees:[Wl({ref:i}),W1(),ab()],map:async function(c,[u,d,h]){if(c===".")return;if(o&&!o.some(y=>sZ(c,y)))return null;switch(n&&await n({phase:"Analyzing workdir",loaded:++l}),[!!h,!!u,!!d].map(Number).join("")){case"000":return;case"001":return a&&o&&o.includes(c)?["delete",c]:void 0;case"010":switch(await u.type()){case"tree":return["mkdir",c];case"blob":return["create",c,await u.oid(),await u.mode()];case"commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`new entry Unhandled type ${await u.type()}`]}case"011":switch(`${await u.type()}-${await d.type()}`){case"tree-tree":return;case"tree-blob":case"blob-tree":return["conflict",c];case"blob-blob":return await u.oid()!==await d.oid()?a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()]:["conflict",c]:await u.mode()!==await d.mode()?a?["update",c,await u.oid(),await u.mode(),!0]:["conflict",c]:["create-index",c,await u.oid(),await u.mode()];case"commit-tree":return;case"commit-blob":return["conflict",c];default:return["error",`new entry Unhandled type ${u.type}`]}case"100":return["delete-index",c];case"101":switch(await h.type()){case"tree":return["rmdir",c];case"blob":return await h.oid()!==await d.oid()?a?["delete",c]:["conflict",c]:["delete",c];case"commit":return["rmdir-index",c];default:return["error",`delete entry Unhandled type ${await h.type()}`]}case"110":case"111":switch(`${await h.type()}-${await u.type()}`){case"tree-tree":return;case"blob-blob":{if(await h.oid()===await u.oid()&&await h.mode()===await u.mode()&&!a)return;if(d){if(await d.oid()!==await h.oid()&&await d.oid()!==await u.oid())return a?["update",c,await u.oid(),await u.mode(),await u.mode()!==await d.mode()]:["conflict",c]}else if(a)return["update",c,await u.oid(),await u.mode(),await u.mode()!==await h.mode()];return await u.mode()!==await h.mode()?["update",c,await u.oid(),await u.mode(),!0]:await u.oid()!==await h.oid()?["update",c,await u.oid(),await u.mode(),!1]:void 0}case"tree-blob":return["update-dir-to-blob",c,await u.oid()];case"blob-tree":return["update-blob-to-tree",c];case"commit-commit":return["mkdir-index",c,await u.oid(),await u.mode()];default:return["error",`update entry Unhandled type ${await h.type()}-${await u.type()}`]}}},reduce:async function(c,u){return u=ZY(u),c?c&&c[0]==="rmdir"?(u.push(c),u):(u.unshift(c),u):u}})}async function iZ({fs:e,onProgress:t,onPostCheckout:n,dir:r,gitdir:s=$t.join(r,".git"),remote:i="origin",ref:a,filepaths:o,noCheckout:l=!1,noUpdateHead:c=a===void 0,dryRun:u=!1,force:d=!1,track:h=!0,cache:m={}}){try{ut("fs",e),ut("dir",r),ut("gitdir",s);const y=a||"HEAD";return await bD({fs:new Tn(e),cache:m,onProgress:t,onPostCheckout:n,dir:r,gitdir:s,remote:i,ref:y,filepaths:o,noCheckout:l,noUpdateHead:c,dryRun:u,force:d,track:h})}catch(y){throw y.caller="git.checkout",y}}const bke=new RegExp("^refs/(heads/|tags/|remotes/)?(.*)");function om(e){const t=bke.exec(e);return t?t[1]==="remotes/"&&e.endsWith("/HEAD")?t[2].slice(0,-5):t[2]:e}async function op({fs:e,gitdir:t,fullname:n=!1,test:r=!1}){const s=await Yt.resolve({fs:e,gitdir:t,ref:"HEAD",depth:2});if(r)try{await Yt.resolve({fs:e,gitdir:t,ref:s})}catch{return}if(s.startsWith("refs/"))return n?s:om(s)}function vke(e){return e=e.replace(/^git@([^:]+):/,"https://$1/"),e=e.replace(/^ssh:\/\//,"https://"),e}function aZ({username:e="",password:t=""}){return`Basic ${cn.from(`${e}:${t}`).toString("base64")}`}async function K1(e,t){const n=GY(e);for(;;){const{value:r,done:s}=await n.next();if(r&&await t(r),s)break}n.return&&n.return()}async function ak(e){let t=0;const n=[];await K1(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let s=0;for(const i of n)r.set(i,s),s+=i.byteLength;return r}function Cz(e){let t=e.match(/^https?:\/\/([^/]+)@/);if(t==null)return{url:e,auth:{}};t=t[1];const[n,r]=t.split(":");return e=e.replace(`${t}@`,""),{url:e,auth:{username:n,password:r}}}function Uj(e,t){const n=t.toString(16);return"0".repeat(e-n.length)+n}class yi{static flush(){return cn.from("0000","utf8")}static delim(){return cn.from("0001","utf8")}static encode(t){typeof t=="string"&&(t=cn.from(t));const n=t.length+4,r=Uj(4,n);return cn.concat([cn.from(r,"utf8"),t])}static streamReader(t){const n=new KY(t);return async function(){try{let s=await n.read(4);if(s==null)return!0;if(s=parseInt(s.toString("utf8"),16),s===0||s===1)return null;const i=await n.read(s-4);return i??!0}catch(s){return t.error=s,!0}}}}async function kz(e){const t={};let n;for(;n=await e(),n!==!0;){if(n===null)continue;n=n.toString("utf8").replace(/\n$/,"");const r=n.indexOf("=");if(r>-1){const s=n.slice(0,r),i=n.slice(r+1);t[s]=i}else t[n]=!0}return{protocolVersion:2,capabilities2:t}}async function Ez(e,{service:t}){const n=new Set,r=new Map,s=new Map,i=yi.streamReader(e);let a=await i();for(;a===null;)a=await i();if(a===!0)throw new O1;if(a.includes("version 2"))return kz(i);if(a.toString("utf8").replace(/\n$/,"")!==`# service=${t}`)throw new rg(`# service=${t}\\n`,a.toString("utf8"));let o=await i();for(;o===null;)o=await i();if(o===!0)return{capabilities:n,refs:r,symrefs:s};if(o=o.toString("utf8"),o.includes("version 2"))return kz(i);const[l,c]=fI(o,"\0","\\x00");if(c.split(" ").map(u=>n.add(u)),l!=="0000000000000000000000000000000000000000 capabilities^{}"){const[u,d]=fI(l," "," ");for(r.set(d,u);;){const h=await i();if(h===!0)break;if(h!==null){const[m,y]=fI(h.toString("utf8")," "," ");r.set(y,m)}}}for(const u of n)if(u.startsWith("symref=")){const d=u.match(/symref=([^:]+):(.*)/);d.length===3&&s.set(d[1],d[2])}return{protocolVersion:1,capabilities:n,refs:r,symrefs:s}}function fI(e,t,n){const r=e.trim().split(t);if(r.length!==2)throw new rg(`Two strings separated by '${n}'`,e.toString("utf8"));return r}const Tz=(e,t)=>e.endsWith("?")?`${e}${t}`:`${e}/${t.replace(/^https?:\/\//,"")}`,Az=(e,t)=>{(t.username||t.password)&&(e.Authorization=aZ(t)),t.headers&&Object.assign(e,t.headers)},hI=async e=>{try{const t=cn.from(await ak(e.body)),n=t.toString("utf8");return{preview:n.length<256?n:n.slice(0,256)+"...",response:n,data:t}}catch{return{}}};class ok{static async capabilities(){return["discover","connect"]}static async discover({http:t,onProgress:n,onAuth:r,onAuthSuccess:s,onAuthFailure:i,corsProxy:a,service:o,url:l,headers:c,protocolVersion:u}){let{url:d,auth:h}=Cz(l);const m=a?Tz(a,d):d;(h.username||h.password)&&(c.Authorization=aZ(h)),u===2&&(c["Git-Protocol"]="version=2");let y,b,v=!1;do if(y=await t.request({onProgress:n,method:"GET",url:`${m}/info/refs?service=${o}`,headers:c}),b=!1,y.statusCode===401||y.statusCode===203){const x=v?i:r;if(x){if(h=await x(d,{...h,headers:{...c}}),h&&h.cancel)throw new ub;h&&(Az(c,h),v=!0,b=!0)}}else y.statusCode===200&&v&&s&&await s(d,h);while(b);if(y.statusCode!==200){const{response:x}=await hI(y);throw new yy(y.statusCode,y.statusMessage,x)}if(y.headers["content-type"]===`application/x-${o}-advertisement`){const x=await Ez(y.body,{service:o});return x.auth=h,x}else{const{preview:x,response:w,data:S}=await hI(y);try{const k=await Ez([S],{service:o});return k.auth=h,k}catch{throw new $1(x,w)}}}static async connect({http:t,onProgress:n,corsProxy:r,service:s,url:i,auth:a,body:o,headers:l}){const c=Cz(i);c&&(i=c.url),r&&(i=Tz(r,i)),l["content-type"]=`application/x-${s}-request`,l.accept=`application/x-${s}-result`,Az(l,a);const u=await t.request({onProgress:n,method:"POST",url:`${i}/${s}`,body:o,headers:l});if(u.statusCode!==200){const{response:d}=hI(u);throw new yy(u.statusCode,u.statusMessage,d)}return u}}function xke({url:e}){if(e.startsWith("git@"))return{transport:"ssh",address:e};const t=e.match(/(\w+)(:\/\/|::)(.*)/);if(t!==null){if(t[2]==="://")return{transport:t[1],address:t[0]};if(t[2]==="::")return{transport:t[1],address:t[3]}}}class dT{static getRemoteHelperFor({url:t}){const n=new Map;n.set("http",ok),n.set("https",ok);const r=xke({url:t});if(!r)throw new U1(t);if(n.has(r.transport))return n.get(r.transport);throw new z1(t,r.transport,r.transport==="ssh"?vke(t):void 0)}}let Hp=null;class xw{static async read({fs:t,gitdir:n}){Hp===null&&(Hp=new bw);const r=$t.join(n,"shallow"),s=new Set;return await Hp.acquire(r,async function(){const i=await t.read(r,{encoding:"utf8"});if(i===null||i.trim()==="")return s;i.trim().split(`
`).map(a=>s.add(a))}),s}static async write({fs:t,gitdir:n,oids:r}){Hp===null&&(Hp=new bw);const s=$t.join(n,"shallow");if(r.size>0){const i=[...r].join(`
`)+`
`;await Hp.acquire(s,async function(){await t.write(s,i,{encoding:"utf8"})})}else await Hp.acquire(s,async function(){await t.rm(s)})}}async function wke({fs:e,gitdir:t,oid:n}){const r=`objects/${n.slice(0,2)}/${n.slice(2)}`;return e.exists(`${t}/${r}`)}async function _ke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}){let i=await e.readdir($t.join(n,"objects/pack"));i=i.filter(a=>a.endsWith(".idx"));for(const a of i){const o=`${n}/objects/pack/${a}`,l=await yD({fs:e,cache:t,filename:o,getExternalRefDelta:s});if(l.error)throw new xr(l.error);if(l.offsets.has(r))return!0}return!1}async function Rz({fs:e,cache:t,gitdir:n,oid:r,format:s="content"}){const i=o=>Xs({fs:e,cache:t,gitdir:n,oid:o});let a=await wke({fs:e,gitdir:n,oid:r});return a||(a=await _ke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:i})),a}function Ske(e){const s="5041434b"+"00000002"+"00000000";return e.slice(0,12).toString("hex")===s}function oZ(e,t){const n=e.map(r=>r.split("=",1)[0]);return t.filter(r=>{const s=r.split("=",1)[0];return n.includes(s)})}const fT={name:"isomorphic-git",version:"1.30.1",agent:"git/isomorphic-git@1.30.1"};class $C{constructor(){this._queue=[]}write(t){if(this._ended)throw Error("You cannot write to a FIFO that has already been ended!");if(this._waiting){const n=this._waiting;this._waiting=null,n({value:t})}else this._queue.push(t)}end(){if(this._ended=!0,this._waiting){const t=this._waiting;this._waiting=null,t({done:!0})}}destroy(t){this.error=t,this.end()}async next(){if(this._queue.length>0)return{value:this._queue.shift()};if(this._ended)return{done:!0};if(this._waiting)throw Error("You cannot call read until the previous call to read has returned!");return new Promise(t=>{this._waiting=t})}}function Cke(e){const t=e.indexOf("\r"),n=e.indexOf(`
`);return t===-1&&n===-1?-1:t===-1?n+1:n===-1?t+1:n===t+1?n+1:Math.min(t,n)+1}function lZ(e){const t=new $C;let n="";return(async()=>(await K1(e,r=>{for(r=r.toString("utf8"),n+=r;;){const s=Cke(n);if(s===-1)break;t.write(n.slice(0,s)),n=n.slice(s)}}),n.length>0&&t.write(n),t.end()))(),t}class cZ{static demux(t){const n=yi.streamReader(t),r=new $C,s=new $C,i=new $C,a=async function(){const o=await n();if(o===null)return a();if(o===!0){r.end(),i.end(),t.error?s.destroy(t.error):s.end();return}switch(o[0]){case 1:{s.write(o.slice(1));break}case 2:{i.write(o.slice(1));break}case 3:{const l=o.slice(1);i.write(l),r.end(),i.end(),s.destroy(new Error(l.toString("utf8")));return}default:r.write(o)}a()};return a(),{packetlines:r,packfile:s,progress:i}}}async function kke(e){const{packetlines:t,packfile:n,progress:r}=cZ.demux(e),s=[],i=[],a=[];let o=!1,l=!1;return new Promise((c,u)=>{K1(t,d=>{const h=d.toString("utf8").trim();if(h.startsWith("shallow")){const m=h.slice(-41).trim();m.length!==40&&u(new Lh(m)),s.push(m)}else if(h.startsWith("unshallow")){const m=h.slice(-41).trim();m.length!==40&&u(new Lh(m)),i.push(m)}else if(h.startsWith("ACK")){const[,m,y]=h.split(" ");a.push({oid:m,status:y}),y||(l=!0)}else h.startsWith("NAK")?(o=!0,l=!0):(l=!0,o=!0);l&&(e.error?u(e.error):c({shallows:s,unshallows:i,acks:a,nak:o,packfile:n,progress:r}))}).finally(()=>{l||(e.error?u(e.error):c({shallows:s,unshallows:i,acks:a,nak:o,packfile:n,progress:r}))})})}function Eke({capabilities:e=[],wants:t=[],haves:n=[],shallows:r=[],depth:s=null,since:i=null,exclude:a=[]}){const o=[];t=[...new Set(t)];let l=` ${e.join(" ")}`;for(const c of t)o.push(yi.encode(`want ${c}${l}
`)),l="";for(const c of r)o.push(yi.encode(`shallow ${c}
`));s!==null&&o.push(yi.encode(`deepen ${s}
`)),i!==null&&o.push(yi.encode(`deepen-since ${Math.floor(i.valueOf()/1e3)}
`));for(const c of a)o.push(yi.encode(`deepen-not ${c}
`));o.push(yi.flush());for(const c of n)o.push(yi.encode(`have ${c}
`));return o.push(yi.encode(`done
`)),o}async function vD({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:l,ref:c,remoteRef:u,remote:d,url:h,corsProxy:m,depth:y=null,since:b=null,exclude:v=[],relative:x=!1,tags:w=!1,singleBranch:S=!1,headers:k={},prune:C=!1,pruneTags:T=!1}){const A=c||await op({fs:e,gitdir:l,test:!0}),N=await Oi.get({fs:e,gitdir:l}),I=d||A&&await N.get(`branch.${A}.remote`)||"origin",O=h||await N.get(`remote.${I}.url`);if(typeof O>"u")throw new Do("remote OR url");const B=u||A&&await N.get(`branch.${A}.merge`)||c||"HEAD";m===void 0&&(m=await N.get("http.corsProxy"));const D=dT.getRemoteHelperFor({url:O}),H=await D.discover({http:n,onAuth:i,onAuthSuccess:a,onAuthFailure:o,corsProxy:m,service:"git-upload-pack",url:O,headers:k,protocolVersion:1}),P=H.auth,K=H.refs;if(K.size===0)return{defaultBranch:null,fetchHead:null,fetchHeadDescription:null};if(y!==null&&!H.capabilities.has("shallow"))throw new wh("shallow","depth");if(b!==null&&!H.capabilities.has("deepen-since"))throw new wh("deepen-since","since");if(v.length>0&&!H.capabilities.has("deepen-not"))throw new wh("deepen-not","exclude");if(x===!0&&!H.capabilities.has("deepen-relative"))throw new wh("deepen-relative","relative");const{oid:U,fullref:V}=Yt.resolveAgainstMap({ref:B,map:K});for(const We of K.keys())We===V||We==="HEAD"||We.startsWith("refs/heads/")||w&&We.startsWith("refs/tags/")||K.delete(We);const L=oZ([...H.capabilities],["multi_ack_detailed","no-done","side-band-64k","ofs-delta",`agent=${fT.agent}`]);x&&L.push("deepen-relative");const te=S?[U]:K.values(),W=S?[A]:await Yt.listRefs({fs:e,gitdir:l,filepath:"refs"});let Q=[];for(let We of W)try{We=await Yt.expand({fs:e,gitdir:l,ref:We});const je=await Yt.resolve({fs:e,gitdir:l,ref:We});await Rz({fs:e,cache:t,gitdir:l,oid:je})&&Q.push(je)}catch{}Q=[...new Set(Q)];const ee=await xw.read({fs:e,gitdir:l}),re=H.capabilities.has("shallow")?[...ee]:[],pe=Eke({capabilities:L,wants:te,haves:Q,shallows:re,depth:y,since:b,exclude:v}),de=cn.from(await ak(pe)),Oe=await D.connect({http:n,onProgress:r,corsProxy:m,service:"git-upload-pack",url:O,auth:P,body:[de],headers:k}),Fe=await kke(Oe.body);Oe.headers&&(Fe.headers=Oe.headers);for(const We of Fe.shallows)if(!ee.has(We))try{const{object:je}=await Xs({fs:e,cache:t,gitdir:l,oid:We}),Y=new Zs(je),ye=await Promise.all(Y.headers().parent.map(ce=>Rz({fs:e,cache:t,gitdir:l,oid:ce})));ye.length===0||ye.every(ce=>ce)||ee.add(We)}catch{ee.add(We)}for(const We of Fe.unshallows)ee.delete(We);if(await xw.write({fs:e,gitdir:l,oids:ee}),S){const We=new Map([[V,U]]),je=new Map;let Y=10,ye=V;for(;Y--;){const oe=H.symrefs.get(ye);if(oe===void 0)break;je.set(ye,oe),ye=oe}const Ie=K.get(ye);Ie&&We.set(ye,Ie);const{pruned:ce}=await Yt.updateRemoteRefs({fs:e,gitdir:l,remote:I,refs:We,symrefs:je,tags:w,prune:C});C&&(Fe.pruned=ce)}else{const{pruned:We}=await Yt.updateRemoteRefs({fs:e,gitdir:l,remote:I,refs:K,symrefs:H.symrefs,tags:w,prune:C,pruneTags:T});C&&(Fe.pruned=We)}if(Fe.HEAD=H.symrefs.get("HEAD"),Fe.HEAD===void 0){const{oid:We}=Yt.resolveAgainstMap({ref:"HEAD",map:K});for(const[je,Y]of K.entries())if(je!=="HEAD"&&Y===We){Fe.HEAD=je;break}}const Se=V.startsWith("refs/tags")?"tag":"branch";if(Fe.FETCH_HEAD={oid:U,description:`${Se} '${om(V)}' of ${O}`},r||s){const We=lZ(Fe.progress);K1(We,async je=>{if(s&&await s(je),r){const Y=je.match(/([^:]*).*\((\d+?)\/(\d+?)\)/);Y&&await r({phase:Y[1].trim(),loaded:parseInt(Y[2],10),total:parseInt(Y[3],10)})}})}const Ce=cn.from(await ak(Fe.packfile));if(Oe.body.error)throw Oe.body.error;const qe=Ce.slice(-20).toString("hex"),Qe={defaultBranch:Fe.HEAD,fetchHead:Fe.FETCH_HEAD.oid,fetchHeadDescription:Fe.FETCH_HEAD.description};if(Fe.headers&&(Qe.headers=Fe.headers),C&&(Qe.pruned=Fe.pruned),qe!==""&&!Ske(Ce)){Qe.packfile=`objects/pack/pack-${qe}.pack`;const We=$t.join(l,Qe.packfile);await e.write(We,Ce);const je=ye=>Xs({fs:e,cache:t,gitdir:l,oid:ye}),Y=await gy.fromPack({pack:Ce,getExternalRefDelta:je,onProgress:r});await e.write(We.replace(/\.pack$/,".idx"),await Y.toBuffer())}return Qe}async function uZ({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:$t.join(n,".git"),defaultBranch:s="master"}){if(await e.exists(r+"/config"))return;let i=["hooks","info","objects/info","objects/pack","refs/heads","refs/tags"];i=i.map(a=>r+"/"+a);for(const a of i)await e.mkdir(a);await e.write(r+"/config",`[core]
	repositoryformatversion = 0
	filemode = false
	bare = ${t}
`+(t?"":`	logallrefupdates = true
`)+`	symlinks = false
	ignorecase = true
`),await e.write(r+"/HEAD",`ref: refs/heads/${s}
`)}async function Tke({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,onPostCheckout:l,dir:c,gitdir:u,url:d,corsProxy:h,ref:m,remote:y,depth:b,since:v,exclude:x,relative:w,singleBranch:S,noCheckout:k,noTags:C,headers:T}){try{if(await uZ({fs:e,gitdir:u}),await rZ({fs:e,gitdir:u,remote:y,url:d,force:!1}),h){const I=await Oi.get({fs:e,gitdir:u});await I.set("http.corsProxy",h),await Oi.save({fs:e,gitdir:u,config:I})}const{defaultBranch:A,fetchHead:N}=await vD({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:u,ref:m,remote:y,corsProxy:h,depth:b,since:v,exclude:x,relative:w,singleBranch:S,headers:T,tags:!C});if(N===null)return;m=m||A,m=m.replace("refs/heads/",""),await bD({fs:e,cache:t,onProgress:r,onPostCheckout:l,dir:c,gitdir:u,ref:m,remote:y,noCheckout:k})}catch(A){throw await e.rmdir(u,{recursive:!0,maxRetries:10}).catch(()=>{}),A}}async function Ake({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c=$t.join(l,".git"),url:u,corsProxy:d=void 0,ref:h=void 0,remote:m="origin",depth:y=void 0,since:b=void 0,exclude:v=[],relative:x=!1,singleBranch:w=!1,noCheckout:S=!1,noTags:k=!1,headers:C={},cache:T={}}){try{return ut("fs",e),ut("http",t),ut("gitdir",c),S||ut("dir",l),ut("url",u),await Tke({fs:new Tn(e),cache:T,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPostCheckout:o,dir:l,gitdir:c,url:u,corsProxy:d,ref:h,remote:m,depth:y,since:b,exclude:v,relative:x,singleBranch:w,noCheckout:S,noTags:k,headers:C})}catch(A){throw A.caller="git.clone",A}}async function Rke({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),message:s,author:i,committer:a,signingKey:o,amend:l=!1,dryRun:c=!1,noUpdateBranch:u=!1,ref:d,parent:h,tree:m,cache:y={}}){try{ut("fs",e),l||ut("message",s),o&&ut("onSign",t);const b=new Tn(e);return await uT({fs:b,cache:y,onSign:t,gitdir:r,message:s,author:i,committer:a,signingKey:o,amend:l,dryRun:c,noUpdateBranch:u,ref:d,parent:h,tree:m})}catch(b){throw b.caller="git.commit",b}}async function Nke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),fullname:r=!1,test:s=!1}){try{return ut("fs",e),ut("gitdir",n),await op({fs:new Tn(e),gitdir:n,fullname:r,test:s})}catch(i){throw i.caller="git.currentBranch",i}}async function Mke({fs:e,gitdir:t,ref:n}){if(n=n.startsWith("refs/heads/")?n:`refs/heads/${n}`,!await Yt.exists({fs:e,gitdir:t,ref:n}))throw new As(n);const s=await Yt.expand({fs:e,gitdir:t,ref:n}),i=await op({fs:e,gitdir:t,fullname:!0});if(s===i){const l=await Yt.resolve({fs:e,gitdir:t,ref:s});await Yt.writeRef({fs:e,gitdir:t,ref:"HEAD",value:l})}await Yt.deleteRef({fs:e,gitdir:t,ref:s});const a=om(n),o=await Oi.get({fs:e,gitdir:t});await o.deleteSection("branch",a),await Oi.save({fs:e,gitdir:t,config:o})}async function Ike({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{return ut("fs",e),ut("ref",r),await Mke({fs:new Tn(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteBranch",s}}async function jke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{ut("fs",e),ut("ref",r),await Yt.deleteRef({fs:new Tn(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteRef",s}}async function Pke({fs:e,gitdir:t,remote:n}){const r=await Oi.get({fs:e,gitdir:t});await r.deleteSection("remote",n),await Oi.save({fs:e,gitdir:t,config:r})}async function Oke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),remote:r}){try{return ut("fs",e),ut("remote",r),await Pke({fs:new Tn(e),gitdir:n,remote:r})}catch(s){throw s.caller="git.deleteRemote",s}}async function Dke({fs:e,gitdir:t,ref:n}){n=n.startsWith("refs/tags/")?n:`refs/tags/${n}`,await Yt.deleteRef({fs:e,gitdir:t,ref:n})}async function Fke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{return ut("fs",e),ut("ref",r),await Dke({fs:new Tn(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.deleteTag",s}}async function Lke({fs:e,gitdir:t,oid:n}){const r=n.slice(0,2);return(await e.readdir(`${t}/objects/${r}`)).map(i=>`${r}${i}`).filter(i=>i.startsWith(n))}async function Bke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s}){const i=[];let a=await e.readdir($t.join(n,"objects/pack"));a=a.filter(o=>o.endsWith(".idx"));for(const o of a){const l=`${n}/objects/pack/${o}`,c=await yD({fs:e,cache:t,filename:l,getExternalRefDelta:s});if(c.error)throw new xr(c.error);for(const u of c.offsets.keys())u.startsWith(r)&&i.push(u)}return i}async function $ke({fs:e,cache:t,gitdir:n,oid:r}){const s=o=>Xs({fs:e,cache:t,gitdir:n,oid:o}),i=await Lke({fs:e,gitdir:n,oid:r}),a=await Bke({fs:e,cache:t,gitdir:n,oid:r,getExternalRefDelta:s});for(const o of a)i.indexOf(o)===-1&&i.push(o);if(i.length===1)return i[0];throw i.length>1?new I1("oids",r,i):new As(`an object matching "${r}"`)}async function zke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,cache:s={}}){try{return ut("fs",e),ut("gitdir",n),ut("oid",r),await $ke({fs:new Tn(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.expandOid",i}}async function Uke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r}){try{return ut("fs",e),ut("gitdir",n),ut("ref",r),await Yt.expand({fs:new Tn(e),gitdir:n,ref:r})}catch(s){throw s.caller="git.expandRef",s}}async function xD({fs:e,cache:t,gitdir:n,oids:r}){const s={},i=r.length;let a=r.map((o,l)=>({index:l,oid:o}));for(;a.length;){const o=new Set;for(const{oid:c,index:u}of a)s[c]||(s[c]=new Set),s[c].add(u),s[c].size===i&&o.add(c);if(o.size>0)return[...o];const l=new Map;for(const{oid:c,index:u}of a)try{const{object:d}=await Xs({fs:e,cache:t,gitdir:n,oid:c}),h=Zs.from(d),{parent:m}=h.parseHeaders();for(const y of m)(!s[y]||!s[y].has(u))&&l.set(y+":"+u,{oid:y,index:u})}catch{}a=Array.from(l.values())}return[]}const pI=/^.*(\r?\n|$)/gm;function qke({branches:e,contents:t}){const n=e[1],r=e[2],s=t[0],i=t[1],a=t[2],o=i.match(pI),l=s.match(pI),c=a.match(pI),u=l2e(o,l,c),d=7;let h="",m=!0;for(const y of u)y.ok&&(h+=y.ok.join("")),y.conflict&&(m=!1,h+=`${"<".repeat(d)} ${n}
`,h+=y.conflict.a.join(""),h+=`${"=".repeat(d)}
`,h+=y.conflict.b.join(""),h+=`${">".repeat(d)} ${r}
`);return{cleanMerge:m,mergedText:h}}async function Vke({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),index:s,ourOid:i,baseOid:a,theirOid:o,ourName:l="ours",baseName:c="base",theirName:u="theirs",dryRun:d=!1,abortOnConflict:h=!0,mergeDriver:m}){const y=Wl({ref:i}),b=Wl({ref:a}),v=Wl({ref:o}),x=[],w=[],S=[],k=[],C=await $h({fs:e,cache:t,dir:n,gitdir:r,trees:[y,b,v],map:async function(T,[A,N,I]){const O=tk(T),B=await ik(A,N),D=await ik(I,N);switch(`${B}-${D}`){case"false-false":return{mode:await N.mode(),path:O,oid:await N.oid(),type:await N.type()};case"false-true":return I?{mode:await I.mode(),path:O,oid:await I.oid(),type:await I.type()}:void 0;case"true-false":return A?{mode:await A.mode(),path:O,oid:await A.oid(),type:await A.type()}:void 0;case"true-true":{if(A&&N&&I&&await A.type()==="blob"&&await N.type()==="blob"&&await I.type()==="blob")return Wke({fs:e,gitdir:r,path:O,ours:A,base:N,theirs:I,ourName:l,baseName:c,theirName:u,mergeDriver:m}).then(async H=>{if(H.cleanMerge)h||s.insert({filepath:T,oid:H.mergeResult.oid,stage:0});else if(x.push(T),w.push(T),!h){const P=await N.oid(),K=await A.oid(),U=await I.oid();s.delete({filepath:T}),s.insert({filepath:T,oid:P,stage:1}),s.insert({filepath:T,oid:K,stage:2}),s.insert({filepath:T,oid:U,stage:3})}return H.mergeResult});if(N&&!A&&I&&await N.type()==="blob"&&await I.type()==="blob"){if(x.push(T),S.push(T),!h){const H=await N.oid(),P=await I.oid();s.delete({filepath:T}),s.insert({filepath:T,oid:H,stage:1}),s.insert({filepath:T,oid:P,stage:3})}return{mode:await I.mode(),oid:await I.oid(),type:"blob",path:O}}if(N&&A&&!I&&await N.type()==="blob"&&await A.type()==="blob"){if(x.push(T),k.push(T),!h){const H=await N.oid(),P=await A.oid();s.delete({filepath:T}),s.insert({filepath:T,oid:H,stage:1}),s.insert({filepath:T,oid:P,stage:2})}return{mode:await A.mode(),oid:await A.oid(),type:"blob",path:O}}if(N&&!A&&!I&&await N.type()==="blob")return;throw new lb}}},reduce:x.length!==0&&(!n||h)?void 0:async(T,A)=>{const N=A.filter(Boolean);if(T&&!(T&&T.type==="tree"&&N.length===0)){if(N.length>0){const O=new Uo(N).toObject(),B=await Go({fs:e,gitdir:r,type:"tree",object:O,dryRun:d});T.oid=B}return T}}});return x.length!==0?(n&&!h&&await $h({fs:e,cache:t,dir:n,gitdir:r,trees:[Wl({ref:C.oid})],map:async function(T,[A]){const N=`${n}/${T}`;if(await A.type()==="blob"){const I=await A.mode(),O=new TextDecoder().decode(await A.content());await e.write(N,O,{mode:I})}return!0}}),new cb(x,w,S,k)):C.oid}async function Wke({fs:e,gitdir:t,path:n,ours:r,base:s,theirs:i,ourName:a,theirName:o,baseName:l,dryRun:c,mergeDriver:u=qke}){const d="blob",h=await s.mode()===await r.mode()?await i.mode():await r.mode();if(await r.oid()===await i.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await r.oid(),type:d}};if(await r.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await i.oid(),type:d}};if(await i.oid()===await s.oid())return{cleanMerge:!0,mergeResult:{mode:h,path:n,oid:await r.oid(),type:d}};const m=cn.from(await r.content()).toString("utf8"),y=cn.from(await s.content()).toString("utf8"),b=cn.from(await i.content()).toString("utf8"),{mergedText:v,cleanMerge:x}=await u({branches:[l,a,o],contents:[y,m,b],path:n}),w=await Go({fs:e,gitdir:t,type:"blob",object:cn.from(v,"utf8"),dryRun:c});return{cleanMerge:x,mergeResult:{mode:h,path:n,oid:w,type:d}}}async function dZ({fs:e,cache:t,dir:n,gitdir:r,ours:s,theirs:i,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:d,author:h,committer:m,signingKey:y,onSign:b,mergeDriver:v}){s===void 0&&(s=await op({fs:e,gitdir:r,fullname:!0})),s=await Yt.expand({fs:e,gitdir:r,ref:s}),i=await Yt.expand({fs:e,gitdir:r,ref:i});const x=await Yt.resolve({fs:e,gitdir:r,ref:s}),w=await Yt.resolve({fs:e,gitdir:r,ref:i}),S=await xD({fs:e,cache:t,gitdir:r,oids:[x,w]});if(S.length!==1)throw new lb;const k=S[0];if(k===w)return{oid:x,alreadyMerged:!0};if(a&&k===x)return!l&&!c&&await Yt.writeRef({fs:e,gitdir:r,ref:s,value:w}),{oid:w,fastForward:!0};{if(o)throw new D1;const C=await ua.acquire({fs:e,gitdir:r,cache:t,allowUnmerged:!1},async A=>Vke({fs:e,cache:t,dir:n,gitdir:r,index:A,ourOid:x,theirOid:w,baseOid:k,ourName:om(s),baseName:"base",theirName:om(i),dryRun:l,abortOnConflict:u,mergeDriver:v}));if(C instanceof cb)throw C;return d||(d=`Merge branch '${om(i)}' into ${om(s)}`),{oid:await uT({fs:e,cache:t,gitdir:r,message:d,ref:s,tree:C,parent:[x,w],author:h,committer:m,signingKey:y,onSign:b,dryRun:l,noUpdateBranch:c}),tree:C,mergeCommit:!0}}}async function fZ({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,dir:l,gitdir:c,ref:u,url:d,remote:h,remoteRef:m,prune:y,pruneTags:b,fastForward:v,fastForwardOnly:x,corsProxy:w,singleBranch:S,headers:k,author:C,committer:T,signingKey:A}){try{if(!u){const O=await op({fs:e,gitdir:c});if(!O)throw new Do("ref");u=O}const{fetchHead:N,fetchHeadDescription:I}=await vD({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,gitdir:c,corsProxy:w,ref:u,url:d,remote:h,remoteRef:m,singleBranch:S,headers:k,prune:y,pruneTags:b});await dZ({fs:e,cache:t,gitdir:c,ours:u,theirs:N,fastForward:v,fastForwardOnly:x,message:`Merge ${I}`,author:C,committer:T,signingKey:A,dryRun:!1,noUpdateBranch:!1}),await bD({fs:e,cache:t,onProgress:r,dir:l,gitdir:c,ref:u,remote:h,noCheckout:!1})}catch(N){throw N.caller="git.pull",N}}async function Hke({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=$t.join(o,".git"),ref:c,url:u,remote:d,remoteRef:h,corsProxy:m,singleBranch:y,headers:b={},cache:v={}}){try{ut("fs",e),ut("http",t),ut("gitdir",l);const x={name:"",email:"",timestamp:Date.now(),timezoneOffset:0};return await fZ({fs:new Tn(e),cache:v,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:d,remoteRef:h,fastForwardOnly:!0,corsProxy:m,singleBranch:y,headers:b,author:x,committer:x})}catch(x){throw x.caller="git.fastForward",x}}async function Gke({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=$t.join(o,".git"),ref:c,remote:u,remoteRef:d,url:h,corsProxy:m,depth:y=null,since:b=null,exclude:v=[],relative:x=!1,tags:w=!1,singleBranch:S=!1,headers:k={},prune:C=!1,pruneTags:T=!1,cache:A={}}){try{return ut("fs",e),ut("http",t),ut("gitdir",l),await vD({fs:new Tn(e),cache:A,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,gitdir:l,ref:c,remote:u,remoteRef:d,url:h,corsProxy:m,depth:y,since:b,exclude:v,relative:x,tags:w,singleBranch:S,headers:k,prune:C,pruneTags:T})}catch(N){throw N.caller="git.fetch",N}}async function Kke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oids:r,cache:s={}}){try{return ut("fs",e),ut("gitdir",n),ut("oids",r),await xD({fs:new Tn(e),cache:s,gitdir:n,oids:r})}catch(i){throw i.caller="git.findMergeBase",i}}async function hZ({fs:e,filepath:t}){if(await e.exists($t.join(t,".git")))return t;{const n=my(t);if(n===t)throw new As(`git root for ${t}`);return hZ({fs:e,filepath:n})}}async function Yke({fs:e,filepath:t}){try{return ut("fs",e),ut("filepath",t),await hZ({fs:new Tn(e),filepath:t})}catch(n){throw n.caller="git.findRoot",n}}async function Zke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),path:r}){try{return ut("fs",e),ut("gitdir",n),ut("path",r),await vw({fs:new Tn(e),gitdir:n,path:r})}catch(s){throw s.caller="git.getConfig",s}}async function Xke({fs:e,gitdir:t,path:n}){return(await Oi.get({fs:e,gitdir:t})).getall(n)}async function Jke({fs:e,dir:t,gitdir:n=$t.join(t,".git"),path:r}){try{return ut("fs",e),ut("gitdir",n),ut("path",r),await Xke({fs:new Tn(e),gitdir:n,path:r})}catch(s){throw s.caller="git.getConfigAll",s}}async function Qke({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1}){try{ut("http",e),ut("url",i);const c=await dT.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:1}),u={capabilities:[...c.capabilities]};for(const[d,h]of c.refs){const m=d.split("/"),y=m.pop();let b=u;for(const v of m)b[v]=b[v]||{},b=b[v];b[y]=h}for(const[d,h]of c.symrefs){const m=d.split("/"),y=m.pop();let b=u;for(const v of m)b[v]=b[v]||{},b=b[v];b[y]=h}return u}catch(l){throw l.caller="git.getRemoteInfo",l}}function pZ(e,t,n,r){const s=[];for(const[i,a]of e.refs){if(t&&!i.startsWith(t))continue;if(i.endsWith("^{}")){if(r){const l=i.replace("^{}",""),c=s[s.length-1],u=c.ref===l?c:s.find(d=>d.ref===l);if(u===void 0)throw new Error("I did not expect this to happen");u.peeled=a}continue}const o={ref:i,oid:a};n&&e.symrefs.has(i)&&(o.target=e.symrefs.get(i)),s.push(o)}return s}async function eEe({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1,protocolVersion:l=2}){try{ut("http",e),ut("url",i);const u=await dT.getRemoteHelperFor({url:i}).discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:l});if(u.protocolVersion===2)return{protocolVersion:u.protocolVersion,capabilities:u.capabilities2};const d={};for(const h of u.capabilities){const[m,y]=h.split("=");y?d[m]=y:d[m]=!0}return{protocolVersion:1,capabilities:d,refs:pZ(u,void 0,!0,!0)}}catch(c){throw c.caller="git.getRemoteInfo2",c}}async function tEe({type:e,object:t,format:n="content",oid:r=void 0}){return n!=="deflated"&&(n!=="wrapped"&&(t=ob.wrap({type:e,object:t})),r=await Jd(t)),{oid:r,object:t}}async function nEe({object:e}){try{ut("object",e),typeof e=="string"?e=cn.from(e,"utf8"):e=cn.from(e);const t="blob",{oid:n,object:r}=await tEe({type:"blob",format:"content",object:e});return{oid:n,type:t,object:new Uint8Array(r),format:"wrapped"}}catch(t){throw t.caller="git.hashBlob",t}}async function rEe({fs:e,cache:t,onProgress:n,dir:r,gitdir:s,filepath:i}){try{i=$t.join(r,i);const a=await e.read(i),o=c=>Xs({fs:e,cache:t,gitdir:s,oid:c}),l=await gy.fromPack({pack:a,getExternalRefDelta:o,onProgress:n});return await e.write(i.replace(/\.pack$/,".idx"),await l.toBuffer()),{oids:[...l.hashes]}}catch(a){throw a.caller="git.indexPack",a}}async function sEe({fs:e,onProgress:t,dir:n,gitdir:r=$t.join(n,".git"),filepath:s,cache:i={}}){try{return ut("fs",e),ut("dir",n),ut("gitdir",n),ut("filepath",s),await rEe({fs:new Tn(e),cache:i,onProgress:t,dir:n,gitdir:r,filepath:s})}catch(a){throw a.caller="git.indexPack",a}}async function iEe({fs:e,bare:t=!1,dir:n,gitdir:r=t?n:$t.join(n,".git"),defaultBranch:s="master"}){try{return ut("fs",e),ut("gitdir",r),t||ut("dir",n),await uZ({fs:new Tn(e),bare:t,dir:n,gitdir:r,defaultBranch:s})}catch(i){throw i.caller="git.init",i}}async function mZ({fs:e,cache:t,gitdir:n,oid:r,ancestor:s,depth:i}){const a=await xw.read({fs:e,gitdir:n});if(!r)throw new Do("oid");if(!s)throw new Do("ancestor");if(r===s)return!1;const o=[r],l=new Set;let c=0;for(;o.length;){if(c++===i)throw new L1(i);const u=o.shift(),{type:d,object:h}=await Xs({fs:e,cache:t,gitdir:n,oid:u});if(d!=="commit")throw new yo(u,d,"commit");const m=Zs.from(h).parse();for(const y of m.parent)if(y===s)return!0;if(!a.has(u))for(const y of m.parent)l.has(y)||(o.push(y),l.add(y))}return!1}async function aEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,ancestor:s,depth:i=-1,cache:a={}}){try{return ut("fs",e),ut("gitdir",n),ut("oid",r),ut("ancestor",s),await mZ({fs:new Tn(e),cache:a,gitdir:n,oid:r,ancestor:s,depth:i})}catch(o){throw o.caller="git.isDescendent",o}}async function oEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r}){try{return ut("fs",e),ut("dir",t),ut("gitdir",n),ut("filepath",r),db.isIgnored({fs:new Tn(e),dir:t,gitdir:n,filepath:r})}catch(s){throw s.caller="git.isIgnored",s}}async function lEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),remote:r}){try{return ut("fs",e),ut("gitdir",n),Yt.listBranches({fs:new Tn(e),gitdir:n,remote:r})}catch(s){throw s.caller="git.listBranches",s}}async function cEe({fs:e,gitdir:t,ref:n,cache:r}){if(n){const s=await Yt.resolve({gitdir:t,fs:e,ref:n}),i=[];return await gZ({fs:e,cache:r,gitdir:t,oid:s,filenames:i,prefix:""}),i}else return ua.acquire({fs:e,gitdir:t,cache:r},async function(s){return s.entries.map(i=>i.path)})}async function gZ({fs:e,cache:t,gitdir:n,oid:r,filenames:s,prefix:i}){const{tree:a}=await fb({fs:e,cache:t,gitdir:n,oid:r});for(const o of a)o.type==="tree"?await gZ({fs:e,cache:t,gitdir:n,oid:o.oid,filenames:s,prefix:$t.join(i,o.path)}):s.push($t.join(i,o.path))}async function uEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,cache:s={}}){try{return ut("fs",e),ut("gitdir",n),await cEe({fs:new Tn(e),cache:s,gitdir:n,ref:r})}catch(i){throw i.caller="git.listFiles",i}}async function dEe({fs:e,cache:t,gitdir:n,ref:r}){let s;try{s=await Yt.resolve({gitdir:n,fs:e,ref:r})}catch(o){if(o instanceof As)return[]}return(await fb({fs:e,cache:t,gitdir:n,oid:s})).tree.map(o=>({target:o.path,note:o.oid}))}async function fEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r="refs/notes/commits",cache:s={}}){try{return ut("fs",e),ut("gitdir",n),ut("ref",r),await dEe({fs:new Tn(e),cache:s,gitdir:n,ref:r})}catch(i){throw i.caller="git.listNotes",i}}async function hEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r}){try{return ut("fs",e),ut("gitdir",n),Yt.listRefs({fs:new Tn(e),gitdir:n,filepath:r})}catch(s){throw s.caller="git.listRefs",s}}async function pEe({fs:e,gitdir:t}){const n=await Oi.get({fs:e,gitdir:t}),r=await n.getSubsections("remote");return Promise.all(r.map(async i=>{const a=await n.get(`remote.${i}.url`);return{remote:i,url:a}}))}async function mEe({fs:e,dir:t,gitdir:n=$t.join(t,".git")}){try{return ut("fs",e),ut("gitdir",n),await pEe({fs:new Tn(e),gitdir:n})}catch(r){throw r.caller="git.listRemotes",r}}async function gEe(e){const t=yi.streamReader(e),n=[];let r;for(;r=await t(),r!==!0;){if(r===null)continue;r=r.toString("utf8").replace(/\n$/,"");const[s,i,...a]=r.split(" "),o={ref:i,oid:s};for(const l of a){const[c,u]=l.split(":");c==="symref-target"?o.target=u:c==="peeled"&&(o.peeled=u)}n.push(o)}return n}async function yEe({prefix:e,symrefs:t,peelTags:n}){const r=[];return r.push(yi.encode(`command=ls-refs
`)),r.push(yi.encode(`agent=${fT.agent}
`)),(n||t||e)&&r.push(yi.delim()),n&&r.push(yi.encode("peel")),t&&r.push(yi.encode("symrefs")),e&&r.push(yi.encode(`ref-prefix ${e}`)),r.push(yi.flush()),r}async function bEe({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,url:i,headers:a={},forPush:o=!1,protocolVersion:l=2,prefix:c,symrefs:u,peelTags:d}){try{ut("http",e),ut("url",i);const h=await ok.discover({http:e,onAuth:t,onAuthSuccess:n,onAuthFailure:r,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,headers:a,protocolVersion:l});if(h.protocolVersion===1)return pZ(h,c,u,d);const m=await yEe({prefix:c,symrefs:u,peelTags:d}),y=await ok.connect({http:e,auth:h.auth,headers:a,corsProxy:s,service:o?"git-receive-pack":"git-upload-pack",url:i,body:m});return gEe(y.body)}catch(h){throw h.caller="git.listServerRefs",h}}async function vEe({fs:e,dir:t,gitdir:n=$t.join(t,".git")}){try{return ut("fs",e),ut("gitdir",n),Yt.listTags({fs:new Tn(e),gitdir:n})}catch(r){throw r.caller="git.listTags",r}}function xEe(e,t){return e.committer.timestamp-t.committer.timestamp}const wEe="e69de29bb2d1d6434b8b29ae775ad8c2e48c5391";async function Nz({fs:e,cache:t,gitdir:n,oid:r,fileId:s}){if(s===wEe)return;const i=r;let a;const o=await vy({fs:e,cache:t,gitdir:n,oid:r}),l=o.tree;return s===o.oid?a=o.path:(a=await yZ({fs:e,cache:t,gitdir:n,tree:l,fileId:s,oid:i}),Array.isArray(a)&&(a.length===0?a=void 0:a.length===1&&(a=a[0]))),a}async function yZ({fs:e,cache:t,gitdir:n,tree:r,fileId:s,oid:i,filepaths:a=[],parentPath:o=""}){const l=r.entries().map(function(c){let u;return c.oid===s?(u=$t.join(o,c.path),a.push(u)):c.type==="tree"&&(u=Xs({fs:e,cache:t,gitdir:n,oid:c.oid}).then(function({object:d}){return yZ({fs:e,cache:t,gitdir:n,tree:Uo.from(d),fileId:s,oid:i,filepaths:a,parentPath:$t.join(o,c.path)})})),u});return await Promise.all(l),a}async function _Ee({fs:e,cache:t,gitdir:n,filepath:r,ref:s,depth:i,since:a,force:o,follow:l}){const c=typeof a>"u"?void 0:Math.floor(a.valueOf()/1e3),u=[],d=await xw.read({fs:e,gitdir:n}),h=await Yt.resolve({fs:e,gitdir:n,ref:s}),m=[await wy({fs:e,cache:t,gitdir:n,oid:h})];let y,b,v;function x(w){v&&r&&u.push(w)}for(;m.length>0;){const w=m.pop();if(c!==void 0&&w.commit.committer.timestamp<=c)break;if(r){let S;try{S=await H1({fs:e,cache:t,gitdir:n,oid:w.commit.tree,filepath:r}),b&&y!==S&&u.push(b),y=S,b=w,v=!0}catch(k){if(k instanceof As){let C=l&&y;if(C&&(C=await Nz({fs:e,cache:t,gitdir:n,oid:w.commit.tree,fileId:y}),C))if(Array.isArray(C)){if(b){const T=await Nz({fs:e,cache:t,gitdir:n,oid:b.commit.tree,fileId:y});if(Array.isArray(T))if(C=C.filter(A=>T.indexOf(A)===-1),C.length===1)C=C[0],r=C,b&&u.push(b);else{C=!1,b&&u.push(b);break}}}else r=C,b&&u.push(b);if(!C){if(v&&y&&(u.push(b),!o))break;if(!o&&!l)throw k}b=w,v=!1}else throw k}}else u.push(w);if(i!==void 0&&u.length===i){x(w);break}if(!d.has(w.oid))for(const S of w.commit.parent){const k=await wy({fs:e,cache:t,gitdir:n,oid:S});m.map(C=>C.oid).includes(k.oid)||m.push(k)}m.length===0&&x(w),m.sort((S,k)=>xEe(S.commit,k.commit))}return u}async function SEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,ref:s="HEAD",depth:i,since:a,force:o,follow:l,cache:c={}}){try{return ut("fs",e),ut("gitdir",n),ut("ref",s),await _Ee({fs:new Tn(e),cache:c,gitdir:n,filepath:r,ref:s,depth:i,since:a,force:o,follow:l})}catch(u){throw u.caller="git.log",u}}async function CEe({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ours:s,theirs:i,fastForward:a=!0,fastForwardOnly:o=!1,dryRun:l=!1,noUpdateBranch:c=!1,abortOnConflict:u=!0,message:d,author:h,committer:m,signingKey:y,cache:b={},mergeDriver:v}){try{ut("fs",e),y&&ut("onSign",t);const x=new Tn(e),w=await zh({fs:x,gitdir:r,author:h});if(!w&&(!o||!a))throw new Ua("author");const S=await xy({fs:x,gitdir:r,author:w,committer:m});if(!S&&(!o||!a))throw new Ua("committer");return await dZ({fs:x,cache:b,dir:n,gitdir:r,ours:s,theirs:i,fastForward:a,fastForwardOnly:o,dryRun:l,noUpdateBranch:c,abortOnConflict:u,message:d,author:w,committer:S,signingKey:y,onSign:t,mergeDriver:v})}catch(x){throw x.caller="git.merge",x}}const kEe={commit:16,tree:32,blob:48,tag:64,ofs_delta:96,ref_delta:112};async function bZ({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),oids:s}){const i=new OY,a=[];function o(u,d){const h=cn.from(u,d);a.push(h),i.update(h)}async function l({stype:u,object:d}){const h=kEe[u];let m=d.length,y=m>15?128:0;const b=m&15;m=m>>>4;let v=(y|h|b).toString(16);for(o(v,"hex");y;)y=m>127?128:0,v=y|m&127,o(Uj(2,v),"hex"),m=m>>>7;o(cn.from(await XY(d)))}o("PACK"),o("00000002","hex"),o(Uj(8,s.length),"hex");for(const u of s){const{type:d,object:h}=await Xs({fs:e,cache:t,gitdir:r,oid:u});await l({object:h,stype:d})}const c=i.digest();return a.push(c),a}async function EEe({fs:e,cache:t,gitdir:n,oids:r,write:s}){const i=await bZ({fs:e,cache:t,gitdir:n,oids:r}),a=cn.from(await ak(i)),l=`pack-${a.slice(-20).toString("hex")}.pack`;return s?(await e.write($t.join(n,`objects/pack/${l}`),a),{filename:l}):{filename:l,packfile:new Uint8Array(a)}}async function TEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oids:r,write:s=!1,cache:i={}}){try{return ut("fs",e),ut("gitdir",n),ut("oids",r),await EEe({fs:new Tn(e),cache:i,gitdir:n,oids:r,write:s})}catch(a){throw a.caller="git.packObjects",a}}async function AEe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l=$t.join(o,".git"),ref:c,url:u,remote:d,remoteRef:h,prune:m=!1,pruneTags:y=!1,fastForward:b=!0,fastForwardOnly:v=!1,corsProxy:x,singleBranch:w,headers:S={},author:k,committer:C,signingKey:T,cache:A={}}){try{ut("fs",e),ut("gitdir",l);const N=new Tn(e),I=await zh({fs:N,gitdir:l,author:k});if(!I)throw new Ua("author");const O=await xy({fs:N,gitdir:l,author:I,committer:C});if(!O)throw new Ua("committer");return await fZ({fs:N,cache:A,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,dir:o,gitdir:l,ref:c,url:u,remote:d,remoteRef:h,fastForward:b,fastForwardOnly:v,corsProxy:x,singleBranch:w,headers:S,author:I,committer:O,signingKey:T,prune:m,pruneTags:y})}catch(N){throw N.caller="git.pull",N}}async function REe({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),start:s,finish:i}){const a=await xw.read({fs:e,gitdir:r}),o=new Set,l=new Set;for(const d of s)o.add(await Yt.resolve({fs:e,gitdir:r,ref:d}));for(const d of i)try{const h=await Yt.resolve({fs:e,gitdir:r,ref:d});l.add(h)}catch{}const c=new Set;async function u(d){c.add(d);const{type:h,object:m}=await Xs({fs:e,cache:t,gitdir:r,oid:d});if(h==="tag"){const b=ao.from(m).headers().object;return u(b)}if(h!=="commit")throw new yo(d,h,"commit");if(!a.has(d)){const b=Zs.from(m).headers().parent;for(d of b)!l.has(d)&&!c.has(d)&&await u(d)}}for(const d of o)await u(d);return c}async function mI({fs:e,cache:t,dir:n,gitdir:r=$t.join(n,".git"),oids:s}){const i=new Set;async function a(o){if(i.has(o))return;i.add(o);const{type:l,object:c}=await Xs({fs:e,cache:t,gitdir:r,oid:o});if(l==="tag"){const d=ao.from(c).headers().object;await a(d)}else if(l==="commit"){const d=Zs.from(c).headers().tree;await a(d)}else if(l==="tree"){const u=Uo.from(c);for(const d of u)d.type==="blob"&&i.add(d.oid),d.type==="tree"&&await a(d.oid)}}for(const o of s)await a(o);return i}async function NEe(e){const t={};let n="";const r=yi.streamReader(e);let s=await r();for(;s!==!0;)s!==null&&(n+=s.toString("utf8")+`
`),s=await r();const i=n.toString("utf8").split(`
`);if(s=i.shift(),!s.startsWith("unpack "))throw new rg('unpack ok" or "unpack [error message]',s);t.ok=s==="unpack ok",t.ok||(t.error=s.slice(7)),t.refs={};for(const a of i){if(a.trim()==="")continue;const o=a.slice(0,2),l=a.slice(3);let c=l.indexOf(" ");c===-1&&(c=l.length);const u=l.slice(0,c),d=l.slice(c+1);t.refs[u]={ok:o==="ok",error:d}}return t}async function MEe({capabilities:e=[],triplets:t=[]}){const n=[];let r=`\0 ${e.join(" ")}`;for(const s of t)n.push(yi.encode(`${s.oldoid} ${s.oid} ${s.fullRef}${r}
`)),r="";return n.push(yi.flush()),n}async function IEe({fs:e,cache:t,http:n,onProgress:r,onMessage:s,onAuth:i,onAuthSuccess:a,onAuthFailure:o,onPrePush:l,gitdir:c,ref:u,remoteRef:d,remote:h,url:m,force:y=!1,delete:b=!1,corsProxy:v,headers:x={}}){const w=u||await op({fs:e,gitdir:c});if(typeof w>"u")throw new Do("ref");const S=await Oi.get({fs:e,gitdir:c});h=h||await S.get(`branch.${w}.pushRemote`)||await S.get("remote.pushDefault")||await S.get(`branch.${w}.remote`)||"origin";const k=m||await S.get(`remote.${h}.pushurl`)||await S.get(`remote.${h}.url`);if(typeof k>"u")throw new Do("remote OR url");const C=d||await S.get(`branch.${w}.merge`);if(typeof k>"u")throw new Do("remoteRef");v===void 0&&(v=await S.get("http.corsProxy"));const T=await Yt.expand({fs:e,gitdir:c,ref:w}),A=b?"0000000000000000000000000000000000000000":await Yt.resolve({fs:e,gitdir:c,ref:T}),N=dT.getRemoteHelperFor({url:k}),I=await N.discover({http:n,onAuth:i,onAuthSuccess:a,onAuthFailure:o,corsProxy:v,service:"git-receive-pack",url:k,headers:x,protocolVersion:1}),O=I.auth;let B;if(!C)B=T;else try{B=await Yt.expandAgainstMap({ref:C,map:I.refs})}catch(ee){if(ee instanceof As)B=C.startsWith("refs/")?C:`refs/heads/${C}`;else throw ee}const D=I.refs.get(B)||"0000000000000000000000000000000000000000";if(l&&!await l({remote:h,url:k,localRef:{ref:b?"(delete)":T,oid:A},remoteRef:{ref:B,oid:D}}))throw new ub;const H=!I.capabilities.has("no-thin");let P=new Set;if(!b){const ee=[...I.refs.values()];let re=new Set;if(D!=="0000000000000000000000000000000000000000"){const pe=await xD({fs:e,cache:t,gitdir:c,oids:[A,D]});for(const de of pe)ee.push(de);H&&(re=await mI({fs:e,cache:t,gitdir:c,oids:pe}))}if(!ee.includes(A)){const pe=await REe({fs:e,cache:t,gitdir:c,start:[A],finish:ee});P=await mI({fs:e,cache:t,gitdir:c,oids:pe})}if(H){try{const pe=await Yt.resolve({fs:e,gitdir:c,ref:`refs/remotes/${h}/HEAD`,depth:2}),{oid:de}=await Yt.resolveAgainstMap({ref:pe.replace(`refs/remotes/${h}/`,""),fullref:pe,map:I.refs}),Oe=[de];for(const Fe of await mI({fs:e,cache:t,gitdir:c,oids:Oe}))re.add(Fe)}catch{}for(const pe of re)P.delete(pe)}if(A===D&&(y=!0),!y){if(T.startsWith("refs/tags")&&D!=="0000000000000000000000000000000000000000")throw new by("tag-exists");if(A!=="0000000000000000000000000000000000000000"&&D!=="0000000000000000000000000000000000000000"&&!await mZ({fs:e,cache:t,gitdir:c,oid:A,ancestor:D,depth:-1}))throw new by("not-fast-forward")}}const K=oZ([...I.capabilities],["report-status","side-band-64k",`agent=${fT.agent}`]),U=await MEe({capabilities:K,triplets:[{oldoid:D,oid:A,fullRef:B}]}),V=b?[]:await bZ({fs:e,cache:t,gitdir:c,oids:[...P]}),L=await N.connect({http:n,onProgress:r,corsProxy:v,service:"git-receive-pack",url:k,auth:O,headers:x,body:[...U,...V]}),{packfile:te,progress:W}=await cZ.demux(L.body);if(s){const ee=lZ(W);K1(ee,async re=>{await s(re)})}const Q=await NEe(te);if(L.headers&&(Q.headers=L.headers),h&&Q.ok&&Q.refs[B].ok&&!T.startsWith("refs/tags")){const ee=`refs/remotes/${h}/${B.replace("refs/heads","")}`;b?await Yt.deleteRef({fs:e,gitdir:c,ref:ee}):await Yt.writeRef({fs:e,gitdir:c,ref:ee,value:A})}if(Q.ok&&Object.values(Q.refs).every(ee=>ee.ok))return Q;{const ee=Object.entries(Q.refs).filter(([re,pe])=>!pe.ok).map(([re,pe])=>`
  - ${re}: ${pe.error}`).join("");throw new F1(ee,Q)}}async function jEe({fs:e,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPrePush:o,dir:l,gitdir:c=$t.join(l,".git"),ref:u,remoteRef:d,remote:h="origin",url:m,force:y=!1,delete:b=!1,corsProxy:v,headers:x={},cache:w={}}){try{return ut("fs",e),ut("http",t),ut("gitdir",c),await IEe({fs:new Tn(e),cache:w,http:t,onProgress:n,onMessage:r,onAuth:s,onAuthSuccess:i,onAuthFailure:a,onPrePush:o,gitdir:c,ref:u,remoteRef:d,remote:h,url:m,force:y,delete:b,corsProxy:v,headers:x})}catch(S){throw S.caller="git.push",S}}async function vZ({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Xs({fs:e,cache:t,gitdir:n,oid:r});if(s==="tag")return r=ao.from(i).parse().object,vZ({fs:e,cache:t,gitdir:n,oid:r});if(s!=="blob")throw new yo(r,s,"blob");return{oid:r,blob:new Uint8Array(i)}}async function xZ({fs:e,cache:t,gitdir:n,oid:r,filepath:s=void 0}){return s!==void 0&&(r=await H1({fs:e,cache:t,gitdir:n,oid:r,filepath:s})),await vZ({fs:e,cache:t,gitdir:n,oid:r})}async function PEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,filepath:s,cache:i={}}){try{return ut("fs",e),ut("gitdir",n),ut("oid",r),await xZ({fs:new Tn(e),cache:i,gitdir:n,oid:r,filepath:s})}catch(a){throw a.caller="git.readBlob",a}}async function wZ({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,cache:s={}}){try{return ut("fs",e),ut("gitdir",n),ut("oid",r),await wy({fs:new Tn(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.readCommit",i}}async function OEe({fs:e,cache:t,gitdir:n,ref:r="refs/notes/commits",oid:s}){const i=await Yt.resolve({gitdir:n,fs:e,ref:r}),{blob:a}=await xZ({fs:e,cache:t,gitdir:n,oid:i,filepath:s});return a}async function DEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r="refs/notes/commits",oid:s,cache:i={}}){try{return ut("fs",e),ut("gitdir",n),ut("ref",r),ut("oid",s),await OEe({fs:new Tn(e),cache:i,gitdir:n,ref:r,oid:s})}catch(a){throw a.caller="git.readNote",a}}async function FEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,format:s="parsed",filepath:i=void 0,encoding:a=void 0,cache:o={}}){try{ut("fs",e),ut("gitdir",n),ut("oid",r);const l=new Tn(e);i!==void 0&&(r=await H1({fs:l,cache:o,gitdir:n,oid:r,filepath:i}));const u=await Xs({fs:l,cache:o,gitdir:n,oid:r,format:s==="parsed"?"content":s});if(u.oid=r,s==="parsed")switch(u.format="parsed",u.type){case"commit":u.object=Zs.from(u.object).parse();break;case"tree":u.object=Uo.from(u.object).entries();break;case"blob":a?u.object=u.object.toString(a):(u.object=new Uint8Array(u.object),u.format="content");break;case"tag":u.object=ao.from(u.object).parse();break;default:throw new yo(u.oid,u.type,"blob|commit|tag|tree")}else(u.format==="deflated"||u.format==="wrapped")&&(u.type=u.format);return u}catch(l){throw l.caller="git.readObject",l}}async function LEe({fs:e,cache:t,gitdir:n,oid:r}){const{type:s,object:i}=await Xs({fs:e,cache:t,gitdir:n,oid:r,format:"content"});if(s!=="tag")throw new yo(r,s,"tag");const a=ao.from(i);return{oid:r,tag:a.parse(),payload:a.payload()}}async function BEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,cache:s={}}){try{return ut("fs",e),ut("gitdir",n),ut("oid",r),await LEe({fs:new Tn(e),cache:s,gitdir:n,oid:r})}catch(i){throw i.caller="git.readTag",i}}async function $Ee({fs:e,dir:t,gitdir:n=$t.join(t,".git"),oid:r,filepath:s=void 0,cache:i={}}){try{return ut("fs",e),ut("gitdir",n),ut("oid",r),await fb({fs:new Tn(e),cache:i,gitdir:n,oid:r,filepath:s})}catch(a){throw a.caller="git.readTree",a}}async function zEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,cache:s={}}){try{ut("fs",e),ut("gitdir",n),ut("filepath",r),await ua.acquire({fs:new Tn(e),gitdir:n,cache:s},async function(i){i.delete({filepath:r})})}catch(i){throw i.caller="git.remove",i}}async function UEe({fs:e,cache:t,onSign:n,gitdir:r,ref:s="refs/notes/commits",oid:i,author:a,committer:o,signingKey:l}){let c;try{c=await Yt.resolve({gitdir:r,fs:e,ref:s})}catch(y){if(!(y instanceof As))throw y}let d=(await fb({fs:e,gitdir:r,oid:c||"4b825dc642cb6eb9a060e54bf8d69288fbee4904"})).tree;d=d.filter(y=>y.path!==i);const h=await G1({fs:e,gitdir:r,tree:d});return await uT({fs:e,cache:t,onSign:n,gitdir:r,ref:s,tree:h,parent:c&&[c],message:`Note removed by 'isomorphic-git removeNote'
`,author:a,committer:o,signingKey:l})}async function qEe({fs:e,onSign:t,dir:n,gitdir:r=$t.join(n,".git"),ref:s="refs/notes/commits",oid:i,author:a,committer:o,signingKey:l,cache:c={}}){try{ut("fs",e),ut("gitdir",r),ut("oid",i);const u=new Tn(e),d=await zh({fs:u,gitdir:r,author:a});if(!d)throw new Ua("author");const h=await xy({fs:u,gitdir:r,author:d,committer:o});if(!h)throw new Ua("committer");return await UEe({fs:u,cache:c,onSign:t,gitdir:r,ref:s,oid:i,author:d,committer:h,signingKey:l})}catch(u){throw u.caller="git.removeNote",u}}async function VEe({fs:e,gitdir:t,oldref:n,ref:r,checkout:s=!1}){if(r!==wu.clean(r))throw new $c(r,wu.clean(r));if(n!==wu.clean(n))throw new $c(n,wu.clean(n));const i=`refs/heads/${n}`,a=`refs/heads/${r}`;if(await Yt.exists({fs:e,gitdir:t,ref:a}))throw new Vc("branch",r,!1);const l=await Yt.resolve({fs:e,gitdir:t,ref:i,depth:1});await Yt.writeRef({fs:e,gitdir:t,ref:a,value:l}),await Yt.deleteRef({fs:e,gitdir:t,ref:i});const u=await op({fs:e,gitdir:t,fullname:!0})===i;(s||u)&&await Yt.writeSymbolicRef({fs:e,gitdir:t,ref:"HEAD",value:a})}async function WEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,oldref:s,checkout:i=!1}){try{return ut("fs",e),ut("gitdir",n),ut("ref",r),ut("oldref",s),await VEe({fs:new Tn(e),gitdir:n,ref:r,oldref:s,checkout:i})}catch(a){throw a.caller="git.renameBranch",a}}async function _Z({gitdir:e,type:t,object:n}){return Jd(ob.wrap({type:t,object:n}))}async function HEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,ref:s,cache:i={}}){try{ut("fs",e),ut("gitdir",n),ut("filepath",r);const a=new Tn(e);let o,l;try{o=await Yt.resolve({fs:a,gitdir:n,ref:s||"HEAD"})}catch(d){if(s)throw d}if(o)try{o=await H1({fs:a,cache:i,gitdir:n,oid:o,filepath:r})}catch{o=null}let c={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:0,uid:0,gid:0,size:0};const u=t&&await a.read($t.join(t,r));u&&(l=await _Z({gitdir:n,type:"blob",object:u}),o===l&&(c=await a.lstat($t.join(t,r)))),await ua.acquire({fs:a,gitdir:n,cache:i},async function(d){d.delete({filepath:r}),o&&d.insert({filepath:r,stats:c,oid:o})})}catch(a){throw a.caller="git.reset",a}}async function GEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,depth:s}){try{return ut("fs",e),ut("gitdir",n),ut("ref",r),await Yt.resolve({fs:new Tn(e),gitdir:n,ref:r,depth:s})}catch(i){throw i.caller="git.resolveRef",i}}async function KEe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),path:r,value:s,append:i=!1}){try{ut("fs",e),ut("gitdir",n),ut("path",r);const a=new Tn(e),o=await Oi.get({fs:a,gitdir:n});i?await o.append(r,s):await o.set(r,s),await Oi.save({fs:a,gitdir:n,config:o})}catch(a){throw a.caller="git.setConfig",a}}async function SZ({fs:e,gitdir:t,commit:n}){const r=Zs.from(n).toObject();return await Go({fs:e,gitdir:t,type:"commit",object:r,format:"content"})}class lk{static get timezoneOffsetForRefLogEntry(){const t=new Date().getTimezoneOffset(),n=Math.abs(Math.floor(t/60)),r=Math.abs(t%60).toString().padStart(2,"0");return`${t>0?"-":"+"}${n.toString().padStart(2,"0")}${r}`}static createStashReflogEntry(t,n,r){const s=t.name.replace(/\s/g,""),i="0000000000000000000000000000000000000000",a=Math.floor(Date.now()/1e3),o=lk.timezoneOffsetForRefLogEntry;return`${i} ${n} ${s} ${t.email} ${a} ${o}	${r}
`}static getStashReflogEntry(t,n=!1){return t.split(`
`).filter(i=>i).reverse().map((i,a)=>n?`stash@{${a}}: ${i.split("	")[1]}`:i)}}const YEe={stage:ab,workdir:W1};let gI;async function _y(e,t){return gI===void 0&&(gI=new bw),gI.acquire(e,t)}async function ZEe(e,t,n,r,s=null){const i=$t.join(n,r),a=await e.lstat(i);if(!a)throw new As(i);if(a.isDirectory())throw new xr(`${i}: file expected, but found directory`);const o=s?await HY({fs:e,gitdir:t,oid:s}):void 0;let l=o?s:void 0;return o||await _y({fs:e,gitdir:t,currentFilepath:i},async()=>{const c=a.isSymbolicLink()?await e.readlink(i).then(JY):await e.read(i);if(c===null)throw new As(i);l=await Go({fs:e,gitdir:t,type:"blob",object:c})}),l}async function XEe({fs:e,dir:t,gitdir:n,entries:r}){async function s(i){if(i.type==="tree"){if(!i.oid){const a=await Promise.all(i.children.map(s));i.oid=await G1({fs:e,gitdir:n,tree:a}),i.mode=16384}}else i.type==="blob"&&(i.oid=await ZEe(e,n,t,i.path,i.oid),i.mode=33188);return i.path=i.path.split("/").pop(),i}return Promise.all(r.map(s))}async function Mz({fs:e,dir:t,gitdir:n,treePair:r}){const s=r[1]==="stage",i=r.map(m=>typeof m=="string"?YEe[m]():m),a=[],u=await $h({fs:e,cache:{},dir:t,gitdir:n,trees:i,map:async(m,[y,b])=>{if(!(m==="."||await db.isIgnored({fs:e,dir:t,gitdir:n,filepath:m}))&&b)return(!y||await y.oid()!==await b.oid()&&await b.oid()!==void 0)&&a.push([y,b]),{mode:await b.mode(),path:m,oid:await b.oid(),type:await b.type()}},reduce:async(m,y)=>(y=y.filter(Boolean),m?(m.children=y,m):y.length>0?y:void 0),iterate:async(m,y)=>{const b=[];for(const v of y){const[x,w]=v;s?w&&(await e.exists(`${t}/${w.toString()}`)?b.push(v):a.push([null,w])):x&&(w?b.push(v):a.push([x,null]))}return b.length?Promise.all(b.map(m)):[]}});if(a.length===0||u.length===0)return null;const h=(await XEe({fs:e,dir:t,gitdir:n,entries:u})).filter(Boolean).map(m=>({mode:m.mode,path:m.path,oid:m.oid,type:m.type}));return G1({fs:e,gitdir:n,tree:h})}async function JEe({fs:e,dir:t,gitdir:n,stashCommit:r,parentCommit:s,wasStaged:i}){const a=[],o=[],l=await $h({fs:e,cache:{},dir:t,gitdir:n,trees:[Wl({ref:s}),Wl({ref:r})],map:async(c,[u,d])=>{if(c==="."||await db.isIgnored({fs:e,dir:t,gitdir:n,filepath:c}))return;const h=d?await d.type():await u.type();if(h!=="tree"&&h!=="blob")return;if(!d&&u){const y=h==="tree"?"rmdir":"rm";return h==="tree"&&a.push(c),h==="blob"&&i&&o.push({filepath:c,oid:await u.oid()}),{method:y,filepath:c}}const m=await d.oid();if(!u||await u.oid()!==m)return h==="tree"?{method:"mkdir",filepath:c}:(i&&o.push({filepath:c,oid:m,stats:await e.lstat($t.join(t,c))}),{method:"write",filepath:c,oid:m})}});await _y({fs:e,gitdir:n,dirRemoved:a,ops:l},async()=>{for(const c of l){const u=$t.join(t,c.filepath);switch(c.method){case"rmdir":await e.rmdir(u);break;case"mkdir":await e.mkdir(u);break;case"rm":await e.rm(u);break;case"write":if(!a.some(d=>u.startsWith(d))){const{object:d}=await Xs({fs:e,cache:{},gitdir:n,oid:c.oid});await e.exists(u)&&await e.rm(u),await e.write(u,d)}break}}}),await ua.acquire({fs:e,gitdir:n,cache:{}},async c=>{o.forEach(({filepath:u,stats:d,oid:h})=>{c.insert({filepath:u,stats:d,oid:h})})})}class Ud{constructor({fs:t,dir:n,gitdir:r=$t.join(n,".git")}){Object.assign(this,{fs:t,dir:n,gitdir:r,_author:null})}static get refStash(){return"refs/stash"}static get refLogsStash(){return"logs/refs/stash"}get refStashPath(){return $t.join(this.gitdir,Ud.refStash)}get refLogsStashPath(){return $t.join(this.gitdir,Ud.refLogsStash)}async getAuthor(){if(!this._author&&(this._author=await zh({fs:this.fs,gitdir:this.gitdir,author:{}}),!this._author))throw new Ua("author");return this._author}async getStashSHA(t,n){return await this.fs.exists(this.refStashPath)?(n||await this.readStashReflogs({parsed:!1}))[t].split(" ")[1]:null}async writeStashCommit({message:t,tree:n,parent:r}){return SZ({fs:this.fs,gitdir:this.gitdir,commit:{message:t,tree:n,parent:r,author:await this.getAuthor(),committer:await this.getAuthor()}})}async readStashCommit(t){const n=await this.readStashReflogs({parsed:!1});if(t!==0&&(t<0||t>n.length-1))throw new $c(`stash@${t}`,"number that is in range of [0, num of stash pushed]");const r=await this.getStashSHA(t,n);return r?wy({fs:this.fs,cache:{},gitdir:this.gitdir,oid:r}):{}}async writeStashRef(t){return Yt.writeRef({fs:this.fs,gitdir:this.gitdir,ref:Ud.refStash,value:t})}async writeStashReflogEntry({stashCommit:t,message:n}){const r=await this.getAuthor(),s=lk.createStashReflogEntry(r,t,n),i=this.refLogsStashPath;await _y({filepath:i,entry:s},async()=>{const a=await this.fs.exists(i)?await this.fs.read(i,"utf8"):"";await this.fs.write(i,a+s,"utf8")})}async readStashReflogs({parsed:t=!1}){if(!await this.fs.exists(this.refLogsStashPath))return[];const r=(await this.fs.read(this.refLogsStashPath)).toString();return lk.getStashReflogEntry(r,t)}}async function QEe({fs:e,dir:t,gitdir:n,message:r=""}){const s=new Ud({fs:e,dir:t,gitdir:n});await s.getAuthor();const i=await op({fs:e,gitdir:n,fullname:!1}),a=await Yt.resolve({fs:e,gitdir:n,ref:"HEAD"}),l=(await wZ({fs:e,dir:t,gitdir:n,oid:a})).commit.message,c=[a];let u=null,d=Wl({ref:"HEAD"});const h=await Mz({fs:e,dir:t,gitdir:n,treePair:[Wl({ref:"HEAD"}),"stage"]});if(h){const v=await s.writeStashCommit({message:`stash-Index: WIP on ${i} - ${new Date().toISOString()}`,tree:h,parent:c});c.push(v),u=h,d=ab()}const m=await Mz({fs:e,dir:t,gitdir:n,treePair:[d,"workdir"]});if(m){const v=await s.writeStashCommit({message:`stash-WorkDir: WIP on ${i} - ${new Date().toISOString()}`,tree:m,parent:[c[c.length-1]]});c.push(v),u=m}if(!u||!h&&!m)throw new As("changes, nothing to stash");const y=(r.trim()||`WIP on ${i}`)+`: ${a.substring(0,7)} ${l}`,b=await s.writeStashCommit({message:y,tree:u,parent:c});return await s.writeStashRef(b),await s.writeStashReflogEntry({stashCommit:b,message:y}),await iZ({fs:e,dir:t,gitdir:n,ref:i,track:!1,force:!0}),b}async function CZ({fs:e,dir:t,gitdir:n,refIdx:r=0}){const i=await new Ud({fs:e,dir:t,gitdir:n}).readStashCommit(r),{parent:a=null}=i.commit?i.commit:{};if(!(!a||!Array.isArray(a)))for(let o=0;o<a.length-1;o++){const c=(await wy({fs:e,cache:{},gitdir:n,oid:a[o+1]})).commit.message.startsWith("stash-Index");await JEe({fs:e,dir:t,gitdir:n,stashCommit:a[o+1],parentCommit:a[o],wasStaged:c})}}async function kZ({fs:e,dir:t,gitdir:n,refIdx:r=0}){const s=new Ud({fs:e,dir:t,gitdir:n});if(!(await s.readStashCommit(r)).commit)return;const a=s.refStashPath;await _y(a,async()=>{await e.exists(a)&&await e.rm(a)});const o=await s.readStashReflogs({parsed:!1});if(!o.length)return;o.splice(r,1);const l=s.refLogsStashPath;await _y({reflogEntries:o,stashReflogPath:l,stashMgr:s},async()=>{if(o.length){await e.write(l,o.join(`
`),"utf8");const c=o[o.length-1].split(" ")[1];await s.writeStashRef(c)}else await e.rm(l)})}async function eTe({fs:e,dir:t,gitdir:n}){return new Ud({fs:e,dir:t,gitdir:n}).readStashReflogs({parsed:!0})}async function tTe({fs:e,dir:t,gitdir:n}){const r=new Ud({fs:e,dir:t,gitdir:n}),s=[r.refStashPath,r.refLogsStashPath];await _y(s,async()=>{await Promise.all(s.map(async i=>{if(await e.exists(i))return e.rm(i)}))})}async function nTe({fs:e,dir:t,gitdir:n,refIdx:r=0}){await CZ({fs:e,dir:t,gitdir:n,refIdx:r}),await kZ({fs:e,dir:t,gitdir:n,refIdx:r})}async function rTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),op:r="push",message:s="",refIdx:i=0}){ut("fs",e),ut("dir",t),ut("gitdir",n),ut("op",r);const a={push:QEe,apply:CZ,drop:kZ,list:eTe,clear:tTe,pop:nTe},o=["apply","drop","pop"];try{const l=new Tn(e);["refs","logs","logs/refs"].map(d=>$t.join(n,d)).forEach(async d=>{await l.exists(d)||await l.mkdir(d)});const u=a[r];if(u){if(o.includes(r)&&i<0)throw new $c(`stash@${i}`,"number that is in range of [0, num of stash pushed]");return await u({fs:l,dir:t,gitdir:n,message:s,refIdx:i})}throw new Error(`To be implemented: ${r}`)}catch(l){throw l.caller="git.stash",l}}async function sTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),filepath:r,cache:s={}}){try{ut("fs",e),ut("gitdir",n),ut("filepath",r);const i=new Tn(e);if(await db.isIgnored({fs:i,gitdir:n,dir:t,filepath:r}))return"ignored";const o=await iTe({fs:i,cache:s,gitdir:n}),l=await EZ({fs:i,cache:s,gitdir:n,tree:o,path:r}),c=await ua.acquire({fs:i,gitdir:n,cache:s},async function(b){for(const v of b)if(v.path===r)return v;return null}),u=await i.lstat($t.join(t,r)),d=l!==null,h=c!==null,m=u!==null,y=async()=>{if(h&&!ek(c,u))return c.oid;{const b=await i.read($t.join(t,r)),v=await _Z({gitdir:n,type:"blob",object:b});return h&&c.oid===v&&u.size!==-1&&ua.acquire({fs:i,gitdir:n,cache:s},async function(x){x.insert({filepath:r,stats:u,oid:v})}),v}};if(!d&&!m&&!h)return"absent";if(!d&&!m&&h)return"*absent";if(!d&&m&&!h)return"*added";if(!d&&m&&h)return await y()===c.oid?"added":"*added";if(d&&!m&&!h)return"deleted";if(d&&!m&&h)return l===c.oid,"*deleted";if(d&&m&&!h)return await y()===l?"*undeleted":"*undeletemodified";if(d&&m&&h){const b=await y();return b===l?b===c.oid?"unmodified":"*unmodified":b===c.oid?"modified":"*modified"}}catch(i){throw i.caller="git.status",i}}async function EZ({fs:e,cache:t,gitdir:n,tree:r,path:s}){typeof s=="string"&&(s=s.split("/"));const i=s.shift();for(const a of r)if(a.path===i){if(s.length===0)return a.oid;const{type:o,object:l}=await Xs({fs:e,cache:t,gitdir:n,oid:a.oid});if(o==="tree"){const c=Uo.from(l);return EZ({fs:e,cache:t,gitdir:n,tree:c,path:s})}if(o==="blob")throw new yo(a.oid,o,"blob",s.join("/"))}return null}async function iTe({fs:e,cache:t,gitdir:n}){let r;try{r=await Yt.resolve({fs:e,gitdir:n,ref:"HEAD"})}catch(i){if(i instanceof As)return[]}const{tree:s}=await fb({fs:e,cache:t,gitdir:n,oid:r});return s}async function aTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r="HEAD",filepaths:s=["."],filter:i,cache:a={},ignored:o=!1}){try{ut("fs",e),ut("gitdir",n),ut("ref",r);const l=new Tn(e);return await $h({fs:l,cache:a,dir:t,gitdir:n,trees:[Wl({ref:r}),W1(),ab()],map:async function(c,[u,d,h]){if(!u&&!h&&d&&!o&&await db.isIgnored({fs:l,dir:t,filepath:c})||!s.some(T=>sZ(c,T)))return null;if(i&&!i(c))return;const[m,y,b]=await Promise.all([u&&u.type(),d&&d.type(),h&&h.type()]),v=[m,y,b].includes("blob");if((m==="tree"||m==="special")&&!v)return;if(m==="commit")return null;if((y==="tree"||y==="special")&&!v)return;if(b==="commit")return null;if((b==="tree"||b==="special")&&!v)return;const x=m==="blob"?await u.oid():void 0,w=b==="blob"?await h.oid():void 0;let S;m!=="blob"&&y==="blob"&&b!=="blob"?S="42":y==="blob"&&(S=await d.oid());const k=[void 0,x,S,w],C=k.map(T=>k.indexOf(T));return C.shift(),[c,...C]}})}catch(l){throw l.caller="git.statusMatrix",l}}async function oTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,object:s,force:i=!1}){try{ut("fs",e),ut("gitdir",n),ut("ref",r);const a=new Tn(e);if(r===void 0)throw new Do("ref");r=r.startsWith("refs/tags/")?r:`refs/tags/${r}`;const o=await Yt.resolve({fs:a,gitdir:n,ref:s||"HEAD"});if(!i&&await Yt.exists({fs:a,gitdir:n,ref:r}))throw new Vc("tag",r);await Yt.writeRef({fs:a,gitdir:n,ref:r,value:o})}catch(a){throw a.caller="git.tag",a}}async function lTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),cache:r={},filepath:s,oid:i,mode:a,add:o,remove:l,force:c}){try{ut("fs",e),ut("gitdir",n),ut("filepath",s);const u=new Tn(e);if(l)return await ua.acquire({fs:u,gitdir:n,cache:r},async function(h){if(!c){const m=await u.lstat($t.join(t,s));if(m){if(m.isDirectory())throw new Bh("directory");return}}h.has({filepath:s})&&h.delete({filepath:s})});let d;if(!i){if(d=await u.lstat($t.join(t,s)),!d)throw new As(`file at "${s}" on disk and "remove" not set`);if(d.isDirectory())throw new Bh("directory")}return await ua.acquire({fs:u,gitdir:n,cache:r},async function(h){if(!o&&!h.has({filepath:s}))throw new As(`file at "${s}" in index and "add" not set`);let m;if(i)m={ctime:new Date(0),mtime:new Date(0),dev:0,ino:0,mode:a,uid:0,gid:0,size:0};else{m=d;const y=m.isSymbolicLink()?await u.readlink($t.join(t,s)):await u.read($t.join(t,s));i=await Go({fs:u,gitdir:n,type:"blob",format:"content",object:y})}return h.insert({filepath:s,oid:i,stats:m}),i})}catch(u){throw u.caller="git.updateIndex",u}}function cTe(){try{return fT.version}catch(e){throw e.caller="git.version",e}}async function uTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),trees:r,map:s,reduce:i,iterate:a,cache:o={}}){try{return ut("fs",e),ut("gitdir",n),ut("trees",r),await $h({fs:new Tn(e),cache:o,dir:t,gitdir:n,trees:r,map:s,reduce:i,iterate:a})}catch(l){throw l.caller="git.walk",l}}async function dTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),blob:r}){try{return ut("fs",e),ut("gitdir",n),ut("blob",r),await Go({fs:new Tn(e),gitdir:n,type:"blob",object:r,format:"content"})}catch(s){throw s.caller="git.writeBlob",s}}async function fTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),commit:r}){try{return ut("fs",e),ut("gitdir",n),ut("commit",r),await SZ({fs:new Tn(e),gitdir:n,commit:r})}catch(s){throw s.caller="git.writeCommit",s}}async function hTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),type:r,object:s,format:i="parsed",oid:a,encoding:o=void 0}){try{const l=new Tn(e);if(i==="parsed"){switch(r){case"commit":s=Zs.from(s).toObject();break;case"tree":s=Uo.from(s).toObject();break;case"blob":s=cn.from(s,o);break;case"tag":s=ao.from(s).toObject();break;default:throw new yo(a||"",r,"blob|commit|tag|tree")}i="content"}return a=await Go({fs:l,gitdir:n,type:r,object:s,oid:a,format:i}),a}catch(l){throw l.caller="git.writeObject",l}}async function pTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),ref:r,value:s,force:i=!1,symbolic:a=!1}){try{ut("fs",e),ut("gitdir",n),ut("ref",r),ut("value",s);const o=new Tn(e);if(r!==wu.clean(r))throw new $c(r,wu.clean(r));if(!i&&await Yt.exists({fs:o,gitdir:n,ref:r}))throw new Vc("ref",r);a?await Yt.writeSymbolicRef({fs:o,gitdir:n,ref:r,value:s}):(s=await Yt.resolve({fs:o,gitdir:n,ref:s}),await Yt.writeRef({fs:o,gitdir:n,ref:r,value:s}))}catch(o){throw o.caller="git.writeRef",o}}async function mTe({fs:e,gitdir:t,tag:n}){const r=ao.from(n).toObject();return await Go({fs:e,gitdir:t,type:"tag",object:r,format:"content"})}async function gTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),tag:r}){try{return ut("fs",e),ut("gitdir",n),ut("tag",r),await mTe({fs:new Tn(e),gitdir:n,tag:r})}catch(s){throw s.caller="git.writeTag",s}}async function yTe({fs:e,dir:t,gitdir:n=$t.join(t,".git"),tree:r}){try{return ut("fs",e),ut("gitdir",n),ut("tree",r),await G1({fs:new Tn(e),gitdir:n,tree:r})}catch(s){throw s.caller="git.writeTree",s}}var qi={Errors:W2e,STAGE:ab,TREE:Wl,WORKDIR:W1,add:cke,abortMerge:ike,addNote:dke,addRemote:fke,annotatedTag:pke,branch:gke,checkout:iZ,clone:Ake,commit:Rke,getConfig:Zke,getConfigAll:Jke,setConfig:KEe,currentBranch:Nke,deleteBranch:Ike,deleteRef:jke,deleteRemote:Oke,deleteTag:Fke,expandOid:zke,expandRef:Uke,fastForward:Hke,fetch:Gke,findMergeBase:Kke,findRoot:Yke,getRemoteInfo:Qke,getRemoteInfo2:eEe,hashBlob:nEe,indexPack:sEe,init:iEe,isDescendent:aEe,isIgnored:oEe,listBranches:lEe,listFiles:uEe,listNotes:fEe,listRefs:hEe,listRemotes:mEe,listServerRefs:bEe,listTags:vEe,log:SEe,merge:CEe,packObjects:TEe,pull:AEe,push:jEe,readBlob:PEe,readCommit:wZ,readNote:DEe,readObject:FEe,readTag:BEe,readTree:$Ee,remove:zEe,removeNote:qEe,renameBranch:WEe,resetIndex:HEe,updateIndex:lTe,resolveRef:GEe,status:sTe,statusMatrix:aTe,tag:oTe,version:cTe,walk:uTe,writeBlob:dTe,writeCommit:fTe,writeObject:hTe,writeRef:pTe,writeTag:gTe,writeTree:yTe,stash:rTe};function bTe(e){let t=[e];return{next(){return Promise.resolve({done:t.length===0,value:t.pop()})},return(){return t=[],{}},[Symbol.asyncIterator](){return this}}}function vTe(e){return e[Symbol.asyncIterator]?e[Symbol.asyncIterator]():e[Symbol.iterator]?e[Symbol.iterator]():e.next?e:bTe(e)}async function xTe(e,t){const n=vTe(e);for(;;){const{value:r,done:s}=await n.next();if(r&&await t(r),s)break}n.return&&n.return()}async function wTe(e){let t=0;const n=[];await xTe(e,i=>{n.push(i),t+=i.byteLength});const r=new Uint8Array(t);let s=0;for(const i of n)r.set(i,s),s+=i.byteLength;return r}function _Te(e){if(e[Symbol.asyncIterator])return e;const t=e.getReader();return{next(){return t.read()},return(){return t.releaseLock(),{}},[Symbol.asyncIterator](){return this}}}async function STe({onProgress:e,url:t,method:n="GET",headers:r={},body:s}){s&&(s=await wTe(s));const i=await fetch(t,{method:n,headers:r,body:s}),a=i.body&&i.body.getReader?_Te(i.body):[new Uint8Array(await i.arrayBuffer())];r={};for(const[o,l]of i.headers.entries())r[o]=l;return{url:i.url,method:i.method,statusCode:i.status,statusMessage:i.statusText,body:a,headers:r}}var ww={request:STe};const _w="https://cors.isomorphic-git.org",Sy=new Map,TZ=async(e,t)=>{const{gitUserName:n,gitUserEmail:r}=pr.getState();if(!n||!r)return Te.error("Git user name and email must be configured in Settings before committing."),!1;try{const s=await qi.getConfig({fs:t,dir:e,path:"user.name"}).catch(()=>null),i=await qi.getConfig({fs:t,dir:e,path:"user.email"}).catch(()=>null);return s!==n&&await qi.setConfig({fs:t,dir:e,path:"user.name",value:n}),i!==r&&await qi.setConfig({fs:t,dir:e,path:"user.email",value:r}),!0}catch(s){return console.error("[VFS Git Op] Error checking/setting Git config:",s),Te.error(`Failed to configure Git user: ${s instanceof Error?s.message:String(s)}`),!1}},Sw=async(e,t)=>{const n=new URL(e).origin;if(console.log(`[VFS Git Op] Auth requested for ${e}`),t!=null&&t.username&&(t!=null&&t.password))return console.log(`[VFS Git Op] Using stored credentials for ${e}`),{username:t.username,password:t.password,authScheme:"Basic"};const r=Sy.get(n);if(r!=null&&r.username&&(r!=null&&r.password))return console.log(`[VFS Git Op] Using session credentials for ${e}`),{username:r.username,password:r.password,authScheme:"Basic"};console.log(`[VFS Git Op] No stored or session credentials found for ${e}. Prompting user.`);const s=window.prompt(`Enter username for ${e}`);if(!s)return Te.error("Authentication cancelled: Username not provided."),null;const i=window.prompt(`Enter password or token for ${s}@${e}`);return i?(Sy.set(n,{username:s,password:i}),console.log(`[VFS Git Op] Stored prompted credentials in session for ${n}`),{username:s,password:i,authScheme:"Basic"}):(Te.error("Authentication cancelled: Password/token not provided."),null)},Cw=(e,t)=>{const n=new URL(e).origin;return console.error(`[VFS Git Op] Auth FAILED for ${e}`,t),Sy.has(n)&&(console.log(`[VFS Git Op] Clearing failed session credentials for ${n}`),Sy.delete(n)),null},kw=(e,t)=>{console.log(`[VFS Git Op] Auth SUCCESS for ${e}`,t);const n=new URL(e).origin;!Sy.has(n)&&t.username&&t.password&&(Sy.set(n,{username:t.username,password:t.password}),console.log(`[VFS Git Op] Stored successful prompted credentials in session for ${n}`))},F0=e=>{if(e.name==="HttpError"&&e.data){const{statusCode:t,statusMessage:n,body:r}=e.data;let s="";if(r)try{const i=JSON.parse(r);s=i.message||i.error||JSON.stringify(i)}catch{s=r}return`HTTP ${t} ${n}${s?`: ${s}`:""}`}return e.name==="NotFoundError"?`Not Found: ${e.message}`:e.code==="CheckoutConflictError"?"Checkout conflict: Local changes would be overwritten.":e.code==="MergeConflictError"?"Merge conflict: Resolve conflicts manually.":e instanceof Error?e.message:String(e)},CTe=async(e,t)=>{const n=ha,r=Ur(e),s=Lu(r,".git");try{return(await n.promises.stat(s)).isDirectory()}catch(i){return i instanceof Error&&i.code==="ENOENT"||console.error(`[VFS Git Op] Error checking for .git in ${r}:`,i),!1}},AZ=async(e,t,n,r,s)=>{var o;const i=(s==null?void 0:s.fsInstance)??ha,a=Ur(e);console.log(`[VFS Git Op] Attempting to clone ${t} into ${a}`);try{let l=!1;try{await i.promises.stat(Lu(a,".git")),l=!0}catch(h){if(h.code!=="ENOENT")throw h}if(l)throw console.warn(`[VFS Git Op] Clone target ${a} already contains a .git directory.`),new Error(`Repository already cloned at ${a}.`);const c=oT(a);if(c!=="/")try{await i.promises.mkdir(c,{recursive:!0})}catch(h){if(h.code!=="EEXIST")throw h}let u=n;if(!u)try{if(u=(o=(await qi.getRemoteInfo({http:ww,url:t,corsProxy:_w,onAuth:m=>Sw(m,r),onAuthFailure:Cw,onAuthSuccess:kw})).HEAD)==null?void 0:o.replace("refs/heads/",""),!u)throw new Error("Could not determine default branch from remote.");console.log(`[VFS Git Op] No branch specified, using remote default: ${u}`)}catch(h){throw console.error("[VFS Git Op] Failed to get remote info to determine default branch:",h),new Error(`Failed to determine default branch: ${F0(h)}`)}await qi.clone({fs:i,http:ww,dir:a,corsProxy:_w,url:t,ref:u,singleBranch:!0,depth:10,onAuth:h=>Sw(h,r),onAuthFailure:Cw,onAuthSuccess:kw,onProgress:h=>{h.phase==="counting objects"&&h.total?console.log(`Clone progress: ${h.phase} ${h.loaded}/${h.total}`):h.phase==="receiving objects"&&h.total?console.log(`Clone progress: ${h.phase} ${h.loaded}/${h.total}`):console.log(`Clone progress: ${h.phase}`)}}),await i.promises.stat(Lu(a,".git"));const d=await qi.currentBranch({fs:i,dir:a,fullname:!1}).catch(()=>null);d!==u&&(console.warn(`[VFS Git Op] Cloned repo HEAD is at ${d}, expected ${u}. Checking out...`),await qi.checkout({fs:i,dir:a,ref:u})),Te.success(`Repository cloned successfully into ${a} (branch: ${u}).`),console.log(`[VFS Git Op] Clone successful for ${t}`)}catch(l){console.error(`[VFS Git Op] Git clone failed for ${t}:`,l);const c=F0(l);if(l instanceof Error&&l.message.includes("already cloned")||Te.error(`Git clone failed: ${c}`),!(l instanceof Error&&l.message.includes("already cloned")))try{console.log(`[VFS Git Op] Attempting cleanup of failed clone: ${a}`),await i.promises.rm(a,{recursive:!0,force:!0})}catch(u){console.warn("[VFS Git Op] Failed cleanup after clone error:",u)}throw l}},RZ=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ha,r=Ur(e);try{await qi.init({fs:n,dir:r}),Te.success(`Initialized empty Git repository in "${vi(r)}"`)}catch(s){throw console.error(`[VFS Git Op] Git init failed for ${r}:`,s),Te.error(`Git init failed: ${s instanceof Error?s.message:String(s)}`),s}},wD=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ha,s=Ur(e);try{if(!await TZ(s,r))throw new Error("Git user configuration is missing or invalid.");if(await qi.add({fs:r,dir:s,filepath:"."}),!(await qi.statusMatrix({fs:r,dir:s})).some(([,,c])=>c!==0)){Te.info("No changes detected to commit.");return}const l=await qi.commit({fs:r,dir:s,message:t,author:{name:pr.getState().gitUserName,email:pr.getState().gitUserEmail}});Te.success(`Changes committed: ${l.substring(0,7)}`)}catch(i){throw console.error(`[VFS Git Op] Git commit failed for ${s}:`,i),Te.error(`Git commit failed: ${i instanceof Error?i.message:String(i)}`),i}},hT=async(e,t,n,r)=>{const s=(r==null?void 0:r.fsInstance)??ha,i=Ur(e);try{if(!await TZ(i,s))throw new Error("Git user configuration is missing or invalid.");if(!t)throw new Error("Branch name must be provided for pull operation.");console.log(`[VFS Git Op] Pulling branch ${t} for ${i}`);const o=await qi.currentBranch({fs:s,dir:i,fullname:!1}).catch(()=>null);if(o!==t){console.log(`[VFS Git Op] Current branch is ${o}, switching to ${t} before pull...`);try{await qi.checkout({fs:s,dir:i,ref:t})}catch(l){if(l.code==="NotFoundError"){console.log(`[VFS Git Op] Local branch ${t} not found. Attempting to fetch and create...`);try{await qi.fetch({fs:s,http:ww,dir:i,corsProxy:_w,remote:"origin",ref:t,depth:1,singleBranch:!0,tags:!1,onAuth:c=>Sw(c,n),onAuthFailure:Cw,onAuthSuccess:kw}),await qi.branch({fs:s,dir:i,ref:t,checkout:!0}),console.log(`[VFS Git Op] Successfully created and checked out local branch ${t}.`)}catch(c){throw console.error(`[VFS Git Op] Failed to create local branch ${t} from remote:`,c),new Error(`Failed to switch to or create local branch "${t}": ${F0(c)}`)}}else throw console.error(`[VFS Git Op] Failed to checkout branch ${t}:`,l),new Error(`Failed to checkout branch "${t}": ${F0(l)}`)}}await qi.pull({fs:s,http:ww,dir:i,ref:t,singleBranch:!0,author:{name:pr.getState().gitUserName,email:pr.getState().gitUserEmail},corsProxy:_w,onAuth:l=>Sw(l,n),onAuthFailure:Cw,onAuthSuccess:kw}),Te.success(`Pulled changes successfully for "${vi(i)}"`),console.log(`[VFS Git Op] Pull successful for ${i}`)}catch(a){if(console.error(`[VFS Git Op] Git pull failed for ${i}:`,a),a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")?Te.info(`Branch "${t}" is already up-to-date.`):Te.error(`Git pull failed: ${F0(a)}`),!(a instanceof Error&&a.message.toLowerCase().includes("already up-to-date")))throw a}},_D=async(e,t,n,r)=>{var a,o;const s=(r==null?void 0:r.fsInstance)??ha,i=Ur(e);try{if(!t)throw new Error("Branch name must be provided for push operation.");console.log(`[VFS Git Op] Pushing local branch ${t} for ${i}`);const l=await qi.push({fs:s,http:ww,dir:i,corsProxy:_w,ref:t,remote:"origin",remoteRef:`refs/heads/${t}`,force:!1,onAuth:c=>Sw(c,n),onAuthFailure:Cw,onAuthSuccess:kw});if(l!=null&&l.ok)Te.success(`Pushed changes successfully for "${vi(i)}"`);else if((a=l==null?void 0:l.error)!=null&&a.includes("up-to-date"))Te.info(`Branch "${t}" already up-to-date on remote.`);else throw(o=l==null?void 0:l.error)!=null&&o.includes("rejected")?(Te.error(`Push rejected for "${vi(i)}". Pull changes first.`),new Error(l.error)):new Error((l==null?void 0:l.error)||"Push rejected by remote")}catch(l){throw console.error(`[VFS Git Op] Git push failed for ${i}:`,l),l instanceof Error&&l.message.includes("rejected")||Te.error(`Git push failed: ${F0(l)}`),l}},NZ=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ha,r=Ur(e);console.log(`[VFS Git Op] Git Status on ${r}`);try{const s=await qi.statusMatrix({fs:n,dir:r});console.log("Git Status Matrix:",s);const i=s.map(([a,o,l,c])=>{let u="";return c===2&&(u+="INDEX_Modified "),c===3&&(u+="INDEX_Added "),o===0&&l===2?u+="WT_New":o===1&&l===2?u+="WT_Modified":o===1&&l===0?u+="WT_Deleted":o===1&&l===1&&c===0&&(u="Unmodified"),(!u||u==="INDEX_Unmodified ")&&(u=`h:${o} w:${l} s:${c}`),`${a}: ${u.trim()}`}).filter(a=>!a.endsWith("Unmodified")).join(`
`);Te.info(`Git Status for "${vi(r)}":
${i||"No changes"}`,{duration:15e3})}catch(s){throw console.error(`[VFS Git Op] Git status failed for ${r}:`,s),Te.error(`Git status failed: ${s instanceof Error?s.message:String(s)}`),s}},Im=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ha,r=Ur(e);if(r!=="/")try{await n.promises.mkdir(r,{recursive:!0})}catch(s){if(s instanceof Error&&s.code==="EEXIST"){console.warn(`[VFS Op] Directory already exists or created concurrently: ${r}`);return}throw console.error(`[VFS Op] Failed to create directory ${r}:`,s),Te.error(`Error creating directory "${vi(r)}": ${s instanceof Error?s.message:String(s)}`),s}},kTe=async e=>{try{const t={backend:ACe,name:`litechat_vfs_${e}`};return await xCe(t),ha}catch(t){return console.error(`[VFS Op] Failed to initialize VFS for key "${e}":`,t),Te.error(`Failed to initialize filesystem "${e}": ${t instanceof Error?t.message:String(t)}`),null}},SD=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ha,r=Ur(e);try{try{await n.promises.stat(r)}catch(l){if(l.code==="ENOENT")return console.warn(`[VFS Op] Directory not found for listing, attempting creation: ${r}`),await Im(r,{fsInstance:n}),[];throw l}const i=(await n.promises.readdir(r)).map(async l=>{const c=Lu(r,l);try{const u=await n.promises.stat(c);return{name:l,path:c,isDirectory:u.isDirectory(),size:u.size,lastModified:u.mtime}}catch(u){return console.error(`[VFS Op] Failed to stat ${c}:`,u),null}});return(await Promise.all(i)).filter(l=>l!==null)}catch(s){throw console.error(`[VFS Op] Failed to list directory ${r}:`,s),Te.error(`Error listing files: ${s instanceof Error?s.message:String(s)}`),s}},lp=async(e,t)=>{const n=(t==null?void 0:t.fsInstance)??ha,r=Ur(e);try{const s=await n.promises.readFile(r);return Re.emit(hn.fileRead,{path:r}),s}catch(s){throw console.error(`[VFS Op] Failed to read file ${r}:`,s),Te.error(`Error reading file "${vi(r)}": ${s instanceof Error?s.message:String(s)}`),s}},pT=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ha,s=Ur(e),i=oT(s);try{i!=="/"&&await Im(i,{fsInstance:r}),await r.promises.writeFile(s,t),Re.emit(hn.fileWritten,{path:s})}catch(a){throw a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to write file ${s}:`,a),Te.error(`Error writing file "${vi(s)}": ${a instanceof Error?a.message:String(a)}`)),a}},CD=async(e,t=!1,n)=>{const r=(n==null?void 0:n.fsInstance)??ha,s=Ur(e);if(s==="/")throw Te.error("Cannot delete the root directory."),new Error("Cannot delete the root directory.");try{(await r.promises.stat(s)).isDirectory()?(await r.promises.rm(s,{recursive:t}),Re.emit(hn.fileDeleted,{path:s})):(await r.promises.unlink(s),Re.emit(hn.fileDeleted,{path:s})),Te.success(`"${vi(s)}" deleted.`)}catch(i){if(i instanceof Error&&i.code==="ENOENT"){console.warn(`[VFS Op] Item not found for deletion: ${s}`);return}throw console.error(`[VFS Op] Failed to delete ${s}:`,i),Te.error(`Error deleting "${vi(s)}": ${i instanceof Error?i.message:String(i)}`),i}},MZ=async(e,t)=>{await Im(e,t)},ETe=async(e,t,n)=>{try{const r=await lp(e,n),s=new Blob([r]),i=URL.createObjectURL(s),a=document.createElement("a");a.href=i;const o=Ur(e);a.download=t||vi(o),document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL(i)}catch(r){console.error(`[VFS Op] Failed to initiate download for ${e}:`,r),r instanceof Error&&r.message.includes("Error reading file")||Te.error(`Download failed: ${r instanceof Error?r.message:String(r)}`)}},IZ=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ha,s=Ur(t);let i=0,a=0;const o=Array.from(e);try{await Im(s,{fsInstance:r});for(const l of o){const c=Lu(s,l.name);try{const u=await l.arrayBuffer();await pT(c,new Uint8Array(u),{fsInstance:r}),i++}catch(u){a++,console.error(`[VFS Op] Failed to upload ${l.name}:`,u)}}}catch(l){a=o.length,console.error(`[VFS Op] Failed to prepare target directory ${s} for upload:`,l)}finally{a>0&&i>0?Te.warning(`Upload complete with issues. ${i} succeeded, ${a} failed.`):a===0&&i>0&&Te.success(`Successfully uploaded ${i} file(s) to ${s==="/"?"root":vi(s)}.`)}},TTe=async(e,t,n)=>{const r=ha;if(!e.name.toLowerCase().endsWith(".zip")){Te.error("Please select a valid ZIP file.");return}const s=Ur(t);let i;try{await Im(s,{fsInstance:r}),i=await fD.loadAsync(e);const a=Object.values(i.files),o=await Promise.allSettled(a.map(async d=>{const h=Lu(s,d.name);if(d.dir)await Im(h,{fsInstance:r});else{const m=await d.async("uint8array");await pT(h,m,{fsInstance:r})}return{name:d.name,isDir:d.dir}}));let l=0,c=0,u=0;o.forEach(d=>{d.status==="fulfilled"&&d.value?d.value.isDir?c++:l++:d.status==="rejected"&&(u++,console.error("[VFS Op] ZIP Extraction item failed:",d.reason))}),u>0?Te.warning(`Finished extracting "${e.name}". ${l+c} items succeeded, ${u} failed.`):Te.success(`Successfully extracted ${l} files and ${c} folders from "${e.name}" to ${s==="/"?"root":vi(s)}.`)}catch(a){a instanceof Error&&a.message.includes("Error creating directory")||(console.error(`[VFS Op] Failed to extract zip ${e.name}:`,a),Te.error(`ZIP extraction failed: ${a instanceof Error?a.message:String(a)}`))}},Iz=async(e,t="/",n)=>{const r=ha,s=new fD,i=Ur(t),a=vi(i)||"root";try{try{if(!(await r.promises.stat(i)).isDirectory()){Te.error(`Cannot export: "${a}" is not a directory.`);return}}catch(h){h instanceof Error&&h.code==="ENOENT"?Te.error(`Cannot export: Path "${a}" not found.`):Te.error(`Cannot export: Error accessing path "${a}". ${h instanceof Error?h.message:String(h)}`);return}const o=async(h,m)=>{const y=await SD(h,{fsInstance:r});for(const b of y)if(b.isDirectory){if(b.name===".git")continue;const v=m.folder(b.name);if(v)await o(b.path,v);else throw new Error(`Failed to create subfolder ${b.name} in zip.`)}else{const v=await lp(b.path,{fsInstance:r});m.file(b.name,v)}};await o(i,s);const l=await s.generateAsync({type:"blob"}),c=URL.createObjectURL(l),u=document.createElement("a");u.href=c;const d=`vfs_${a}_export.zip`;u.download=e||d,document.body.appendChild(u),u.click(),document.body.removeChild(u),URL.revokeObjectURL(c),Te.success(`"${a}" exported as ${u.download}.`)}catch(o){console.error("[VFS Op] Failed to download all as zip:",o),o instanceof Error&&(o.message.includes("Error listing files")||o.message.includes("Error reading file")||o.message.includes("Cannot export"))||Te.error(`ZIP export failed: ${o instanceof Error?o.message:String(o)}`)}},jZ=async(e,t,n)=>{const r=(n==null?void 0:n.fsInstance)??ha,s=Ur(e),i=Ur(t);if(s==="/"||i==="/")throw Te.error("Cannot rename the root directory."),new Error("Cannot rename the root directory.");if(s!==i)try{const a=oT(i);a!=="/"&&await Im(a,{fsInstance:r}),await r.promises.rename(s,i),Te.success(`Renamed "${vi(s)}" to "${vi(i)}"`)}catch(a){throw a instanceof Error&&a.code==="ENOENT"?a.message.includes("Error creating directory")||Te.error(`Rename failed: Original item "${vi(s)}" not found.`):a instanceof Error&&a.code==="EEXIST"?Te.error(`Rename failed: An item named "${vi(i)}" already exists.`):a instanceof Error&&a.message.includes("Error creating directory")||Te.error(`Rename failed: ${a instanceof Error?a.message:String(a)}`),console.error(`[VFS Op] Failed to rename ${s} to ${i}:`,a),a}},ATe=1024*5,RTe=(e,t)=>{try{const n=atob(e),r=new Array(n.length);for(let a=0;a<n.length;a++)r[a]=n.charCodeAt(a);const s=new Uint8Array(r),i=new Blob([s],{type:t});return URL.createObjectURL(i)}catch(n){return console.error("Error creating blob URL from base64:",n),null}},jz=e=>{let t=null;if(e.contentText!==void 0)t=new Blob([e.contentText],{type:e.type});else if(e.contentBase64!==void 0)try{const n=atob(e.contentBase64),r=new Array(n.length);for(let i=0;i<n.length;i++)r[i]=n.charCodeAt(i);const s=new Uint8Array(r);t=new Blob([s],{type:e.type})}catch(n){return console.error("Failed to reconstruct file from base64:",n),null}return t?new File([t],e.name,{type:e.type}):(console.error(`Failed to reconstruct file "${e.name}": No content found in metadata.`),null)},PZ=({fileMeta:e,onRemove:t,isReadOnly:n=!1})=>{const[r,s]=E.useState(null),[i,a]=E.useState(null),[o,l]=E.useState(!1),[c,u]=E.useState(!1),[d,h]=E.useState(!0),m=e.type||"application/octet-stream",y=tw(e.name,m),b=m.startsWith("image/"),v=m.startsWith("audio/"),x=m.startsWith("video/"),w=e.source==="vfs";E.useEffect(()=>{let I=null;return a(null),e.source==="direct"&&!y&&e.contentBase64?(I=RTe(e.contentBase64,m),I||a("Failed to decode file content for preview."),s(I)):s(null),e.source==="direct"&&y&&e.contentText&&e.contentText.length>ATe?a(`Text file too large for preview (${(e.size/1024).toFixed(1)} KB).`):e.source==="direct"&&y&&e.contentText===void 0&&a("Text content missing from metadata."),()=>{I&&(URL.revokeObjectURL(I),s(null))}},[e.id,e.size,e.source,e.contentBase64,e.contentText,m,y]);const S=async()=>{if(e.source==="vfs"){Te.info("File is already in VFS.");return}const I=jz(e);if(!I){Te.error("Cannot add to VFS: Failed to reconstruct file data.");return}l(!0);try{await IZ([I],"/"),Te.success(`"${e.name}" added to VFS root.`)}catch(O){console.error("Failed to add file to VFS:",O),Te.error(`Failed to add "${e.name}" to VFS.`)}finally{l(!1)}},k=async()=>{u(!0);try{let I;if(e.source==="vfs"&&e.path){const D=await lp(e.path);I=new Blob([D],{type:m})}else{const D=jz(e);if(!D)throw new Error("Could not reconstruct file data.");I=D}const O=URL.createObjectURL(I),B=document.createElement("a");B.href=O,B.download=e.name,document.body.appendChild(B),B.click(),document.body.removeChild(B),URL.revokeObjectURL(O)}catch(I){console.error("Failed to download file:",I),Te.error(`Download failed: ${I instanceof Error?I.message:String(I)}`)}finally{u(!1)}},C=()=>h(I=>!I),T=()=>w?f.jsx(GP,{className:"h-5 w-5 text-cyan-500"}):y?f.jsx(nj,{className:"h-5 w-5 text-blue-500"}):b?f.jsx(Ah,{className:"h-5 w-5 text-purple-500"}):v?f.jsx(hge,{className:"h-5 w-5 text-green-500"}):x?f.jsx(l0e,{className:"h-5 w-5 text-orange-500"}):f.jsx(kme,{className:"h-5 w-5 text-muted-foreground"}),A=()=>w?f.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"VFS file attached. Content will be loaded when sent."}):i?f.jsxs("div",{className:"p-2 text-xs text-destructive flex items-center gap-1",children:[f.jsx(Kl,{className:"h-4 w-4"}),f.jsx("span",{children:i})]}):y&&e.contentText!==void 0?f.jsx(Qy,{lang:m==="text/markdown"?"markdown":"text",code:e.contentText,filepath:e.name}):b&&r?f.jsx("img",{src:r,alt:e.name,className:"max-w-full max-h-64 object-contain rounded"}):v&&r?f.jsx("audio",{controls:!0,src:r,className:"w-full",children:"Your browser does not support the audio element."}):x&&r?f.jsx("video",{controls:!0,src:r,className:"max-w-full max-h-64 rounded",children:"Your browser does not support the video tag."}):f.jsx("p",{className:"p-2 text-xs text-muted-foreground italic",children:"Preview not available for this file type or content missing."}),N=E.useMemo(()=>{let I="File";return w?I="VFS File":y?I="Text":b?I="Image":v?I="Audio":x&&(I="Video"),`${I} (${yw(e.size)})`},[w,y,b,v,x,e.size]);return f.jsxs("div",{className:"border rounded-md overflow-hidden bg-card shadow-sm my-1",children:[f.jsxs("div",{className:"flex items-center justify-between p-2 border-b bg-muted/30",children:[f.jsxs("div",{className:"flex items-center gap-2 min-w-0",children:[T(),f.jsx("span",{className:"text-sm font-medium truncate",title:e.name,children:e.name}),f.jsxs("span",{className:"text-xs text-muted-foreground flex-shrink-0",children:["(",yw(e.size),")"]}),w&&e.path&&f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsxs("span",{className:"text-xs text-cyan-400 truncate max-w-[100px]",children:["(VFS: ",e.path,")"]})}),f.jsx(Cr,{children:f.jsxs("p",{children:["From VFS: ",e.path]})})]})})]}),f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:k,disabled:c,"aria-label":"Download file",children:c?f.jsx(Jn,{className:"h-3.5 w-3.5 animate-spin"}):f.jsx(Tc,{className:"h-3.5 w-3.5"})})}),f.jsx(Cr,{children:"Download File"})]})}),f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:C,"aria-label":d?"Unfold preview":"Fold preview",children:f.jsx(vE,{className:"h-3.5 w-3.5"})})}),f.jsx(Cr,{side:"top",children:d?"Unfold":"Fold"})]})}),!n&&t&&f.jsxs(f.Fragment,{children:[e.source==="direct"&&f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:S,disabled:o,"aria-label":"Add to VFS",children:o?f.jsx(Jn,{className:"h-3.5 w-3.5 animate-spin"}):f.jsx(WP,{className:"h-3.5 w-3.5"})})}),f.jsx(Cr,{children:"Add to VFS"})]})}),f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{variant:"ghost",size:"icon",className:"h-6 w-6 text-destructive hover:text-destructive/80",onClick:()=>t(e.id),"aria-label":"Remove file",children:f.jsx(Pi,{className:"h-3.5 w-3.5"})})}),f.jsx(Cr,{children:"Remove from Prompt"})]})})]})]})]}),d?f.jsx("div",{className:"p-2 text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20",onClick:C,children:N}):f.jsx("div",{className:Ze("p-2 max-h-80 overflow-y-auto"),children:A()})]})},OZ=6048e5,NTe=864e5,DZ=6e4,FZ=36e5,YS=43200,Pz=1440,Oz=Symbol.for("constructDateFrom");function xi(e,t){return typeof e=="function"?e(t):e&&typeof e=="object"&&Oz in e?e[Oz](t):e instanceof Date?new e.constructor(t):new Date(t)}function Wr(e,t){return xi(t||e,e)}function LZ(e,t,n){const r=Wr(e,n==null?void 0:n.in);return isNaN(t)?xi(e,NaN):(t&&r.setDate(r.getDate()+t),r)}function BZ(e,t,n){const r=Wr(e,n==null?void 0:n.in);if(isNaN(t))return xi(e,NaN);if(!t)return r;const s=r.getDate(),i=xi(e,r.getTime());i.setMonth(r.getMonth()+t+1,0);const a=i.getDate();return s>=a?i:(r.setFullYear(i.getFullYear(),i.getMonth(),s),r)}let MTe={};function hb(){return MTe}function Cy(e,t){var o,l,c,u;const n=hb(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=Wr(e,t==null?void 0:t.in),i=s.getDay(),a=(i<r?7:0)+i-r;return s.setDate(s.getDate()-a),s.setHours(0,0,0,0),s}function Ew(e,t){return Cy(e,{...t,weekStartsOn:1})}function $Z(e,t){const n=Wr(e,t==null?void 0:t.in),r=n.getFullYear(),s=xi(n,0);s.setFullYear(r+1,0,4),s.setHours(0,0,0,0);const i=Ew(s),a=xi(n,0);a.setFullYear(r,0,4),a.setHours(0,0,0,0);const o=Ew(a);return n.getTime()>=i.getTime()?r+1:n.getTime()>=o.getTime()?r:r-1}function ck(e){const t=Wr(e),n=new Date(Date.UTC(t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()));return n.setUTCFullYear(t.getFullYear()),+e-+n}function cp(e,...t){const n=xi.bind(null,e||t.find(r=>typeof r=="object"));return t.map(n)}function Tw(e,t){const n=Wr(e,t==null?void 0:t.in);return n.setHours(0,0,0,0),n}function zZ(e,t,n){const[r,s]=cp(n==null?void 0:n.in,e,t),i=Tw(r),a=Tw(s),o=+i-ck(i),l=+a-ck(a);return Math.round((o-l)/NTe)}function ITe(e,t){const n=$Z(e,t),r=xi(e,0);return r.setFullYear(n,0,4),r.setHours(0,0,0,0),Ew(r)}function jTe(e,t,n){return LZ(e,t*7,n)}function PTe(e,t,n){return BZ(e,t*12,n)}function OTe(e,t){let n,r=t==null?void 0:t.in;return e.forEach(s=>{!r&&typeof s=="object"&&(r=xi.bind(null,s));const i=Wr(s,r);(!n||n<i||isNaN(+i))&&(n=i)}),xi(r,n||NaN)}function DTe(e,t){let n,r=t==null?void 0:t.in;return e.forEach(s=>{!r&&typeof s=="object"&&(r=xi.bind(null,s));const i=Wr(s,r);(!n||n>i||isNaN(+i))&&(n=i)}),xi(r,n||NaN)}function zC(e,t){const n=+Wr(e)-+Wr(t);return n<0?-1:n>0?1:n}function FTe(e){return xi(e,Date.now())}function LTe(e,t,n){const[r,s]=cp(n==null?void 0:n.in,e,t);return+Tw(r)==+Tw(s)}function UZ(e){return e instanceof Date||typeof e=="object"&&Object.prototype.toString.call(e)==="[object Date]"}function BTe(e){return!(!UZ(e)&&typeof e!="number"||isNaN(+Wr(e)))}function qZ(e,t,n){const[r,s]=cp(n==null?void 0:n.in,e,t),i=r.getFullYear()-s.getFullYear(),a=r.getMonth()-s.getMonth();return i*12+a}function $Te(e){return t=>{const r=(e?Math[e]:Math.trunc)(t);return r===0?0:r}}function zTe(e,t){return+Wr(e)-+Wr(t)}function UTe(e,t){const n=Wr(e,t==null?void 0:t.in);return n.setHours(23,59,59,999),n}function VZ(e,t){const n=Wr(e,t==null?void 0:t.in),r=n.getMonth();return n.setFullYear(n.getFullYear(),r+1,0),n.setHours(23,59,59,999),n}function qTe(e,t){const n=Wr(e,t==null?void 0:t.in);return+UTe(n,t)==+VZ(n,t)}function VTe(e,t,n){const[r,s,i]=cp(n==null?void 0:n.in,e,e,t),a=zC(s,i),o=Math.abs(qZ(s,i));if(o<1)return 0;s.getMonth()===1&&s.getDate()>27&&s.setDate(30),s.setMonth(s.getMonth()-a*o);let l=zC(s,i)===-a;qTe(r)&&o===1&&zC(r,i)===1&&(l=!1);const c=a*(o-+l);return c===0?0:c}function WTe(e,t,n){const r=zTe(e,t)/1e3;return $Te(n==null?void 0:n.roundingMethod)(r)}function HTe(e,t){const[n,r]=cp(e,t.start,t.end);return{start:n,end:r}}function GTe(e,t){const{start:n,end:r}=HTe(t==null?void 0:t.in,e);let s=+n>+r;const i=s?+n:+r,a=s?r:n;a.setHours(0,0,0,0),a.setDate(1);let o=1;const l=[];for(;+a<=i;)l.push(xi(n,a)),a.setMonth(a.getMonth()+o);return s?l.reverse():l}function KTe(e,t){const n=Wr(e,t==null?void 0:t.in);return n.setDate(1),n.setHours(0,0,0,0),n}function YTe(e,t){const n=Wr(e,t==null?void 0:t.in),r=n.getFullYear();return n.setFullYear(r+1,0,0),n.setHours(23,59,59,999),n}function WZ(e,t){const n=Wr(e,t==null?void 0:t.in);return n.setFullYear(n.getFullYear(),0,1),n.setHours(0,0,0,0),n}function HZ(e,t){var o,l,c,u;const n=hb(),r=(t==null?void 0:t.weekStartsOn)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.weekStartsOn)??n.weekStartsOn??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.weekStartsOn)??0,s=Wr(e,t==null?void 0:t.in),i=s.getDay(),a=(i<r?-7:0)+6-(i-r);return s.setDate(s.getDate()+a),s.setHours(23,59,59,999),s}function ZTe(e,t){return HZ(e,{...t,weekStartsOn:1})}const XTe={lessThanXSeconds:{one:"less than a second",other:"less than {{count}} seconds"},xSeconds:{one:"1 second",other:"{{count}} seconds"},halfAMinute:"half a minute",lessThanXMinutes:{one:"less than a minute",other:"less than {{count}} minutes"},xMinutes:{one:"1 minute",other:"{{count}} minutes"},aboutXHours:{one:"about 1 hour",other:"about {{count}} hours"},xHours:{one:"1 hour",other:"{{count}} hours"},xDays:{one:"1 day",other:"{{count}} days"},aboutXWeeks:{one:"about 1 week",other:"about {{count}} weeks"},xWeeks:{one:"1 week",other:"{{count}} weeks"},aboutXMonths:{one:"about 1 month",other:"about {{count}} months"},xMonths:{one:"1 month",other:"{{count}} months"},aboutXYears:{one:"about 1 year",other:"about {{count}} years"},xYears:{one:"1 year",other:"{{count}} years"},overXYears:{one:"over 1 year",other:"over {{count}} years"},almostXYears:{one:"almost 1 year",other:"almost {{count}} years"}},JTe=(e,t,n)=>{let r;const s=XTe[e];return typeof s=="string"?r=s:t===1?r=s.one:r=s.other.replace("{{count}}",t.toString()),n!=null&&n.addSuffix?n.comparison&&n.comparison>0?"in "+r:r+" ago":r};function yI(e){return(t={})=>{const n=t.width?String(t.width):e.defaultWidth;return e.formats[n]||e.formats[e.defaultWidth]}}const QTe={full:"EEEE, MMMM do, y",long:"MMMM do, y",medium:"MMM d, y",short:"MM/dd/yyyy"},eAe={full:"h:mm:ss a zzzz",long:"h:mm:ss a z",medium:"h:mm:ss a",short:"h:mm a"},tAe={full:"{{date}} 'at' {{time}}",long:"{{date}} 'at' {{time}}",medium:"{{date}}, {{time}}",short:"{{date}}, {{time}}"},nAe={date:yI({formats:QTe,defaultWidth:"full"}),time:yI({formats:eAe,defaultWidth:"full"}),dateTime:yI({formats:tAe,defaultWidth:"full"})},rAe={lastWeek:"'last' eeee 'at' p",yesterday:"'yesterday at' p",today:"'today at' p",tomorrow:"'tomorrow at' p",nextWeek:"eeee 'at' p",other:"P"},sAe=(e,t,n,r)=>rAe[e];function Uv(e){return(t,n)=>{const r=n!=null&&n.context?String(n.context):"standalone";let s;if(r==="formatting"&&e.formattingValues){const a=e.defaultFormattingWidth||e.defaultWidth,o=n!=null&&n.width?String(n.width):a;s=e.formattingValues[o]||e.formattingValues[a]}else{const a=e.defaultWidth,o=n!=null&&n.width?String(n.width):e.defaultWidth;s=e.values[o]||e.values[a]}const i=e.argumentCallback?e.argumentCallback(t):t;return s[i]}}const iAe={narrow:["B","A"],abbreviated:["BC","AD"],wide:["Before Christ","Anno Domini"]},aAe={narrow:["1","2","3","4"],abbreviated:["Q1","Q2","Q3","Q4"],wide:["1st quarter","2nd quarter","3rd quarter","4th quarter"]},oAe={narrow:["J","F","M","A","M","J","J","A","S","O","N","D"],abbreviated:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],wide:["January","February","March","April","May","June","July","August","September","October","November","December"]},lAe={narrow:["S","M","T","W","T","F","S"],short:["Su","Mo","Tu","We","Th","Fr","Sa"],abbreviated:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],wide:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]},cAe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"}},uAe={narrow:{am:"a",pm:"p",midnight:"mi",noon:"n",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},abbreviated:{am:"AM",pm:"PM",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"},wide:{am:"a.m.",pm:"p.m.",midnight:"midnight",noon:"noon",morning:"in the morning",afternoon:"in the afternoon",evening:"in the evening",night:"at night"}},dAe=(e,t)=>{const n=Number(e),r=n%100;if(r>20||r<10)switch(r%10){case 1:return n+"st";case 2:return n+"nd";case 3:return n+"rd"}return n+"th"},fAe={ordinalNumber:dAe,era:Uv({values:iAe,defaultWidth:"wide"}),quarter:Uv({values:aAe,defaultWidth:"wide",argumentCallback:e=>e-1}),month:Uv({values:oAe,defaultWidth:"wide"}),day:Uv({values:lAe,defaultWidth:"wide"}),dayPeriod:Uv({values:cAe,defaultWidth:"wide",formattingValues:uAe,defaultFormattingWidth:"wide"})};function qv(e){return(t,n={})=>{const r=n.width,s=r&&e.matchPatterns[r]||e.matchPatterns[e.defaultMatchWidth],i=t.match(s);if(!i)return null;const a=i[0],o=r&&e.parsePatterns[r]||e.parsePatterns[e.defaultParseWidth],l=Array.isArray(o)?pAe(o,d=>d.test(a)):hAe(o,d=>d.test(a));let c;c=e.valueCallback?e.valueCallback(l):l,c=n.valueCallback?n.valueCallback(c):c;const u=t.slice(a.length);return{value:c,rest:u}}}function hAe(e,t){for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)&&t(e[n]))return n}function pAe(e,t){for(let n=0;n<e.length;n++)if(t(e[n]))return n}function mAe(e){return(t,n={})=>{const r=t.match(e.matchPattern);if(!r)return null;const s=r[0],i=t.match(e.parsePattern);if(!i)return null;let a=e.valueCallback?e.valueCallback(i[0]):i[0];a=n.valueCallback?n.valueCallback(a):a;const o=t.slice(s.length);return{value:a,rest:o}}}const gAe=/^(\d+)(th|st|nd|rd)?/i,yAe=/\d+/i,bAe={narrow:/^(b|a)/i,abbreviated:/^(b\.?\s?c\.?|b\.?\s?c\.?\s?e\.?|a\.?\s?d\.?|c\.?\s?e\.?)/i,wide:/^(before christ|before common era|anno domini|common era)/i},vAe={any:[/^b/i,/^(a|c)/i]},xAe={narrow:/^[1234]/i,abbreviated:/^q[1234]/i,wide:/^[1234](th|st|nd|rd)? quarter/i},wAe={any:[/1/i,/2/i,/3/i,/4/i]},_Ae={narrow:/^[jfmasond]/i,abbreviated:/^(jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec)/i,wide:/^(january|february|march|april|may|june|july|august|september|october|november|december)/i},SAe={narrow:[/^j/i,/^f/i,/^m/i,/^a/i,/^m/i,/^j/i,/^j/i,/^a/i,/^s/i,/^o/i,/^n/i,/^d/i],any:[/^ja/i,/^f/i,/^mar/i,/^ap/i,/^may/i,/^jun/i,/^jul/i,/^au/i,/^s/i,/^o/i,/^n/i,/^d/i]},CAe={narrow:/^[smtwf]/i,short:/^(su|mo|tu|we|th|fr|sa)/i,abbreviated:/^(sun|mon|tue|wed|thu|fri|sat)/i,wide:/^(sunday|monday|tuesday|wednesday|thursday|friday|saturday)/i},kAe={narrow:[/^s/i,/^m/i,/^t/i,/^w/i,/^t/i,/^f/i,/^s/i],any:[/^su/i,/^m/i,/^tu/i,/^w/i,/^th/i,/^f/i,/^sa/i]},EAe={narrow:/^(a|p|mi|n|(in the|at) (morning|afternoon|evening|night))/i,any:/^([ap]\.?\s?m\.?|midnight|noon|(in the|at) (morning|afternoon|evening|night))/i},TAe={any:{am:/^a/i,pm:/^p/i,midnight:/^mi/i,noon:/^no/i,morning:/morning/i,afternoon:/afternoon/i,evening:/evening/i,night:/night/i}},AAe={ordinalNumber:mAe({matchPattern:gAe,parsePattern:yAe,valueCallback:e=>parseInt(e,10)}),era:qv({matchPatterns:bAe,defaultMatchWidth:"wide",parsePatterns:vAe,defaultParseWidth:"any"}),quarter:qv({matchPatterns:xAe,defaultMatchWidth:"wide",parsePatterns:wAe,defaultParseWidth:"any",valueCallback:e=>e+1}),month:qv({matchPatterns:_Ae,defaultMatchWidth:"wide",parsePatterns:SAe,defaultParseWidth:"any"}),day:qv({matchPatterns:CAe,defaultMatchWidth:"wide",parsePatterns:kAe,defaultParseWidth:"any"}),dayPeriod:qv({matchPatterns:EAe,defaultMatchWidth:"any",parsePatterns:TAe,defaultParseWidth:"any"})},mT={code:"en-US",formatDistance:JTe,formatLong:nAe,formatRelative:sAe,localize:fAe,match:AAe,options:{weekStartsOn:0,firstWeekContainsDate:1}};function RAe(e,t){const n=Wr(e,t==null?void 0:t.in);return zZ(n,WZ(n))+1}function GZ(e,t){const n=Wr(e,t==null?void 0:t.in),r=+Ew(n)-+ITe(n);return Math.round(r/OZ)+1}function KZ(e,t){var u,d,h,m;const n=Wr(e,t==null?void 0:t.in),r=n.getFullYear(),s=hb(),i=(t==null?void 0:t.firstWeekContainsDate)??((d=(u=t==null?void 0:t.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??s.firstWeekContainsDate??((m=(h=s.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,a=xi((t==null?void 0:t.in)||e,0);a.setFullYear(r+1,0,i),a.setHours(0,0,0,0);const o=Cy(a,t),l=xi((t==null?void 0:t.in)||e,0);l.setFullYear(r,0,i),l.setHours(0,0,0,0);const c=Cy(l,t);return+n>=+o?r+1:+n>=+c?r:r-1}function NAe(e,t){var o,l,c,u;const n=hb(),r=(t==null?void 0:t.firstWeekContainsDate)??((l=(o=t==null?void 0:t.locale)==null?void 0:o.options)==null?void 0:l.firstWeekContainsDate)??n.firstWeekContainsDate??((u=(c=n.locale)==null?void 0:c.options)==null?void 0:u.firstWeekContainsDate)??1,s=KZ(e,t),i=xi((t==null?void 0:t.in)||e,0);return i.setFullYear(s,0,r),i.setHours(0,0,0,0),Cy(i,t)}function YZ(e,t){const n=Wr(e,t==null?void 0:t.in),r=+Cy(n,t)-+NAe(n,t);return Math.round(r/OZ)+1}function xs(e,t){const n=e<0?"-":"",r=Math.abs(e).toString().padStart(t,"0");return n+r}const lh={y(e,t){const n=e.getFullYear(),r=n>0?n:1-n;return xs(t==="yy"?r%100:r,t.length)},M(e,t){const n=e.getMonth();return t==="M"?String(n+1):xs(n+1,2)},d(e,t){return xs(e.getDate(),t.length)},a(e,t){const n=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.toUpperCase();case"aaa":return n;case"aaaaa":return n[0];case"aaaa":default:return n==="am"?"a.m.":"p.m."}},h(e,t){return xs(e.getHours()%12||12,t.length)},H(e,t){return xs(e.getHours(),t.length)},m(e,t){return xs(e.getMinutes(),t.length)},s(e,t){return xs(e.getSeconds(),t.length)},S(e,t){const n=t.length,r=e.getMilliseconds(),s=Math.trunc(r*Math.pow(10,n-3));return xs(s,t.length)}},i0={midnight:"midnight",noon:"noon",morning:"morning",afternoon:"afternoon",evening:"evening",night:"night"},Dz={G:function(e,t,n){const r=e.getFullYear()>0?1:0;switch(t){case"G":case"GG":case"GGG":return n.era(r,{width:"abbreviated"});case"GGGGG":return n.era(r,{width:"narrow"});case"GGGG":default:return n.era(r,{width:"wide"})}},y:function(e,t,n){if(t==="yo"){const r=e.getFullYear(),s=r>0?r:1-r;return n.ordinalNumber(s,{unit:"year"})}return lh.y(e,t)},Y:function(e,t,n,r){const s=KZ(e,r),i=s>0?s:1-s;if(t==="YY"){const a=i%100;return xs(a,2)}return t==="Yo"?n.ordinalNumber(i,{unit:"year"}):xs(i,t.length)},R:function(e,t){const n=$Z(e);return xs(n,t.length)},u:function(e,t){const n=e.getFullYear();return xs(n,t.length)},Q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"Q":return String(r);case"QQ":return xs(r,2);case"Qo":return n.ordinalNumber(r,{unit:"quarter"});case"QQQ":return n.quarter(r,{width:"abbreviated",context:"formatting"});case"QQQQQ":return n.quarter(r,{width:"narrow",context:"formatting"});case"QQQQ":default:return n.quarter(r,{width:"wide",context:"formatting"})}},q:function(e,t,n){const r=Math.ceil((e.getMonth()+1)/3);switch(t){case"q":return String(r);case"qq":return xs(r,2);case"qo":return n.ordinalNumber(r,{unit:"quarter"});case"qqq":return n.quarter(r,{width:"abbreviated",context:"standalone"});case"qqqqq":return n.quarter(r,{width:"narrow",context:"standalone"});case"qqqq":default:return n.quarter(r,{width:"wide",context:"standalone"})}},M:function(e,t,n){const r=e.getMonth();switch(t){case"M":case"MM":return lh.M(e,t);case"Mo":return n.ordinalNumber(r+1,{unit:"month"});case"MMM":return n.month(r,{width:"abbreviated",context:"formatting"});case"MMMMM":return n.month(r,{width:"narrow",context:"formatting"});case"MMMM":default:return n.month(r,{width:"wide",context:"formatting"})}},L:function(e,t,n){const r=e.getMonth();switch(t){case"L":return String(r+1);case"LL":return xs(r+1,2);case"Lo":return n.ordinalNumber(r+1,{unit:"month"});case"LLL":return n.month(r,{width:"abbreviated",context:"standalone"});case"LLLLL":return n.month(r,{width:"narrow",context:"standalone"});case"LLLL":default:return n.month(r,{width:"wide",context:"standalone"})}},w:function(e,t,n,r){const s=YZ(e,r);return t==="wo"?n.ordinalNumber(s,{unit:"week"}):xs(s,t.length)},I:function(e,t,n){const r=GZ(e);return t==="Io"?n.ordinalNumber(r,{unit:"week"}):xs(r,t.length)},d:function(e,t,n){return t==="do"?n.ordinalNumber(e.getDate(),{unit:"date"}):lh.d(e,t)},D:function(e,t,n){const r=RAe(e);return t==="Do"?n.ordinalNumber(r,{unit:"dayOfYear"}):xs(r,t.length)},E:function(e,t,n){const r=e.getDay();switch(t){case"E":case"EE":case"EEE":return n.day(r,{width:"abbreviated",context:"formatting"});case"EEEEE":return n.day(r,{width:"narrow",context:"formatting"});case"EEEEEE":return n.day(r,{width:"short",context:"formatting"});case"EEEE":default:return n.day(r,{width:"wide",context:"formatting"})}},e:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"e":return String(i);case"ee":return xs(i,2);case"eo":return n.ordinalNumber(i,{unit:"day"});case"eee":return n.day(s,{width:"abbreviated",context:"formatting"});case"eeeee":return n.day(s,{width:"narrow",context:"formatting"});case"eeeeee":return n.day(s,{width:"short",context:"formatting"});case"eeee":default:return n.day(s,{width:"wide",context:"formatting"})}},c:function(e,t,n,r){const s=e.getDay(),i=(s-r.weekStartsOn+8)%7||7;switch(t){case"c":return String(i);case"cc":return xs(i,t.length);case"co":return n.ordinalNumber(i,{unit:"day"});case"ccc":return n.day(s,{width:"abbreviated",context:"standalone"});case"ccccc":return n.day(s,{width:"narrow",context:"standalone"});case"cccccc":return n.day(s,{width:"short",context:"standalone"});case"cccc":default:return n.day(s,{width:"wide",context:"standalone"})}},i:function(e,t,n){const r=e.getDay(),s=r===0?7:r;switch(t){case"i":return String(s);case"ii":return xs(s,t.length);case"io":return n.ordinalNumber(s,{unit:"day"});case"iii":return n.day(r,{width:"abbreviated",context:"formatting"});case"iiiii":return n.day(r,{width:"narrow",context:"formatting"});case"iiiiii":return n.day(r,{width:"short",context:"formatting"});case"iiii":default:return n.day(r,{width:"wide",context:"formatting"})}},a:function(e,t,n){const s=e.getHours()/12>=1?"pm":"am";switch(t){case"a":case"aa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"aaa":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"aaaaa":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"aaaa":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},b:function(e,t,n){const r=e.getHours();let s;switch(r===12?s=i0.noon:r===0?s=i0.midnight:s=r/12>=1?"pm":"am",t){case"b":case"bb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"bbb":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"}).toLowerCase();case"bbbbb":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"bbbb":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},B:function(e,t,n){const r=e.getHours();let s;switch(r>=17?s=i0.evening:r>=12?s=i0.afternoon:r>=4?s=i0.morning:s=i0.night,t){case"B":case"BB":case"BBB":return n.dayPeriod(s,{width:"abbreviated",context:"formatting"});case"BBBBB":return n.dayPeriod(s,{width:"narrow",context:"formatting"});case"BBBB":default:return n.dayPeriod(s,{width:"wide",context:"formatting"})}},h:function(e,t,n){if(t==="ho"){let r=e.getHours()%12;return r===0&&(r=12),n.ordinalNumber(r,{unit:"hour"})}return lh.h(e,t)},H:function(e,t,n){return t==="Ho"?n.ordinalNumber(e.getHours(),{unit:"hour"}):lh.H(e,t)},K:function(e,t,n){const r=e.getHours()%12;return t==="Ko"?n.ordinalNumber(r,{unit:"hour"}):xs(r,t.length)},k:function(e,t,n){let r=e.getHours();return r===0&&(r=24),t==="ko"?n.ordinalNumber(r,{unit:"hour"}):xs(r,t.length)},m:function(e,t,n){return t==="mo"?n.ordinalNumber(e.getMinutes(),{unit:"minute"}):lh.m(e,t)},s:function(e,t,n){return t==="so"?n.ordinalNumber(e.getSeconds(),{unit:"second"}):lh.s(e,t)},S:function(e,t){return lh.S(e,t)},X:function(e,t,n){const r=e.getTimezoneOffset();if(r===0)return"Z";switch(t){case"X":return Lz(r);case"XXXX":case"XX":return Zp(r);case"XXXXX":case"XXX":default:return Zp(r,":")}},x:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"x":return Lz(r);case"xxxx":case"xx":return Zp(r);case"xxxxx":case"xxx":default:return Zp(r,":")}},O:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"O":case"OO":case"OOO":return"GMT"+Fz(r,":");case"OOOO":default:return"GMT"+Zp(r,":")}},z:function(e,t,n){const r=e.getTimezoneOffset();switch(t){case"z":case"zz":case"zzz":return"GMT"+Fz(r,":");case"zzzz":default:return"GMT"+Zp(r,":")}},t:function(e,t,n){const r=Math.trunc(+e/1e3);return xs(r,t.length)},T:function(e,t,n){return xs(+e,t.length)}};function Fz(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=Math.trunc(r/60),i=r%60;return i===0?n+String(s):n+String(s)+t+xs(i,2)}function Lz(e,t){return e%60===0?(e>0?"-":"+")+xs(Math.abs(e)/60,2):Zp(e,t)}function Zp(e,t=""){const n=e>0?"-":"+",r=Math.abs(e),s=xs(Math.trunc(r/60),2),i=xs(r%60,2);return n+s+t+i}const Bz=(e,t)=>{switch(e){case"P":return t.date({width:"short"});case"PP":return t.date({width:"medium"});case"PPP":return t.date({width:"long"});case"PPPP":default:return t.date({width:"full"})}},ZZ=(e,t)=>{switch(e){case"p":return t.time({width:"short"});case"pp":return t.time({width:"medium"});case"ppp":return t.time({width:"long"});case"pppp":default:return t.time({width:"full"})}},MAe=(e,t)=>{const n=e.match(/(P+)(p+)?/)||[],r=n[1],s=n[2];if(!s)return Bz(e,t);let i;switch(r){case"P":i=t.dateTime({width:"short"});break;case"PP":i=t.dateTime({width:"medium"});break;case"PPP":i=t.dateTime({width:"long"});break;case"PPPP":default:i=t.dateTime({width:"full"});break}return i.replace("{{date}}",Bz(r,t)).replace("{{time}}",ZZ(s,t))},IAe={p:ZZ,P:MAe},jAe=/^D+$/,PAe=/^Y+$/,OAe=["D","DD","YY","YYYY"];function DAe(e){return jAe.test(e)}function FAe(e){return PAe.test(e)}function LAe(e,t,n){const r=BAe(e,t,n);if(console.warn(r),OAe.includes(e))throw new RangeError(r)}function BAe(e,t,n){const r=e[0]==="Y"?"years":"days of the month";return`Use \`${e.toLowerCase()}\` instead of \`${e}\` (in \`${t}\`) for formatting ${r} to the input \`${n}\`; see: https://github.com/date-fns/date-fns/blob/master/docs/unicodeTokens.md`}const $Ae=/[yYQqMLwIdDecihHKkms]o|(\w)\1*|''|'(''|[^'])+('|$)|./g,zAe=/P+p+|P+|p+|''|'(''|[^'])+('|$)|./g,UAe=/^'([^]*?)'?$/,qAe=/''/g,VAe=/[a-zA-Z]/;function jd(e,t,n){var u,d,h,m,y,b,v,x;const r=hb(),s=(n==null?void 0:n.locale)??r.locale??mT,i=(n==null?void 0:n.firstWeekContainsDate)??((d=(u=n==null?void 0:n.locale)==null?void 0:u.options)==null?void 0:d.firstWeekContainsDate)??r.firstWeekContainsDate??((m=(h=r.locale)==null?void 0:h.options)==null?void 0:m.firstWeekContainsDate)??1,a=(n==null?void 0:n.weekStartsOn)??((b=(y=n==null?void 0:n.locale)==null?void 0:y.options)==null?void 0:b.weekStartsOn)??r.weekStartsOn??((x=(v=r.locale)==null?void 0:v.options)==null?void 0:x.weekStartsOn)??0,o=Wr(e,n==null?void 0:n.in);if(!BTe(o))throw new RangeError("Invalid time value");let l=t.match(zAe).map(w=>{const S=w[0];if(S==="p"||S==="P"){const k=IAe[S];return k(w,s.formatLong)}return w}).join("").match($Ae).map(w=>{if(w==="''")return{isToken:!1,value:"'"};const S=w[0];if(S==="'")return{isToken:!1,value:WAe(w)};if(Dz[S])return{isToken:!0,value:w};if(S.match(VAe))throw new RangeError("Format string contains an unescaped latin alphabet character `"+S+"`");return{isToken:!1,value:w}});s.localize.preprocessor&&(l=s.localize.preprocessor(o,l));const c={firstWeekContainsDate:i,weekStartsOn:a,locale:s};return l.map(w=>{if(!w.isToken)return w.value;const S=w.value;(!(n!=null&&n.useAdditionalWeekYearTokens)&&FAe(S)||!(n!=null&&n.useAdditionalDayOfYearTokens)&&DAe(S))&&LAe(S,t,String(e));const k=Dz[S[0]];return k(o,S,s.localize,c)}).join("")}function WAe(e){const t=e.match(UAe);return t?t[1].replace(qAe,"'"):e}function HAe(e,t,n){const r=hb(),s=(n==null?void 0:n.locale)??r.locale??mT,i=2520,a=zC(e,t);if(isNaN(a))throw new RangeError("Invalid time value");const o=Object.assign({},n,{addSuffix:n==null?void 0:n.addSuffix,comparison:a}),[l,c]=cp(n==null?void 0:n.in,...a>0?[t,e]:[e,t]),u=WTe(c,l),d=(ck(c)-ck(l))/1e3,h=Math.round((u-d)/60);let m;if(h<2)return n!=null&&n.includeSeconds?u<5?s.formatDistance("lessThanXSeconds",5,o):u<10?s.formatDistance("lessThanXSeconds",10,o):u<20?s.formatDistance("lessThanXSeconds",20,o):u<40?s.formatDistance("halfAMinute",0,o):u<60?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",1,o):h===0?s.formatDistance("lessThanXMinutes",1,o):s.formatDistance("xMinutes",h,o);if(h<45)return s.formatDistance("xMinutes",h,o);if(h<90)return s.formatDistance("aboutXHours",1,o);if(h<Pz){const y=Math.round(h/60);return s.formatDistance("aboutXHours",y,o)}else{if(h<i)return s.formatDistance("xDays",1,o);if(h<YS){const y=Math.round(h/Pz);return s.formatDistance("xDays",y,o)}else if(h<YS*2)return m=Math.round(h/YS),s.formatDistance("aboutXMonths",m,o)}if(m=VTe(c,l),m<12){const y=Math.round(h/YS);return s.formatDistance("xMonths",y,o)}else{const y=m%12,b=Math.trunc(m/12);return y<3?s.formatDistance("aboutXYears",b,o):y<9?s.formatDistance("overXYears",b,o):s.formatDistance("almostXYears",b+1,o)}}function XZ(e,t){return HAe(e,FTe(e),t)}function GAe(e,t){const n=Wr(e,t==null?void 0:t.in),r=n.getFullYear(),s=n.getMonth(),i=xi(n,0);return i.setFullYear(r,s+1,0),i.setHours(0,0,0,0),i.getDate()}function KAe(e,t){return Wr(e,t==null?void 0:t.in).getMonth()}function YAe(e,t){return Wr(e,t==null?void 0:t.in).getFullYear()}function ZAe(e,t){return+Wr(e)>+Wr(t)}function XAe(e,t){return+Wr(e)<+Wr(t)}function JAe(e,t,n){const[r,s]=cp(n==null?void 0:n.in,e,t);return r.getFullYear()===s.getFullYear()&&r.getMonth()===s.getMonth()}function QAe(e,t,n){const[r,s]=cp(n==null?void 0:n.in,e,t);return r.getFullYear()===s.getFullYear()}function eRe(e,t){const n=()=>xi(t==null?void 0:t.in,NaN),s=sRe(e);let i;if(s.date){const c=iRe(s.date,2);i=aRe(c.restDateString,c.year)}if(!i||isNaN(+i))return n();const a=+i;let o=0,l;if(s.time&&(o=oRe(s.time),isNaN(o)))return n();if(s.timezone){if(l=lRe(s.timezone),isNaN(l))return n()}else{const c=new Date(a+o),u=Wr(0,t==null?void 0:t.in);return u.setFullYear(c.getUTCFullYear(),c.getUTCMonth(),c.getUTCDate()),u.setHours(c.getUTCHours(),c.getUTCMinutes(),c.getUTCSeconds(),c.getUTCMilliseconds()),u}return Wr(a+o+l,t==null?void 0:t.in)}const ZS={dateTimeDelimiter:/[T ]/,timeZoneDelimiter:/[Z ]/i,timezone:/([Z+-].*)$/},tRe=/^-?(?:(\d{3})|(\d{2})(?:-?(\d{2}))?|W(\d{2})(?:-?(\d{1}))?|)$/,nRe=/^(\d{2}(?:[.,]\d*)?)(?::?(\d{2}(?:[.,]\d*)?))?(?::?(\d{2}(?:[.,]\d*)?))?$/,rRe=/^([+-])(\d{2})(?::?(\d{2}))?$/;function sRe(e){const t={},n=e.split(ZS.dateTimeDelimiter);let r;if(n.length>2)return t;if(/:/.test(n[0])?r=n[0]:(t.date=n[0],r=n[1],ZS.timeZoneDelimiter.test(t.date)&&(t.date=e.split(ZS.timeZoneDelimiter)[0],r=e.substr(t.date.length,e.length))),r){const s=ZS.timezone.exec(r);s?(t.time=r.replace(s[1],""),t.timezone=s[1]):t.time=r}return t}function iRe(e,t){const n=new RegExp("^(?:(\\d{4}|[+-]\\d{"+(4+t)+"})|(\\d{2}|[+-]\\d{"+(2+t)+"})$)"),r=e.match(n);if(!r)return{year:NaN,restDateString:""};const s=r[1]?parseInt(r[1]):null,i=r[2]?parseInt(r[2]):null;return{year:i===null?s:i*100,restDateString:e.slice((r[1]||r[2]).length)}}function aRe(e,t){if(t===null)return new Date(NaN);const n=e.match(tRe);if(!n)return new Date(NaN);const r=!!n[4],s=Vv(n[1]),i=Vv(n[2])-1,a=Vv(n[3]),o=Vv(n[4]),l=Vv(n[5])-1;if(r)return hRe(t,o,l)?cRe(t,o,l):new Date(NaN);{const c=new Date(0);return!dRe(t,i,a)||!fRe(t,s)?new Date(NaN):(c.setUTCFullYear(t,i,Math.max(s,a)),c)}}function Vv(e){return e?parseInt(e):1}function oRe(e){const t=e.match(nRe);if(!t)return NaN;const n=bI(t[1]),r=bI(t[2]),s=bI(t[3]);return pRe(n,r,s)?n*FZ+r*DZ+s*1e3:NaN}function bI(e){return e&&parseFloat(e.replace(",","."))||0}function lRe(e){if(e==="Z")return 0;const t=e.match(rRe);if(!t)return 0;const n=t[1]==="+"?-1:1,r=parseInt(t[2]),s=t[3]&&parseInt(t[3])||0;return mRe(r,s)?n*(r*FZ+s*DZ):NaN}function cRe(e,t,n){const r=new Date(0);r.setUTCFullYear(e,0,4);const s=r.getUTCDay()||7,i=(t-1)*7+n+1-s;return r.setUTCDate(r.getUTCDate()+i),r}const uRe=[31,null,31,30,31,30,31,31,30,31,30,31];function JZ(e){return e%400===0||e%4===0&&e%100!==0}function dRe(e,t,n){return t>=0&&t<=11&&n>=1&&n<=(uRe[t]||(JZ(e)?29:28))}function fRe(e,t){return t>=1&&t<=(JZ(e)?366:365)}function hRe(e,t,n){return t>=1&&t<=53&&n>=0&&n<=6}function pRe(e,t,n){return e===24?t===0&&n===0:n>=0&&n<60&&t>=0&&t<60&&e>=0&&e<25}function mRe(e,t){return t>=0&&t<=59}function gRe(e,t,n){const r=Wr(e,n==null?void 0:n.in),s=r.getFullYear(),i=r.getDate(),a=xi(e,0);a.setFullYear(s,t,15),a.setHours(0,0,0,0);const o=GAe(a);return r.setMonth(t,Math.min(i,o)),r}function yRe(e,t,n){const r=Wr(e,n==null?void 0:n.in);return isNaN(+r)?xi(e,NaN):(r.setFullYear(t),r)}const qn=({tooltipText:e,icon:t,iconClassName:n,tooltipSide:r="top",onClick:s,disabled:i,variant:a="ghost",size:o="icon",className:l,"aria-label":c,...u})=>{const d=typeof t=="function";return f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{variant:a,size:o,onClick:s,disabled:i,className:Ze("h-6 w-6",l),"aria-label":c??e,...u,children:d?f.jsx(t,{className:Ze("h-3.5 w-3.5",n)}):t})}),f.jsx(Cr,{side:r,children:f.jsx("p",{children:e})})]})})},$z={};function bRe(e){let t=$z[e];if(t)return t;t=$z[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);t.push(r)}for(let n=0;n<e.length;n++){const r=e.charCodeAt(n);t[r]="%"+("0"+r.toString(16).toUpperCase()).slice(-2)}return t}function ky(e,t){typeof t!="string"&&(t=ky.defaultChars);const n=bRe(t);return e.replace(/(%[a-f0-9]{2})+/gi,function(r){let s="";for(let i=0,a=r.length;i<a;i+=3){const o=parseInt(r.slice(i+1,i+3),16);if(o<128){s+=n[o];continue}if((o&224)===192&&i+3<a){const l=parseInt(r.slice(i+4,i+6),16);if((l&192)===128){const c=o<<6&1984|l&63;c<128?s+="":s+=String.fromCharCode(c),i+=3;continue}}if((o&240)===224&&i+6<a){const l=parseInt(r.slice(i+4,i+6),16),c=parseInt(r.slice(i+7,i+9),16);if((l&192)===128&&(c&192)===128){const u=o<<12&61440|l<<6&4032|c&63;u<2048||u>=55296&&u<=57343?s+="":s+=String.fromCharCode(u),i+=6;continue}}if((o&248)===240&&i+9<a){const l=parseInt(r.slice(i+4,i+6),16),c=parseInt(r.slice(i+7,i+9),16),u=parseInt(r.slice(i+10,i+12),16);if((l&192)===128&&(c&192)===128&&(u&192)===128){let d=o<<18&1835008|l<<12&258048|c<<6&4032|u&63;d<65536||d>1114111?s+="":(d-=65536,s+=String.fromCharCode(55296+(d>>10),56320+(d&1023))),i+=9;continue}}s+=""}return s})}ky.defaultChars=";/?:@&=+$,#";ky.componentChars="";const zz={};function vRe(e){let t=zz[e];if(t)return t;t=zz[e]=[];for(let n=0;n<128;n++){const r=String.fromCharCode(n);/^[0-9a-z]$/i.test(r)?t.push(r):t.push("%"+("0"+n.toString(16).toUpperCase()).slice(-2))}for(let n=0;n<e.length;n++)t[e.charCodeAt(n)]=e[n];return t}function Y1(e,t,n){typeof t!="string"&&(n=t,t=Y1.defaultChars),typeof n>"u"&&(n=!0);const r=vRe(t);let s="";for(let i=0,a=e.length;i<a;i++){const o=e.charCodeAt(i);if(n&&o===37&&i+2<a&&/^[0-9a-f]{2}$/i.test(e.slice(i+1,i+3))){s+=e.slice(i,i+3),i+=2;continue}if(o<128){s+=r[o];continue}if(o>=55296&&o<=57343){if(o>=55296&&o<=56319&&i+1<a){const l=e.charCodeAt(i+1);if(l>=56320&&l<=57343){s+=encodeURIComponent(e[i]+e[i+1]),i++;continue}}s+="%EF%BF%BD";continue}s+=encodeURIComponent(e[i])}return s}Y1.defaultChars=";/?:@&=+$,-_.!~*'()#";Y1.componentChars="-_.!~*'()";function kD(e){let t="";return t+=e.protocol||"",t+=e.slashes?"//":"",t+=e.auth?e.auth+"@":"",e.hostname&&e.hostname.indexOf(":")!==-1?t+="["+e.hostname+"]":t+=e.hostname||"",t+=e.port?":"+e.port:"",t+=e.pathname||"",t+=e.search||"",t+=e.hash||"",t}function uk(){this.protocol=null,this.slashes=null,this.auth=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.pathname=null}const xRe=/^([a-z0-9.+-]+:)/i,wRe=/:[0-9]*$/,_Re=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,SRe=["<",">",'"',"`"," ","\r",`
`,"	"],CRe=["{","}","|","\\","^","`"].concat(SRe),kRe=["'"].concat(CRe),Uz=["%","/","?",";","#"].concat(kRe),qz=["/","?","#"],ERe=255,Vz=/^[+a-z0-9A-Z_-]{0,63}$/,TRe=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Wz={javascript:!0,"javascript:":!0},Hz={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0};function ED(e,t){if(e&&e instanceof uk)return e;const n=new uk;return n.parse(e,t),n}uk.prototype.parse=function(e,t){let n,r,s,i=e;if(i=i.trim(),!t&&e.split("#").length===1){const c=_Re.exec(i);if(c)return this.pathname=c[1],c[2]&&(this.search=c[2]),this}let a=xRe.exec(i);if(a&&(a=a[0],n=a.toLowerCase(),this.protocol=a,i=i.substr(a.length)),(t||a||i.match(/^\/\/[^@\/]+@[^@\/]+/))&&(s=i.substr(0,2)==="//",s&&!(a&&Wz[a])&&(i=i.substr(2),this.slashes=!0)),!Wz[a]&&(s||a&&!Hz[a])){let c=-1;for(let y=0;y<qz.length;y++)r=i.indexOf(qz[y]),r!==-1&&(c===-1||r<c)&&(c=r);let u,d;c===-1?d=i.lastIndexOf("@"):d=i.lastIndexOf("@",c),d!==-1&&(u=i.slice(0,d),i=i.slice(d+1),this.auth=u),c=-1;for(let y=0;y<Uz.length;y++)r=i.indexOf(Uz[y]),r!==-1&&(c===-1||r<c)&&(c=r);c===-1&&(c=i.length),i[c-1]===":"&&c--;const h=i.slice(0,c);i=i.slice(c),this.parseHost(h),this.hostname=this.hostname||"";const m=this.hostname[0]==="["&&this.hostname[this.hostname.length-1]==="]";if(!m){const y=this.hostname.split(/\./);for(let b=0,v=y.length;b<v;b++){const x=y[b];if(x&&!x.match(Vz)){let w="";for(let S=0,k=x.length;S<k;S++)x.charCodeAt(S)>127?w+="x":w+=x[S];if(!w.match(Vz)){const S=y.slice(0,b),k=y.slice(b+1),C=x.match(TRe);C&&(S.push(C[1]),k.unshift(C[2])),k.length&&(i=k.join(".")+i),this.hostname=S.join(".");break}}}}this.hostname.length>ERe&&(this.hostname=""),m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2))}const o=i.indexOf("#");o!==-1&&(this.hash=i.substr(o),i=i.slice(0,o));const l=i.indexOf("?");return l!==-1&&(this.search=i.substr(l),i=i.slice(0,l)),i&&(this.pathname=i),Hz[n]&&this.hostname&&!this.pathname&&(this.pathname=""),this};uk.prototype.parseHost=function(e){let t=wRe.exec(e);t&&(t=t[0],t!==":"&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)};const ARe=Object.freeze(Object.defineProperty({__proto__:null,decode:ky,encode:Y1,format:kD,parse:ED},Symbol.toStringTag,{value:"Module"})),QZ=/[\0-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,eX=/[\0-\x1F\x7F-\x9F]/,RRe=/[\xAD\u0600-\u0605\u061C\u06DD\u070F\u0890\u0891\u08E2\u180E\u200B-\u200F\u202A-\u202E\u2060-\u2064\u2066-\u206F\uFEFF\uFFF9-\uFFFB]|\uD804[\uDCBD\uDCCD]|\uD80D[\uDC30-\uDC3F]|\uD82F[\uDCA0-\uDCA3]|\uD834[\uDD73-\uDD7A]|\uDB40[\uDC01\uDC20-\uDC7F]/,TD=/[!-#%-\*,-\/:;\?@\[-\]_\{\}\xA1\xA7\xAB\xB6\xB7\xBB\xBF\u037E\u0387\u055A-\u055F\u0589\u058A\u05BE\u05C0\u05C3\u05C6\u05F3\u05F4\u0609\u060A\u060C\u060D\u061B\u061D-\u061F\u066A-\u066D\u06D4\u0700-\u070D\u07F7-\u07F9\u0830-\u083E\u085E\u0964\u0965\u0970\u09FD\u0A76\u0AF0\u0C77\u0C84\u0DF4\u0E4F\u0E5A\u0E5B\u0F04-\u0F12\u0F14\u0F3A-\u0F3D\u0F85\u0FD0-\u0FD4\u0FD9\u0FDA\u104A-\u104F\u10FB\u1360-\u1368\u1400\u166E\u169B\u169C\u16EB-\u16ED\u1735\u1736\u17D4-\u17D6\u17D8-\u17DA\u1800-\u180A\u1944\u1945\u1A1E\u1A1F\u1AA0-\u1AA6\u1AA8-\u1AAD\u1B5A-\u1B60\u1B7D\u1B7E\u1BFC-\u1BFF\u1C3B-\u1C3F\u1C7E\u1C7F\u1CC0-\u1CC7\u1CD3\u2010-\u2027\u2030-\u2043\u2045-\u2051\u2053-\u205E\u207D\u207E\u208D\u208E\u2308-\u230B\u2329\u232A\u2768-\u2775\u27C5\u27C6\u27E6-\u27EF\u2983-\u2998\u29D8-\u29DB\u29FC\u29FD\u2CF9-\u2CFC\u2CFE\u2CFF\u2D70\u2E00-\u2E2E\u2E30-\u2E4F\u2E52-\u2E5D\u3001-\u3003\u3008-\u3011\u3014-\u301F\u3030\u303D\u30A0\u30FB\uA4FE\uA4FF\uA60D-\uA60F\uA673\uA67E\uA6F2-\uA6F7\uA874-\uA877\uA8CE\uA8CF\uA8F8-\uA8FA\uA8FC\uA92E\uA92F\uA95F\uA9C1-\uA9CD\uA9DE\uA9DF\uAA5C-\uAA5F\uAADE\uAADF\uAAF0\uAAF1\uABEB\uFD3E\uFD3F\uFE10-\uFE19\uFE30-\uFE52\uFE54-\uFE61\uFE63\uFE68\uFE6A\uFE6B\uFF01-\uFF03\uFF05-\uFF0A\uFF0C-\uFF0F\uFF1A\uFF1B\uFF1F\uFF20\uFF3B-\uFF3D\uFF3F\uFF5B\uFF5D\uFF5F-\uFF65]|\uD800[\uDD00-\uDD02\uDF9F\uDFD0]|\uD801\uDD6F|\uD802[\uDC57\uDD1F\uDD3F\uDE50-\uDE58\uDE7F\uDEF0-\uDEF6\uDF39-\uDF3F\uDF99-\uDF9C]|\uD803[\uDEAD\uDF55-\uDF59\uDF86-\uDF89]|\uD804[\uDC47-\uDC4D\uDCBB\uDCBC\uDCBE-\uDCC1\uDD40-\uDD43\uDD74\uDD75\uDDC5-\uDDC8\uDDCD\uDDDB\uDDDD-\uDDDF\uDE38-\uDE3D\uDEA9]|\uD805[\uDC4B-\uDC4F\uDC5A\uDC5B\uDC5D\uDCC6\uDDC1-\uDDD7\uDE41-\uDE43\uDE60-\uDE6C\uDEB9\uDF3C-\uDF3E]|\uD806[\uDC3B\uDD44-\uDD46\uDDE2\uDE3F-\uDE46\uDE9A-\uDE9C\uDE9E-\uDEA2\uDF00-\uDF09]|\uD807[\uDC41-\uDC45\uDC70\uDC71\uDEF7\uDEF8\uDF43-\uDF4F\uDFFF]|\uD809[\uDC70-\uDC74]|\uD80B[\uDFF1\uDFF2]|\uD81A[\uDE6E\uDE6F\uDEF5\uDF37-\uDF3B\uDF44]|\uD81B[\uDE97-\uDE9A\uDFE2]|\uD82F\uDC9F|\uD836[\uDE87-\uDE8B]|\uD83A[\uDD5E\uDD5F]/,tX=/[\$\+<->\^`\|~\xA2-\xA6\xA8\xA9\xAC\xAE-\xB1\xB4\xB8\xD7\xF7\u02C2-\u02C5\u02D2-\u02DF\u02E5-\u02EB\u02ED\u02EF-\u02FF\u0375\u0384\u0385\u03F6\u0482\u058D-\u058F\u0606-\u0608\u060B\u060E\u060F\u06DE\u06E9\u06FD\u06FE\u07F6\u07FE\u07FF\u0888\u09F2\u09F3\u09FA\u09FB\u0AF1\u0B70\u0BF3-\u0BFA\u0C7F\u0D4F\u0D79\u0E3F\u0F01-\u0F03\u0F13\u0F15-\u0F17\u0F1A-\u0F1F\u0F34\u0F36\u0F38\u0FBE-\u0FC5\u0FC7-\u0FCC\u0FCE\u0FCF\u0FD5-\u0FD8\u109E\u109F\u1390-\u1399\u166D\u17DB\u1940\u19DE-\u19FF\u1B61-\u1B6A\u1B74-\u1B7C\u1FBD\u1FBF-\u1FC1\u1FCD-\u1FCF\u1FDD-\u1FDF\u1FED-\u1FEF\u1FFD\u1FFE\u2044\u2052\u207A-\u207C\u208A-\u208C\u20A0-\u20C0\u2100\u2101\u2103-\u2106\u2108\u2109\u2114\u2116-\u2118\u211E-\u2123\u2125\u2127\u2129\u212E\u213A\u213B\u2140-\u2144\u214A-\u214D\u214F\u218A\u218B\u2190-\u2307\u230C-\u2328\u232B-\u2426\u2440-\u244A\u249C-\u24E9\u2500-\u2767\u2794-\u27C4\u27C7-\u27E5\u27F0-\u2982\u2999-\u29D7\u29DC-\u29FB\u29FE-\u2B73\u2B76-\u2B95\u2B97-\u2BFF\u2CE5-\u2CEA\u2E50\u2E51\u2E80-\u2E99\u2E9B-\u2EF3\u2F00-\u2FD5\u2FF0-\u2FFF\u3004\u3012\u3013\u3020\u3036\u3037\u303E\u303F\u309B\u309C\u3190\u3191\u3196-\u319F\u31C0-\u31E3\u31EF\u3200-\u321E\u322A-\u3247\u3250\u3260-\u327F\u328A-\u32B0\u32C0-\u33FF\u4DC0-\u4DFF\uA490-\uA4C6\uA700-\uA716\uA720\uA721\uA789\uA78A\uA828-\uA82B\uA836-\uA839\uAA77-\uAA79\uAB5B\uAB6A\uAB6B\uFB29\uFBB2-\uFBC2\uFD40-\uFD4F\uFDCF\uFDFC-\uFDFF\uFE62\uFE64-\uFE66\uFE69\uFF04\uFF0B\uFF1C-\uFF1E\uFF3E\uFF40\uFF5C\uFF5E\uFFE0-\uFFE6\uFFE8-\uFFEE\uFFFC\uFFFD]|\uD800[\uDD37-\uDD3F\uDD79-\uDD89\uDD8C-\uDD8E\uDD90-\uDD9C\uDDA0\uDDD0-\uDDFC]|\uD802[\uDC77\uDC78\uDEC8]|\uD805\uDF3F|\uD807[\uDFD5-\uDFF1]|\uD81A[\uDF3C-\uDF3F\uDF45]|\uD82F\uDC9C|\uD833[\uDF50-\uDFC3]|\uD834[\uDC00-\uDCF5\uDD00-\uDD26\uDD29-\uDD64\uDD6A-\uDD6C\uDD83\uDD84\uDD8C-\uDDA9\uDDAE-\uDDEA\uDE00-\uDE41\uDE45\uDF00-\uDF56]|\uD835[\uDEC1\uDEDB\uDEFB\uDF15\uDF35\uDF4F\uDF6F\uDF89\uDFA9\uDFC3]|\uD836[\uDC00-\uDDFF\uDE37-\uDE3A\uDE6D-\uDE74\uDE76-\uDE83\uDE85\uDE86]|\uD838[\uDD4F\uDEFF]|\uD83B[\uDCAC\uDCB0\uDD2E\uDEF0\uDEF1]|\uD83C[\uDC00-\uDC2B\uDC30-\uDC93\uDCA0-\uDCAE\uDCB1-\uDCBF\uDCC1-\uDCCF\uDCD1-\uDCF5\uDD0D-\uDDAD\uDDE6-\uDE02\uDE10-\uDE3B\uDE40-\uDE48\uDE50\uDE51\uDE60-\uDE65\uDF00-\uDFFF]|\uD83D[\uDC00-\uDED7\uDEDC-\uDEEC\uDEF0-\uDEFC\uDF00-\uDF76\uDF7B-\uDFD9\uDFE0-\uDFEB\uDFF0]|\uD83E[\uDC00-\uDC0B\uDC10-\uDC47\uDC50-\uDC59\uDC60-\uDC87\uDC90-\uDCAD\uDCB0\uDCB1\uDD00-\uDE53\uDE60-\uDE6D\uDE70-\uDE7C\uDE80-\uDE88\uDE90-\uDEBD\uDEBF-\uDEC5\uDECE-\uDEDB\uDEE0-\uDEE8\uDEF0-\uDEF8\uDF00-\uDF92\uDF94-\uDFCA]/,nX=/[ \xA0\u1680\u2000-\u200A\u2028\u2029\u202F\u205F\u3000]/,NRe=Object.freeze(Object.defineProperty({__proto__:null,Any:QZ,Cc:eX,Cf:RRe,P:TD,S:tX,Z:nX},Symbol.toStringTag,{value:"Module"})),MRe=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(e=>e.charCodeAt(0))),IRe=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(e=>e.charCodeAt(0)));var vI;const jRe=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),PRe=(vI=String.fromCodePoint)!==null&&vI!==void 0?vI:function(e){let t="";return e>65535&&(e-=65536,t+=String.fromCharCode(e>>>10&1023|55296),e=56320|e&1023),t+=String.fromCharCode(e),t};function ORe(e){var t;return e>=55296&&e<=57343||e>1114111?65533:(t=jRe.get(e))!==null&&t!==void 0?t:e}var la;(function(e){e[e.NUM=35]="NUM",e[e.SEMI=59]="SEMI",e[e.EQUALS=61]="EQUALS",e[e.ZERO=48]="ZERO",e[e.NINE=57]="NINE",e[e.LOWER_A=97]="LOWER_A",e[e.LOWER_F=102]="LOWER_F",e[e.LOWER_X=120]="LOWER_X",e[e.LOWER_Z=122]="LOWER_Z",e[e.UPPER_A=65]="UPPER_A",e[e.UPPER_F=70]="UPPER_F",e[e.UPPER_Z=90]="UPPER_Z"})(la||(la={}));const DRe=32;var _h;(function(e){e[e.VALUE_LENGTH=49152]="VALUE_LENGTH",e[e.BRANCH_LENGTH=16256]="BRANCH_LENGTH",e[e.JUMP_TABLE=127]="JUMP_TABLE"})(_h||(_h={}));function qj(e){return e>=la.ZERO&&e<=la.NINE}function FRe(e){return e>=la.UPPER_A&&e<=la.UPPER_F||e>=la.LOWER_A&&e<=la.LOWER_F}function LRe(e){return e>=la.UPPER_A&&e<=la.UPPER_Z||e>=la.LOWER_A&&e<=la.LOWER_Z||qj(e)}function BRe(e){return e===la.EQUALS||LRe(e)}var na;(function(e){e[e.EntityStart=0]="EntityStart",e[e.NumericStart=1]="NumericStart",e[e.NumericDecimal=2]="NumericDecimal",e[e.NumericHex=3]="NumericHex",e[e.NamedEntity=4]="NamedEntity"})(na||(na={}));var vh;(function(e){e[e.Legacy=0]="Legacy",e[e.Strict=1]="Strict",e[e.Attribute=2]="Attribute"})(vh||(vh={}));class $Re{constructor(t,n,r){this.decodeTree=t,this.emitCodePoint=n,this.errors=r,this.state=na.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=vh.Strict}startEntity(t){this.decodeMode=t,this.state=na.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(t,n){switch(this.state){case na.EntityStart:return t.charCodeAt(n)===la.NUM?(this.state=na.NumericStart,this.consumed+=1,this.stateNumericStart(t,n+1)):(this.state=na.NamedEntity,this.stateNamedEntity(t,n));case na.NumericStart:return this.stateNumericStart(t,n);case na.NumericDecimal:return this.stateNumericDecimal(t,n);case na.NumericHex:return this.stateNumericHex(t,n);case na.NamedEntity:return this.stateNamedEntity(t,n)}}stateNumericStart(t,n){return n>=t.length?-1:(t.charCodeAt(n)|DRe)===la.LOWER_X?(this.state=na.NumericHex,this.consumed+=1,this.stateNumericHex(t,n+1)):(this.state=na.NumericDecimal,this.stateNumericDecimal(t,n))}addToNumericResult(t,n,r,s){if(n!==r){const i=r-n;this.result=this.result*Math.pow(s,i)+parseInt(t.substr(n,i),s),this.consumed+=i}}stateNumericHex(t,n){const r=n;for(;n<t.length;){const s=t.charCodeAt(n);if(qj(s)||FRe(s))n+=1;else return this.addToNumericResult(t,r,n,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(t,r,n,16),-1}stateNumericDecimal(t,n){const r=n;for(;n<t.length;){const s=t.charCodeAt(n);if(qj(s))n+=1;else return this.addToNumericResult(t,r,n,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(t,r,n,10),-1}emitNumericEntity(t,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(t===la.SEMI)this.consumed+=1;else if(this.decodeMode===vh.Strict)return 0;return this.emitCodePoint(ORe(this.result),this.consumed),this.errors&&(t!==la.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(t,n){const{decodeTree:r}=this;let s=r[this.treeIndex],i=(s&_h.VALUE_LENGTH)>>14;for(;n<t.length;n++,this.excess++){const a=t.charCodeAt(n);if(this.treeIndex=zRe(r,s,this.treeIndex+Math.max(1,i),a),this.treeIndex<0)return this.result===0||this.decodeMode===vh.Attribute&&(i===0||BRe(a))?0:this.emitNotTerminatedNamedEntity();if(s=r[this.treeIndex],i=(s&_h.VALUE_LENGTH)>>14,i!==0){if(a===la.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==vh.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var t;const{result:n,decodeTree:r}=this,s=(r[n]&_h.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,s,this.consumed),(t=this.errors)===null||t===void 0||t.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(t,n,r){const{decodeTree:s}=this;return this.emitCodePoint(n===1?s[t]&~_h.VALUE_LENGTH:s[t+1],r),n===3&&this.emitCodePoint(s[t+2],r),r}end(){var t;switch(this.state){case na.NamedEntity:return this.result!==0&&(this.decodeMode!==vh.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case na.NumericDecimal:return this.emitNumericEntity(0,2);case na.NumericHex:return this.emitNumericEntity(0,3);case na.NumericStart:return(t=this.errors)===null||t===void 0||t.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case na.EntityStart:return 0}}}function rX(e){let t="";const n=new $Re(e,r=>t+=PRe(r));return function(s,i){let a=0,o=0;for(;(o=s.indexOf("&",o))>=0;){t+=s.slice(a,o),n.startEntity(i);const c=n.write(s,o+1);if(c<0){a=o+n.end();break}a=o+c,o=c===0?a+1:a}const l=t+s.slice(a);return t="",l}}function zRe(e,t,n,r){const s=(t&_h.BRANCH_LENGTH)>>7,i=t&_h.JUMP_TABLE;if(s===0)return i!==0&&r===i?n:-1;if(i){const l=r-i;return l<0||l>=s?-1:e[n+l]-1}let a=n,o=a+s-1;for(;a<=o;){const l=a+o>>>1,c=e[l];if(c<r)a=l+1;else if(c>r)o=l-1;else return e[l+s]}return-1}const URe=rX(MRe);rX(IRe);function sX(e,t=vh.Legacy){return URe(e,t)}function qRe(e){return Object.prototype.toString.call(e)}function AD(e){return qRe(e)==="[object String]"}const VRe=Object.prototype.hasOwnProperty;function WRe(e,t){return VRe.call(e,t)}function gT(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){if(n){if(typeof n!="object")throw new TypeError(n+"must be object");Object.keys(n).forEach(function(r){e[r]=n[r]})}}),e}function iX(e,t,n){return[].concat(e.slice(0,t),n,e.slice(t+1))}function RD(e){return!(e>=55296&&e<=57343||e>=64976&&e<=65007||(e&65535)===65535||(e&65535)===65534||e>=0&&e<=8||e===11||e>=14&&e<=31||e>=127&&e<=159||e>1114111)}function dk(e){if(e>65535){e-=65536;const t=55296+(e>>10),n=56320+(e&1023);return String.fromCharCode(t,n)}return String.fromCharCode(e)}const aX=/\\([!"#$%&'()*+,\-./:;<=>?@[\\\]^_`{|}~])/g,HRe=/&([a-z#][a-z0-9]{1,31});/gi,GRe=new RegExp(aX.source+"|"+HRe.source,"gi"),KRe=/^#((?:x[a-f0-9]{1,8}|[0-9]{1,8}))$/i;function YRe(e,t){if(t.charCodeAt(0)===35&&KRe.test(t)){const r=t[1].toLowerCase()==="x"?parseInt(t.slice(2),16):parseInt(t.slice(1),10);return RD(r)?dk(r):e}const n=sX(e);return n!==e?n:e}function ZRe(e){return e.indexOf("\\")<0?e:e.replace(aX,"$1")}function Ey(e){return e.indexOf("\\")<0&&e.indexOf("&")<0?e:e.replace(GRe,function(t,n,r){return n||YRe(t,r)})}const XRe=/[&<>"]/,JRe=/[&<>"]/g,QRe={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;"};function eNe(e){return QRe[e]}function Uh(e){return XRe.test(e)?e.replace(JRe,eNe):e}const tNe=/[.?*+^$[\]\\(){}|-]/g;function nNe(e){return e.replace(tNe,"\\$&")}function Fs(e){switch(e){case 9:case 32:return!0}return!1}function Aw(e){if(e>=8192&&e<=8202)return!0;switch(e){case 9:case 10:case 11:case 12:case 13:case 32:case 160:case 5760:case 8239:case 8287:case 12288:return!0}return!1}function Rw(e){return TD.test(e)||tX.test(e)}function Nw(e){switch(e){case 33:case 34:case 35:case 36:case 37:case 38:case 39:case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:case 58:case 59:case 60:case 61:case 62:case 63:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 124:case 125:case 126:return!0;default:return!1}}function yT(e){return e=e.trim().replace(/\s+/g," "),"".toLowerCase()===""&&(e=e.replace(//g,"")),e.toLowerCase().toUpperCase()}const rNe={mdurl:ARe,ucmicro:NRe},sNe=Object.freeze(Object.defineProperty({__proto__:null,arrayReplaceAt:iX,assign:gT,escapeHtml:Uh,escapeRE:nNe,fromCodePoint:dk,has:WRe,isMdAsciiPunct:Nw,isPunctChar:Rw,isSpace:Fs,isString:AD,isValidEntityCode:RD,isWhiteSpace:Aw,lib:rNe,normalizeReference:yT,unescapeAll:Ey,unescapeMd:ZRe},Symbol.toStringTag,{value:"Module"}));function iNe(e,t,n){let r,s,i,a;const o=e.posMax,l=e.pos;for(e.pos=t+1,r=1;e.pos<o;){if(i=e.src.charCodeAt(e.pos),i===93&&(r--,r===0)){s=!0;break}if(a=e.pos,e.md.inline.skipToken(e),i===91){if(a===e.pos-1)r++;else if(n)return e.pos=l,-1}}let c=-1;return s&&(c=e.pos),e.pos=l,c}function aNe(e,t,n){let r,s=t;const i={ok:!1,pos:0,str:""};if(e.charCodeAt(s)===60){for(s++;s<n;){if(r=e.charCodeAt(s),r===10||r===60)return i;if(r===62)return i.pos=s+1,i.str=Ey(e.slice(t+1,s)),i.ok=!0,i;if(r===92&&s+1<n){s+=2;continue}s++}return i}let a=0;for(;s<n&&(r=e.charCodeAt(s),!(r===32||r<32||r===127));){if(r===92&&s+1<n){if(e.charCodeAt(s+1)===32)break;s+=2;continue}if(r===40&&(a++,a>32))return i;if(r===41){if(a===0)break;a--}s++}return t===s||a!==0||(i.str=Ey(e.slice(t,s)),i.pos=s,i.ok=!0),i}function oNe(e,t,n,r){let s,i=t;const a={ok:!1,can_continue:!1,pos:0,str:"",marker:0};if(r)a.str=r.str,a.marker=r.marker;else{if(i>=n)return a;let o=e.charCodeAt(i);if(o!==34&&o!==39&&o!==40)return a;t++,i++,o===40&&(o=41),a.marker=o}for(;i<n;){if(s=e.charCodeAt(i),s===a.marker)return a.pos=i+1,a.str+=Ey(e.slice(t,i)),a.ok=!0,a;if(s===40&&a.marker===41)return a;s===92&&i+1<n&&i++,i++}return a.can_continue=!0,a.str+=Ey(e.slice(t,i)),a}const lNe=Object.freeze(Object.defineProperty({__proto__:null,parseLinkDestination:aNe,parseLinkLabel:iNe,parseLinkTitle:oNe},Symbol.toStringTag,{value:"Module"})),Vu={};Vu.code_inline=function(e,t,n,r,s){const i=e[t];return"<code"+s.renderAttrs(i)+">"+Uh(i.content)+"</code>"};Vu.code_block=function(e,t,n,r,s){const i=e[t];return"<pre"+s.renderAttrs(i)+"><code>"+Uh(e[t].content)+`</code></pre>
`};Vu.fence=function(e,t,n,r,s){const i=e[t],a=i.info?Ey(i.info).trim():"";let o="",l="";if(a){const u=a.split(/(\s+)/g);o=u[0],l=u.slice(2).join("")}let c;if(n.highlight?c=n.highlight(i.content,o,l)||Uh(i.content):c=Uh(i.content),c.indexOf("<pre")===0)return c+`
`;if(a){const u=i.attrIndex("class"),d=i.attrs?i.attrs.slice():[];u<0?d.push(["class",n.langPrefix+o]):(d[u]=d[u].slice(),d[u][1]+=" "+n.langPrefix+o);const h={attrs:d};return`<pre><code${s.renderAttrs(h)}>${c}</code></pre>
`}return`<pre><code${s.renderAttrs(i)}>${c}</code></pre>
`};Vu.image=function(e,t,n,r,s){const i=e[t];return i.attrs[i.attrIndex("alt")][1]=s.renderInlineAsText(i.children,n,r),s.renderToken(e,t,n)};Vu.hardbreak=function(e,t,n){return n.xhtmlOut?`<br />
`:`<br>
`};Vu.softbreak=function(e,t,n){return n.breaks?n.xhtmlOut?`<br />
`:`<br>
`:`
`};Vu.text=function(e,t){return Uh(e[t].content)};Vu.html_block=function(e,t){return e[t].content};Vu.html_inline=function(e,t){return e[t].content};function pb(){this.rules=gT({},Vu)}pb.prototype.renderAttrs=function(t){let n,r,s;if(!t.attrs)return"";for(s="",n=0,r=t.attrs.length;n<r;n++)s+=" "+Uh(t.attrs[n][0])+'="'+Uh(t.attrs[n][1])+'"';return s};pb.prototype.renderToken=function(t,n,r){const s=t[n];let i="";if(s.hidden)return"";s.block&&s.nesting!==-1&&n&&t[n-1].hidden&&(i+=`
`),i+=(s.nesting===-1?"</":"<")+s.tag,i+=this.renderAttrs(s),s.nesting===0&&r.xhtmlOut&&(i+=" /");let a=!1;if(s.block&&(a=!0,s.nesting===1&&n+1<t.length)){const o=t[n+1];(o.type==="inline"||o.hidden||o.nesting===-1&&o.tag===s.tag)&&(a=!1)}return i+=a?`>
`:">",i};pb.prototype.renderInline=function(e,t,n){let r="";const s=this.rules;for(let i=0,a=e.length;i<a;i++){const o=e[i].type;typeof s[o]<"u"?r+=s[o](e,i,t,n,this):r+=this.renderToken(e,i,t)}return r};pb.prototype.renderInlineAsText=function(e,t,n){let r="";for(let s=0,i=e.length;s<i;s++)switch(e[s].type){case"text":r+=e[s].content;break;case"image":r+=this.renderInlineAsText(e[s].children,t,n);break;case"html_inline":case"html_block":r+=e[s].content;break;case"softbreak":case"hardbreak":r+=`
`;break}return r};pb.prototype.render=function(e,t,n){let r="";const s=this.rules;for(let i=0,a=e.length;i<a;i++){const o=e[i].type;o==="inline"?r+=this.renderInline(e[i].children,t,n):typeof s[o]<"u"?r+=s[o](e,i,t,n,this):r+=this.renderToken(e,i,t,n)}return r};function qo(){this.__rules__=[],this.__cache__=null}qo.prototype.__find__=function(e){for(let t=0;t<this.__rules__.length;t++)if(this.__rules__[t].name===e)return t;return-1};qo.prototype.__compile__=function(){const e=this,t=[""];e.__rules__.forEach(function(n){n.enabled&&n.alt.forEach(function(r){t.indexOf(r)<0&&t.push(r)})}),e.__cache__={},t.forEach(function(n){e.__cache__[n]=[],e.__rules__.forEach(function(r){r.enabled&&(n&&r.alt.indexOf(n)<0||e.__cache__[n].push(r.fn))})})};qo.prototype.at=function(e,t,n){const r=this.__find__(e),s=n||{};if(r===-1)throw new Error("Parser rule not found: "+e);this.__rules__[r].fn=t,this.__rules__[r].alt=s.alt||[],this.__cache__=null};qo.prototype.before=function(e,t,n,r){const s=this.__find__(e),i=r||{};if(s===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};qo.prototype.after=function(e,t,n,r){const s=this.__find__(e),i=r||{};if(s===-1)throw new Error("Parser rule not found: "+e);this.__rules__.splice(s+1,0,{name:t,enabled:!0,fn:n,alt:i.alt||[]}),this.__cache__=null};qo.prototype.push=function(e,t,n){const r=n||{};this.__rules__.push({name:e,enabled:!0,fn:t,alt:r.alt||[]}),this.__cache__=null};qo.prototype.enable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const s=this.__find__(r);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[s].enabled=!0,n.push(r)},this),this.__cache__=null,n};qo.prototype.enableOnly=function(e,t){Array.isArray(e)||(e=[e]),this.__rules__.forEach(function(n){n.enabled=!1}),this.enable(e,t)};qo.prototype.disable=function(e,t){Array.isArray(e)||(e=[e]);const n=[];return e.forEach(function(r){const s=this.__find__(r);if(s<0){if(t)return;throw new Error("Rules manager: invalid rule name "+r)}this.__rules__[s].enabled=!1,n.push(r)},this),this.__cache__=null,n};qo.prototype.getRules=function(e){return this.__cache__===null&&this.__compile__(),this.__cache__[e]||[]};function Wc(e,t,n){this.type=e,this.tag=t,this.attrs=null,this.map=null,this.nesting=n,this.level=0,this.children=null,this.content="",this.markup="",this.info="",this.meta=null,this.block=!1,this.hidden=!1}Wc.prototype.attrIndex=function(t){if(!this.attrs)return-1;const n=this.attrs;for(let r=0,s=n.length;r<s;r++)if(n[r][0]===t)return r;return-1};Wc.prototype.attrPush=function(t){this.attrs?this.attrs.push(t):this.attrs=[t]};Wc.prototype.attrSet=function(t,n){const r=this.attrIndex(t),s=[t,n];r<0?this.attrPush(s):this.attrs[r]=s};Wc.prototype.attrGet=function(t){const n=this.attrIndex(t);let r=null;return n>=0&&(r=this.attrs[n][1]),r};Wc.prototype.attrJoin=function(t,n){const r=this.attrIndex(t);r<0?this.attrPush([t,n]):this.attrs[r][1]=this.attrs[r][1]+" "+n};function oX(e,t,n){this.src=e,this.env=n,this.tokens=[],this.inlineMode=!1,this.md=t}oX.prototype.Token=Wc;const cNe=/\r\n?|\n/g,uNe=/\0/g;function dNe(e){let t;t=e.src.replace(cNe,`
`),t=t.replace(uNe,""),e.src=t}function fNe(e){let t;e.inlineMode?(t=new e.Token("inline","",0),t.content=e.src,t.map=[0,1],t.children=[],e.tokens.push(t)):e.md.block.parse(e.src,e.md,e.env,e.tokens)}function hNe(e){const t=e.tokens;for(let n=0,r=t.length;n<r;n++){const s=t[n];s.type==="inline"&&e.md.inline.parse(s.content,e.md,e.env,s.children)}}function pNe(e){return/^<a[>\s]/i.test(e)}function mNe(e){return/^<\/a\s*>/i.test(e)}function gNe(e){const t=e.tokens;if(e.md.options.linkify)for(let n=0,r=t.length;n<r;n++){if(t[n].type!=="inline"||!e.md.linkify.pretest(t[n].content))continue;let s=t[n].children,i=0;for(let a=s.length-1;a>=0;a--){const o=s[a];if(o.type==="link_close"){for(a--;s[a].level!==o.level&&s[a].type!=="link_open";)a--;continue}if(o.type==="html_inline"&&(pNe(o.content)&&i>0&&i--,mNe(o.content)&&i++),!(i>0)&&o.type==="text"&&e.md.linkify.test(o.content)){const l=o.content;let c=e.md.linkify.match(l);const u=[];let d=o.level,h=0;c.length>0&&c[0].index===0&&a>0&&s[a-1].type==="text_special"&&(c=c.slice(1));for(let m=0;m<c.length;m++){const y=c[m].url,b=e.md.normalizeLink(y);if(!e.md.validateLink(b))continue;let v=c[m].text;c[m].schema?c[m].schema==="mailto:"&&!/^mailto:/i.test(v)?v=e.md.normalizeLinkText("mailto:"+v).replace(/^mailto:/,""):v=e.md.normalizeLinkText(v):v=e.md.normalizeLinkText("http://"+v).replace(/^http:\/\//,"");const x=c[m].index;if(x>h){const C=new e.Token("text","",0);C.content=l.slice(h,x),C.level=d,u.push(C)}const w=new e.Token("link_open","a",1);w.attrs=[["href",b]],w.level=d++,w.markup="linkify",w.info="auto",u.push(w);const S=new e.Token("text","",0);S.content=v,S.level=d,u.push(S);const k=new e.Token("link_close","a",-1);k.level=--d,k.markup="linkify",k.info="auto",u.push(k),h=c[m].lastIndex}if(h<l.length){const m=new e.Token("text","",0);m.content=l.slice(h),m.level=d,u.push(m)}t[n].children=s=iX(s,a,u)}}}}const lX=/\+-|\.\.|\?\?\?\?|!!!!|,,|--/,yNe=/\((c|tm|r)\)/i,bNe=/\((c|tm|r)\)/ig,vNe={c:"",r:"",tm:""};function xNe(e,t){return vNe[t.toLowerCase()]}function wNe(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&(r.content=r.content.replace(bNe,xNe)),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function _Ne(e){let t=0;for(let n=e.length-1;n>=0;n--){const r=e[n];r.type==="text"&&!t&&lX.test(r.content)&&(r.content=r.content.replace(/\+-/g,"").replace(/\.{2,}/g,"").replace(/([?!])/g,"$1..").replace(/([?!]){4,}/g,"$1$1$1").replace(/,{2,}/g,",").replace(/(^|[^-])---(?=[^-]|$)/mg,"$1").replace(/(^|\s)--(?=\s|$)/mg,"$1").replace(/(^|[^-\s])--(?=[^-\s]|$)/mg,"$1")),r.type==="link_open"&&r.info==="auto"&&t--,r.type==="link_close"&&r.info==="auto"&&t++}}function SNe(e){let t;if(e.md.options.typographer)for(t=e.tokens.length-1;t>=0;t--)e.tokens[t].type==="inline"&&(yNe.test(e.tokens[t].content)&&wNe(e.tokens[t].children),lX.test(e.tokens[t].content)&&_Ne(e.tokens[t].children))}const CNe=/['"]/,Gz=/['"]/g,Kz="";function XS(e,t,n){return e.slice(0,t)+n+e.slice(t+1)}function kNe(e,t){let n;const r=[];for(let s=0;s<e.length;s++){const i=e[s],a=e[s].level;for(n=r.length-1;n>=0&&!(r[n].level<=a);n--);if(r.length=n+1,i.type!=="text")continue;let o=i.content,l=0,c=o.length;e:for(;l<c;){Gz.lastIndex=l;const u=Gz.exec(o);if(!u)break;let d=!0,h=!0;l=u.index+1;const m=u[0]==="'";let y=32;if(u.index-1>=0)y=o.charCodeAt(u.index-1);else for(n=s-1;n>=0&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n--)if(e[n].content){y=e[n].content.charCodeAt(e[n].content.length-1);break}let b=32;if(l<c)b=o.charCodeAt(l);else for(n=s+1;n<e.length&&!(e[n].type==="softbreak"||e[n].type==="hardbreak");n++)if(e[n].content){b=e[n].content.charCodeAt(0);break}const v=Nw(y)||Rw(String.fromCharCode(y)),x=Nw(b)||Rw(String.fromCharCode(b)),w=Aw(y),S=Aw(b);if(S?d=!1:x&&(w||v||(d=!1)),w?h=!1:v&&(S||x||(h=!1)),b===34&&u[0]==='"'&&y>=48&&y<=57&&(h=d=!1),d&&h&&(d=v,h=x),!d&&!h){m&&(i.content=XS(i.content,u.index,Kz));continue}if(h)for(n=r.length-1;n>=0;n--){let k=r[n];if(r[n].level<a)break;if(k.single===m&&r[n].level===a){k=r[n];let C,T;m?(C=t.md.options.quotes[2],T=t.md.options.quotes[3]):(C=t.md.options.quotes[0],T=t.md.options.quotes[1]),i.content=XS(i.content,u.index,T),e[k.token].content=XS(e[k.token].content,k.pos,C),l+=T.length-1,k.token===s&&(l+=C.length-1),o=i.content,c=o.length,r.length=n;continue e}}d?r.push({token:s,pos:u.index,single:m,level:a}):h&&m&&(i.content=XS(i.content,u.index,Kz))}}}function ENe(e){if(e.md.options.typographer)for(let t=e.tokens.length-1;t>=0;t--)e.tokens[t].type!=="inline"||!CNe.test(e.tokens[t].content)||kNe(e.tokens[t].children,e)}function TNe(e){let t,n;const r=e.tokens,s=r.length;for(let i=0;i<s;i++){if(r[i].type!=="inline")continue;const a=r[i].children,o=a.length;for(t=0;t<o;t++)a[t].type==="text_special"&&(a[t].type="text");for(t=n=0;t<o;t++)a[t].type==="text"&&t+1<o&&a[t+1].type==="text"?a[t+1].content=a[t].content+a[t+1].content:(t!==n&&(a[n]=a[t]),n++);t!==n&&(a.length=n)}}const xI=[["normalize",dNe],["block",fNe],["inline",hNe],["linkify",gNe],["replacements",SNe],["smartquotes",ENe],["text_join",TNe]];function ND(){this.ruler=new qo;for(let e=0;e<xI.length;e++)this.ruler.push(xI[e][0],xI[e][1])}ND.prototype.process=function(e){const t=this.ruler.getRules("");for(let n=0,r=t.length;n<r;n++)t[n](e)};ND.prototype.State=oX;function Wu(e,t,n,r){this.src=e,this.md=t,this.env=n,this.tokens=r,this.bMarks=[],this.eMarks=[],this.tShift=[],this.sCount=[],this.bsCount=[],this.blkIndent=0,this.line=0,this.lineMax=0,this.tight=!1,this.ddIndent=-1,this.listIndent=-1,this.parentType="root",this.level=0;const s=this.src;for(let i=0,a=0,o=0,l=0,c=s.length,u=!1;a<c;a++){const d=s.charCodeAt(a);if(!u)if(Fs(d)){o++,d===9?l+=4-l%4:l++;continue}else u=!0;(d===10||a===c-1)&&(d!==10&&a++,this.bMarks.push(i),this.eMarks.push(a),this.tShift.push(o),this.sCount.push(l),this.bsCount.push(0),u=!1,o=0,l=0,i=a+1)}this.bMarks.push(s.length),this.eMarks.push(s.length),this.tShift.push(0),this.sCount.push(0),this.bsCount.push(0),this.lineMax=this.bMarks.length-1}Wu.prototype.push=function(e,t,n){const r=new Wc(e,t,n);return r.block=!0,n<0&&this.level--,r.level=this.level,n>0&&this.level++,this.tokens.push(r),r};Wu.prototype.isEmpty=function(t){return this.bMarks[t]+this.tShift[t]>=this.eMarks[t]};Wu.prototype.skipEmptyLines=function(t){for(let n=this.lineMax;t<n&&!(this.bMarks[t]+this.tShift[t]<this.eMarks[t]);t++);return t};Wu.prototype.skipSpaces=function(t){for(let n=this.src.length;t<n;t++){const r=this.src.charCodeAt(t);if(!Fs(r))break}return t};Wu.prototype.skipSpacesBack=function(t,n){if(t<=n)return t;for(;t>n;)if(!Fs(this.src.charCodeAt(--t)))return t+1;return t};Wu.prototype.skipChars=function(t,n){for(let r=this.src.length;t<r&&this.src.charCodeAt(t)===n;t++);return t};Wu.prototype.skipCharsBack=function(t,n,r){if(t<=r)return t;for(;t>r;)if(n!==this.src.charCodeAt(--t))return t+1;return t};Wu.prototype.getLines=function(t,n,r,s){if(t>=n)return"";const i=new Array(n-t);for(let a=0,o=t;o<n;o++,a++){let l=0;const c=this.bMarks[o];let u=c,d;for(o+1<n||s?d=this.eMarks[o]+1:d=this.eMarks[o];u<d&&l<r;){const h=this.src.charCodeAt(u);if(Fs(h))h===9?l+=4-(l+this.bsCount[o])%4:l++;else if(u-c<this.tShift[o])l++;else break;u++}l>r?i[a]=new Array(l-r+1).join(" ")+this.src.slice(u,d):i[a]=this.src.slice(u,d)}return i.join("")};Wu.prototype.Token=Wc;const ANe=65536;function wI(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];return e.src.slice(n,r)}function Yz(e){const t=[],n=e.length;let r=0,s=e.charCodeAt(r),i=!1,a=0,o="";for(;r<n;)s===124&&(i?(o+=e.substring(a,r-1),a=r):(t.push(o+e.substring(a,r)),o="",a=r+1)),i=s===92,r++,s=e.charCodeAt(r);return t.push(o+e.substring(a)),t}function RNe(e,t,n,r){if(t+2>n)return!1;let s=t+1;if(e.sCount[s]<e.blkIndent||e.sCount[s]-e.blkIndent>=4)return!1;let i=e.bMarks[s]+e.tShift[s];if(i>=e.eMarks[s])return!1;const a=e.src.charCodeAt(i++);if(a!==124&&a!==45&&a!==58||i>=e.eMarks[s])return!1;const o=e.src.charCodeAt(i++);if(o!==124&&o!==45&&o!==58&&!Fs(o)||a===45&&Fs(o))return!1;for(;i<e.eMarks[s];){const k=e.src.charCodeAt(i);if(k!==124&&k!==45&&k!==58&&!Fs(k))return!1;i++}let l=wI(e,t+1),c=l.split("|");const u=[];for(let k=0;k<c.length;k++){const C=c[k].trim();if(!C){if(k===0||k===c.length-1)continue;return!1}if(!/^:?-+:?$/.test(C))return!1;C.charCodeAt(C.length-1)===58?u.push(C.charCodeAt(0)===58?"center":"right"):C.charCodeAt(0)===58?u.push("left"):u.push("")}if(l=wI(e,t).trim(),l.indexOf("|")===-1||e.sCount[t]-e.blkIndent>=4)return!1;c=Yz(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop();const d=c.length;if(d===0||d!==u.length)return!1;if(r)return!0;const h=e.parentType;e.parentType="table";const m=e.md.block.ruler.getRules("blockquote"),y=e.push("table_open","table",1),b=[t,0];y.map=b;const v=e.push("thead_open","thead",1);v.map=[t,t+1];const x=e.push("tr_open","tr",1);x.map=[t,t+1];for(let k=0;k<c.length;k++){const C=e.push("th_open","th",1);u[k]&&(C.attrs=[["style","text-align:"+u[k]]]);const T=e.push("inline","",0);T.content=c[k].trim(),T.children=[],e.push("th_close","th",-1)}e.push("tr_close","tr",-1),e.push("thead_close","thead",-1);let w,S=0;for(s=t+2;s<n&&!(e.sCount[s]<e.blkIndent);s++){let k=!1;for(let T=0,A=m.length;T<A;T++)if(m[T](e,s,n,!0)){k=!0;break}if(k||(l=wI(e,s).trim(),!l)||e.sCount[s]-e.blkIndent>=4||(c=Yz(l),c.length&&c[0]===""&&c.shift(),c.length&&c[c.length-1]===""&&c.pop(),S+=d-c.length,S>ANe))break;if(s===t+2){const T=e.push("tbody_open","tbody",1);T.map=w=[t+2,0]}const C=e.push("tr_open","tr",1);C.map=[s,s+1];for(let T=0;T<d;T++){const A=e.push("td_open","td",1);u[T]&&(A.attrs=[["style","text-align:"+u[T]]]);const N=e.push("inline","",0);N.content=c[T]?c[T].trim():"",N.children=[],e.push("td_close","td",-1)}e.push("tr_close","tr",-1)}return w&&(e.push("tbody_close","tbody",-1),w[1]=s),e.push("table_close","table",-1),b[1]=s,e.parentType=h,e.line=s,!0}function NNe(e,t,n){if(e.sCount[t]-e.blkIndent<4)return!1;let r=t+1,s=r;for(;r<n;){if(e.isEmpty(r)){r++;continue}if(e.sCount[r]-e.blkIndent>=4){r++,s=r;continue}break}e.line=s;const i=e.push("code_block","code",0);return i.content=e.getLines(t,s,4+e.blkIndent,!1)+`
`,i.map=[t,e.line],!0}function MNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||s+3>i)return!1;const a=e.src.charCodeAt(s);if(a!==126&&a!==96)return!1;let o=s;s=e.skipChars(s,a);let l=s-o;if(l<3)return!1;const c=e.src.slice(o,s),u=e.src.slice(s,i);if(a===96&&u.indexOf(String.fromCharCode(a))>=0)return!1;if(r)return!0;let d=t,h=!1;for(;d++,!(d>=n||(s=o=e.bMarks[d]+e.tShift[d],i=e.eMarks[d],s<i&&e.sCount[d]<e.blkIndent));)if(e.src.charCodeAt(s)===a&&!(e.sCount[d]-e.blkIndent>=4)&&(s=e.skipChars(s,a),!(s-o<l)&&(s=e.skipSpaces(s),!(s<i)))){h=!0;break}l=e.sCount[t],e.line=d+(h?1:0);const m=e.push("fence","code",0);return m.info=u,m.content=e.getLines(t+1,d,l,!0),m.markup=c,m.map=[t,e.line],!0}function INe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];const a=e.lineMax;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(s)!==62)return!1;if(r)return!0;const o=[],l=[],c=[],u=[],d=e.md.block.ruler.getRules("blockquote"),h=e.parentType;e.parentType="blockquote";let m=!1,y;for(y=t;y<n;y++){const S=e.sCount[y]<e.blkIndent;if(s=e.bMarks[y]+e.tShift[y],i=e.eMarks[y],s>=i)break;if(e.src.charCodeAt(s++)===62&&!S){let C=e.sCount[y]+1,T,A;e.src.charCodeAt(s)===32?(s++,C++,A=!1,T=!0):e.src.charCodeAt(s)===9?(T=!0,(e.bsCount[y]+C)%4===3?(s++,C++,A=!1):A=!0):T=!1;let N=C;for(o.push(e.bMarks[y]),e.bMarks[y]=s;s<i;){const I=e.src.charCodeAt(s);if(Fs(I))I===9?N+=4-(N+e.bsCount[y]+(A?1:0))%4:N++;else break;s++}m=s>=i,l.push(e.bsCount[y]),e.bsCount[y]=e.sCount[y]+1+(T?1:0),c.push(e.sCount[y]),e.sCount[y]=N-C,u.push(e.tShift[y]),e.tShift[y]=s-e.bMarks[y];continue}if(m)break;let k=!1;for(let C=0,T=d.length;C<T;C++)if(d[C](e,y,n,!0)){k=!0;break}if(k){e.lineMax=y,e.blkIndent!==0&&(o.push(e.bMarks[y]),l.push(e.bsCount[y]),u.push(e.tShift[y]),c.push(e.sCount[y]),e.sCount[y]-=e.blkIndent);break}o.push(e.bMarks[y]),l.push(e.bsCount[y]),u.push(e.tShift[y]),c.push(e.sCount[y]),e.sCount[y]=-1}const b=e.blkIndent;e.blkIndent=0;const v=e.push("blockquote_open","blockquote",1);v.markup=">";const x=[t,0];v.map=x,e.md.block.tokenize(e,t,y);const w=e.push("blockquote_close","blockquote",-1);w.markup=">",e.lineMax=a,e.parentType=h,x[1]=e.line;for(let S=0;S<u.length;S++)e.bMarks[S+t]=o[S],e.tShift[S+t]=u[S],e.sCount[S+t]=c[S],e.bsCount[S+t]=l[S];return e.blkIndent=b,!0}function jNe(e,t,n,r){const s=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let i=e.bMarks[t]+e.tShift[t];const a=e.src.charCodeAt(i++);if(a!==42&&a!==45&&a!==95)return!1;let o=1;for(;i<s;){const c=e.src.charCodeAt(i++);if(c!==a&&!Fs(c))return!1;c===a&&o++}if(o<3)return!1;if(r)return!0;e.line=t+1;const l=e.push("hr","hr",0);return l.map=[t,e.line],l.markup=Array(o+1).join(String.fromCharCode(a)),!0}function Zz(e,t){const n=e.eMarks[t];let r=e.bMarks[t]+e.tShift[t];const s=e.src.charCodeAt(r++);if(s!==42&&s!==45&&s!==43)return-1;if(r<n){const i=e.src.charCodeAt(r);if(!Fs(i))return-1}return r}function Xz(e,t){const n=e.bMarks[t]+e.tShift[t],r=e.eMarks[t];let s=n;if(s+1>=r)return-1;let i=e.src.charCodeAt(s++);if(i<48||i>57)return-1;for(;;){if(s>=r)return-1;if(i=e.src.charCodeAt(s++),i>=48&&i<=57){if(s-n>=10)return-1;continue}if(i===41||i===46)break;return-1}return s<r&&(i=e.src.charCodeAt(s),!Fs(i))?-1:s}function PNe(e,t){const n=e.level+2;for(let r=t+2,s=e.tokens.length-2;r<s;r++)e.tokens[r].level===n&&e.tokens[r].type==="paragraph_open"&&(e.tokens[r+2].hidden=!0,e.tokens[r].hidden=!0,r+=2)}function ONe(e,t,n,r){let s,i,a,o,l=t,c=!0;if(e.sCount[l]-e.blkIndent>=4||e.listIndent>=0&&e.sCount[l]-e.listIndent>=4&&e.sCount[l]<e.blkIndent)return!1;let u=!1;r&&e.parentType==="paragraph"&&e.sCount[l]>=e.blkIndent&&(u=!0);let d,h,m;if((m=Xz(e,l))>=0){if(d=!0,a=e.bMarks[l]+e.tShift[l],h=Number(e.src.slice(a,m-1)),u&&h!==1)return!1}else if((m=Zz(e,l))>=0)d=!1;else return!1;if(u&&e.skipSpaces(m)>=e.eMarks[l])return!1;if(r)return!0;const y=e.src.charCodeAt(m-1),b=e.tokens.length;d?(o=e.push("ordered_list_open","ol",1),h!==1&&(o.attrs=[["start",h]])):o=e.push("bullet_list_open","ul",1);const v=[l,0];o.map=v,o.markup=String.fromCharCode(y);let x=!1;const w=e.md.block.ruler.getRules("list"),S=e.parentType;for(e.parentType="list";l<n;){i=m,s=e.eMarks[l];const k=e.sCount[l]+m-(e.bMarks[l]+e.tShift[l]);let C=k;for(;i<s;){const K=e.src.charCodeAt(i);if(K===9)C+=4-(C+e.bsCount[l])%4;else if(K===32)C++;else break;i++}const T=i;let A;T>=s?A=1:A=C-k,A>4&&(A=1);const N=k+A;o=e.push("list_item_open","li",1),o.markup=String.fromCharCode(y);const I=[l,0];o.map=I,d&&(o.info=e.src.slice(a,m-1));const O=e.tight,B=e.tShift[l],D=e.sCount[l],H=e.listIndent;if(e.listIndent=e.blkIndent,e.blkIndent=N,e.tight=!0,e.tShift[l]=T-e.bMarks[l],e.sCount[l]=C,T>=s&&e.isEmpty(l+1)?e.line=Math.min(e.line+2,n):e.md.block.tokenize(e,l,n,!0),(!e.tight||x)&&(c=!1),x=e.line-l>1&&e.isEmpty(e.line-1),e.blkIndent=e.listIndent,e.listIndent=H,e.tShift[l]=B,e.sCount[l]=D,e.tight=O,o=e.push("list_item_close","li",-1),o.markup=String.fromCharCode(y),l=e.line,I[1]=l,l>=n||e.sCount[l]<e.blkIndent||e.sCount[l]-e.blkIndent>=4)break;let P=!1;for(let K=0,U=w.length;K<U;K++)if(w[K](e,l,n,!0)){P=!0;break}if(P)break;if(d){if(m=Xz(e,l),m<0)break;a=e.bMarks[l]+e.tShift[l]}else if(m=Zz(e,l),m<0)break;if(y!==e.src.charCodeAt(m-1))break}return d?o=e.push("ordered_list_close","ol",-1):o=e.push("bullet_list_close","ul",-1),o.markup=String.fromCharCode(y),v[1]=l,e.line=l,e.parentType=S,c&&PNe(e,b),!0}function DNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t],a=t+1;if(e.sCount[t]-e.blkIndent>=4||e.src.charCodeAt(s)!==91)return!1;function o(w){const S=e.lineMax;if(w>=S||e.isEmpty(w))return null;let k=!1;if(e.sCount[w]-e.blkIndent>3&&(k=!0),e.sCount[w]<0&&(k=!0),!k){const A=e.md.block.ruler.getRules("reference"),N=e.parentType;e.parentType="reference";let I=!1;for(let O=0,B=A.length;O<B;O++)if(A[O](e,w,S,!0)){I=!0;break}if(e.parentType=N,I)return null}const C=e.bMarks[w]+e.tShift[w],T=e.eMarks[w];return e.src.slice(C,T+1)}let l=e.src.slice(s,i+1);i=l.length;let c=-1;for(s=1;s<i;s++){const w=l.charCodeAt(s);if(w===91)return!1;if(w===93){c=s;break}else if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(w===92&&(s++,s<i&&l.charCodeAt(s)===10)){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}}if(c<0||l.charCodeAt(c+1)!==58)return!1;for(s=c+2;s<i;s++){const w=l.charCodeAt(s);if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(!Fs(w))break}const u=e.md.helpers.parseLinkDestination(l,s,i);if(!u.ok)return!1;const d=e.md.normalizeLink(u.str);if(!e.md.validateLink(d))return!1;s=u.pos;const h=s,m=a,y=s;for(;s<i;s++){const w=l.charCodeAt(s);if(w===10){const S=o(a);S!==null&&(l+=S,i=l.length,a++)}else if(!Fs(w))break}let b=e.md.helpers.parseLinkTitle(l,s,i);for(;b.can_continue;){const w=o(a);if(w===null)break;l+=w,s=i,i=l.length,a++,b=e.md.helpers.parseLinkTitle(l,s,i,b)}let v;for(s<i&&y!==s&&b.ok?(v=b.str,s=b.pos):(v="",s=h,a=m);s<i;){const w=l.charCodeAt(s);if(!Fs(w))break;s++}if(s<i&&l.charCodeAt(s)!==10&&v)for(v="",s=h,a=m;s<i;){const w=l.charCodeAt(s);if(!Fs(w))break;s++}if(s<i&&l.charCodeAt(s)!==10)return!1;const x=yT(l.slice(1,c));return x?(r||(typeof e.env.references>"u"&&(e.env.references={}),typeof e.env.references[x]>"u"&&(e.env.references[x]={title:v,href:d}),e.line=a),!0):!1}const FNe=["address","article","aside","base","basefont","blockquote","body","caption","center","col","colgroup","dd","details","dialog","dir","div","dl","dt","fieldset","figcaption","figure","footer","form","frame","frameset","h1","h2","h3","h4","h5","h6","head","header","hr","html","iframe","legend","li","link","main","menu","menuitem","nav","noframes","ol","optgroup","option","p","param","search","section","summary","table","tbody","td","tfoot","th","thead","title","tr","track","ul"],LNe="[a-zA-Z_:][a-zA-Z0-9:._-]*",BNe="[^\"'=<>`\\x00-\\x20]+",$Ne="'[^']*'",zNe='"[^"]*"',UNe="(?:"+BNe+"|"+$Ne+"|"+zNe+")",qNe="(?:\\s+"+LNe+"(?:\\s*=\\s*"+UNe+")?)",cX="<[A-Za-z][A-Za-z0-9\\-]*"+qNe+"*\\s*\\/?>",uX="<\\/[A-Za-z][A-Za-z0-9\\-]*\\s*>",VNe="<!---?>|<!--(?:[^-]|-[^-]|--[^>])*-->",WNe="<[?][\\s\\S]*?[?]>",HNe="<![A-Za-z][^>]*>",GNe="<!\\[CDATA\\[[\\s\\S]*?\\]\\]>",KNe=new RegExp("^(?:"+cX+"|"+uX+"|"+VNe+"|"+WNe+"|"+HNe+"|"+GNe+")"),YNe=new RegExp("^(?:"+cX+"|"+uX+")"),a0=[[/^<(script|pre|style|textarea)(?=(\s|>|$))/i,/<\/(script|pre|style|textarea)>/i,!0],[/^<!--/,/-->/,!0],[/^<\?/,/\?>/,!0],[/^<![A-Z]/,/>/,!0],[/^<!\[CDATA\[/,/\]\]>/,!0],[new RegExp("^</?("+FNe.join("|")+")(?=(\\s|/?>|$))","i"),/^$/,!0],[new RegExp(YNe.source+"\\s*$"),/^$/,!1]];function ZNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4||!e.md.options.html||e.src.charCodeAt(s)!==60)return!1;let a=e.src.slice(s,i),o=0;for(;o<a0.length&&!a0[o][0].test(a);o++);if(o===a0.length)return!1;if(r)return a0[o][2];let l=t+1;if(!a0[o][1].test(a)){for(;l<n&&!(e.sCount[l]<e.blkIndent);l++)if(s=e.bMarks[l]+e.tShift[l],i=e.eMarks[l],a=e.src.slice(s,i),a0[o][1].test(a)){a.length!==0&&l++;break}}e.line=l;const c=e.push("html_block","",0);return c.map=[t,l],c.content=e.getLines(t,l,e.blkIndent,!0),!0}function XNe(e,t,n,r){let s=e.bMarks[t]+e.tShift[t],i=e.eMarks[t];if(e.sCount[t]-e.blkIndent>=4)return!1;let a=e.src.charCodeAt(s);if(a!==35||s>=i)return!1;let o=1;for(a=e.src.charCodeAt(++s);a===35&&s<i&&o<=6;)o++,a=e.src.charCodeAt(++s);if(o>6||s<i&&!Fs(a))return!1;if(r)return!0;i=e.skipSpacesBack(i,s);const l=e.skipCharsBack(i,35,s);l>s&&Fs(e.src.charCodeAt(l-1))&&(i=l),e.line=t+1;const c=e.push("heading_open","h"+String(o),1);c.markup="########".slice(0,o),c.map=[t,e.line];const u=e.push("inline","",0);u.content=e.src.slice(s,i).trim(),u.map=[t,e.line],u.children=[];const d=e.push("heading_close","h"+String(o),-1);return d.markup="########".slice(0,o),!0}function JNe(e,t,n){const r=e.md.block.ruler.getRules("paragraph");if(e.sCount[t]-e.blkIndent>=4)return!1;const s=e.parentType;e.parentType="paragraph";let i=0,a,o=t+1;for(;o<n&&!e.isEmpty(o);o++){if(e.sCount[o]-e.blkIndent>3)continue;if(e.sCount[o]>=e.blkIndent){let m=e.bMarks[o]+e.tShift[o];const y=e.eMarks[o];if(m<y&&(a=e.src.charCodeAt(m),(a===45||a===61)&&(m=e.skipChars(m,a),m=e.skipSpaces(m),m>=y))){i=a===61?1:2;break}}if(e.sCount[o]<0)continue;let h=!1;for(let m=0,y=r.length;m<y;m++)if(r[m](e,o,n,!0)){h=!0;break}if(h)break}if(!i)return!1;const l=e.getLines(t,o,e.blkIndent,!1).trim();e.line=o+1;const c=e.push("heading_open","h"+String(i),1);c.markup=String.fromCharCode(a),c.map=[t,e.line];const u=e.push("inline","",0);u.content=l,u.map=[t,e.line-1],u.children=[];const d=e.push("heading_close","h"+String(i),-1);return d.markup=String.fromCharCode(a),e.parentType=s,!0}function QNe(e,t,n){const r=e.md.block.ruler.getRules("paragraph"),s=e.parentType;let i=t+1;for(e.parentType="paragraph";i<n&&!e.isEmpty(i);i++){if(e.sCount[i]-e.blkIndent>3||e.sCount[i]<0)continue;let c=!1;for(let u=0,d=r.length;u<d;u++)if(r[u](e,i,n,!0)){c=!0;break}if(c)break}const a=e.getLines(t,i,e.blkIndent,!1).trim();e.line=i;const o=e.push("paragraph_open","p",1);o.map=[t,e.line];const l=e.push("inline","",0);return l.content=a,l.map=[t,e.line],l.children=[],e.push("paragraph_close","p",-1),e.parentType=s,!0}const JS=[["table",RNe,["paragraph","reference"]],["code",NNe],["fence",MNe,["paragraph","reference","blockquote","list"]],["blockquote",INe,["paragraph","reference","blockquote","list"]],["hr",jNe,["paragraph","reference","blockquote","list"]],["list",ONe,["paragraph","reference","blockquote"]],["reference",DNe],["html_block",ZNe,["paragraph","reference","blockquote"]],["heading",XNe,["paragraph","reference","blockquote"]],["lheading",JNe],["paragraph",QNe]];function bT(){this.ruler=new qo;for(let e=0;e<JS.length;e++)this.ruler.push(JS[e][0],JS[e][1],{alt:(JS[e][2]||[]).slice()})}bT.prototype.tokenize=function(e,t,n){const r=this.ruler.getRules(""),s=r.length,i=e.md.options.maxNesting;let a=t,o=!1;for(;a<n&&(e.line=a=e.skipEmptyLines(a),!(a>=n||e.sCount[a]<e.blkIndent));){if(e.level>=i){e.line=n;break}const l=e.line;let c=!1;for(let u=0;u<s;u++)if(c=r[u](e,a,n,!1),c){if(l>=e.line)throw new Error("block rule didn't increment state.line");break}if(!c)throw new Error("none of the block rules matched");e.tight=!o,e.isEmpty(e.line-1)&&(o=!0),a=e.line,a<n&&e.isEmpty(a)&&(o=!0,a++,e.line=a)}};bT.prototype.parse=function(e,t,n,r){if(!e)return;const s=new this.State(e,t,n,r);this.tokenize(s,s.line,s.lineMax)};bT.prototype.State=Wu;function Z1(e,t,n,r){this.src=e,this.env=n,this.md=t,this.tokens=r,this.tokens_meta=Array(r.length),this.pos=0,this.posMax=this.src.length,this.level=0,this.pending="",this.pendingLevel=0,this.cache={},this.delimiters=[],this._prev_delimiters=[],this.backticks={},this.backticksScanned=!1,this.linkLevel=0}Z1.prototype.pushPending=function(){const e=new Wc("text","",0);return e.content=this.pending,e.level=this.pendingLevel,this.tokens.push(e),this.pending="",e};Z1.prototype.push=function(e,t,n){this.pending&&this.pushPending();const r=new Wc(e,t,n);let s=null;return n<0&&(this.level--,this.delimiters=this._prev_delimiters.pop()),r.level=this.level,n>0&&(this.level++,this._prev_delimiters.push(this.delimiters),this.delimiters=[],s={delimiters:this.delimiters}),this.pendingLevel=this.level,this.tokens.push(r),this.tokens_meta.push(s),r};Z1.prototype.scanDelims=function(e,t){const n=this.posMax,r=this.src.charCodeAt(e),s=e>0?this.src.charCodeAt(e-1):32;let i=e;for(;i<n&&this.src.charCodeAt(i)===r;)i++;const a=i-e,o=i<n?this.src.charCodeAt(i):32,l=Nw(s)||Rw(String.fromCharCode(s)),c=Nw(o)||Rw(String.fromCharCode(o)),u=Aw(s),d=Aw(o),h=!d&&(!c||u||l),m=!u&&(!l||d||c);return{can_open:h&&(t||!m||l),can_close:m&&(t||!h||c),length:a}};Z1.prototype.Token=Wc;function eMe(e){switch(e){case 10:case 33:case 35:case 36:case 37:case 38:case 42:case 43:case 45:case 58:case 60:case 61:case 62:case 64:case 91:case 92:case 93:case 94:case 95:case 96:case 123:case 125:case 126:return!0;default:return!1}}function tMe(e,t){let n=e.pos;for(;n<e.posMax&&!eMe(e.src.charCodeAt(n));)n++;return n===e.pos?!1:(t||(e.pending+=e.src.slice(e.pos,n)),e.pos=n,!0)}const nMe=/(?:^|[^a-z0-9.+-])([a-z][a-z0-9.+-]*)$/i;function rMe(e,t){if(!e.md.options.linkify||e.linkLevel>0)return!1;const n=e.pos,r=e.posMax;if(n+3>r||e.src.charCodeAt(n)!==58||e.src.charCodeAt(n+1)!==47||e.src.charCodeAt(n+2)!==47)return!1;const s=e.pending.match(nMe);if(!s)return!1;const i=s[1],a=e.md.linkify.matchAtStart(e.src.slice(n-i.length));if(!a)return!1;let o=a.url;if(o.length<=i.length)return!1;o=o.replace(/\*+$/,"");const l=e.md.normalizeLink(o);if(!e.md.validateLink(l))return!1;if(!t){e.pending=e.pending.slice(0,-i.length);const c=e.push("link_open","a",1);c.attrs=[["href",l]],c.markup="linkify",c.info="auto";const u=e.push("text","",0);u.content=e.md.normalizeLinkText(o);const d=e.push("link_close","a",-1);d.markup="linkify",d.info="auto"}return e.pos+=o.length-i.length,!0}function sMe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==10)return!1;const r=e.pending.length-1,s=e.posMax;if(!t)if(r>=0&&e.pending.charCodeAt(r)===32)if(r>=1&&e.pending.charCodeAt(r-1)===32){let i=r-1;for(;i>=1&&e.pending.charCodeAt(i-1)===32;)i--;e.pending=e.pending.slice(0,i),e.push("hardbreak","br",0)}else e.pending=e.pending.slice(0,-1),e.push("softbreak","br",0);else e.push("softbreak","br",0);for(n++;n<s&&Fs(e.src.charCodeAt(n));)n++;return e.pos=n,!0}const MD=[];for(let e=0;e<256;e++)MD.push(0);"\\!\"#$%&'()*+,./:;<=>?@[]^_`{|}~-".split("").forEach(function(e){MD[e.charCodeAt(0)]=1});function iMe(e,t){let n=e.pos;const r=e.posMax;if(e.src.charCodeAt(n)!==92||(n++,n>=r))return!1;let s=e.src.charCodeAt(n);if(s===10){for(t||e.push("hardbreak","br",0),n++;n<r&&(s=e.src.charCodeAt(n),!!Fs(s));)n++;return e.pos=n,!0}let i=e.src[n];if(s>=55296&&s<=56319&&n+1<r){const o=e.src.charCodeAt(n+1);o>=56320&&o<=57343&&(i+=e.src[n+1],n++)}const a="\\"+i;if(!t){const o=e.push("text_special","",0);s<256&&MD[s]!==0?o.content=i:o.content=a,o.markup=a,o.info="escape"}return e.pos=n+1,!0}function aMe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==96)return!1;const s=n;n++;const i=e.posMax;for(;n<i&&e.src.charCodeAt(n)===96;)n++;const a=e.src.slice(s,n),o=a.length;if(e.backticksScanned&&(e.backticks[o]||0)<=s)return t||(e.pending+=a),e.pos+=o,!0;let l=n,c;for(;(c=e.src.indexOf("`",l))!==-1;){for(l=c+1;l<i&&e.src.charCodeAt(l)===96;)l++;const u=l-c;if(u===o){if(!t){const d=e.push("code_inline","code",0);d.markup=a,d.content=e.src.slice(n,c).replace(/\n/g," ").replace(/^ (.+) $/,"$1")}return e.pos=l,!0}e.backticks[u]=c}return e.backticksScanned=!0,t||(e.pending+=a),e.pos+=o,!0}function oMe(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==126)return!1;const s=e.scanDelims(e.pos,!0);let i=s.length;const a=String.fromCharCode(r);if(i<2)return!1;let o;i%2&&(o=e.push("text","",0),o.content=a,i--);for(let l=0;l<i;l+=2)o=e.push("text","",0),o.content=a+a,e.delimiters.push({marker:r,length:0,token:e.tokens.length-1,end:-1,open:s.can_open,close:s.can_close});return e.pos+=s.length,!0}function Jz(e,t){let n;const r=[],s=t.length;for(let i=0;i<s;i++){const a=t[i];if(a.marker!==126||a.end===-1)continue;const o=t[a.end];n=e.tokens[a.token],n.type="s_open",n.tag="s",n.nesting=1,n.markup="~~",n.content="",n=e.tokens[o.token],n.type="s_close",n.tag="s",n.nesting=-1,n.markup="~~",n.content="",e.tokens[o.token-1].type==="text"&&e.tokens[o.token-1].content==="~"&&r.push(o.token-1)}for(;r.length;){const i=r.pop();let a=i+1;for(;a<e.tokens.length&&e.tokens[a].type==="s_close";)a++;a--,i!==a&&(n=e.tokens[a],e.tokens[a]=e.tokens[i],e.tokens[i]=n)}}function lMe(e){const t=e.tokens_meta,n=e.tokens_meta.length;Jz(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&Jz(e,t[r].delimiters)}const dX={tokenize:oMe,postProcess:lMe};function cMe(e,t){const n=e.pos,r=e.src.charCodeAt(n);if(t||r!==95&&r!==42)return!1;const s=e.scanDelims(e.pos,r===42);for(let i=0;i<s.length;i++){const a=e.push("text","",0);a.content=String.fromCharCode(r),e.delimiters.push({marker:r,length:s.length,token:e.tokens.length-1,end:-1,open:s.can_open,close:s.can_close})}return e.pos+=s.length,!0}function Qz(e,t){const n=t.length;for(let r=n-1;r>=0;r--){const s=t[r];if(s.marker!==95&&s.marker!==42||s.end===-1)continue;const i=t[s.end],a=r>0&&t[r-1].end===s.end+1&&t[r-1].marker===s.marker&&t[r-1].token===s.token-1&&t[s.end+1].token===i.token+1,o=String.fromCharCode(s.marker),l=e.tokens[s.token];l.type=a?"strong_open":"em_open",l.tag=a?"strong":"em",l.nesting=1,l.markup=a?o+o:o,l.content="";const c=e.tokens[i.token];c.type=a?"strong_close":"em_close",c.tag=a?"strong":"em",c.nesting=-1,c.markup=a?o+o:o,c.content="",a&&(e.tokens[t[r-1].token].content="",e.tokens[t[s.end+1].token].content="",r--)}}function uMe(e){const t=e.tokens_meta,n=e.tokens_meta.length;Qz(e,e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&Qz(e,t[r].delimiters)}const fX={tokenize:cMe,postProcess:uMe};function dMe(e,t){let n,r,s,i,a="",o="",l=e.pos,c=!0;if(e.src.charCodeAt(e.pos)!==91)return!1;const u=e.pos,d=e.posMax,h=e.pos+1,m=e.md.helpers.parseLinkLabel(e,e.pos,!0);if(m<0)return!1;let y=m+1;if(y<d&&e.src.charCodeAt(y)===40){for(c=!1,y++;y<d&&(n=e.src.charCodeAt(y),!(!Fs(n)&&n!==10));y++);if(y>=d)return!1;if(l=y,s=e.md.helpers.parseLinkDestination(e.src,y,e.posMax),s.ok){for(a=e.md.normalizeLink(s.str),e.md.validateLink(a)?y=s.pos:a="",l=y;y<d&&(n=e.src.charCodeAt(y),!(!Fs(n)&&n!==10));y++);if(s=e.md.helpers.parseLinkTitle(e.src,y,e.posMax),y<d&&l!==y&&s.ok)for(o=s.str,y=s.pos;y<d&&(n=e.src.charCodeAt(y),!(!Fs(n)&&n!==10));y++);}(y>=d||e.src.charCodeAt(y)!==41)&&(c=!0),y++}if(c){if(typeof e.env.references>"u")return!1;if(y<d&&e.src.charCodeAt(y)===91?(l=y+1,y=e.md.helpers.parseLinkLabel(e,y),y>=0?r=e.src.slice(l,y++):y=m+1):y=m+1,r||(r=e.src.slice(h,m)),i=e.env.references[yT(r)],!i)return e.pos=u,!1;a=i.href,o=i.title}if(!t){e.pos=h,e.posMax=m;const b=e.push("link_open","a",1),v=[["href",a]];b.attrs=v,o&&v.push(["title",o]),e.linkLevel++,e.md.inline.tokenize(e),e.linkLevel--,e.push("link_close","a",-1)}return e.pos=y,e.posMax=d,!0}function fMe(e,t){let n,r,s,i,a,o,l,c,u="";const d=e.pos,h=e.posMax;if(e.src.charCodeAt(e.pos)!==33||e.src.charCodeAt(e.pos+1)!==91)return!1;const m=e.pos+2,y=e.md.helpers.parseLinkLabel(e,e.pos+1,!1);if(y<0)return!1;if(i=y+1,i<h&&e.src.charCodeAt(i)===40){for(i++;i<h&&(n=e.src.charCodeAt(i),!(!Fs(n)&&n!==10));i++);if(i>=h)return!1;for(c=i,o=e.md.helpers.parseLinkDestination(e.src,i,e.posMax),o.ok&&(u=e.md.normalizeLink(o.str),e.md.validateLink(u)?i=o.pos:u=""),c=i;i<h&&(n=e.src.charCodeAt(i),!(!Fs(n)&&n!==10));i++);if(o=e.md.helpers.parseLinkTitle(e.src,i,e.posMax),i<h&&c!==i&&o.ok)for(l=o.str,i=o.pos;i<h&&(n=e.src.charCodeAt(i),!(!Fs(n)&&n!==10));i++);else l="";if(i>=h||e.src.charCodeAt(i)!==41)return e.pos=d,!1;i++}else{if(typeof e.env.references>"u")return!1;if(i<h&&e.src.charCodeAt(i)===91?(c=i+1,i=e.md.helpers.parseLinkLabel(e,i),i>=0?s=e.src.slice(c,i++):i=y+1):i=y+1,s||(s=e.src.slice(m,y)),a=e.env.references[yT(s)],!a)return e.pos=d,!1;u=a.href,l=a.title}if(!t){r=e.src.slice(m,y);const b=[];e.md.inline.parse(r,e.md,e.env,b);const v=e.push("image","img",0),x=[["src",u],["alt",""]];v.attrs=x,v.children=b,v.content=r,l&&x.push(["title",l])}return e.pos=i,e.posMax=h,!0}const hMe=/^([a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+@[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)*)$/,pMe=/^([a-zA-Z][a-zA-Z0-9+.-]{1,31}):([^<>\x00-\x20]*)$/;function mMe(e,t){let n=e.pos;if(e.src.charCodeAt(n)!==60)return!1;const r=e.pos,s=e.posMax;for(;;){if(++n>=s)return!1;const a=e.src.charCodeAt(n);if(a===60)return!1;if(a===62)break}const i=e.src.slice(r+1,n);if(pMe.test(i)){const a=e.md.normalizeLink(i);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=i.length+2,!0}if(hMe.test(i)){const a=e.md.normalizeLink("mailto:"+i);if(!e.md.validateLink(a))return!1;if(!t){const o=e.push("link_open","a",1);o.attrs=[["href",a]],o.markup="autolink",o.info="auto";const l=e.push("text","",0);l.content=e.md.normalizeLinkText(i);const c=e.push("link_close","a",-1);c.markup="autolink",c.info="auto"}return e.pos+=i.length+2,!0}return!1}function gMe(e){return/^<a[>\s]/i.test(e)}function yMe(e){return/^<\/a\s*>/i.test(e)}function bMe(e){const t=e|32;return t>=97&&t<=122}function vMe(e,t){if(!e.md.options.html)return!1;const n=e.posMax,r=e.pos;if(e.src.charCodeAt(r)!==60||r+2>=n)return!1;const s=e.src.charCodeAt(r+1);if(s!==33&&s!==63&&s!==47&&!bMe(s))return!1;const i=e.src.slice(r).match(KNe);if(!i)return!1;if(!t){const a=e.push("html_inline","",0);a.content=i[0],gMe(a.content)&&e.linkLevel++,yMe(a.content)&&e.linkLevel--}return e.pos+=i[0].length,!0}const xMe=/^&#((?:x[a-f0-9]{1,6}|[0-9]{1,7}));/i,wMe=/^&([a-z][a-z0-9]{1,31});/i;function _Me(e,t){const n=e.pos,r=e.posMax;if(e.src.charCodeAt(n)!==38||n+1>=r)return!1;if(e.src.charCodeAt(n+1)===35){const i=e.src.slice(n).match(xMe);if(i){if(!t){const a=i[1][0].toLowerCase()==="x"?parseInt(i[1].slice(1),16):parseInt(i[1],10),o=e.push("text_special","",0);o.content=RD(a)?dk(a):dk(65533),o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}else{const i=e.src.slice(n).match(wMe);if(i){const a=sX(i[0]);if(a!==i[0]){if(!t){const o=e.push("text_special","",0);o.content=a,o.markup=i[0],o.info="entity"}return e.pos+=i[0].length,!0}}}return!1}function e7(e){const t={},n=e.length;if(!n)return;let r=0,s=-2;const i=[];for(let a=0;a<n;a++){const o=e[a];if(i.push(0),(e[r].marker!==o.marker||s!==o.token-1)&&(r=a),s=o.token,o.length=o.length||0,!o.close)continue;t.hasOwnProperty(o.marker)||(t[o.marker]=[-1,-1,-1,-1,-1,-1]);const l=t[o.marker][(o.open?3:0)+o.length%3];let c=r-i[r]-1,u=c;for(;c>l;c-=i[c]+1){const d=e[c];if(d.marker===o.marker&&d.open&&d.end<0){let h=!1;if((d.close||o.open)&&(d.length+o.length)%3===0&&(d.length%3!==0||o.length%3!==0)&&(h=!0),!h){const m=c>0&&!e[c-1].open?i[c-1]+1:0;i[a]=a-c+m,i[c]=m,o.open=!1,d.end=a,d.close=!1,u=-1,s=-2;break}}}u!==-1&&(t[o.marker][(o.open?3:0)+(o.length||0)%3]=u)}}function SMe(e){const t=e.tokens_meta,n=e.tokens_meta.length;e7(e.delimiters);for(let r=0;r<n;r++)t[r]&&t[r].delimiters&&e7(t[r].delimiters)}function CMe(e){let t,n,r=0;const s=e.tokens,i=e.tokens.length;for(t=n=0;t<i;t++)s[t].nesting<0&&r--,s[t].level=r,s[t].nesting>0&&r++,s[t].type==="text"&&t+1<i&&s[t+1].type==="text"?s[t+1].content=s[t].content+s[t+1].content:(t!==n&&(s[n]=s[t]),n++);t!==n&&(s.length=n)}const _I=[["text",tMe],["linkify",rMe],["newline",sMe],["escape",iMe],["backticks",aMe],["strikethrough",dX.tokenize],["emphasis",fX.tokenize],["link",dMe],["image",fMe],["autolink",mMe],["html_inline",vMe],["entity",_Me]],SI=[["balance_pairs",SMe],["strikethrough",dX.postProcess],["emphasis",fX.postProcess],["fragments_join",CMe]];function X1(){this.ruler=new qo;for(let e=0;e<_I.length;e++)this.ruler.push(_I[e][0],_I[e][1]);this.ruler2=new qo;for(let e=0;e<SI.length;e++)this.ruler2.push(SI[e][0],SI[e][1])}X1.prototype.skipToken=function(e){const t=e.pos,n=this.ruler.getRules(""),r=n.length,s=e.md.options.maxNesting,i=e.cache;if(typeof i[t]<"u"){e.pos=i[t];return}let a=!1;if(e.level<s){for(let o=0;o<r;o++)if(e.level++,a=n[o](e,!0),e.level--,a){if(t>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}else e.pos=e.posMax;a||e.pos++,i[t]=e.pos};X1.prototype.tokenize=function(e){const t=this.ruler.getRules(""),n=t.length,r=e.posMax,s=e.md.options.maxNesting;for(;e.pos<r;){const i=e.pos;let a=!1;if(e.level<s){for(let o=0;o<n;o++)if(a=t[o](e,!1),a){if(i>=e.pos)throw new Error("inline rule didn't increment state.pos");break}}if(a){if(e.pos>=r)break;continue}e.pending+=e.src[e.pos++]}e.pending&&e.pushPending()};X1.prototype.parse=function(e,t,n,r){const s=new this.State(e,t,n,r);this.tokenize(s);const i=this.ruler2.getRules(""),a=i.length;for(let o=0;o<a;o++)i[o](s)};X1.prototype.State=Z1;function kMe(e){const t={};e=e||{},t.src_Any=QZ.source,t.src_Cc=eX.source,t.src_Z=nX.source,t.src_P=TD.source,t.src_ZPCc=[t.src_Z,t.src_P,t.src_Cc].join("|"),t.src_ZCc=[t.src_Z,t.src_Cc].join("|");const n="[><]";return t.src_pseudo_letter="(?:(?!"+n+"|"+t.src_ZPCc+")"+t.src_Any+")",t.src_ip4="(?:(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)",t.src_auth="(?:(?:(?!"+t.src_ZCc+"|[@/\\[\\]()]).)+@)?",t.src_port="(?::(?:6(?:[0-4]\\d{3}|5(?:[0-4]\\d{2}|5(?:[0-2]\\d|3[0-5])))|[1-5]?\\d{1,4}))?",t.src_host_terminator="(?=$|"+n+"|"+t.src_ZPCc+")(?!"+(e["---"]?"-(?!--)|":"-|")+"_|:\\d|\\.-|\\.(?!$|"+t.src_ZPCc+"))",t.src_path="(?:[/?#](?:(?!"+t.src_ZCc+"|"+n+`|[()[\\]{}.,"'?!\\-;]).|\\[(?:(?!`+t.src_ZCc+"|\\]).)*\\]|\\((?:(?!"+t.src_ZCc+"|[)]).)*\\)|\\{(?:(?!"+t.src_ZCc+'|[}]).)*\\}|\\"(?:(?!'+t.src_ZCc+`|["]).)+\\"|\\'(?:(?!`+t.src_ZCc+"|[']).)+\\'|\\'(?="+t.src_pseudo_letter+"|[-])|\\.{2,}[a-zA-Z0-9%/&]|\\.(?!"+t.src_ZCc+"|[.]|$)|"+(e["---"]?"\\-(?!--(?:[^-]|$))(?:-*)|":"\\-+|")+",(?!"+t.src_ZCc+"|$)|;(?!"+t.src_ZCc+"|$)|\\!+(?!"+t.src_ZCc+"|[!]|$)|\\?(?!"+t.src_ZCc+"|[?]|$))+|\\/)?",t.src_email_name='[\\-;:&=\\+\\$,\\.a-zA-Z0-9_][\\-;:&=\\+\\$,\\"\\.a-zA-Z0-9_]*',t.src_xn="xn--[a-z0-9\\-]{1,59}",t.src_domain_root="(?:"+t.src_xn+"|"+t.src_pseudo_letter+"{1,63})",t.src_domain="(?:"+t.src_xn+"|(?:"+t.src_pseudo_letter+")|(?:"+t.src_pseudo_letter+"(?:-|"+t.src_pseudo_letter+"){0,61}"+t.src_pseudo_letter+"))",t.src_host="(?:(?:(?:(?:"+t.src_domain+")\\.)*"+t.src_domain+"))",t.tpl_host_fuzzy="(?:"+t.src_ip4+"|(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%)))",t.tpl_host_no_ip_fuzzy="(?:(?:(?:"+t.src_domain+")\\.)+(?:%TLDS%))",t.src_host_strict=t.src_host+t.src_host_terminator,t.tpl_host_fuzzy_strict=t.tpl_host_fuzzy+t.src_host_terminator,t.src_host_port_strict=t.src_host+t.src_port+t.src_host_terminator,t.tpl_host_port_fuzzy_strict=t.tpl_host_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_port_no_ip_fuzzy_strict=t.tpl_host_no_ip_fuzzy+t.src_port+t.src_host_terminator,t.tpl_host_fuzzy_test="localhost|www\\.|\\.\\d{1,3}\\.|(?:\\.(?:%TLDS%)(?:"+t.src_ZPCc+"|>|$))",t.tpl_email_fuzzy="(^|"+n+'|"|\\(|'+t.src_ZCc+")("+t.src_email_name+"@"+t.tpl_host_fuzzy_strict+")",t.tpl_link_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_fuzzy_strict+t.src_path+")",t.tpl_link_no_ip_fuzzy="(^|(?![.:/\\-_@])(?:[$+<=>^`|]|"+t.src_ZPCc+"))((?![$+<=>^`|])"+t.tpl_host_port_no_ip_fuzzy_strict+t.src_path+")",t}function Vj(e){return Array.prototype.slice.call(arguments,1).forEach(function(n){n&&Object.keys(n).forEach(function(r){e[r]=n[r]})}),e}function vT(e){return Object.prototype.toString.call(e)}function EMe(e){return vT(e)==="[object String]"}function TMe(e){return vT(e)==="[object Object]"}function AMe(e){return vT(e)==="[object RegExp]"}function t7(e){return vT(e)==="[object Function]"}function RMe(e){return e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&")}const hX={fuzzyLink:!0,fuzzyEmail:!0,fuzzyIP:!1};function NMe(e){return Object.keys(e||{}).reduce(function(t,n){return t||hX.hasOwnProperty(n)},!1)}const MMe={"http:":{validate:function(e,t,n){const r=e.slice(t);return n.re.http||(n.re.http=new RegExp("^\\/\\/"+n.re.src_auth+n.re.src_host_port_strict+n.re.src_path,"i")),n.re.http.test(r)?r.match(n.re.http)[0].length:0}},"https:":"http:","ftp:":"http:","//":{validate:function(e,t,n){const r=e.slice(t);return n.re.no_http||(n.re.no_http=new RegExp("^"+n.re.src_auth+"(?:localhost|(?:(?:"+n.re.src_domain+")\\.)+"+n.re.src_domain_root+")"+n.re.src_port+n.re.src_host_terminator+n.re.src_path,"i")),n.re.no_http.test(r)?t>=3&&e[t-3]===":"||t>=3&&e[t-3]==="/"?0:r.match(n.re.no_http)[0].length:0}},"mailto:":{validate:function(e,t,n){const r=e.slice(t);return n.re.mailto||(n.re.mailto=new RegExp("^"+n.re.src_email_name+"@"+n.re.src_host_strict,"i")),n.re.mailto.test(r)?r.match(n.re.mailto)[0].length:0}}},IMe="a[cdefgilmnoqrstuwxz]|b[abdefghijmnorstvwyz]|c[acdfghiklmnoruvwxyz]|d[ejkmoz]|e[cegrstu]|f[ijkmor]|g[abdefghilmnpqrstuwy]|h[kmnrtu]|i[delmnoqrst]|j[emop]|k[eghimnprwyz]|l[abcikrstuvy]|m[acdeghklmnopqrstuvwxyz]|n[acefgilopruz]|om|p[aefghklmnrstwy]|qa|r[eosuw]|s[abcdeghijklmnortuvxyz]|t[cdfghjklmnortvwz]|u[agksyz]|v[aceginu]|w[fs]|y[et]|z[amw]",jMe="biz|com|edu|gov|net|org|pro|web|xxx|aero|asia|coop|info|museum|name|shop|".split("|");function PMe(e){e.__index__=-1,e.__text_cache__=""}function OMe(e){return function(t,n){const r=t.slice(n);return e.test(r)?r.match(e)[0].length:0}}function n7(){return function(e,t){t.normalize(e)}}function fk(e){const t=e.re=kMe(e.__opts__),n=e.__tlds__.slice();e.onCompile(),e.__tlds_replaced__||n.push(IMe),n.push(t.src_xn),t.src_tlds=n.join("|");function r(o){return o.replace("%TLDS%",t.src_tlds)}t.email_fuzzy=RegExp(r(t.tpl_email_fuzzy),"i"),t.link_fuzzy=RegExp(r(t.tpl_link_fuzzy),"i"),t.link_no_ip_fuzzy=RegExp(r(t.tpl_link_no_ip_fuzzy),"i"),t.host_fuzzy_test=RegExp(r(t.tpl_host_fuzzy_test),"i");const s=[];e.__compiled__={};function i(o,l){throw new Error('(LinkifyIt) Invalid schema "'+o+'": '+l)}Object.keys(e.__schemas__).forEach(function(o){const l=e.__schemas__[o];if(l===null)return;const c={validate:null,link:null};if(e.__compiled__[o]=c,TMe(l)){AMe(l.validate)?c.validate=OMe(l.validate):t7(l.validate)?c.validate=l.validate:i(o,l),t7(l.normalize)?c.normalize=l.normalize:l.normalize?i(o,l):c.normalize=n7();return}if(EMe(l)){s.push(o);return}i(o,l)}),s.forEach(function(o){e.__compiled__[e.__schemas__[o]]&&(e.__compiled__[o].validate=e.__compiled__[e.__schemas__[o]].validate,e.__compiled__[o].normalize=e.__compiled__[e.__schemas__[o]].normalize)}),e.__compiled__[""]={validate:null,normalize:n7()};const a=Object.keys(e.__compiled__).filter(function(o){return o.length>0&&e.__compiled__[o]}).map(RMe).join("|");e.re.schema_test=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+a+")","i"),e.re.schema_search=RegExp("(^|(?!_)(?:[><]|"+t.src_ZPCc+"))("+a+")","ig"),e.re.schema_at_start=RegExp("^"+e.re.schema_search.source,"i"),e.re.pretest=RegExp("("+e.re.schema_test.source+")|("+e.re.host_fuzzy_test.source+")|@","i"),PMe(e)}function DMe(e,t){const n=e.__index__,r=e.__last_index__,s=e.__text_cache__.slice(n,r);this.schema=e.__schema__.toLowerCase(),this.index=n+t,this.lastIndex=r+t,this.raw=s,this.text=s,this.url=s}function Wj(e,t){const n=new DMe(e,t);return e.__compiled__[n.schema].normalize(n,e),n}function gl(e,t){if(!(this instanceof gl))return new gl(e,t);t||NMe(e)&&(t=e,e={}),this.__opts__=Vj({},hX,t),this.__index__=-1,this.__last_index__=-1,this.__schema__="",this.__text_cache__="",this.__schemas__=Vj({},MMe,e),this.__compiled__={},this.__tlds__=jMe,this.__tlds_replaced__=!1,this.re={},fk(this)}gl.prototype.add=function(t,n){return this.__schemas__[t]=n,fk(this),this};gl.prototype.set=function(t){return this.__opts__=Vj(this.__opts__,t),this};gl.prototype.test=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return!1;let n,r,s,i,a,o,l,c,u;if(this.re.schema_test.test(t)){for(l=this.re.schema_search,l.lastIndex=0;(n=l.exec(t))!==null;)if(i=this.testSchemaAt(t,n[2],l.lastIndex),i){this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+i;break}}return this.__opts__.fuzzyLink&&this.__compiled__["http:"]&&(c=t.search(this.re.host_fuzzy_test),c>=0&&(this.__index__<0||c<this.__index__)&&(r=t.match(this.__opts__.fuzzyIP?this.re.link_fuzzy:this.re.link_no_ip_fuzzy))!==null&&(a=r.index+r[1].length,(this.__index__<0||a<this.__index__)&&(this.__schema__="",this.__index__=a,this.__last_index__=r.index+r[0].length))),this.__opts__.fuzzyEmail&&this.__compiled__["mailto:"]&&(u=t.indexOf("@"),u>=0&&(s=t.match(this.re.email_fuzzy))!==null&&(a=s.index+s[1].length,o=s.index+s[0].length,(this.__index__<0||a<this.__index__||a===this.__index__&&o>this.__last_index__)&&(this.__schema__="mailto:",this.__index__=a,this.__last_index__=o))),this.__index__>=0};gl.prototype.pretest=function(t){return this.re.pretest.test(t)};gl.prototype.testSchemaAt=function(t,n,r){return this.__compiled__[n.toLowerCase()]?this.__compiled__[n.toLowerCase()].validate(t,r,this):0};gl.prototype.match=function(t){const n=[];let r=0;this.__index__>=0&&this.__text_cache__===t&&(n.push(Wj(this,r)),r=this.__last_index__);let s=r?t.slice(r):t;for(;this.test(s);)n.push(Wj(this,r)),s=s.slice(this.__last_index__),r+=this.__last_index__;return n.length?n:null};gl.prototype.matchAtStart=function(t){if(this.__text_cache__=t,this.__index__=-1,!t.length)return null;const n=this.re.schema_at_start.exec(t);if(!n)return null;const r=this.testSchemaAt(t,n[2],n[0].length);return r?(this.__schema__=n[2],this.__index__=n.index+n[1].length,this.__last_index__=n.index+n[0].length+r,Wj(this,0)):null};gl.prototype.tlds=function(t,n){return t=Array.isArray(t)?t:[t],n?(this.__tlds__=this.__tlds__.concat(t).sort().filter(function(r,s,i){return r!==i[s-1]}).reverse(),fk(this),this):(this.__tlds__=t.slice(),this.__tlds_replaced__=!0,fk(this),this)};gl.prototype.normalize=function(t){t.schema||(t.url="http://"+t.url),t.schema==="mailto:"&&!/^mailto:/i.test(t.url)&&(t.url="mailto:"+t.url)};gl.prototype.onCompile=function(){};const L0=2147483647,_u=36,ID=1,Mw=26,FMe=38,LMe=700,pX=72,mX=128,gX="-",BMe=/^xn--/,$Me=/[^\0-\x7F]/,zMe=/[\x2E\u3002\uFF0E\uFF61]/g,UMe={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},CI=_u-ID,Su=Math.floor,kI=String.fromCharCode;function mh(e){throw new RangeError(UMe[e])}function qMe(e,t){const n=[];let r=e.length;for(;r--;)n[r]=t(e[r]);return n}function yX(e,t){const n=e.split("@");let r="";n.length>1&&(r=n[0]+"@",e=n[1]),e=e.replace(zMe,".");const s=e.split("."),i=qMe(s,t).join(".");return r+i}function bX(e){const t=[];let n=0;const r=e.length;for(;n<r;){const s=e.charCodeAt(n++);if(s>=55296&&s<=56319&&n<r){const i=e.charCodeAt(n++);(i&64512)==56320?t.push(((s&1023)<<10)+(i&1023)+65536):(t.push(s),n--)}else t.push(s)}return t}const VMe=e=>String.fromCodePoint(...e),WMe=function(e){return e>=48&&e<58?26+(e-48):e>=65&&e<91?e-65:e>=97&&e<123?e-97:_u},r7=function(e,t){return e+22+75*(e<26)-((t!=0)<<5)},vX=function(e,t,n){let r=0;for(e=n?Su(e/LMe):e>>1,e+=Su(e/t);e>CI*Mw>>1;r+=_u)e=Su(e/CI);return Su(r+(CI+1)*e/(e+FMe))},xX=function(e){const t=[],n=e.length;let r=0,s=mX,i=pX,a=e.lastIndexOf(gX);a<0&&(a=0);for(let o=0;o<a;++o)e.charCodeAt(o)>=128&&mh("not-basic"),t.push(e.charCodeAt(o));for(let o=a>0?a+1:0;o<n;){const l=r;for(let u=1,d=_u;;d+=_u){o>=n&&mh("invalid-input");const h=WMe(e.charCodeAt(o++));h>=_u&&mh("invalid-input"),h>Su((L0-r)/u)&&mh("overflow"),r+=h*u;const m=d<=i?ID:d>=i+Mw?Mw:d-i;if(h<m)break;const y=_u-m;u>Su(L0/y)&&mh("overflow"),u*=y}const c=t.length+1;i=vX(r-l,c,l==0),Su(r/c)>L0-s&&mh("overflow"),s+=Su(r/c),r%=c,t.splice(r++,0,s)}return String.fromCodePoint(...t)},wX=function(e){const t=[];e=bX(e);const n=e.length;let r=mX,s=0,i=pX;for(const l of e)l<128&&t.push(kI(l));const a=t.length;let o=a;for(a&&t.push(gX);o<n;){let l=L0;for(const u of e)u>=r&&u<l&&(l=u);const c=o+1;l-r>Su((L0-s)/c)&&mh("overflow"),s+=(l-r)*c,r=l;for(const u of e)if(u<r&&++s>L0&&mh("overflow"),u===r){let d=s;for(let h=_u;;h+=_u){const m=h<=i?ID:h>=i+Mw?Mw:h-i;if(d<m)break;const y=d-m,b=_u-m;t.push(kI(r7(m+y%b,0))),d=Su(y/b)}t.push(kI(r7(d,0))),i=vX(s,c,o===a),s=0,++o}++s,++r}return t.join("")},HMe=function(e){return yX(e,function(t){return BMe.test(t)?xX(t.slice(4).toLowerCase()):t})},GMe=function(e){return yX(e,function(t){return $Me.test(t)?"xn--"+wX(t):t})},_X={version:"2.3.1",ucs2:{decode:bX,encode:VMe},decode:xX,encode:wX,toASCII:GMe,toUnicode:HMe},KMe={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:100},components:{core:{},block:{},inline:{}}},YMe={options:{html:!1,xhtmlOut:!1,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["paragraph"]},inline:{rules:["text"],rules2:["balance_pairs","fragments_join"]}}},ZMe={options:{html:!0,xhtmlOut:!0,breaks:!1,langPrefix:"language-",linkify:!1,typographer:!1,quotes:"",highlight:null,maxNesting:20},components:{core:{rules:["normalize","block","inline","text_join"]},block:{rules:["blockquote","code","fence","heading","hr","html_block","lheading","list","reference","paragraph"]},inline:{rules:["autolink","backticks","emphasis","entity","escape","html_inline","image","link","newline","text"],rules2:["balance_pairs","emphasis","fragments_join"]}}},XMe={default:KMe,zero:YMe,commonmark:ZMe},JMe=/^(vbscript|javascript|file|data):/,QMe=/^data:image\/(gif|png|jpeg|webp);/;function eIe(e){const t=e.trim().toLowerCase();return JMe.test(t)?QMe.test(t):!0}const SX=["http:","https:","mailto:"];function tIe(e){const t=ED(e,!0);if(t.hostname&&(!t.protocol||SX.indexOf(t.protocol)>=0))try{t.hostname=_X.toASCII(t.hostname)}catch{}return Y1(kD(t))}function nIe(e){const t=ED(e,!0);if(t.hostname&&(!t.protocol||SX.indexOf(t.protocol)>=0))try{t.hostname=_X.toUnicode(t.hostname)}catch{}return ky(kD(t),ky.defaultChars+"%")}function Vo(e,t){if(!(this instanceof Vo))return new Vo(e,t);t||AD(e)||(t=e||{},e="default"),this.inline=new X1,this.block=new bT,this.core=new ND,this.renderer=new pb,this.linkify=new gl,this.validateLink=eIe,this.normalizeLink=tIe,this.normalizeLinkText=nIe,this.utils=sNe,this.helpers=gT({},lNe),this.options={},this.configure(e),t&&this.set(t)}Vo.prototype.set=function(e){return gT(this.options,e),this};Vo.prototype.configure=function(e){const t=this;if(AD(e)){const n=e;if(e=XMe[n],!e)throw new Error('Wrong `markdown-it` preset "'+n+'", check name')}if(!e)throw new Error("Wrong `markdown-it` preset, can't be empty");return e.options&&t.set(e.options),e.components&&Object.keys(e.components).forEach(function(n){e.components[n].rules&&t[n].ruler.enableOnly(e.components[n].rules),e.components[n].rules2&&t[n].ruler2.enableOnly(e.components[n].rules2)}),this};Vo.prototype.enable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(s){n=n.concat(this[s].ruler.enable(e,!0))},this),n=n.concat(this.inline.ruler2.enable(e,!0));const r=e.filter(function(s){return n.indexOf(s)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to enable unknown rule(s): "+r);return this};Vo.prototype.disable=function(e,t){let n=[];Array.isArray(e)||(e=[e]),["core","block","inline"].forEach(function(s){n=n.concat(this[s].ruler.disable(e,!0))},this),n=n.concat(this.inline.ruler2.disable(e,!0));const r=e.filter(function(s){return n.indexOf(s)<0});if(r.length&&!t)throw new Error("MarkdownIt. Failed to disable unknown rule(s): "+r);return this};Vo.prototype.use=function(e){const t=[this].concat(Array.prototype.slice.call(arguments,1));return e.apply(e,t),this};Vo.prototype.parse=function(e,t){if(typeof e!="string")throw new Error("Input data should be a String");const n=new this.core.State(e,this,t);return this.core.process(n),n.tokens};Vo.prototype.render=function(e,t){return t=t||{},this.renderer.render(this.parse(e,t),this.options,t)};Vo.prototype.parseInline=function(e,t){const n=new this.core.State(e,this,t);return n.inlineMode=!0,this.core.process(n),n.tokens};Vo.prototype.renderInline=function(e,t){return t=t||{},this.renderer.render(this.parseInline(e,t),this.options,t)};const EI=new Vo({html:!1,linkify:!0,breaks:!0});function xT(e){return E.useMemo(()=>{var n;if(!e)return[];try{const r=EI.parse(e,{}),s=[];let i="",a=0;for(;a<r.length;){const o=r[a];if(o.type==="fence"){i&&(s.push(i),i="");const l=((n=o.info)==null?void 0:n.trim())||"";let c,u;if(l.includes(":")){const[d,...h]=l.split(":");c=d||void 0,u=h.join(":")||void 0}else c=l.split(" ")[0]||void 0;s.push({type:"block",lang:c,code:o.content,filepath:u}),a++}else{const l=[];for(;a<r.length&&r[a].type!=="fence";)l.push(r[a]),a++;l.length>0&&(i+=EI.renderer.render(l,EI.options,{}))}}return i&&s.push(i),s}catch(r){return console.error("Markdown parsing error:",r),[`<pre>${String(e??"").replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}</pre>`]}},[e])}const rIe=({markdownContent:e,interactionId:t})=>{const n=xT(e);return e!=null&&e.trim()?f.jsx("div",{className:"overflow-wrap-anywhere",children:n.map((r,s)=>typeof r=="string"?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:r}},`html-${s}`):r.type==="block"?f.jsx(Qy,{lang:r.lang,code:r.code,filepath:r.filepath,interactionId:t},`block-${s}`):null)}):null},wT=Ve.memo(({turnData:e,timestamp:t,className:n,isAssistantComplete:r=!0,interactionId:s})=>{var v,x;const i=pr(w=>w.foldUserMessagesOnCompletion),[a,o]=E.useState(r&&i),[l,c]=E.useState(!1);E.useEffect(()=>{r&&i&&o(!0)},[r,i]);const u=t?XZ(new Date(t),{addSuffix:!0}):"Sending...",d=((v=e.metadata)==null?void 0:v.attachedFiles)&&e.metadata.attachedFiles.length>0,h=e.content&&e.content.trim().length>0,m=E.useCallback(()=>o(w=>!w),[]),y=E.useCallback(async()=>{if(e.content)try{await navigator.clipboard.writeText(e.content),c(!0),Te.success("User prompt copied!"),setTimeout(()=>c(!1),1500)}catch(w){Te.error("Failed to copy prompt."),console.error("Clipboard copy failed:",w)}},[e.content]),b=E.useMemo(()=>{var S;let w="";return h&&(w+=`"${e.content.substring(0,50)}${e.content.length>50?"...":""}"`),h&&d&&(w+=" + "),d&&(w+=`${(S=e.metadata.attachedFiles)==null?void 0:S.length} file(s)`),w||"[Empty Prompt]"},[h,d,e.content,e.metadata]);return f.jsxs("div",{className:Ze("user-prompt relative group/user overflow-wrap-anywhere",n),children:[f.jsxs("div",{className:Ze("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-10 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-center gap-1 mb-1 sm:mb-0",children:[f.jsx(i0e,{className:"h-4 w-4 text-primary flex-shrink-0"}),f.jsx("span",{className:"text-xs font-semibold text-primary mr-1",children:"User"}),f.jsxs("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/user:opacity-100 focus-within:opacity-100 transition-opacity",children:[h&&f.jsx(qn,{tooltipText:"Copy Prompt",onClick:y,"aria-label":"Copy user prompt",icon:l?f.jsx(co,{className:"text-green-500"}):f.jsx(wE,{}),className:"h-5 w-5"}),(h||d)&&f.jsx(qn,{tooltipText:a?"Unfold":"Fold",onClick:m,"aria-label":a?"Unfold prompt":"Fold prompt",icon:a?f.jsx(Ql,{}):f.jsx(Xh,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})]})]}),f.jsx("div",{className:"flex items-center flex-shrink-0 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground",children:u})})]}),!a&&f.jsxs(f.Fragment,{children:[d&&f.jsx("div",{className:"mb-2 space-y-1",children:(x=e.metadata.attachedFiles)==null?void 0:x.map(w=>f.jsx(PZ,{fileMeta:w,isReadOnly:!0},w.id))}),f.jsx(rIe,{markdownContent:e.content,interactionId:s})]}),a&&f.jsx("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:m,children:b})]})});wT.displayName="UserPromptDisplay";const sIe=(e,t,n,r)=>typeof e=="string"?e.trim()?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:e}},`html-${t}`):null:e.type==="block"?f.jsx(Qy,{lang:e.lang,code:e.code,filepath:e.filepath,isStreaming:n,interactionId:r},`block-${t}`):null,iIe=({interactionId:e,markdownContent:t,isStreaming:n=!1,className:r})=>{const{enableStreamingMarkdown:s}=pr(yn(h=>({enableStreamingMarkdown:h.enableStreamingMarkdown}))),i=xT(s?t:null),a=Wi(yn(h=>Object.values(h.canvasControls))),o=E.useCallback((h,m)=>a.filter(y=>y.type==="tool-call-step"&&y.targetSlot===h&&y.renderer).map(y=>y.renderer?f.jsx(Ve.Fragment,{children:y.renderer(m)},y.id):null).filter(Boolean),[a]),{toolCallStrings:l,toolResultStrings:c}=un(yn(h=>{var y,b;const m=h.interactions.find(v=>v.id===e);return{toolCallStrings:(y=m==null?void 0:m.metadata)==null?void 0:y.toolCalls,toolResultStrings:(b=m==null?void 0:m.metadata)==null?void 0:b.toolResults}})),u=E.useMemo(()=>{if(!l)return[];try{const h=l.map(y=>JSON.parse(y)),m=(c==null?void 0:c.map(y=>JSON.parse(y)))??[];return h.map(y=>{const b=m.find(v=>v.toolCallId===y.toolCallId);return{call:y,result:b}})}catch(h){return console.error("[StreamingContentView] Error parsing tool call/result strings:",h),[]}},[l,c]),d=E.useMemo(()=>s?i.map((h,m)=>sIe(h,m,n&&m===i.length-1,e)).filter(Boolean):[],[s,i,n,e]);return!s&&!t&&u.length===0?n?f.jsx("div",{className:Ze("text-muted-foreground italic",r),children:"Generating response..."}):null:f.jsxs("div",{className:Ze("streaming-content-view overflow-wrap-anywhere",r),children:[u.map(({call:h,result:m},y)=>{const b={interactionId:e,toolCall:h,toolResult:m,canvasContextType:"tool-call-step"};return f.jsx(Ve.Fragment,{children:o("tool-call-content",b)},`tool-step-${h.toolCallId||y}`)}),s?d:t?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:new Vo().render(t)}}):null]})},aIe=({onStop:e,className:t,size:n="icon",variant:r="ghost","aria-label":s="Stop Generation"})=>f.jsx(qn,{tooltipText:"Stop",onClick:e,"aria-label":s,icon:f.jsx(Kge,{}),variant:r,size:n,className:t}),oIe="modulepreload",lIe=function(e){return"/"+e},s7={},Dr=function(t,n,r){let s=Promise.resolve();if(n&&n.length>0){let a=function(c){return Promise.all(c.map(u=>Promise.resolve(u).then(d=>({status:"fulfilled",value:d}),d=>({status:"rejected",reason:d}))))};document.getElementsByTagName("link");const o=document.querySelector("meta[property=csp-nonce]"),l=(o==null?void 0:o.nonce)||(o==null?void 0:o.getAttribute("nonce"));s=a(n.map(c=>{if(c=lIe(c),c in s7)return;s7[c]=!0;const u=c.endsWith(".css"),d=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${c}"]${d}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":oIe,u||(h.as="script"),h.crossOrigin="",h.href=c,l&&h.setAttribute("nonce",l),document.head.appendChild(h),u)return new Promise((m,y)=>{h.addEventListener("load",m),h.addEventListener("error",()=>y(new Error(`Unable to preload CSS for ${c}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return t().catch(i)})},cIe=Symbol("Let zodToJsonSchema decide on which parser to use"),i7={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",allowedAdditionalProperties:!0,rejectedAdditionalProperties:!1,definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},uIe=e=>typeof e=="string"?{...i7,name:e}:{...i7,...e},dIe=e=>{const t=uIe(e),n=t.name!==void 0?[...t.basePath,t.definitionPath,t.name]:t.basePath;return{...t,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(t.definitions).map(([r,s])=>[s._def,{def:s._def,path:[...t.basePath,t.definitionPath,r],jsonSchema:void 0}]))}};function CX(e,t,n,r){r!=null&&r.errorMessages&&n&&(e.errorMessage={...e.errorMessage,[t]:n})}function ws(e,t,n,r,s){e[t]=n,CX(e,t,r,s)}function fIe(){return{}}function hIe(e,t){var r,s,i;const n={type:"array"};return(r=e.type)!=null&&r._def&&((i=(s=e.type)==null?void 0:s._def)==null?void 0:i.typeName)!==tn.ZodAny&&(n.items=cs(e.type._def,{...t,currentPath:[...t.currentPath,"items"]})),e.minLength&&ws(n,"minItems",e.minLength.value,e.minLength.message,t),e.maxLength&&ws(n,"maxItems",e.maxLength.value,e.maxLength.message,t),e.exactLength&&(ws(n,"minItems",e.exactLength.value,e.exactLength.message,t),ws(n,"maxItems",e.exactLength.value,e.exactLength.message,t)),n}function pIe(e,t){const n={type:"integer",format:"int64"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"min":t.target==="jsonSchema7"?r.inclusive?ws(n,"minimum",r.value,r.message,t):ws(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),ws(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?ws(n,"maximum",r.value,r.message,t):ws(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),ws(n,"maximum",r.value,r.message,t));break;case"multipleOf":ws(n,"multipleOf",r.value,r.message,t);break}return n}function mIe(){return{type:"boolean"}}function kX(e,t){return cs(e.type._def,t)}const gIe=(e,t)=>cs(e.innerType._def,t);function EX(e,t,n){const r=n??t.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,i)=>EX(e,t,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return yIe(e,t)}}const yIe=(e,t)=>{const n={type:"integer",format:"unix-time"};if(t.target==="openApi3")return n;for(const r of e.checks)switch(r.kind){case"min":ws(n,"minimum",r.value,r.message,t);break;case"max":ws(n,"maximum",r.value,r.message,t);break}return n};function bIe(e,t){return{...cs(e.innerType._def,t),default:e.defaultValue()}}function vIe(e,t){return t.effectStrategy==="input"?cs(e.schema._def,t):{}}function xIe(e){return{type:"string",enum:Array.from(e.values)}}const wIe=e=>"type"in e&&e.type==="string"?!1:"allOf"in e;function _Ie(e,t){const n=[cs(e.left._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),cs(e.right._def,{...t,currentPath:[...t.currentPath,"allOf","1"]})].filter(i=>!!i);let r=t.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return n.forEach(i=>{if(wIe(i))s.push(...i.allOf),i.unevaluatedProperties===void 0&&(r=void 0);else{let a=i;if("additionalProperties"in i&&i.additionalProperties===!1){const{additionalProperties:o,...l}=i;a=l}else r=void 0;s.push(a)}}),s.length?{allOf:s,...r}:void 0}function SIe(e,t){const n=typeof e.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(e.value)?"array":"object"}:t.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[e.value]}:{type:n==="bigint"?"integer":n,const:e.value}}let TI;const pc={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(TI===void 0&&(TI=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),TI),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function TX(e,t){const n={type:"string"};if(e.checks)for(const r of e.checks)switch(r.kind){case"min":ws(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t);break;case"max":ws(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"email":switch(t.emailStrategy){case"format:email":mc(n,"email",r.message,t);break;case"format:idn-email":mc(n,"idn-email",r.message,t);break;case"pattern:zod":Qa(n,pc.email,r.message,t);break}break;case"url":mc(n,"uri",r.message,t);break;case"uuid":mc(n,"uuid",r.message,t);break;case"regex":Qa(n,r.regex,r.message,t);break;case"cuid":Qa(n,pc.cuid,r.message,t);break;case"cuid2":Qa(n,pc.cuid2,r.message,t);break;case"startsWith":Qa(n,RegExp(`^${AI(r.value,t)}`),r.message,t);break;case"endsWith":Qa(n,RegExp(`${AI(r.value,t)}$`),r.message,t);break;case"datetime":mc(n,"date-time",r.message,t);break;case"date":mc(n,"date",r.message,t);break;case"time":mc(n,"time",r.message,t);break;case"duration":mc(n,"duration",r.message,t);break;case"length":ws(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,t),ws(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,t);break;case"includes":{Qa(n,RegExp(AI(r.value,t)),r.message,t);break}case"ip":{r.version!=="v6"&&mc(n,"ipv4",r.message,t),r.version!=="v4"&&mc(n,"ipv6",r.message,t);break}case"base64url":Qa(n,pc.base64url,r.message,t);break;case"jwt":Qa(n,pc.jwt,r.message,t);break;case"cidr":{r.version!=="v6"&&Qa(n,pc.ipv4Cidr,r.message,t),r.version!=="v4"&&Qa(n,pc.ipv6Cidr,r.message,t);break}case"emoji":Qa(n,pc.emoji(),r.message,t);break;case"ulid":{Qa(n,pc.ulid,r.message,t);break}case"base64":{switch(t.base64Strategy){case"format:binary":{mc(n,"binary",r.message,t);break}case"contentEncoding:base64":{ws(n,"contentEncoding","base64",r.message,t);break}case"pattern:zod":{Qa(n,pc.base64,r.message,t);break}}break}case"nanoid":Qa(n,pc.nanoid,r.message,t)}return n}function AI(e,t){return t.patternStrategy==="escape"?kIe(e):e}const CIe=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function kIe(e){let t="";for(let n=0;n<e.length;n++)CIe.has(e[n])||(t+="\\"),t+=e[n];return t}function mc(e,t,n,r){var s;e.format||(s=e.anyOf)!=null&&s.some(i=>i.format)?(e.anyOf||(e.anyOf=[]),e.format&&(e.anyOf.push({format:e.format,...e.errorMessage&&r.errorMessages&&{errorMessage:{format:e.errorMessage.format}}}),delete e.format,e.errorMessage&&(delete e.errorMessage.format,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.anyOf.push({format:t,...n&&r.errorMessages&&{errorMessage:{format:n}}})):ws(e,"format",t,n,r)}function Qa(e,t,n,r){var s;e.pattern||(s=e.allOf)!=null&&s.some(i=>i.pattern)?(e.allOf||(e.allOf=[]),e.pattern&&(e.allOf.push({pattern:e.pattern,...e.errorMessage&&r.errorMessages&&{errorMessage:{pattern:e.errorMessage.pattern}}}),delete e.pattern,e.errorMessage&&(delete e.errorMessage.pattern,Object.keys(e.errorMessage).length===0&&delete e.errorMessage)),e.allOf.push({pattern:a7(t,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):ws(e,"pattern",a7(t,r),n,r)}function a7(e,t){var l;if(!t.applyRegexFlags||!e.flags)return e.source;const n={i:e.flags.includes("i"),m:e.flags.includes("m"),s:e.flags.includes("s")},r=n.i?e.source.toLowerCase():e.source;let s="",i=!1,a=!1,o=!1;for(let c=0;c<r.length;c++){if(i){s+=r[c],i=!1;continue}if(n.i){if(a){if(r[c].match(/[a-z]/)){o?(s+=r[c],s+=`${r[c-2]}-${r[c]}`.toUpperCase(),o=!1):r[c+1]==="-"&&((l=r[c+2])!=null&&l.match(/[a-z]/))?(s+=r[c],o=!0):s+=`${r[c]}${r[c].toUpperCase()}`;continue}}else if(r[c].match(/[a-z]/)){s+=`[${r[c]}${r[c].toUpperCase()}]`;continue}}if(n.m){if(r[c]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(r[c]==="$"){s+=`($|(?=[\r
]))`;continue}}if(n.s&&r[c]==="."){s+=a?`${r[c]}\r
`:`[${r[c]}\r
]`;continue}s+=r[c],r[c]==="\\"?i=!0:a&&r[c]==="]"?a=!1:!a&&r[c]==="["&&(a=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${t.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),e.source}return s}function AX(e,t){var r,s,i,a,o,l;if(t.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),t.target==="openApi3"&&((r=e.keyType)==null?void 0:r._def.typeName)===tn.ZodEnum)return{type:"object",required:e.keyType._def.values,properties:e.keyType._def.values.reduce((c,u)=>({...c,[u]:cs(e.valueType._def,{...t,currentPath:[...t.currentPath,"properties",u]})??{}}),{}),additionalProperties:t.rejectedAdditionalProperties};const n={type:"object",additionalProperties:cs(e.valueType._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]})??t.allowedAdditionalProperties};if(t.target==="openApi3")return n;if(((s=e.keyType)==null?void 0:s._def.typeName)===tn.ZodString&&((i=e.keyType._def.checks)!=null&&i.length)){const{type:c,...u}=TX(e.keyType._def,t);return{...n,propertyNames:u}}else{if(((a=e.keyType)==null?void 0:a._def.typeName)===tn.ZodEnum)return{...n,propertyNames:{enum:e.keyType._def.values}};if(((o=e.keyType)==null?void 0:o._def.typeName)===tn.ZodBranded&&e.keyType._def.type._def.typeName===tn.ZodString&&((l=e.keyType._def.type._def.checks)!=null&&l.length)){const{type:c,...u}=kX(e.keyType._def,t);return{...n,propertyNames:u}}}return n}function EIe(e,t){if(t.mapStrategy==="record")return AX(e,t);const n=cs(e.keyType._def,{...t,currentPath:[...t.currentPath,"items","items","0"]})||{},r=cs(e.valueType._def,{...t,currentPath:[...t.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function TIe(e){const t=e.values,r=Object.keys(e.values).filter(i=>typeof t[t[i]]!="number").map(i=>t[i]),s=Array.from(new Set(r.map(i=>typeof i)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function AIe(){return{not:{}}}function RIe(e){return e.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const hk={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function NIe(e,t){if(t.target==="openApi3")return o7(e,t);const n=e.options instanceof Map?Array.from(e.options.values()):e.options;if(n.every(r=>r._def.typeName in hk&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((s,i)=>{const a=hk[i._def.typeName];return a&&!s.includes(a)?[...s,a]:s},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((s,i)=>{const a=typeof i._def.value;switch(a){case"string":case"number":case"boolean":return[...s,a];case"bigint":return[...s,"integer"];case"object":if(i._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===n.length){const s=r.filter((i,a,o)=>o.indexOf(i)===a);return{type:s.length>1?s:s[0],enum:n.reduce((i,a)=>i.includes(a._def.value)?i:[...i,a._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,s)=>[...r,...s._def.values.filter(i=>!r.includes(i))],[])};return o7(e,t)}const o7=(e,t)=>{const n=(e.options instanceof Map?Array.from(e.options.values()):e.options).map((r,s)=>cs(r._def,{...t,currentPath:[...t.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!t.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function MIe(e,t){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(e.innerType._def.typeName)&&(!e.innerType._def.checks||!e.innerType._def.checks.length))return t.target==="openApi3"?{type:hk[e.innerType._def.typeName],nullable:!0}:{type:[hk[e.innerType._def.typeName],"null"]};if(t.target==="openApi3"){const r=cs(e.innerType._def,{...t,currentPath:[...t.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=cs(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function IIe(e,t){const n={type:"number"};if(!e.checks)return n;for(const r of e.checks)switch(r.kind){case"int":n.type="integer",CX(n,"type",r.message,t);break;case"min":t.target==="jsonSchema7"?r.inclusive?ws(n,"minimum",r.value,r.message,t):ws(n,"exclusiveMinimum",r.value,r.message,t):(r.inclusive||(n.exclusiveMinimum=!0),ws(n,"minimum",r.value,r.message,t));break;case"max":t.target==="jsonSchema7"?r.inclusive?ws(n,"maximum",r.value,r.message,t):ws(n,"exclusiveMaximum",r.value,r.message,t):(r.inclusive||(n.exclusiveMaximum=!0),ws(n,"maximum",r.value,r.message,t));break;case"multipleOf":ws(n,"multipleOf",r.value,r.message,t);break}return n}function jIe(e,t){const n=t.target==="openAi",r={type:"object",properties:{}},s=[],i=e.shape();for(const o in i){let l=i[o];if(l===void 0||l._def===void 0)continue;let c=OIe(l);c&&n&&(l instanceof Eu&&(l=l._def.innerType),l.isNullable()||(l=l.nullable()),c=!1);const u=cs(l._def,{...t,currentPath:[...t.currentPath,"properties",o],propertyPath:[...t.currentPath,"properties",o]});u!==void 0&&(r.properties[o]=u,c||s.push(o))}s.length&&(r.required=s);const a=PIe(e,t);return a!==void 0&&(r.additionalProperties=a),r}function PIe(e,t){if(e.catchall._def.typeName!=="ZodNever")return cs(e.catchall._def,{...t,currentPath:[...t.currentPath,"additionalProperties"]});switch(e.unknownKeys){case"passthrough":return t.allowedAdditionalProperties;case"strict":return t.rejectedAdditionalProperties;case"strip":return t.removeAdditionalStrategy==="strict"?t.allowedAdditionalProperties:t.rejectedAdditionalProperties}}function OIe(e){try{return e.isOptional()}catch{return!0}}const DIe=(e,t)=>{var r;if(t.currentPath.toString()===((r=t.propertyPath)==null?void 0:r.toString()))return cs(e.innerType._def,t);const n=cs(e.innerType._def,{...t,currentPath:[...t.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},FIe=(e,t)=>{if(t.pipeStrategy==="input")return cs(e.in._def,t);if(t.pipeStrategy==="output")return cs(e.out._def,t);const n=cs(e.in._def,{...t,currentPath:[...t.currentPath,"allOf","0"]}),r=cs(e.out._def,{...t,currentPath:[...t.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(s=>s!==void 0)}};function LIe(e,t){return cs(e.type._def,t)}function BIe(e,t){const r={type:"array",uniqueItems:!0,items:cs(e.valueType._def,{...t,currentPath:[...t.currentPath,"items"]})};return e.minSize&&ws(r,"minItems",e.minSize.value,e.minSize.message,t),e.maxSize&&ws(r,"maxItems",e.maxSize.value,e.maxSize.message,t),r}function $Ie(e,t){return e.rest?{type:"array",minItems:e.items.length,items:e.items.map((n,r)=>cs(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:cs(e.rest._def,{...t,currentPath:[...t.currentPath,"additionalItems"]})}:{type:"array",minItems:e.items.length,maxItems:e.items.length,items:e.items.map((n,r)=>cs(n._def,{...t,currentPath:[...t.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function zIe(){return{not:{}}}function UIe(){return{}}const qIe=(e,t)=>cs(e.innerType._def,t),VIe=(e,t,n)=>{switch(t){case tn.ZodString:return TX(e,n);case tn.ZodNumber:return IIe(e,n);case tn.ZodObject:return jIe(e,n);case tn.ZodBigInt:return pIe(e,n);case tn.ZodBoolean:return mIe();case tn.ZodDate:return EX(e,n);case tn.ZodUndefined:return zIe();case tn.ZodNull:return RIe(n);case tn.ZodArray:return hIe(e,n);case tn.ZodUnion:case tn.ZodDiscriminatedUnion:return NIe(e,n);case tn.ZodIntersection:return _Ie(e,n);case tn.ZodTuple:return $Ie(e,n);case tn.ZodRecord:return AX(e,n);case tn.ZodLiteral:return SIe(e,n);case tn.ZodEnum:return xIe(e);case tn.ZodNativeEnum:return TIe(e);case tn.ZodNullable:return MIe(e,n);case tn.ZodOptional:return DIe(e,n);case tn.ZodMap:return EIe(e,n);case tn.ZodSet:return BIe(e,n);case tn.ZodLazy:return()=>e.getter()._def;case tn.ZodPromise:return LIe(e,n);case tn.ZodNaN:case tn.ZodNever:return AIe();case tn.ZodEffects:return vIe(e,n);case tn.ZodAny:return fIe();case tn.ZodUnknown:return UIe();case tn.ZodDefault:return bIe(e,n);case tn.ZodBranded:return kX(e,n);case tn.ZodReadonly:return qIe(e,n);case tn.ZodCatch:return gIe(e,n);case tn.ZodPipeline:return FIe(e,n);case tn.ZodFunction:case tn.ZodVoid:case tn.ZodSymbol:return;default:return(r=>{})()}};function cs(e,t,n=!1){var o;const r=t.seen.get(e);if(t.override){const l=(o=t.override)==null?void 0:o.call(t,e,t,r,n);if(l!==cIe)return l}if(r&&!n){const l=WIe(r,t);if(l!==void 0)return l}const s={def:e,path:t.currentPath,jsonSchema:void 0};t.seen.set(e,s);const i=VIe(e,e.typeName,t),a=typeof i=="function"?cs(i(),t):i;if(a&&GIe(e,t,a),t.postProcess){const l=t.postProcess(a,e,t);return s.jsonSchema=a,l}return s.jsonSchema=a,a}const WIe=(e,t)=>{switch(t.$refStrategy){case"root":return{$ref:e.path.join("/")};case"relative":return{$ref:HIe(t.currentPath,e.path)};case"none":case"seen":return e.path.length<t.currentPath.length&&e.path.every((n,r)=>t.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${t.currentPath.join("/")}! Defaulting to any`),{}):t.$refStrategy==="seen"?{}:void 0}},HIe=(e,t)=>{let n=0;for(;n<e.length&&n<t.length&&e[n]===t[n];n++);return[(e.length-n).toString(),...t.slice(n)].join("/")},GIe=(e,t,n)=>(e.description&&(n.description=e.description,t.markdownDescription&&(n.markdownDescription=e.description)),n),KIe=(e,t)=>{const n=dIe(t),r=typeof t=="object"&&t.definitions?Object.entries(t.definitions).reduce((l,[c,u])=>({...l,[c]:cs(u._def,{...n,currentPath:[...n.basePath,n.definitionPath,c]},!0)??{}}),{}):void 0,s=typeof t=="string"?t:(t==null?void 0:t.nameStrategy)==="title"||t==null?void 0:t.name,i=cs(e._def,s===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,s]},!1)??{},a=typeof t=="object"&&t.name!==void 0&&t.nameStrategy==="title"?t.name:void 0;a!==void 0&&(i.title=a);const o=s===void 0?r?{...i,[n.definitionPath]:r}:i:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,s].join("/"),[n.definitionPath]:{...r,[s]:i}};return n.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in o||"oneOf"in o||"allOf"in o||"type"in o&&Array.isArray(o.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),o};var Iw={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},jw={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},Pw={code:"4",name:"assistant_message",parse:e=>{if(e==null||typeof e!="object"||!("id"in e)||!("role"in e)||!("content"in e)||typeof e.id!="string"||typeof e.role!="string"||e.role!=="assistant"||!Array.isArray(e.content)||!e.content.every(t=>t!=null&&typeof t=="object"&&"type"in t&&t.type==="text"&&"text"in t&&t.text!=null&&typeof t.text=="object"&&"value"in t.text&&typeof t.text.value=="string"))throw new Error('"assistant_message" parts expect an object with an "id", "role", and "content" property.');return{type:"assistant_message",value:e}}},Ow={code:"5",name:"assistant_control_data",parse:e=>{if(e==null||typeof e!="object"||!("threadId"in e)||!("messageId"in e)||typeof e.threadId!="string"||typeof e.messageId!="string")throw new Error('"assistant_control_data" parts expect an object with a "threadId" and "messageId" property.');return{type:"assistant_control_data",value:{threadId:e.threadId,messageId:e.messageId}}}},Dw={code:"6",name:"data_message",parse:e=>{if(e==null||typeof e!="object"||!("role"in e)||!("data"in e)||typeof e.role!="string"||e.role!=="data")throw new Error('"data_message" parts expect an object with a "role" and "data" property.');return{type:"data_message",value:e}}},YIe=[Iw,jw,Pw,Ow,Dw];Iw.code+"",jw.code+"",Pw.code+"",Ow.code+"",Dw.code+"";Iw.name+"",Iw.code,jw.name+"",jw.code,Pw.name+"",Pw.code,Ow.name+"",Ow.code,Dw.name+"",Dw.code;YIe.map(e=>e.code);function ZIe(e){const t=["ROOT"];let n=-1,r=null;function s(l,c,u){switch(l){case'"':{n=c,t.pop(),t.push(u),t.push("INSIDE_STRING");break}case"f":case"t":case"n":{n=c,r=c,t.pop(),t.push(u),t.push("INSIDE_LITERAL");break}case"-":{t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=c,t.pop(),t.push(u),t.push("INSIDE_NUMBER");break}case"{":{n=c,t.pop(),t.push(u),t.push("INSIDE_OBJECT_START");break}case"[":{n=c,t.pop(),t.push(u),t.push("INSIDE_ARRAY_START");break}}}function i(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_OBJECT_AFTER_COMMA");break}case"}":{n=c,t.pop();break}}}function a(l,c){switch(l){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=c,t.pop();break}}}for(let l=0;l<e.length;l++){const c=e[l];switch(t[t.length-1]){case"ROOT":s(c,l,"FINISH");break;case"INSIDE_OBJECT_START":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}case"}":{n=l,t.pop();break}}break}case"INSIDE_OBJECT_AFTER_COMMA":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_KEY");break}}break}case"INSIDE_OBJECT_KEY":{switch(c){case'"':{t.pop(),t.push("INSIDE_OBJECT_AFTER_KEY");break}}break}case"INSIDE_OBJECT_AFTER_KEY":{switch(c){case":":{t.pop(),t.push("INSIDE_OBJECT_BEFORE_VALUE");break}}break}case"INSIDE_OBJECT_BEFORE_VALUE":{s(c,l,"INSIDE_OBJECT_AFTER_VALUE");break}case"INSIDE_OBJECT_AFTER_VALUE":{i(c,l);break}case"INSIDE_STRING":{switch(c){case'"':{t.pop(),n=l;break}case"\\":{t.push("INSIDE_STRING_ESCAPE");break}default:n=l}break}case"INSIDE_ARRAY_START":{switch(c){case"]":{n=l,t.pop();break}default:{n=l,s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}}break}case"INSIDE_ARRAY_AFTER_VALUE":{switch(c){case",":{t.pop(),t.push("INSIDE_ARRAY_AFTER_COMMA");break}case"]":{n=l,t.pop();break}default:{n=l;break}}break}case"INSIDE_ARRAY_AFTER_COMMA":{s(c,l,"INSIDE_ARRAY_AFTER_VALUE");break}case"INSIDE_STRING_ESCAPE":{t.pop(),n=l;break}case"INSIDE_NUMBER":{switch(c){case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":{n=l;break}case"e":case"E":case"-":case".":break;case",":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"}":{t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"&&i(c,l);break}case"]":{t.pop(),t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l);break}default:{t.pop();break}}break}case"INSIDE_LITERAL":{const d=e.substring(r,l+1);!"false".startsWith(d)&&!"true".startsWith(d)&&!"null".startsWith(d)?(t.pop(),t[t.length-1]==="INSIDE_OBJECT_AFTER_VALUE"?i(c,l):t[t.length-1]==="INSIDE_ARRAY_AFTER_VALUE"&&a(c,l)):n=l;break}}}let o=e.slice(0,n+1);for(let l=t.length-1;l>=0;l--)switch(t[l]){case"INSIDE_STRING":{o+='"';break}case"INSIDE_OBJECT_KEY":case"INSIDE_OBJECT_AFTER_KEY":case"INSIDE_OBJECT_AFTER_COMMA":case"INSIDE_OBJECT_START":case"INSIDE_OBJECT_BEFORE_VALUE":case"INSIDE_OBJECT_AFTER_VALUE":{o+="}";break}case"INSIDE_ARRAY_START":case"INSIDE_ARRAY_AFTER_COMMA":case"INSIDE_ARRAY_AFTER_VALUE":{o+="]";break}case"INSIDE_LITERAL":{const u=e.substring(r,e.length);"true".startsWith(u)?o+="true".slice(u.length):"false".startsWith(u)?o+="false".slice(u.length):"null".startsWith(u)&&(o+="null".slice(u.length))}}return o}function XIe(e){if(e===void 0)return{value:void 0,state:"undefined-input"};let t=km({text:e});return t.success?{value:t.value,state:"successful-parse"}:(t=km({text:ZIe(e)}),t.success?{value:t.value,state:"repaired-parse"}:{value:void 0,state:"failed-parse"})}var JIe={code:"0",name:"text",parse:e=>{if(typeof e!="string")throw new Error('"text" parts expect a string value.');return{type:"text",value:e}}},QIe={code:"2",name:"data",parse:e=>{if(!Array.isArray(e))throw new Error('"data" parts expect an array value.');return{type:"data",value:e}}},e3e={code:"3",name:"error",parse:e=>{if(typeof e!="string")throw new Error('"error" parts expect a string value.');return{type:"error",value:e}}},t3e={code:"8",name:"message_annotations",parse:e=>{if(!Array.isArray(e))throw new Error('"message_annotations" parts expect an array value.');return{type:"message_annotations",value:e}}},n3e={code:"9",name:"tool_call",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string"||!("args"in e)||typeof e.args!="object")throw new Error('"tool_call" parts expect an object with a "toolCallId", "toolName", and "args" property.');return{type:"tool_call",value:e}}},r3e={code:"a",name:"tool_result",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("result"in e))throw new Error('"tool_result" parts expect an object with a "toolCallId" and a "result" property.');return{type:"tool_result",value:e}}},s3e={code:"b",name:"tool_call_streaming_start",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("toolName"in e)||typeof e.toolName!="string")throw new Error('"tool_call_streaming_start" parts expect an object with a "toolCallId" and "toolName" property.');return{type:"tool_call_streaming_start",value:e}}},i3e={code:"c",name:"tool_call_delta",parse:e=>{if(e==null||typeof e!="object"||!("toolCallId"in e)||typeof e.toolCallId!="string"||!("argsTextDelta"in e)||typeof e.argsTextDelta!="string")throw new Error('"tool_call_delta" parts expect an object with a "toolCallId" and "argsTextDelta" property.');return{type:"tool_call_delta",value:e}}},a3e={code:"d",name:"finish_message",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_message" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),{type:"finish_message",value:t}}},o3e={code:"e",name:"finish_step",parse:e=>{if(e==null||typeof e!="object"||!("finishReason"in e)||typeof e.finishReason!="string")throw new Error('"finish_step" parts expect an object with a "finishReason" property.');const t={finishReason:e.finishReason,isContinued:!1};return"usage"in e&&e.usage!=null&&typeof e.usage=="object"&&"promptTokens"in e.usage&&"completionTokens"in e.usage&&(t.usage={promptTokens:typeof e.usage.promptTokens=="number"?e.usage.promptTokens:Number.NaN,completionTokens:typeof e.usage.completionTokens=="number"?e.usage.completionTokens:Number.NaN}),"isContinued"in e&&typeof e.isContinued=="boolean"&&(t.isContinued=e.isContinued),{type:"finish_step",value:t}}},l3e={code:"f",name:"start_step",parse:e=>{if(e==null||typeof e!="object"||!("messageId"in e)||typeof e.messageId!="string")throw new Error('"start_step" parts expect an object with an "id" property.');return{type:"start_step",value:{messageId:e.messageId}}}},c3e={code:"g",name:"reasoning",parse:e=>{if(typeof e!="string")throw new Error('"reasoning" parts expect a string value.');return{type:"reasoning",value:e}}},u3e={code:"h",name:"source",parse:e=>{if(e==null||typeof e!="object")throw new Error('"source" parts expect a Source object.');return{type:"source",value:e}}},d3e={code:"i",name:"redacted_reasoning",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string")throw new Error('"redacted_reasoning" parts expect an object with a "data" property.');return{type:"redacted_reasoning",value:{data:e.data}}}},f3e={code:"j",name:"reasoning_signature",parse:e=>{if(e==null||typeof e!="object"||!("signature"in e)||typeof e.signature!="string")throw new Error('"reasoning_signature" parts expect an object with a "signature" property.');return{type:"reasoning_signature",value:{signature:e.signature}}}},h3e={code:"k",name:"file",parse:e=>{if(e==null||typeof e!="object"||!("data"in e)||typeof e.data!="string"||!("mimeType"in e)||typeof e.mimeType!="string")throw new Error('"file" parts expect an object with a "data" and "mimeType" property.');return{type:"file",value:e}}},_T=[JIe,QIe,e3e,t3e,n3e,r3e,s3e,i3e,a3e,o3e,l3e,c3e,u3e,d3e,f3e,h3e];Object.fromEntries(_T.map(e=>[e.code,e]));Object.fromEntries(_T.map(e=>[e.name,e.code]));_T.map(e=>e.code);function Ma(e,t){const n=_T.find(r=>r.name===e);if(!n)throw new Error(`Invalid stream part type: ${e}`);return`${n.code}:${JSON.stringify(t)}
`}function p3e(e,t){var n;const r=(n=void 0)!=null?n:!1;return RX(KIe(e,{$refStrategy:r?"root":"none",target:"jsonSchema7"}),{validate:s=>{const i=e.safeParse(s);return i.success?{success:!0,value:i.data}:{success:!1,error:i.error}}})}var Hj=Symbol.for("vercel.ai.schema");function RX(e,{validate:t}={}){return{[Hj]:!0,_type:void 0,[x2]:!0,jsonSchema:e,validate:t}}function m3e(e){return typeof e=="object"&&e!==null&&Hj in e&&e[Hj]===!0&&"jsonSchema"in e&&"validate"in e}function ST(e){return m3e(e)?e:p3e(e)}const C0=globalThis||void 0||self;var g3e=typeof globalThis=="object"?globalThis:typeof self=="object"?self:typeof window=="object"?window:typeof C0=="object"?C0:{},lm="1.9.0",l7=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function y3e(e){var t=new Set([e]),n=new Set,r=e.match(l7);if(!r)return function(){return!1};var s={major:+r[1],minor:+r[2],patch:+r[3],prerelease:r[4]};if(s.prerelease!=null)return function(l){return l===e};function i(o){return n.add(o),!1}function a(o){return t.add(o),!0}return function(l){if(t.has(l))return!0;if(n.has(l))return!1;var c=l.match(l7);if(!c)return i(l);var u={major:+c[1],minor:+c[2],patch:+c[3],prerelease:c[4]};return u.prerelease!=null||s.major!==u.major?i(l):s.major===0?s.minor===u.minor&&s.patch<=u.patch?a(l):i(l):s.minor<=u.minor?a(l):i(l)}}var b3e=y3e(lm),v3e=lm.split(".")[0],Fw=Symbol.for("opentelemetry.js.api."+v3e),Lw=g3e;function jD(e,t,n,r){var s;r===void 0&&(r=!1);var i=Lw[Fw]=(s=Lw[Fw])!==null&&s!==void 0?s:{version:lm};if(!r&&i[e]){var a=new Error("@opentelemetry/api: Attempted duplicate registration of API: "+e);return n.error(a.stack||a.message),!1}if(i.version!==lm){var a=new Error("@opentelemetry/api: Registration of version v"+i.version+" for "+e+" does not match previously registered API v"+lm);return n.error(a.stack||a.message),!1}return i[e]=t,n.debug("@opentelemetry/api: Registered a global for "+e+" v"+lm+"."),!0}function Bw(e){var t,n,r=(t=Lw[Fw])===null||t===void 0?void 0:t.version;if(!(!r||!b3e(r)))return(n=Lw[Fw])===null||n===void 0?void 0:n[e]}function PD(e,t){t.debug("@opentelemetry/api: Unregistering a global for "+e+" v"+lm+".");var n=Lw[Fw];n&&delete n[e]}var x3e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},w3e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},_3e=function(){function e(t){this._namespace=t.namespace||"DiagComponentLogger"}return e.prototype.debug=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Wv("debug",this._namespace,t)},e.prototype.error=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Wv("error",this._namespace,t)},e.prototype.info=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Wv("info",this._namespace,t)},e.prototype.warn=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Wv("warn",this._namespace,t)},e.prototype.verbose=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return Wv("verbose",this._namespace,t)},e}();function Wv(e,t,n){var r=Bw("diag");if(r)return n.unshift(t),r[e].apply(r,w3e([],x3e(n),!1))}var ol;(function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"})(ol||(ol={}));function S3e(e,t){e<ol.NONE?e=ol.NONE:e>ol.ALL&&(e=ol.ALL),t=t||{};function n(r,s){var i=t[r];return typeof i=="function"&&e>=s?i.bind(t):function(){}}return{error:n("error",ol.ERROR),warn:n("warn",ol.WARN),info:n("info",ol.INFO),debug:n("debug",ol.DEBUG),verbose:n("verbose",ol.VERBOSE)}}var C3e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},k3e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},E3e="diag",pk=function(){function e(){function t(s){return function(){for(var i=[],a=0;a<arguments.length;a++)i[a]=arguments[a];var o=Bw("diag");if(o)return o[s].apply(o,k3e([],C3e(i),!1))}}var n=this,r=function(s,i){var a,o,l;if(i===void 0&&(i={logLevel:ol.INFO}),s===n){var c=new Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return n.error((a=c.stack)!==null&&a!==void 0?a:c.message),!1}typeof i=="number"&&(i={logLevel:i});var u=Bw("diag"),d=S3e((o=i.logLevel)!==null&&o!==void 0?o:ol.INFO,s);if(u&&!i.suppressOverrideMessage){var h=(l=new Error().stack)!==null&&l!==void 0?l:"<failed to generate stacktrace>";u.warn("Current logger will be overwritten from "+h),d.warn("Current logger will overwrite one already registered from "+h)}return jD("diag",d,n,!0)};n.setLogger=r,n.disable=function(){PD(E3e,n)},n.createComponentLogger=function(s){return new _3e(s)},n.verbose=t("verbose"),n.debug=t("debug"),n.info=t("info"),n.warn=t("warn"),n.error=t("error")}return e.instance=function(){return this._instance||(this._instance=new e),this._instance},e}();function T3e(e){return Symbol.for(e)}var A3e=function(){function e(t){var n=this;n._currentContext=t?new Map(t):new Map,n.getValue=function(r){return n._currentContext.get(r)},n.setValue=function(r,s){var i=new e(n._currentContext);return i._currentContext.set(r,s),i},n.deleteValue=function(r){var s=new e(n._currentContext);return s._currentContext.delete(r),s}}return e}(),R3e=new A3e,N3e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},M3e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},I3e=function(){function e(){}return e.prototype.active=function(){return R3e},e.prototype.with=function(t,n,r){for(var s=[],i=3;i<arguments.length;i++)s[i-3]=arguments[i];return n.call.apply(n,M3e([r],N3e(s),!1))},e.prototype.bind=function(t,n){return n},e.prototype.enable=function(){return this},e.prototype.disable=function(){return this},e}(),j3e=function(e,t){var n=typeof Symbol=="function"&&e[Symbol.iterator];if(!n)return e;var r=n.call(e),s,i=[],a;try{for(;(t===void 0||t-- >0)&&!(s=r.next()).done;)i.push(s.value)}catch(o){a={error:o}}finally{try{s&&!s.done&&(n=r.return)&&n.call(r)}finally{if(a)throw a.error}}return i},P3e=function(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))},RI="context",O3e=new I3e,NX=function(){function e(){}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalContextManager=function(t){return jD(RI,t,pk.instance())},e.prototype.active=function(){return this._getContextManager().active()},e.prototype.with=function(t,n,r){for(var s,i=[],a=3;a<arguments.length;a++)i[a-3]=arguments[a];return(s=this._getContextManager()).with.apply(s,P3e([t,n,r],j3e(i),!1))},e.prototype.bind=function(t,n){return this._getContextManager().bind(t,n)},e.prototype._getContextManager=function(){return Bw(RI)||O3e},e.prototype.disable=function(){this._getContextManager().disable(),PD(RI,pk.instance())},e}(),Gj;(function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"})(Gj||(Gj={}));var MX="0000000000000000",IX="00000000000000000000000000000000",D3e={traceId:IX,spanId:MX,traceFlags:Gj.NONE},Mx=function(){function e(t){t===void 0&&(t=D3e),this._spanContext=t}return e.prototype.spanContext=function(){return this._spanContext},e.prototype.setAttribute=function(t,n){return this},e.prototype.setAttributes=function(t){return this},e.prototype.addEvent=function(t,n){return this},e.prototype.addLink=function(t){return this},e.prototype.addLinks=function(t){return this},e.prototype.setStatus=function(t){return this},e.prototype.updateName=function(t){return this},e.prototype.end=function(t){},e.prototype.isRecording=function(){return!1},e.prototype.recordException=function(t,n){},e}(),OD=T3e("OpenTelemetry Context Key SPAN");function DD(e){return e.getValue(OD)||void 0}function F3e(){return DD(NX.getInstance().active())}function FD(e,t){return e.setValue(OD,t)}function L3e(e){return e.deleteValue(OD)}function B3e(e,t){return FD(e,new Mx(t))}function jX(e){var t;return(t=DD(e))===null||t===void 0?void 0:t.spanContext()}var $3e=/^([0-9a-f]{32})$/i,z3e=/^[0-9a-f]{16}$/i;function U3e(e){return $3e.test(e)&&e!==IX}function q3e(e){return z3e.test(e)&&e!==MX}function PX(e){return U3e(e.traceId)&&q3e(e.spanId)}function V3e(e){return new Mx(e)}var NI=NX.getInstance(),OX=function(){function e(){}return e.prototype.startSpan=function(t,n,r){r===void 0&&(r=NI.active());var s=!!(n!=null&&n.root);if(s)return new Mx;var i=r&&jX(r);return W3e(i)&&PX(i)?new Mx(i):new Mx},e.prototype.startActiveSpan=function(t,n,r,s){var i,a,o;if(!(arguments.length<2)){arguments.length===2?o=n:arguments.length===3?(i=n,o=r):(i=n,a=r,o=s);var l=a??NI.active(),c=this.startSpan(t,i,l),u=FD(l,c);return NI.with(u,o,void 0,c)}},e}();function W3e(e){return typeof e=="object"&&typeof e.spanId=="string"&&typeof e.traceId=="string"&&typeof e.traceFlags=="number"}var H3e=new OX,G3e=function(){function e(t,n,r,s){this._provider=t,this.name=n,this.version=r,this.options=s}return e.prototype.startSpan=function(t,n,r){return this._getTracer().startSpan(t,n,r)},e.prototype.startActiveSpan=function(t,n,r,s){var i=this._getTracer();return Reflect.apply(i.startActiveSpan,i,arguments)},e.prototype._getTracer=function(){if(this._delegate)return this._delegate;var t=this._provider.getDelegateTracer(this.name,this.version,this.options);return t?(this._delegate=t,this._delegate):H3e},e}(),K3e=function(){function e(){}return e.prototype.getTracer=function(t,n,r){return new OX},e}(),Y3e=new K3e,c7=function(){function e(){}return e.prototype.getTracer=function(t,n,r){var s;return(s=this.getDelegateTracer(t,n,r))!==null&&s!==void 0?s:new G3e(this,t,n,r)},e.prototype.getDelegate=function(){var t;return(t=this._delegate)!==null&&t!==void 0?t:Y3e},e.prototype.setDelegate=function(t){this._delegate=t},e.prototype.getDelegateTracer=function(t,n,r){var s;return(s=this._delegate)===null||s===void 0?void 0:s.getTracer(t,n,r)},e}(),mk;(function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"})(mk||(mk={}));var MI="trace",Z3e=function(){function e(){this._proxyTracerProvider=new c7,this.wrapSpanContext=V3e,this.isSpanContextValid=PX,this.deleteSpan=L3e,this.getSpan=DD,this.getActiveSpan=F3e,this.getSpanContext=jX,this.setSpan=FD,this.setSpanContext=B3e}return e.getInstance=function(){return this._instance||(this._instance=new e),this._instance},e.prototype.setGlobalTracerProvider=function(t){var n=jD(MI,this._proxyTracerProvider,pk.instance());return n&&this._proxyTracerProvider.setDelegate(t),n},e.prototype.getTracerProvider=function(){return Bw(MI)||this._proxyTracerProvider},e.prototype.getTracer=function(t,n){return this.getTracerProvider().getTracer(t,n)},e.prototype.disable=function(){PD(MI,pk.instance()),this._proxyTracerProvider=new c7},e}(),X3e=Z3e.getInstance(),J3e=Object.defineProperty,LD=(e,t)=>{for(var n in t)J3e(e,n,{get:t[n],enumerable:!0})};function gk(e,{contentType:t,dataStreamVersion:n}){const r=new Headers(e??{});return r.has("Content-Type")||r.set("Content-Type",t),n!==void 0&&r.set("X-Vercel-AI-Data-Stream",n),r}function u7(e,{contentType:t,dataStreamVersion:n}){const r={};if(e!=null)for(const[s,i]of Object.entries(e))r[s]=i;return r["Content-Type"]==null&&(r["Content-Type"]=t),n!==void 0&&(r["X-Vercel-AI-Data-Stream"]=n),r}function d7({response:e,status:t,statusText:n,headers:r,stream:s}){e.writeHead(t??200,n,r);const i=s.getReader();(async()=>{try{for(;;){const{done:o,value:l}=await i.read();if(o)break;e.write(l)}}catch(o){throw o}finally{e.end()}})()}var DX="AI_InvalidArgumentError",FX=`vercel.ai.error.${DX}`,Q3e=Symbol.for(FX),LX,vc=class extends rr{constructor({parameter:e,value:t,message:n}){super({name:DX,message:`Invalid argument for parameter ${e}: ${n}`}),this[LX]=!0,this.parameter=e,this.value=t}static isInstance(e){return rr.hasMarker(e,FX)}};LX=Q3e;var BX="AI_RetryError",$X=`vercel.ai.error.${BX}`,eje=Symbol.for($X),zX,f7=class extends rr{constructor({message:e,reason:t,errors:n}){super({name:BX,message:e}),this[zX]=!0,this.reason=t,this.errors=n,this.lastError=n[n.length-1]}static isInstance(e){return rr.hasMarker(e,$X)}};zX=eje;var tje=({maxRetries:e=2,initialDelayInMs:t=2e3,backoffFactor:n=2}={})=>async r=>UX(r,{maxRetries:e,delayInMs:t,backoffFactor:n});async function UX(e,{maxRetries:t,delayInMs:n,backoffFactor:r},s=[]){try{return await e()}catch(i){if(OC(i)||t===0)throw i;const a=Oye(i),o=[...s,i],l=o.length;if(l>t)throw new f7({message:`Failed after ${l} attempts. Last error: ${a}`,reason:"maxRetriesExceeded",errors:o});if(i instanceof Error&&Vl.isInstance(i)&&i.isRetryable===!0&&l<=t)return await jye(n),UX(e,{maxRetries:t,delayInMs:r*n,backoffFactor:r},o);throw l===1?i:new f7({message:`Failed after ${l} attempts with non-retryable error: '${a}'`,reason:"errorNotRetryable",errors:o})}}function nje({maxRetries:e}){if(e!=null){if(!Number.isInteger(e))throw new vc({parameter:"maxRetries",value:e,message:"maxRetries must be an integer"});if(e<0)throw new vc({parameter:"maxRetries",value:e,message:"maxRetries must be >= 0"})}const t=e??2;return{maxRetries:t,retry:tje({maxRetries:t})}}function Kj({operationId:e,telemetry:t}){return{"operation.name":`${e}${(t==null?void 0:t.functionId)!=null?` ${t.functionId}`:""}`,"resource.name":t==null?void 0:t.functionId,"ai.operationId":e,"ai.telemetry.functionId":t==null?void 0:t.functionId}}function rje({model:e,settings:t,telemetry:n,headers:r}){var s;return{"ai.model.provider":e.provider,"ai.model.id":e.modelId,...Object.entries(t).reduce((i,[a,o])=>(i[`ai.settings.${a}`]=o,i),{}),...Object.entries((s=n==null?void 0:n.metadata)!=null?s:{}).reduce((i,[a,o])=>(i[`ai.telemetry.metadata.${a}`]=o,i),{}),...Object.entries(r??{}).reduce((i,[a,o])=>(o!==void 0&&(i[`ai.request.headers.${a}`]=o),i),{})}}var sje={startSpan(){return QS},startActiveSpan(e,t,n,r){if(typeof t=="function")return t(QS);if(typeof n=="function")return n(QS);if(typeof r=="function")return r(QS)}},QS={spanContext(){return ije},setAttribute(){return this},setAttributes(){return this},addEvent(){return this},addLink(){return this},addLinks(){return this},setStatus(){return this},updateName(){return this},end(){return this},isRecording(){return!1},recordException(){return this}},ije={traceId:"",spanId:"",traceFlags:0};function aje({isEnabled:e=!1,tracer:t}={}){return e?t||X3e.getTracer("ai"):sje}function Yj({name:e,tracer:t,attributes:n,fn:r,endWhenDone:s=!0}){return t.startActiveSpan(e,{attributes:n},async i=>{try{const a=await r(i);return s&&i.end(),a}catch(a){try{a instanceof Error?(i.recordException({name:a.name,message:a.message,stack:a.stack}),i.setStatus({code:mk.ERROR,message:a.message})):i.setStatus({code:mk.ERROR})}finally{i.end()}throw a}})}function k0({telemetry:e,attributes:t}){return(e==null?void 0:e.isEnabled)!==!0?{}:Object.entries(t).reduce((n,[r,s])=>{if(s===void 0)return n;if(typeof s=="object"&&"input"in s&&typeof s.input=="function"){if((e==null?void 0:e.recordInputs)===!1)return n;const i=s.input();return i===void 0?n:{...n,[r]:i}}if(typeof s=="object"&&"output"in s&&typeof s.output=="function"){if((e==null?void 0:e.recordOutputs)===!1)return n;const i=s.output();return i===void 0?n:{...n,[r]:i}}return{...n,[r]:s}},{})}var oje=class{constructor({data:e,mimeType:t}){const n=e instanceof Uint8Array;this.base64Data=n?void 0:e,this.uint8ArrayData=n?e:void 0,this.mimeType=t}get base64(){return this.base64Data==null&&(this.base64Data=Pu(this.uint8ArrayData)),this.base64Data}get uint8Array(){return this.uint8ArrayData==null&&(this.uint8ArrayData=IE(this.base64Data)),this.uint8ArrayData}},lje=class extends oje{constructor(e){super(e),this.type="file"}},cje=[{mimeType:"image/gif",bytesPrefix:[71,73,70],base64Prefix:"R0lG"},{mimeType:"image/png",bytesPrefix:[137,80,78,71],base64Prefix:"iVBORw"},{mimeType:"image/jpeg",bytesPrefix:[255,216],base64Prefix:"/9j/"},{mimeType:"image/webp",bytesPrefix:[82,73,70,70],base64Prefix:"UklGRg"},{mimeType:"image/bmp",bytesPrefix:[66,77],base64Prefix:"Qk"},{mimeType:"image/tiff",bytesPrefix:[73,73,42,0],base64Prefix:"SUkqAA"},{mimeType:"image/tiff",bytesPrefix:[77,77,0,42],base64Prefix:"TU0AKg"},{mimeType:"image/avif",bytesPrefix:[0,0,0,32,102,116,121,112,97,118,105,102],base64Prefix:"AAAAIGZ0eXBhdmlm"},{mimeType:"image/heic",bytesPrefix:[0,0,0,32,102,116,121,112,104,101,105,99],base64Prefix:"AAAAIGZ0eXBoZWlj"}],uje=e=>{const t=typeof e=="string"?IE(e):e,n=(t[6]&127)<<21|(t[7]&127)<<14|(t[8]&127)<<7|t[9]&127;return t.slice(n+10)};function dje(e){return typeof e=="string"&&e.startsWith("SUQz")||typeof e!="string"&&e.length>10&&e[0]===73&&e[1]===68&&e[2]===51?uje(e):e}function fje({data:e,signatures:t}){const n=dje(e);for(const r of t)if(typeof n=="string"?n.startsWith(r.base64Prefix):n.length>=r.bytesPrefix.length&&r.bytesPrefix.every((s,i)=>n[i]===s))return r.mimeType}var qX="AI_NoObjectGeneratedError",VX=`vercel.ai.error.${qX}`,hje=Symbol.for(VX),WX,h7=class extends rr{constructor({message:e="No object generated.",cause:t,text:n,response:r,usage:s,finishReason:i}){super({name:qX,message:e,cause:t}),this[WX]=!0,this.text=n,this.response=r,this.usage=s,this.finishReason=i}static isInstance(e){return rr.hasMarker(e,VX)}};WX=hje;var HX="AI_DownloadError",GX=`vercel.ai.error.${HX}`,pje=Symbol.for(GX),KX,II=class extends rr{constructor({url:e,statusCode:t,statusText:n,cause:r,message:s=r==null?`Failed to download ${e}: ${t} ${n}`:`Failed to download ${e}: ${r}`}){super({name:HX,message:s,cause:r}),this[KX]=!0,this.url=e,this.statusCode=t,this.statusText=n}static isInstance(e){return rr.hasMarker(e,GX)}};KX=pje;async function mje({url:e}){var t;const n=e.toString();try{const r=await fetch(n);if(!r.ok)throw new II({url:n,statusCode:r.status,statusText:r.statusText});return{data:new Uint8Array(await r.arrayBuffer()),mimeType:(t=r.headers.get("content-type"))!=null?t:void 0}}catch(r){throw II.isInstance(r)?r:new II({url:n,cause:r})}}var YX="AI_InvalidDataContentError",ZX=`vercel.ai.error.${YX}`,gje=Symbol.for(ZX),XX,p7=class extends rr{constructor({content:e,cause:t,message:n=`Invalid data content. Expected a base64 string, Uint8Array, ArrayBuffer, or Buffer, but got ${typeof e}.`}){super({name:YX,message:n,cause:t}),this[XX]=!0,this.content=e}static isInstance(e){return rr.hasMarker(e,ZX)}};XX=gje;var JX=ms([$e(),I2(Uint8Array),I2(ArrayBuffer),EG(e=>{var t,n;return(n=(t=globalThis.Buffer)==null?void 0:t.isBuffer(e))!=null?n:!1},{message:"Must be a Buffer"})]);function BD(e){return typeof e=="string"?e:e instanceof ArrayBuffer?Pu(new Uint8Array(e)):Pu(e)}function yk(e){if(e instanceof Uint8Array)return e;if(typeof e=="string")try{return IE(e)}catch(t){throw new p7({message:"Invalid data content. Content string is not a base64-encoded media.",content:e,cause:t})}if(e instanceof ArrayBuffer)return new Uint8Array(e);throw new p7({content:e})}function yje(e){try{return new TextDecoder().decode(e)}catch{throw new Error("Error decoding Uint8Array to text")}}var QX="AI_InvalidMessageRoleError",eJ=`vercel.ai.error.${QX}`,bje=Symbol.for(eJ),tJ,vje=class extends rr{constructor({role:e,message:t=`Invalid message role: '${e}'. Must be one of: "system", "user", "assistant", "tool".`}){super({name:QX,message:t}),this[tJ]=!0,this.role=e}static isInstance(e){return rr.hasMarker(e,eJ)}};tJ=bje;function xje(e){try{const[t,n]=e.split(",");return{mimeType:t.split(";")[0].split(":")[1],base64Content:n}}catch{return{mimeType:void 0,base64Content:void 0}}}async function wje({prompt:e,modelSupportsImageUrls:t=!0,modelSupportsUrl:n=()=>!1,downloadImplementation:r=mje}){const s=await Sje(e.messages,r,t,n);return[...e.system!=null?[{role:"system",content:e.system}]:[],...e.messages.map(i=>_je(i,s))]}function _je(e,t){var n,r,s,i,a,o;const l=e.role;switch(l){case"system":return{role:"system",content:e.content,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};case"user":return typeof e.content=="string"?{role:"user",content:[{type:"text",text:e.content}],providerMetadata:(r=e.providerOptions)!=null?r:e.experimental_providerMetadata}:{role:"user",content:e.content.map(c=>Cje(c,t)).filter(c=>c.type!=="text"||c.text!==""),providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"assistant":return typeof e.content=="string"?{role:"assistant",content:[{type:"text",text:e.content}],providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}:{role:"assistant",content:e.content.filter(c=>c.type!=="text"||c.text!=="").map(c=>{var u;const d=(u=c.providerOptions)!=null?u:c.experimental_providerMetadata;switch(c.type){case"file":return{type:"file",data:c.data instanceof URL?c.data:BD(c.data),filename:c.filename,mimeType:c.mimeType,providerMetadata:d};case"reasoning":return{type:"reasoning",text:c.text,signature:c.signature,providerMetadata:d};case"redacted-reasoning":return{type:"redacted-reasoning",data:c.data,providerMetadata:d};case"text":return{type:"text",text:c.text,providerMetadata:d};case"tool-call":return{type:"tool-call",toolCallId:c.toolCallId,toolName:c.toolName,args:c.args,providerMetadata:d}}}),providerMetadata:(a=e.providerOptions)!=null?a:e.experimental_providerMetadata};case"tool":return{role:"tool",content:e.content.map(c=>{var u;return{type:"tool-result",toolCallId:c.toolCallId,toolName:c.toolName,result:c.result,content:c.experimental_content,isError:c.isError,providerMetadata:(u=c.providerOptions)!=null?u:c.experimental_providerMetadata}}),providerMetadata:(o=e.providerOptions)!=null?o:e.experimental_providerMetadata};default:{const c=l;throw new vje({role:c})}}}async function Sje(e,t,n,r){const s=e.filter(a=>a.role==="user").map(a=>a.content).filter(a=>Array.isArray(a)).flat().filter(a=>a.type==="image"||a.type==="file").filter(a=>!(a.type==="image"&&n===!0)).map(a=>a.type==="image"?a.image:a.data).map(a=>typeof a=="string"&&(a.startsWith("http:")||a.startsWith("https:"))?new URL(a):a).filter(a=>a instanceof URL).filter(a=>!r(a)),i=await Promise.all(s.map(async a=>({url:a,data:await t({url:a})})));return Object.fromEntries(i.map(({url:a,data:o})=>[a.toString(),o]))}function Cje(e,t){var n,r,s,i;if(e.type==="text")return{type:"text",text:e.text,providerMetadata:(n=e.providerOptions)!=null?n:e.experimental_providerMetadata};let a=e.mimeType,o,l,c;const u=e.type;switch(u){case"image":o=e.image;break;case"file":o=e.data;break;default:throw new Error(`Unsupported part type: ${u}`)}try{l=typeof o=="string"?new URL(o):o}catch{l=o}if(l instanceof URL)if(l.protocol==="data:"){const{mimeType:d,base64Content:h}=xje(l.toString());if(d==null||h==null)throw new Error(`Invalid data URL format in part ${u}`);a=d,c=yk(h)}else{const d=t[l.toString()];d?(c=d.data,a??(a=d.mimeType)):c=l}else c=yk(l);switch(u){case"image":return c instanceof Uint8Array&&(a=(r=fje({data:c,signatures:cje}))!=null?r:a),{type:"image",image:c,mimeType:a,providerMetadata:(s=e.providerOptions)!=null?s:e.experimental_providerMetadata};case"file":{if(a==null)throw new Error("Mime type is missing for file part");return{type:"file",data:c instanceof Uint8Array?BD(c):c,filename:e.filename,mimeType:a,providerMetadata:(i=e.providerOptions)!=null?i:e.experimental_providerMetadata}}}}function kje({maxTokens:e,temperature:t,topP:n,topK:r,presencePenalty:s,frequencyPenalty:i,stopSequences:a,seed:o}){if(e!=null){if(!Number.isInteger(e))throw new vc({parameter:"maxTokens",value:e,message:"maxTokens must be an integer"});if(e<1)throw new vc({parameter:"maxTokens",value:e,message:"maxTokens must be >= 1"})}if(t!=null&&typeof t!="number")throw new vc({parameter:"temperature",value:t,message:"temperature must be a number"});if(n!=null&&typeof n!="number")throw new vc({parameter:"topP",value:n,message:"topP must be a number"});if(r!=null&&typeof r!="number")throw new vc({parameter:"topK",value:r,message:"topK must be a number"});if(s!=null&&typeof s!="number")throw new vc({parameter:"presencePenalty",value:s,message:"presencePenalty must be a number"});if(i!=null&&typeof i!="number")throw new vc({parameter:"frequencyPenalty",value:i,message:"frequencyPenalty must be a number"});if(o!=null&&!Number.isInteger(o))throw new vc({parameter:"seed",value:o,message:"seed must be an integer"});return{maxTokens:e,temperature:t??0,topP:n,topK:r,presencePenalty:s,frequencyPenalty:i,stopSequences:a!=null&&a.length>0?a:void 0,seed:o}}function m7(e){var t,n,r;const s=[];for(const i of e){let a;try{a=new URL(i.url)}catch{throw new Error(`Invalid URL: ${i.url}`)}switch(a.protocol){case"http:":case"https:":{if((t=i.contentType)!=null&&t.startsWith("image/"))s.push({type:"image",image:a});else{if(!i.contentType)throw new Error("If the attachment is not an image, it must specify a content type");s.push({type:"file",data:a,mimeType:i.contentType})}break}case"data:":{let o,l,c;try{[o,l]=i.url.split(","),c=o.split(";")[0].split(":")[1]}catch{throw new Error(`Error processing data URL: ${i.url}`)}if(c==null||l==null)throw new Error(`Invalid data URL format: ${i.url}`);if((n=i.contentType)!=null&&n.startsWith("image/"))s.push({type:"image",image:yk(l)});else if((r=i.contentType)!=null&&r.startsWith("text/"))s.push({type:"text",text:yje(yk(l))});else{if(!i.contentType)throw new Error("If the attachment is not an image or text, it must specify a content type");s.push({type:"file",data:l,mimeType:i.contentType})}break}default:throw new Error(`Unsupported URL protocol: ${a.protocol}`)}}return s}var nJ="AI_MessageConversionError",rJ=`vercel.ai.error.${nJ}`,Eje=Symbol.for(rJ),sJ,jI=class extends rr{constructor({originalMessage:e,message:t}){super({name:nJ,message:t}),this[sJ]=!0,this.originalMessage=e}static isInstance(e){return rr.hasMarker(e,rJ)}};sJ=Eje;function Tje(e,t){var n,r;const s=(n=t==null?void 0:t.tools)!=null?n:{},i=[];for(let a=0;a<e.length;a++){const o=e[a],l=a===e.length-1,{role:c,content:u,experimental_attachments:d}=o;switch(c){case"system":{i.push({role:"system",content:u});break}case"user":{if(o.parts==null)i.push({role:"user",content:d?[{type:"text",text:u},...m7(d)]:u});else{const h=o.parts.filter(m=>m.type==="text").map(m=>({type:"text",text:m.text}));i.push({role:"user",content:d?[...h,...m7(d)]:h})}break}case"assistant":{if(o.parts!=null){let y=function(){const w=[];for(const k of x)switch(k.type){case"file":case"text":{w.push(k);break}case"reasoning":{for(const C of k.details)switch(C.type){case"text":w.push({type:"reasoning",text:C.text,signature:C.signature});break;case"redacted":w.push({type:"redacted-reasoning",data:C.data});break}break}case"tool-invocation":w.push({type:"tool-call",toolCallId:k.toolInvocation.toolCallId,toolName:k.toolInvocation.toolName,args:k.toolInvocation.args});break;default:{const C=k;throw new Error(`Unsupported part: ${C}`)}}i.push({role:"assistant",content:w});const S=x.filter(k=>k.type==="tool-invocation").map(k=>k.toolInvocation);S.length>0&&i.push({role:"tool",content:S.map(k=>{if(!("result"in k))throw new jI({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(k)});const{toolCallId:C,toolName:T,result:A}=k,N=s[T];return(N==null?void 0:N.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:C,toolName:T,result:N.experimental_toToolResultContent(A),experimental_content:N.experimental_toToolResultContent(A)}:{type:"tool-result",toolCallId:C,toolName:T,result:A}})}),x=[],v=!1,b++},b=0,v=!1,x=[];for(const w of o.parts)switch(w.type){case"text":{v&&y(),x.push(w);break}case"file":case"reasoning":{x.push(w);break}case"tool-invocation":{((r=w.toolInvocation.step)!=null?r:0)!==b&&y(),x.push(w),v=!0;break}}y();break}const h=o.toolInvocations;if(h==null||h.length===0){i.push({role:"assistant",content:u});break}const m=h.reduce((y,b)=>{var v;return Math.max(y,(v=b.step)!=null?v:0)},0);for(let y=0;y<=m;y++){const b=h.filter(v=>{var x;return((x=v.step)!=null?x:0)===y});b.length!==0&&(i.push({role:"assistant",content:[...l&&u&&y===0?[{type:"text",text:u}]:[],...b.map(({toolCallId:v,toolName:x,args:w})=>({type:"tool-call",toolCallId:v,toolName:x,args:w}))]}),i.push({role:"tool",content:b.map(v=>{if(!("result"in v))throw new jI({originalMessage:o,message:"ToolInvocation must have a result: "+JSON.stringify(v)});const{toolCallId:x,toolName:w,result:S}=v,k=s[w];return(k==null?void 0:k.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:x,toolName:w,result:k.experimental_toToolResultContent(S),experimental_content:k.experimental_toToolResultContent(S)}:{type:"tool-result",toolCallId:x,toolName:w,result:S}})}))}u&&!l&&i.push({role:"assistant",content:u});break}case"data":break;default:{const h=c;throw new jI({originalMessage:o,message:`Unsupported role: ${h}`})}}}return i}var Zj=wbe(()=>ms([xbe(),$e(),At(),Zn(),Ih($e(),Zj),ln(Zj)])),ui=Ih($e(),Ih($e(),Zj)),Aje=ln(ms([Ke({type:Mn("text"),text:$e()}),Ke({type:Mn("image"),data:$e(),mimeType:$e().optional()})])),iJ=Ke({type:Mn("text"),text:$e(),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),Rje=Ke({type:Mn("image"),image:ms([JX,I2(URL)]),mimeType:$e().optional(),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),aJ=Ke({type:Mn("file"),data:ms([JX,I2(URL)]),filename:$e().optional(),mimeType:$e(),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),Nje=Ke({type:Mn("reasoning"),text:$e(),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),Mje=Ke({type:Mn("redacted-reasoning"),data:$e(),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),Ije=Ke({type:Mn("tool-call"),toolCallId:$e(),toolName:$e(),args:Yy(),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),jje=Ke({type:Mn("tool-result"),toolCallId:$e(),toolName:$e(),result:Yy(),content:Aje.optional(),isError:Zn().optional(),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),Pje=Ke({role:Mn("system"),content:$e(),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),Oje=Ke({role:Mn("user"),content:ms([$e(),ln(ms([iJ,Rje,aJ]))]),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),Dje=Ke({role:Mn("assistant"),content:ms([$e(),ln(ms([iJ,aJ,Nje,Mje,Ije]))]),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),Fje=Ke({role:Mn("tool"),content:ln(jje),providerOptions:ui.optional(),experimental_providerMetadata:ui.optional()}),Lje=ms([Pje,Oje,Dje,Fje]);function Bje({prompt:e,tools:t}){if(e.prompt==null&&e.messages==null)throw new xc({prompt:e,message:"prompt or messages must be defined"});if(e.prompt!=null&&e.messages!=null)throw new xc({prompt:e,message:"prompt and messages cannot be defined at the same time"});if(e.system!=null&&typeof e.system!="string")throw new xc({prompt:e,message:"system must be a string"});if(e.prompt!=null){if(typeof e.prompt!="string")throw new xc({prompt:e,message:"prompt must be a string"});return{type:"prompt",system:e.system,messages:[{role:"user",content:e.prompt}]}}if(e.messages!=null){const r=$je(e.messages)==="ui-messages"?Tje(e.messages,{tools:t}):e.messages;if(r.length===0)throw new xc({prompt:e,message:"messages must not be empty"});const s=Ky({value:r,schema:ln(Lje)});if(!s.success)throw new xc({prompt:e,message:["message must be a CoreMessage or a UI message",`Validation error: ${s.error.message}`].join(`
`),cause:s.error});return{type:"messages",messages:r,system:e.system}}throw new Error("unreachable")}function $je(e){if(!Array.isArray(e))throw new xc({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received non-array value: ${JSON.stringify(e)}`].join(`
`),cause:e});if(e.length===0)return"messages";const t=e.map(zje);if(t.some(r=>r==="has-ui-specific-parts"))return"ui-messages";const n=t.findIndex(r=>r!=="has-core-specific-parts"&&r!=="message");if(n===-1)return"messages";throw new xc({prompt:e,message:["messages must be an array of CoreMessage or UIMessage",`Received message of type: "${t[n]}" at index ${n}`,`messages[${n}]: ${JSON.stringify(e[n])}`].join(`
`),cause:e})}function zje(e){return typeof e=="object"&&e!==null&&(e.role==="function"||e.role==="data"||"toolInvocations"in e||"parts"in e||"experimental_attachments"in e)?"has-ui-specific-parts":typeof e=="object"&&e!==null&&"content"in e&&(Array.isArray(e.content)||"experimental_providerMetadata"in e||"providerOptions"in e)?"has-core-specific-parts":typeof e=="object"&&e!==null&&"role"in e&&"content"in e&&typeof e.content=="string"&&["system","user","assistant","tool"].includes(e.role)?"message":"other"}function Uje({promptTokens:e,completionTokens:t}){return{promptTokens:e,completionTokens:t,totalTokens:e+t}}function qje(e,t){return{promptTokens:e.promptTokens+t.promptTokens,completionTokens:e.completionTokens+t.completionTokens,totalTokens:e.totalTokens+t.totalTokens}}var Vje="JSON schema:",Wje="You MUST answer with a JSON object that matches the JSON schema above.",Hje="You MUST answer with JSON.";function Gje({prompt:e,schema:t,schemaPrefix:n=t!=null?Vje:void 0,schemaSuffix:r=t!=null?Wje:Hje}){return[e!=null&&e.length>0?e:void 0,e!=null&&e.length>0?"":void 0,n,t!=null?JSON.stringify(t):void 0,r].filter(s=>s!=null).join(`
`)}function PI(e){const t=e.pipeThrough(new TransformStream);return t[Symbol.asyncIterator]=()=>{const n=t.getReader();return{async next(){const{done:r,value:s}=await n.read();return r?{done:!0,value:void 0}:{done:!1,value:s}}}},t}function Kje(e){const t=e.map(n=>({...n,content:typeof n.content=="string"?n.content:n.content.map(Yje)}));return JSON.stringify(t)}function Yje(e){return e.type==="image"?{...e,image:e.image instanceof Uint8Array?BD(e.image):e.image}:e}Wm({prefix:"aiobj",size:24});var So=class{constructor(){this.status={type:"pending"},this._resolve=void 0,this._reject=void 0}get value(){return this.promise?this.promise:(this.promise=new Promise((e,t)=>{this.status.type==="resolved"?e(this.status.value):this.status.type==="rejected"&&t(this.status.error),this._resolve=e,this._reject=t}),this.promise)}resolve(e){var t;this.status={type:"resolved",value:e},this.promise&&((t=this._resolve)==null||t.call(this,e))}reject(e){var t;this.status={type:"rejected",error:e},this.promise&&((t=this._reject)==null||t.call(this,e))}};function g7(){let e,t;return{promise:new Promise((r,s)=>{e=r,t=s}),resolve:e,reject:t}}function Zje(){let e=[],t=null,n=!1,r=g7();const s=async()=>{if(n&&e.length===0){t==null||t.close();return}if(e.length===0)return r=g7(),await r.promise,s();try{const{value:i,done:a}=await e[0].read();a?(e.shift(),e.length>0?await s():n&&(t==null||t.close())):t==null||t.enqueue(i)}catch(i){t==null||t.error(i),e.shift(),n&&e.length===0&&(t==null||t.close())}};return{stream:new ReadableStream({start(i){t=i},pull:s,async cancel(){for(const i of e)await i.cancel();e=[],n=!0}}),addStream:i=>{if(n)throw new Error("Cannot add inner stream: outer stream is closed");e.push(i.getReader()),r.resolve()},close:()=>{n=!0,r.resolve(),e.length===0&&(t==null||t.close())},terminate:()=>{n=!0,r.resolve(),e.forEach(i=>i.cancel()),e=[],t==null||t.close()}}}function Xje(){var e,t;return(t=(e=globalThis==null?void 0:globalThis.performance)==null?void 0:e.now())!=null?t:Date.now()}Wm({prefix:"aiobj",size:24});var oJ="AI_NoOutputSpecifiedError",lJ=`vercel.ai.error.${oJ}`,Jje=Symbol.for(lJ),cJ,Qje=class extends rr{constructor({message:e="No output specified."}={}){super({name:oJ,message:e}),this[cJ]=!0}static isInstance(e){return rr.hasMarker(e,lJ)}};cJ=Jje;var uJ="AI_ToolExecutionError",dJ=`vercel.ai.error.${uJ}`,e4e=Symbol.for(dJ),fJ,t4e=class extends rr{constructor({toolArgs:e,toolName:t,toolCallId:n,cause:r,message:s=`Error executing tool ${t}: ${v1(r)}`}){super({name:uJ,message:s,cause:r}),this[fJ]=!0,this.toolArgs=e,this.toolName=t,this.toolCallId=n}static isInstance(e){return rr.hasMarker(e,dJ)}};fJ=e4e;function n4e(e){return e!=null&&Object.keys(e).length>0}function r4e({tools:e,toolChoice:t,activeTools:n}){return n4e(e)?{tools:(n!=null?Object.entries(e).filter(([s])=>n.includes(s)):Object.entries(e)).map(([s,i])=>{const a=i.type;switch(a){case void 0:case"function":return{type:"function",name:s,description:i.description,parameters:ST(i.parameters).jsonSchema};case"provider-defined":return{type:"provider-defined",name:s,id:i.id,args:i.args};default:{const o=a;throw new Error(`Unsupported tool type: ${o}`)}}}),toolChoice:t==null?{type:"auto"}:typeof t=="string"?{type:t}:{type:"tool",toolName:t.toolName}}:{tools:void 0,toolChoice:void 0}}var s4e=/^([\s\S]*?)(\s+)(\S*)$/;function i4e(e){const t=e.match(s4e);return t?{prefix:t[1],whitespace:t[2],suffix:t[3]}:void 0}var hJ="AI_InvalidToolArgumentsError",pJ=`vercel.ai.error.${hJ}`,a4e=Symbol.for(pJ),mJ,gJ=class extends rr{constructor({toolArgs:e,toolName:t,cause:n,message:r=`Invalid arguments for tool ${t}: ${v1(n)}`}){super({name:hJ,message:r,cause:n}),this[mJ]=!0,this.toolArgs=e,this.toolName=t}static isInstance(e){return rr.hasMarker(e,pJ)}};mJ=a4e;var yJ="AI_NoSuchToolError",bJ=`vercel.ai.error.${yJ}`,o4e=Symbol.for(bJ),vJ,Xj=class extends rr{constructor({toolName:e,availableTools:t=void 0,message:n=`Model tried to call unavailable tool '${e}'. ${t===void 0?"No tools are available.":`Available tools: ${t.join(", ")}.`}`}){super({name:yJ,message:n}),this[vJ]=!0,this.toolName=e,this.availableTools=t}static isInstance(e){return rr.hasMarker(e,bJ)}};vJ=o4e;var xJ="AI_ToolCallRepairError",wJ=`vercel.ai.error.${xJ}`,l4e=Symbol.for(wJ),_J,c4e=class extends rr{constructor({cause:e,originalError:t,message:n=`Error repairing tool call: ${v1(e)}`}){super({name:xJ,message:n,cause:e}),this[_J]=!0,this.originalError=t}static isInstance(e){return rr.hasMarker(e,wJ)}};_J=l4e;async function u4e({toolCall:e,tools:t,repairToolCall:n,system:r,messages:s}){if(t==null)throw new Xj({toolName:e.toolName});try{return await y7({toolCall:e,tools:t})}catch(i){if(n==null||!(Xj.isInstance(i)||gJ.isInstance(i)))throw i;let a=null;try{a=await n({toolCall:e,tools:t,parameterSchema:({toolName:o})=>ST(t[o].parameters).jsonSchema,system:r,messages:s,error:i})}catch(o){throw new c4e({cause:o,originalError:i})}if(a==null)throw i;return await y7({toolCall:a,tools:t})}}async function y7({toolCall:e,tools:t}){const n=e.toolName,r=t[n];if(r==null)throw new Xj({toolName:e.toolName,availableTools:Object.keys(t)});const s=ST(r.parameters),i=e.args.trim()===""?Ky({value:{},schema:s}):km({text:e.args,schema:s});if(i.success===!1)throw new gJ({toolName:n,toolArgs:e.args,cause:i.error});return{type:"tool-call",toolCallId:e.toolCallId,toolName:n,args:i.value}}function d4e(e){const t=e.filter(n=>n.type==="text").map(n=>n.text).join("");return t.length>0?t:void 0}function b7({text:e="",files:t,reasoning:n,tools:r,toolCalls:s,toolResults:i,messageId:a,generateMessageId:o}){const l=[],c=[];return n.length>0&&c.push(...n.map(u=>u.type==="text"?{...u,type:"reasoning"}:{...u,type:"redacted-reasoning"})),t.length>0&&c.push(...t.map(u=>({type:"file",data:u.base64,mimeType:u.mimeType}))),e.length>0&&c.push({type:"text",text:e}),s.length>0&&c.push(...s),c.length>0&&l.push({role:"assistant",content:c,id:a}),i.length>0&&l.push({role:"tool",id:o(),content:i.map(u=>{const d=r[u.toolName];return(d==null?void 0:d.experimental_toToolResultContent)!=null?{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:d.experimental_toToolResultContent(u.result),experimental_content:d.experimental_toToolResultContent(u.result)}:{type:"tool-result",toolCallId:u.toolCallId,toolName:u.toolName,result:u.result}})}),l}Wm({prefix:"aitxt",size:24});Wm({prefix:"msg",size:24});var f4e={};LD(f4e,{object:()=>b4e,text:()=>y4e});var SJ="AI_InvalidStreamPartError",CJ=`vercel.ai.error.${SJ}`,h4e=Symbol.for(CJ),kJ,p4e=class extends rr{constructor({chunk:e,message:t}){super({name:SJ,message:t}),this[kJ]=!0,this.chunk=e}static isInstance(e){return rr.hasMarker(e,CJ)}};kJ=h4e;var m4e="AI_MCPClientError",EJ=`vercel.ai.error.${m4e}`,g4e=Symbol.for(EJ),TJ,sa=class extends rr{constructor({name:e="MCPClientError",message:t,cause:n}){super({name:e,message:t,cause:n}),this[TJ]=!0}static isInstance(e){return rr.hasMarker(e,EJ)}};TJ=g4e;var y4e=()=>({type:"text",responseFormat:()=>({type:"text"}),injectIntoSystemPrompt({system:e}){return e},parsePartial({text:e}){return{partial:e}},parseOutput({text:e}){return e}}),b4e=({schema:e})=>{const t=ST(e);return{type:"object",responseFormat:({model:n})=>({type:"json",schema:n.supportsStructuredOutputs?t.jsonSchema:void 0}),injectIntoSystemPrompt({system:n,model:r}){return r.supportsStructuredOutputs?n:Gje({prompt:n,schema:t.jsonSchema})},parsePartial({text:n}){const r=XIe(n);switch(r.state){case"failed-parse":case"undefined-input":return;case"repaired-parse":case"successful-parse":return{partial:r.value};default:{const s=r.state;throw new Error(`Unsupported parse state: ${s}`)}}},parseOutput({text:n},r){const s=km({text:n});if(!s.success)throw new h7({message:"No object generated: could not parse the response.",cause:s.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});const i=Ky({value:s.value,schema:t});if(!i.success)throw new h7({message:"No object generated: response did not match schema.",cause:i.error,text:n,response:r.response,usage:r.usage,finishReason:r.finishReason});return i.value}}};function v4e(e){return e===void 0?[]:Array.isArray(e)?e:[e]}async function x4e({stream:e,onError:t}){const n=e.getReader();try{for(;;){const{done:r}=await n.read();if(r)break}}catch(r){t==null||t(r)}finally{n.releaseLock()}}function $D(e,t){const n=e.getReader(),r=t.getReader();let s,i,a=!1,o=!1;async function l(u){try{s==null&&(s=n.read());const d=await s;s=void 0,d.done?u.close():u.enqueue(d.value)}catch(d){u.error(d)}}async function c(u){try{i==null&&(i=r.read());const d=await i;i=void 0,d.done?u.close():u.enqueue(d.value)}catch(d){u.error(d)}}return new ReadableStream({async pull(u){try{if(a){await c(u);return}if(o){await l(u);return}s==null&&(s=n.read()),i==null&&(i=r.read());const{result:d,reader:h}=await Promise.race([s.then(m=>({result:m,reader:n})),i.then(m=>({result:m,reader:r}))]);d.done||u.enqueue(d.value),h===n?(s=void 0,d.done&&(await c(u),a=!0)):(i=void 0,d.done&&(o=!0,await l(u)))}catch(d){u.error(d)}},cancel(){n.cancel(),r.cancel()}})}function w4e({tools:e,generatorStream:t,toolCallStreaming:n,tracer:r,telemetry:s,system:i,messages:a,abortSignal:o,repairToolCall:l}){let c=null;const u=new ReadableStream({start(x){c=x}}),d={},h=new Set;let m=!1,y;function b(){m&&h.size===0&&(y!=null&&c.enqueue(y),c.close())}const v=new TransformStream({async transform(x,w){const S=x.type;switch(S){case"text-delta":case"reasoning":case"reasoning-signature":case"redacted-reasoning":case"source":case"response-metadata":case"error":{w.enqueue(x);break}case"file":{w.enqueue(new lje({data:x.data,mimeType:x.mimeType}));break}case"tool-call-delta":{n&&(d[x.toolCallId]||(w.enqueue({type:"tool-call-streaming-start",toolCallId:x.toolCallId,toolName:x.toolName}),d[x.toolCallId]=!0),w.enqueue({type:"tool-call-delta",toolCallId:x.toolCallId,toolName:x.toolName,argsTextDelta:x.argsTextDelta}));break}case"tool-call":{try{const k=await u4e({toolCall:x,tools:e,repairToolCall:l,system:i,messages:a});w.enqueue(k);const C=e[k.toolName];if(C.execute!=null){const T=oa();h.add(T),Yj({name:"ai.toolCall",attributes:k0({telemetry:s,attributes:{...Kj({operationId:"ai.toolCall",telemetry:s}),"ai.toolCall.name":k.toolName,"ai.toolCall.id":k.toolCallId,"ai.toolCall.args":{output:()=>JSON.stringify(k.args)}}}),tracer:r,fn:async A=>C.execute(k.args,{toolCallId:k.toolCallId,messages:a,abortSignal:o}).then(N=>{c.enqueue({...k,type:"tool-result",result:N}),h.delete(T),b();try{A.setAttributes(k0({telemetry:s,attributes:{"ai.toolCall.result":{output:()=>JSON.stringify(N)}}}))}catch{}},N=>{c.enqueue({type:"error",error:new t4e({toolCallId:k.toolCallId,toolName:k.toolName,toolArgs:k.args,cause:N})}),h.delete(T),b()})})}}catch(k){c.enqueue({type:"error",error:k})}break}case"finish":{y={type:"finish",finishReason:x.finishReason,logprobs:x.logprobs,usage:Uje(x.usage),experimental_providerMetadata:x.providerMetadata};break}default:{const k=S;throw new Error(`Unhandled chunk type: ${k}`)}}},flush(){m=!0,b()}});return new ReadableStream({async start(x){return Promise.all([t.pipeThrough(v).pipeTo(new WritableStream({write(w){x.enqueue(w)},close(){}})),u.pipeTo(new WritableStream({write(w){x.enqueue(w)},close(){x.close()}}))])}})}var _4e=Wm({prefix:"aitxt",size:24}),S4e=Wm({prefix:"msg",size:24});function C4e({model:e,tools:t,toolChoice:n,system:r,prompt:s,messages:i,maxRetries:a,abortSignal:o,headers:l,maxSteps:c=1,experimental_generateMessageId:u=S4e,experimental_output:d,experimental_continueSteps:h=!1,experimental_telemetry:m,experimental_providerMetadata:y,providerOptions:b=y,experimental_toolCallStreaming:v=!1,toolCallStreaming:x=v,experimental_activeTools:w,experimental_repairToolCall:S,experimental_transform:k,onChunk:C,onError:T,onFinish:A,onStepFinish:N,_internal:{now:I=Xje,generateId:O=_4e,currentDate:B=()=>new Date}={},...D}){return new E4e({model:e,telemetry:m,headers:l,settings:D,maxRetries:a,abortSignal:o,system:r,prompt:s,messages:i,tools:t,toolChoice:n,toolCallStreaming:x,transforms:v4e(k),activeTools:w,repairToolCall:S,maxSteps:c,output:d,continueSteps:h,providerOptions:b,onChunk:C,onError:T,onFinish:A,onStepFinish:N,now:I,currentDate:B,generateId:O,generateMessageId:u})}function k4e(e){if(!e)return new TransformStream({transform(i,a){a.enqueue({part:i,partialOutput:void 0})}});let t="",n="",r="";function s({controller:i,partialOutput:a=void 0}){i.enqueue({part:{type:"text-delta",textDelta:n},partialOutput:a}),n=""}return new TransformStream({transform(i,a){if(i.type==="step-finish"&&s({controller:a}),i.type!=="text-delta"){a.enqueue({part:i,partialOutput:void 0});return}t+=i.textDelta,n+=i.textDelta;const o=e.parsePartial({text:t});if(o!=null){const l=JSON.stringify(o.partial);l!==r&&(s({controller:a,partialOutput:o.partial}),r=l)}},flush(i){n.length>0&&s({controller:i})}})}var E4e=class{constructor({model:e,telemetry:t,headers:n,settings:r,maxRetries:s,abortSignal:i,system:a,prompt:o,messages:l,tools:c,toolChoice:u,toolCallStreaming:d,transforms:h,activeTools:m,repairToolCall:y,maxSteps:b,output:v,continueSteps:x,providerOptions:w,now:S,currentDate:k,generateId:C,generateMessageId:T,onChunk:A,onError:N,onFinish:I,onStepFinish:O}){this.warningsPromise=new So,this.usagePromise=new So,this.finishReasonPromise=new So,this.providerMetadataPromise=new So,this.textPromise=new So,this.reasoningPromise=new So,this.reasoningDetailsPromise=new So,this.sourcesPromise=new So,this.filesPromise=new So,this.toolCallsPromise=new So,this.toolResultsPromise=new So,this.requestPromise=new So,this.responsePromise=new So,this.stepsPromise=new So;var B;if(b<1)throw new vc({parameter:"maxSteps",value:b,message:"maxSteps must be at least 1"});this.output=v;let D="",H="",P="",K=[],U=[],V,L=[];const te=[],W={id:C(),timestamp:k(),modelId:e.modelId,messages:[]};let Q=[],ee=[],re,pe,de="initial";const Oe=[];let Fe;const Se=new TransformStream({async transform(ce,oe){oe.enqueue(ce);const{part:se}=ce;if((se.type==="text-delta"||se.type==="reasoning"||se.type==="source"||se.type==="tool-call"||se.type==="tool-result"||se.type==="tool-call-streaming-start"||se.type==="tool-call-delta")&&await(A==null?void 0:A({chunk:se})),se.type==="error"&&await(N==null?void 0:N({error:se.error})),se.type==="text-delta"&&(D+=se.textDelta,H+=se.textDelta,P+=se.textDelta),se.type==="reasoning"&&(V==null?(V={type:"text",text:se.textDelta},K.push(V)):V.text+=se.textDelta),se.type==="reasoning-signature"){if(V==null)throw new rr({name:"InvalidStreamPart",message:"reasoning-signature without reasoning"});V.signature=se.signature,V=void 0}if(se.type==="redacted-reasoning"&&K.push({type:"redacted",data:se.data}),se.type==="file"&&U.push(se),se.type==="source"&&(te.push(se.source),L.push(se.source)),se.type==="tool-call"&&Q.push(se),se.type==="tool-result"&&ee.push(se),se.type==="step-finish"){const Me=b7({text:H,files:U,reasoning:K,tools:c??{},toolCalls:Q,toolResults:ee,messageId:se.messageId,generateMessageId:T}),Be=Oe.length;let Ae="done";Be+1<b&&(x&&se.finishReason==="length"&&Q.length===0?Ae="continue":Q.length>0&&ee.length===Q.length&&(Ae="tool-result"));const lt={stepType:de,text:D,reasoning:d4e(K),reasoningDetails:K,files:U,sources:L,toolCalls:Q,toolResults:ee,finishReason:se.finishReason,usage:se.usage,warnings:se.warnings,logprobs:se.logprobs,request:se.request,response:{...se.response,messages:[...W.messages,...Me]},providerMetadata:se.experimental_providerMetadata,experimental_providerMetadata:se.experimental_providerMetadata,isContinued:se.isContinued};await(O==null?void 0:O(lt)),Oe.push(lt),Q=[],ee=[],D="",L=[],K=[],U=[],V=void 0,Ae!=="done"&&(de=Ae),Ae!=="continue"&&(W.messages.push(...Me),H="")}se.type==="finish"&&(W.id=se.response.id,W.timestamp=se.response.timestamp,W.modelId=se.response.modelId,W.headers=se.response.headers,pe=se.usage,re=se.finishReason)},async flush(ce){var oe;try{if(Oe.length===0)return;const se=Oe[Oe.length-1];Ie.warningsPromise.resolve(se.warnings),Ie.requestPromise.resolve(se.request),Ie.responsePromise.resolve(se.response),Ie.toolCallsPromise.resolve(se.toolCalls),Ie.toolResultsPromise.resolve(se.toolResults),Ie.providerMetadataPromise.resolve(se.experimental_providerMetadata),Ie.reasoningPromise.resolve(se.reasoning),Ie.reasoningDetailsPromise.resolve(se.reasoningDetails);const Me=re??"unknown",Be=pe??{completionTokens:NaN,promptTokens:NaN,totalTokens:NaN};Ie.finishReasonPromise.resolve(Me),Ie.usagePromise.resolve(Be),Ie.textPromise.resolve(P),Ie.sourcesPromise.resolve(te),Ie.filesPromise.resolve(se.files),Ie.stepsPromise.resolve(Oe),await(I==null?void 0:I({finishReason:Me,logprobs:void 0,usage:Be,text:P,reasoning:se.reasoning,reasoningDetails:se.reasoningDetails,files:se.files,sources:se.sources,toolCalls:se.toolCalls,toolResults:se.toolResults,request:(oe=se.request)!=null?oe:{},response:se.response,warnings:se.warnings,providerMetadata:se.providerMetadata,experimental_providerMetadata:se.experimental_providerMetadata,steps:Oe})),Fe.setAttributes(k0({telemetry:t,attributes:{"ai.response.finishReason":Me,"ai.response.text":{output:()=>P},"ai.response.toolCalls":{output:()=>{var Ae;return(Ae=se.toolCalls)!=null&&Ae.length?JSON.stringify(se.toolCalls):void 0}},"ai.usage.promptTokens":Be.promptTokens,"ai.usage.completionTokens":Be.completionTokens}}))}catch(se){ce.error(se)}finally{Fe.end()}}}),Ce=Zje();this.addStream=Ce.addStream,this.closeStream=Ce.close;let qe=Ce.stream;for(const ce of h)qe=qe.pipeThrough(ce({tools:c,stopStream(){Ce.terminate()}}));this.baseStream=qe.pipeThrough(k4e(v)).pipeThrough(Se);const{maxRetries:Qe,retry:We}=nje({maxRetries:s}),je=aje(t),Y=rje({model:e,telemetry:t,headers:n,settings:{...r,maxRetries:Qe}}),ye=Bje({prompt:{system:(B=v==null?void 0:v.injectIntoSystemPrompt({system:a,model:e}))!=null?B:a,prompt:o,messages:l},tools:c}),Ie=this;Yj({name:"ai.streamText",attributes:k0({telemetry:t,attributes:{...Kj({operationId:"ai.streamText",telemetry:t}),...Y,"ai.prompt":{input:()=>JSON.stringify({system:a,prompt:o,messages:l})},"ai.settings.maxSteps":b}}),tracer:je,endWhenDone:!1,fn:async ce=>{Fe=ce;async function oe({currentStep:se,responseMessages:Me,usage:Be,stepType:Ae,previousStepText:lt,hasLeadingWhitespace:Tt,messageId:dt}){var Pt;const qt=Me.length===0?ye.type:"messages",Ft=[...ye.messages,...Me],Ht=await wje({prompt:{type:qt,system:ye.system,messages:Ft},modelSupportsImageUrls:e.supportsImageUrls,modelSupportsUrl:(Pt=e.supportsUrl)==null?void 0:Pt.bind(e)}),we={type:"regular",...r4e({tools:c,toolChoice:u,activeTools:m})},{result:{stream:F,warnings:X,rawResponse:be,request:ke},doStreamSpan:ge,startTimestampMs:Ee}=await We(()=>Yj({name:"ai.streamText.doStream",attributes:k0({telemetry:t,attributes:{...Kj({operationId:"ai.streamText.doStream",telemetry:t}),...Y,"ai.prompt.format":{input:()=>qt},"ai.prompt.messages":{input:()=>Kje(Ht)},"ai.prompt.tools":{input:()=>{var Zt;return(Zt=we.tools)==null?void 0:Zt.map(nn=>JSON.stringify(nn))}},"ai.prompt.toolChoice":{input:()=>we.toolChoice!=null?JSON.stringify(we.toolChoice):void 0},"gen_ai.system":e.provider,"gen_ai.request.model":e.modelId,"gen_ai.request.frequency_penalty":r.frequencyPenalty,"gen_ai.request.max_tokens":r.maxTokens,"gen_ai.request.presence_penalty":r.presencePenalty,"gen_ai.request.stop_sequences":r.stopSequences,"gen_ai.request.temperature":r.temperature,"gen_ai.request.top_k":r.topK,"gen_ai.request.top_p":r.topP}}),tracer:je,endWhenDone:!1,fn:async Zt=>({startTimestampMs:S(),doStreamSpan:Zt,result:await e.doStream({mode:we,...kje(r),inputFormat:qt,responseFormat:v==null?void 0:v.responseFormat({model:e}),prompt:Ht,providerMetadata:w,abortSignal:i,headers:n})})})),le=w4e({tools:c,generatorStream:F,toolCallStreaming:d,tracer:je,telemetry:t,system:a,messages:Ft,repairToolCall:y,abortSignal:i}),ft=ke??{},et=[],$=[],Ue=[],tt=[];let ve,_e="unknown",ze={promptTokens:0,completionTokens:0,totalTokens:0},Ct,fe=!0,Z="",G=Ae==="continue"?lt:"",J,xe={id:C(),timestamp:k(),modelId:e.modelId},De="",He=!1,wt=!0,Qt=!1;async function On({controller:Zt,chunk:nn}){Zt.enqueue(nn),Z+=nn.textDelta,G+=nn.textDelta,He=!0,Qt=nn.textDelta.trimEnd()!==nn.textDelta}Ie.addStream(le.pipeThrough(new TransformStream({async transform(Zt,nn){var fn,br,Mr;if(fe){const ss=S()-Ee;fe=!1,ge.addEvent("ai.stream.firstChunk",{"ai.response.msToFirstChunk":ss}),ge.setAttributes({"ai.response.msToFirstChunk":ss}),nn.enqueue({type:"step-start",messageId:dt,request:ft,warnings:X??[]})}if(Zt.type==="text-delta"&&Zt.textDelta.length===0)return;const rs=Zt.type;switch(rs){case"text-delta":{if(x){const ss=wt&&Tt?Zt.textDelta.trimStart():Zt.textDelta;if(ss.length===0)break;wt=!1,De+=ss;const kr=i4e(De);kr!=null&&(De=kr.suffix,await On({controller:nn,chunk:{type:"text-delta",textDelta:kr.prefix+kr.whitespace}}))}else await On({controller:nn,chunk:Zt});break}case"reasoning":{nn.enqueue(Zt),ve==null?(ve={type:"text",text:Zt.textDelta},Ue.push(ve)):ve.text+=Zt.textDelta;break}case"reasoning-signature":{if(nn.enqueue(Zt),ve==null)throw new p4e({chunk:Zt,message:"reasoning-signature without reasoning"});ve.signature=Zt.signature,ve=void 0;break}case"redacted-reasoning":{nn.enqueue(Zt),Ue.push({type:"redacted",data:Zt.data});break}case"tool-call":{nn.enqueue(Zt),et.push(Zt);break}case"tool-result":{nn.enqueue(Zt),$.push(Zt);break}case"response-metadata":{xe={id:(fn=Zt.id)!=null?fn:xe.id,timestamp:(br=Zt.timestamp)!=null?br:xe.timestamp,modelId:(Mr=Zt.modelId)!=null?Mr:xe.modelId};break}case"finish":{ze=Zt.usage,_e=Zt.finishReason,Ct=Zt.experimental_providerMetadata,J=Zt.logprobs;const ss=S()-Ee;ge.addEvent("ai.stream.finish"),ge.setAttributes({"ai.response.msToFinish":ss,"ai.response.avgCompletionTokensPerSecond":1e3*ze.completionTokens/ss});break}case"file":{tt.push(Zt),nn.enqueue(Zt);break}case"source":case"tool-call-streaming-start":case"tool-call-delta":{nn.enqueue(Zt);break}case"error":{nn.enqueue(Zt),_e="error";break}default:{const ss=rs;throw new Error(`Unknown chunk type: ${ss}`)}}},async flush(Zt){const nn=et.length>0?JSON.stringify(et):void 0;let fn="done";se+1<b&&(x&&_e==="length"&&et.length===0?fn="continue":et.length>0&&$.length===et.length&&(fn="tool-result")),x&&De.length>0&&(fn!=="continue"||Ae==="continue"&&!He)&&(await On({controller:Zt,chunk:{type:"text-delta",textDelta:De}}),De="");try{ge.setAttributes(k0({telemetry:t,attributes:{"ai.response.finishReason":_e,"ai.response.text":{output:()=>Z},"ai.response.toolCalls":{output:()=>nn},"ai.response.id":xe.id,"ai.response.model":xe.modelId,"ai.response.timestamp":xe.timestamp.toISOString(),"ai.usage.promptTokens":ze.promptTokens,"ai.usage.completionTokens":ze.completionTokens,"gen_ai.response.finish_reasons":[_e],"gen_ai.response.id":xe.id,"gen_ai.response.model":xe.modelId,"gen_ai.usage.input_tokens":ze.promptTokens,"gen_ai.usage.output_tokens":ze.completionTokens}}))}catch{}finally{ge.end()}Zt.enqueue({type:"step-finish",finishReason:_e,usage:ze,providerMetadata:Ct,experimental_providerMetadata:Ct,logprobs:J,request:ft,response:{...xe,headers:be==null?void 0:be.headers},warnings:X,isContinued:fn==="continue",messageId:dt});const br=qje(Be,ze);if(fn==="done")Zt.enqueue({type:"finish",finishReason:_e,usage:br,providerMetadata:Ct,experimental_providerMetadata:Ct,logprobs:J,response:{...xe,headers:be==null?void 0:be.headers}}),Ie.closeStream();else{if(Ae==="continue"){const Mr=Me[Me.length-1];typeof Mr.content=="string"?Mr.content+=Z:Mr.content.push({text:Z,type:"text"})}else Me.push(...b7({text:Z,files:tt,reasoning:Ue,tools:c??{},toolCalls:et,toolResults:$,messageId:dt,generateMessageId:T}));await oe({currentStep:se+1,responseMessages:Me,usage:br,stepType:fn,previousStepText:G,hasLeadingWhitespace:Qt,messageId:fn==="continue"?dt:T()})}}})))}await oe({currentStep:0,responseMessages:[],usage:{promptTokens:0,completionTokens:0,totalTokens:0},previousStepText:"",stepType:"initial",hasLeadingWhitespace:!1,messageId:T()})}}).catch(ce=>{Ie.addStream(new ReadableStream({start(oe){oe.enqueue({type:"error",error:ce}),oe.close()}})),Ie.closeStream()})}get warnings(){return this.warningsPromise.value}get usage(){return this.usagePromise.value}get finishReason(){return this.finishReasonPromise.value}get experimental_providerMetadata(){return this.providerMetadataPromise.value}get providerMetadata(){return this.providerMetadataPromise.value}get text(){return this.textPromise.value}get reasoning(){return this.reasoningPromise.value}get reasoningDetails(){return this.reasoningDetailsPromise.value}get sources(){return this.sourcesPromise.value}get files(){return this.filesPromise.value}get toolCalls(){return this.toolCallsPromise.value}get toolResults(){return this.toolResultsPromise.value}get request(){return this.requestPromise.value}get response(){return this.responsePromise.value}get steps(){return this.stepsPromise.value}teeStream(){const[e,t]=this.baseStream.tee();return this.baseStream=t,e}get textStream(){return PI(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){e.type==="text-delta"&&t.enqueue(e.textDelta)}})))}get fullStream(){return PI(this.teeStream().pipeThrough(new TransformStream({transform({part:e},t){t.enqueue(e)}})))}async consumeStream(e){var t;try{await x4e({stream:this.fullStream,onError:e==null?void 0:e.onError})}catch(n){(t=e==null?void 0:e.onError)==null||t.call(e,n)}}get experimental_partialOutputStream(){if(this.output==null)throw new Qje;return PI(this.teeStream().pipeThrough(new TransformStream({transform({partialOutput:e},t){e!=null&&t.enqueue(e)}})))}toDataStreamInternal({getErrorMessage:e=()=>"An error occurred.",sendUsage:t=!0,sendReasoning:n=!1,sendSources:r=!1,experimental_sendFinish:s=!0}){return this.fullStream.pipeThrough(new TransformStream({transform:async(i,a)=>{const o=i.type;switch(o){case"text-delta":{a.enqueue(Ma("text",i.textDelta));break}case"reasoning":{n&&a.enqueue(Ma("reasoning",i.textDelta));break}case"redacted-reasoning":{n&&a.enqueue(Ma("redacted_reasoning",{data:i.data}));break}case"reasoning-signature":{n&&a.enqueue(Ma("reasoning_signature",{signature:i.signature}));break}case"file":{a.enqueue(Ma("file",{mimeType:i.mimeType,data:i.base64}));break}case"source":{r&&a.enqueue(Ma("source",i.source));break}case"tool-call-streaming-start":{a.enqueue(Ma("tool_call_streaming_start",{toolCallId:i.toolCallId,toolName:i.toolName}));break}case"tool-call-delta":{a.enqueue(Ma("tool_call_delta",{toolCallId:i.toolCallId,argsTextDelta:i.argsTextDelta}));break}case"tool-call":{a.enqueue(Ma("tool_call",{toolCallId:i.toolCallId,toolName:i.toolName,args:i.args}));break}case"tool-result":{a.enqueue(Ma("tool_result",{toolCallId:i.toolCallId,result:i.result}));break}case"error":{a.enqueue(Ma("error",e(i.error)));break}case"step-start":{a.enqueue(Ma("start_step",{messageId:i.messageId}));break}case"step-finish":{a.enqueue(Ma("finish_step",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0,isContinued:i.isContinued}));break}case"finish":{s&&a.enqueue(Ma("finish_message",{finishReason:i.finishReason,usage:t?{promptTokens:i.usage.promptTokens,completionTokens:i.usage.completionTokens}:void 0}));break}default:{const l=o;throw new Error(`Unknown chunk type: ${l}`)}}}}))}pipeDataStreamToResponse(e,{status:t,statusText:n,headers:r,data:s,getErrorMessage:i,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c}={}){d7({response:e,status:t,statusText:n,headers:u7(r,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"}),stream:this.toDataStream({data:s,getErrorMessage:i,sendUsage:a,sendReasoning:o,sendSources:l,experimental_sendFinish:c})})}pipeTextStreamToResponse(e,t){d7({response:e,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText,headers:u7(t==null?void 0:t.headers,{contentType:"text/plain; charset=utf-8"}),stream:this.textStream.pipeThrough(new TextEncoderStream)})}toDataStream(e){const t=this.toDataStreamInternal({getErrorMessage:e==null?void 0:e.getErrorMessage,sendUsage:e==null?void 0:e.sendUsage,sendReasoning:e==null?void 0:e.sendReasoning,sendSources:e==null?void 0:e.sendSources,experimental_sendFinish:e==null?void 0:e.experimental_sendFinish}).pipeThrough(new TextEncoderStream);return e!=null&&e.data?$D(e==null?void 0:e.data.stream,t):t}mergeIntoDataStream(e,t){e.merge(this.toDataStreamInternal({getErrorMessage:e.onError,sendUsage:t==null?void 0:t.sendUsage,sendReasoning:t==null?void 0:t.sendReasoning,sendSources:t==null?void 0:t.sendSources,experimental_sendFinish:t==null?void 0:t.experimental_sendFinish}))}toDataStreamResponse({headers:e,status:t,statusText:n,data:r,getErrorMessage:s,sendUsage:i,sendReasoning:a,sendSources:o,experimental_sendFinish:l}={}){return new Response(this.toDataStream({data:r,getErrorMessage:s,sendUsage:i,sendReasoning:a,sendSources:o,experimental_sendFinish:l}),{status:t,statusText:n,headers:gk(e,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}toTextStreamResponse(e){var t;return new Response(this.textStream.pipeThrough(new TextEncoderStream),{status:(t=e==null?void 0:e.status)!=null?t:200,headers:gk(e==null?void 0:e.headers,{contentType:"text/plain; charset=utf-8"})})}};var AJ="2024-11-05",T4e=[AJ,"2024-10-07"],A4e=Ke({name:$e(),version:$e()}).passthrough(),zD=Ke({_meta:ia(Ke({}).passthrough())}).passthrough(),$w=zD,R4e=Ke({method:$e(),params:ia(zD)}),N4e=Ke({experimental:ia(Ke({}).passthrough()),logging:ia(Ke({}).passthrough()),prompts:ia(Ke({listChanged:ia(Zn())}).passthrough()),resources:ia(Ke({subscribe:ia(Zn()),listChanged:ia(Zn())}).passthrough()),tools:ia(Ke({listChanged:ia(Zn())}).passthrough())}).passthrough(),M4e=$w.extend({protocolVersion:$e(),capabilities:N4e,serverInfo:A4e,instructions:ia($e())}),I4e=$w.extend({nextCursor:ia($e())}),j4e=Ke({name:$e(),description:ia($e()),inputSchema:Ke({type:Mn("object"),properties:ia(Ke({}).passthrough())}).passthrough()}).passthrough(),P4e=I4e.extend({tools:ln(j4e)}),O4e=Ke({type:Mn("text"),text:$e()}).passthrough(),D4e=Ke({type:Mn("image"),data:$e().base64(),mimeType:$e()}).passthrough(),RJ=Ke({uri:$e(),mimeType:ia($e())}).passthrough(),F4e=RJ.extend({text:$e()}),L4e=RJ.extend({blob:$e().base64()}),B4e=Ke({type:Mn("resource"),resource:ms([F4e,L4e])}).passthrough(),$4e=$w.extend({content:ln(ms([O4e,D4e,B4e])),isError:Zn().default(!1).optional()}).or($w.extend({toolResult:Yy()})),CT="2.0",z4e=Ke({jsonrpc:Mn(CT),id:ms([$e(),At().int()])}).merge(R4e).strict(),U4e=Ke({jsonrpc:Mn(CT),id:ms([$e(),At().int()]),result:$w}).strict(),q4e=Ke({jsonrpc:Mn(CT),id:ms([$e(),At().int()]),error:Ke({code:At().int(),message:$e(),data:ia(Yy())})}).strict(),V4e=Ke({jsonrpc:Mn(CT)}).merge(Ke({method:$e(),params:ia(zD)})).strict(),W4e=ms([z4e,V4e,U4e,q4e]),H4e=class{constructor({url:e,headers:t}){this.connected=!1,this.url=new URL(e),this.headers=t}async start(){return new Promise((e,t)=>{if(this.connected)return e();this.abortController=new AbortController,(async()=>{var r,s,i;try{const a=new Headers(this.headers);a.set("Accept","text/event-stream");const o=await fetch(this.url.href,{headers:a,signal:(r=this.abortController)==null?void 0:r.signal});if(!o.ok||!o.body){const d=new sa({message:`MCP SSE Transport Error: ${o.status} ${o.statusText}`});return(s=this.onerror)==null||s.call(this,d),t(d)}const c=o.body.pipeThrough(new TextDecoderStream).pipeThrough(xG()).getReader(),u=async()=>{var d,h,m;try{for(;;){const{done:y,value:b}=await c.read();if(y){if(this.connected)throw this.connected=!1,new sa({message:"MCP SSE Transport Error: Connection closed unexpectedly"});return}const{event:v,data:x}=b;if(v==="endpoint"){if(this.endpoint=new URL(x,this.url),this.endpoint.origin!==this.url.origin)throw new sa({message:`MCP SSE Transport Error: Endpoint origin does not match connection origin: ${this.endpoint.origin}`});this.connected=!0,e()}else if(v==="message")try{const w=W4e.parse(JSON.parse(x));(d=this.onmessage)==null||d.call(this,w)}catch(w){const S=new sa({message:"MCP SSE Transport Error: Failed to parse message",cause:w});(h=this.onerror)==null||h.call(this,S)}}}catch(y){if(y instanceof Error&&y.name==="AbortError")return;(m=this.onerror)==null||m.call(this,y),t(y)}};this.sseConnection={close:()=>c.cancel()},u()}catch(a){if(a instanceof Error&&a.name==="AbortError")return;(i=this.onerror)==null||i.call(this,a),t(a)}})()})}async close(){var e,t,n;this.connected=!1,(e=this.sseConnection)==null||e.close(),(t=this.abortController)==null||t.abort(),(n=this.onclose)==null||n.call(this)}async send(e){var t,n,r;if(!this.endpoint||!this.connected)throw new sa({message:"MCP SSE Transport Error: Not connected"});try{const s=new Headers(this.headers);s.set("Content-Type","application/json");const i={method:"POST",headers:s,body:JSON.stringify(e),signal:(t=this.abortController)==null?void 0:t.signal},a=await fetch(this.endpoint,i);if(!a.ok){const o=await a.text().catch(()=>null),l=new sa({message:`MCP SSE Transport Error: POSTing to endpoint (HTTP ${a.status}): ${o}`});(n=this.onerror)==null||n.call(this,l);return}}catch(s){(r=this.onerror)==null||r.call(this,s);return}}};function G4e(e){if(e.type!=="sse")throw new sa({message:"Unsupported or invalid transport configuration. If you are using a custom transport, make sure it implements the MCPTransport interface."});return new H4e(e)}function K4e(e){return"start"in e&&typeof e.start=="function"&&"send"in e&&typeof e.send=="function"&&"close"in e&&typeof e.close=="function"}var Y4e="1.0.0";async function v7(e){const t=new Z4e(e);return await t.init(),t}var Z4e=class{constructor({transport:e,name:t="ai-sdk-mcp-client",onUncaughtError:n}){this.requestMessageId=0,this.responseHandlers=new Map,this.serverCapabilities={},this.isClosed=!0,this.onUncaughtError=n,K4e(e)?this.transport=e:this.transport=G4e(e),this.transport.onclose=()=>this.onClose(),this.transport.onerror=r=>this.onError(r),this.transport.onmessage=r=>{if("method"in r){this.onError(new sa({message:"Unsupported message type"}));return}this.onResponse(r)},this.clientInfo={name:t,version:Y4e}}async init(){try{await this.transport.start(),this.isClosed=!1;const e=await this.request({request:{method:"initialize",params:{protocolVersion:AJ,capabilities:{},clientInfo:this.clientInfo}},resultSchema:M4e});if(e===void 0)throw new sa({message:"Server sent invalid initialize result"});if(!T4e.includes(e.protocolVersion))throw new sa({message:`Server's protocol version is not supported: ${e.protocolVersion}`});return this.serverCapabilities=e.capabilities,await this.notification({method:"notifications/initialized"}),this}catch(e){throw await this.close(),e}}async close(){var e;this.isClosed||(await((e=this.transport)==null?void 0:e.close()),this.onClose())}assertCapability(e){switch(e){case"initialize":break;case"tools/list":case"tools/call":if(!this.serverCapabilities.tools)throw new sa({message:"Server does not support tools"});break;default:throw new sa({message:`Unsupported method: ${e}`})}}async request({request:e,resultSchema:t,options:n}){return new Promise((r,s)=>{if(this.isClosed)return s(new sa({message:"Attempted to send a request from a closed client"}));this.assertCapability(e.method);const i=n==null?void 0:n.signal;i==null||i.throwIfAborted();const a=this.requestMessageId++,o={...e,jsonrpc:"2.0",id:a},l=()=>{this.responseHandlers.delete(a)};this.responseHandlers.set(a,c=>{if(i!=null&&i.aborted)return s(new sa({message:"Request was aborted",cause:i.reason}));if(c instanceof Error)return s(c);try{const u=t.parse(c.result);r(u)}catch(u){const d=new sa({message:"Failed to parse server response",cause:u});s(d)}}),this.transport.send(o).catch(c=>{l(),s(c)})})}async listTools({params:e,options:t}={}){try{return this.request({request:{method:"tools/list",params:e},resultSchema:P4e,options:t})}catch(n){throw n}}async callTool({name:e,args:t,options:n}){try{return this.request({request:{method:"tools/call",params:{name:e,arguments:t}},resultSchema:$4e,options:{signal:n==null?void 0:n.abortSignal}})}catch(r){throw r}}async notification(e){const t={...e,jsonrpc:"2.0"};await this.transport.send(t)}async tools({schemas:e="automatic"}={}){var t;const n={};try{const r=await this.listTools();for(const{name:s,description:i,inputSchema:a}of r.tools){if(e!=="automatic"&&!(s in e))continue;const o=e==="automatic"?RX({...a,properties:(t=a.properties)!=null?t:{},additionalProperties:!1}):e[s].parameters,l=this,c={description:i,parameters:o,execute:async(u,d)=>{var h;return(h=d==null?void 0:d.abortSignal)==null||h.throwIfAborted(),l.callTool({name:s,args:u,options:d})}};n[s]=c}return n}catch(r){throw r}}onClose(){if(this.isClosed)return;this.isClosed=!0;const e=new sa({message:"Connection closed"});for(const t of this.responseHandlers.values())t(e);this.responseHandlers.clear()}onError(e){this.onUncaughtError&&this.onUncaughtError(e)}onResponse(e){const t=Number(e.id),n=this.responseHandlers.get(t);if(n===void 0)throw new sa({message:`Protocol error: Received a response for an unknown message ID: ${JSON.stringify(e)}`});this.responseHandlers.delete(t),n("result"in e?e:new sa({message:e.error.message,cause:e.error}))}},X4e={};LD(X4e,{mergeIntoDataStream:()=>ePe,toDataStream:()=>J4e,toDataStreamResponse:()=>Q4e});function NJ(e={}){const t=new TextEncoder;let n="";return new TransformStream({async start(){e.onStart&&await e.onStart()},async transform(r,s){s.enqueue(t.encode(r)),n+=r,e.onToken&&await e.onToken(r),e.onText&&typeof r=="string"&&await e.onText(r)},async flush(){e.onCompletion&&await e.onCompletion(n),e.onFinal&&await e.onFinal(n)}})}function UD(e,t){return e.pipeThrough(new TransformStream({transform:async(n,r)=>{var s;if(typeof n=="string"){r.enqueue(n);return}if("event"in n){n.event==="on_chat_model_stream"&&x7((s=n.data)==null?void 0:s.chunk,r);return}x7(n,r)}})).pipeThrough(NJ(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(n,r)=>{r.enqueue(Ma("text",n))}}))}function J4e(e,t){return UD(e,t).pipeThrough(new TextEncoderStream)}function Q4e(e,t){var n;const r=UD(e,t==null?void 0:t.callbacks).pipeThrough(new TextEncoderStream),s=t==null?void 0:t.data,i=t==null?void 0:t.init,a=s?$D(s.stream,r):r;return new Response(a,{status:(n=i==null?void 0:i.status)!=null?n:200,statusText:i==null?void 0:i.statusText,headers:gk(i==null?void 0:i.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function ePe(e,t){t.dataStream.merge(UD(e,t.callbacks))}function x7(e,t){if(typeof e.content=="string")t.enqueue(e.content);else{const n=e.content;for(const r of n)r.type==="text"&&t.enqueue(r.text)}}var tPe={};LD(tPe,{mergeIntoDataStream:()=>sPe,toDataStream:()=>nPe,toDataStreamResponse:()=>rPe});function qD(e,t){const n=iPe();return Iye(e[Symbol.asyncIterator]()).pipeThrough(new TransformStream({async transform(r,s){s.enqueue(n(r.delta))}})).pipeThrough(NJ(t)).pipeThrough(new TextDecoderStream).pipeThrough(new TransformStream({transform:async(r,s)=>{s.enqueue(Ma("text",r))}}))}function nPe(e,t){return qD(e,t).pipeThrough(new TextEncoderStream)}function rPe(e,t={}){var n;const{init:r,data:s,callbacks:i}=t,a=qD(e,i).pipeThrough(new TextEncoderStream),o=s?$D(s.stream,a):a;return new Response(o,{status:(n=r==null?void 0:r.status)!=null?n:200,statusText:r==null?void 0:r.statusText,headers:gk(r==null?void 0:r.headers,{contentType:"text/plain; charset=utf-8",dataStreamVersion:"v1"})})}function sPe(e,t){t.dataStream.merge(qD(e,t.callbacks))}function iPe(){let e=!0;return t=>(e&&(t=t.trimStart(),t&&(e=!1)),t)}class aPe{static async executeInteraction(t,n,r){let s,i=!1,a=null,o,l,c;try{s=await C4e(n);for await(const u of s.fullStream){if(n.abortSignal.aborted){console.log(`[AIService] Stream ${t} aborted by signal.`);break}switch(u.type){case"text-delta":r.onChunk(u.textDelta);break;case"reasoning":r.onReasoningChunk(u.textDelta);break;case"tool-call":r.onToolCall(u);break;case"tool-result":r.onToolResult(u);break;case"step-start":r.onStepStart&&r.onStepStart({messageId:u.messageId,request:u.request,warnings:u.warnings||[]}),console.log(`[AIService] Step started for ${t} - Message ID: ${u.messageId}`);break;case"step-finish":r.onStepFinish&&r.onStepFinish({finishReason:u.finishReason,usage:u.usage,isContinued:u.isContinued||!1,warnings:u.warnings||[]}),console.log(`[AIService] Step finished for ${t} - Reason: ${u.finishReason}, Continued: ${u.isContinued}`);break;case"finish":i=!0,a=u.finishReason,o=u.usage,l=u.providerMetadata;break;case"error":r.onError(new Error(`AI Stream Error Part: ${u.error instanceof Error?u.error.message:u.error}`));return;default:console.warn(`[AIService] Received unexpected stream part type: ${u.type} for ${t}`,u);break}}s!=null&&s.reasoning?(c=await s.reasoning,console.log(`[AIService] Extracted final reasoning for ${t}`)):console.log(`[AIService] No final reasoning found in stream result for ${t}.`),!n.abortSignal.aborted&&i?r.onFinish({finishReason:a,usage:o,providerMetadata:l,reasoning:c}):!n.abortSignal.aborted&&!i&&(console.warn(`[AIService] Stream ${t} ended without a 'finish' part.`),r.onError(new Error("Stream ended unexpectedly without a finish signal.")))}catch(u){console.error(`[AIService] Error during streamText call for ${t}:`,u),u instanceof Error&&u.name==="AbortError"||r.onError(u instanceof Error?u:new Error(String(u)))}finally{console.log(`[AIService] Stream processing finished for ${t}.`)}}}const oPe=".litechat/conversations",MJ="/synced_repos";async function lPe(e,t,n,r=!1){n(t.id,"syncing");const s=Ur(`${MJ}/${t.id}`),i={username:t.username,password:t.password},a=t.branch||"main";try{let o=!1;try{await e.promises.stat(Lu(s,".git")),o=!0}catch(l){if(l.code==="ENOENT")o=!1;else throw l}o?(r||Te.info(`Pulling latest changes for "${t.name}"...`),await hT(s,a,i,{fsInstance:e}),r||Te.success(`Repository "${t.name}" synced successfully.`),n(t.id,"idle")):(r||Te.info(`Cloning repository "${t.name}"...`),await AZ(s,t.remoteUrl,a,i,{fsInstance:e}),r||Te.success(`Repository "${t.name}" cloned successfully.`),n(t.id,"idle"))}catch(o){console.error(`Failed to initialize/sync repository ${t.name}:`,o),n(t.id,"error")}}async function cPe(e,t,n,r,s,i,a,o=!1){var h,m;r(t.id,"syncing");const l=Ur(`${MJ}/${n.id}`),c=Lu(l,oPe,`${t.id}.json`),u={username:n.username,password:n.password},d=n.branch||"main";try{try{await e.promises.stat(Lu(l,".git"))}catch(w){if(w.code==="ENOENT"){Te.error(`Repository "${n.name}" not found locally. Please clone/sync it from Settings first.`),r(t.id,"error","Repo not cloned");return}throw w}o||Te.info(`Pulling latest changes for "${n.name}"...`),await hT(l,d,u,{fsInstance:e});let y=null,b=null;try{const w=await lp(c,{fsInstance:e}),S=new TextDecoder().decode(w);y=JSON.parse(S),b=(h=y==null?void 0:y.conversation)!=null&&h.updatedAt?new Date(y.conversation.updatedAt).getTime():null,isNaN(b??NaN)&&(b=null)}catch(w){w.code==="ENOENT"?console.log(`Conversation file ${c} not found in repo. Will push local version.`):(console.error(`Failed to read or parse remote conversation file: ${w.message}`),Te.warning(`Could not read remote version of conversation: ${w.message}`))}const v=t.updatedAt.getTime(),x=((m=t.lastSyncedAt)==null?void 0:m.getTime())??0;if(!y||v>(b??0)||v>x&&v>=(b??0)){o||Te.info("Local changes detected. Pushing to remote...");const w=await bt.loadInteractionsForConversation(t.id),{lastSyncedAt:S,...k}=t,C=JSON.stringify({conversation:k,interactions:w},null,2);await pT(c,C,{fsInstance:e}),await wD(l,`Sync conversation: ${t.title} (${t.id})`,{fsInstance:e}),await _D(l,d,u,{fsInstance:e}),await s(t.id,{lastSyncedAt:new Date}),r(t.id,"idle"),o||Te.success("Conversation synced successfully (pushed).")}else if(b&&b>v){o||Te.info("Remote changes detected. Updating local conversation...");const w={...y.conversation,createdAt:new Date(y.conversation.createdAt),updatedAt:new Date(y.conversation.updatedAt),lastSyncedAt:new Date};await bt.saveConversation(w),await bt.deleteInteractionsForConversation(t.id);const S=y.interactions.map(k=>bt.saveInteraction({...k,conversationId:t.id,startedAt:k.startedAt?new Date(k.startedAt):null,endedAt:k.endedAt?new Date(k.endedAt):null}));await Promise.all(S),i()===t.id&&a()==="conversation"&&await un.getState().loadInteractions(t.id),r(t.id,"idle"),o||Te.success("Conversation synced successfully (pulled).")}else o||Te.info("Conversation already up-to-date."),await s(t.id,{lastSyncedAt:new Date}),r(t.id,"idle")}catch(y){console.error(`Sync failed for conversation ${t.id}:`,y),r(t.id,"error",y.message)}}const Sa={loaded:"project.loaded",added:"project.added",updated:"project.updated",deleted:"project.deleted",loadingStateChanged:"project.loading.state.changed",loadProjectsRequest:"project.load.projects.request",addProjectRequest:"project.add.project.request",updateProjectRequest:"project.update.project.request",deleteProjectRequest:"project.delete.project.request"},er={conversationsLoaded:"conversation.conversations.loaded",selectedItemChanged:"conversation.selected.item.changed",conversationAdded:"conversation.added",conversationUpdated:"conversation.updated",conversationDeleted:"conversation.deleted",conversationSyncStatusChanged:"conversation.sync.status.changed",syncReposLoaded:"conversation.sync.repos.loaded",syncRepoChanged:"conversation.sync.repo.changed",syncRepoInitStatusChanged:"conversation.sync.repo.init.status.changed",loadingStateChanged:"conversation.loading.state.changed",loadConversationsRequest:"conversation.load.conversations.request",addConversationRequest:"conversation.add.conversation.request",updateConversationRequest:"conversation.update.conversation.request",deleteConversationRequest:"conversation.delete.conversation.request",selectItemRequest:"conversation.select.item.request",importConversationRequest:"conversation.import.conversation.request",exportConversationRequest:"conversation.export.conversation.request",exportProjectRequest:"conversation.export.project.request",exportAllConversationsRequest:"conversation.export.all.conversations.request",loadSyncReposRequest:"conversation.load.sync.repos.request",addSyncRepoRequest:"conversation.add.sync.repo.request",updateSyncRepoRequest:"conversation.update.sync.repo.request",deleteSyncRepoRequest:"conversation.delete.sync.repo.request",linkConversationToRepoRequest:"conversation.link.conversation.to.repo.request",syncConversationRequest:"conversation.sync.conversation.request",initializeOrSyncRepoRequest:"conversation.initialize.or.sync.repo.request",updateCurrentConversationToolSettingsRequest:"conversation.update.current.conversation.tool.settings.request"},yl=Wo(Ho((e,t)=>({projects:[],isLoading:!1,error:null,loadProjects:async()=>{e({isLoading:!0,error:null});try{const n=await bt.loadProjects();e({projects:n,isLoading:!1}),Re.emit(Sa.loaded,{projects:n})}catch(n){console.error("ProjectStore: Error loading projects",n),e({error:"Failed to load projects",isLoading:!1}),Re.emit(Sa.loadingStateChanged,{isLoading:!1,error:"Failed to load projects"})}},addProject:async n=>{var l;const r=qr(),s=new Date,i=n.parentId?((l=t().getProjectById(n.parentId))==null?void 0:l.path)??"/":"/",a=Ur(`${i}/${n.name.replace(/\s+/g,"-").toLowerCase()}-${r.substring(0,4)}`),o={id:r,path:a,createdAt:s,updatedAt:s,name:n.name,parentId:n.parentId??null,systemPrompt:n.systemPrompt??null,modelId:n.modelId??null,temperature:n.temperature??null,maxTokens:n.maxTokens??null,topP:n.topP??null,topK:n.topK??null,presencePenalty:n.presencePenalty??null,frequencyPenalty:n.frequencyPenalty??null,defaultTagIds:n.defaultTagIds??null,defaultRuleIds:n.defaultRuleIds??null,metadata:n.metadata??{}};try{return await bt.saveProject(o),e(c=>{c.projects.unshift(o),c.projects.sort((u,d)=>d.updatedAt.getTime()-u.updatedAt.getTime())}),Re.emit(Sa.added,{project:o}),r}catch(c){throw console.error("ProjectStore: Error adding project",c),e({error:"Failed to save new project"}),c}},updateProject:async(n,r)=>{var a;const s=t().getProjectById(n);if(!s){console.warn(`ProjectStore: Project ${n} not found for update.`);return}const i={...s,...r,updatedAt:new Date};if(r.name&&r.name!==s.name){const o=s.parentId?((a=t().getProjectById(s.parentId))==null?void 0:a.path)??"/":"/";i.path=Ur(`${o}/${r.name.replace(/\s+/g,"-").toLowerCase()}-${n.substring(0,4)}`)}try{await bt.saveProject(i),e(o=>{const l=o.projects.findIndex(c=>c.id===n);l!==-1&&(o.projects[l]=i,o.projects.sort((c,u)=>u.updatedAt.getTime()-c.updatedAt.getTime()))}),Re.emit(Sa.updated,{projectId:n,updates:i})}catch(o){throw console.error("ProjectStore: Error updating project",o),e({error:"Failed to save project update"}),o}},deleteProject:async n=>{const r=t().projects.find(a=>a.id===n);if(!r)return;const s=new Set,i=a=>{s.add(a),t().projects.filter(o=>o.parentId===a).forEach(o=>i(o.id))};i(n);try{await bt.deleteProject(n),e(a=>({projects:a.projects.filter(o=>!s.has(o.id))})),Re.emit(er.loadConversationsRequest,void 0),Re.emit(Sa.deleted,{projectId:n}),Te.success(`Project "${r.name}" and its contents deleted.`)}catch(a){throw console.error("ProjectStore: Error deleting project",a),e({error:"Failed to delete project"}),a}},getProjectById:n=>{if(n)return t().projects.find(r=>r.id===n)},getTopLevelProjectId:n=>{if(!n)return null;let r=t().getProjectById(n);if(!r)return null;for(;r.parentId;){const s=t().getProjectById(r.parentId);if(!s)break;r=s}return r.id},getEffectiveProjectSettings:n=>{const r=pr.getState(),s=Qn.getState().selectedModelId,i={systemPrompt:r.globalSystemPrompt,modelId:s,temperature:r.temperature,maxTokens:r.maxTokens,topP:r.topP,topK:r.topK,presencePenalty:r.presencePenalty,frequencyPenalty:r.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null};if(!n)return i;const a=t().getProjectById(n);if(!a)return i;const o=a.parentId?t().getEffectiveProjectSettings(a.parentId):i;return{systemPrompt:a.systemPrompt!==null&&a.systemPrompt!==void 0?a.systemPrompt:o.systemPrompt,modelId:a.modelId!==null&&a.modelId!==void 0?a.modelId:o.modelId,temperature:a.temperature!==null&&a.temperature!==void 0?a.temperature:o.temperature,maxTokens:a.maxTokens!==null&&a.maxTokens!==void 0?a.maxTokens:o.maxTokens,topP:a.topP!==null&&a.topP!==void 0?a.topP:o.topP,topK:a.topK!==null&&a.topK!==void 0?a.topK:o.topK,presencePenalty:a.presencePenalty!==null&&a.presencePenalty!==void 0?a.presencePenalty:o.presencePenalty,frequencyPenalty:a.frequencyPenalty!==null&&a.frequencyPenalty!==void 0?a.frequencyPenalty:o.frequencyPenalty,defaultTagIds:a.defaultTagIds!==null&&a.defaultTagIds!==void 0?a.defaultTagIds:o.defaultTagIds,defaultRuleIds:a.defaultRuleIds!==null&&a.defaultRuleIds!==void 0?a.defaultRuleIds:o.defaultRuleIds}},getRegisteredActionHandlers:()=>{const n="projectStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:Sa.loadProjectsRequest,handler:r.loadProjects,storeId:n},{eventName:Sa.addProjectRequest,handler:s(r.addProject),storeId:n},{eventName:Sa.updateProjectRequest,handler:i=>r.updateProject(i.id,i.updates),storeId:n},{eventName:Sa.deleteProjectRequest,handler:i=>r.deleteProject(i.id),storeId:n}]}}))),Gp=(e,t)=>{const n=URL.createObjectURL(e),r=document.createElement("a");r.href=n,r.download=t,document.body.appendChild(r),r.click(),document.body.removeChild(r),URL.revokeObjectURL(n)},uPe=(e,t)=>{let n=`# ${e.title}

`;return n+=`*Conversation ID: ${e.id}*
`,n+=`*Created: ${jd(e.createdAt,"yyyy-MM-dd HH:mm:ss")}*
`,n+=`*Last Updated: ${jd(e.updatedAt,"yyyy-MM-dd HH:mm:ss")}*
`,e.projectId&&(n+=`*Project ID: ${e.projectId}*
`),n+=`
---

`,t.filter(r=>r.type==="message.user_assistant").sort((r,s)=>r.index-s.index).forEach(r=>{var s,i,a,o,l,c,u,d;((s=r.prompt)!=null&&s.content||(o=(a=(i=r.prompt)==null?void 0:i.metadata)==null?void 0:a.attachedFiles)!=null&&o.length)&&(n+=`## User (Index: ${r.index})

`,(l=r.prompt.metadata)!=null&&l.attachedFiles&&r.prompt.metadata.attachedFiles.length>0&&(n+=`**Attached Files:**
`,r.prompt.metadata.attachedFiles.forEach(h=>{n+=`- ${h.name} (${h.type}, ${yw(h.size)}) ${h.source==="vfs"?`(VFS: ${h.path})`:"(Direct Upload)"}
`}),n+=`
`),r.prompt.content&&(n+=`${r.prompt.content}

`)),r.response&&(n+=`## Assistant (Index: ${r.index})

`,(c=r.metadata)!=null&&c.modelId&&(n+=`*Model: ${r.metadata.modelId}*

`),typeof r.response=="string"?n+=`${r.response}

`:(n+="```json\n",n+=`${JSON.stringify(r.response,null,2)}
`,n+="```\n\n"),((u=r.metadata)!=null&&u.promptTokens||(d=r.metadata)!=null&&d.completionTokens)&&(n+=`*Tokens: ${r.metadata.promptTokens??"?"} (prompt) / ${r.metadata.completionTokens??"?"} (completion)*

`)),n+=`---

`}),n};class E0{static async importConversation(t,n,r){try{const s=await t.text(),i=JSON.parse(s);if(!i||typeof i!="object"||!i.conversation||!Array.isArray(i.interactions))throw new Error("Invalid import file format. Expected { conversation: {}, interactions: [] }.");const a=i.conversation,o=i.interactions;if(!a.id||!a.title||!a.createdAt||!a.updatedAt)throw new Error("Invalid conversation data in import file.");const l=await n({title:a.title||"Imported Chat",metadata:a.metadata,projectId:null,syncRepoId:null,lastSyncedAt:null}),c=o.map(u=>bt.saveInteraction({...u,conversationId:l,id:qr()}));await Promise.all(c),await r(l,"conversation"),Te.success("Conversation imported successfully.")}catch(s){throw console.error("ImportExportService: Error importing conversation",s),Te.error(`Import failed: ${s instanceof Error?s.message:String(s)}`),s}}static async exportConversation(t,n){try{const r=Vn.getState().getConversationById(t);if(!r)throw new Error("Conversation not found.");const s=await bt.loadInteractionsForConversation(t);let i,a;const o=r.title.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"conversation";if(n==="json"){const c=JSON.stringify({conversation:r,interactions:s},null,2);i=new Blob([c],{type:"application/json"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.json`}else if(n==="md"){const l=uPe(r,s);i=new Blob([l],{type:"text/markdown"}),a=`litechat_conversation_${o}_${t.substring(0,6)}.md`}else throw new Error("Invalid export format specified.");Gp(i,a),Te.success(`Conversation exported as ${n.toUpperCase()}.`)}catch(r){throw console.error("ImportExportService: Error exporting conversation",r),Te.error(`Export failed: ${r instanceof Error?r.message:String(r)}`),r}}static async exportProject(t){try{const{projects:n,getProjectById:r}=yl.getState(),{conversations:s}=Vn.getState(),i=r(t);if(!i)throw new Error("Project not found.");const a=async h=>{const m=n.find(x=>x.id===h);if(!m)throw new Error(`Project ${h} not found in state.`);const y=n.filter(x=>x.parentId===h),b=s.filter(x=>x.projectId===h),v=[];for(const x of y)v.push(await a(x.id));for(const x of b){const w=await bt.loadInteractionsForConversation(x.id);v.push({conversation:x,interactions:w})}return{project:m,children:v}},o=await a(t),l=JSON.stringify(o,null,2),c=new Blob([l],{type:"application/json"}),d=`litechat_project_${i.name.replace(/[^a-z0-9]/gi,"_").toLowerCase()||"project"}_${t.substring(0,6)}.json`;Gp(c,d),Te.success(`Project "${i.name}" exported.`)}catch(n){throw console.error("ImportExportService: Error exporting project",n),Te.error(`Project export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async exportAllConversations(){try{const t=Vn.getState().conversations,n=[];for(const a of t){const o=await bt.loadInteractionsForConversation(a.id);n.push({conversation:a,interactions:o})}const r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),i=`litechat_all_conversations_export_${new Date().toISOString().split("T")[0]}.json`;Gp(s,i),Te.success("All conversations exported.")}catch(t){throw console.error("ImportExportService: Error exporting conversations",t),Te.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportFullConfiguration(t){try{const n=await bt.getAllDataForExport(t),r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),a=`litechat_full_config_${jd(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Gp(s,a),Te.success("Full configuration exported successfully.")}catch(n){throw console.error("ImportExportService: Error exporting full configuration",n),Te.error(`Export failed: ${n instanceof Error?n.message:String(n)}`),n}}static async exportPromptTemplates(){try{const n=(await bt.loadPromptTemplates()).filter(l=>!l.type||l.type==="prompt"),r={version:1,exportedAt:new Date().toISOString(),promptTemplates:n},s=JSON.stringify(r,null,2),i=new Blob([s],{type:"application/json"}),o=`litechat_prompt_templates_${jd(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Gp(i,o),Te.success(`Exported ${n.length} prompt templates.`)}catch(t){throw console.error("ImportExportService: Error exporting prompt templates",t),Te.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportAgents(){try{const t=await bt.loadPromptTemplates(),n=t.filter(u=>u.type==="agent"),r=n.map(u=>u.id),s=t.filter(u=>u.type==="task"&&u.parentId&&r.includes(u.parentId)),i={version:1,exportedAt:new Date().toISOString(),agents:[...n,...s]},a=JSON.stringify(i,null,2),o=new Blob([a],{type:"application/json"}),c=`litechat_agents_${jd(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Gp(o,c),Te.success(`Exported ${n.length} agents with ${s.length} tasks.`)}catch(t){throw console.error("ImportExportService: Error exporting agents",t),Te.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async exportMcpServers(){try{const t=await bt.loadSetting("mcpServers",[]),n={version:1,exportedAt:new Date().toISOString(),mcpServers:t},r=JSON.stringify(n,null,2),s=new Blob([r],{type:"application/json"}),a=`litechat_mcp_servers_${jd(new Date,"yyyy-MM-dd_HH-mm-ss")}.json`;Gp(s,a),Te.success(`Exported ${t.length} MCP server configurations.`)}catch(t){throw console.error("ImportExportService: Error exporting MCP servers",t),Te.error(`Export failed: ${t instanceof Error?t.message:String(t)}`),t}}static async importFullConfiguration(t,n){try{const r=await t.text(),s=JSON.parse(r);if(!s||typeof s!="object"||!s.version)throw new Error("Invalid import file format. Missing version or basic structure.");await bt.importAllData(s,n),Te.success("Configuration imported successfully. Reloading application..."),setTimeout(()=>window.location.reload(),1500)}catch(r){throw console.error("ImportExportService: Error importing full configuration",r),Te.error(`Full import failed: ${r instanceof Error?r.message:String(r)}`),r}}static async importPromptTemplates(t){try{const n=await t.text(),r=JSON.parse(n);if(!r||typeof r!="object"||!r.promptTemplates||!Array.isArray(r.promptTemplates))throw new Error("Invalid prompt templates file format.");let s=0;for(const i of r.promptTemplates)try{await bt.savePromptTemplate({...i,id:i.id||qr(),createdAt:i.createdAt?new Date(i.createdAt):new Date,updatedAt:new Date}),s++}catch(a){console.warn(`Failed to import template ${i.name}:`,a)}Te.success(`Imported ${s} prompt templates.`)}catch(n){throw console.error("ImportExportService: Error importing prompt templates",n),Te.error(`Import failed: ${n instanceof Error?n.message:String(n)}`),n}}static async importAgents(t){try{const n=await t.text(),r=JSON.parse(n);if(!r||typeof r!="object"||!r.agents||!Array.isArray(r.agents))throw new Error("Invalid agents file format.");let s=0,i=0;for(const a of r.agents)try{await bt.savePromptTemplate({...a,id:a.id||qr(),createdAt:a.createdAt?new Date(a.createdAt):new Date,updatedAt:new Date}),a.type==="agent"?s++:a.type==="task"&&i++}catch(o){console.warn(`Failed to import ${a.type} ${a.name}:`,o)}Te.success(`Imported ${s} agents with ${i} tasks.`)}catch(n){throw console.error("ImportExportService: Error importing agents",n),Te.error(`Import failed: ${n instanceof Error?n.message:String(n)}`),n}}static async importMcpServers(t){try{const n=await t.text(),r=JSON.parse(n);if(!r||typeof r!="object"||!r.mcpServers||!Array.isArray(r.mcpServers))throw new Error("Invalid MCP servers file format.");await bt.saveSetting("mcpServers",r.mcpServers),Te.success(`Imported ${r.mcpServers.length} MCP server configurations.`)}catch(n){throw console.error("ImportExportService: Error importing MCP servers",n),Te.error(`Import failed: ${n instanceof Error?n.message:String(n)}`),n}}}const au="sync_repos",ds={repoChanged:"sync.repo.changed",repoInitStatusChanged:"sync.repo.init.status.changed",bulkSyncStarted:"sync.bulk.sync.started",bulkSyncProgress:"sync.bulk.sync.progress",bulkSyncCompleted:"sync.bulk.sync.completed",bulkSyncFailed:"sync.bulk.sync.failed"},ei=Wo(Ho((e,t)=>({nodes:{},childrenMap:{"":[]},rootId:null,currentParentId:null,selectedFileIds:new Set,loading:!1,operationLoading:!1,error:null,fs:null,enableVfs:!0,vfsKey:null,configuredVfsKey:null,initializingKey:null,_setLoading:n=>{e(r=>{r.loading=n,n&&(r.error=null)}),Re.emit(hn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setOperationLoading:n=>{e(r=>{r.operationLoading=n}),Re.emit(hn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_setError:n=>{e(r=>{r.error=n,r.loading=!1,r.operationLoading=!1,r.initializingKey=null,n&&Te.error(`VFS Error: ${n}`)}),Re.emit(hn.loadingStateChanged,{isLoading:t().loading,operationLoading:t().operationLoading,error:t().error})},_addNodes:n=>{e(r=>{const s={};n.forEach(i=>{r.nodes[i.id]=i;const a=i.parentId??r.rootId??"";s[a]||(s[a]=r.childrenMap[a]?[...r.childrenMap[a]]:[]),s[a].includes(i.id)||s[a].push(i.id)});for(const i in s)(!r.childrenMap[i]||JSON.stringify(r.childrenMap[i].sort())!==JSON.stringify(s[i].sort()))&&(r.childrenMap[i]=s[i])}),Re.emit(hn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_updateNode:(n,r)=>{e(s=>{s.nodes[n]&&Object.assign(s.nodes[n],r)}),Re.emit(hn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap})},_removeNodes:n=>{e(r=>{n.forEach(s=>{const i=r.nodes[s];if(i){const a=i.parentId??r.rootId??"";if(r.childrenMap[a]&&(r.childrenMap[a]=r.childrenMap[a].filter(o=>o!==s)),delete r.nodes[s],r.selectedFileIds.delete(s),i.type==="folder"){const o=Object.values(r.nodes).filter(l=>l.parentId===s).map(l=>l.id);o.length>0&&t()._removeNodes(o),delete r.childrenMap[s]}}})}),Re.emit(hn.nodesUpdated,{vfsKey:t().vfsKey,nodes:t().nodes,childrenMap:t().childrenMap}),Re.emit(hn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},_setFsInstance:n=>{e({fs:n}),Re.emit(hn.fsInstanceChanged,{fsInstance:n})},_setEnableVfs:n=>{console.log(`[VfsStore] Setting global enableVfs to: ${n}`),e({enableVfs:n}),Re.emit(hn.vfsEnabledChanged,{enabled:n}),n||(e({fs:null,configuredVfsKey:null,vfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,initializingKey:null}),Re.emit(hn.vfsKeyChanged,{vfsKey:null,configuredVfsKey:null}))},_setConfiguredVfsKey:n=>{e({configuredVfsKey:n}),Re.emit(hn.vfsKeyChanged,{vfsKey:t().vfsKey,configuredVfsKey:n})},setVfsKey:n=>{if(n!==null){const r=t().vfsKey,s=t().configuredVfsKey;if(n===r){n&&n!==s&&!t().initializingKey&&t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during re-initialization trigger for ${n}:`,i)});return}console.log(`[VfsStore] setVfsKey: Changing desired key from ${r} to ${n}. Configured: ${s}`),e({vfsKey:n}),e({fs:null,configuredVfsKey:null,rootId:null,currentParentId:null,nodes:{},childrenMap:{"":[]},error:null,loading:!1,operationLoading:!1,selectedFileIds:new Set,initializingKey:null}),Re.emit(hn.vfsKeyChanged,{vfsKey:n,configuredVfsKey:null}),n!==null&&t().initializeVFS(n).catch(i=>{console.error(`[VfsStore] Error during initialization trigger for ${n}:`,i)})}},initializeVFS:async(n,r)=>{let s,i;if(typeof n=="object"&&n!==null&&"vfsKey"in n)console.warn("[VfsStore] initializeVFS called with a single object payload. Correcting. Input:",JSON.parse(JSON.stringify(n))),s=String(n.vfsKey),i=n.options;else if(typeof n=="string")s=n,i=r;else{const h=`[VfsStore] initializeVFS called with invalid vfsKey type. Type: ${typeof n}, Value: "${String(n)}". Aborting.`;throw console.error(h,n),new Error("VFS key must be a string and cannot be empty.")}if(!s||s.trim()===""){const h=`[VfsStore] initializeVFS: Derived vfsKey is empty or invalid. Original param: ${String(n)}, Derived key: "${s}". Aborting.`;throw console.error(h,{originalVfsKeyParam:n,originalOptionsParam:r}),new Error("VFS key cannot be empty after processing.")}const a=(i==null?void 0:i.force)===!0;if(t().initializingKey===s){const h=`Initialization skipped for "${s}". Already actively initializing this exact key.`;return console.warn(`[VfsStore] ${h}`),new Promise((m,y)=>{const b=setInterval(()=>{const v=t();v.initializingKey!==s&&(clearInterval(b),v.configuredVfsKey===s&&v.fs?m(v.fs):y(new Error(`VFS initialization for "${s}" failed or was interrupted`)))},100);setTimeout(()=>{clearInterval(b),y(new Error(`Timeout waiting for VFS "${s}" initialization to complete`))},1e4)})}if(t().configuredVfsKey===s&&t().fs)return a||e({loading:!1}),t().fs;if(!a){if(t().vfsKey!==s){const h=`UI Initialization aborted for "${s}". Desired key is now "${t().vfsKey}".`;throw console.warn(`[VfsStore] ${h}`),new Error(h)}if(t().initializingKey!==null&&t().initializingKey!==s){const h=`UI Initialization skipped for "${s}". Already initializing a different key "${t().initializingKey}".`;throw console.warn(`[VfsStore] ${h}`),new Error(h)}}const{_setLoading:o,_setError:l,_addNodes:c,_setFsInstance:u,_setConfiguredVfsKey:d}=t();console.log(`[VfsStore] Initializing VFS with key: ${s} (Forced: ${a})`),e({initializingKey:s}),a||(o(!0),l(null));try{const h=await kTe(s);if(!h)throw new Error("Filesystem backend initialization failed.");if(!a&&t().vfsKey!==s){const b=`UI Initialization for key "${s}" completed, but desired key changed to "${t().vfsKey}". Discarding result.`;throw console.warn(`[VfsStore] ${b}`),e({initializingKey:null,loading:!1}),new Error(b)}if(a)return u(h),d(s),e({initializingKey:null}),Re.emit(hn.loadingStateChanged,{isLoading:!1,operationLoading:!1,error:null}),h;u(h),d(s),console.log(`[VfsStore] UI VFS instance configured for key: ${s}`);const m="vfs-root";let y=t().nodes[m];try{await h.promises.stat("/")}catch(b){if(b.code==="ENOENT")console.warn("[VfsStore] Root directory '/' not found, will be created implicitly.");else throw b}if(!y||y.path!=="/"){const b=Date.now();y={id:m,parentId:null,name:"",path:"/",type:"folder",createdAt:b,lastModified:b},c([y])}return e(b=>{b.rootId=y.id,b.currentParentId=y.id}),await t().fetchNodes(y.id),h}catch(h){const m=`Failed to initialize VFS (${s}): ${h instanceof Error?h.message:String(h)}`;throw console.error(`[VfsStore DEBUG] Error in initializeVFS catch block: ${m}`,h),t().initializingKey===s&&(l(m),a||(u(null),d(null))),new Error(m)}finally{t().initializingKey===s&&(e({initializingKey:null}),a||e({loading:!1}))}},fetchNodes:async(n=null)=>{const{_setLoading:r,_setError:s,_addNodes:i,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u,initializingKey:d}=t();if(!a||c!==u||d){console.warn(`[VfsStore] fetchNodes skipped. Ready: ${!!a}, Match: ${c===u}, Init: ${d}`);return}r(!0);try{const h=n?o[n]:o[l||""],m=h?h.path:"/",y=await SD(m,{fsInstance:a}),b=n??l??"",v=new Set(y.map(C=>C.path)),S=(t().childrenMap[b]||[]).map(C=>t().nodes[C]).filter(Boolean).filter(C=>!v.has(C.path)).map(C=>C.id);S.length>0&&t()._removeNodes(S);const k=y.map(C=>{const T=Object.values(t().nodes).find(N=>N.path===C.path),A=Date.now();return{id:(T==null?void 0:T.id)||qr(),parentId:n,name:C.name,path:C.path,type:C.isDirectory?"folder":"file",size:C.size,createdAt:(T==null?void 0:T.createdAt)??A,lastModified:C.lastModified.getTime(),mimeType:C.isDirectory?void 0:C.mimeType}});k.length>0&&i(k),e(C=>{const T=k.map(A=>A.id);(!C.childrenMap[b]||JSON.stringify(C.childrenMap[b].sort())!==JSON.stringify(T.sort()))&&(C.childrenMap[b]=T)})}catch(h){console.error("Failed to fetch VFS nodes:",h),s("Failed to load directory contents.")}finally{r(!1)}},findNodeByPath:n=>{const r=Ur(n);if(t().vfsKey===t().configuredVfsKey){if(r==="/"){const s=t().rootId;return s?t().nodes[s]:void 0}return Object.values(t().nodes).find(s=>s.path===r)}},setCurrentPath:async n=>{const{findNodeByPath:r,fetchNodes:s,rootId:i,fs:a}=t();if(!a||t().vfsKey!==t().configuredVfsKey)return;const o=Ur(n),l=r(o);l&&l.type==="folder"?(e(c=>{c.currentParentId=l.id}),t().childrenMap[l.id]||await s(l.id)):o==="/"&&i?(e(c=>{c.currentParentId=i}),t().childrenMap[i]||await s(i)):console.warn(`Path not found or not a directory: ${n}`)},createDirectory:async(n,r)=>{const{_setOperationLoading:s,_setError:i,fs:a,nodes:o,rootId:l,_addNodes:c,configuredVfsKey:u,vfsKey:d}=t();if(!a||u!==d){i("Filesystem not ready.");return}if(!r.trim()){i("Directory name cannot be empty.");return}s(!0);try{const h=n?o[n]:o[l||""],m=h?h.path:"/",y=Fj(m,r.trim());try{throw await a.promises.stat(y),new Error(`"${r.trim()}" already exists.`)}catch(w){if(w.code!=="ENOENT")throw w}await MZ(y,{fsInstance:a});const b=Date.now(),x={id:qr(),parentId:n,name:r.trim(),path:y,type:"folder",createdAt:b,lastModified:b};c([x])}catch(h){console.error("Failed to create directory:",h),i(h.message||"Failed to create directory.")}finally{s(!1)}},uploadFiles:async(n,r)=>{const{_setOperationLoading:s,_setError:i,fs:a,nodes:o,rootId:l,configuredVfsKey:c,vfsKey:u}=t();if(!a||c!==u){i("Filesystem not ready.");return}s(!0);try{const d=n?o[n]:o[l||""],h=d?d.path:"/";await IZ(Array.from(r),h,{fsInstance:a}),await t().fetchNodes(n)}catch(d){console.error("Failed to upload files:",d),i("Failed to upload one or more files.")}finally{s(!1)}},deleteNodes:async n=>{const{_setOperationLoading:r,_setError:s,_removeNodes:i,fs:a,configuredVfsKey:o,vfsKey:l}=t();if(!a||o!==l){s("Filesystem not ready.");return}r(!0);try{const c=n.map(u=>t().nodes[u]).filter(Boolean);for(const u of c)await CD(u.path,u.type==="folder",{fsInstance:a});i(n)}catch(c){console.error("Failed to delete nodes:",c),s("Failed to delete one or more items."),await t().fetchNodes(t().currentParentId)}finally{r(!1)}},renameNode:async(n,r)=>{const{_setOperationLoading:s,_setError:i,_updateNode:a,nodes:o,fs:l,rootId:c,configuredVfsKey:u,vfsKey:d}=t();if(!l||u!==d){i("Filesystem not ready.");return}if(!r.trim()){i("Name cannot be empty.");return}const h=o[n];if(!h){i("Item not found.");return}if(h.name!==r.trim()){s(!0);try{const m=h.parentId?o[h.parentId]:o[c||""],y=m?m.path:"/",b=Fj(y,r.trim());try{throw await l.promises.stat(b),new Error(`"${r.trim()}" already exists.`)}catch(x){if(x.code!=="ENOENT")throw x}await jZ(h.path,b,{fsInstance:l});const v={name:r.trim(),path:b,lastModified:Date.now()};a(n,v)}catch(m){console.error("Failed to rename item:",m),i(m.message||"Failed to rename item.")}finally{s(!1)}}},downloadFile:async n=>{const{nodes:r,fs:s,_setError:i,configuredVfsKey:a,vfsKey:o}=t();if(!s||a!==o)return i("Filesystem not ready."),null;const l=r[n];if(!l||l.type!=="file")return i("File not found."),null;try{const c=await lp(l.path,{fsInstance:s}),u=l.mimeType||"application/octet-stream",d=new Blob([c],{type:u});return{name:l.name,blob:d}}catch(c){return console.error("Failed to download file:",c),i("Failed to retrieve file content."),null}},selectFile:n=>{e(r=>{r.selectedFileIds.add(n)}),Re.emit(hn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},deselectFile:n=>{e(r=>{r.selectedFileIds.delete(n)}),Re.emit(hn.selectionChanged,{selectedFileIds:Array.from(t().selectedFileIds)})},clearSelection:()=>{e(n=>{n.selectedFileIds.clear()}),Re.emit(hn.selectionChanged,{selectedFileIds:[]})},resetStuckInitialization:()=>{console.warn("[VfsStore] Force resetting stuck initialization state"),e({initializingKey:null,loading:!1,operationLoading:!1,error:null})},getRegisteredActionHandlers:()=>{const n="vfsStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:hn.setVfsKeyRequest,handler:i=>r.setVfsKey(i.key),storeId:n},{eventName:hn.initializeVFSRequest,handler:async i=>{await r.initializeVFS(i.vfsKey,i.options)},storeId:n},{eventName:hn.fetchNodesRequest,handler:i=>r.fetchNodes(i.parentId),storeId:n},{eventName:hn.setCurrentPathRequest,handler:i=>r.setCurrentPath(i.path),storeId:n},{eventName:hn.createDirectoryRequest,handler:i=>r.createDirectory(i.parentId,i.name),storeId:n},{eventName:hn.uploadFilesRequest,handler:i=>r.uploadFiles(i.parentId,i.files),storeId:n},{eventName:hn.deleteNodesRequest,handler:i=>r.deleteNodes(i.ids),storeId:n},{eventName:hn.renameNodeRequest,handler:i=>r.renameNode(i.id,i.newName),storeId:n},{eventName:hn.downloadFileRequest,handler:s(r.downloadFile),storeId:n},{eventName:hn.selectFileRequest,handler:i=>r.selectFile(i.fileId),storeId:n},{eventName:hn.deselectFileRequest,handler:i=>r.deselectFile(i.fileId),storeId:n},{eventName:hn.clearSelectionRequest,handler:r.clearSelection,storeId:n},{eventName:hn.setEnableVfsRequest,handler:i=>r._setEnableVfs(i.enabled),storeId:n}]}}))),dPe="/synced_repos",Vn=Wo(Ho((e,t)=>({conversations:[],selectedItemId:null,selectedItemType:null,syncRepos:[],conversationSyncStatus:{},repoInitializationStatus:{},isLoading:!1,error:null,_ensureSyncVfsReady:async()=>(console.log("[ConversationStore] Ensuring Sync VFS is ready..."),ei.getState().initializingKey===au&&(console.warn("[ConversationStore] VFS appears stuck in initializing state, resetting..."),ei.getState().resetStuckInitialization()),new Promise((r,s)=>{let i=null;const a=()=>{Re.off(hn.fsInstanceChanged,o),Re.off(hn.loadingStateChanged,l),i&&(clearTimeout(i),i=null)},o=u=>{ei.getState().configuredVfsKey===au&&u.fsInstance&&(console.log(`[ConversationStore] Sync VFS ready via fsInstanceChanged for key ${au}.`),a(),r(u.fsInstance))},l=u=>{const d=ei.getState();d.configuredVfsKey===au&&(u.error?(console.error(`[ConversationStore] Sync VFS initialization error for key ${au}: ${u.error}`),a(),s(new Error(u.error))):!u.isLoading&&!u.operationLoading&&d.fs&&(console.log(`[ConversationStore] Sync VFS ready via loadingStateChanged for key ${au}.`),a(),r(d.fs)))};Re.on(hn.fsInstanceChanged,o),Re.on(hn.loadingStateChanged,l);const c=ei.getState();if(c.configuredVfsKey===au&&c.fs&&!c.loading&&!c.operationLoading&&!c.error){console.log(`[ConversationStore] Sync VFS already ready for key ${au}.`),a(),r(c.fs);return}i=setTimeout(()=>{const u=`Timeout waiting for Sync VFS (${au}) to become ready.`;console.error(`[ConversationStore] ${u}`),a(),s(new Error(u))},3e4),Re.emit(hn.initializeVFSRequest,{vfsKey:au,options:{force:!0}})})),loadConversations:async()=>{e({isLoading:!0,error:null});try{const[n,r]=await Promise.all([bt.loadConversations(),bt.loadSyncRepos()]),s={};n.forEach(i=>{if(i.syncRepoId){const a=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,o=i.updatedAt instanceof Date?i.updatedAt.getTime():null;a?o&&o>a?s[i.id]="needs-sync":s[i.id]="idle":s[i.id]="needs-sync"}else s[i.id]="idle"}),e({conversations:n,syncRepos:r,conversationSyncStatus:s,repoInitializationStatus:{},isLoading:!1}),Re.emit(er.conversationsLoaded,{conversations:n}),Re.emit(er.syncReposLoaded,{repos:r})}catch(n){console.error("ConversationStore: Error loading conversations",n),e({error:"Failed load conversations",isLoading:!1}),Re.emit(er.loadingStateChanged,{isLoading:!1,error:"Failed load conversations"})}},addConversation:async n=>{const r=qr(),s=new Date,i={id:r,createdAt:s,updatedAt:s,title:n.title,projectId:n.projectId??null,metadata:{...n.metadata??{},enabledTools:[],toolMaxStepsOverride:null},syncRepoId:n.syncRepoId??null,lastSyncedAt:n.lastSyncedAt??null};let a=!1;try{const o=JSON.stringify(i);return await bt.saveConversation(JSON.parse(o)),a=!0,e(l=>{l.conversations.some(c=>c.id===i.id)||(l.conversations.unshift(i),l.conversationSyncStatus[r]=i.syncRepoId?"needs-sync":"idle")}),Re.emit(er.conversationAdded,{conversation:i}),r}catch(o){throw console.error("ConversationStore: Error adding conversation",o),a&&e(l=>({error:"Failed to save new conversation to state",conversations:l.conversations.filter(c=>c.id!==r),conversationSyncStatus:Object.fromEntries(Object.entries(l.conversationSyncStatus).filter(([c])=>c!==r))})),o}},updateConversation:async(n,r)=>{const s=t().getConversationById(n);if(!s){console.warn(`ConversationStore: Conversation ${n} not found for update.`);return}e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){const l=a.conversations[o].metadata??{},c=r.metadata??{},u={...l,...c};Object.assign(a.conversations[o],{...r,metadata:u,updatedAt:new Date});const d=["title","metadata","projectId"].some(y=>y in r),h=a.conversations[o].lastSyncedAt instanceof Date?a.conversations[o].lastSyncedAt.getTime():null,m=a.conversations[o].updatedAt.getTime();"syncRepoId"in r?a.conversationSyncStatus[n]=r.syncRepoId?"needs-sync":"idle":d&&a.conversations[o].syncRepoId&&a.conversationSyncStatus[n]==="idle"&&(!h||m>h)&&(a.conversationSyncStatus[n]="needs-sync")}});const i=t().getConversationById(n);if(i)try{const a=JSON.parse(JSON.stringify(i));await bt.saveConversation(a),Re.emit(er.conversationUpdated,{conversationId:n,updates:r})}catch(a){throw console.error("ConversationStore: Error updating conversation",a),e(o=>{const l=o.conversations.findIndex(c=>c.id===n);if(l!==-1){o.conversations[l]=s;const c=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,u=s.updatedAt.getTime();o.conversationSyncStatus[n]=s.syncRepoId&&c&&u<=c?"idle":s.syncRepoId?"needs-sync":"idle"}o.error="Failed to save conversation update"}),a}else console.error("ConversationStore: Failed to retrieve updated conversation state after update."),e(a=>{const o=a.conversations.findIndex(l=>l.id===n);if(o!==-1){a.conversations[o]=s;const l=s.lastSyncedAt instanceof Date?s.lastSyncedAt.getTime():null,c=s.updatedAt.getTime();a.conversationSyncStatus[n]=s.syncRepoId&&l&&c<=l?"idle":s.syncRepoId?"needs-sync":"idle"}a.error="Failed to save conversation update (state error)"})},deleteConversation:async n=>{const r=t().selectedItemId,s=t().selectedItemType,i=t().conversations.find(a=>a.id===n);if(i){e(a=>({conversations:a.conversations.filter(o=>o.id!==n),selectedItemId:r===n&&s==="conversation"?null:r,selectedItemType:r===n&&s==="conversation"?null:s,conversationSyncStatus:Object.fromEntries(Object.entries(a.conversationSyncStatus).filter(([o])=>o!==n))}));try{await bt.deleteConversation(n),await bt.deleteInteractionsForConversation(n),Re.emit(er.conversationDeleted,{conversationId:n}),r===n&&s==="conversation"&&(Re.emit(En.setCurrentConversationIdRequest,{id:null}),Re.emit(er.selectedItemChanged,{itemId:null,itemType:null}))}catch(a){throw console.error("ConversationStore: Error deleting conversation",a),e(o=>{if(i){o.conversations.push(i);const l=i.lastSyncedAt instanceof Date?i.lastSyncedAt.getTime():null,c=i.updatedAt.getTime();o.conversationSyncStatus[n]=i.syncRepoId&&l&&c<=l?"idle":i.syncRepoId?"needs-sync":"idle"}r===n&&s==="conversation"&&(o.selectedItemId=n,o.selectedItemType="conversation"),o.error="Failed to delete conversation"}),a}}},selectItem:async(n,r)=>{const s=t().selectedItemId,i=t().selectedItemType;if(s===n&&i===r)return;console.log(`ConversationStore: Selecting item. ID: ${n}, Type: ${r}. Previous: ${s} (${i})`);const a=r==="conversation"?n:null;a&&(Re.emit(En.setCurrentConversationIdRequest,{id:a}),Re.emit(En.loadInteractionsRequest,{conversationId:a})),e({selectedItemId:n,selectedItemType:r}),Re.emit(er.selectedItemChanged,{itemId:n,itemType:r})},importConversation:async n=>{await E0.importConversation(n,t().addConversation,t().selectItem)},exportConversation:async(n,r)=>{await E0.exportConversation(n,r)},exportProject:async n=>{await E0.exportProject(n)},exportAllConversations:async()=>{await E0.exportAllConversations()},loadSyncRepos:async()=>{if(!t().isLoading){e({isLoading:!0,error:null});try{const n=await bt.loadSyncRepos();e({syncRepos:n,isLoading:!1}),Re.emit(er.syncReposLoaded,{repos:n})}catch(n){console.error("ConversationStore: Error loading sync repos",n),e({error:"Failed load sync repositories",isLoading:!1}),Re.emit(er.loadingStateChanged,{isLoading:!1,error:"Failed load sync repositories"})}}},addSyncRepo:async n=>{const r=qr(),s=new Date,i={id:r,createdAt:s,updatedAt:s,name:n.name,remoteUrl:n.remoteUrl,branch:n.branch||"main",username:n.username??null,password:n.password??null};e(a=>{a.syncRepos.push(i)});try{const a=t().syncRepos.find(o=>o.id===r);if(a){const o=JSON.parse(JSON.stringify(a));await bt.saveSyncRepo(o),Re.emit(ds.repoChanged,{repoId:r,action:"added"})}else throw new Error("Failed to retrieve newly added sync repo state");Te.success(`Sync repository "${i.name}" added.`);try{await t().initializeOrSyncRepo(r)}catch(o){console.warn(`Failed to automatically initialize repository "${i.name}":`,o),Te.warning(`Repository "${i.name}" added but initialization failed. You can manually sync it later.`)}return r}catch(a){throw console.error("ConversationStore: Error adding sync repo",a),e(o=>({error:"Failed to save sync repository",syncRepos:o.syncRepos.filter(l=>l.id!==r)})),a}},updateSyncRepo:async(n,r)=>{const s=t().syncRepos.find(a=>a.id===n);if(!s){console.warn(`ConversationStore: SyncRepo ${n} not found.`);return}e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&Object.assign(a.syncRepos[o],{...r,branch:r.branch||a.syncRepos[o].branch||"main",updatedAt:new Date})});const i=t().syncRepos.find(a=>a.id===n);if(i)try{const a=JSON.parse(JSON.stringify(i));await bt.saveSyncRepo(a),Re.emit(ds.repoChanged,{repoId:n,action:"updated"}),Te.success(`Sync repository "${i.name}" updated.`)}catch(a){throw console.error("ConversationStore: Error updating sync repo",a),e(o=>{const l=o.syncRepos.findIndex(c=>c.id===n);l!==-1&&(o.syncRepos[l]=s),o.error="Failed to save sync repository update"}),a}else console.error("ConversationStore: Failed to retrieve updated sync repo state after update."),e(a=>{const o=a.syncRepos.findIndex(l=>l.id===n);o!==-1&&(a.syncRepos[o]=s),a.error="Failed to save sync repository update (state error)"})},deleteSyncRepo:async n=>{const r=t().syncRepos.find(s=>s.id===n);if(r)try{let s;try{s=await t()._ensureSyncVfsReady()}catch(a){throw console.error("ConversationStore: Failed to initialize sync VFS for deletion",a),Te.error("Failed to initialize filesystem for deletion. Repository not deleted."),a}await bt.deleteSyncRepo(n);const i=Ur(`${dPe}/${n}`);try{await CD(i,!0,{fsInstance:s}),console.log(`[ConversationStore] Successfully deleted VFS directory: ${i}`)}catch(a){console.error(`[ConversationStore] Failed to delete VFS directory ${i}:`,a),a.code!=="ENOENT"&&console.warn(`Could not remove local sync folder for "${r.name}": ${a.message}`)}e(a=>({syncRepos:a.syncRepos.filter(o=>o.id!==n),repoInitializationStatus:Object.fromEntries(Object.entries(a.repoInitializationStatus).filter(([o])=>o!==n))})),Re.emit(ds.repoChanged,{repoId:n,action:"deleted"}),Te.success(`Sync repository "${r.name}" deleted.`)}catch(s){throw console.error("ConversationStore: Error deleting sync repo",s),e(i=>{i.error="Failed to delete sync repository"}),s}},linkConversationToRepo:async(n,r)=>{await t().updateConversation(n,{syncRepoId:r,lastSyncedAt:null}),t()._setConversationSyncStatus(n,r?"needs-sync":"idle"),Te.info(`Conversation ${r?"linked to":"unlinked from"} sync repository.`)},_setConversationSyncStatus:(n,r,s=null)=>{e(i=>{i.conversationSyncStatus[n]=r,r==="error"&&s&&console.error(`Sync error for ${n}: ${s}`)}),Re.emit(er.conversationSyncStatusChanged,{conversationId:n,status:r})},_setRepoInitializationStatus:(n,r)=>{e(s=>{s.repoInitializationStatus[n]=r}),Re.emit(ds.repoInitStatusChanged,{repoId:n,status:r})},initializeOrSyncRepo:async(n,r=!1)=>{const s=t().syncRepos.find(a=>a.id===n);if(!s){r||Te.error("Sync repsitory configuration not found.");return}let i;try{i=await t()._ensureSyncVfsReady()}catch{t()._setRepoInitializationStatus(n,"error");return}await lPe(i,s,t()._setRepoInitializationStatus,r)},syncConversation:async(n,r=!1)=>{const s=t().getConversationById(n);if(!s){r||Te.error("Conversation not found for syncing.");return}if(!s.syncRepoId){r||Te.info("Conversation not linked to a sync repository.");return}const i=t().syncRepos.find(l=>l.id===s.syncRepoId);if(!i){r||Te.error("Sync repository configuration not found."),t()._setConversationSyncStatus(n,"error","Repo not found");return}let a;try{a=await t()._ensureSyncVfsReady()}catch{t()._setConversationSyncStatus(n,"error","Filesystem not ready");return}await cPe(a,s,i,t()._setConversationSyncStatus,t().updateConversation,()=>t().selectedItemId,()=>t().selectedItemType,r);const o=t().getConversationById(n);o&&e(l=>{const c=l.conversations.findIndex(u=>u.id===n);c!==-1&&(l.conversations[c]=o)})},getConversationById:n=>{if(n)return t().conversations.find(r=>r.id===n)},syncAllConversations:async()=>{const{BulkSyncService:n}=await Dr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>U0);return{BulkSyncService:r}},void 0);await n.syncAll({syncRepos:!1,syncConversations:!0,continueOnError:!0,maxConcurrent:3})},syncPendingConversations:async()=>{const{BulkSyncService:n}=await Dr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>U0);return{BulkSyncService:r}},void 0);await n.syncPendingConversations()},initializeAllRepositories:async()=>{const{BulkSyncService:n}=await Dr(async()=>{const{BulkSyncService:r}=await Promise.resolve().then(()=>U0);return{BulkSyncService:r}},void 0);await n.initializeAllRepositories()},updateCurrentConversationToolSettings:async n=>{const{selectedItemId:r,selectedItemType:s,updateConversation:i}=t();if(s!=="conversation"||!r){console.warn("Cannot update tool settings: No conversation selected.");return}const a=t().getConversationById(r);if(!a){console.warn("Cannot update tool settings: Selected conversation not found.");return}const o=a.metadata??{},l={...o};n.enabledTools!==void 0&&(l.enabledTools=n.enabledTools),n.toolMaxStepsOverride!==void 0&&(l.toolMaxStepsOverride=n.toolMaxStepsOverride),(JSON.stringify(l)!==JSON.stringify(o)||!a.metadata)&&await i(r,{metadata:l})},_unlinkConversationsFromProjects:n=>{const r=new Set(n);e(s=>{s.conversations=s.conversations.map(i=>i.projectId&&r.has(i.projectId)?{...i,projectId:null}:i)})},getRegisteredActionHandlers:()=>{const n="conversationStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:er.loadConversationsRequest,handler:r.loadConversations,storeId:n},{eventName:er.addConversationRequest,handler:s(r.addConversation),storeId:n},{eventName:er.updateConversationRequest,handler:i=>r.updateConversation(i.id,i.updates),storeId:n},{eventName:er.deleteConversationRequest,handler:i=>r.deleteConversation(i.id),storeId:n},{eventName:er.selectItemRequest,handler:i=>r.selectItem(i.id,i.type),storeId:n},{eventName:er.importConversationRequest,handler:i=>r.importConversation(i.file),storeId:n},{eventName:er.exportConversationRequest,handler:i=>r.exportConversation(i.conversationId,i.format),storeId:n},{eventName:er.exportProjectRequest,handler:i=>r.exportProject(i.projectId),storeId:n},{eventName:er.exportAllConversationsRequest,handler:r.exportAllConversations,storeId:n},{eventName:er.loadSyncReposRequest,handler:r.loadSyncRepos,storeId:n},{eventName:er.addSyncRepoRequest,handler:s(r.addSyncRepo),storeId:n},{eventName:er.updateSyncRepoRequest,handler:i=>r.updateSyncRepo(i.id,i.updates),storeId:n},{eventName:er.deleteSyncRepoRequest,handler:i=>r.deleteSyncRepo(i.id),storeId:n},{eventName:er.linkConversationToRepoRequest,handler:i=>r.linkConversationToRepo(i.conversationId,i.repoId),storeId:n},{eventName:er.syncConversationRequest,handler:i=>r.syncConversation(i.conversationId),storeId:n},{eventName:er.initializeOrSyncRepoRequest,handler:i=>r.initializeOrSyncRepo(i.repoId),storeId:n},{eventName:er.updateCurrentConversationToolSettingsRequest,handler:i=>r.updateCurrentConversationToolSettings(i),storeId:n}]}}))),zi={copyInteractionResponseRequest:"canvas.interaction.copy.response.request",regenerateInteractionRequest:"canvas.interaction.regenerate.request",regenerateInteractionWithModelRequest:"canvas.interaction.regenerate.with.model.request",forkConversationRequest:"canvas.interaction.fork.conversation.request",forkConversationWithModelRequest:"canvas.interaction.fork.conversation.with.model.request",forkConversationCompactRequest:"canvas.interaction.fork.conversation.compact.request",raceInteractionRequest:"canvas.interaction.race.request",editResponseRequest:"canvas.interaction.edit.response.request",copyCodeBlockRequest:"canvas.codeblock.copy.request",editCodeBlockRequest:"canvas.codeblock.edit.request"},gh={async submitPrompt(e){var O,B,D,H,P,K;console.log("[ConversationService] submitPrompt called",e);const t=un.getState(),n=yl.getState(),r=Yl.getState(),s=Vn.getState(),i=pr.getState(),a=t.currentConversationId;if(!a){Te.error("Cannot submit prompt: No active conversation."),console.error("[ConversationService] submitPrompt failed: No conversationId.");return}const o=s.getConversationById(a),l=(o==null?void 0:o.projectId)??null,c=n.getEffectiveProjectSettings(l),d=t.interactions.filter(U=>U.conversationId===a).length===0&&i.autoTitleEnabled&&((O=e.metadata)==null?void 0:O.autoTitleEnabledForTurn)===!0&&i.autoTitleModelId,m=t.interactions.filter(U=>U.parentId===null&&U.status==="COMPLETED").sort((U,V)=>U.index-V.index).map(U=>{var V;if(U.type==="message.assistant_regen"&&((V=U.metadata)!=null&&V.regeneratedFromId)){const L=t.interactions.find(te=>te.id===U.metadata.regeneratedFromId);if(L&&L.prompt&&L.type==="message.user_assistant")return{...U,prompt:L.prompt,type:"message.user_assistant"}}return U.type==="message.user_assistant"&&U.prompt?U:null}).filter(Boolean),y=FC(m);let b=e.content;const v=[],x=((B=e.metadata)==null?void 0:B.effectiveRulesContent)??[],w=x.filter(U=>U.type==="system").map(U=>U.content),S=x.filter(U=>U.type==="before").map(U=>U.content),k=x.filter(U=>U.type==="after").map(U=>U.content);S.length>0&&(b=`${S.join(`
`)}

${b}`),k.length>0&&(b=`${b}

    ${k.join(`
`)}`),b&&v.push({type:"text",text:b});const C=((D=e.metadata)==null?void 0:D.attachedFiles)??[];if(C.length>0){const U=await this._processFilesForPrompt(C,a);v.unshift(...U)}v.length>0?y.push({role:"user",content:v}):console.warn("[ConversationService] No user text or file content found in turnData. Submitting without user message.");let A=((H=e.metadata)==null?void 0:H.turnSystemPrompt)??c.systemPrompt??void 0;w.length>0&&(A=`${A?`${A}

        `:""}${w.join(`
`)}`);const N={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...e.parameters??{}};Object.keys(N).forEach(U=>{(N[U]===null||N[U]===void 0)&&delete N[U]});const I={system:A,messages:y,parameters:N,metadata:{...(({turnSystemPrompt:U,activeTagIds:V,activeRuleIds:L,effectiveRulesContent:te,autoTitleEnabledForTurn:W,...Q})=>({...Q,effectivelyAppliedTagIds:V,effectivelyAppliedRuleIds:L}))(e.metadata??{}),modelId:r.modelId??void 0,attachedFiles:(P=e.metadata.attachedFiles)==null?void 0:P.map(({contentBase64:U,contentText:V,...L})=>L)}};try{const U=Sc.startInteraction(I,a,e);if(d){console.log("[ConversationService] Triggering asynchronous title generation.");const V=(((K=e.metadata)==null?void 0:K.effectiveRulesContent)??[]).map(L=>({id:L.sourceRuleId||qr(),name:L.sourceRuleId?`Rule ${L.sourceRuleId.substring(0,4)}`:"Context Rule",content:L.content,type:L.type,createdAt:new Date,updatedAt:new Date}));this.generateConversationTitle(a,e,V).catch(L=>{console.error("[ConversationService] Background title generation failed:",L)})}await U}catch(U){throw console.error("[ConversationService] Error starting interaction:",U),Te.error(`Failed to start interaction: ${U instanceof Error?U.message:String(U)}`),U}},async generateConversationTitle(e,t,n){var o,l;const r=pr.getState();if(!r.autoTitleModelId){console.warn("[ConversationService] Auto-title generation skipped: No model selected in settings.");return}let s=t.content;if(s.length>r.autoTitlePromptMaxLength&&(s=s.substring(0,r.autoTitlePromptMaxLength)+"..."),r.autoTitleIncludeFiles&&((l=(o=t.metadata)==null?void 0:o.attachedFiles)!=null&&l.length)){const c=t.metadata.attachedFiles.map(u=>u.name).join(", ");s+=`

[Attached files: ${c}]`}if(r.autoTitleIncludeRules&&n.length>0){const c=n.map(u=>u.name).join(", ");s+=`

[Active rules: ${c}]`}const i={system:"Generate a concise, descriptive title (max 8-10 words) for the following user prompt. Output ONLY the title text, nothing else.",messages:[{role:"user",content:s}],parameters:{temperature:.5,max_tokens:20},metadata:{modelId:r.autoTitleModelId,isTitleGeneration:!0},tools:void 0,toolChoice:"none"},a={id:qr(),content:`[Generate title based on: ${t.content.substring(0,50)}...]`,parameters:i.parameters,metadata:{...i.metadata,originalTurnId:t.id}};try{await Sc.startInteraction(i,e,a,"conversation.title_generation")}catch(c){console.error("[ConversationService] Error starting title generation interaction:",c)}},async regenerateInteraction(e){var D,H,P,K;console.log(`[ConversationService] regenerateInteraction called for ID: ${e}`);const t=un.getState(),n=yl.getState(),r=Yl.getState(),s=Vn.getState(),i=t.interactions.find(U=>U.id===e);if(console.log("[ConversationService] Target interaction for regen:",JSON.parse(JSON.stringify(i))),!i||!i.prompt){Te.error("Cannot regenerate: Original interaction data missing.");return}const a=null,o=i.index,l=i.prompt,c=i.conversationId,u=s.getConversationById(c),d=(u==null?void 0:u.projectId)??null,h=n.getEffectiveProjectSettings(d),m=i.index,y=t.interactions.filter(U=>U.conversationId===c&&U.index<m&&U.status==="COMPLETED"&&U.type==="message.user_assistant"&&U.parentId===null).sort((U,V)=>U.index-V.index),b=FC(y);let v=l.content;const x=[],w=((D=l.metadata)==null?void 0:D.effectiveRulesContent)??[],S=w.filter(U=>U.type==="system").map(U=>U.content),k=w.filter(U=>U.type==="before").map(U=>U.content),C=w.filter(U=>U.type==="after").map(U=>U.content);k.length>0&&(v=`${k.join(`
`)}

${v}`),C.length>0&&(v=`${v}

    ${C.join(`
`)}`),v&&x.push({type:"text",text:v});const T=((H=l.metadata)==null?void 0:H.attachedFiles)??[];if(T.length>0){const U=await this._processFilesForPrompt(T,c);x.unshift(...U)}x.length>0?b.push({role:"user",content:x}):console.warn("[ConversationService] No user text or file content found in original turnData for regeneration.");let N=((P=l.metadata)==null?void 0:P.turnSystemPrompt)??h.systemPrompt??void 0;S.length>0&&(N=`${N?`${N}

        `:""}${S.join(`
`)}`);const I={temperature:r.temperature,max_tokens:r.maxTokens,top_p:r.topP,top_k:r.topK,presence_penalty:r.presencePenalty,frequency_penalty:r.frequencyPenalty,...l.parameters??{}};Object.keys(I).forEach(U=>{(I[U]===null||I[U]===void 0)&&delete I[U]});const O={system:N,messages:b,parameters:I,metadata:{...(({turnSystemPrompt:U,activeTagIds:V,activeRuleIds:L,effectiveRulesContent:te,autoTitleEnabledForTurn:W,...Q})=>({...Q,effectivelyAppliedTagIds:V,effectivelyAppliedRuleIds:L}))(l.metadata??{}),modelId:r.modelId??void 0,regeneratedFromId:e,attachedFiles:T.map(({contentBase64:U,contentText:V,...L})=>L)}};let B=null;try{if(B=await Sc.startInteraction(O,c,l,"message.assistant_regen"),!B)throw new Error("Failed to create new interaction for regeneration.");const U={};let V=!1;B.index!==o&&(U.index=o,V=!0),B.parentId!==a&&(U.parentId=a,V=!0);let L=B;V&&(t._updateInteractionInState(B.id,U),L={...B,...U},await bt.saveInteraction(L)),console.log("[ConversationService] New active interaction state after potential updates:",JSON.parse(JSON.stringify(L)));const te=[];let W=i;for(;W;){te.push(W);const ee=(K=W.metadata)==null?void 0:K.regeneratedFromId;ee?W=t.interactions.find(re=>re.id===ee):W=null}const Q=te.sort((ee,re)=>{var Oe,Fe;const pe=((Oe=ee.startedAt)==null?void 0:Oe.getTime())??0,de=((Fe=re.startedAt)==null?void 0:Fe.getTime())??0;return pe-de});for(let ee=0;ee<Q.length;ee++){const re=Q[ee],pe={parentId:L.id,index:ee};console.log(`[ConversationService] Updating old version ${re.id} to be child of ${L.id} with childIndex ${ee}`,JSON.parse(JSON.stringify(pe))),t._updateInteractionInState(re.id,pe),await bt.saveInteraction({...re,...pe})}}catch(U){throw console.error("[ConversationService] Error during regeneration process:",U),Te.error(`Failed to regenerate response: ${U instanceof Error?U.message:String(U)}`),U}},_pendingForks:new Set,_pendingCompactForks:new Set,async forkConversation(e){if(console.log(`[ConversationService] forkConversation called for ID: ${e}`),this._pendingForks.has(e)){console.warn(`[ConversationService] Fork already in progress for ${e}`),Te.info("Fork already in progress for this interaction.");return}this._pendingForks.add(e);try{const t=un.getState(),n=Vn.getState(),r=t.interactions.find(l=>l.id===e);if(!r){Te.error("Cannot fork: Interaction not found.");return}const s=n.getConversationById(r.conversationId);if(!s){Te.error("Cannot fork: Original conversation not found.");return}const i=t.interactions.filter(l=>l.conversationId===r.conversationId&&l.index<=r.index&&l.parentId===null&&(l.type==="message.user_assistant"||l.type==="message.assistant_regen")).sort((l,c)=>l.index-c.index),a=`Fork: ${s.title}`,o=await n.addConversation({title:a,projectId:s.projectId,metadata:s.metadata});for(let l=0;l<i.length;l++){const c=i[l],u={...c,id:qr(),conversationId:o,index:l,parentId:null,startedAt:new Date,endedAt:c.endedAt?new Date:null,metadata:{...c.metadata,forkedFromId:c.id}};await bt.saveInteraction(u)}await n.selectItem(o,"conversation"),Re.emit(sn.focusInputRequest,void 0),Te.success(`Conversation forked successfully: "${a}"`)}catch(t){throw console.error("[ConversationService] Error during fork process:",t),Te.error(`Failed to fork conversation: ${t instanceof Error?t.message:String(t)}`),t}finally{this._pendingForks.delete(e)}},async forkConversationCompact(e,t){if(console.log(`[ConversationService] forkConversationCompact called for ID: ${e} with model: ${t}`),this._pendingCompactForks.has(e)){console.warn(`[ConversationService] Compact fork already in progress for ${e}`),Te.info("Compact fork already in progress for this interaction.");return}this._pendingCompactForks.add(e);try{const n=un.getState(),r=Vn.getState(),s=pr.getState(),i=n.interactions.find(T=>T.id===e);if(!i){Te.error("Cannot fork compact: Interaction not found.");return}const a=r.getConversationById(i.conversationId);if(!a){Te.error("Cannot fork compact: Original conversation not found.");return}const o=n.interactions.filter(T=>T.conversationId===i.conversationId&&T.index<=i.index&&T.parentId===null&&(T.type==="message.user_assistant"||T.type==="message.assistant_regen")).sort((T,A)=>T.index-A.index),l=FC(o),c=T=>typeof T=="string"?T:Array.isArray(T)?T.map(A=>A.type==="text"?A.text:A.type==="image"?"[Image attached]":`[${A.type||"Content"} attached]`).join(" "):typeof T=="object"&&T!==null?"text"in T&&typeof T.text=="string"?T.text:"[Non-text content]":String(T),u=l.map(T=>`**${T.role.toUpperCase()}:** ${c(T.content)}`).join(`

`),d=s.forkCompactPrompt,m=d?`${d}

Here is our conversation history to summarize:

${u}`:`Please provide a comprehensive but concise summary of our previous conversation. Include:
1. The main topics discussed
2. Key decisions or conclusions reached
3. Important context that would be needed to continue the conversation
4. Any specific technical details, code, or data that were mentioned

Keep the summary detailed enough that we can seamlessly continue our discussion, but compact enough to be efficient.

Here is our conversation history to summarize:

${u}`,y=s.forkCompactModelId||t,b={system:"You are an expert at creating comprehensive conversation summaries. Provide a detailed but concise summary that captures all important context and information needed to continue the conversation seamlessly.",messages:[{role:"user",content:m}],parameters:{temperature:.3,max_tokens:2e3},metadata:{modelId:y,isCompactGeneration:!0},tools:void 0,toolChoice:"none"},v=`Compact: ${a.title}`,x=await r.addConversation({title:v,projectId:a.projectId,metadata:a.metadata}),w=`Please provide a comprehensive summary of our previous conversation titled "${a.title}". Include the main topics, key decisions, and important context needed to continue seamlessly.`,S={id:qr(),conversationId:x,type:"message.user_assistant",prompt:{id:qr(),content:w,parameters:{},metadata:{isResumeMessage:!0,originalConversationId:i.conversationId,compactedFromInteractionId:e}},response:"Compacting...",status:"STREAMING",startedAt:new Date,endedAt:null,metadata:{isResumeMessage:!0,originalConversationId:i.conversationId,compactedFromInteractionId:e,isCompactingInProgress:!0},index:0,parentId:null};await bt.saveInteraction(S),un.getState()._addInteractionToState(S),await r.selectItem(x,"conversation"),await new Promise(T=>{const A=N=>{N.conversationId===x&&(Re.off(En.loaded,A),T())};Re.on(En.loaded,A),setTimeout(()=>{Re.off(En.loaded,A),T()},2e3)});const C={id:qr(),content:`[Internal compact generation for conversation ${e}]`,parameters:b.parameters,metadata:{...b.metadata,originalConversationId:i.conversationId,compactedFromInteractionId:e,targetUserInteractionId:S.id,targetConversationId:x}};await Sc.startInteraction(b,x,C,"conversation.compact"),Re.emit(sn.focusInputRequest,void 0),Te.success(`Conversation compacted and forked: "${v}"`)}catch(n){throw console.error("[ConversationService] Error during compact fork process:",n),Te.error(`Failed to fork and compact conversation: ${n instanceof Error?n.message:String(n)}`),n}finally{this._pendingCompactForks.delete(e)}},async _processFilesForPrompt(e,t){const n=[],r=e.filter(i=>i.source==="vfs");let s;if(r.length>0){const i=Vn.getState().getConversationById(t),a=(i==null?void 0:i.projectId)??"orphan";try{s=await this._ensureVfsReady(a)}catch{Te.error(`Filesystem unavailable for key ${a}. VFS files cannot be processed.`),r.forEach(l=>{n.push({type:"text",text:`[Skipped VFS file: ${l.name} - Filesystem unavailable]`})}),s=void 0}}for(const i of e){let a=null;try{if(i.source==="direct")a=M$(i);else if(i.source==="vfs"&&s&&i.path){console.log(`[ConversationService] Fetching VFS file: ${i.path}`);const o=await lp(i.path,{fsInstance:s});a=M$({...i,contentBytes:o})}else if(i.source==="vfs"&&!s)continue;a&&n.push(a)}catch(o){console.error(`[ConversationService] Error processing file ${i.name}:`,o),n.push({type:"text",text:`[Error processing file: ${i.name}]`})}}return n},async _ensureVfsReady(e){return console.log(`[ConversationService] Ensuring VFS ready for key "${e}"...`),new Promise((t,n)=>{const r=o=>{ei.getState().configuredVfsKey===e&&(i(),t(o.fsInstance))},s=o=>{if(ei.getState().configuredVfsKey===e&&!o.isLoading&&!o.operationLoading)if(o.error)i(),n(new Error(o.error));else{const l=ei.getState().fs;l&&(i(),t(l))}},i=()=>{Re.off(hn.fsInstanceChanged,r),Re.off(hn.loadingStateChanged,s)};Re.on(hn.fsInstanceChanged,r),Re.on(hn.loadingStateChanged,s);const a=ei.getState();if(a.configuredVfsKey===e&&a.fs&&!a.loading&&!a.operationLoading&&!a.error){i(),t(a.fs);return}if(a.configuredVfsKey===e&&a.error&&!a.loading&&!a.operationLoading){i(),n(new Error(a.error));return}Re.emit(hn.initializeVFSRequest,{vfsKey:e,options:{force:!0}})})}},Sc={_activeControllers:new Map,_streamingToolData:new Map,_firstChunkTimestamps:new Map,_interactionStartTimes:new Map,_pendingRegenerations:new Set,initializeCanvasEventHandlers(){Re.on(zi.copyInteractionResponseRequest,async e=>{const{interactionId:t}=e,n=un.getState().interactions.find(s=>s.id===t);if(!n){Te.error(`Copy failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Copy request for unknown interaction ${t}`);return}const r=n.response??"";if(typeof r!="string"||r.trim()===""){Te.info("No response content to copy.");return}try{await navigator.clipboard.writeText(r),Te.success("Response copied!")}catch(s){Te.error("Failed to copy response."),console.error("[InteractionService] Error copying response:",s)}}),Re.on(zi.regenerateInteractionRequest,async e=>{const{interactionId:t}=e;if(console.log(`[InteractionService] Received regenerateInteractionRequest for ${t}`),this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const n=un.getState().interactions.find(o=>o.id===t);if(!n){Te.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const r=un.getState();if(r.status==="streaming"){Te.info("Cannot regenerate while another response is streaming.");return}const i=r.interactions.filter(o=>o.conversationId===n.conversationId&&o.parentId===null&&(o.type==="message.user_assistant"||o.type==="message.assistant_regen")).sort((o,l)=>o.index-l.index),a=i.length>0?i[i.length-1]:null;if((a==null?void 0:a.id)!==t){Te.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t),await gh.regenerateInteraction(t)}catch(o){Te.error(`Failed to regenerate response: ${String(o)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,o)}finally{this._pendingRegenerations.delete(t)}}),Re.on(zi.regenerateInteractionWithModelRequest,async e=>{const{interactionId:t,modelId:n}=e;if(this._pendingRegenerations.has(t)){console.warn(`[InteractionService] Regeneration already pending for ${t}. Ignoring request.`);return}const r=un.getState().interactions.find(l=>l.id===t);if(!r){Te.error(`Regeneration failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Regeneration request for unknown interaction ${t}`);return}const s=un.getState();if(s.status==="streaming"){Te.info("Cannot regenerate while another response is streaming.");return}const a=s.interactions.filter(l=>l.conversationId===r.conversationId&&l.parentId===null&&(l.type==="message.user_assistant"||l.type==="message.assistant_regen")).sort((l,c)=>l.index-c.index),o=a.length>0?a[a.length-1]:null;if((o==null?void 0:o.id)!==t){Te.info("Can only regenerate the last response in the conversation.");return}try{this._pendingRegenerations.add(t);const l=Yl.getState(),c=l.modelId;console.log(`[InteractionService] Temporarily setting model to ${n} for regeneration`),l.setModelId(n);try{await gh.regenerateInteraction(t)}finally{console.log(`[InteractionService] Restoring original model ${c}`),l.setModelId(c)}}catch(l){Te.error(`Failed to regenerate response: ${String(l)}`),console.error(`[InteractionService] Error regenerating interaction ${t}:`,l)}finally{this._pendingRegenerations.delete(t)}}),Re.on(zi.raceInteractionRequest,async e=>{const{interactionId:t,modelIds:n,staggerMs:r}=e,s=un.getState().interactions.find(c=>c.id===t);if(!s){Te.error(`Race failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Race request for unknown interaction ${t}`);return}const i=un.getState();if(i.status==="streaming"){Te.info("Cannot start race while another response is streaming.");return}const o=i.interactions.filter(c=>c.conversationId===s.conversationId&&c.parentId===null&&(c.type==="message.user_assistant"||c.type==="message.assistant_regen")).sort((c,u)=>c.index-u.index),l=o.length>0?o[o.length-1]:null;if((l==null?void 0:l.id)!==t){Te.info("Can only race from the last response in the conversation.");return}if(n.length<2){Te.error("Need at least 2 models to race");return}try{const c=Yl.getState(),u=c.modelId;console.log(`[InteractionService] Starting race with ${n.length} models`),Te.info(`Starting race with ${n.length} models...`);const d=n.map((b,v)=>new Promise(x=>{setTimeout(async()=>{try{c.setModelId(b),await gh.regenerateInteraction(t),x({success:!0,modelId:b,index:v})}catch(w){console.error(`[InteractionService] Race participant ${v+1} failed:`,w),x({success:!1,modelId:b,index:v,error:w})}},v*r)})),h=await Promise.all(d);c.setModelId(u);const m=h.filter(b=>b.success).length,y=h.length-m;m>0?Te.success(`Race completed! ${m} models responded${y>0?`, ${y} failed`:""}`):Te.error(`Race failed: All ${n.length} models failed to respond`)}catch(c){Te.error(`Race failed: ${String(c)}`),console.error("[InteractionService] Error during race:",c)}}),Re.on(zi.forkConversationRequest,async e=>{const{interactionId:t}=e;if(console.log(`[InteractionService] Received forkConversationRequest for ${t}`),!un.getState().interactions.find(i=>i.id===t)){Te.error(`Fork failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Fork request for unknown interaction ${t}`);return}if(un.getState().status==="streaming"){Te.info("Cannot fork while another response is streaming.");return}try{await gh.forkConversation(t)}catch(i){Te.error(`Failed to fork conversation: ${String(i)}`),console.error(`[InteractionService] Error forking conversation ${t}:`,i)}}),Re.on(zi.forkConversationWithModelRequest,async e=>{const{interactionId:t,modelId:n}=e;if(console.log(`[InteractionService] Received forkConversationWithModelRequest for ${t} with model ${n}`),!un.getState().interactions.find(a=>a.id===t)){Te.error(`Fork failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Fork request for unknown interaction ${t}`);return}if(un.getState().status==="streaming"){Te.info("Cannot fork while another response is streaming.");return}try{console.log(`[InteractionService] Creating fork conversation first, then setting model to ${n}`),await gh.forkConversation(t),await new Promise(a=>requestAnimationFrame(a)),console.log(`[InteractionService] Setting global model to ${n} for the new forked conversation`),Re.emit(Wn.selectModelRequest,{modelId:n})}catch(a){Te.error(`Failed to fork conversation: ${String(a)}`),console.error(`[InteractionService] Error forking conversation ${t}:`,a)}}),Re.on(zi.forkConversationCompactRequest,async e=>{const{interactionId:t,modelId:n}=e;if(console.log(`[InteractionService] Received forkConversationCompactRequest for ${t} with model ${n}`),!un.getState().interactions.find(a=>a.id===t)){Te.error(`Fork compact failed: Interaction ${t} not found.`),console.warn(`[InteractionService] Fork compact request for unknown interaction ${t}`);return}if(un.getState().status==="streaming"){Te.info("Cannot fork compact while another response is streaming.");return}try{console.log(`[InteractionService] Creating compact fork conversation with model ${n}`),await gh.forkConversationCompact(t,n)}catch(a){Te.error(`Failed to fork and compact conversation: ${String(a)}`),console.error(`[InteractionService] Error forking and compacting conversation ${t}:`,a)}}),Re.on(zi.copyCodeBlockRequest,async e=>{const{content:t,interactionId:n,codeBlockId:r,language:s}=e;if(!t||t.trim()===""){Te.info("No code to copy.");return}try{await navigator.clipboard.writeText(t),Te.success(`Code block ${s?`(${s}) `:""}copied!`),console.log(`[InteractionService] Code block copied. InteractionID: ${n}, CodeBlockID: ${r}, Language: ${s}`)}catch(i){Te.error("Failed to copy code block."),console.error("[InteractionService] Error copying code block:",i)}})},async startInteraction(e,t,n,r="message.user_assistant"){var P,K,U,V,L,te,W,Q,ee,re,pe,de,Oe,Fe;console.log(`[InteractionService] startInteraction called (Type: ${r})`,e,t,n);const s=await U2(cy.INTERACTION_BEFORE_START,{prompt:e,conversationId:t});if(s===!1)return console.log("[InteractionService] Interaction start cancelled by middleware."),null;const i=s&&typeof s=="object"?s.prompt:e,a=n.id||qr(),o=new AbortController;this._activeControllers.set(a,o),this._streamingToolData.set(a,{calls:[],results:[]}),this._firstChunkTimestamps.delete(a),this._interactionStartTimes.delete(a);const l=un.getState(),u=l.interactions.filter(Se=>Se.conversationId===t),d=r==="conversation.title_generation"||r==="conversation.compact"?-1:u.reduce((Se,Ce)=>Math.max(Se,Ce.index),-1)+1,h=null,m=performance.now();this._interactionStartTimes.set(a,m);const y={id:a,conversationId:t,type:r,prompt:{...n},response:null,status:"STREAMING",startedAt:new Date,endedAt:null,metadata:{...n.metadata||{},...i.metadata||{},toolCalls:[],toolResults:[],reasoning:void 0,timeToFirstToken:void 0,generationTime:void 0,isTitleGeneration:r==="conversation.title_generation",isCompactGeneration:r==="conversation.compact"},index:d,parentId:h};r!=="conversation.title_generation"&&r!=="conversation.compact"?(l._addInteractionToState(y),l._addStreamingId(a)):(l._addInteractionToState(y),l._addStreamingId(a),console.log(`[InteractionService] Added ${r} interaction ${a} to state.`)),bt.saveInteraction({...y}).catch(Se=>{console.error(`[InteractionService] Failed initial persistence for ${a}`,Se)}),Re.emit(En.started,{interactionId:a,conversationId:t,type:y.type});const b=(P=i.metadata)==null?void 0:P.modelId;if(!b)return await this._finalizeInteraction(a,"ERROR",new Error("No model ID specified in prompt metadata."),r),null;const{providerId:v,modelId:x}=Ac(b);if(!v||!x)return await this._finalizeInteraction(a,"ERROR",new Error(`Invalid combined model ID format: ${b}`),r),null;const w=Qn.getState().dbProviderConfigs.find(Se=>Se.id===v);if(!w)return await this._finalizeInteraction(a,"ERROR",new Error(`Provider configuration not found for ID: ${v}`),r),null;const S=Qn.getState().getApiKeyForProvider(v),k=lO(w,x,S);if(!k)return await this._finalizeInteraction(a,"ERROR",new Error(`Failed to instantiate model instance ${b} from provider ${w.name}`),r),null;console.log(`[InteractionService] Using model instance for ${b}`);const C=r!=="conversation.title_generation"&&r!=="conversation.compact"?(((K=i.metadata)==null?void 0:K.enabledTools)??[]).reduce((Se,Ce)=>{if(Ce.startsWith("mcp_")){const qe=globalThis.mcpToolsModuleInstance;if(qe&&qe.mcpClients){const Qe=Ce.substring(4).split("_");if(Qe.length>=2){const We=Qe[0],je=Qe.slice(1).join("_");for(const[,Y]of qe.mcpClients)if(Y.name===We&&Y.tools[je]){const ye=Wi.getState().getRegisteredTools(),Ie=`mcp_${We}_${je}`,ce=ye[Ie];if(ce&&ce.definition){const oe={description:ce.definition.description,parameters:ce.definition.parameters,execute:async se=>{if(ce.implementation)return await ce.implementation(se,N$());throw console.error(`[InteractionService] MCP tool ${je} has no implementation`),new Error(`MCP tool ${je} has no implementation`)}};Se[Ce]=oe}else console.warn(`[InteractionService] MCP tool ${Ie} not found in control registry`);break}}}}else{const Qe=Wi.getState().getRegisteredTools()[Ce];if(Qe&&Qe.implementation){const We={description:Qe.definition.description,parameters:Qe.definition.parameters,execute:async je=>{const Y=un.getState().currentConversationId,ye=Y?Vn.getState().getConversationById(Y):null;let Ie;ye&&ye.projectId?typeof ye.projectId=="string"?Ie=ye.projectId:(console.warn(`[InteractionService] conversation.projectId for conversation ${Y} is not a string (type: ${typeof ye.projectId}). Defaulting VFS key to "orphan". Value:`,ye.projectId),Ie="orphan"):Ie="orphan";let ce;try{if(Re.emit(hn.initializeVFSRequest,{vfsKey:Ie,options:{force:!0}}),await new Promise(oe=>setTimeout(oe,100)),ce=ei.getState().fs,ei.getState().configuredVfsKey!==Ie||!ce)throw new Error(`Filesystem for key "${Ie}" not ready after request.`)}catch(oe){throw new Error(`Filesystem error: ${oe.message}`)}try{const oe=N$(),se=Qe.definition.parameters.parse(je),Me=Qe.implementation,Be={...oe,fsInstance:ce};return await Me(se,Be)}catch(oe){throw oe instanceof Oc?new Error(`Invalid arguments: ${oe.errors.map(se=>`${se.path.join(".")} (${se.message})`).join(", ")}`):new Error(oe instanceof Error?oe.message:String(oe))}}};Se[Ce]=We}}return Se},{}):void 0,{getSelectedModel:T}=Qn.getState(),A=T(),N=((V=(U=A==null?void 0:A.metadata)==null?void 0:U.supported_parameters)==null?void 0:V.includes("tools"))??!1,I=(((L=i.metadata)==null?void 0:L.enabledTools)??[]).filter(Se=>Se.startsWith("mcp_")).length,O=(((te=i.metadata)==null?void 0:te.enabledTools)??[]).filter(Se=>!Se.startsWith("mcp_")).length;!N&&(I>0||O>0)&&console.warn(`[InteractionService] Model ${(A==null?void 0:A.name)||"unknown"} does not support tools. Ignoring ${I+O} enabled tools.`);const B=((W=i.parameters)==null?void 0:W.maxSteps)??pr.getState().toolMaxSteps,D={model:k,messages:i.messages,abortSignal:o.signal,system:i.system,temperature:(Q=i.parameters)==null?void 0:Q.temperature,maxTokens:(ee=i.parameters)==null?void 0:ee.max_tokens,topP:(re=i.parameters)==null?void 0:re.top_p,topK:(pe=i.parameters)==null?void 0:pe.top_k,presencePenalty:(de=i.parameters)==null?void 0:de.presence_penalty,frequencyPenalty:(Oe=i.parameters)==null?void 0:Oe.frequency_penalty,maxSteps:B,...N&&C&&Object.keys(C).length>0&&{tools:C},...((Fe=i.parameters)==null?void 0:Fe.providerOptions)&&{providerOptions:i.parameters.providerOptions},...N&&i.toolChoice&&{toolChoice:i.toolChoice}},H={onChunk:Se=>this._handleChunk(a,Se),onReasoningChunk:Se=>this._handleReasoningChunk(a,Se),onToolCall:Se=>this._handleToolCall(a,Se),onToolResult:Se=>this._handleToolResult(a,Se),onFinish:Se=>this._handleFinish(a,Se,r).catch(Ce=>{console.error(`[InteractionService] Error in finish handler for ${a}:`,Ce)}),onError:Se=>this._handleError(a,Se,r).catch(Ce=>{console.error(`[InteractionService] Error in error handler for ${a}:`,Ce)})};return console.log(`[InteractionService] Calling AIService.executeInteraction for ${a}`),aPe.executeInteraction(a,D,H).catch(Se=>{console.error(`[InteractionService] Error during AIService.executeInteraction for ${a}:`,Se);const Ce=un.getState().interactions.find(qe=>qe.id===a);Ce&&Ce.status==="STREAMING"&&this._finalizeInteraction(a,"ERROR",Se instanceof Error?Se:new Error(String(Se)),r).catch(qe=>{console.error("[InteractionService] Error during finalization after execution error:",qe)})}),y},abortInteraction(e){console.log(`[InteractionService] Aborting interaction ${e}`);const t=this._activeControllers.get(e);if(t&&!t.signal.aborted)t.abort(),Te.info("Interaction cancelled.");else{console.warn(`[InteractionService] No active controller found or already aborted for ${e}.`);const n=un.getState(),r=n.interactions.find(s=>s.id===e);n.streamingInteractionIds.includes(e)&&(console.warn(`[InteractionService] Forcing cleanup for potentially stuck interaction ${e}`),this._finalizeInteraction(e,"CANCELLED",new Error("Interaction aborted manually (controller missing)"),(r==null?void 0:r.type)??"message.user_assistant").catch(s=>{console.error("[InteractionService] Error during forced finalization:",s)}))}},async _handleChunk(e,t){this._firstChunkTimestamps.has(e)||this._firstChunkTimestamps.set(e,performance.now());const n={interactionId:e,chunk:t},r=await U2(cy.INTERACTION_PROCESS_CHUNK,n);if(r!==!1){const s=r&&typeof r=="object"&&"chunk"in r?r.chunk:t;un.getState().appendInteractionResponseChunk(e,s),Re.emit(En.streamChunk,{interactionId:e,chunk:s})}},_handleReasoningChunk(e,t){un.getState().appendReasoningChunk(e,t)},_handleToolCall(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.calls.push(n),this._streamingToolData.set(e,r),un.getState()._updateInteractionInState(e,{metadata:{toolCalls:[...r.calls]}})}catch(n){console.error(`[InteractionService] Failed to process tool call for ${e}:`,n)}},_handleToolResult(e,t){try{const n=JSON.stringify(t),r=this._streamingToolData.get(e)||{calls:[],results:[]};r.results.push(n),this._streamingToolData.set(e,r),un.getState()._updateInteractionInState(e,{metadata:{toolResults:[...r.results]}})}catch(n){console.error(`[InteractionService] Failed to process tool result for ${e}:`,n)}},async _handleFinish(e,t,n){console.log(`[InteractionService] Finishing interaction ${e} (Type: ${n}). Reason: ${t.finishReason}`),await this._finalizeInteraction(e,"COMPLETED",void 0,n,t)},async _handleError(e,t,n){console.error(`[InteractionService] Handling error for interaction ${e} (Type: ${n}):`,t);const r=t.name==="AbortError";await this._finalizeInteraction(e,r?"CANCELLED":"ERROR",r?void 0:t,n)},async _finalizeInteraction(e,t,n,r="message.user_assistant",s){var C,T,A,N,I;const i=un.getState(),a=i.interactions.find(O=>O.id===e);if(!a||a.status!=="STREAMING"&&r!=="conversation.title_generation"&&r!=="conversation.compact"){console.warn(`[InteractionService] Interaction ${e} already finalized or not found. Skipping finalization with status ${t}.`),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e);return}const o=i.activeStreamBuffers[e]??"",l=i.activeReasoningBuffers[e]??"",c=this._streamingToolData.get(e)||{calls:[],results:[]},u=(a==null?void 0:a.metadata)||{};console.log(`[InteractionService] Finalizing ${e}. Buffered Content Length: ${o.length}, Reasoning Length: ${l.length}`);const d=performance.now(),h=this._interactionStartTimes.get(e),m=this._firstChunkTimestamps.get(e),y=h?Math.round(d-h):void 0,b=h&&m?Math.round(m-h):void 0,v=(s==null?void 0:s.reasoning)??l,x={status:t,endedAt:new Date,response:o||null,metadata:{...u,...(s==null?void 0:s.usage)&&{promptTokens:s.usage.promptTokens,completionTokens:s.usage.completionTokens,totalTokens:s.usage.totalTokens},...(s==null?void 0:s.providerMetadata)&&{providerMetadata:s.providerMetadata},toolCalls:c.calls,toolResults:c.results,reasoning:v||void 0,timeToFirstToken:b,generationTime:y,...(t==="ERROR"||t==="WARNING"||t==="CANCELLED")&&{error:(n==null?void 0:n.message)??"Interaction ended unexpectedly."}}};if(r==="conversation.title_generation"&&t==="COMPLETED"&&x.response&&typeof x.response=="string"){const O=x.response.trim().replace(/^"|"$/g,"");a&&O&&Re.emit(er.updateConversationRequest,{id:a.conversationId,updates:{title:O}})}if(r==="prompt.enhance"&&t==="COMPLETED"&&x.response&&typeof x.response=="string"){const O=x.response.trim();if(O){const{PromptEnhancementService:B}=await Dr(async()=>{const{PromptEnhancementService:D}=await Promise.resolve().then(()=>gHe);return{PromptEnhancementService:D}},void 0);await B.handleEnhancementCompletion(e,O)}}if(r==="conversation.compact"&&t==="COMPLETED"&&x.response&&typeof x.response=="string"){const O=x.response.trim(),B=(C=a==null?void 0:a.metadata)==null?void 0:C.targetUserInteractionId,D=(T=a==null?void 0:a.metadata)==null?void 0:T.targetConversationId,H=(A=a==null?void 0:a.metadata)==null?void 0:A.combineSourceInteractionId;if((N=a==null?void 0:a.metadata)!=null&&N.isCombineGeneration&&H){console.log(`[InteractionService] Combine completion handler triggered for ${e} targeting ${H}`);try{const P=un.getState(),K=P.interactions.find(U=>{var V,L;return U.parentId===H&&((V=U.metadata)==null?void 0:V.isCombineGeneration)===!0&&((L=U.metadata)==null?void 0:L.isCompactingInProgress)===!0});if(K){const U={...K.metadata,isCompactingInProgress:!1,combineGeneratedAt:new Date().toISOString()};P._updateInteractionInState(K.id,{response:O,status:"COMPLETED",endedAt:new Date,metadata:U});const V=P.interactions.find(L=>L.id===K.id);V&&await bt.saveInteraction(V),Re.emit(En.updated,{interactionId:K.id,updates:{response:O,status:"COMPLETED",endedAt:new Date,metadata:U}}),P._removeStreamingId(K.id)}}catch(P){console.error("[InteractionService] Error updating combine interaction:",P)}}else if(O&&B&&D)try{await Vn.getState().selectItem(D,"conversation");const K=un.getState();K.currentConversationId!==D&&await K.loadInteractions(D);const U=K.interactions.find(L=>L.id===B);if(!U)throw new Error(`Target interaction ${B} not found after loading conversation ${D}`);const V={...U,response:O,status:"COMPLETED",endedAt:new Date,metadata:{...U.metadata,isCompactingInProgress:!1,isRaceCombining:!1,compactGeneratedAt:new Date().toISOString(),combinedResponse:(I=U.metadata)!=null&&I.isRaceCombining?!0:void 0}};await bt.saveInteraction(V),K._updateInteractionInState(B,{response:O,status:"COMPLETED",endedAt:new Date,metadata:V.metadata}),Re.emit(En.updated,{interactionId:B,updates:{response:O,status:"COMPLETED",endedAt:new Date,metadata:V.metadata}}),K._removeStreamingId(B)}catch(P){console.error(`[InteractionService] Error updating user interaction ${B} with compact summary:`,P);try{await Vn.getState().selectItem(D,"conversation");const U=un.getState(),V=U.interactions.find(W=>W.id===B),L={response:"Error generating compact summary. Please try again.",status:"ERROR",endedAt:new Date,metadata:{...(V==null?void 0:V.metadata)||{},isCompactingInProgress:!1,compactError:P instanceof Error?P.message:String(P)}};U._updateInteractionInState(B,L),Re.emit(En.updated,{interactionId:B,updates:L}),U._removeStreamingId(B);const te=U.interactions.find(W=>W.id===B);te&&await bt.saveInteraction(te)}catch(K){console.error(`[InteractionService] Fallback update also failed for ${B}:`,K)}}}i._updateInteractionInState(e,x),i._removeStreamingId(e);const w=un.getState().interactions.find(O=>O.id===e);w?bt.saveInteraction({...w}).catch(O=>{console.error(`[InteractionService] Failed final persistence for ${e}`,O)}):console.error(`[InteractionService] CRITICAL - Could not find final state for interaction ${e} to persist.`);let S=[],k=[];try{S=c.calls.map(O=>JSON.parse(O)),k=c.results.map(O=>JSON.parse(O))}catch(O){console.error("[InteractionService] Failed to parse tool strings for event emitter:",O)}Re.emit(En.completed,{interactionId:e,status:t,error:n==null?void 0:n.message,toolCalls:S,toolResults:k}),this._activeControllers.delete(e),this._streamingToolData.delete(e),this._interactionStartTimes.delete(e),this._firstChunkTimestamps.delete(e)}},bk=Ve.memo(({interactionId:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var P;const{interaction:s,interactionStatus:i}=un(yn(K=>{const U=K.interactions.find(V=>V.id===e);return{interaction:U,interactionStatus:U==null?void 0:U.status}})),a=pr(K=>K.streamingRenderFPS),[o,l]=E.useState(""),[c,u]=E.useState(""),[d,h]=E.useState(!0),[m,y]=E.useState(!1),b=E.useRef(null),v=E.useRef(0),x=E.useRef(null);E.useEffect(()=>{const K=1e3/a;let U=!0;const V=L=>{if(!U)return;if(un.getState().streamingInteractionIds.includes(e)){if(L-v.current>=K){const W=un.getState().activeStreamBuffers[e]??"",Q=un.getState().activeReasoningBuffers[e]??"";l(W),u(Q),v.current=L}b.current=requestAnimationFrame(V)}else{const W=un.getState().activeStreamBuffers[e]??"",Q=un.getState().activeReasoningBuffers[e]??"";l(W),u(Q),b.current=null}};return b.current=requestAnimationFrame(V),()=>{U=!1,b.current&&(cancelAnimationFrame(b.current),b.current=null)}},[e,a]),E.useEffect(()=>{if(i&&i!=="STREAMING"){const K=un.getState().activeStreamBuffers[e]??"",U=un.getState().activeReasoningBuffers[e]??"";l(K),u(U),b.current&&(cancelAnimationFrame(b.current),b.current=null)}},[i,e]);const{dbProviderConfigs:w,getAllAvailableModelDefsForProvider:S}=Qn(yn(K=>({dbProviderConfigs:K.dbProviderConfigs,getAllAvailableModelDefsForProvider:K.getAllAvailableModelDefsForProvider}))),k=E.useMemo(()=>{var ee;const K=(ee=s==null?void 0:s.metadata)==null?void 0:ee.modelId;if(!K)return"Loading Model...";const{providerId:U,modelId:V}=Ac(K);if(!U||!V)return K;const L=w.find(re=>re.id===U),te=(L==null?void 0:L.name)??U,Q=S(U).find(re=>re.id===V);return`${(Q==null?void 0:Q.name)??V} (${te})`},[(P=s==null?void 0:s.metadata)==null?void 0:P.modelId,w,S]),C=E.useCallback(()=>h(K=>!K),[]),T=E.useCallback(()=>{y(!1)},[]),A=E.useCallback(()=>{y(!0)},[]),N=E.useCallback(()=>{m?T():A()},[m,T,A]);if(!s)return r?f.jsxs("div",{className:Ze("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[f.jsx("div",{className:"h-8 bg-muted rounded w-3/4 mb-4"}),f.jsxs("div",{className:"mt-3 pt-3 border-t border-border/50",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),f.jsxs("div",{className:"space-y-2 mt-2",children:[f.jsx("div",{className:"h-4 bg-muted rounded w-full"}),f.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),f.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]})]}):f.jsxs("div",{className:Ze("group/card relative rounded-lg border border-primary/30 bg-card p-4 shadow-sm animate-pulse",t),children:[f.jsxs("div",{className:"flex justify-between items-center mb-2",children:[f.jsx("span",{className:"text-xs font-medium text-muted-foreground",children:"Assistant (Loading...)"}),f.jsx("span",{className:"text-xs text-muted-foreground",children:"Streaming..."})]}),f.jsxs("div",{className:"space-y-2 mt-2",children:[f.jsx("div",{className:"h-4 bg-muted rounded w-full"}),f.jsx("div",{className:"h-4 bg-muted rounded w-5/6"}),f.jsx("div",{className:"h-4 bg-muted rounded w-full"})]})]});const I=()=>{Sc.abortInteraction(e)},O=n==null?void 0:n("header-actions",s,{isFolded:m,toggleFold:N}),B=n==null?void 0:n("actions",s),D=n==null?void 0:n("content",s),H=n==null?void 0:n("menu",s);return f.jsxs("div",{ref:x,className:Ze("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors",i==="ERROR"?"border-destructive/50 bg-destructive/5":i==="STREAMING"?"border-primary/30":"border-border",t),children:[r&&s.prompt&&f.jsx(wT,{turnData:s.prompt,timestamp:s.startedAt,isAssistantComplete:!1,interactionId:s.id}),f.jsxs("div",{className:Ze("relative group/assistant",r&&s.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[H,f.jsxs("div",{className:Ze("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-20 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[f.jsx(ty,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),f.jsx("div",{className:"flex flex-col min-w-0",children:f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",k,")"]}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:O})]})})]}),f.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:"Streaming..."})})]}),!m&&f.jsxs(f.Fragment,{children:[D,c&&f.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:C,children:[f.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[f.jsx(Hy,{className:"h-3.5 w-3.5"})," Reasoning (Streaming)"]}),f.jsx("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:f.jsx(qn,{tooltipText:d?"Show Reasoning":"Hide Reasoning",onClick:K=>{K.stopPropagation(),C()},"aria-label":d?"Show reasoning":"Hide reasoning",icon:d?f.jsx(Ql,{}):f.jsx(Xh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})})]}),!d&&f.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:c})]}),f.jsx(iIe,{interactionId:e,markdownContent:o,isStreaming:!0})]}),m&&f.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:N,children:[c?"[Reasoning] ":"",o&&typeof o=="string"?`"${o.substring(0,80)}${o.length>80?"...":""}"`:"[Streaming...]"]})]}),f.jsxs("div",{className:Ze("absolute bottom-1 left-1 md:bottom-2 md:left-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-20"),children:[B,f.jsx(aIe,{onStop:I,"aria-label":"Stop Generation"})]})]})});bk.displayName="StreamingInteractionCard";const w7=e=>e===void 0?"?":e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`,fPe=({displayModelName:e,timeAgo:t,promptTokens:n,completionTokens:r,timeToFirstToken:s,generationTime:i,headerActionsSlot:a})=>{const o=n!==void 0&&r!==void 0?n+r:void 0;return f.jsxs("div",{className:Ze("flex flex-col sm:flex-row justify-between items-start mb-2 sticky top-0 bg-card/80 backdrop-blur-sm z-20 p-1 -m-1 rounded-t"),children:[f.jsxs("div",{className:"flex items-start gap-1 min-w-0 mb-1 sm:mb-0",children:[f.jsx(ty,{className:"h-4 w-4 text-secondary flex-shrink-0 mt-0.5"}),f.jsxs("div",{className:"flex flex-col min-w-0",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs("span",{className:"text-xs font-semibold text-secondary truncate mr-1",children:["Assistant (",e,")"]}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/assistant:opacity-100 focus-within:opacity-100 transition-opacity",children:a})]}),f.jsxs("div",{className:"flex items-center gap-2 text-xs text-muted-foreground mt-0.5 flex-wrap",children:[o!==void 0&&f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsxs(Sr,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(ume,{className:"h-3 w-3"}),f.jsx("span",{children:o.toLocaleString()})]}),f.jsxs(Cr,{side:"bottom",children:["Tokens: ",n??"?"," (Prompt) +"," ",r??"?"," (Completion) = ",o]})]})}),s!==void 0&&f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsxs(Sr,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(f0e,{className:"h-3 w-3"}),f.jsx("span",{children:w7(s)})]}),f.jsx(Cr,{side:"bottom",children:"Time to First Token"})]})}),i!==void 0&&f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsxs(Sr,{className:"flex items-center gap-0.5 cursor-default",children:[f.jsx(sme,{className:"h-3 w-3"}),f.jsx("span",{children:w7(i)})]}),f.jsx(Cr,{side:"bottom",children:"Total Generation Time"})]})})]})]})]}),f.jsx("div",{className:"flex items-start flex-shrink-0 gap-1 self-end sm:self-start",children:f.jsx("span",{className:"text-xs text-muted-foreground mt-0.5",children:t})})]})},hPe=({markdownContent:e,interactionId:t})=>{const n=xT(e);return e!=null&&e.trim()?f.jsx("div",{className:"overflow-wrap-anywhere",children:n.map((r,s)=>typeof r=="string"?f.jsx("div",{className:"markdown-content",dangerouslySetInnerHTML:{__html:r}},`html-${s}`):r.type==="block"?f.jsx(Qy,{lang:r.lang,code:r.code,filepath:r.filepath,interactionId:t},`block-${s}`):null)}):null},pPe=({interactionId:e,response:t,toolCalls:n,toolResults:r,reasoning:s,isError:i,errorMessage:a,isFolded:o,toggleFold:l})=>{const[c,u]=E.useState(!0),[d,h]=E.useState(!1),m=Wi(yn(C=>Object.values(C.canvasControls))),y=E.useCallback((C,T)=>m.filter(A=>A.type==="tool-call-step"&&A.targetSlot===C&&A.renderer).map(A=>A.renderer?f.jsx(Ve.Fragment,{children:A.renderer(T)},A.id):null).filter(Boolean),[m]),b=E.useMemo(()=>{if(!n)return[];const C=n.map(A=>JSON.parse(A)),T=(r==null?void 0:r.map(A=>JSON.parse(A)))??[];return C.map(A=>{const N=T.find(I=>I.toolCallId===A.toolCallId);return{call:A,result:N}})},[n,r]),v=E.useCallback(()=>u(C=>!C),[]),x=E.useCallback(async()=>{if(s)try{await navigator.clipboard.writeText(s),h(!0),Te.success("Reasoning copied!"),setTimeout(()=>h(!1),1500)}catch(C){Te.error("Failed to copy reasoning."),console.error("Clipboard copy failed for reasoning:",C)}},[s]),w=!!s,S=t&&(typeof t!="string"||t.trim().length>0),k=b&&b.length>0;return o?f.jsxs("div",{className:"text-xs text-muted-foreground italic cursor-pointer hover:bg-muted/20 p-1 rounded",onClick:l,children:[w?"[Reasoning] ":"",k?`[${b==null?void 0:b.length} Tool Call(s)] `:"",S&&typeof t=="string"?`"${t.substring(0,80)}${t.length>80?"...":""}"`:k||w?"":"[No text response]"]}):f.jsxs(f.Fragment,{children:[i&&a&&f.jsxs("div",{className:"mb-2 rounded border border-destructive bg-destructive/10 p-2 text-xs text-destructive-foreground",children:[f.jsx("p",{className:"font-semibold",children:"Error:"}),f.jsx("p",{children:a})]}),w&&f.jsxs("div",{className:"my-2 p-2 border border-blue-500/30 bg-blue-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1 cursor-pointer group/reasoning",onClick:v,children:[f.jsxs("span",{className:"font-semibold text-blue-700 dark:text-blue-300 flex items-center gap-1",children:[f.jsx(Hy,{className:"h-3.5 w-3.5"})," Reasoning"]}),f.jsxs("div",{className:"flex items-center opacity-0 group-hover/reasoning:opacity-100 focus-within:opacity-100 transition-opacity",children:[f.jsx(qn,{tooltipText:"Copy Reasoning",onClick:C=>{C.stopPropagation(),x()},"aria-label":"Copy reasoning",icon:d?f.jsx(co,{className:"text-green-500"}):f.jsx(wE,{}),className:"h-5 w-5 text-muted-foreground"}),f.jsx(qn,{tooltipText:c?"Show Reasoning":"Hide Reasoning",onClick:C=>{C.stopPropagation(),v()},"aria-label":c?"Show reasoning":"Hide reasoning",icon:c?f.jsx(Ql,{}):f.jsx(Xh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]})]}),!c&&f.jsx("pre",{className:"whitespace-pre-wrap text-xs font-mono p-2 bg-background/30 rounded mt-1 overflow-wrap-anywhere",children:s})]}),b.map(({call:C,result:T},A)=>{const N={interactionId:e,toolCall:C,toolResult:T,canvasContextType:"tool-call-step"};return f.jsx(Ve.Fragment,{children:y("tool-call-content",N)},`tool-step-${C.toolCallId||A}`)}),S&&typeof t=="string"&&f.jsx(hPe,{markdownContent:t,interactionId:e}),!S&&!k&&!w&&!i&&f.jsx("div",{className:"text-xs text-muted-foreground italic p-1",children:"[No text response]"})]})},Jj=Ve.memo(({interaction:e,className:t,renderSlot:n,showPrompt:r=!0})=>{var O,B,D,H,P,K,U,V,L,te,W,Q;const[s,i]=E.useState(!1),a=E.useRef(null),o=E.useCallback(()=>{i(!1)},[]),l=E.useCallback(()=>{i(!0)},[]),c=E.useCallback(()=>{s?o():l()},[s,o,l]),{dbProviderConfigs:u,getAllAvailableModelDefsForProvider:d}=Qn(yn(ee=>({dbProviderConfigs:ee.dbProviderConfigs,getAllAvailableModelDefsForProvider:ee.getAllAvailableModelDefsForProvider}))),h=e.endedAt?XZ(new Date(e.endedAt),{addSuffix:!0}):"Processing...",m=E.useMemo(()=>{var Ce;const ee=(Ce=e.metadata)==null?void 0:Ce.modelId;if(!ee)return"Unknown Model";const{providerId:re,modelId:pe}=Ac(ee);if(!re||!pe)return ee;const de=u.find(qe=>qe.id===re),Oe=(de==null?void 0:de.name)??re,Se=d(re).find(qe=>qe.id===pe);return`${(Se==null?void 0:Se.name)??pe} (${Oe})`},[(O=e.metadata)==null?void 0:O.modelId,u,d]),y=e.status==="COMPLETED",b=y||e.status==="ERROR",v=e.status==="ERROR",x=e.response&&(typeof e.response!="string"||e.response.trim().length>0),w=((B=e.metadata)==null?void 0:B.toolCalls)&&e.metadata.toolCalls.length>0,S=((D=e.metadata)==null?void 0:D.toolResults)&&e.metadata.toolResults.length>0,k=!!((H=e.metadata)!=null&&H.reasoning),C=x||w||S||k,T=n==null?void 0:n("header-actions",e,{isFolded:s,toggleFold:c}),A=n==null?void 0:n("actions",e),N=n==null?void 0:n("content",e),I=n==null?void 0:n("menu",e);return f.jsxs("div",{ref:a,className:Ze("group/card relative rounded-lg border bg-card p-3 md:p-4 shadow-sm transition-colors hover:bg-muted/50","overflow-wrap-anywhere",v?"border-destructive/50 bg-destructive/5":"border-border",t),children:[r&&e.prompt&&f.jsx(wT,{turnData:e.prompt,timestamp:e.startedAt,isAssistantComplete:y,interactionId:e.id}),f.jsxs("div",{className:Ze("relative group/assistant",r&&e.prompt?"mt-3 pt-3 border-t border-border/50":""),children:[I,f.jsx(fPe,{displayModelName:m,timeAgo:h,isFolded:s,toggleFold:c,canFold:C,promptTokens:(P=e.metadata)==null?void 0:P.promptTokens,completionTokens:(K=e.metadata)==null?void 0:K.completionTokens,timeToFirstToken:(U=e.metadata)==null?void 0:U.timeToFirstToken,generationTime:(V=e.metadata)==null?void 0:V.generationTime,headerActionsSlot:T&&T.length>0?f.jsx(f.Fragment,{children:T}):void 0}),N,f.jsx(pPe,{interactionId:e.id,response:e.response,toolCalls:(L=e.metadata)==null?void 0:L.toolCalls,toolResults:(te=e.metadata)==null?void 0:te.toolResults,reasoning:(W=e.metadata)==null?void 0:W.reasoning,isError:v,errorMessage:(Q=e.metadata)==null?void 0:Q.error,isFolded:s,toggleFold:c})]}),b&&A&&A.length>0&&f.jsx("div",{className:Ze("absolute bottom-1 left-1 md:bottom-2 md:left-2 flex items-center space-x-0.5 md:space-x-1 opacity-0 group-hover/card:opacity-100 transition-opacity duration-200","bg-card/80 backdrop-blur-sm p-0.5 md:p-1 rounded-md shadow-md z-20"),children:A})]})});Jj.displayName="InteractionCard";const mPe=({interactionGroup:e,renderSlot:t,activeStreamingInteractionId:n})=>{const[r,s]=E.useState(0);if(!e||e.length===0)return null;if(e.length===1){const a=e[0];return f.jsxs("div",{className:"tab-content pt-0",children:[" ",a.id===n&&a.status==="STREAMING"?f.jsx(bk,{interactionId:a.id,renderSlot:t,showPrompt:!1},a.id):f.jsx(Jj,{interaction:a,renderSlot:t,showPrompt:!1},a.id)]})}const i=e[r];return f.jsxs("div",{className:"response-tabs-container flex flex-col",children:[f.jsxs("div",{className:"tabs-header flex border-b mb-1",children:[" ",e.map((a,o)=>{const l=()=>{var c,u,d;return o===0?(c=a.metadata)!=null&&c.editedResponse?f.jsx(jB,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):f.jsx(jB,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(u=a.metadata)!=null&&u.raceTab?f.jsx(AH,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):(d=a.metadata)!=null&&d.originalVersion?f.jsx(YP,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"}):f.jsx(Zme,{className:"h-3.5 w-3.5 mr-1 flex-shrink-0"})};return f.jsxs(ct,{variant:"ghost",size:"sm",onClick:()=>s(o),className:`mr-0.5 rounded-b-none flex items-center px-2 py-1 text-xs font-medium hover:bg-muted/50 focus-visible:ring-1 focus-visible:ring-ring focus-visible:ring-offset-0 transition-colors duration-150 ease-in-out                 ${r===o?"border-b-2 border-primary text-primary":"border-b-2 border-transparent text-muted-foreground hover:text-foreground"}`,children:[l(),o+1," "]},a.id)})]}),f.jsxs("div",{className:"tab-content pt-1",children:[" ",i&&(i.id===n&&i.status==="STREAMING"?f.jsx(bk,{interactionId:i.id,renderSlot:t,showPrompt:!1},i.id):f.jsx(Jj,{interaction:i,renderSlot:t,showPrompt:!1},i.id))]})]})};var gPe=E.createContext(void 0);function mb(e){const t=E.useContext(gPe);return e||t||"ltr"}function zw(e,[t,n]){return Math.min(n,Math.max(t,e))}function yPe(e,t){return E.useReducer((n,r)=>t[n][r]??n,e)}var VD="ScrollArea",[IJ,Odt]=Yi(VD),[bPe,sc]=IJ(VD),jJ=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,type:r="hover",dir:s,scrollHideDelay:i=600,...a}=e,[o,l]=E.useState(null),[c,u]=E.useState(null),[d,h]=E.useState(null),[m,y]=E.useState(null),[b,v]=E.useState(null),[x,w]=E.useState(0),[S,k]=E.useState(0),[C,T]=E.useState(!1),[A,N]=E.useState(!1),I=In(t,B=>l(B)),O=mb(s);return f.jsx(bPe,{scope:n,type:r,dir:O,scrollHideDelay:i,scrollArea:o,viewport:c,onViewportChange:u,content:d,onContentChange:h,scrollbarX:m,onScrollbarXChange:y,scrollbarXEnabled:C,onScrollbarXEnabledChange:T,scrollbarY:b,onScrollbarYChange:v,scrollbarYEnabled:A,onScrollbarYEnabledChange:N,onCornerWidthChange:w,onCornerHeightChange:k,children:f.jsx(cr.div,{dir:O,...a,ref:I,style:{position:"relative","--radix-scroll-area-corner-width":x+"px","--radix-scroll-area-corner-height":S+"px",...e.style}})})});jJ.displayName=VD;var PJ="ScrollAreaViewport",OJ=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,children:r,nonce:s,...i}=e,a=sc(PJ,n),o=E.useRef(null),l=In(t,o,a.onViewportChange);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),f.jsx(cr.div,{"data-radix-scroll-area-viewport":"",...i,ref:l,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...e.style},children:f.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:r})})]})});OJ.displayName=PJ;var Hu="ScrollAreaScrollbar",DJ=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=sc(Hu,e.__scopeScrollArea),{onScrollbarXEnabledChange:i,onScrollbarYEnabledChange:a}=s,o=e.orientation==="horizontal";return E.useEffect(()=>(o?i(!0):a(!0),()=>{o?i(!1):a(!1)}),[o,i,a]),s.type==="hover"?f.jsx(vPe,{...r,ref:t,forceMount:n}):s.type==="scroll"?f.jsx(xPe,{...r,ref:t,forceMount:n}):s.type==="auto"?f.jsx(FJ,{...r,ref:t,forceMount:n}):s.type==="always"?f.jsx(WD,{...r,ref:t}):null});DJ.displayName=Hu;var vPe=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=sc(Hu,e.__scopeScrollArea),[i,a]=E.useState(!1);return E.useEffect(()=>{const o=s.scrollArea;let l=0;if(o){const c=()=>{window.clearTimeout(l),a(!0)},u=()=>{l=window.setTimeout(()=>a(!1),s.scrollHideDelay)};return o.addEventListener("pointerenter",c),o.addEventListener("pointerleave",u),()=>{window.clearTimeout(l),o.removeEventListener("pointerenter",c),o.removeEventListener("pointerleave",u)}}},[s.scrollArea,s.scrollHideDelay]),f.jsx(fa,{present:n||i,children:f.jsx(FJ,{"data-state":i?"visible":"hidden",...r,ref:t})})}),xPe=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=sc(Hu,e.__scopeScrollArea),i=e.orientation==="horizontal",a=ET(()=>l("SCROLL_END"),100),[o,l]=yPe("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return E.useEffect(()=>{if(o==="idle"){const c=window.setTimeout(()=>l("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(c)}},[o,s.scrollHideDelay,l]),E.useEffect(()=>{const c=s.viewport,u=i?"scrollLeft":"scrollTop";if(c){let d=c[u];const h=()=>{const m=c[u];d!==m&&(l("SCROLL"),a()),d=m};return c.addEventListener("scroll",h),()=>c.removeEventListener("scroll",h)}},[s.viewport,i,l,a]),f.jsx(fa,{present:n||o!=="hidden",children:f.jsx(WD,{"data-state":o==="hidden"?"hidden":"visible",...r,ref:t,onPointerEnter:Wt(e.onPointerEnter,()=>l("POINTER_ENTER")),onPointerLeave:Wt(e.onPointerLeave,()=>l("POINTER_LEAVE"))})})}),FJ=E.forwardRef((e,t)=>{const n=sc(Hu,e.__scopeScrollArea),{forceMount:r,...s}=e,[i,a]=E.useState(!1),o=e.orientation==="horizontal",l=ET(()=>{if(n.viewport){const c=n.viewport.offsetWidth<n.viewport.scrollWidth,u=n.viewport.offsetHeight<n.viewport.scrollHeight;a(o?c:u)}},10);return Ty(n.viewport,l),Ty(n.content,l),f.jsx(fa,{present:r||i,children:f.jsx(WD,{"data-state":i?"visible":"hidden",...s,ref:t})})}),WD=E.forwardRef((e,t)=>{const{orientation:n="vertical",...r}=e,s=sc(Hu,e.__scopeScrollArea),i=E.useRef(null),a=E.useRef(0),[o,l]=E.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),c=UJ(o.viewport,o.content),u={...r,sizes:o,onSizesChange:l,hasThumb:c>0&&c<1,onThumbChange:h=>i.current=h,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:h=>a.current=h};function d(h,m){return EPe(h,a.current,o,m)}return n==="horizontal"?f.jsx(wPe,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const h=s.viewport.scrollLeft,m=_7(h,o,s.dir);i.current.style.transform=`translate3d(${m}px, 0, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollLeft=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollLeft=d(h,s.dir))}}):n==="vertical"?f.jsx(_Pe,{...u,ref:t,onThumbPositionChange:()=>{if(s.viewport&&i.current){const h=s.viewport.scrollTop,m=_7(h,o);i.current.style.transform=`translate3d(0, ${m}px, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollTop=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollTop=d(h))}}):null}),wPe=E.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=sc(Hu,e.__scopeScrollArea),[a,o]=E.useState(),l=E.useRef(null),c=In(t,l,i.onScrollbarXChange);return E.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),f.jsx(BJ,{"data-orientation":"horizontal",...s,ref:c,sizes:n,style:{bottom:0,left:i.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:i.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":kT(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,d)=>{if(i.viewport){const h=i.viewport.scrollLeft+u.deltaX;e.onWheelScroll(h),VJ(h,d)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&r({content:i.viewport.scrollWidth,viewport:i.viewport.offsetWidth,scrollbar:{size:l.current.clientWidth,paddingStart:xk(a.paddingLeft),paddingEnd:xk(a.paddingRight)}})}})}),_Pe=E.forwardRef((e,t)=>{const{sizes:n,onSizesChange:r,...s}=e,i=sc(Hu,e.__scopeScrollArea),[a,o]=E.useState(),l=E.useRef(null),c=In(t,l,i.onScrollbarYChange);return E.useEffect(()=>{l.current&&o(getComputedStyle(l.current))},[l]),f.jsx(BJ,{"data-orientation":"vertical",...s,ref:c,sizes:n,style:{top:0,right:i.dir==="ltr"?0:void 0,left:i.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":kT(n)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,d)=>{if(i.viewport){const h=i.viewport.scrollTop+u.deltaY;e.onWheelScroll(h),VJ(h,d)&&u.preventDefault()}},onResize:()=>{l.current&&i.viewport&&a&&r({content:i.viewport.scrollHeight,viewport:i.viewport.offsetHeight,scrollbar:{size:l.current.clientHeight,paddingStart:xk(a.paddingTop),paddingEnd:xk(a.paddingBottom)}})}})}),[SPe,LJ]=IJ(Hu),BJ=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,sizes:r,hasThumb:s,onThumbChange:i,onThumbPointerUp:a,onThumbPointerDown:o,onThumbPositionChange:l,onDragScroll:c,onWheelScroll:u,onResize:d,...h}=e,m=sc(Hu,n),[y,b]=E.useState(null),v=In(t,I=>b(I)),x=E.useRef(null),w=E.useRef(""),S=m.viewport,k=r.content-r.viewport,C=Es(u),T=Es(l),A=ET(d,10);function N(I){if(x.current){const O=I.clientX-x.current.left,B=I.clientY-x.current.top;c({x:O,y:B})}}return E.useEffect(()=>{const I=O=>{const B=O.target;(y==null?void 0:y.contains(B))&&C(O,k)};return document.addEventListener("wheel",I,{passive:!1}),()=>document.removeEventListener("wheel",I,{passive:!1})},[S,y,k,C]),E.useEffect(T,[r,T]),Ty(y,A),Ty(m.content,A),f.jsx(SPe,{scope:n,scrollbar:y,hasThumb:s,onThumbChange:Es(i),onThumbPointerUp:Es(a),onThumbPositionChange:T,onThumbPointerDown:Es(o),children:f.jsx(cr.div,{...h,ref:v,style:{position:"absolute",...h.style},onPointerDown:Wt(e.onPointerDown,I=>{I.button===0&&(I.target.setPointerCapture(I.pointerId),x.current=y.getBoundingClientRect(),w.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",m.viewport&&(m.viewport.style.scrollBehavior="auto"),N(I))}),onPointerMove:Wt(e.onPointerMove,N),onPointerUp:Wt(e.onPointerUp,I=>{const O=I.target;O.hasPointerCapture(I.pointerId)&&O.releasePointerCapture(I.pointerId),document.body.style.webkitUserSelect=w.current,m.viewport&&(m.viewport.style.scrollBehavior=""),x.current=null})})})}),vk="ScrollAreaThumb",$J=E.forwardRef((e,t)=>{const{forceMount:n,...r}=e,s=LJ(vk,e.__scopeScrollArea);return f.jsx(fa,{present:n||s.hasThumb,children:f.jsx(CPe,{ref:t,...r})})}),CPe=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,style:r,...s}=e,i=sc(vk,n),a=LJ(vk,n),{onThumbPositionChange:o}=a,l=In(t,d=>a.onThumbChange(d)),c=E.useRef(void 0),u=ET(()=>{c.current&&(c.current(),c.current=void 0)},100);return E.useEffect(()=>{const d=i.viewport;if(d){const h=()=>{if(u(),!c.current){const m=TPe(d,o);c.current=m,o()}};return o(),d.addEventListener("scroll",h),()=>d.removeEventListener("scroll",h)}},[i.viewport,u,o]),f.jsx(cr.div,{"data-state":a.hasThumb?"visible":"hidden",...s,ref:l,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...r},onPointerDownCapture:Wt(e.onPointerDownCapture,d=>{const m=d.target.getBoundingClientRect(),y=d.clientX-m.left,b=d.clientY-m.top;a.onThumbPointerDown({x:y,y:b})}),onPointerUp:Wt(e.onPointerUp,a.onThumbPointerUp)})});$J.displayName=vk;var HD="ScrollAreaCorner",zJ=E.forwardRef((e,t)=>{const n=sc(HD,e.__scopeScrollArea),r=!!(n.scrollbarX&&n.scrollbarY);return n.type!=="scroll"&&r?f.jsx(kPe,{...e,ref:t}):null});zJ.displayName=HD;var kPe=E.forwardRef((e,t)=>{const{__scopeScrollArea:n,...r}=e,s=sc(HD,n),[i,a]=E.useState(0),[o,l]=E.useState(0),c=!!(i&&o);return Ty(s.scrollbarX,()=>{var d;const u=((d=s.scrollbarX)==null?void 0:d.offsetHeight)||0;s.onCornerHeightChange(u),l(u)}),Ty(s.scrollbarY,()=>{var d;const u=((d=s.scrollbarY)==null?void 0:d.offsetWidth)||0;s.onCornerWidthChange(u),a(u)}),c?f.jsx(cr.div,{...r,ref:t,style:{width:i,height:o,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function xk(e){return e?parseInt(e,10):0}function UJ(e,t){const n=e/t;return isNaN(n)?0:n}function kT(e){const t=UJ(e.viewport,e.content),n=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,r=(e.scrollbar.size-n)*t;return Math.max(r,18)}function EPe(e,t,n,r="ltr"){const s=kT(n),i=s/2,a=t||i,o=s-a,l=n.scrollbar.paddingStart+a,c=n.scrollbar.size-n.scrollbar.paddingEnd-o,u=n.content-n.viewport,d=r==="ltr"?[0,u]:[u*-1,0];return qJ([l,c],d)(e)}function _7(e,t,n="ltr"){const r=kT(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,i=t.scrollbar.size-s,a=t.content-t.viewport,o=i-r,l=n==="ltr"?[0,a]:[a*-1,0],c=zw(e,l);return qJ([0,a],[0,o])(c)}function qJ(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function VJ(e,t){return e>0&&e<t}var TPe=(e,t=()=>{})=>{let n={left:e.scrollLeft,top:e.scrollTop},r=0;return function s(){const i={left:e.scrollLeft,top:e.scrollTop},a=n.left!==i.left,o=n.top!==i.top;(a||o)&&t(),n=i,r=window.requestAnimationFrame(s)}(),()=>window.cancelAnimationFrame(r)};function ET(e,t){const n=Es(e),r=E.useRef(0);return E.useEffect(()=>()=>window.clearTimeout(r.current),[]),E.useCallback(()=>{window.clearTimeout(r.current),r.current=window.setTimeout(n,t)},[n,t])}function Ty(e,t){const n=Es(t);si(()=>{let r=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(r),r=window.requestAnimationFrame(n)});return s.observe(e),()=>{window.cancelAnimationFrame(r),s.unobserve(e)}}},[e,n])}var APe=jJ,RPe=OJ,NPe=zJ;function Zl({className:e,children:t,...n}){return f.jsxs(APe,{"data-slot":"scroll-area",className:Ze("relative",e),...n,children:[f.jsx(RPe,{"data-slot":"scroll-area-viewport",className:"focus-visible:ring-ring/50 size-full rounded-[inherit] transition-[color,box-shadow] outline-none focus-visible:ring-[3px] focus-visible:outline-1",children:t}),f.jsx(MPe,{}),f.jsx(NPe,{})]})}function MPe({className:e,orientation:t="vertical",...n}){return f.jsx(DJ,{"data-slot":"scroll-area-scrollbar",orientation:t,className:Ze("flex touch-none p-px transition-colors select-none",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent",t==="horizontal"&&"h-2.5 flex-col border-t border-t-transparent",e),...n,children:f.jsx($J,{"data-slot":"scroll-area-thumb",className:"bg-border relative flex-1 rounded-full"})})}function Gr({className:e,...t}){return f.jsx("div",{"data-slot":"skeleton",className:Ze("bg-accent animate-pulse rounded-md",e),...t})}const IPe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M4 12h16",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M12 5v16",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})};function Fo({className:e,...t}){return f.jsx("div",{"data-slot":"card",className:Ze("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",e),...t})}function Lo({className:e,...t}){return f.jsx("div",{"data-slot":"card-header",className:Ze("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",e),...t})}function Bo({className:e,...t}){return f.jsx("div",{"data-slot":"card-title",className:Ze("leading-none font-semibold",e),...t})}function Au({className:e,...t}){return f.jsx("div",{"data-slot":"card-description",className:Ze("text-muted-foreground text-sm",e),...t})}function $o({className:e,...t}){return f.jsx("div",{"data-slot":"card-content",className:Ze("px-6",e),...t})}function jPe({className:e,...t}){return f.jsx("div",{"data-slot":"card-footer",className:Ze("flex items-center px-6 [.border-t]:pt-6",e),...t})}const Tr={sidebarVisibilityChanged:"ui.sidebar.visibility.changed",chatControlPanelVisibilityChanged:"ui.chat.control.panel.visibility.changed",promptControlPanelVisibilityChanged:"ui.prompt.control.panel.visibility.changed",globalLoadingChanged:"ui.global.loading.changed",globalErrorChanged:"ui.global.error.changed",focusInputFlagChanged:"ui.focus.input.flag.changed",modalStateChanged:"ui.modal.state.changed",toggleSidebarRequest:"ui.toggle.sidebar.request",toggleChatControlPanelRequest:"ui.toggle.chat.control.panel.request",togglePromptControlPanelRequest:"ui.toggle.prompt.control.panel.request",setGlobalLoadingRequest:"ui.set.global.loading.request",setGlobalErrorRequest:"ui.set.global.error.request",setFocusInputFlagRequest:"ui.set.focus.input.flag.request",openModalRequest:"ui.modal.open.request",closeModalRequest:"ui.modal.close.request",contextChanged:"ui.legacy.contextChanged"},PPe=({title:e,description:t,icon:n,onClick:r})=>f.jsxs(Fo,{className:"hover:border-primary/50 hover:bg-muted/30 transition-all cursor-pointer group",onClick:r,children:[f.jsxs(Lo,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[f.jsxs(Bo,{className:"text-sm font-medium flex items-center gap-2",children:[n," ",e]}),f.jsx(wpe,{className:"h-4 w-4 text-muted-foreground group-hover:translate-x-1 transition-transform"})]}),f.jsx($o,{children:f.jsx("p",{className:"text-xs text-muted-foreground",children:t})})]}),WJ=()=>{const e=(r,s)=>{Re.emit(Tr.openModalRequest,{modalId:"settingsModal",initialTab:r,initialSubTab:s})},t=()=>{Re.emit(Tr.openModalRequest,{modalId:"core-vfs-modal-panel"})},n=[{title:"Configure Theme",description:"Customize colors, fonts, and code block appearance.",icon:f.jsx(ny,{className:"h-4 w-4 text-purple-500"}),onClick:()=>e("theme")},{title:"Manage Rules & Tags",description:"Define reusable prompt snippets and organize them.",icon:f.jsx(sj,{className:"h-4 w-4 text-blue-500"}),onClick:()=>e("rules-tags")},{title:"Add Files",description:"Upload or manage files in the virtual filesystem.",icon:f.jsx(GP,{className:"h-4 w-4 text-cyan-500"}),onClick:t},{title:"Add Provider",description:"Connect to AI services like OpenAI, Ollama, etc.",icon:f.jsx(ry,{className:"h-4 w-4 text-green-500"}),onClick:()=>e("providers","providers-config")},{title:"Add API Key",description:"Store API keys securely in your browser.",icon:f.jsx(Zx,{className:"h-4 w-4 text-amber-500"}),onClick:()=>e("providers","api-keys")},{title:"Setup Git Sync",description:"Configure repositories to sync conversations with Git.",icon:f.jsx(jc,{className:"h-4 w-4 text-orange-500"}),onClick:()=>e("git")}];return f.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 max-w-4xl w-full pt-4",children:n.map(r=>f.jsx(PPe,{title:r.title,description:r.description,icon:r.icon,onClick:r.onClick},r.title))})},S7=()=>f.jsxs("div",{className:"flex h-full flex-col items-center justify-center text-center p-4",children:[f.jsx(IPe,{className:"h-16 w-16 text-muted-foreground mb-4"}),f.jsx("h2",{className:"text-xl font-semibold mb-2",children:"Start Chatting"}),f.jsx("p",{className:"text-muted-foreground max-w-md mb-8",children:"Select an existing conversation or project from the sidebar, or click the '+' button to start a new chat. You can also explore these setup options:"}),f.jsx(WJ,{})]}),GD=E.createContext({});function KD(e){const t=E.useRef(null);return t.current===null&&(t.current=e()),t.current}const YD=typeof window<"u",HJ=YD?E.useLayoutEffect:E.useEffect,TT=E.createContext(null),ZD=E.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class OPe extends E.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=n.offsetParent,s=r instanceof HTMLElement&&r.offsetWidth||0,i=this.props.sizeRef.current;i.height=n.offsetHeight||0,i.width=n.offsetWidth||0,i.top=n.offsetTop,i.left=n.offsetLeft,i.right=s-i.width-i.left}return null}componentDidUpdate(){}render(){return this.props.children}}function DPe({children:e,isPresent:t,anchorX:n}){const r=E.useId(),s=E.useRef(null),i=E.useRef({width:0,height:0,top:0,left:0,right:0}),{nonce:a}=E.useContext(ZD);return E.useInsertionEffect(()=>{const{width:o,height:l,top:c,left:u,right:d}=i.current;if(t||!s.current||!o||!l)return;const h=n==="left"?`left: ${u}`:`right: ${d}`;s.current.dataset.motionPopId=r;const m=document.createElement("style");return a&&(m.nonce=a),document.head.appendChild(m),m.sheet&&m.sheet.insertRule(`
          [data-motion-pop-id="${r}"] {
            position: absolute !important;
            width: ${o}px !important;
            height: ${l}px !important;
            ${h}px !important;
            top: ${c}px !important;
          }
        `),()=>{document.head.contains(m)&&document.head.removeChild(m)}},[t]),f.jsx(OPe,{isPresent:t,childRef:s,sizeRef:i,children:E.cloneElement(e,{ref:s})})}const FPe=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:s,presenceAffectsLayout:i,mode:a,anchorX:o})=>{const l=KD(LPe),c=E.useId();let u=!0,d=E.useMemo(()=>(u=!1,{id:c,initial:t,isPresent:n,custom:s,onExitComplete:h=>{l.set(h,!0);for(const m of l.values())if(!m)return;r&&r()},register:h=>(l.set(h,!1),()=>l.delete(h))}),[n,l,r]);return i&&u&&(d={...d}),E.useMemo(()=>{l.forEach((h,m)=>l.set(m,!1))},[n]),E.useEffect(()=>{!n&&!l.size&&r&&r()},[n]),a==="popLayout"&&(e=f.jsx(DPe,{isPresent:n,anchorX:o,children:e})),f.jsx(TT.Provider,{value:d,children:e})};function LPe(){return new Map}function GJ(e=!0){const t=E.useContext(TT);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:s}=t,i=E.useId();E.useEffect(()=>{if(e)return s(i)},[e]);const a=E.useCallback(()=>e&&r&&r(i),[i,r,e]);return!n&&r?[!1,a]:[!0]}const eC=e=>e.key||"";function C7(e){const t=[];return E.Children.forEach(e,n=>{E.isValidElement(n)&&t.push(n)}),t}const BPe=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:s=!0,mode:i="sync",propagate:a=!1,anchorX:o="left"})=>{const[l,c]=GJ(a),u=E.useMemo(()=>C7(e),[e]),d=a&&!l?[]:u.map(eC),h=E.useRef(!0),m=E.useRef(u),y=KD(()=>new Map),[b,v]=E.useState(u),[x,w]=E.useState(u);HJ(()=>{h.current=!1,m.current=u;for(let C=0;C<x.length;C++){const T=eC(x[C]);d.includes(T)?y.delete(T):y.get(T)!==!0&&y.set(T,!1)}},[x,d.length,d.join("-")]);const S=[];if(u!==b){let C=[...u];for(let T=0;T<x.length;T++){const A=x[T],N=eC(A);d.includes(N)||(C.splice(T,0,A),S.push(A))}return i==="wait"&&S.length&&(C=S),w(C7(C)),v(u),null}const{forceRender:k}=E.useContext(GD);return f.jsx(f.Fragment,{children:x.map(C=>{const T=eC(C),A=a&&!l?!1:u===x||d.includes(T),N=()=>{if(y.has(T))y.set(T,!0);else return;let I=!0;y.forEach(O=>{O||(I=!1)}),I&&(k==null||k(),w(m.current),a&&(c==null||c()),r&&r())};return f.jsx(FPe,{isPresent:A,initial:!h.current||n?void 0:!1,custom:t,presenceAffectsLayout:s,mode:i,onExitComplete:A?void 0:N,anchorX:o,children:C},T)})})},tC=["setup","read","resolveKeyframes","preUpdate","update","preRender","render","postRender"],k7={value:null};function $Pe(e,t){let n=new Set,r=new Set,s=!1,i=!1;const a=new WeakSet;let o={delta:0,timestamp:0,isProcessing:!1},l=0;function c(d){a.has(d)&&(u.schedule(d),e()),l++,d(o)}const u={schedule:(d,h=!1,m=!1)=>{const b=m&&s?n:r;return h&&a.add(d),b.has(d)||b.add(d),d},cancel:d=>{r.delete(d),a.delete(d)},process:d=>{if(o=d,s){i=!0;return}s=!0,[n,r]=[r,n],n.forEach(c),t&&k7.value&&k7.value.frameloop[t].push(l),l=0,n.clear(),s=!1,i&&(i=!1,u.process(d))}};return u}const Qd={},zPe=40;function KJ(e,t){let n=!1,r=!0;const s={delta:0,timestamp:0,isProcessing:!1},i=()=>n=!0,a=tC.reduce((S,k)=>(S[k]=$Pe(i,t?k:void 0),S),{}),{setup:o,read:l,resolveKeyframes:c,preUpdate:u,update:d,preRender:h,render:m,postRender:y}=a,b=()=>{const S=Qd.useManualTiming?s.timestamp:performance.now();n=!1,Qd.useManualTiming||(s.delta=r?1e3/60:Math.max(Math.min(S-s.timestamp,zPe),1)),s.timestamp=S,s.isProcessing=!0,o.process(s),l.process(s),c.process(s),u.process(s),d.process(s),h.process(s),m.process(s),y.process(s),s.isProcessing=!1,n&&t&&(r=!1,e(b))},v=()=>{n=!0,r=!0,s.isProcessing||e(b)};return{schedule:tC.reduce((S,k)=>{const C=a[k];return S[k]=(T,A=!1,N=!1)=>(n||v(),C.schedule(T,A,N)),S},{}),cancel:S=>{for(let k=0;k<tC.length;k++)a[tC[k]].cancel(S)},state:s,steps:a}}const Hl=e=>e,{schedule:ri,cancel:qh,state:_a,steps:OI}=KJ(typeof requestAnimationFrame<"u"?requestAnimationFrame:Hl,!0),YJ=E.createContext({strict:!1}),E7={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},Ay={};for(const e in E7)Ay[e]={isEnabled:t=>E7[e].some(n=>!!t[n])};function UPe(e){for(const t in e)Ay[t]={...Ay[t],...e[t]}}const qPe=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function wk(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||qPe.has(e)}let ZJ=e=>!wk(e);function VPe(e){e&&(ZJ=t=>t.startsWith("on")?!wk(t):e(t))}try{VPe(require("@emotion/is-prop-valid").default)}catch{}function WPe(e,t,n){const r={};for(const s in e)s==="values"&&typeof e.values=="object"||(ZJ(s)||n===!0&&wk(s)||!t&&!wk(s)||e.draggable&&s.startsWith("onDrag"))&&(r[s]=e[s]);return r}function HPe(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...r)=>e(...r);return new Proxy(n,{get:(r,s)=>s==="create"?e:(t.has(s)||t.set(s,e(s)),t.get(s))})}const AT=E.createContext({});function RT(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}function Uw(e){return typeof e=="string"||Array.isArray(e)}const XD=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],JD=["initial",...XD];function NT(e){return RT(e.animate)||JD.some(t=>Uw(e[t]))}function XJ(e){return!!(NT(e)||e.variants)}function GPe(e,t){if(NT(e)){const{initial:n,animate:r}=e;return{initial:n===!1||Uw(n)?n:void 0,animate:Uw(r)?r:void 0}}return e.inherit!==!1?t:{}}function KPe(e){const{initial:t,animate:n}=GPe(e,E.useContext(AT));return E.useMemo(()=>({initial:t,animate:n}),[T7(t),T7(n)])}function T7(e){return Array.isArray(e)?e.join(" "):e}const YPe=Symbol.for("motionComponentSymbol");function T0(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function ZPe(e,t,n){return E.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):T0(n)&&(n.current=r))},[t])}const QD=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),XPe="framerAppearId",JJ="data-"+QD(XPe),QJ=E.createContext({}),{schedule:eF}=KJ(queueMicrotask,!1);function JPe(e,t,n,r,s){var b,v;const{visualElement:i}=E.useContext(AT),a=E.useContext(YJ),o=E.useContext(TT),l=E.useContext(ZD).reducedMotion,c=E.useRef(null);r=r||a.renderer,!c.current&&r&&(c.current=r(e,{visualState:t,parent:i,props:n,presenceContext:o,blockInitialAnimation:o?o.initial===!1:!1,reducedMotionConfig:l}));const u=c.current,d=E.useContext(QJ);u&&!u.projection&&s&&(u.type==="html"||u.type==="svg")&&QPe(c.current,n,s,d);const h=E.useRef(!1);E.useInsertionEffect(()=>{u&&h.current&&u.update(n,o)});const m=n[JJ],y=E.useRef(!!m&&!((b=window.MotionHandoffIsComplete)!=null&&b.call(window,m))&&((v=window.MotionHasOptimisedAnimation)==null?void 0:v.call(window,m)));return HJ(()=>{u&&(h.current=!0,window.MotionIsMounted=!0,u.updateFeatures(),eF.render(u.render),y.current&&u.animationState&&u.animationState.animateChanges())}),E.useEffect(()=>{u&&(!y.current&&u.animationState&&u.animationState.animateChanges(),y.current&&(queueMicrotask(()=>{var x;(x=window.MotionHandoffMarkAsComplete)==null||x.call(window,m)}),y.current=!1))}),u}function QPe(e,t,n,r){const{layoutId:s,layout:i,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:c,layoutCrossfade:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:eQ(e.parent)),e.projection.setOptions({layoutId:s,layout:i,alwaysMeasureLayout:!!a||o&&T0(o),visualElement:e,animationType:typeof i=="string"?i:"both",initialPromotionConfig:r,crossfade:u,layoutScroll:l,layoutRoot:c})}function eQ(e){if(e)return e.options.allowProjection!==!1?e.projection:eQ(e.parent)}let tF=()=>{};function eOe({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:r,Component:s}){e&&UPe(e);function i(o,l){let c;const u={...E.useContext(ZD),...o,layoutId:tOe(o)},{isStatic:d}=u,h=KPe(o),m=r(o,d);if(!d&&YD){nOe();const y=rOe(u);c=y.MeasureLayout,h.visualElement=JPe(s,m,u,t,y.ProjectionNode)}return f.jsxs(AT.Provider,{value:h,children:[c&&h.visualElement?f.jsx(c,{visualElement:h.visualElement,...u}):null,n(s,o,ZPe(m,h.visualElement,l),m,d,h.visualElement)]})}i.displayName=`motion.${typeof s=="string"?s:`create(${s.displayName??s.name??""})`}`;const a=E.forwardRef(i);return a[YPe]=s,a}function tOe({layoutId:e}){const t=E.useContext(GD).id;return t&&e!==void 0?t+"-"+e:e}function nOe(e,t){E.useContext(YJ).strict}function rOe(e){const{drag:t,layout:n}=Ay;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const tQ=e=>t=>typeof t=="string"&&t.startsWith(e),nF=tQ("--"),sOe=tQ("var(--"),rF=e=>sOe(e)?iOe.test(e.split("/*")[0].trim()):!1,iOe=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,qw={};function aOe(e){for(const t in e)qw[t]=e[t],nF(t)&&(qw[t].isCSSVariable=!0)}const gb=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],yb=new Set(gb);function nQ(e,{layout:t,layoutId:n}){return yb.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!qw[e]||e==="opacity")}const La=e=>!!(e&&e.getVelocity),rQ=(e,t)=>t&&typeof e=="number"?t.transform(e):e,ef=(e,t,n)=>n>t?t:n<e?e:n,bb={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},Vw={...bb,transform:e=>ef(0,1,e)},nC={...bb,default:1},A7={...bb,transform:Math.round},J1=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),ch=J1("deg"),Ru=J1("%"),lr=J1("px"),oOe=J1("vh"),lOe=J1("vw"),R7={...Ru,parse:e=>Ru.parse(e)/100,transform:e=>Ru.transform(e*100)},cOe={rotate:ch,rotateX:ch,rotateY:ch,rotateZ:ch,scale:nC,scaleX:nC,scaleY:nC,scaleZ:nC,skew:ch,skewX:ch,skewY:ch,distance:lr,translateX:lr,translateY:lr,translateZ:lr,x:lr,y:lr,z:lr,perspective:lr,transformPerspective:lr,opacity:Vw,originX:R7,originY:R7,originZ:lr},sF={borderWidth:lr,borderTopWidth:lr,borderRightWidth:lr,borderBottomWidth:lr,borderLeftWidth:lr,borderRadius:lr,radius:lr,borderTopLeftRadius:lr,borderTopRightRadius:lr,borderBottomRightRadius:lr,borderBottomLeftRadius:lr,width:lr,maxWidth:lr,height:lr,maxHeight:lr,top:lr,right:lr,bottom:lr,left:lr,padding:lr,paddingTop:lr,paddingRight:lr,paddingBottom:lr,paddingLeft:lr,margin:lr,marginTop:lr,marginRight:lr,marginBottom:lr,marginLeft:lr,backgroundPositionX:lr,backgroundPositionY:lr,...cOe,zIndex:A7,fillOpacity:Vw,strokeOpacity:Vw,numOctaves:A7},uOe={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},dOe=gb.length;function fOe(e,t,n){let r="",s=!0;for(let i=0;i<dOe;i++){const a=gb[i],o=e[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||n){const c=rQ(o,sF[a]);if(!l){s=!1;const u=uOe[a]||a;r+=`${u}(${c}) `}n&&(t[a]=c)}}return r=r.trim(),n?r=n(t,s?"":r):s&&(r="none"),r}function iF(e,t,n){const{style:r,vars:s,transformOrigin:i}=e;let a=!1,o=!1;for(const l in t){const c=t[l];if(yb.has(l)){a=!0;continue}else if(nF(l)){s[l]=c;continue}else{const u=rQ(c,sF[l]);l.startsWith("origin")?(o=!0,i[l]=u):r[l]=u}}if(t.transform||(a||n?r.transform=fOe(t,e.transform,n):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:c="50%",originZ:u=0}=i;r.transformOrigin=`${l} ${c} ${u}`}}const aF=()=>({style:{},transform:{},transformOrigin:{},vars:{}});function sQ(e,t,n){for(const r in t)!La(t[r])&&!nQ(r,n)&&(e[r]=t[r])}function hOe({transformTemplate:e},t){return E.useMemo(()=>{const n=aF();return iF(n,t,e),Object.assign({},n.vars,n.style)},[t])}function pOe(e,t){const n=e.style||{},r={};return sQ(r,n,e),Object.assign(r,hOe(e,t)),r}function mOe(e,t){const n={},r=pOe(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}const gOe=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function oF(e){return typeof e!="string"||e.includes("-")?!1:!!(gOe.indexOf(e)>-1||/[A-Z]/u.test(e))}const yOe={offset:"stroke-dashoffset",array:"stroke-dasharray"},bOe={offset:"strokeDashoffset",array:"strokeDasharray"};function vOe(e,t,n=1,r=0,s=!0){e.pathLength=1;const i=s?yOe:bOe;e[i.offset]=lr.transform(-r);const a=lr.transform(t),o=lr.transform(n);e[i.array]=`${a} ${o}`}function iQ(e,{attrX:t,attrY:n,attrScale:r,pathLength:s,pathSpacing:i=1,pathOffset:a=0,...o},l,c,u){if(iF(e,o,c),l){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:d,style:h}=e;d.transform&&(h.transform=d.transform,delete d.transform),(h.transform||d.transformOrigin)&&(h.transformOrigin=d.transformOrigin??"50% 50%",delete d.transformOrigin),h.transform&&(h.transformBox=(u==null?void 0:u.transformBox)??"fill-box",delete d.transformBox),t!==void 0&&(d.x=t),n!==void 0&&(d.y=n),r!==void 0&&(d.scale=r),s!==void 0&&vOe(d,s,i,a,!1)}const aQ=()=>({...aF(),attrs:{}}),oQ=e=>typeof e=="string"&&e.toLowerCase()==="svg";function xOe(e,t,n,r){const s=E.useMemo(()=>{const i=aQ();return iQ(i,t,oQ(r),e.transformTemplate,e.style),{...i.attrs,style:{...i.style}}},[t]);if(e.style){const i={};sQ(i,e.style,e),s.style={...i,...s.style}}return s}function wOe(e=!1){return(n,r,s,{latestValues:i},a)=>{const l=(oF(n)?xOe:mOe)(r,i,a,n),c=WPe(r,typeof n=="string",e),u=n!==E.Fragment?{...c,...l,ref:s}:{},{children:d}=r,h=E.useMemo(()=>La(d)?d.get():d,[d]);return E.createElement(n,{...u,children:h})}}function N7(e){const t=[{},{}];return e==null||e.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function lF(e,t,n,r){if(typeof t=="function"){const[s,i]=N7(r);t=t(n!==void 0?n:e.custom,s,i)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[s,i]=N7(r);t=t(n!==void 0?n:e.custom,s,i)}return t}function UC(e){return La(e)?e.get():e}function _Oe({scrapeMotionValuesFromProps:e,createRenderState:t},n,r,s){return{latestValues:SOe(n,r,s,e),renderState:t()}}const lQ=e=>(t,n)=>{const r=E.useContext(AT),s=E.useContext(TT),i=()=>_Oe(e,t,r,s);return n?i():KD(i)};function SOe(e,t,n,r){const s={},i=r(e,{});for(const h in i)s[h]=UC(i[h]);let{initial:a,animate:o}=e;const l=NT(e),c=XJ(e);t&&c&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),o===void 0&&(o=t.animate));let u=n?n.initial===!1:!1;u=u||a===!1;const d=u?o:a;if(d&&typeof d!="boolean"&&!RT(d)){const h=Array.isArray(d)?d:[d];for(let m=0;m<h.length;m++){const y=lF(e,h[m]);if(y){const{transitionEnd:b,transition:v,...x}=y;for(const w in x){let S=x[w];if(Array.isArray(S)){const k=u?S.length-1:0;S=S[k]}S!==null&&(s[w]=S)}for(const w in b)s[w]=b[w]}}}return s}function cF(e,t,n){var i;const{style:r}=e,s={};for(const a in r)(La(r[a])||t.style&&La(t.style[a])||nQ(a,e)||((i=n==null?void 0:n.getValue(a))==null?void 0:i.liveStyle)!==void 0)&&(s[a]=r[a]);return s}const COe={useVisualState:lQ({scrapeMotionValuesFromProps:cF,createRenderState:aF})};function cQ(e,t,n){const r=cF(e,t,n);for(const s in e)if(La(e[s])||La(t[s])){const i=gb.indexOf(s)!==-1?"attr"+s.charAt(0).toUpperCase()+s.substring(1):s;r[i]=e[s]}return r}const kOe={useVisualState:lQ({scrapeMotionValuesFromProps:cQ,createRenderState:aQ})};function EOe(e,t){return function(r,{forwardMotionProps:s}={forwardMotionProps:!1}){const a={...oF(r)?kOe:COe,preloadedFeatures:e,useRender:wOe(s),createVisualElement:t,Component:r};return eOe(a)}}function Ww(e,t,n){const r=e.getProps();return lF(r,t,n!==void 0?n:r.custom,e)}const Qj=e=>Array.isArray(e);let qC;function TOe(){qC=void 0}const Io={now:()=>(qC===void 0&&Io.set(_a.isProcessing||Qd.useManualTiming?_a.timestamp:performance.now()),qC),set:e=>{qC=e,queueMicrotask(TOe)}};function uF(e,t){e.indexOf(t)===-1&&e.push(t)}function dF(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class fF{constructor(){this.subscriptions=[]}add(t){return uF(this.subscriptions,t),()=>dF(this.subscriptions,t)}notify(t,n,r){const s=this.subscriptions.length;if(s)if(s===1)this.subscriptions[0](t,n,r);else for(let i=0;i<s;i++){const a=this.subscriptions[i];a&&a(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function uQ(e,t){return t?e*(1e3/t):0}const M7=30,AOe=e=>!isNaN(parseFloat(e));class ROe{constructor(t,n={}){this.version="__VERSION__",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,s=!0)=>{var a,o;const i=Io.now();this.updatedAt!==i&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&((a=this.events.change)==null||a.notify(this.current)),s&&((o=this.events.renderRequest)==null||o.notify(this.current))},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=Io.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=AOe(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new fF);const r=this.events[t].add(n);return t==="change"?()=>{r(),ri.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return this.current}getPrevious(){return this.prev}getVelocity(){const t=Io.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>M7)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,M7);return uQ(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){var t;(t=this.events.destroy)==null||t.notify(),this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function Hw(e,t){return new ROe(e,t)}function NOe(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,Hw(n))}function MOe(e){return Qj(e)?e[e.length-1]||0:e}function IOe(e,t){const n=Ww(e,t);let{transitionEnd:r={},transition:s={},...i}=n||{};i={...i,...r};for(const a in i){const o=MOe(i[a]);NOe(e,a,o)}}function jOe(e){return!!(La(e)&&e.add)}function e4(e,t){const n=e.getValue("willChange");if(jOe(n))return n.add(t);if(!n&&Qd.WillChange){const r=new Qd.WillChange("auto");e.addValue("willChange",r),r.add(t)}}function dQ(e){return e.props[JJ]}const POe=e=>e!==null;function OOe(e,{repeat:t,repeatType:n="loop"},r){const s=e.filter(POe),i=t&&n!=="loop"&&t%2===1?0:s.length-1;return s[i]}const DOe={type:"spring",stiffness:500,damping:25,restSpeed:10},FOe=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),LOe={type:"keyframes",duration:.8},BOe={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},$Oe=(e,{keyframes:t})=>t.length>2?LOe:yb.has(e)?e.startsWith("scale")?FOe(t[1]):DOe:BOe;function zOe({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:s,repeat:i,repeatType:a,repeatDelay:o,from:l,elapsed:c,...u}){return!!Object.keys(u).length}function hF(e,t){return(e==null?void 0:e[t])??(e==null?void 0:e.default)??e}const Nu=e=>e*1e3,Mu=e=>e/1e3,Ix=e=>Math.round(e*1e5)/1e5,pF=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function UOe(e){return e==null}const qOe=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,mF=(e,t)=>n=>!!(typeof n=="string"&&qOe.test(n)&&n.startsWith(e)||t&&!UOe(n)&&Object.prototype.hasOwnProperty.call(n,t)),fQ=(e,t,n)=>r=>{if(typeof r!="string")return r;const[s,i,a,o]=r.match(pF);return{[e]:parseFloat(s),[t]:parseFloat(i),[n]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},VOe=e=>ef(0,255,e),DI={...bb,transform:e=>Math.round(VOe(e))},cm={test:mF("rgb","red"),parse:fQ("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+DI.transform(e)+", "+DI.transform(t)+", "+DI.transform(n)+", "+Ix(Vw.transform(r))+")"};function WOe(e){let t="",n="",r="",s="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),s=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),s=e.substring(4,5),t+=t,n+=n,r+=r,s+=s),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:s?parseInt(s,16)/255:1}}const t4={test:mF("#"),parse:WOe,transform:cm.transform},A0={test:mF("hsl","hue"),parse:fQ("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+Ru.transform(Ix(t))+", "+Ru.transform(Ix(n))+", "+Ix(Vw.transform(r))+")"},Pa={test:e=>cm.test(e)||t4.test(e)||A0.test(e),parse:e=>cm.test(e)?cm.parse(e):A0.test(e)?A0.parse(e):t4.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?cm.transform(e):A0.transform(e)},HOe=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function GOe(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(pF))==null?void 0:t.length)||0)+(((n=e.match(HOe))==null?void 0:n.length)||0)>0}const hQ="number",pQ="color",KOe="var",YOe="var(",I7="${}",ZOe=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function Gw(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},s=[];let i=0;const o=t.replace(ZOe,l=>(Pa.test(l)?(r.color.push(i),s.push(pQ),n.push(Pa.parse(l))):l.startsWith(YOe)?(r.var.push(i),s.push(KOe),n.push(l)):(r.number.push(i),s.push(hQ),n.push(parseFloat(l))),++i,I7)).split(I7);return{values:n,split:o,indexes:r,types:s}}function mQ(e){return Gw(e).values}function gQ(e){const{split:t,types:n}=Gw(e),r=t.length;return s=>{let i="";for(let a=0;a<r;a++)if(i+=t[a],s[a]!==void 0){const o=n[a];o===hQ?i+=Ix(s[a]):o===pQ?i+=Pa.transform(s[a]):i+=s[a]}return i}}const XOe=e=>typeof e=="number"?0:e;function JOe(e){const t=mQ(e);return gQ(e)(t.map(XOe))}const Vh={test:GOe,parse:mQ,createTransformer:gQ,getAnimatableNone:JOe};function FI(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function QOe({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let s=0,i=0,a=0;if(!t)s=i=a=n;else{const o=n<.5?n*(1+t):n+t-n*t,l=2*n-o;s=FI(l,o,e+1/3),i=FI(l,o,e),a=FI(l,o,e-1/3)}return{red:Math.round(s*255),green:Math.round(i*255),blue:Math.round(a*255),alpha:r}}function _k(e,t){return n=>n>0?t:e}const ti=(e,t,n)=>e+(t-e)*n,LI=(e,t,n)=>{const r=e*e,s=n*(t*t-r)+r;return s<0?0:Math.sqrt(s)},eDe=[t4,cm,A0],tDe=e=>eDe.find(t=>t.test(e));function j7(e){const t=tDe(e);if(!t)return!1;let n=t.parse(e);return t===A0&&(n=QOe(n)),n}const P7=(e,t)=>{const n=j7(e),r=j7(t);if(!n||!r)return _k(e,t);const s={...n};return i=>(s.red=LI(n.red,r.red,i),s.green=LI(n.green,r.green,i),s.blue=LI(n.blue,r.blue,i),s.alpha=ti(n.alpha,r.alpha,i),cm.transform(s))},n4=new Set(["none","hidden"]);function nDe(e,t){return n4.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}const rDe=(e,t)=>n=>t(e(n)),Q1=(...e)=>e.reduce(rDe);function sDe(e,t){return n=>ti(e,t,n)}function gF(e){return typeof e=="number"?sDe:typeof e=="string"?rF(e)?_k:Pa.test(e)?P7:oDe:Array.isArray(e)?yQ:typeof e=="object"?Pa.test(e)?P7:iDe:_k}function yQ(e,t){const n=[...e],r=n.length,s=e.map((i,a)=>gF(i)(i,t[a]));return i=>{for(let a=0;a<r;a++)n[a]=s[a](i);return n}}function iDe(e,t){const n={...e,...t},r={};for(const s in n)e[s]!==void 0&&t[s]!==void 0&&(r[s]=gF(e[s])(e[s],t[s]));return s=>{for(const i in r)n[i]=r[i](s);return n}}function aDe(e,t){const n=[],r={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const i=t.types[s],a=e.indexes[i][r[i]],o=e.values[a]??0;n[s]=o,r[i]++}return n}const oDe=(e,t)=>{const n=Vh.createTransformer(t),r=Gw(e),s=Gw(t);return r.indexes.var.length===s.indexes.var.length&&r.indexes.color.length===s.indexes.color.length&&r.indexes.number.length>=s.indexes.number.length?n4.has(e)&&!s.values.length||n4.has(t)&&!r.values.length?nDe(e,t):Q1(yQ(aDe(r,s),s.values),n):_k(e,t)};function bQ(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?ti(e,t,n):gF(e)(e,t)}const lDe=e=>{const t=({timestamp:n})=>e(n);return{start:()=>ri.update(t,!0),stop:()=>qh(t),now:()=>_a.isProcessing?_a.timestamp:Io.now()}},vQ=(e,t,n=10)=>{let r="";const s=Math.max(Math.round(t/n),2);for(let i=0;i<s;i++)r+=e(i/(s-1))+", ";return`linear(${r.substring(0,r.length-2)})`},Sk=2e4;function yF(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<Sk;)t+=n,r=e.next(t);return t>=Sk?1/0:t}function cDe(e,t=100,n){const r=n({...e,keyframes:[0,t]}),s=Math.min(yF(r),Sk);return{type:"keyframes",ease:i=>r.next(s*i).value/t,duration:Mu(s)}}const uDe=5;function xQ(e,t,n){const r=Math.max(t-uDe,0);return uQ(n-e(r),t-r)}const li={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},O7=.001;function dDe({duration:e=li.duration,bounce:t=li.bounce,velocity:n=li.velocity,mass:r=li.mass}){let s,i,a=1-t;a=ef(li.minDamping,li.maxDamping,a),e=ef(li.minDuration,li.maxDuration,Mu(e)),a<1?(s=c=>{const u=c*a,d=u*e,h=u-n,m=r4(c,a),y=Math.exp(-d);return O7-h/m*y},i=c=>{const d=c*a*e,h=d*n+n,m=Math.pow(a,2)*Math.pow(c,2)*e,y=Math.exp(-d),b=r4(Math.pow(c,2),a);return(-s(c)+O7>0?-1:1)*((h-m)*y)/b}):(s=c=>{const u=Math.exp(-c*e),d=(c-n)*e+1;return-.001+u*d},i=c=>{const u=Math.exp(-c*e),d=(n-c)*(e*e);return u*d});const o=5/e,l=hDe(s,i,o);if(e=Nu(e),isNaN(l))return{stiffness:li.stiffness,damping:li.damping,duration:e};{const c=Math.pow(l,2)*r;return{stiffness:c,damping:a*2*Math.sqrt(r*c),duration:e}}}const fDe=12;function hDe(e,t,n){let r=n;for(let s=1;s<fDe;s++)r=r-e(r)/t(r);return r}function r4(e,t){return e*Math.sqrt(1-t*t)}const pDe=["duration","bounce"],mDe=["stiffness","damping","mass"];function D7(e,t){return t.some(n=>e[n]!==void 0)}function gDe(e){let t={velocity:li.velocity,stiffness:li.stiffness,damping:li.damping,mass:li.mass,isResolvedFromDuration:!1,...e};if(!D7(e,mDe)&&D7(e,pDe))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),s=r*r,i=2*ef(.05,1,1-(e.bounce||0))*Math.sqrt(s);t={...t,mass:li.mass,stiffness:s,damping:i}}else{const n=dDe(e);t={...t,...n,mass:li.mass},t.isResolvedFromDuration=!0}return t}function Ck(e=li.visualDuration,t=li.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:s}=n;const i=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],o={done:!1,value:i},{stiffness:l,damping:c,mass:u,duration:d,velocity:h,isResolvedFromDuration:m}=gDe({...n,velocity:-Mu(n.velocity||0)}),y=h||0,b=c/(2*Math.sqrt(l*u)),v=a-i,x=Mu(Math.sqrt(l/u)),w=Math.abs(v)<5;r||(r=w?li.restSpeed.granular:li.restSpeed.default),s||(s=w?li.restDelta.granular:li.restDelta.default);let S;if(b<1){const C=r4(x,b);S=T=>{const A=Math.exp(-b*x*T);return a-A*((y+b*x*v)/C*Math.sin(C*T)+v*Math.cos(C*T))}}else if(b===1)S=C=>a-Math.exp(-x*C)*(v+(y+x*v)*C);else{const C=x*Math.sqrt(b*b-1);S=T=>{const A=Math.exp(-b*x*T),N=Math.min(C*T,300);return a-A*((y+b*x*v)*Math.sinh(N)+C*v*Math.cosh(N))/C}}const k={calculatedDuration:m&&d||null,next:C=>{const T=S(C);if(m)o.done=C>=d;else{let A=C===0?y:0;b<1&&(A=C===0?Nu(y):xQ(S,C,T));const N=Math.abs(A)<=r,I=Math.abs(a-T)<=s;o.done=N&&I}return o.value=o.done?a:T,o},toString:()=>{const C=Math.min(yF(k),Sk),T=vQ(A=>k.next(C*A).value,C,30);return C+"ms "+T},toTransition:()=>{}};return k}Ck.applyToOptions=e=>{const t=cDe(e,100,Ck);return e.ease=t.ease,e.duration=Nu(t.duration),e.type="keyframes",e};function s4({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:s=10,bounceStiffness:i=500,modifyTarget:a,min:o,max:l,restDelta:c=.5,restSpeed:u}){const d=e[0],h={done:!1,value:d},m=N=>o!==void 0&&N<o||l!==void 0&&N>l,y=N=>o===void 0?l:l===void 0||Math.abs(o-N)<Math.abs(l-N)?o:l;let b=n*t;const v=d+b,x=a===void 0?v:a(v);x!==v&&(b=x-d);const w=N=>-b*Math.exp(-N/r),S=N=>x+w(N),k=N=>{const I=w(N),O=S(N);h.done=Math.abs(I)<=c,h.value=h.done?x:O};let C,T;const A=N=>{m(h.value)&&(C=N,T=Ck({keyframes:[h.value,y(h.value)],velocity:xQ(S,N,h.value),damping:s,stiffness:i,restDelta:c,restSpeed:u}))};return A(0),{calculatedDuration:null,next:N=>{let I=!1;return!T&&C===void 0&&(I=!0,k(N),A(N)),C!==void 0&&N>=C?T.next(N-C):(!I&&k(N),h)}}}const Kw=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r};function yDe(e,t,n){const r=[],s=n||Qd.mix||bQ,i=e.length-1;for(let a=0;a<i;a++){let o=s(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||Hl:t;o=Q1(l,o)}r.push(o)}return r}function bDe(e,t,{clamp:n=!0,ease:r,mixer:s}={}){const i=e.length;if(tF(i===t.length),i===1)return()=>t[0];if(i===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[i-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=yDe(t,r,s),l=o.length,c=u=>{if(a&&u<e[0])return t[0];let d=0;if(l>1)for(;d<e.length-2&&!(u<e[d+1]);d++);const h=Kw(e[d],e[d+1],u);return o[d](h)};return n?u=>c(ef(e[0],e[i-1],u)):c}function vDe(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const s=Kw(0,t,r);e.push(ti(n,1,s))}}function xDe(e){const t=[0];return vDe(t,e.length-1),t}function wDe(e,t){return e.map(n=>n*t)}const wQ=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,_De=1e-7,SDe=12;function CDe(e,t,n,r,s){let i,a,o=0;do a=t+(n-t)/2,i=wQ(a,r,s)-e,i>0?n=a:t=a;while(Math.abs(i)>_De&&++o<SDe);return a}function e_(e,t,n,r){if(e===t&&n===r)return Hl;const s=i=>CDe(i,0,1,e,n);return i=>i===0||i===1?i:wQ(s(i),t,r)}const kDe=e_(.42,0,1,1),EDe=e_(0,0,.58,1),_Q=e_(.42,0,.58,1),TDe=e=>Array.isArray(e)&&typeof e[0]!="number",SQ=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,CQ=e=>t=>1-e(1-t),kQ=e_(.33,1.53,.69,.99),bF=CQ(kQ),EQ=SQ(bF),TQ=e=>(e*=2)<1?.5*bF(e):.5*(2-Math.pow(2,-10*(e-1))),vF=e=>1-Math.sin(Math.acos(e)),AQ=CQ(vF),RQ=SQ(vF),NQ=e=>Array.isArray(e)&&typeof e[0]=="number",ADe={linear:Hl,easeIn:kDe,easeInOut:_Q,easeOut:EDe,circIn:vF,circInOut:RQ,circOut:AQ,backIn:bF,backInOut:EQ,backOut:kQ,anticipate:TQ},RDe=e=>typeof e=="string",F7=e=>{if(NQ(e)){tF(e.length===4);const[t,n,r,s]=e;return e_(t,n,r,s)}else if(RDe(e))return ADe[e];return e};function NDe(e,t){return e.map(()=>t||_Q).splice(0,e.length-1)}function jx({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const s=TDe(r)?r.map(F7):F7(r),i={done:!1,value:t[0]},a=wDe(n&&n.length===t.length?n:xDe(t),e),o=bDe(a,t,{ease:Array.isArray(s)?s:NDe(t,s)});return{calculatedDuration:e,next:l=>(i.value=o(l),i.done=l>=e,i)}}const MDe=e=>e!==null;function xF(e,{repeat:t,repeatType:n="loop"},r,s=1){const i=e.filter(MDe),o=s<0||t&&n!=="loop"&&t%2===1?0:i.length-1;return!o||r===void 0?i[o]:r}const IDe={decay:s4,inertia:s4,tween:jx,keyframes:jx,spring:Ck};function MQ(e){typeof e.type=="string"&&(e.type=IDe[e.type])}class wF{constructor(){this.count=0,this.updateFinished()}get finished(){return this._finished}updateFinished(){this.count++,this._finished=new Promise(t=>{this.resolve=t})}notifyFinished(){this.resolve()}then(t,n){return this.finished.then(t,n)}}const jDe=e=>e/100;class IQ extends wF{constructor(t){super(),this.state="idle",this.startTime=null,this.isStopped=!1,this.currentTime=0,this.holdTime=null,this.playbackSpeed=1,this.stop=()=>{const{motionValue:n}=this.options;if(n&&n.updatedAt!==Io.now()&&this.tick(Io.now()),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:r}=this.options;r&&r()},this.options=t,this.initAnimation(),this.play(),t.autoplay===!1&&this.pause()}initAnimation(){const{options:t}=this;MQ(t);const{type:n=jx,repeat:r=0,repeatDelay:s=0,repeatType:i,velocity:a=0}=t;let{keyframes:o}=t;const l=n||jx;l!==jx&&typeof o[0]!="number"&&(this.mixKeyframes=Q1(jDe,bQ(o[0],o[1])),o=[0,100]);const c=l({...t,keyframes:o});i==="mirror"&&(this.mirroredGenerator=l({...t,keyframes:[...o].reverse(),velocity:-a})),c.calculatedDuration===null&&(c.calculatedDuration=yF(c));const{calculatedDuration:u}=c;this.calculatedDuration=u,this.resolvedDuration=u+s,this.totalDuration=this.resolvedDuration*(r+1)-s,this.generator=c}updateTime(t){const n=Math.round(t-this.startTime)*this.playbackSpeed;this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=n}tick(t,n=!1){const{generator:r,totalDuration:s,mixKeyframes:i,mirroredGenerator:a,resolvedDuration:o,calculatedDuration:l}=this;if(this.startTime===null)return r.next(0);const{delay:c=0,keyframes:u,repeat:d,repeatType:h,repeatDelay:m,type:y,onUpdate:b,finalKeyframe:v}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-s/this.speed,this.startTime)),n?this.currentTime=t:this.updateTime(t);const x=this.currentTime-c*(this.playbackSpeed>=0?1:-1),w=this.playbackSpeed>=0?x<0:x>s;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=s);let S=this.currentTime,k=r;if(d){const N=Math.min(this.currentTime,s)/o;let I=Math.floor(N),O=N%1;!O&&N>=1&&(O=1),O===1&&I--,I=Math.min(I,d+1),!!(I%2)&&(h==="reverse"?(O=1-O,m&&(O-=m/o)):h==="mirror"&&(k=a)),S=ef(0,1,O)*o}const C=w?{done:!1,value:u[0]}:k.next(S);i&&(C.value=i(C.value));let{done:T}=C;!w&&l!==null&&(T=this.playbackSpeed>=0?this.currentTime>=s:this.currentTime<=0);const A=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&T);return A&&y!==s4&&(C.value=xF(u,this.options,v,this.speed)),b&&b(C.value),A&&this.finish(),C}then(t,n){return this.finished.then(t,n)}get duration(){return Mu(this.calculatedDuration)}get time(){return Mu(this.currentTime)}set time(t){t=Nu(t),this.currentTime=t,this.startTime===null||this.holdTime!==null||this.playbackSpeed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.playbackSpeed)}get speed(){return this.playbackSpeed}set speed(t){this.updateTime(Io.now());const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=Mu(this.currentTime))}play(){if(this.isStopped)return;const{driver:t=lDe,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=t(i=>this.tick(i))),n&&n();const s=this.driver.now();this.state==="finished"?(this.updateFinished(),this.startTime=s):this.holdTime!==null?this.startTime=s-this.holdTime:this.startTime||(this.startTime=r??s),this.state==="finished"&&this.speed<0&&(this.startTime+=this.calculatedDuration),this.holdTime=null,this.state="running",this.driver.start()}pause(){this.state="paused",this.updateTime(Io.now()),this.holdTime=this.currentTime}complete(){this.state!=="running"&&this.play(),this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.holdTime=null,this.startTime=0,this.tick(0),this.teardown()}teardown(){this.notifyFinished(),this.state="idle",this.stopDriver(),this.startTime=this.holdTime=null}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}attachTimeline(t){return this.options.allowFlatten&&(this.options.type="keyframes",this.options.ease="linear",this.initAnimation()),t.observe(this)}}function PDe(e){for(let t=1;t<e.length;t++)e[t]??(e[t]=e[t-1])}const um=e=>e*180/Math.PI,i4=e=>{const t=um(Math.atan2(e[1],e[0]));return a4(t)},ODe={x:4,y:5,translateX:4,translateY:5,scaleX:0,scaleY:3,scale:e=>(Math.abs(e[0])+Math.abs(e[3]))/2,rotate:i4,rotateZ:i4,skewX:e=>um(Math.atan(e[1])),skewY:e=>um(Math.atan(e[2])),skew:e=>(Math.abs(e[1])+Math.abs(e[2]))/2},a4=e=>(e=e%360,e<0&&(e+=360),e),L7=i4,B7=e=>Math.sqrt(e[0]*e[0]+e[1]*e[1]),$7=e=>Math.sqrt(e[4]*e[4]+e[5]*e[5]),DDe={x:12,y:13,z:14,translateX:12,translateY:13,translateZ:14,scaleX:B7,scaleY:$7,scale:e=>(B7(e)+$7(e))/2,rotateX:e=>a4(um(Math.atan2(e[6],e[5]))),rotateY:e=>a4(um(Math.atan2(-e[2],e[0]))),rotateZ:L7,rotate:L7,skewX:e=>um(Math.atan(e[4])),skewY:e=>um(Math.atan(e[1])),skew:e=>(Math.abs(e[1])+Math.abs(e[4]))/2};function z7(e){return e.includes("scale")?1:0}function o4(e,t){if(!e||e==="none")return z7(t);const n=e.match(/^matrix3d\(([-\d.e\s,]+)\)$/u);let r,s;if(n)r=DDe,s=n;else{const o=e.match(/^matrix\(([-\d.e\s,]+)\)$/u);r=ODe,s=o}if(!s)return z7(t);const i=r[t],a=s[1].split(",").map(LDe);return typeof i=="function"?i(a):a[i]}const FDe=(e,t)=>{const{transform:n="none"}=getComputedStyle(e);return o4(n,t)};function LDe(e){return parseFloat(e.trim())}const U7=e=>e===bb||e===lr,BDe=new Set(["x","y","z"]),$De=gb.filter(e=>!BDe.has(e));function zDe(e){const t=[];return $De.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const bm={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:(e,{transform:t})=>o4(t,"x"),y:(e,{transform:t})=>o4(t,"y")};bm.translateX=bm.x;bm.translateY=bm.y;const vm=new Set;let l4=!1,c4=!1,u4=!1;function jQ(){if(c4){const e=Array.from(vm).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const s=zDe(r);s.length&&(n.set(r,s),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const s=n.get(r);s&&s.forEach(([i,a])=>{var o;(o=r.getValue(i))==null||o.set(a)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}c4=!1,l4=!1,vm.forEach(e=>e.complete(u4)),vm.clear()}function PQ(){vm.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(c4=!0)})}function UDe(){u4=!0,PQ(),jQ(),u4=!1}class _F{constructor(t,n,r,s,i,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=s,this.element=i,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(vm.add(this),l4||(l4=!0,ri.read(PQ),ri.resolveKeyframes(jQ))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:s}=this;if(t[0]===null){const i=s==null?void 0:s.get(),a=t[t.length-1];if(i!==void 0)t[0]=i;else if(r&&n){const o=r.readValue(n,a);o!=null&&(t[0]=o)}t[0]===void 0&&(t[0]=a),s&&i===void 0&&s.set(t[0])}PDe(t)}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(t=!1){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe,t),vm.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,vm.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const qDe=e=>e.startsWith("--");function VDe(e,t,n){qDe(t)?e.style.setProperty(t,n):e.style[t]=n}function SF(e){let t;return()=>(t===void 0&&(t=e()),t)}const WDe=SF(()=>window.ScrollTimeline!==void 0),HDe={};function GDe(e,t){const n=SF(e);return()=>HDe[t]??n()}const OQ=GDe(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),cx=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,q7={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:cx([0,.65,.55,1]),circOut:cx([.55,0,1,.45]),backIn:cx([.31,.01,.66,-.59]),backOut:cx([.33,1.53,.69,.99])};function DQ(e,t){if(e)return typeof e=="function"?OQ()?vQ(e,t):"ease-out":NQ(e)?cx(e):Array.isArray(e)?e.map(n=>DQ(n,t)||q7.easeOut):q7[e]}function KDe(e,t,n,{delay:r=0,duration:s=300,repeat:i=0,repeatType:a="loop",ease:o="easeOut",times:l}={},c=void 0){const u={[t]:n};l&&(u.offset=l);const d=DQ(o,s);Array.isArray(d)&&(u.easing=d);const h={delay:r,duration:s,easing:Array.isArray(d)?"linear":d,fill:"both",iterations:i+1,direction:a==="reverse"?"alternate":"normal"};return c&&(h.pseudoElement=c),e.animate(u,h)}function FQ(e){return typeof e=="function"&&"applyToOptions"in e}function YDe({type:e,...t}){return FQ(e)&&OQ()?e.applyToOptions(t):(t.duration??(t.duration=300),t.ease??(t.ease="easeOut"),t)}class ZDe extends wF{constructor(t){if(super(),this.finishedTime=null,this.isStopped=!1,!t)return;const{element:n,name:r,keyframes:s,pseudoElement:i,allowFlatten:a=!1,finalKeyframe:o,onComplete:l}=t;this.isPseudoElement=!!i,this.allowFlatten=a,this.options=t,tF(typeof t.type!="string");const c=YDe(t);this.animation=KDe(n,r,s,c,i),c.autoplay===!1&&this.animation.pause(),this.animation.onfinish=()=>{if(this.finishedTime=this.time,!i){const u=xF(s,this.options,o,this.speed);this.updateMotionValue?this.updateMotionValue(u):VDe(n,r,u),this.animation.cancel()}l==null||l(),this.notifyFinished()},this.animation.oncancel=()=>this.notifyFinished()}play(){this.isStopped||(this.animation.play(),this.state==="finished"&&this.updateFinished())}pause(){this.animation.pause()}complete(){var t,n;(n=(t=this.animation).finish)==null||n.call(t)}cancel(){try{this.animation.cancel()}catch{}}stop(){if(this.isStopped)return;this.isStopped=!0;const{state:t}=this;t==="idle"||t==="finished"||(this.updateMotionValue?this.updateMotionValue():this.commitStyles(),this.isPseudoElement||this.cancel())}commitStyles(){var t,n;this.isPseudoElement||(n=(t=this.animation).commitStyles)==null||n.call(t)}get duration(){var n,r;const t=((r=(n=this.animation.effect)==null?void 0:n.getComputedTiming)==null?void 0:r.call(n).duration)||0;return Mu(Number(t))}get time(){return Mu(Number(this.animation.currentTime)||0)}set time(t){this.finishedTime=null,this.animation.currentTime=Nu(t)}get speed(){return this.animation.playbackRate}set speed(t){t<0&&(this.finishedTime=null),this.animation.playbackRate=t}get state(){return this.finishedTime!==null?"finished":this.animation.playState}get startTime(){return Number(this.animation.startTime)}set startTime(t){this.animation.startTime=t}attachTimeline({timeline:t,observe:n}){var r;return this.allowFlatten&&((r=this.animation.effect)==null||r.updateTiming({easing:"linear"})),this.animation.onfinish=null,t&&WDe()?(this.animation.timeline=t,Hl):n(this)}}const LQ={anticipate:TQ,backInOut:EQ,circInOut:RQ};function XDe(e){return e in LQ}function JDe(e){typeof e.ease=="string"&&XDe(e.ease)&&(e.ease=LQ[e.ease])}const V7=10;class QDe extends ZDe{constructor(t){JDe(t),MQ(t),super(t),t.startTime&&(this.startTime=t.startTime),this.options=t}updateMotionValue(t){const{motionValue:n,onUpdate:r,onComplete:s,element:i,...a}=this.options;if(!n)return;if(t!==void 0){n.set(t);return}const o=new IQ({...a,autoplay:!1}),l=Nu(this.finishedTime??this.time);n.setWithVelocity(o.sample(l-V7).value,o.sample(l).value,V7),o.stop()}}const W7=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Vh.test(e)||e==="0")&&!e.startsWith("url("));function eFe(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function tFe(e,t,n,r){const s=e[0];if(s===null)return!1;if(t==="display"||t==="visibility")return!0;const i=e[e.length-1],a=W7(s,t),o=W7(i,t);return!a||!o?!1:eFe(e)||(n==="spring"||FQ(n))&&r}const nFe=new Set(["opacity","clipPath","filter","transform"]),rFe=SF(()=>Object.hasOwnProperty.call(Element.prototype,"animate"));function sFe(e){const{motionValue:t,name:n,repeatDelay:r,repeatType:s,damping:i,type:a}=e;if(!t||!t.owner||!(t.owner.current instanceof HTMLElement))return!1;const{onUpdate:o,transformTemplate:l}=t.owner.getProps();return rFe()&&n&&nFe.has(n)&&(n!=="transform"||!l)&&!o&&!r&&s!=="mirror"&&i!==0&&a!=="inertia"}const iFe=40;class aFe extends wF{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:s=0,repeatDelay:i=0,repeatType:a="loop",keyframes:o,name:l,motionValue:c,element:u,...d}){var y;super(),this.stop=()=>{var b,v;this._animation?(this._animation.stop(),(b=this.stopTimeline)==null||b.call(this)):(v=this.keyframeResolver)==null||v.cancel()},this.createdAt=Io.now();const h={autoplay:t,delay:n,type:r,repeat:s,repeatDelay:i,repeatType:a,name:l,motionValue:c,element:u,...d},m=(u==null?void 0:u.KeyframeResolver)||_F;this.keyframeResolver=new m(o,(b,v,x)=>this.onKeyframesResolved(b,v,h,!x),l,c,u),(y=this.keyframeResolver)==null||y.scheduleResolve()}onKeyframesResolved(t,n,r,s){this.keyframeResolver=void 0;const{name:i,type:a,velocity:o,delay:l,isHandoff:c,onUpdate:u}=r;this.resolvedAt=Io.now(),tFe(t,i,a,o)||((Qd.instantAnimations||!l)&&(u==null||u(xF(t,r,n))),t[0]=t[t.length-1],r.duration=0,r.repeat=0);const h={startTime:s?this.resolvedAt?this.resolvedAt-this.createdAt>iFe?this.resolvedAt:this.createdAt:this.createdAt:void 0,finalKeyframe:n,...r,keyframes:t},m=!c&&sFe(h)?new QDe({...h,element:h.motionValue.owner.current}):new IQ(h);m.finished.then(()=>this.notifyFinished()).catch(Hl),this.pendingTimeline&&(this.stopTimeline=m.attachTimeline(this.pendingTimeline),this.pendingTimeline=void 0),this._animation=m}get finished(){return this._animation?this.animation.finished:this._finished}then(t,n){return this.finished.finally(t).then(()=>{})}get animation(){return this._animation||UDe(),this._animation}get duration(){return this.animation.duration}get time(){return this.animation.time}set time(t){this.animation.time=t}get speed(){return this.animation.speed}get state(){return this.animation.state}set speed(t){this.animation.speed=t}get startTime(){return this.animation.startTime}attachTimeline(t){return this._animation?this.stopTimeline=this.animation.attachTimeline(t):this.pendingTimeline=t,()=>this.stop()}play(){this.animation.play()}pause(){this.animation.pause()}complete(){this.animation.complete()}cancel(){this.animation.cancel()}}const CF=(e,t,n,r={},s,i)=>a=>{const o=hF(r,e)||{},l=o.delay||r.delay||0;let{elapsed:c=0}=r;c=c-Nu(l);const u={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-c,onUpdate:h=>{t.set(h),o.onUpdate&&o.onUpdate(h)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:i?void 0:s};zOe(o)||Object.assign(u,$Oe(e,u)),u.duration&&(u.duration=Nu(u.duration)),u.repeatDelay&&(u.repeatDelay=Nu(u.repeatDelay)),u.from!==void 0&&(u.keyframes[0]=u.from);let d=!1;if((u.type===!1||u.duration===0&&!u.repeatDelay)&&(u.duration=0,u.delay===0&&(d=!0)),(Qd.instantAnimations||Qd.skipAnimations)&&(d=!0,u.duration=0,u.delay=0),u.allowFlatten=!o.type&&!o.ease,d&&!i&&t.get()!==void 0){const h=OOe(u.keyframes,o);if(h!==void 0){ri.update(()=>{u.onUpdate(h),u.onComplete()});return}}return new aFe(u)},BQ=new Set(["width","height","top","left","right","bottom",...gb]);function oFe({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function $Q(e,t,{delay:n=0,transitionOverride:r,type:s}={}){let{transition:i=e.getDefaultTransition(),transitionEnd:a,...o}=t;r&&(i=r);const l=[],c=s&&e.animationState&&e.animationState.getState()[s];for(const u in o){const d=e.getValue(u,e.latestValues[u]??null),h=o[u];if(h===void 0||c&&oFe(c,u))continue;const m={delay:n,...hF(i||{},u)},y=d.get();if(y!==void 0&&!d.isAnimating&&!Array.isArray(h)&&h===y&&!m.velocity)continue;let b=!1;if(window.MotionHandoffAnimation){const x=dQ(e);if(x){const w=window.MotionHandoffAnimation(x,u,ri);w!==null&&(m.startTime=w,b=!0)}}e4(e,u),d.start(CF(u,d,h,e.shouldReduceMotion&&BQ.has(u)?{type:!1}:m,e,b));const v=d.animation;v&&l.push(v)}return a&&Promise.all(l).then(()=>{ri.update(()=>{a&&IOe(e,a)})}),l}function d4(e,t,n={}){var l;const r=Ww(e,t,n.type==="exit"?(l=e.presenceContext)==null?void 0:l.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=r||{};n.transitionOverride&&(s=n.transitionOverride);const i=r?()=>Promise.all($Q(e,r,n)):()=>Promise.resolve(),a=e.variantChildren&&e.variantChildren.size?(c=0)=>{const{delayChildren:u=0,staggerChildren:d,staggerDirection:h}=s;return lFe(e,t,u+c,d,h,n)}:()=>Promise.resolve(),{when:o}=s;if(o){const[c,u]=o==="beforeChildren"?[i,a]:[a,i];return c().then(()=>u())}else return Promise.all([i(),a(n.delay)])}function lFe(e,t,n=0,r=0,s=1,i){const a=[],o=(e.variantChildren.size-1)*r,l=s===1?(c=0)=>c*r:(c=0)=>o-c*r;return Array.from(e.variantChildren).sort(cFe).forEach((c,u)=>{c.notify("AnimationStart",t),a.push(d4(c,t,{...i,delay:n+l(u)}).then(()=>c.notify("AnimationComplete",t)))}),Promise.all(a)}function cFe(e,t){return e.sortNodePosition(t)}function uFe(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const s=t.map(i=>d4(e,i,n));r=Promise.all(s)}else if(typeof t=="string")r=d4(e,t,n);else{const s=typeof t=="function"?Ww(e,t,n.custom):t;r=Promise.all($Q(e,s,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}function zQ(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}const dFe=JD.length;function UQ(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?UQ(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<dFe;n++){const r=JD[n],s=e.props[r];(Uw(s)||s===!1)&&(t[r]=s)}return t}const fFe=[...XD].reverse(),hFe=XD.length;function pFe(e){return t=>Promise.all(t.map(({animation:n,options:r})=>uFe(e,n,r)))}function mFe(e){let t=pFe(e),n=H7(),r=!0;const s=l=>(c,u)=>{var h;const d=Ww(e,u,l==="exit"?(h=e.presenceContext)==null?void 0:h.custom:void 0);if(d){const{transition:m,transitionEnd:y,...b}=d;c={...c,...b,...y}}return c};function i(l){t=l(e)}function a(l){const{props:c}=e,u=UQ(e.parent)||{},d=[],h=new Set;let m={},y=1/0;for(let v=0;v<hFe;v++){const x=fFe[v],w=n[x],S=c[x]!==void 0?c[x]:u[x],k=Uw(S),C=x===l?w.isActive:null;C===!1&&(y=v);let T=S===u[x]&&S!==c[x]&&k;if(T&&r&&e.manuallyAnimateOnMount&&(T=!1),w.protectedKeys={...m},!w.isActive&&C===null||!S&&!w.prevProp||RT(S)||typeof S=="boolean")continue;const A=gFe(w.prevProp,S);let N=A||x===l&&w.isActive&&!T&&k||v>y&&k,I=!1;const O=Array.isArray(S)?S:[S];let B=O.reduce(s(x),{});C===!1&&(B={});const{prevResolvedValues:D={}}=w,H={...D,...B},P=V=>{N=!0,h.has(V)&&(I=!0,h.delete(V)),w.needsAnimating[V]=!0;const L=e.getValue(V);L&&(L.liveStyle=!1)};for(const V in H){const L=B[V],te=D[V];if(m.hasOwnProperty(V))continue;let W=!1;Qj(L)&&Qj(te)?W=!zQ(L,te):W=L!==te,W?L!=null?P(V):h.add(V):L!==void 0&&h.has(V)?P(V):w.protectedKeys[V]=!0}w.prevProp=S,w.prevResolvedValues=B,w.isActive&&(m={...m,...B}),r&&e.blockInitialAnimation&&(N=!1),N&&(!(T&&A)||I)&&d.push(...O.map(V=>({animation:V,options:{type:x}})))}if(h.size){const v={};if(typeof c.initial!="boolean"){const x=Ww(e,Array.isArray(c.initial)?c.initial[0]:c.initial);x&&x.transition&&(v.transition=x.transition)}h.forEach(x=>{const w=e.getBaseTarget(x),S=e.getValue(x);S&&(S.liveStyle=!0),v[x]=w??null}),d.push({animation:v})}let b=!!d.length;return r&&(c.initial===!1||c.initial===c.animate)&&!e.manuallyAnimateOnMount&&(b=!1),r=!1,b?t(d):Promise.resolve()}function o(l,c){var d;if(n[l].isActive===c)return Promise.resolve();(d=e.variantChildren)==null||d.forEach(h=>{var m;return(m=h.animationState)==null?void 0:m.setActive(l,c)}),n[l].isActive=c;const u=a(l);for(const h in n)n[h].protectedKeys={};return u}return{animateChanges:a,setActive:o,setAnimateFunction:i,getState:()=>n,reset:()=>{n=H7(),r=!0}}}function gFe(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!zQ(t,e):!1}function Kp(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function H7(){return{animate:Kp(!0),whileInView:Kp(),whileHover:Kp(),whileTap:Kp(),whileDrag:Kp(),whileFocus:Kp(),exit:Kp()}}class up{constructor(t){this.isMounted=!1,this.node=t}update(){}}class yFe extends up{constructor(t){super(t),t.animationState||(t.animationState=mFe(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();RT(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)==null||t.call(this)}}let bFe=0;class vFe extends up{constructor(){super(...arguments),this.id=bFe++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const s=this.node.animationState.setActive("exit",!t);n&&!t&&s.then(()=>{n(this.id)})}mount(){const{register:t,onExitComplete:n}=this.node.presenceContext||{};n&&n(this.id),t&&(this.unmount=t(this.id))}unmount(){}}const xFe={animation:{Feature:yFe},exit:{Feature:vFe}};function Yw(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}const kF=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1;function t_(e){return{point:{x:e.pageX,y:e.pageY}}}const wFe=e=>t=>kF(t)&&e(t,t_(t));function Px(e,t,n,r){return Yw(e,t,wFe(n),r)}function qQ({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function _Fe({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function SFe(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}const VQ=1e-4,CFe=1-VQ,kFe=1+VQ,WQ=.01,EFe=0-WQ,TFe=0+WQ;function no(e){return e.max-e.min}function AFe(e,t,n){return Math.abs(e-t)<=n}function G7(e,t,n,r=.5){e.origin=r,e.originPoint=ti(t.min,t.max,e.origin),e.scale=no(n)/no(t),e.translate=ti(n.min,n.max,e.origin)-e.originPoint,(e.scale>=CFe&&e.scale<=kFe||isNaN(e.scale))&&(e.scale=1),(e.translate>=EFe&&e.translate<=TFe||isNaN(e.translate))&&(e.translate=0)}function Ox(e,t,n,r){G7(e.x,t.x,n.x,r?r.originX:void 0),G7(e.y,t.y,n.y,r?r.originY:void 0)}function K7(e,t,n){e.min=n.min+t.min,e.max=e.min+no(t)}function RFe(e,t,n){K7(e.x,t.x,n.x),K7(e.y,t.y,n.y)}function Y7(e,t,n){e.min=t.min-n.min,e.max=e.min+no(t)}function Dx(e,t,n){Y7(e.x,t.x,n.x),Y7(e.y,t.y,n.y)}const Z7=()=>({translate:0,scale:1,origin:0,originPoint:0}),R0=()=>({x:Z7(),y:Z7()}),X7=()=>({min:0,max:0}),gi=()=>({x:X7(),y:X7()});function Ll(e){return[e("x"),e("y")]}function BI(e){return e===void 0||e===1}function f4({scale:e,scaleX:t,scaleY:n}){return!BI(e)||!BI(t)||!BI(n)}function Xp(e){return f4(e)||HQ(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function HQ(e){return J7(e.x)||J7(e.y)}function J7(e){return e&&e!=="0%"}function kk(e,t,n){const r=e-n,s=t*r;return n+s}function Q7(e,t,n,r,s){return s!==void 0&&(e=kk(e,s,r)),kk(e,n,r)+t}function h4(e,t=0,n=1,r,s){e.min=Q7(e.min,t,n,r,s),e.max=Q7(e.max,t,n,r,s)}function GQ(e,{x:t,y:n}){h4(e.x,t.translate,t.scale,t.originPoint),h4(e.y,n.translate,n.scale,n.originPoint)}const eU=.999999999999,tU=1.0000000000001;function NFe(e,t,n,r=!1){const s=n.length;if(!s)return;t.x=t.y=1;let i,a;for(let o=0;o<s;o++){i=n[o],a=i.projectionDelta;const{visualElement:l}=i.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&i.options.layoutScroll&&i.scroll&&i!==i.root&&M0(e,{x:-i.scroll.offset.x,y:-i.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,GQ(e,a)),r&&Xp(i.latestValues)&&M0(e,i.latestValues))}t.x<tU&&t.x>eU&&(t.x=1),t.y<tU&&t.y>eU&&(t.y=1)}function N0(e,t){e.min=e.min+t,e.max=e.max+t}function nU(e,t,n,r,s=.5){const i=ti(e.min,e.max,s);h4(e,t,n,i,r)}function M0(e,t){nU(e.x,t.x,t.scaleX,t.scale,t.originX),nU(e.y,t.y,t.scaleY,t.scale,t.originY)}function KQ(e,t){return qQ(SFe(e.getBoundingClientRect(),t))}function MFe(e,t,n){const r=KQ(e,n),{scroll:s}=t;return s&&(N0(r.x,s.offset.x),N0(r.y,s.offset.y)),r}const YQ=({current:e})=>e?e.ownerDocument.defaultView:null,rU=(e,t)=>Math.abs(e-t);function IFe(e,t){const n=rU(e.x,t.x),r=rU(e.y,t.y);return Math.sqrt(n**2+r**2)}class ZQ{constructor(t,n,{transformPagePoint:r,contextWindow:s,dragSnapToOrigin:i=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const d=zI(this.lastMoveEventInfo,this.history),h=this.startEvent!==null,m=IFe(d.offset,{x:0,y:0})>=3;if(!h&&!m)return;const{point:y}=d,{timestamp:b}=_a;this.history.push({...y,timestamp:b});const{onStart:v,onMove:x}=this.handlers;h||(v&&v(this.lastMoveEvent,d),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,d)},this.handlePointerMove=(d,h)=>{this.lastMoveEvent=d,this.lastMoveEventInfo=$I(h,this.transformPagePoint),ri.update(this.updatePoint,!0)},this.handlePointerUp=(d,h)=>{this.end();const{onEnd:m,onSessionEnd:y,resumeAnimation:b}=this.handlers;if(this.dragSnapToOrigin&&b&&b(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const v=zI(d.type==="pointercancel"?this.lastMoveEventInfo:$I(h,this.transformPagePoint),this.history);this.startEvent&&m&&m(d,v),y&&y(d,v)},!kF(t))return;this.dragSnapToOrigin=i,this.handlers=n,this.transformPagePoint=r,this.contextWindow=s||window;const a=t_(t),o=$I(a,this.transformPagePoint),{point:l}=o,{timestamp:c}=_a;this.history=[{...l,timestamp:c}];const{onSessionStart:u}=n;u&&u(t,zI(o,this.history)),this.removeListeners=Q1(Px(this.contextWindow,"pointermove",this.handlePointerMove),Px(this.contextWindow,"pointerup",this.handlePointerUp),Px(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),qh(this.updatePoint)}}function $I(e,t){return t?{point:t(e.point)}:e}function sU(e,t){return{x:e.x-t.x,y:e.y-t.y}}function zI({point:e},t){return{point:e,delta:sU(e,XQ(t)),offset:sU(e,jFe(t)),velocity:PFe(t,.1)}}function jFe(e){return e[0]}function XQ(e){return e[e.length-1]}function PFe(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const s=XQ(e);for(;n>=0&&(r=e[n],!(s.timestamp-r.timestamp>Nu(t)));)n--;if(!r)return{x:0,y:0};const i=Mu(s.timestamp-r.timestamp);if(i===0)return{x:0,y:0};const a={x:(s.x-r.x)/i,y:(s.y-r.y)/i};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}function OFe(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?ti(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?ti(n,e,r.max):Math.min(e,n)),e}function iU(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function DFe(e,{top:t,left:n,bottom:r,right:s}){return{x:iU(e.x,n,s),y:iU(e.y,t,r)}}function aU(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function FFe(e,t){return{x:aU(e.x,t.x),y:aU(e.y,t.y)}}function LFe(e,t){let n=.5;const r=no(e),s=no(t);return s>r?n=Kw(t.min,t.max-r,e.min):r>s&&(n=Kw(e.min,e.max-s,t.min)),ef(0,1,n)}function BFe(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const p4=.35;function $Fe(e=p4){return e===!1?e=0:e===!0&&(e=p4),{x:oU(e,"left","right"),y:oU(e,"top","bottom")}}function oU(e,t,n){return{min:lU(e,t),max:lU(e,n)}}function lU(e,t){return typeof e=="number"?e:e[t]||0}const gc={x:!1,y:!1};function JQ(){return gc.x||gc.y}function zFe(e){return e==="x"||e==="y"?gc[e]?null:(gc[e]=!0,()=>{gc[e]=!1}):gc.x||gc.y?null:(gc.x=gc.y=!0,()=>{gc.x=gc.y=!1})}const UFe=new WeakMap;class qFe{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=gi(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const s=u=>{const{dragSnapToOrigin:d}=this.getProps();d?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(t_(u).point)},i=(u,d)=>{const{drag:h,dragPropagation:m,onDragStart:y}=this.getProps();if(h&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=zFe(h),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),Ll(v=>{let x=this.getAxisMotionValue(v).get()||0;if(Ru.test(x)){const{projection:w}=this.visualElement;if(w&&w.layout){const S=w.layout.layoutBox[v];S&&(x=no(S)*(parseFloat(x)/100))}}this.originPoint[v]=x}),y&&ri.postRender(()=>y(u,d)),e4(this.visualElement,"transform");const{animationState:b}=this.visualElement;b&&b.setActive("whileDrag",!0)},a=(u,d)=>{const{dragPropagation:h,dragDirectionLock:m,onDirectionLock:y,onDrag:b}=this.getProps();if(!h&&!this.openDragLock)return;const{offset:v}=d;if(m&&this.currentDirection===null){this.currentDirection=VFe(v),this.currentDirection!==null&&y&&y(this.currentDirection);return}this.updateAxis("x",d.point,v),this.updateAxis("y",d.point,v),this.visualElement.render(),b&&b(u,d)},o=(u,d)=>this.stop(u,d),l=()=>Ll(u=>{var d;return this.getAnimationState(u)==="paused"&&((d=this.getAxisMotionValue(u).animation)==null?void 0:d.play())}),{dragSnapToOrigin:c}=this.getProps();this.panSession=new ZQ(t,{onSessionStart:s,onStart:i,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:c,contextWindow:YQ(this.visualElement)})}stop(t,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:s}=n;this.startAnimation(s);const{onDragEnd:i}=this.getProps();i&&ri.postRender(()=>i(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:s}=this.getProps();if(!r||!rC(t,s,this.currentDirection))return;const i=this.getAxisMotionValue(t);let a=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(a=OFe(a,this.constraints[t],this.elastic[t])),i.set(a)}resolveConstraints(){var i;const{dragConstraints:t,dragElastic:n}=this.getProps(),r=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(i=this.visualElement.projection)==null?void 0:i.layout,s=this.constraints;t&&T0(t)?this.constraints||(this.constraints=this.resolveRefConstraints()):t&&r?this.constraints=DFe(r.layoutBox,t):this.constraints=!1,this.elastic=$Fe(n),s!==this.constraints&&r&&this.constraints&&!this.hasMutatedConstraints&&Ll(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=BFe(r.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!T0(t))return!1;const r=t.current,{projection:s}=this.visualElement;if(!s||!s.layout)return!1;const i=MFe(r,s.root,this.visualElement.getTransformPagePoint());let a=FFe(s.layout.layoutBox,i);if(n){const o=n(_Fe(a));this.hasMutatedConstraints=!!o,o&&(a=qQ(o))}return a}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:s,dragTransition:i,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},c=Ll(u=>{if(!rC(u,n,this.currentDirection))return;let d=l&&l[u]||{};a&&(d={min:0,max:0});const h=s?200:1e6,m=s?40:1e7,y={type:"inertia",velocity:r?t[u]:0,bounceStiffness:h,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...i,...d};return this.startAxisValueAnimation(u,y)});return Promise.all(c).then(o)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return e4(this.visualElement,t),r.start(CF(t,r,0,n,this.visualElement,!1))}stopAnimation(){Ll(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){Ll(t=>{var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)==null?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),s=r[n];return s||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){Ll(n=>{const{drag:r}=this.getProps();if(!rC(n,r,this.currentDirection))return;const{projection:s}=this.visualElement,i=this.getAxisMotionValue(n);if(s&&s.layout){const{min:a,max:o}=s.layout.layoutBox[n];i.set(t[n]-ti(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!T0(n)||!r||!this.constraints)return;this.stopAnimation();const s={x:0,y:0};Ll(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();s[a]=LFe({min:l,max:l},this.constraints[a])}});const{transformTemplate:i}=this.visualElement.getProps();this.visualElement.current.style.transform=i?i({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),Ll(a=>{if(!rC(a,t,null))return;const o=this.getAxisMotionValue(a),{min:l,max:c}=this.constraints[a];o.set(ti(l,c,s[a]))})}addListeners(){if(!this.visualElement.current)return;UFe.set(this.visualElement,this);const t=this.visualElement.current,n=Px(t,"pointerdown",l=>{const{drag:c,dragListener:u=!0}=this.getProps();c&&u&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();T0(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:s}=this.visualElement,i=s.addEventListener("measure",r);s&&!s.layout&&(s.root&&s.root.updateScroll(),s.updateLayout()),ri.read(r);const a=Yw(window,"resize",()=>this.scalePositionWithinConstraints()),o=s.addEventListener("didUpdate",({delta:l,hasLayoutChanged:c})=>{this.isDragging&&c&&(Ll(u=>{const d=this.getAxisMotionValue(u);d&&(this.originPoint[u]+=l[u].translate,d.set(d.get()+l[u].translate))}),this.visualElement.render())});return()=>{a(),n(),i(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:s=!1,dragConstraints:i=!1,dragElastic:a=p4,dragMomentum:o=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:s,dragConstraints:i,dragElastic:a,dragMomentum:o}}}function rC(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function VFe(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class WFe extends up{constructor(t){super(t),this.removeGroupControls=Hl,this.removeListeners=Hl,this.controls=new qFe(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Hl}unmount(){this.removeGroupControls(),this.removeListeners()}}const cU=e=>(t,n)=>{e&&ri.postRender(()=>e(t,n))};class HFe extends up{constructor(){super(...arguments),this.removePointerDownListener=Hl}onPointerDown(t){this.session=new ZQ(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:YQ(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:s}=this.node.getProps();return{onSessionStart:cU(t),onStart:cU(n),onMove:r,onEnd:(i,a)=>{delete this.session,s&&ri.postRender(()=>s(i,a))}}}mount(){this.removePointerDownListener=Px(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const VC={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function uU(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const Hv={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(lr.test(e))e=parseFloat(e);else return e;const n=uU(e,t.target.x),r=uU(e,t.target.y);return`${n}% ${r}%`}},GFe={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,s=Vh.parse(e);if(s.length>5)return r;const i=Vh.createTransformer(e),a=typeof s[0]!="number"?1:0,o=n.x.scale*t.x,l=n.y.scale*t.y;s[0+a]/=o,s[1+a]/=l;const c=ti(o,l,.5);return typeof s[2+a]=="number"&&(s[2+a]/=c),typeof s[3+a]=="number"&&(s[3+a]/=c),i(s)}};class KFe extends E.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:s}=this.props,{projection:i}=t;aOe(YFe),i&&(n.group&&n.group.add(i),r&&r.register&&s&&r.register(i),i.root.didUpdate(),i.addEventListener("animationComplete",()=>{this.safeToRemove()}),i.setOptions({...i.options,onExitComplete:()=>this.safeToRemove()})),VC.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:s,isPresent:i}=this.props,{projection:a}=r;return a&&(a.isPresent=i,s||t.layoutDependency!==n||n===void 0||t.isPresent!==i?a.willUpdate():this.safeToRemove(),t.isPresent!==i&&(i?a.promote():a.relegate()||ri.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),eF.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:s}=t;s&&(s.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(s),r&&r.deregister&&r.deregister(s))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function QQ(e){const[t,n]=GJ(),r=E.useContext(GD);return f.jsx(KFe,{...e,layoutGroup:r,switchLayoutGroup:E.useContext(QJ),isPresent:t,safeToRemove:n})}const YFe={borderRadius:{...Hv,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:Hv,borderTopRightRadius:Hv,borderBottomLeftRadius:Hv,borderBottomRightRadius:Hv,boxShadow:GFe};function ZFe(e,t,n){const r=La(e)?e:Hw(e);return r.start(CF("",r,t,n)),r.animation}function XFe(e){return e instanceof SVGElement&&e.tagName!=="svg"}const JFe=(e,t)=>e.depth-t.depth;class QFe{constructor(){this.children=[],this.isDirty=!1}add(t){uF(this.children,t),this.isDirty=!0}remove(t){dF(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(JFe),this.isDirty=!1,this.children.forEach(t)}}function e6e(e,t){const n=Io.now(),r=({timestamp:s})=>{const i=s-n;i>=t&&(qh(r),e(i-t))};return ri.setup(r,!0),()=>qh(r)}const eee=["TopLeft","TopRight","BottomLeft","BottomRight"],t6e=eee.length,dU=e=>typeof e=="string"?parseFloat(e):e,fU=e=>typeof e=="number"||lr.test(e);function n6e(e,t,n,r,s,i){s?(e.opacity=ti(0,n.opacity??1,r6e(r)),e.opacityExit=ti(t.opacity??1,0,s6e(r))):i&&(e.opacity=ti(t.opacity??1,n.opacity??1,r));for(let a=0;a<t6e;a++){const o=`border${eee[a]}Radius`;let l=hU(t,o),c=hU(n,o);if(l===void 0&&c===void 0)continue;l||(l=0),c||(c=0),l===0||c===0||fU(l)===fU(c)?(e[o]=Math.max(ti(dU(l),dU(c),r),0),(Ru.test(c)||Ru.test(l))&&(e[o]+="%")):e[o]=c}(t.rotate||n.rotate)&&(e.rotate=ti(t.rotate||0,n.rotate||0,r))}function hU(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const r6e=tee(0,.5,AQ),s6e=tee(.5,.95,Hl);function tee(e,t,n){return r=>r<e?0:r>t?1:n(Kw(e,t,r))}function pU(e,t){e.min=t.min,e.max=t.max}function Pl(e,t){pU(e.x,t.x),pU(e.y,t.y)}function mU(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function gU(e,t,n,r,s){return e-=t,e=kk(e,1/n,r),s!==void 0&&(e=kk(e,1/s,r)),e}function i6e(e,t=0,n=1,r=.5,s,i=e,a=e){if(Ru.test(t)&&(t=parseFloat(t),t=ti(a.min,a.max,t/100)-a.min),typeof t!="number")return;let o=ti(i.min,i.max,r);e===i&&(o-=t),e.min=gU(e.min,t,n,o,s),e.max=gU(e.max,t,n,o,s)}function yU(e,t,[n,r,s],i,a){i6e(e,t[n],t[r],t[s],t.scale,i,a)}const a6e=["x","scaleX","originX"],o6e=["y","scaleY","originY"];function bU(e,t,n,r){yU(e.x,t,a6e,n?n.x:void 0,r?r.x:void 0),yU(e.y,t,o6e,n?n.y:void 0,r?r.y:void 0)}function vU(e){return e.translate===0&&e.scale===1}function nee(e){return vU(e.x)&&vU(e.y)}function xU(e,t){return e.min===t.min&&e.max===t.max}function l6e(e,t){return xU(e.x,t.x)&&xU(e.y,t.y)}function wU(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function ree(e,t){return wU(e.x,t.x)&&wU(e.y,t.y)}function _U(e){return no(e.x)/no(e.y)}function SU(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class c6e{constructor(){this.members=[]}add(t){uF(this.members,t),t.scheduleRender()}remove(t){if(dF(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(s=>t===s);if(n===0)return!1;let r;for(let s=n;s>=0;s--){const i=this.members[s];if(i.isPresent!==!1){r=i;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:s}=t.options;s===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function u6e(e,t,n){let r="";const s=e.x.translate/t.x,i=e.y.translate/t.y,a=(n==null?void 0:n.z)||0;if((s||i||a)&&(r=`translate3d(${s}px, ${i}px, ${a}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:c,rotate:u,rotateX:d,rotateY:h,skewX:m,skewY:y}=n;c&&(r=`perspective(${c}px) ${r}`),u&&(r+=`rotate(${u}deg) `),d&&(r+=`rotateX(${d}deg) `),h&&(r+=`rotateY(${h}deg) `),m&&(r+=`skewX(${m}deg) `),y&&(r+=`skewY(${y}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const UI=["","X","Y","Z"],d6e={visibility:"hidden"},CU=1e3;let f6e=0;function qI(e,t,n,r){const{latestValues:s}=t;s[e]&&(n[e]=s[e],t.setStaticValue(e,0),r&&(r[e]=0))}function see(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=dQ(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:s,layoutId:i}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",ri,!(s||i))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&see(r)}function iee({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:s}){return class{constructor(a={},o=t==null?void 0:t()){this.id=f6e++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,this.nodes.forEach(m6e),this.nodes.forEach(x6e),this.nodes.forEach(w6e),this.nodes.forEach(g6e)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new QFe)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new fF),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a){if(this.instance)return;this.isSVG=XFe(a),this.instance=a;const{layoutId:o,layout:l,visualElement:c}=this.options;if(c&&!c.current&&c.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),this.root.hasTreeAnimated&&(l||o)&&(this.isLayoutDirty=!0),e){let u;const d=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,u&&u(),u=e6e(d,250),VC.hasAnimatedSinceResize&&(VC.hasAnimatedSinceResize=!1,this.nodes.forEach(EU))})}o&&this.root.registerSharedNode(o,this),this.options.animate!==!1&&c&&(o||l)&&this.addEventListener("didUpdate",({delta:u,hasLayoutChanged:d,hasRelativeLayoutChanged:h,layout:m})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const y=this.options.transition||c.getDefaultTransition()||E6e,{onLayoutAnimationStart:b,onLayoutAnimationComplete:v}=c.getProps(),x=!this.targetLayout||!ree(this.targetLayout,m),w=!d&&h;if(this.options.layoutRoot||this.resumeFrom||w||d&&(x||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(u,w);const S={...hF(y,"layout"),onPlay:b,onComplete:v};(c.shouldReduceMotion||this.options.layoutRoot)&&(S.delay=0,S.type=!1),this.startAnimation(S)}else d||EU(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=m})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,this.eventHandlers.clear(),qh(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(_6e),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&see(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let u=0;u<this.path.length;u++){const d=this.path[u];d.shouldResetTransform=!0,d.updateScroll("snapshot"),d.options.layoutRoot&&d.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const c=this.getTransformTemplate();this.prevTransformTemplateValue=c?c(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(kU);return}this.isUpdating||this.nodes.forEach(b6e),this.isUpdating=!1,this.nodes.forEach(v6e),this.nodes.forEach(h6e),this.nodes.forEach(p6e),this.clearAllSnapshots();const o=Io.now();_a.delta=ef(0,1e3/60,o-_a.timestamp),_a.timestamp=o,_a.isProcessing=!0,OI.update.process(_a),OI.preRender.process(_a),OI.render.process(_a),_a.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,eF.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(y6e),this.sharedNodes.forEach(S6e)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,ri.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){ri.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure(),this.snapshot&&!no(this.snapshot.measuredBox.x)&&!no(this.snapshot.measuredBox.y)&&(this.snapshot=void 0))}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=gi(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o&&this.instance){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!s)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!nee(this.projectionDelta),l=this.getTransformTemplate(),c=l?l(this.latestValues,""):void 0,u=c!==this.prevTransformTemplateValue;a&&this.instance&&(o||Xp(this.latestValues)||u)&&(s(this.instance,c),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),T6e(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var c;const{visualElement:a}=this.options;if(!a)return gi();const o=a.measureViewportBox();if(!(((c=this.scroll)==null?void 0:c.wasRoot)||this.path.some(A6e))){const{scroll:u}=this.root;u&&(N0(o.x,u.offset.x),N0(o.y,u.offset.y))}return o}removeElementScroll(a){var l;const o=gi();if(Pl(o,a),(l=this.scroll)!=null&&l.wasRoot)return o;for(let c=0;c<this.path.length;c++){const u=this.path[c],{scroll:d,options:h}=u;u!==this.root&&d&&h.layoutScroll&&(d.wasRoot&&Pl(o,a),N0(o.x,d.offset.x),N0(o.y,d.offset.y))}return o}applyTransform(a,o=!1){const l=gi();Pl(l,a);for(let c=0;c<this.path.length;c++){const u=this.path[c];!o&&u.options.layoutScroll&&u.scroll&&u!==u.root&&M0(l,{x:-u.scroll.offset.x,y:-u.scroll.offset.y}),Xp(u.latestValues)&&M0(l,u.latestValues)}return Xp(this.latestValues)&&M0(l,this.latestValues),l}removeTransform(a){const o=gi();Pl(o,a);for(let l=0;l<this.path.length;l++){const c=this.path[l];if(!c.instance||!Xp(c.latestValues))continue;f4(c.latestValues)&&c.updateSnapshot();const u=gi(),d=c.measurePageBox();Pl(u,d),bU(o,c.latestValues,c.snapshot?c.snapshot.layoutBox:void 0,u)}return Xp(this.latestValues)&&bU(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==_a.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var h;const o=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=o.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=o.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=o.isSharedProjectionDirty);const l=!!this.resumingFrom||this!==o;if(!(a||l&&this.isSharedProjectionDirty||this.isProjectionDirty||(h=this.parent)!=null&&h.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:u,layoutId:d}=this.options;if(!(!this.layout||!(u||d))){if(this.resolvedRelativeTargetAt=_a.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=gi(),this.relativeTargetOrigin=gi(),Dx(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),Pl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)&&(this.target||(this.target=gi(),this.targetWithTransforms=gi()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),RFe(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):Pl(this.target,this.layout.layoutBox),GQ(this.target,this.targetDelta)):Pl(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget)){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=gi(),this.relativeTargetOrigin=gi(),Dx(this.relativeTargetOrigin,this.target,m.target),Pl(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}}}getClosestProjectingParent(){if(!(!this.parent||f4(this.parent.latestValues)||HQ(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var y;const a=this.getLead(),o=!!this.resumingFrom||this!==a;let l=!0;if((this.isProjectionDirty||(y=this.parent)!=null&&y.isProjectionDirty)&&(l=!1),o&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(l=!1),this.resolvedRelativeTargetAt===_a.timestamp&&(l=!1),l)return;const{layout:c,layoutId:u}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||u))return;Pl(this.layoutCorrected,this.layout.layoutBox);const d=this.treeScale.x,h=this.treeScale.y;NFe(this.layoutCorrected,this.treeScale,this.path,o),a.layout&&!a.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(a.target=a.layout.layoutBox,a.targetWithTransforms=gi());const{target:m}=a;if(!m){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(mU(this.prevProjectionDelta.x,this.projectionDelta.x),mU(this.prevProjectionDelta.y,this.projectionDelta.y)),Ox(this.projectionDelta,this.layoutCorrected,m,this.latestValues),(this.treeScale.x!==d||this.treeScale.y!==h||!SU(this.projectionDelta.x,this.prevProjectionDelta.x)||!SU(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",m))}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)==null||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=R0(),this.projectionDelta=R0(),this.projectionDeltaWithTransform=R0()}setAnimationOrigin(a,o=!1){const l=this.snapshot,c=l?l.latestValues:{},u={...this.latestValues},d=R0();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const h=gi(),m=l?l.source:void 0,y=this.layout?this.layout.source:void 0,b=m!==y,v=this.getStack(),x=!v||v.members.length<=1,w=!!(b&&!x&&this.options.crossfade===!0&&!this.path.some(k6e));this.animationProgress=0;let S;this.mixTargetDelta=k=>{const C=k/1e3;TU(d.x,a.x,C),TU(d.y,a.y,C),this.setTargetDelta(d),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Dx(h,this.layout.layoutBox,this.relativeParent.layout.layoutBox),C6e(this.relativeTarget,this.relativeTargetOrigin,h,C),S&&l6e(this.relativeTarget,S)&&(this.isProjectionDirty=!1),S||(S=gi()),Pl(S,this.relativeTarget)),b&&(this.animationValues=u,n6e(u,c,this.latestValues,C,w,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=C},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(qh(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=ri.update(()=>{VC.hasAnimatedSinceResize=!0,this.currentAnimation=ZFe(0,CU,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onStop:()=>{},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(CU),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:c,latestValues:u}=a;if(!(!o||!l||!c)){if(this!==a&&this.layout&&c&&aee(this.options.animationType,this.layout.layoutBox,c.layoutBox)){l=this.target||gi();const d=no(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+d;const h=no(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+h}Pl(o,l),M0(o,u),Ox(this.projectionDeltaWithTransform,this.layoutCorrected,o,u)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new c6e),this.sharedNodes.get(a).add(o);const c=o.options.initialPromotionConfig;o.promote({transition:c?c.transition:void 0,preserveFollowOpacity:c&&c.shouldPreserveFollowOpacity?c.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var o;const{layoutId:a}=this.options;return a?((o=this.getStack())==null?void 0:o.lead)||this:this}getPrevLead(){var o;const{layoutId:a}=this.options;return a?(o=this.getStack())==null?void 0:o.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const c=this.getStack();c&&c.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const c={};l.z&&qI("z",a,c,this.animationValues);for(let u=0;u<UI.length;u++)qI(`rotate${UI[u]}`,a,c,this.animationValues),qI(`skew${UI[u]}`,a,c,this.animationValues);a.render();for(const u in c)a.setStaticValue(u,c[u]),this.animationValues&&(this.animationValues[u]=c[u]);a.scheduleRender()}getProjectionStyles(a){if(!this.instance||this.isSVG)return;if(!this.isVisible)return d6e;const o={visibility:""},l=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,o.opacity="",o.pointerEvents=UC(a==null?void 0:a.pointerEvents)||"",o.transform=l?l(this.latestValues,""):"none",o;const c=this.getLead();if(!this.projectionDelta||!this.layout||!c.target){const m={};return this.options.layoutId&&(m.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,m.pointerEvents=UC(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Xp(this.latestValues)&&(m.transform=l?l({},""):"none",this.hasProjected=!1),m}const u=c.animationValues||c.latestValues;this.applyTransformsToTarget(),o.transform=u6e(this.projectionDeltaWithTransform,this.treeScale,u),l&&(o.transform=l(u,o.transform));const{x:d,y:h}=this.projectionDelta;o.transformOrigin=`${d.origin*100}% ${h.origin*100}% 0`,c.animationValues?o.opacity=c===this?u.opacity??this.latestValues.opacity??1:this.preserveOpacity?this.latestValues.opacity:u.opacityExit:o.opacity=c===this?u.opacity!==void 0?u.opacity:"":u.opacityExit!==void 0?u.opacityExit:0;for(const m in qw){if(u[m]===void 0)continue;const{correct:y,applyTo:b,isCSSVariable:v}=qw[m],x=o.transform==="none"?u[m]:y(u[m],c);if(b){const w=b.length;for(let S=0;S<w;S++)o[b[S]]=x}else v?this.options.visualElement.renderState.vars[m]=x:o[m]=x}return this.options.layoutId&&(o.pointerEvents=c===this?UC(a==null?void 0:a.pointerEvents)||"":"none"),o}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)==null?void 0:o.stop()}),this.root.nodes.forEach(kU),this.root.sharedNodes.clear()}}}function h6e(e){e.updateLayout()}function p6e(e){var n;const t=((n=e.resumeFrom)==null?void 0:n.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&t&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:s}=e.layout,{animationType:i}=e.options,a=t.source!==e.layout.source;i==="size"?Ll(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],m=no(h);h.min=r[d].min,h.max=h.min+m}):aee(i,t.layoutBox,r)&&Ll(d=>{const h=a?t.measuredBox[d]:t.layoutBox[d],m=no(r[d]);h.max=h.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[d].max=e.relativeTarget[d].min+m)});const o=R0();Ox(o,r,t.layoutBox);const l=R0();a?Ox(l,e.applyTransform(s,!0),t.measuredBox):Ox(l,r,t.layoutBox);const c=!nee(o);let u=!1;if(!e.resumeFrom){const d=e.getClosestProjectingParent();if(d&&!d.resumeFrom){const{snapshot:h,layout:m}=d;if(h&&m){const y=gi();Dx(y,t.layoutBox,h.layoutBox);const b=gi();Dx(b,r,m.layoutBox),ree(y,b)||(u=!0),d.options.layoutRoot&&(e.relativeTarget=b,e.relativeTargetOrigin=y,e.relativeParent=d)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:t,delta:l,layoutDelta:o,hasLayoutChanged:c,hasRelativeLayoutChanged:u})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function m6e(e){e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function g6e(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function y6e(e){e.clearSnapshot()}function kU(e){e.clearMeasurements()}function b6e(e){e.isLayoutDirty=!1}function v6e(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function EU(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function x6e(e){e.resolveTargetDelta()}function w6e(e){e.calcProjection()}function _6e(e){e.resetSkewAndRotation()}function S6e(e){e.removeLeadSnapshot()}function TU(e,t,n){e.translate=ti(t.translate,0,n),e.scale=ti(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function AU(e,t,n,r){e.min=ti(t.min,n.min,r),e.max=ti(t.max,n.max,r)}function C6e(e,t,n,r){AU(e.x,t.x,n.x,r),AU(e.y,t.y,n.y,r)}function k6e(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const E6e={duration:.45,ease:[.4,0,.1,1]},RU=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),NU=RU("applewebkit/")&&!RU("chrome/")?Math.round:Hl;function MU(e){e.min=NU(e.min),e.max=NU(e.max)}function T6e(e){MU(e.x),MU(e.y)}function aee(e,t,n){return e==="position"||e==="preserve-aspect"&&!AFe(_U(t),_U(n),.2)}function A6e(e){var t;return e!==e.root&&((t=e.scroll)==null?void 0:t.wasRoot)}const R6e=iee({attachResizeListener:(e,t)=>Yw(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),VI={current:void 0},oee=iee({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!VI.current){const e=new R6e({});e.mount(window),e.setOptions({layoutScroll:!0}),VI.current=e}return VI.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),N6e={pan:{Feature:HFe},drag:{Feature:WFe,ProjectionNode:oee,MeasureLayout:QQ}};function M6e(e,t,n){if(e instanceof EventTarget)return[e];if(typeof e=="string"){let r=document;const s=(n==null?void 0:n[e])??r.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}function lee(e,t){const n=M6e(e),r=new AbortController,s={passive:!0,...t,signal:r.signal};return[n,s,()=>r.abort()]}function IU(e){return!(e.pointerType==="touch"||JQ())}function I6e(e,t,n={}){const[r,s,i]=lee(e,n),a=o=>{if(!IU(o))return;const{target:l}=o,c=t(l,o);if(typeof c!="function"||!l)return;const u=d=>{IU(d)&&(c(d),l.removeEventListener("pointerleave",u))};l.addEventListener("pointerleave",u,s)};return r.forEach(o=>{o.addEventListener("pointerenter",a,s)}),i}function jU(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const s="onHover"+n,i=r[s];i&&ri.postRender(()=>i(t,t_(t)))}class j6e extends up{mount(){const{current:t}=this.node;t&&(this.unmount=I6e(t,(n,r)=>(jU(this.node,r,"Start"),s=>jU(this.node,s,"End"))))}unmount(){}}class P6e extends up{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=Q1(Yw(this.node.current,"focus",()=>this.onFocus()),Yw(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}const cee=(e,t)=>t?e===t?!0:cee(e,t.parentElement):!1,O6e=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function D6e(e){return O6e.has(e.tagName)||e.tabIndex!==-1}const ux=new WeakSet;function PU(e){return t=>{t.key==="Enter"&&e(t)}}function WI(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const F6e=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=PU(()=>{if(ux.has(n))return;WI(n,"down");const s=PU(()=>{WI(n,"up")}),i=()=>WI(n,"cancel");n.addEventListener("keyup",s,t),n.addEventListener("blur",i,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function OU(e){return kF(e)&&!JQ()}function L6e(e,t,n={}){const[r,s,i]=lee(e,n),a=o=>{const l=o.currentTarget;if(!OU(o)||ux.has(l))return;ux.add(l);const c=t(l,o),u=(m,y)=>{window.removeEventListener("pointerup",d),window.removeEventListener("pointercancel",h),!(!OU(m)||!ux.has(l))&&(ux.delete(l),typeof c=="function"&&c(m,{success:y}))},d=m=>{u(m,l===window||l===document||n.useGlobalTarget||cee(l,m.target))},h=m=>{u(m,!1)};window.addEventListener("pointerup",d,s),window.addEventListener("pointercancel",h,s)};return r.forEach(o=>{(n.useGlobalTarget?window:o).addEventListener("pointerdown",a,s),o instanceof HTMLElement&&(o.addEventListener("focus",c=>F6e(c,s)),!D6e(o)&&!o.hasAttribute("tabindex")&&(o.tabIndex=0))}),i}function DU(e,t,n){const{props:r}=e;if(e.current instanceof HTMLButtonElement&&e.current.disabled)return;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const s="onTap"+(n==="End"?"":n),i=r[s];i&&ri.postRender(()=>i(t,t_(t)))}class B6e extends up{mount(){const{current:t}=this.node;t&&(this.unmount=L6e(t,(n,r)=>(DU(this.node,r,"Start"),(s,{success:i})=>DU(this.node,s,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const m4=new WeakMap,HI=new WeakMap,$6e=e=>{const t=m4.get(e.target);t&&t(e)},z6e=e=>{e.forEach($6e)};function U6e({root:e,...t}){const n=e||document;HI.has(n)||HI.set(n,{});const r=HI.get(n),s=JSON.stringify(t);return r[s]||(r[s]=new IntersectionObserver(z6e,{root:e,...t})),r[s]}function q6e(e,t,n){const r=U6e(t);return m4.set(e,n),r.observe(e),()=>{m4.delete(e),r.unobserve(e)}}const V6e={some:0,all:1};class W6e extends up{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:s="some",once:i}=t,a={root:n?n.current:void 0,rootMargin:r,threshold:typeof s=="number"?s:V6e[s]},o=l=>{const{isIntersecting:c}=l;if(this.isInView===c||(this.isInView=c,i&&!c&&this.hasEnteredView))return;c&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",c);const{onViewportEnter:u,onViewportLeave:d}=this.node.getProps(),h=c?u:d;h&&h(l)};return q6e(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(H6e(t,n))&&this.startObserver()}unmount(){}}function H6e({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const G6e={inView:{Feature:W6e},tap:{Feature:B6e},focus:{Feature:P6e},hover:{Feature:j6e}},K6e={layout:{ProjectionNode:oee,MeasureLayout:QQ}},g4={current:null},uee={current:!1};function Y6e(){if(uee.current=!0,!!YD)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>g4.current=e.matches;e.addListener(t),t()}else g4.current=!1}const Z6e=new WeakMap;function X6e(e,t,n){for(const r in t){const s=t[r],i=n[r];if(La(s))e.addValue(r,s);else if(La(i))e.addValue(r,Hw(s,{owner:e}));else if(i!==s)if(e.hasValue(r)){const a=e.getValue(r);a.liveStyle===!0?a.jump(s):a.hasAnimated||a.set(s)}else{const a=e.getStaticValue(r);e.addValue(r,Hw(a!==void 0?a:s,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const dee=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),fee=e=>/^0[^.\s]+$/u.test(e),J6e={test:e=>e==="auto",parse:e=>e},hee=e=>t=>t.test(e),pee=[bb,lr,Ru,ch,lOe,oOe,J6e],FU=e=>pee.find(hee(e)),Q6e=[...pee,Pa,Vh],e5e=e=>Q6e.find(hee(e)),t5e=new Set(["brightness","contrast","saturate","opacity"]);function n5e(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(pF)||[];if(!r)return e;const s=n.replace(r,"");let i=t5e.has(t)?1:0;return r!==n&&(i*=100),t+"("+i+s+")"}const r5e=/\b([a-z-]*)\(.*?\)/gu,y4={...Vh,getAnimatableNone:e=>{const t=e.match(r5e);return t?t.map(n5e).join(" "):e}},s5e={...sF,color:Pa,backgroundColor:Pa,outlineColor:Pa,fill:Pa,stroke:Pa,borderColor:Pa,borderTopColor:Pa,borderRightColor:Pa,borderBottomColor:Pa,borderLeftColor:Pa,filter:y4,WebkitFilter:y4},mee=e=>s5e[e];function gee(e,t){let n=mee(e);return n!==y4&&(n=Vh),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const LU=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class i5e{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:s,blockInitialAnimation:i,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=_F,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const h=Io.now();this.renderScheduledAt<h&&(this.renderScheduledAt=h,ri.render(this.render,!1,!0))};const{latestValues:l,renderState:c}=a;this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=c,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=s,this.options=o,this.blockInitialAnimation=!!i,this.isControllingVariants=NT(n),this.isVariantNode=XJ(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:u,...d}=this.scrapeMotionValuesFromProps(n,{},this);for(const h in d){const m=d[h];l[h]!==void 0&&La(m)&&m.set(l[h],!1)}}mount(t){this.current=t,Z6e.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),uee.current||Y6e(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:g4.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){this.projection&&this.projection.unmount(),qh(this.notifyUpdate),qh(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=yb.has(t);r&&this.onBindTransform&&this.onBindTransform();const s=n.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&ri.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),i=n.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{s(),i(),a&&a(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in Ay){const n=Ay[t];if(!n)continue;const{isEnabled:r,Feature:s}=n;if(!this.features[t]&&s&&r(this.props)&&(this.features[t]=new s(this)),this.features[t]){const i=this.features[t];i.isMounted?i.update():(i.mount(),i.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):gi()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<LU.length;r++){const s=LU[r];this.propEventSubscriptions[s]&&(this.propEventSubscriptions[s](),delete this.propEventSubscriptions[s]);const i="on"+s,a=t[i];a&&(this.propEventSubscriptions[s]=this.on(s,a))}this.prevMotionValues=X6e(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue()}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=Hw(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){let r=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:this.getBaseTargetFromProps(this.props,t)??this.readValueFromInstance(this.current,t,this.options);return r!=null&&(typeof r=="string"&&(dee(r)||fee(r))?r=parseFloat(r):!e5e(r)&&Vh.test(n)&&(r=gee(t,n)),this.setBaseTarget(t,La(r)?r.get():r)),La(r)?r.get():r}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var i;const{initial:n}=this.props;let r;if(typeof n=="string"||typeof n=="object"){const a=lF(this.props,n,(i=this.presenceContext)==null?void 0:i.custom);a&&(r=a[t])}if(n&&r!==void 0)return r;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!La(s)?s:this.initialValues[t]!==void 0&&r===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new fF),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}const a5e=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function o5e(e){const t=a5e.exec(e);if(!t)return[,];const[,n,r,s]=t;return[`--${n??r}`,s]}function yee(e,t,n=1){const[r,s]=o5e(e);if(!r)return;const i=window.getComputedStyle(t).getPropertyValue(r);if(i){const a=i.trim();return dee(a)?parseFloat(a):a}return rF(s)?yee(s,t,n+1):s}function l5e(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||fee(e):!0}const c5e=new Set(["auto","none","0"]);function u5e(e,t,n){let r=0,s;for(;r<e.length&&!s;){const i=e[r];typeof i=="string"&&!c5e.has(i)&&Gw(i).values.length&&(s=e[r]),r++}if(s&&n)for(const i of t)e[i]=gee(n,s)}class d5e extends _F{constructor(t,n,r,s,i){super(t,n,r,s,i,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let c=t[l];if(typeof c=="string"&&(c=c.trim(),rF(c))){const u=yee(c,n.current);u!==void 0&&(t[l]=u),l===t.length-1&&(this.finalKeyframe=c)}}if(this.resolveNoneKeyframes(),!BQ.has(r)||t.length!==2)return;const[s,i]=t,a=FU(s),o=FU(i);if(a!==o)if(U7(a)&&U7(o))for(let l=0;l<t.length;l++){const c=t[l];typeof c=="string"&&(t[l]=parseFloat(c))}else bm[r]&&(this.needsMeasurement=!0)}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let s=0;s<t.length;s++)(t[s]===null||l5e(t[s]))&&r.push(s);r.length&&u5e(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=bm[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const s=n[n.length-1];s!==void 0&&t.getValue(r,s).jump(s,!1)}measureEndState(){var o;const{element:t,name:n,unresolvedKeyframes:r}=this;if(!t||!t.current)return;const s=t.getValue(n);s&&s.jump(this.measuredOrigin,!1);const i=r.length-1,a=r[i];r[i]=bm[n](t.measureViewportBox(),window.getComputedStyle(t.current)),a!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=a),(o=this.removedTransforms)!=null&&o.length&&this.removedTransforms.forEach(([l,c])=>{t.getValue(l).set(c)}),this.resolveNoneKeyframes()}}class bee extends i5e{constructor(){super(...arguments),this.KeyframeResolver=d5e}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;La(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function vee(e,{style:t,vars:n},r,s){Object.assign(e.style,t,s&&s.getProjectionStyles(r));for(const i in n)e.style.setProperty(i,n[i])}function f5e(e){return window.getComputedStyle(e)}class h5e extends bee{constructor(){super(...arguments),this.type="html",this.renderInstance=vee}readValueFromInstance(t,n){if(yb.has(n))return FDe(t,n);{const r=f5e(t),s=(nF(n)?r.getPropertyValue(n):r[n])||0;return typeof s=="string"?s.trim():s}}measureInstanceViewportBox(t,{transformPagePoint:n}){return KQ(t,n)}build(t,n,r){iF(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return cF(t,n,r)}}const xee=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function p5e(e,t,n,r){vee(e,t,void 0,r);for(const s in t.attrs)e.setAttribute(xee.has(s)?s:QD(s),t.attrs[s])}class m5e extends bee{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=gi}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(yb.has(n)){const r=mee(n);return r&&r.default||0}return n=xee.has(n)?n:QD(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return cQ(t,n,r)}build(t,n,r){iQ(t,n,this.isSVGTag,r.transformTemplate,r.style)}renderInstance(t,n,r,s){p5e(t,n,r,s)}mount(t){this.isSVGTag=oQ(t.tagName),super.mount(t)}}const g5e=(e,t)=>oF(e)?new m5e(t):new h5e(t,{allowProjection:e!==E.Fragment}),y5e=EOe({...xFe,...G6e,...N6e,...K6e},g5e),gu=HPe(y5e),B0=new WeakMap,WC=new WeakMap,Ek={current:[]};let GI=!1,Fx=0;const dx=new Set,sC=new Map;function wee(e){const t=Array.from(e).sort((n,r)=>n instanceof qd&&n.options.deps.includes(r)?1:r instanceof qd&&r.options.deps.includes(n)?-1:0);for(const n of t){if(Ek.current.includes(n))continue;Ek.current.push(n),n.recompute();const r=WC.get(n);if(r)for(const s of r){const i=B0.get(s);i&&wee(i)}}}function b5e(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function v5e(e){e.listeners.forEach(t=>t({prevVal:e.prevState,currentVal:e.state}))}function _ee(e){if(Fx>0&&!sC.has(e)&&sC.set(e,e.prevState),dx.add(e),!(Fx>0)&&!GI)try{for(GI=!0;dx.size>0;){const t=Array.from(dx);dx.clear();for(const n of t){const r=sC.get(n)??n.prevState;n.prevState=r,b5e(n)}for(const n of t){const r=B0.get(n);r&&(Ek.current.push(n),wee(r))}for(const n of t){const r=B0.get(n);if(r)for(const s of r)v5e(s)}}}finally{GI=!1,Ek.current=[],sC.clear()}}function lu(e){Fx++;try{e()}finally{if(Fx--,Fx===0){const t=Array.from(dx)[0];t&&_ee(t)}}}function x5e(e){return typeof e=="function"}class b4{constructor(t,n){this.listeners=new Set,this.subscribe=r=>{var s,i;this.listeners.add(r);const a=(i=(s=this.options)==null?void 0:s.onSubscribe)==null?void 0:i.call(s,r,this);return()=>{this.listeners.delete(r),a==null||a()}},this.prevState=t,this.state=t,this.options=n}setState(t){var n,r,s;this.prevState=this.state,(n=this.options)!=null&&n.updateFn?this.state=this.options.updateFn(this.prevState)(t):x5e(t)?this.state=t(this.prevState):this.state=t,(s=(r=this.options)==null?void 0:r.onUpdate)==null||s.call(r),_ee(this)}}class qd{constructor(t){this.listeners=new Set,this._subscriptions=[],this.lastSeenDepValues=[],this.getDepVals=()=>{const n=[],r=[];for(const s of this.options.deps)n.push(s.prevState),r.push(s.state);return this.lastSeenDepValues=r,{prevDepVals:n,currDepVals:r,prevVal:this.prevState??void 0}},this.recompute=()=>{var n,r;this.prevState=this.state;const{prevDepVals:s,currDepVals:i,prevVal:a}=this.getDepVals();this.state=this.options.fn({prevDepVals:s,currDepVals:i,prevVal:a}),(r=(n=this.options).onUpdate)==null||r.call(n)},this.checkIfRecalculationNeededDeeply=()=>{for(const i of this.options.deps)i instanceof qd&&i.checkIfRecalculationNeededDeeply();let n=!1;const r=this.lastSeenDepValues,{currDepVals:s}=this.getDepVals();for(let i=0;i<s.length;i++)if(s[i]!==r[i]){n=!0;break}n&&this.recompute()},this.mount=()=>(this.registerOnGraph(),this.checkIfRecalculationNeededDeeply(),()=>{this.unregisterFromGraph();for(const n of this._subscriptions)n()}),this.subscribe=n=>{var r,s;this.listeners.add(n);const i=(s=(r=this.options).onSubscribe)==null?void 0:s.call(r,n,this);return()=>{this.listeners.delete(n),i==null||i()}},this.options=t,this.state=t.fn({prevDepVals:void 0,prevVal:void 0,currDepVals:this.getDepVals().currDepVals})}registerOnGraph(t=this.options.deps){for(const n of t)if(n instanceof qd)n.registerOnGraph(),this.registerOnGraph(n.options.deps);else if(n instanceof b4){let r=B0.get(n);r||(r=new Set,B0.set(n,r)),r.add(this);let s=WC.get(this);s||(s=new Set,WC.set(this,s)),s.add(n)}}unregisterFromGraph(t=this.options.deps){for(const n of t)if(n instanceof qd)this.unregisterFromGraph(n.options.deps);else if(n instanceof b4){const r=B0.get(n);r&&r.delete(this);const s=WC.get(this);s&&s.delete(n)}}}function MT(e,t){return typeof e=="function"?e(t):e}function fx(e,t){return EF(t).reduce((r,s)=>{if(r===null)return null;if(typeof r<"u")return r[s]},e)}function iC(e,t,n){const r=EF(t);function s(i){if(!r.length)return MT(n,i);const a=r.shift();if(typeof a=="string"||typeof a=="number"&&!Array.isArray(i))return typeof i=="object"?(i===null&&(i={}),{...i,[a]:s(i[a])}):{[a]:s()};if(Array.isArray(i)&&typeof a=="number"){const o=i.slice(0,a);return[...o.length?o:new Array(a),s(i[a]),...i.slice(a+1)]}return[...new Array(a),s()]}return s(e)}function w5e(e,t){const n=EF(t);function r(s){if(!s)return;if(n.length===1){const a=n[0];if(Array.isArray(s)&&typeof a=="number")return s.filter((c,u)=>u!==a);const{[a]:o,...l}=s;return l}const i=n.shift();if(typeof i=="string"&&typeof s=="object")return{...s,[i]:r(s[i])};if(typeof i=="number"&&Array.isArray(s)){if(i>=s.length)return s;const a=s.slice(0,i);return[...a.length?a:new Array(i),r(s[i]),...s.slice(i+1)]}throw new Error("It seems we have created an infinite loop in deleteBy. ")}return r(e)}const _5e=/^(\d+)$/gm,S5e=/\.(\d+)(?=\.)/gm,C5e=/^(\d+)\./gm,k5e=/\.(\d+$)/gm,E5e=/\.{2,}/gm,v4="__int__",aC=`${v4}$1`;function EF(e){if(Array.isArray(e))return[...e];if(typeof e!="string")throw new Error("Path must be a string.");return e.replace(/(^\[)|]/gm,"").replace(/\[/g,".").replace(_5e,aC).replace(S5e,`.${aC}.`).replace(C5e,`${aC}.`).replace(k5e,`.${aC}`).replace(E5e,".").split(".").map(t=>t.indexOf(v4)===0?parseInt(t.substring(v4.length),10):t)}function T5e(e){return!(Array.isArray(e)&&e.length===0)}function x4(e,t){const{asyncDebounceMs:n}=t,{onChangeAsync:r,onBlurAsync:s,onSubmitAsync:i,onBlurAsyncDebounceMs:a,onChangeAsyncDebounceMs:o}=t.validators||{},l=n??0,c={cause:"change",validate:r,debounceMs:o??l},u={cause:"blur",validate:s,debounceMs:a??l},d={cause:"submit",validate:i,debounceMs:0},h=m=>({...m,debounceMs:0});switch(e){case"submit":return[h(c),h(u),d];case"blur":return[u];case"change":return[c];case"server":default:return[]}}function w4(e,t){const{onChange:n,onBlur:r,onSubmit:s,onMount:i}=t.validators||{},a={cause:"change",validate:n},o={cause:"blur",validate:r},l={cause:"submit",validate:s},c={cause:"mount",validate:i},u={cause:"server",validate:()=>{}};switch(e){case"mount":return[c];case"submit":return[a,o,l,u];case"server":return[u];case"blur":return[o,u];case"change":default:return[a,u]}}const _4=e=>!!e&&typeof e=="object"&&"fields"in e;function g0(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[s,i]of e)if(!t.has(s)||!Object.is(i,t.get(s)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const s of e)if(!t.has(s))return!1;return!0}const n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(const s of n)if(!r.includes(s)||!g0(e[s],t[s]))return!1;return!0}const BU=({newFormValidatorError:e,isPreviousErrorFromFormValidator:t,previousErrorValue:n})=>e?{newErrorValue:e,newSource:"form"}:t?{newErrorValue:void 0,newSource:void 0}:n?{newErrorValue:n,newSource:"field"}:{newErrorValue:void 0,newSource:void 0},$U=({formLevelError:e,fieldLevelError:t})=>t?{newErrorValue:t,newSource:"field"}:e?{newErrorValue:e,newSource:"form"}:{newErrorValue:void 0,newSource:void 0};function A5e(e){const t=new Map;for(const n of e){const r=[...n.path??[]].map(s=>{const i=typeof s=="object"?s.key:s;return typeof i=="number"?`[${i}]`:i}).join(".").replace(/\.\[/g,"[");t.set(r,(t.get(r)??[]).concat(n))}return Object.fromEntries(t)}const zU=e=>{const t=A5e(e);return{form:t,fields:t}},$0={validate({value:e,validationSource:t},n){const r=n["~standard"].validate(e);if(r instanceof Promise)throw new Error("async function passed to sync validator");if(r.issues)return t==="field"?r.issues:zU(r.issues)},async validateAsync({value:e,validationSource:t},n){const r=await n["~standard"].validate(e);if(r.issues)return t==="field"?r.issues:zU(r.issues)}},See=e=>!!e&&"~standard"in e,Tk={isValidating:!1,isTouched:!1,isBlurred:!1,isDirty:!1,isPristine:!0,isValid:!0,isDefaultValue:!0,errors:[],errorMap:{},errorSourceMap:{}};function oC(e){function t(d,h,m,y){const b=r(d,h,m,y);({insert:()=>o(b,d,h),remove:()=>l(b),swap:()=>y!==void 0&&u(b,d,h,y),move:()=>y!==void 0&&c(b,d,h,y)})[m]()}function n(d,h){return`${d}[${h}]`}function r(d,h,m,y){const b=[n(d,h)];if(m==="swap")b.push(n(d,y));else if(m==="move"){const[v,x]=[Math.min(h,y),Math.max(h,y)];for(let w=v;w<=x;w++)b.push(n(d,w))}else{const v=e.getFieldValue(d),x=Array.isArray(v)?v.length:0;for(let w=h+1;w<x;w++)b.push(n(d,w))}return Object.keys(e.fieldInfo).filter(v=>b.some(x=>v.startsWith(x)))}function s(d,h){return d.replace(/\[(\d+)\]/,(m,y)=>{const b=parseInt(y,10);return`[${h==="up"?b+1:Math.max(0,b-1)}]`})}function i(d,h){(h==="up"?d:[...d].reverse()).forEach(y=>{const b=s(y.toString(),h),v=e.getFieldMeta(b);v?e.setFieldMeta(y,v):e.setFieldMeta(y,a())})}const a=()=>Tk,o=(d,h,m)=>{i(d,"down"),d.forEach(y=>{y.toString().startsWith(n(h,m))&&e.setFieldMeta(y,a())})},l=d=>{i(d,"up")},c=(d,h,m,y)=>{const b=new Map(Object.keys(e.fieldInfo).filter(v=>v.startsWith(n(h,m))).map(v=>[v,e.getFieldMeta(v)]));i(d,m<y?"up":"down"),Object.keys(e.fieldInfo).filter(v=>v.startsWith(n(h,y))).forEach(v=>{const x=v.replace(n(h,y),n(h,m)),w=b.get(x);w&&e.setFieldMeta(v,w)})},u=(d,h,m,y)=>{d.forEach(b=>{if(!b.toString().startsWith(n(h,m)))return;const v=b.toString().replace(n(h,m),n(h,y)),[x,w]=[e.getFieldMeta(b),e.getFieldMeta(v)];x&&e.setFieldMeta(v,x),w&&e.setFieldMeta(b,w)})};return{handleArrayFieldMetaShift:t}}function KI(e){return{values:e.values??{},errorMap:e.errorMap??{},fieldMetaBase:e.fieldMetaBase??{},isSubmitted:e.isSubmitted??!1,isSubmitting:e.isSubmitting??!1,isValidating:e.isValidating??!1,submissionAttempts:e.submissionAttempts??0,isSubmitSuccessful:e.isSubmitSuccessful??!1,validationMetaMap:e.validationMetaMap??{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}}}class R5e{constructor(t){var n;this.options={},this.fieldInfo={},this.prevTransformArray=[],this.mount=()=>{var r,s;const i=this.fieldMetaDerived.mount(),a=this.store.mount(),o=()=>{i(),a()};(s=(r=this.options.listeners)==null?void 0:r.onMount)==null||s.call(r,{formApi:this});const{onMount:l}=this.options.validators||{};return l&&this.validateSync("mount"),o},this.update=r=>{var s,i;if(!r)return;const a=this.options;this.options=r;const o=!!((i=(s=r.transform)==null?void 0:s.deps)!=null&&i.some((u,d)=>u!==this.prevTransformArray[d])),l=r.defaultValues&&!g0(r.defaultValues,a.defaultValues)&&!this.state.isTouched,c=!g0(r.defaultState,a.defaultState)&&!this.state.isTouched;!l&&!c&&!o||lu(()=>{this.baseStore.setState(()=>KI(Object.assign({},this.state,c?r.defaultState:{},l?{values:r.defaultValues}:{},o?{_force_re_eval:!this.state._force_re_eval}:{})))})},this.reset=(r,s)=>{const{fieldMeta:i}=this.state,a=this.resetFieldMeta(i);r&&!(s!=null&&s.keepDefaultValues)&&(this.options={...this.options,defaultValues:r}),this.baseStore.setState(()=>{var o;return KI({...this.options.defaultState,values:r??this.options.defaultValues??((o=this.options.defaultState)==null?void 0:o.values),fieldMetaBase:a})})},this.validateAllFields=async r=>{const s=[];return lu(()=>{Object.values(this.fieldInfo).forEach(a=>{if(!a.instance)return;const o=a.instance;s.push(Promise.resolve().then(()=>o.validate(r,{skipFormValidation:!0}))),a.instance.state.meta.isTouched||a.instance.setMeta(l=>({...l,isTouched:!0}))})}),(await Promise.all(s)).flat()},this.validateArrayFieldsStartingFrom=async(r,s,i)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null,l=[`${r}[${s}]`];for(let h=s+1;h<=(o??0);h++)l.push(`${r}[${h}]`);const c=Object.keys(this.fieldInfo).filter(h=>l.some(m=>h.startsWith(m))),u=[];return lu(()=>{c.forEach(h=>{u.push(Promise.resolve().then(()=>this.validateField(h,i)))})}),(await Promise.all(u)).flat()},this.validateField=(r,s)=>{var i;const a=(i=this.fieldInfo[r])==null?void 0:i.instance;return a?(a.state.meta.isTouched||a.setMeta(o=>({...o,isTouched:!0})),a.validate(s)):[]},this.validateSync=r=>{const s=w4(r,this.options);let i=!1;const a={};return lu(()=>{var o,l;for(const u of s){if(!u.validate)continue;const d=this.runValidator({validate:u.validate,value:{value:this.state.values,formApi:this,validationSource:"form"},type:"validate"}),{formError:h,fieldErrors:m}=HC(d),y=lC(u.cause);for(const b of Object.keys(this.state.fieldMeta)){const v=this.getFieldMeta(b);if(!v)continue;const{errorMap:x,errorSourceMap:w}=v,S=m==null?void 0:m[b],{newErrorValue:k,newSource:C}=BU({newFormValidatorError:S,isPreviousErrorFromFormValidator:(w==null?void 0:w[y])==="form",previousErrorValue:x==null?void 0:x[y]});C==="form"&&(a[b]={...a[b],[y]:S}),(x==null?void 0:x[y])!==k&&this.setFieldMeta(b,T=>({...T,errorMap:{...T.errorMap,[y]:k},errorSourceMap:{...T.errorSourceMap,[y]:C}}))}((o=this.state.errorMap)==null?void 0:o[y])!==h&&this.baseStore.setState(b=>({...b,errorMap:{...b.errorMap,[y]:h}})),(h||m)&&(i=!0)}const c=lC("submit");(l=this.state.errorMap)!=null&&l[c]&&r!=="submit"&&!i&&this.baseStore.setState(u=>({...u,errorMap:{...u.errorMap,[c]:void 0}}))}),{hasErrored:i,fieldsErrorMap:a}},this.validateAsync=async r=>{const s=x4(r,this.options);this.state.isFormValidating||this.baseStore.setState(c=>({...c,isFormValidating:!0}));const i=[];let a;for(const c of s){if(!c.validate)continue;const u=lC(c.cause),d=this.state.validationMetaMap[u];d==null||d.lastAbortController.abort();const h=new AbortController;this.state.validationMetaMap[u]={lastAbortController:h},i.push(new Promise(async m=>{let y;try{y=await new Promise((w,S)=>{setTimeout(async()=>{if(h.signal.aborted)return w(void 0);try{w(await this.runValidator({validate:c.validate,value:{value:this.state.values,formApi:this,validationSource:"form",signal:h.signal},type:"validateAsync"}))}catch(k){S(k)}},c.debounceMs)})}catch(w){y=w}const{formError:b,fieldErrors:v}=HC(y);v&&(a=a?{...a,...v}:v);const x=lC(c.cause);for(const w of Object.keys(this.state.fieldMeta)){const S=this.getFieldMeta(w);if(!S)continue;const{errorMap:k,errorSourceMap:C}=S,T=a==null?void 0:a[w],{newErrorValue:A,newSource:N}=BU({newFormValidatorError:T,isPreviousErrorFromFormValidator:(C==null?void 0:C[x])==="form",previousErrorValue:k==null?void 0:k[x]});(k==null?void 0:k[x])!==A&&this.setFieldMeta(w,I=>({...I,errorMap:{...I.errorMap,[x]:A},errorSourceMap:{...I.errorSourceMap,[x]:N}}))}this.baseStore.setState(w=>({...w,errorMap:{...w.errorMap,[x]:b}})),m(a?{fieldErrors:a,errorMapKey:x}:void 0)}))}let o=[];const l={};if(i.length){o=await Promise.all(i);for(const c of o)if(c!=null&&c.fieldErrors){const{errorMapKey:u}=c;for(const[d,h]of Object.entries(c.fieldErrors)){const y={...l[d]||{},[u]:h};l[d]=y}}}return this.baseStore.setState(c=>({...c,isFormValidating:!1})),l},this.validate=r=>{const{hasErrored:s,fieldsErrorMap:i}=this.validateSync(r);return s&&!this.options.asyncAlways?i:this.validateAsync(r)},this.getFieldValue=r=>fx(this.state.values,r),this.getFieldMeta=r=>this.state.fieldMeta[r],this.getFieldInfo=r=>{var s;return(s=this.fieldInfo)[r]||(s[r]={instance:null,validationMetaMap:{onChange:void 0,onBlur:void 0,onSubmit:void 0,onMount:void 0,onServer:void 0}})},this.setFieldMeta=(r,s)=>{this.baseStore.setState(i=>({...i,fieldMetaBase:{...i.fieldMetaBase,[r]:MT(s,i.fieldMetaBase[r])}}))},this.resetFieldMeta=r=>Object.keys(r).reduce((s,i)=>{const a=i;return s[a]=Tk,s},{}),this.setFieldValue=(r,s,i)=>{const a=(i==null?void 0:i.dontUpdateMeta)??!1;lu(()=>{a||this.setFieldMeta(r,o=>({...o,isTouched:!0,isDirty:!0,errorMap:{...o==null?void 0:o.errorMap,onMount:void 0}})),this.baseStore.setState(o=>({...o,values:iC(o.values,r,s)}))})},this.deleteField=r=>{const i=[...Object.keys(this.fieldInfo).filter(a=>{const o=r.toString();return a!==o&&a.startsWith(o)}),r];this.baseStore.setState(a=>{const o={...a};return i.forEach(l=>{o.values=w5e(o.values,l),delete this.fieldInfo[l],delete o.fieldMetaBase[l]}),o})},this.pushFieldValue=(r,s,i)=>{this.setFieldValue(r,a=>[...Array.isArray(a)?a:[],s],i),this.validateField(r,"change")},this.insertFieldValue=async(r,s,i,a)=>{this.setFieldValue(r,o=>[...o.slice(0,s),i,...o.slice(s)],a),await this.validateField(r,"change"),oC(this).handleArrayFieldMetaShift(r,s,"insert"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.replaceFieldValue=async(r,s,i,a)=>{this.setFieldValue(r,o=>o.map((l,c)=>c===s?i:l),a),await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.removeFieldValue=async(r,s,i)=>{const a=this.getFieldValue(r),o=Array.isArray(a)?Math.max(a.length-1,0):null;if(this.setFieldValue(r,l=>l.filter((c,u)=>u!==s),i),oC(this).handleArrayFieldMetaShift(r,s,"remove"),o!==null){const l=`${r}[${o}]`;this.deleteField(l)}await this.validateField(r,"change"),await this.validateArrayFieldsStartingFrom(r,s,"change")},this.swapFieldValues=(r,s,i,a)=>{this.setFieldValue(r,o=>{const l=o[s],c=o[i];return iC(iC(o,`${s}`,c),`${i}`,l)},a),oC(this).handleArrayFieldMetaShift(r,s,"swap",i),this.validateField(r,"change"),this.validateField(`${r}[${s}]`,"change"),this.validateField(`${r}[${i}]`,"change")},this.moveFieldValues=(r,s,i,a)=>{this.setFieldValue(r,o=>{const l=[...o];return l.splice(i,0,l.splice(s,1)[0]),l},a),oC(this).handleArrayFieldMetaShift(r,s,"move",i),this.validateField(r,"change"),this.validateField(`${r}[${s}]`,"change"),this.validateField(`${r}[${i}]`,"change")},this.clearFieldValues=(r,s)=>{const i=this.getFieldValue(r),a=Array.isArray(i)?Math.max(i.length-1,0):null;if(this.setFieldValue(r,[],s),a!==null)for(let o=0;o<=a;o++){const l=`${r}[${o}]`;this.deleteField(l)}this.validateField(r,"change")},this.resetField=r=>{this.baseStore.setState(s=>({...s,fieldMetaBase:{...s.fieldMetaBase,[r]:Tk},values:this.options.defaultValues?iC(s.values,r,fx(this.options.defaultValues,r)):s.values}))},this.getAllErrors=()=>({form:{errors:this.state.errors,errorMap:this.state.errorMap},fields:Object.entries(this.state.fieldMeta).reduce((r,[s,i])=>(Object.keys(i).length&&i.errors.length&&(r[s]={errors:i.errors,errorMap:i.errorMap}),r),{})}),this.parseValuesWithSchema=r=>$0.validate({value:this.state.values,validationSource:"form"},r),this.parseValuesWithSchemaAsync=r=>$0.validateAsync({value:this.state.values,validationSource:"form"},r),this.baseStore=new b4(KI({...t==null?void 0:t.defaultState,values:(t==null?void 0:t.defaultValues)??((n=t==null?void 0:t.defaultState)==null?void 0:n.values)})),this.fieldMetaDerived=new qd({deps:[this.baseStore],fn:({prevDepVals:r,currDepVals:s,prevVal:i})=>{var a,o,l;const c=i,u=r==null?void 0:r[0],d=s[0];let h=0;const m={};for(const y of Object.keys(d.fieldMetaBase)){const b=d.fieldMetaBase[y],v=u==null?void 0:u.fieldMetaBase[y],x=c==null?void 0:c[y],w=fx(d.values,y);let S=x==null?void 0:x.errors;if(!v||b.errorMap!==v.errorMap){S=Object.values(b.errorMap??{}).filter(N=>N!==void 0);const A=(a=this.getFieldInfo(y))==null?void 0:a.instance;A&&!A.options.disableErrorFlat&&(S=S==null?void 0:S.flat(1))}const k=!T5e(S??[]),C=!b.isDirty,T=g0(w,fx(this.options.defaultValues,y))||g0(w,(l=(o=this.getFieldInfo(y))==null?void 0:o.instance)==null?void 0:l.options.defaultValue);if(x&&x.isPristine===C&&x.isValid===k&&x.isDefaultValue===T&&x.errors===S&&b===v){m[y]=x,h++;continue}m[y]={...b,errors:S,isPristine:C,isValid:k,isDefaultValue:T}}return Object.keys(d.fieldMetaBase).length&&c&&h===Object.keys(d.fieldMetaBase).length?c:m}}),this.store=new qd({deps:[this.baseStore,this.fieldMetaDerived],fn:({prevDepVals:r,currDepVals:s,prevVal:i})=>{var a,o,l,c;const u=i,d=r==null?void 0:r[0],h=s[0],m=s[1],y=Object.values(m).filter(Boolean),b=y.some(L=>L.isValidating),v=y.every(L=>L.isValid),x=y.some(L=>L.isTouched),w=y.some(L=>L.isBlurred),S=y.every(L=>L.isDefaultValue),k=x&&((a=h.errorMap)==null?void 0:a.onMount),C=y.some(L=>L.isDirty),T=!C,A=!!((o=h.errorMap)!=null&&o.onMount||y.some(L=>{var te;return(te=L==null?void 0:L.errorMap)==null?void 0:te.onMount})),N=!!b;let I=(u==null?void 0:u.errors)??[];(!d||h.errorMap!==d.errorMap)&&(I=Object.values(h.errorMap).reduce((L,te)=>te===void 0?L:te&&_4(te)?(L.push(te.form),L):(L.push(te),L),[]));const O=I.length===0,B=v&&O,D=this.options.canSubmitWhenInvalid??!1,H=h.submissionAttempts===0&&!x&&!A||!N&&!h.isSubmitting&&B||D;let P=h.errorMap;if(k&&(I=I.filter(L=>L!==h.errorMap.onMount),P=Object.assign(P,{onMount:void 0})),u&&d&&u.errorMap===P&&u.fieldMeta===this.fieldMetaDerived.state&&u.errors===I&&u.isFieldsValidating===b&&u.isFieldsValid===v&&u.isFormValid===O&&u.isValid===B&&u.canSubmit===H&&u.isTouched===x&&u.isBlurred===w&&u.isPristine===T&&u.isDefaultValue===S&&u.isDirty===C&&g0(d,h))return u;let K={...h,errorMap:P,fieldMeta:this.fieldMetaDerived.state,errors:I,isFieldsValidating:b,isFieldsValid:v,isFormValid:O,isValid:B,canSubmit:H,isTouched:x,isBlurred:w,isPristine:T,isDefaultValue:S,isDirty:C};const U=((l=this.options.transform)==null?void 0:l.deps)??[];if(U.length!==this.prevTransformArray.length||U.some((L,te)=>L!==this.prevTransformArray[te])){const L=Object.assign({},this,{state:K});(c=this.options.transform)==null||c.fn(L),K=L.state,this.prevTransformArray=U}return K}}),this.handleSubmit=this.handleSubmit.bind(this),this.update(t||{})}get state(){return this.store.state}runValidator(t){return See(t.validate)?$0[t.type](t.value,t.validate):t.validate(t.value)}async handleSubmit(t){var n,r,s,i,a,o,l,c;if(this.baseStore.setState(d=>({...d,isSubmitted:!1,submissionAttempts:d.submissionAttempts+1,isSubmitSuccessful:!1})),lu(()=>{Object.values(this.fieldInfo).forEach(d=>{d.instance&&(d.instance.state.meta.isTouched||d.instance.setMeta(h=>({...h,isTouched:!0})))})}),!this.state.canSubmit)return;this.baseStore.setState(d=>({...d,isSubmitting:!0}));const u=()=>{this.baseStore.setState(d=>({...d,isSubmitting:!1}))};if(await this.validateAllFields("submit"),!this.state.isFieldsValid){u(),(r=(n=this.options).onSubmitInvalid)==null||r.call(n,{value:this.state.values,formApi:this});return}if(await this.validate("submit"),!this.state.isValid){u(),(i=(s=this.options).onSubmitInvalid)==null||i.call(s,{value:this.state.values,formApi:this});return}lu(()=>{Object.values(this.fieldInfo).forEach(d=>{var h,m,y;(y=(m=(h=d.instance)==null?void 0:h.options.listeners)==null?void 0:m.onSubmit)==null||y.call(m,{value:d.instance.state.value,fieldApi:d.instance})})}),(o=(a=this.options.listeners)==null?void 0:a.onSubmit)==null||o.call(a,{formApi:this});try{await((c=(l=this.options).onSubmit)==null?void 0:c.call(l,{value:this.state.values,formApi:this,meta:t??this.options.onSubmitMeta})),lu(()=>{this.baseStore.setState(d=>({...d,isSubmitted:!0,isSubmitSuccessful:!0})),u()})}catch(d){throw this.baseStore.setState(h=>({...h,isSubmitSuccessful:!1})),u(),d}}setErrorMap(t){lu(()=>{Object.entries(t).forEach(([n,r])=>{const s=n;if(_4(r)){const{formError:i,fieldErrors:a}=HC(r);for(const o of Object.keys(this.fieldInfo))this.getFieldMeta(o)&&this.setFieldMeta(o,c=>({...c,errorMap:{...c.errorMap,[s]:a==null?void 0:a[o]},errorSourceMap:{...c.errorSourceMap,[s]:"form"}}));this.baseStore.setState(o=>({...o,errorMap:{...o.errorMap,[s]:i}}))}else this.baseStore.setState(i=>({...i,errorMap:{...i.errorMap,[s]:r}}))})})}}function HC(e){if(e){if(_4(e)){const t=HC(e.form).formError,n=e.fields;return{formError:t,fieldErrors:n}}return{formError:e}}return{formError:void 0}}function lC(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}class N5e{constructor(t){this.options={},this.mount=()=>{var n,r;const s=this.store.mount();this.options.defaultValue!==void 0&&this.form.setFieldValue(this.name,this.options.defaultValue,{dontUpdateMeta:!0});const i=this.getInfo();i.instance=this,this.update(this.options);const{onMount:a}=this.options.validators||{};if(a){const o=this.runValidator({validate:a,value:{value:this.state.value,fieldApi:this,validationSource:"field"},type:"validate"});o&&this.setMeta(l=>({...l,errorMap:{...l==null?void 0:l.errorMap,onMount:o},errorSourceMap:{...l==null?void 0:l.errorSourceMap,onMount:"field"}}))}return(r=(n=this.options.listeners)==null?void 0:n.onMount)==null||r.call(n,{value:this.state.value,fieldApi:this}),s},this.update=n=>{this.options=n;const r=this.name!==n.name;if(this.name=n.name,this.state.value===void 0){const s=fx(n.form.options.defaultValues,n.name),i=n.defaultValue??s;r?this.setValue(a=>a||i,{dontUpdateMeta:!0}):i!==void 0&&this.setValue(i,{dontUpdateMeta:!0})}this.form.getFieldMeta(this.name)===void 0&&this.setMeta(this.state.meta)},this.getValue=()=>this.form.getFieldValue(this.name),this.setValue=(n,r)=>{this.form.setFieldValue(this.name,n,r),this.triggerOnChangeListener(),this.validate("change")},this.getMeta=()=>this.store.state.meta,this.setMeta=n=>this.form.setFieldMeta(this.name,n),this.getInfo=()=>this.form.getFieldInfo(this.name),this.pushValue=(n,r)=>{this.form.pushFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.insertValue=(n,r,s)=>{this.form.insertFieldValue(this.name,n,r,s),this.triggerOnChangeListener()},this.replaceValue=(n,r,s)=>{this.form.replaceFieldValue(this.name,n,r,s),this.triggerOnChangeListener()},this.removeValue=(n,r)=>{this.form.removeFieldValue(this.name,n,r),this.triggerOnChangeListener()},this.swapValues=(n,r,s)=>{this.form.swapFieldValues(this.name,n,r,s),this.triggerOnChangeListener()},this.moveValue=(n,r,s)=>{this.form.moveFieldValues(this.name,n,r,s),this.triggerOnChangeListener()},this.clearValues=n=>{this.form.clearFieldValues(this.name,n),this.triggerOnChangeListener()},this.getLinkedFields=n=>{const r=Object.values(this.form.fieldInfo),s=[];for(const i of r){if(!i.instance)continue;const{onChangeListenTo:a,onBlurListenTo:o}=i.instance.options.validators||{};n==="change"&&(a!=null&&a.includes(this.name))&&s.push(i.instance),n==="blur"&&(o!=null&&o.includes(this.name))&&s.push(i.instance)}return s},this.validateSync=(n,r)=>{var s;const i=w4(n,this.options),o=this.getLinkedFields(n).reduce((u,d)=>{const h=w4(n,d.options);return h.forEach(m=>{m.field=d}),u.concat(h)},[]);let l=!1;lu(()=>{const u=(d,h)=>{var m;const y=cC(h.cause),b=h.validate?UU(d.runValidator({validate:h.validate,value:{value:d.store.state.value,validationSource:"field",fieldApi:d},type:"validate"})):void 0,v=r[y],{newErrorValue:x,newSource:w}=$U({formLevelError:v,fieldLevelError:b});((m=d.state.meta.errorMap)==null?void 0:m[y])!==x&&d.setMeta(S=>({...S,errorMap:{...S.errorMap,[y]:x},errorSourceMap:{...S.errorSourceMap,[y]:w}})),x&&(l=!0)};for(const d of i)u(this,d);for(const d of o)d.validate&&u(d.field,d)});const c=cC("submit");return(s=this.state.meta.errorMap)!=null&&s[c]&&n!=="submit"&&!l&&this.setMeta(u=>({...u,errorMap:{...u.errorMap,[c]:void 0},errorSourceMap:{...u.errorSourceMap,[c]:void 0}})),{hasErrored:l}},this.validateAsync=async(n,r)=>{const s=x4(n,this.options),i=await r,a=this.getLinkedFields(n),o=a.reduce((h,m)=>{const y=x4(n,m.options);return y.forEach(b=>{b.field=m}),h.concat(y)},[]);this.state.meta.isValidating||this.setMeta(h=>({...h,isValidating:!0}));for(const h of a)h.setMeta(m=>({...m,isValidating:!0}));const l=[],c=[],u=(h,m,y)=>{const b=cC(m.cause),v=h.getInfo().validationMetaMap[b];v==null||v.lastAbortController.abort();const x=new AbortController;this.getInfo().validationMetaMap[b]={lastAbortController:x},y.push(new Promise(async w=>{var S;let k;try{k=await new Promise((I,O)=>{this.timeoutIds.validations[m.cause]&&clearTimeout(this.timeoutIds.validations[m.cause]),this.timeoutIds.validations[m.cause]=setTimeout(async()=>{if(x.signal.aborted)return I(void 0);try{I(await this.runValidator({validate:m.validate,value:{value:h.store.state.value,fieldApi:h,signal:x.signal,validationSource:"field"},type:"validateAsync"}))}catch(B){O(B)}},m.debounceMs)})}catch(I){k=I}if(x.signal.aborted)return w(void 0);const C=UU(k),T=(S=i[this.name])==null?void 0:S[b],{newErrorValue:A,newSource:N}=$U({formLevelError:T,fieldLevelError:C});h.setMeta(I=>({...I,errorMap:{...I==null?void 0:I.errorMap,[b]:A},errorSourceMap:{...I.errorSourceMap,[b]:N}})),w(A)}))};for(const h of s)h.validate&&u(this,h,l);for(const h of o)h.validate&&u(h.field,h,c);let d=[];(l.length||c.length)&&(d=await Promise.all(l),await Promise.all(c)),this.setMeta(h=>({...h,isValidating:!1}));for(const h of a)h.setMeta(m=>({...m,isValidating:!1}));return d.filter(Boolean)},this.validate=(n,r)=>{var s;if(!this.state.meta.isTouched)return[];const{fieldsErrorMap:i}=r!=null&&r.skipFormValidation?{fieldsErrorMap:{}}:this.form.validateSync(n),{hasErrored:a}=this.validateSync(n,i[this.name]??{});if(a&&!this.options.asyncAlways)return(s=this.getInfo().validationMetaMap[cC(n)])==null||s.lastAbortController.abort(),this.state.meta.errors;const o=r!=null&&r.skipFormValidation?Promise.resolve({}):this.form.validateAsync(n);return this.validateAsync(n,o)},this.handleChange=n=>{this.setValue(n)},this.handleBlur=()=>{this.state.meta.isTouched||(this.setMeta(r=>({...r,isTouched:!0})),this.validate("change")),this.state.meta.isBlurred||this.setMeta(r=>({...r,isBlurred:!0})),this.validate("blur"),this.triggerOnBlurListener()},this.parseValueWithSchema=n=>$0.validate({value:this.state.value,validationSource:"field"},n),this.parseValueWithSchemaAsync=n=>$0.validateAsync({value:this.state.value,validationSource:"field"},n),this.form=t.form,this.name=t.name,this.timeoutIds={validations:{},listeners:{},formListeners:{}},this.store=new qd({deps:[this.form.store],fn:()=>{const n=this.form.getFieldValue(this.name),r=this.form.getFieldMeta(this.name)??{...Tk,...t.defaultMeta};return{value:n,meta:r}}}),this.options=t}get state(){return this.store.state}runValidator(t){return See(t.validate)?$0[t.type](t.value,t.validate):t.validate(t.value)}setErrorMap(t){this.setMeta(n=>({...n,errorMap:{...n.errorMap,...t}}))}triggerOnBlurListener(){var t,n,r,s,i,a;const o=(t=this.form.options.listeners)==null?void 0:t.onBlurDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onBlur)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(s=this.options.listeners)==null?void 0:s.onBlurDebounceMs;l&&l>0?(this.timeoutIds.listeners.blur&&clearTimeout(this.timeoutIds.listeners.blur),this.timeoutIds.listeners.blur=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onBlur)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(i=this.options.listeners)==null?void 0:i.onBlur)==null||a.call(i,{value:this.state.value,fieldApi:this})}triggerOnChangeListener(){var t,n,r,s,i,a;const o=(t=this.form.options.listeners)==null?void 0:t.onChangeDebounceMs;o&&o>0?(this.timeoutIds.formListeners.blur&&clearTimeout(this.timeoutIds.formListeners.blur),this.timeoutIds.formListeners.blur=setTimeout(()=>{var c,u;(u=(c=this.form.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{formApi:this.form,fieldApi:this})},o)):(r=(n=this.form.options.listeners)==null?void 0:n.onChange)==null||r.call(n,{formApi:this.form,fieldApi:this});const l=(s=this.options.listeners)==null?void 0:s.onChangeDebounceMs;l&&l>0?(this.timeoutIds.listeners.change&&clearTimeout(this.timeoutIds.listeners.change),this.timeoutIds.listeners.change=setTimeout(()=>{var c,u;(u=(c=this.options.listeners)==null?void 0:c.onChange)==null||u.call(c,{value:this.state.value,fieldApi:this})},l)):(a=(i=this.options.listeners)==null?void 0:i.onChange)==null||a.call(i,{value:this.state.value,fieldApi:this})}}function UU(e){if(e)return e}function cC(e){switch(e){case"submit":return"onSubmit";case"blur":return"onBlur";case"mount":return"onMount";case"server":return"onServer";case"change":default:return"onChange"}}var YI={exports:{}},ZI={},XI={exports:{}},JI={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qU;function M5e(){if(qU)return JI;qU=1;var e=qy();function t(d,h){return d===h&&(d!==0||1/d===1/h)||d!==d&&h!==h}var n=typeof Object.is=="function"?Object.is:t,r=e.useState,s=e.useEffect,i=e.useLayoutEffect,a=e.useDebugValue;function o(d,h){var m=h(),y=r({inst:{value:m,getSnapshot:h}}),b=y[0].inst,v=y[1];return i(function(){b.value=m,b.getSnapshot=h,l(b)&&v({inst:b})},[d,m,h]),s(function(){return l(b)&&v({inst:b}),d(function(){l(b)&&v({inst:b})})},[d]),a(m),m}function l(d){var h=d.getSnapshot;d=d.value;try{var m=h();return!n(d,m)}catch{return!0}}function c(d,h){return h()}var u=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?c:o;return JI.useSyncExternalStore=e.useSyncExternalStore!==void 0?e.useSyncExternalStore:u,JI}var VU;function I5e(){return VU||(VU=1,XI.exports=M5e()),XI.exports}/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var WU;function j5e(){if(WU)return ZI;WU=1;var e=qy(),t=I5e();function n(c,u){return c===u&&(c!==0||1/c===1/u)||c!==c&&u!==u}var r=typeof Object.is=="function"?Object.is:n,s=t.useSyncExternalStore,i=e.useRef,a=e.useEffect,o=e.useMemo,l=e.useDebugValue;return ZI.useSyncExternalStoreWithSelector=function(c,u,d,h,m){var y=i(null);if(y.current===null){var b={hasValue:!1,value:null};y.current=b}else b=y.current;y=o(function(){function x(T){if(!w){if(w=!0,S=T,T=h(T),m!==void 0&&b.hasValue){var A=b.value;if(m(A,T))return k=A}return k=T}if(A=k,r(S,T))return A;var N=h(T);return m!==void 0&&m(A,N)?(S=T,A):(S=T,k=N)}var w=!1,S,k,C=d===void 0?null:d;return[function(){return x(u())},C===null?void 0:function(){return x(C())}]},[u,d,h,m]);var v=s(c,y[0],y[1]);return a(function(){b.hasValue=!0,b.value=v},[v]),l(v),v},ZI}var HU;function P5e(){return HU||(HU=1,YI.exports=j5e()),YI.exports}var O5e=P5e();function TF(e,t=n=>n){return O5e.useSyncExternalStoreWithSelector(e.subscribe,()=>e.state,()=>e.state,t,D5e)}function D5e(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,s]of e)if(!t.has(r)||!Object.is(s,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(let r=0;r<n.length;r++)if(!Object.prototype.hasOwnProperty.call(t,n[r])||!Object.is(e[n[r]],t[n[r]]))return!1;return!0}const Ak=typeof window<"u"?E.useLayoutEffect:E.useEffect;function F5e(e){const[t]=E.useState(()=>{const r=new N5e({...e,form:e.form,name:e.name});return r.Field=Cee,r});return Ak(t.mount,[t]),Ak(()=>{t.update(e)}),TF(t.store,e.mode==="array"?n=>[n.meta,Object.keys(n.value??[]).length]:void 0),t}const Cee=({children:e,...t})=>{const n=F5e(t),r=E.useMemo(()=>MT(e,n),[e,n,n.state.value,n.state.meta]);return f.jsx(f.Fragment,{children:r})};function L5e({form:e,selector:t,children:n}){const r=TF(e.store,t);return MT(n,r)}function ii(e){const[t]=E.useState(()=>{const n=new R5e(e),r=n;return r.Field=function(i){return f.jsx(Cee,{...i,form:n})},r.Subscribe=s=>f.jsx(L5e,{form:n,selector:s.selector,children:s.children}),r});return Ak(t.mount,[]),TF(t.store,n=>n.isSubmitting),Ak(()=>{t.update(e)}),t}function xn({className:e,type:t,...n}){return f.jsx("input",{type:t,"data-slot":"input",className:Ze("file:text-foreground placeholder:text-muted-foreground selection:bg-primary selection:text-primary-foreground dark:bg-input/30 border-input flex h-9 w-full min-w-0 rounded-md border bg-transparent px-3 py-1 text-base shadow-xs transition-[color,box-shadow] outline-none file:inline-flex file:h-7 file:border-0 file:bg-transparent file:text-sm file:font-medium disabled:pointer-events-none disabled:cursor-not-allowed disabled:opacity-50 md:text-sm","focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px]","aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive",e),...n})}function B5e(e){const t=e+"CollectionProvider",[n,r]=Yi(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:v,children:x}=b,w=Ve.useRef(null),S=Ve.useRef(new Map).current;return f.jsx(s,{scope:v,itemMap:S,collectionRef:w,children:x})};a.displayName=t;const o=e+"CollectionSlot",l=ju(o),c=Ve.forwardRef((b,v)=>{const{scope:x,children:w}=b,S=i(o,x),k=In(v,S.collectionRef);return f.jsx(l,{ref:k,children:w})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",h=ju(u),m=Ve.forwardRef((b,v)=>{const{scope:x,children:w,...S}=b,k=Ve.useRef(null),C=In(v,k),T=i(u,x);return Ve.useEffect(()=>(T.itemMap.set(k,{ref:k,...S}),()=>void T.itemMap.delete(k))),f.jsx(h,{[d]:"",ref:C,children:w})});m.displayName=u;function y(b){const v=i(e+"CollectionConsumer",b);return Ve.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const S=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((T,A)=>S.indexOf(T.ref.current)-S.indexOf(A.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:c,ItemSlot:m},y,r]}var $5e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],_i=$5e.reduce((e,t)=>{const n=ju(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function z5e(e,t){e&&dl.flushSync(()=>e.dispatchEvent(t))}var U5e="DismissableLayer",S4="dismissableLayer.update",q5e="dismissableLayer.pointerDownOutside",V5e="dismissableLayer.focusOutside",GU,kee=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),Eee=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=E.useContext(kee),[u,d]=E.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=E.useState({}),y=In(t,A=>d(A)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,k=w>=x,C=G5e(A=>{const N=A.target,I=[...c.branches].some(O=>O.contains(N));!k||I||(s==null||s(A),a==null||a(A),A.defaultPrevented||o==null||o())},h),T=K5e(A=>{const N=A.target;[...c.branches].some(O=>O.contains(N))||(i==null||i(A),a==null||a(A),A.defaultPrevented||o==null||o())},h);return cO(A=>{w===c.layers.size-1&&(r==null||r(A),!A.defaultPrevented&&o&&(A.preventDefault(),o()))},h),E.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(GU=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),KU(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=GU)}},[u,h,n,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),KU())},[u,c]),E.useEffect(()=>{const A=()=>m({});return document.addEventListener(S4,A),()=>document.removeEventListener(S4,A)},[]),f.jsx(_i.div,{...l,ref:y,style:{pointerEvents:S?k?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,T.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,T.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,C.onPointerDownCapture)})});Eee.displayName=U5e;var W5e="DismissableLayerBranch",H5e=E.forwardRef((e,t)=>{const n=E.useContext(kee),r=E.useRef(null),s=In(t,r);return E.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(_i.div,{...e,ref:s})});H5e.displayName=W5e;function G5e(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){Tee(q5e,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function K5e(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1);return E.useEffect(()=>{const s=i=>{i.target&&!r.current&&Tee(V5e,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function KU(){const e=new CustomEvent(S4);document.dispatchEvent(e)}function Tee(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?z5e(s,i):s.dispatchEvent(i)}var QI=0;function IT(){E.useEffect(()=>{const e=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",e[0]??YU()),document.body.insertAdjacentElement("beforeend",e[1]??YU()),QI++,()=>{QI===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(t=>t.remove()),QI--}},[])}function YU(){const e=document.createElement("span");return e.setAttribute("data-radix-focus-guard",""),e.tabIndex=0,e.style.outline="none",e.style.opacity="0",e.style.position="fixed",e.style.pointerEvents="none",e}var e3="focusScope.autoFocusOnMount",t3="focusScope.autoFocusOnUnmount",ZU={bubbles:!1,cancelable:!0},Y5e="FocusScope",Aee=E.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=E.useState(null),c=Es(s),u=Es(i),d=E.useRef(null),h=In(t,b=>l(b)),m=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let b=function(S){if(m.paused||!o)return;const k=S.target;o.contains(k)?d.current=k:uh(d.current,{select:!0})},v=function(S){if(m.paused||!o)return;const k=S.relatedTarget;k!==null&&(o.contains(k)||uh(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const C of S)C.removedNodes.length>0&&uh(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),E.useEffect(()=>{if(o){JU.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(e3,ZU);o.addEventListener(e3,c),o.dispatchEvent(x),x.defaultPrevented||(Z5e(t8e(Ree(o)),{select:!0}),document.activeElement===b&&uh(o))}return()=>{o.removeEventListener(e3,c),setTimeout(()=>{const x=new CustomEvent(t3,ZU);o.addEventListener(t3,u),o.dispatchEvent(x),x.defaultPrevented||uh(b??document.body,{select:!0}),o.removeEventListener(t3,u),JU.remove(m)},0)}}},[o,c,u,m]);const y=E.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[S,k]=X5e(w);S&&k?!b.shiftKey&&x===k?(b.preventDefault(),n&&uh(S,{select:!0})):b.shiftKey&&x===S&&(b.preventDefault(),n&&uh(k,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(_i.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});Aee.displayName=Y5e;function Z5e(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(uh(r,{select:t}),document.activeElement!==n)return}function X5e(e){const t=Ree(e),n=XU(t,e),r=XU(t.reverse(),e);return[n,r]}function Ree(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function XU(e,t){for(const n of e)if(!J5e(n,{upTo:t}))return n}function J5e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function Q5e(e){return e instanceof HTMLInputElement&&"select"in e}function uh(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&Q5e(e)&&t&&e.select()}}var JU=e8e();function e8e(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=QU(e,t),e.unshift(t)},remove(t){var n;e=QU(e,t),(n=e[0])==null||n.resume()}}}function QU(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function t8e(e){return e.filter(t=>t.tagName!=="A")}var n8e="Arrow",Nee=E.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(_i.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});Nee.displayName=n8e;var r8e=Nee,AF="Popper",[Mee,Iee]=Yi(AF),[s8e,jee]=Mee(AF),Pee=e=>{const{__scopePopper:t,children:n}=e,[r,s]=E.useState(null);return f.jsx(s8e,{scope:t,anchor:r,onAnchorChange:s,children:n})};Pee.displayName=AF;var Oee="PopperAnchor",Dee=E.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=jee(Oee,n),a=E.useRef(null),o=In(t,a);return E.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(_i.div,{...s,ref:o})});Dee.displayName=Oee;var RF="PopperContent",[i8e,a8e]=Mee(RF),Fee=E.forwardRef((e,t)=>{var Fe,Se,Ce,qe,Qe,We;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=jee(RF,n),[x,w]=E.useState(null),S=In(t,je=>w(je)),[k,C]=E.useState(null),T=Jy(k),A=(T==null?void 0:T.width)??0,N=(T==null?void 0:T.height)??0,I=r+(i!=="center"?"-"+i:""),O=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},B=Array.isArray(c)?c:[c],D=B.length>0,H={padding:O,boundary:B.filter(l8e),altBoundary:D},{refs:P,floatingStyles:K,placement:U,isPositioned:V,middlewareData:L}=bO({strategy:"fixed",placement:I,whileElementsMounted:(...je)=>yO(...je,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[vO({mainAxis:s+N,alignmentAxis:a}),l&&xO({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?wO():void 0,...H}),l&&_O({...H}),SO({...H,apply:({elements:je,rects:Y,availableWidth:ye,availableHeight:Ie})=>{const{width:ce,height:oe}=Y.reference,se=je.floating.style;se.setProperty("--radix-popper-available-width",`${ye}px`),se.setProperty("--radix-popper-available-height",`${Ie}px`),se.setProperty("--radix-popper-anchor-width",`${ce}px`),se.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),k&&kO({element:k,padding:o}),c8e({arrowWidth:A,arrowHeight:N}),h&&CO({strategy:"referenceHidden",...H})]}),[te,W]=$ee(U),Q=Es(y);si(()=>{V&&(Q==null||Q())},[V,Q]);const ee=(Fe=L.arrow)==null?void 0:Fe.x,re=(Se=L.arrow)==null?void 0:Se.y,pe=((Ce=L.arrow)==null?void 0:Ce.centerOffset)!==0,[de,Oe]=E.useState();return si(()=>{x&&Oe(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:P.setFloating,"data-radix-popper-content-wrapper":"",style:{...K,transform:V?K.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:de,"--radix-popper-transform-origin":[(qe=L.transformOrigin)==null?void 0:qe.x,(Qe=L.transformOrigin)==null?void 0:Qe.y].join(" "),...((We=L.hide)==null?void 0:We.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(i8e,{scope:n,placedSide:te,onArrowChange:C,arrowX:ee,arrowY:re,shouldHideArrow:pe,children:f.jsx(_i.div,{"data-side":te,"data-align":W,...b,ref:S,style:{...b.style,animation:V?void 0:"none"}})})})});Fee.displayName=RF;var Lee="PopperArrow",o8e={top:"bottom",right:"left",bottom:"top",left:"right"},Bee=E.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=a8e(Lee,r),a=o8e[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(r8e,{...s,ref:n,style:{...s.style,display:"block"}})})});Bee.displayName=Lee;function l8e(e){return e!==null}var c8e=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=$ee(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function $ee(e){const[t,n="center"]=e.split("-");return[t,n]}var u8e=Pee,d8e=Dee,f8e=Fee,h8e=Bee,p8e="Portal",zee=E.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=E.useState(!1);si(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?AE.createPortal(f.jsx(_i.div,{...r,ref:t}),a):null});zee.displayName=p8e;function jT(e){const t=E.useRef({value:e,previous:e});return E.useMemo(()=>(t.current.value!==e&&(t.current.previous=t.current.value,t.current.value=e),t.current.previous),[e])}var Uee=Object.freeze({position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal"}),m8e="VisuallyHidden",g8e=E.forwardRef((e,t)=>f.jsx(_i.span,{...e,ref:t,style:{...Uee,...e.style}}));g8e.displayName=m8e;var y8e=function(e){if(typeof document>"u")return null;var t=Array.isArray(e)?e[0]:e;return t.ownerDocument.body},o0=new WeakMap,uC=new WeakMap,dC={},n3=0,qee=function(e){return e&&(e.host||qee(e.parentNode))},b8e=function(e,t){return t.map(function(n){if(e.contains(n))return n;var r=qee(n);return r&&e.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",e,". Doing nothing"),null)}).filter(function(n){return!!n})},v8e=function(e,t,n,r){var s=b8e(t,Array.isArray(e)?e:[e]);dC[n]||(dC[n]=new WeakMap);var i=dC[n],a=[],o=new Set,l=new Set(s),c=function(d){!d||o.has(d)||(o.add(d),c(d.parentNode))};s.forEach(c);var u=function(d){!d||l.has(d)||Array.prototype.forEach.call(d.children,function(h){if(o.has(h))u(h);else try{var m=h.getAttribute(r),y=m!==null&&m!=="false",b=(o0.get(h)||0)+1,v=(i.get(h)||0)+1;o0.set(h,b),i.set(h,v),a.push(h),b===1&&y&&uC.set(h,!0),v===1&&h.setAttribute(n,"true"),y||h.setAttribute(r,"true")}catch(x){console.error("aria-hidden: cannot operate on ",h,x)}})};return u(t),o.clear(),n3++,function(){a.forEach(function(d){var h=o0.get(d)-1,m=i.get(d)-1;o0.set(d,h),i.set(d,m),h||(uC.has(d)||d.removeAttribute(r),uC.delete(d)),m||d.removeAttribute(n)}),n3--,n3||(o0=new WeakMap,o0=new WeakMap,uC=new WeakMap,dC={})}},PT=function(e,t,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(e)?e:[e]),s=y8e(e);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),v8e(r,s,n,"aria-hidden")):function(){return null}},vu=function(){return vu=Object.assign||function(t){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},vu.apply(this,arguments)};function Vee(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(e!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(e);s<r.length;s++)t.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(e,r[s])&&(n[r[s]]=e[r[s]]);return n}function x8e(e,t,n){if(n||arguments.length===2)for(var r=0,s=t.length,i;r<s;r++)(i||!(r in t))&&(i||(i=Array.prototype.slice.call(t,0,r)),i[r]=t[r]);return e.concat(i||Array.prototype.slice.call(t))}var GC="right-scroll-bar-position",KC="width-before-scroll-bar",w8e="with-scroll-bars-hidden",_8e="--removed-body-scroll-bar-size";function r3(e,t){return typeof e=="function"?e(t):e&&(e.current=t),e}function S8e(e,t){var n=E.useState(function(){return{value:e,callback:t,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=t,n.facade}var C8e=typeof window<"u"?E.useLayoutEffect:E.useEffect,eq=new WeakMap;function k8e(e,t){var n=S8e(null,function(r){return e.forEach(function(s){return r3(s,r)})});return C8e(function(){var r=eq.get(n);if(r){var s=new Set(r),i=new Set(e),a=n.current;s.forEach(function(o){i.has(o)||r3(o,null)}),i.forEach(function(o){s.has(o)||r3(o,a)})}eq.set(n,e)},[e]),n}function E8e(e){return e}function T8e(e,t){t===void 0&&(t=E8e);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:e},useMedium:function(i){var a=t(i,r);return n.push(a),function(){n=n.filter(function(o){return o!==a})}},assignSyncMedium:function(i){for(r=!0;n.length;){var a=n;n=[],a.forEach(i)}n={push:function(o){return i(o)},filter:function(){return n}}},assignMedium:function(i){r=!0;var a=[];if(n.length){var o=n;n=[],o.forEach(i),a=n}var l=function(){var u=a;a=[],u.forEach(i)},c=function(){return Promise.resolve().then(l)};c(),n={push:function(u){a.push(u),c()},filter:function(u){return a=a.filter(u),n}}}};return s}function A8e(e){e===void 0&&(e={});var t=T8e(null);return t.options=vu({async:!0,ssr:!1},e),t}var Wee=function(e){var t=e.sideCar,n=Vee(e,["sideCar"]);if(!t)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=t.read();if(!r)throw new Error("Sidecar medium not found");return E.createElement(r,vu({},n))};Wee.isSideCarExport=!0;function R8e(e,t){return e.useMedium(t),Wee}var Hee=A8e(),s3=function(){},OT=E.forwardRef(function(e,t){var n=E.useRef(null),r=E.useState({onScrollCapture:s3,onWheelCapture:s3,onTouchMoveCapture:s3}),s=r[0],i=r[1],a=e.forwardProps,o=e.children,l=e.className,c=e.removeScrollBar,u=e.enabled,d=e.shards,h=e.sideCar,m=e.noIsolation,y=e.inert,b=e.allowPinchZoom,v=e.as,x=v===void 0?"div":v,w=e.gapMode,S=Vee(e,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),k=h,C=k8e([n,t]),T=vu(vu({},S),s);return E.createElement(E.Fragment,null,u&&E.createElement(k,{sideCar:Hee,removeScrollBar:c,shards:d,noIsolation:m,inert:y,setCallbacks:i,allowPinchZoom:!!b,lockRef:n,gapMode:w}),a?E.cloneElement(E.Children.only(o),vu(vu({},T),{ref:C})):E.createElement(x,vu({},T,{className:l,ref:C}),o))});OT.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};OT.classNames={fullWidth:KC,zeroRight:GC};var N8e=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function M8e(){if(!document)return null;var e=document.createElement("style");e.type="text/css";var t=N8e();return t&&e.setAttribute("nonce",t),e}function I8e(e,t){e.styleSheet?e.styleSheet.cssText=t:e.appendChild(document.createTextNode(t))}function j8e(e){var t=document.head||document.getElementsByTagName("head")[0];t.appendChild(e)}var P8e=function(){var e=0,t=null;return{add:function(n){e==0&&(t=M8e())&&(I8e(t,n),j8e(t)),e++},remove:function(){e--,!e&&t&&(t.parentNode&&t.parentNode.removeChild(t),t=null)}}},O8e=function(){var e=P8e();return function(t,n){E.useEffect(function(){return e.add(t),function(){e.remove()}},[t&&n])}},Gee=function(){var e=O8e(),t=function(n){var r=n.styles,s=n.dynamic;return e(r,s),null};return t},D8e={left:0,top:0,right:0,gap:0},i3=function(e){return parseInt(e||"",10)||0},F8e=function(e){var t=window.getComputedStyle(document.body),n=t[e==="padding"?"paddingLeft":"marginLeft"],r=t[e==="padding"?"paddingTop":"marginTop"],s=t[e==="padding"?"paddingRight":"marginRight"];return[i3(n),i3(r),i3(s)]},L8e=function(e){if(e===void 0&&(e="margin"),typeof window>"u")return D8e;var t=F8e(e),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:t[0],top:t[1],right:t[2],gap:Math.max(0,r-n+t[2]-t[0])}},B8e=Gee(),z0="data-scroll-locked",$8e=function(e,t,n,r){var s=e.left,i=e.top,a=e.right,o=e.gap;return n===void 0&&(n="margin"),`
  .`.concat(w8e,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(o,"px ").concat(r,`;
  }
  body[`).concat(z0,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([t&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(GC,` {
    right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(KC,` {
    margin-right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(GC," .").concat(GC,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(KC," .").concat(KC,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(z0,`] {
    `).concat(_8e,": ").concat(o,`px;
  }
`)},tq=function(){var e=parseInt(document.body.getAttribute(z0)||"0",10);return isFinite(e)?e:0},z8e=function(){E.useEffect(function(){return document.body.setAttribute(z0,(tq()+1).toString()),function(){var e=tq()-1;e<=0?document.body.removeAttribute(z0):document.body.setAttribute(z0,e.toString())}},[])},U8e=function(e){var t=e.noRelative,n=e.noImportant,r=e.gapMode,s=r===void 0?"margin":r;z8e();var i=E.useMemo(function(){return L8e(s)},[s]);return E.createElement(B8e,{styles:$8e(i,!t,s,n?"":"!important")})},C4=!1;if(typeof window<"u")try{var fC=Object.defineProperty({},"passive",{get:function(){return C4=!0,!0}});window.addEventListener("test",fC,fC),window.removeEventListener("test",fC,fC)}catch{C4=!1}var l0=C4?{passive:!1}:!1,q8e=function(e){return e.tagName==="TEXTAREA"},Kee=function(e,t){if(!(e instanceof Element))return!1;var n=window.getComputedStyle(e);return n[t]!=="hidden"&&!(n.overflowY===n.overflowX&&!q8e(e)&&n[t]==="visible")},V8e=function(e){return Kee(e,"overflowY")},W8e=function(e){return Kee(e,"overflowX")},nq=function(e,t){var n=t.ownerDocument,r=t;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=Yee(e,r);if(s){var i=Zee(e,r),a=i[1],o=i[2];if(a>o)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},H8e=function(e){var t=e.scrollTop,n=e.scrollHeight,r=e.clientHeight;return[t,n,r]},G8e=function(e){var t=e.scrollLeft,n=e.scrollWidth,r=e.clientWidth;return[t,n,r]},Yee=function(e,t){return e==="v"?V8e(t):W8e(t)},Zee=function(e,t){return e==="v"?H8e(t):G8e(t)},K8e=function(e,t){return e==="h"&&t==="rtl"?-1:1},Y8e=function(e,t,n,r,s){var i=K8e(e,window.getComputedStyle(t).direction),a=i*r,o=n.target,l=t.contains(o),c=!1,u=a>0,d=0,h=0;do{var m=Zee(e,o),y=m[0],b=m[1],v=m[2],x=b-v-i*y;(y||x)&&Yee(e,o)&&(d+=x,h+=y),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!l&&o!==document.body||l&&(t.contains(o)||t===o));return(u&&Math.abs(d)<1||!u&&Math.abs(h)<1)&&(c=!0),c},hC=function(e){return"changedTouches"in e?[e.changedTouches[0].clientX,e.changedTouches[0].clientY]:[0,0]},rq=function(e){return[e.deltaX,e.deltaY]},sq=function(e){return e&&"current"in e?e.current:e},Z8e=function(e,t){return e[0]===t[0]&&e[1]===t[1]},X8e=function(e){return`
  .block-interactivity-`.concat(e,` {pointer-events: none;}
  .allow-interactivity-`).concat(e,` {pointer-events: all;}
`)},J8e=0,c0=[];function Q8e(e){var t=E.useRef([]),n=E.useRef([0,0]),r=E.useRef(),s=E.useState(J8e++)[0],i=E.useState(Gee)[0],a=E.useRef(e);E.useEffect(function(){a.current=e},[e]),E.useEffect(function(){if(e.inert){document.body.classList.add("block-interactivity-".concat(s));var b=x8e([e.lockRef.current],(e.shards||[]).map(sq),!0).filter(Boolean);return b.forEach(function(v){return v.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),b.forEach(function(v){return v.classList.remove("allow-interactivity-".concat(s))})}}},[e.inert,e.lockRef.current,e.shards]);var o=E.useCallback(function(b,v){if("touches"in b&&b.touches.length===2||b.type==="wheel"&&b.ctrlKey)return!a.current.allowPinchZoom;var x=hC(b),w=n.current,S="deltaX"in b?b.deltaX:w[0]-x[0],k="deltaY"in b?b.deltaY:w[1]-x[1],C,T=b.target,A=Math.abs(S)>Math.abs(k)?"h":"v";if("touches"in b&&A==="h"&&T.type==="range")return!1;var N=nq(A,T);if(!N)return!0;if(N?C=A:(C=A==="v"?"h":"v",N=nq(A,T)),!N)return!1;if(!r.current&&"changedTouches"in b&&(S||k)&&(r.current=C),!C)return!0;var I=r.current||C;return Y8e(I,v,b,I==="h"?S:k)},[]),l=E.useCallback(function(b){var v=b;if(!(!c0.length||c0[c0.length-1]!==i)){var x="deltaY"in v?rq(v):hC(v),w=t.current.filter(function(C){return C.name===v.type&&(C.target===v.target||v.target===C.shadowParent)&&Z8e(C.delta,x)})[0];if(w&&w.should){v.cancelable&&v.preventDefault();return}if(!w){var S=(a.current.shards||[]).map(sq).filter(Boolean).filter(function(C){return C.contains(v.target)}),k=S.length>0?o(v,S[0]):!a.current.noIsolation;k&&v.cancelable&&v.preventDefault()}}},[]),c=E.useCallback(function(b,v,x,w){var S={name:b,delta:v,target:x,should:w,shadowParent:eLe(x)};t.current.push(S),setTimeout(function(){t.current=t.current.filter(function(k){return k!==S})},1)},[]),u=E.useCallback(function(b){n.current=hC(b),r.current=void 0},[]),d=E.useCallback(function(b){c(b.type,rq(b),b.target,o(b,e.lockRef.current))},[]),h=E.useCallback(function(b){c(b.type,hC(b),b.target,o(b,e.lockRef.current))},[]);E.useEffect(function(){return c0.push(i),e.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:h}),document.addEventListener("wheel",l,l0),document.addEventListener("touchmove",l,l0),document.addEventListener("touchstart",u,l0),function(){c0=c0.filter(function(b){return b!==i}),document.removeEventListener("wheel",l,l0),document.removeEventListener("touchmove",l,l0),document.removeEventListener("touchstart",u,l0)}},[]);var m=e.removeScrollBar,y=e.inert;return E.createElement(E.Fragment,null,y?E.createElement(i,{styles:X8e(s)}):null,m?E.createElement(U8e,{gapMode:e.gapMode}):null)}function eLe(e){for(var t=null;e!==null;)e instanceof ShadowRoot&&(t=e.host,e=e.host),e=e.parentNode;return t}const tLe=R8e(Hee,Q8e);var n_=E.forwardRef(function(e,t){return E.createElement(OT,vu({},e,{ref:t,sideCar:tLe}))});n_.classNames=OT.classNames;var nLe=[" ","Enter","ArrowUp","ArrowDown"],rLe=[" ","Enter"],jm="Select",[DT,FT,sLe]=B5e(jm),[vb,Fdt]=Yi(jm,[sLe,Iee]),LT=Iee(),[iLe,dp]=vb(jm),[aLe,oLe]=vb(jm),Xee=e=>{const{__scopeSelect:t,children:n,open:r,defaultOpen:s,onOpenChange:i,value:a,defaultValue:o,onValueChange:l,dir:c,name:u,autoComplete:d,disabled:h,required:m,form:y}=e,b=LT(t),[v,x]=E.useState(null),[w,S]=E.useState(null),[k,C]=E.useState(!1),T=mb(c),[A,N]=Lc({prop:r,defaultProp:s??!1,onChange:i,caller:jm}),[I,O]=Lc({prop:a,defaultProp:o,onChange:l,caller:jm}),B=E.useRef(null),D=v?y||!!v.closest("form"):!0,[H,P]=E.useState(new Set),K=Array.from(H).map(U=>U.props.value).join(";");return f.jsx(u8e,{...b,children:f.jsxs(iLe,{required:m,scope:t,trigger:v,onTriggerChange:x,valueNode:w,onValueNodeChange:S,valueNodeHasChildren:k,onValueNodeHasChildrenChange:C,contentId:ca(),value:I,onValueChange:O,open:A,onOpenChange:N,dir:T,triggerPointerDownPosRef:B,disabled:h,children:[f.jsx(DT.Provider,{scope:t,children:f.jsx(aLe,{scope:e.__scopeSelect,onNativeOptionAdd:E.useCallback(U=>{P(V=>new Set(V).add(U))},[]),onNativeOptionRemove:E.useCallback(U=>{P(V=>{const L=new Set(V);return L.delete(U),L})},[]),children:n})}),D?f.jsxs(vte,{"aria-hidden":!0,required:m,tabIndex:-1,name:u,autoComplete:d,value:I,onChange:U=>O(U.target.value),disabled:h,form:y,children:[I===void 0?f.jsx("option",{value:""}):null,Array.from(H)]},K):null]})})};Xee.displayName=jm;var Jee="SelectTrigger",Qee=E.forwardRef((e,t)=>{const{__scopeSelect:n,disabled:r=!1,...s}=e,i=LT(n),a=dp(Jee,n),o=a.disabled||r,l=In(t,a.onTriggerChange),c=FT(n),u=E.useRef("touch"),[d,h,m]=wte(b=>{const v=c().filter(S=>!S.disabled),x=v.find(S=>S.value===a.value),w=_te(v,b,x);w!==void 0&&a.onValueChange(w.value)}),y=b=>{o||(a.onOpenChange(!0),m()),b&&(a.triggerPointerDownPosRef.current={x:Math.round(b.pageX),y:Math.round(b.pageY)})};return f.jsx(d8e,{asChild:!0,...i,children:f.jsx(_i.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":xte(a.value)?"":void 0,...s,ref:l,onClick:Wt(s.onClick,b=>{b.currentTarget.focus(),u.current!=="mouse"&&y(b)}),onPointerDown:Wt(s.onPointerDown,b=>{u.current=b.pointerType;const v=b.target;v.hasPointerCapture(b.pointerId)&&v.releasePointerCapture(b.pointerId),b.button===0&&b.ctrlKey===!1&&b.pointerType==="mouse"&&(y(b),b.preventDefault())}),onKeyDown:Wt(s.onKeyDown,b=>{const v=d.current!=="";!(b.ctrlKey||b.altKey||b.metaKey)&&b.key.length===1&&h(b.key),!(v&&b.key===" ")&&nLe.includes(b.key)&&(y(),b.preventDefault())})})})});Qee.displayName=Jee;var ete="SelectValue",tte=E.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:a="",...o}=e,l=dp(ete,n),{onValueNodeHasChildrenChange:c}=l,u=i!==void 0,d=In(t,l.onValueNodeChange);return si(()=>{c(u)},[c,u]),f.jsx(_i.span,{...o,ref:d,style:{pointerEvents:"none"},children:xte(l.value)?f.jsx(f.Fragment,{children:a}):i})});tte.displayName=ete;var lLe="SelectIcon",nte=E.forwardRef((e,t)=>{const{__scopeSelect:n,children:r,...s}=e;return f.jsx(_i.span,{"aria-hidden":!0,...s,ref:t,children:r||""})});nte.displayName=lLe;var cLe="SelectPortal",rte=e=>f.jsx(zee,{asChild:!0,...e});rte.displayName=cLe;var Pm="SelectContent",ste=E.forwardRef((e,t)=>{const n=dp(Pm,e.__scopeSelect),[r,s]=E.useState();if(si(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?dl.createPortal(f.jsx(ite,{scope:e.__scopeSelect,children:f.jsx(DT.Slot,{scope:e.__scopeSelect,children:f.jsx("div",{children:e.children})})}),i):null}return f.jsx(ate,{...e,ref:t})});ste.displayName=Pm;var yc=10,[ite,fp]=vb(Pm),uLe="SelectContentImpl",dLe=ju("SelectContent.RemoveScroll"),ate=E.forwardRef((e,t)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:a,side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:m,sticky:y,hideWhenDetached:b,avoidCollisions:v,...x}=e,w=dp(Pm,n),[S,k]=E.useState(null),[C,T]=E.useState(null),A=In(t,Fe=>k(Fe)),[N,I]=E.useState(null),[O,B]=E.useState(null),D=FT(n),[H,P]=E.useState(!1),K=E.useRef(!1);E.useEffect(()=>{if(S)return PT(S)},[S]),IT();const U=E.useCallback(Fe=>{const[Se,...Ce]=D().map(We=>We.ref.current),[qe]=Ce.slice(-1),Qe=document.activeElement;for(const We of Fe)if(We===Qe||(We==null||We.scrollIntoView({block:"nearest"}),We===Se&&C&&(C.scrollTop=0),We===qe&&C&&(C.scrollTop=C.scrollHeight),We==null||We.focus(),document.activeElement!==Qe))return},[D,C]),V=E.useCallback(()=>U([N,S]),[U,N,S]);E.useEffect(()=>{H&&V()},[H,V]);const{onOpenChange:L,triggerPointerDownPosRef:te}=w;E.useEffect(()=>{if(S){let Fe={x:0,y:0};const Se=qe=>{var Qe,We;Fe={x:Math.abs(Math.round(qe.pageX)-(((Qe=te.current)==null?void 0:Qe.x)??0)),y:Math.abs(Math.round(qe.pageY)-(((We=te.current)==null?void 0:We.y)??0))}},Ce=qe=>{Fe.x<=10&&Fe.y<=10?qe.preventDefault():S.contains(qe.target)||L(!1),document.removeEventListener("pointermove",Se),te.current=null};return te.current!==null&&(document.addEventListener("pointermove",Se),document.addEventListener("pointerup",Ce,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Se),document.removeEventListener("pointerup",Ce,{capture:!0})}}},[S,L,te]),E.useEffect(()=>{const Fe=()=>L(!1);return window.addEventListener("blur",Fe),window.addEventListener("resize",Fe),()=>{window.removeEventListener("blur",Fe),window.removeEventListener("resize",Fe)}},[L]);const[W,Q]=wte(Fe=>{const Se=D().filter(Qe=>!Qe.disabled),Ce=Se.find(Qe=>Qe.ref.current===document.activeElement),qe=_te(Se,Fe,Ce);qe&&setTimeout(()=>qe.ref.current.focus())}),ee=E.useCallback((Fe,Se,Ce)=>{const qe=!K.current&&!Ce;(w.value!==void 0&&w.value===Se||qe)&&(I(Fe),qe&&(K.current=!0))},[w.value]),re=E.useCallback(()=>S==null?void 0:S.focus(),[S]),pe=E.useCallback((Fe,Se,Ce)=>{const qe=!K.current&&!Ce;(w.value!==void 0&&w.value===Se||qe)&&B(Fe)},[w.value]),de=r==="popper"?k4:ote,Oe=de===k4?{side:o,sideOffset:l,align:c,alignOffset:u,arrowPadding:d,collisionBoundary:h,collisionPadding:m,sticky:y,hideWhenDetached:b,avoidCollisions:v}:{};return f.jsx(ite,{scope:n,content:S,viewport:C,onViewportChange:T,itemRefCallback:ee,selectedItem:N,onItemLeave:re,itemTextRefCallback:pe,focusSelectedItem:V,selectedItemText:O,position:r,isPositioned:H,searchRef:W,children:f.jsx(n_,{as:dLe,allowPinchZoom:!0,children:f.jsx(Aee,{asChild:!0,trapped:w.open,onMountAutoFocus:Fe=>{Fe.preventDefault()},onUnmountAutoFocus:Wt(s,Fe=>{var Se;(Se=w.trigger)==null||Se.focus({preventScroll:!0}),Fe.preventDefault()}),children:f.jsx(Eee,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:Fe=>Fe.preventDefault(),onDismiss:()=>w.onOpenChange(!1),children:f.jsx(de,{role:"listbox",id:w.contentId,"data-state":w.open?"open":"closed",dir:w.dir,onContextMenu:Fe=>Fe.preventDefault(),...x,...Oe,onPlaced:()=>P(!0),ref:A,style:{display:"flex",flexDirection:"column",outline:"none",...x.style},onKeyDown:Wt(x.onKeyDown,Fe=>{const Se=Fe.ctrlKey||Fe.altKey||Fe.metaKey;if(Fe.key==="Tab"&&Fe.preventDefault(),!Se&&Fe.key.length===1&&Q(Fe.key),["ArrowUp","ArrowDown","Home","End"].includes(Fe.key)){let qe=D().filter(Qe=>!Qe.disabled).map(Qe=>Qe.ref.current);if(["ArrowUp","End"].includes(Fe.key)&&(qe=qe.slice().reverse()),["ArrowUp","ArrowDown"].includes(Fe.key)){const Qe=Fe.target,We=qe.indexOf(Qe);qe=qe.slice(We+1)}setTimeout(()=>U(qe)),Fe.preventDefault()}})})})})})})});ate.displayName=uLe;var fLe="SelectItemAlignedPosition",ote=E.forwardRef((e,t)=>{const{__scopeSelect:n,onPlaced:r,...s}=e,i=dp(Pm,n),a=fp(Pm,n),[o,l]=E.useState(null),[c,u]=E.useState(null),d=In(t,A=>u(A)),h=FT(n),m=E.useRef(!1),y=E.useRef(!0),{viewport:b,selectedItem:v,selectedItemText:x,focusSelectedItem:w}=a,S=E.useCallback(()=>{if(i.trigger&&i.valueNode&&o&&c&&b&&v&&x){const A=i.trigger.getBoundingClientRect(),N=c.getBoundingClientRect(),I=i.valueNode.getBoundingClientRect(),O=x.getBoundingClientRect();if(i.dir!=="rtl"){const Qe=O.left-N.left,We=I.left-Qe,je=A.left-We,Y=A.width+je,ye=Math.max(Y,N.width),Ie=window.innerWidth-yc,ce=zw(We,[yc,Math.max(yc,Ie-ye)]);o.style.minWidth=Y+"px",o.style.left=ce+"px"}else{const Qe=N.right-O.right,We=window.innerWidth-I.right-Qe,je=window.innerWidth-A.right-We,Y=A.width+je,ye=Math.max(Y,N.width),Ie=window.innerWidth-yc,ce=zw(We,[yc,Math.max(yc,Ie-ye)]);o.style.minWidth=Y+"px",o.style.right=ce+"px"}const B=h(),D=window.innerHeight-yc*2,H=b.scrollHeight,P=window.getComputedStyle(c),K=parseInt(P.borderTopWidth,10),U=parseInt(P.paddingTop,10),V=parseInt(P.borderBottomWidth,10),L=parseInt(P.paddingBottom,10),te=K+U+H+L+V,W=Math.min(v.offsetHeight*5,te),Q=window.getComputedStyle(b),ee=parseInt(Q.paddingTop,10),re=parseInt(Q.paddingBottom,10),pe=A.top+A.height/2-yc,de=D-pe,Oe=v.offsetHeight/2,Fe=v.offsetTop+Oe,Se=K+U+Fe,Ce=te-Se;if(Se<=pe){const Qe=B.length>0&&v===B[B.length-1].ref.current;o.style.bottom="0px";const We=c.clientHeight-b.offsetTop-b.offsetHeight,je=Math.max(de,Oe+(Qe?re:0)+We+V),Y=Se+je;o.style.height=Y+"px"}else{const Qe=B.length>0&&v===B[0].ref.current;o.style.top="0px";const je=Math.max(pe,K+b.offsetTop+(Qe?ee:0)+Oe)+Ce;o.style.height=je+"px",b.scrollTop=Se-pe+b.offsetTop}o.style.margin=`${yc}px 0`,o.style.minHeight=W+"px",o.style.maxHeight=D+"px",r==null||r(),requestAnimationFrame(()=>m.current=!0)}},[h,i.trigger,i.valueNode,o,c,b,v,x,i.dir,r]);si(()=>S(),[S]);const[k,C]=E.useState();si(()=>{c&&C(window.getComputedStyle(c).zIndex)},[c]);const T=E.useCallback(A=>{A&&y.current===!0&&(S(),w==null||w(),y.current=!1)},[S,w]);return f.jsx(pLe,{scope:n,contentWrapper:o,shouldExpandOnScrollRef:m,onScrollButtonChange:T,children:f.jsx("div",{ref:l,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:k},children:f.jsx(_i.div,{...s,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});ote.displayName=fLe;var hLe="SelectPopperPosition",k4=E.forwardRef((e,t)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=yc,...i}=e,a=LT(n);return f.jsx(f8e,{...a,...i,ref:t,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});k4.displayName=hLe;var[pLe,NF]=vb(Pm,{}),E4="SelectViewport",lte=E.forwardRef((e,t)=>{const{__scopeSelect:n,nonce:r,...s}=e,i=fp(E4,n),a=NF(E4,n),o=In(t,i.onViewportChange),l=E.useRef(0);return f.jsxs(f.Fragment,{children:[f.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),f.jsx(DT.Slot,{scope:n,children:f.jsx(_i.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:Wt(s.onScroll,c=>{const u=c.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:h}=a;if(h!=null&&h.current&&d){const m=Math.abs(l.current-u.scrollTop);if(m>0){const y=window.innerHeight-yc*2,b=parseFloat(d.style.minHeight),v=parseFloat(d.style.height),x=Math.max(b,v);if(x<y){const w=x+m,S=Math.min(y,w),k=w-S;d.style.height=S+"px",d.style.bottom==="0px"&&(u.scrollTop=k>0?k:0,d.style.justifyContent="flex-end")}}}l.current=u.scrollTop})})})]})});lte.displayName=E4;var cte="SelectGroup",[mLe,gLe]=vb(cte),yLe=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=ca();return f.jsx(mLe,{scope:n,id:s,children:f.jsx(_i.div,{role:"group","aria-labelledby":s,...r,ref:t})})});yLe.displayName=cte;var ute="SelectLabel",bLe=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=gLe(ute,n);return f.jsx(_i.div,{id:s.id,...r,ref:t})});bLe.displayName=ute;var Rk="SelectItem",[vLe,dte]=vb(Rk),fte=E.forwardRef((e,t)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...a}=e,o=dp(Rk,n),l=fp(Rk,n),c=o.value===r,[u,d]=E.useState(i??""),[h,m]=E.useState(!1),y=In(t,w=>{var S;return(S=l.itemRefCallback)==null?void 0:S.call(l,w,r,s)}),b=ca(),v=E.useRef("touch"),x=()=>{s||(o.onValueChange(r),o.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return f.jsx(vLe,{scope:n,value:r,disabled:s,textId:b,isSelected:c,onItemTextChange:E.useCallback(w=>{d(S=>S||((w==null?void 0:w.textContent)??"").trim())},[]),children:f.jsx(DT.ItemSlot,{scope:n,value:r,disabled:s,textValue:u,children:f.jsx(_i.div,{role:"option","aria-labelledby":b,"data-highlighted":h?"":void 0,"aria-selected":c&&h,"data-state":c?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...a,ref:y,onFocus:Wt(a.onFocus,()=>m(!0)),onBlur:Wt(a.onBlur,()=>m(!1)),onClick:Wt(a.onClick,()=>{v.current!=="mouse"&&x()}),onPointerUp:Wt(a.onPointerUp,()=>{v.current==="mouse"&&x()}),onPointerDown:Wt(a.onPointerDown,w=>{v.current=w.pointerType}),onPointerMove:Wt(a.onPointerMove,w=>{var S;v.current=w.pointerType,s?(S=l.onItemLeave)==null||S.call(l):v.current==="mouse"&&w.currentTarget.focus({preventScroll:!0})}),onPointerLeave:Wt(a.onPointerLeave,w=>{var S;w.currentTarget===document.activeElement&&((S=l.onItemLeave)==null||S.call(l))}),onKeyDown:Wt(a.onKeyDown,w=>{var k;((k=l.searchRef)==null?void 0:k.current)!==""&&w.key===" "||(rLe.includes(w.key)&&x(),w.key===" "&&w.preventDefault())})})})})});fte.displayName=Rk;var hx="SelectItemText",hte=E.forwardRef((e,t)=>{const{__scopeSelect:n,className:r,style:s,...i}=e,a=dp(hx,n),o=fp(hx,n),l=dte(hx,n),c=oLe(hx,n),[u,d]=E.useState(null),h=In(t,x=>d(x),l.onItemTextChange,x=>{var w;return(w=o.itemTextRefCallback)==null?void 0:w.call(o,x,l.value,l.disabled)}),m=u==null?void 0:u.textContent,y=E.useMemo(()=>f.jsx("option",{value:l.value,disabled:l.disabled,children:m},l.value),[l.disabled,l.value,m]),{onNativeOptionAdd:b,onNativeOptionRemove:v}=c;return si(()=>(b(y),()=>v(y)),[b,v,y]),f.jsxs(f.Fragment,{children:[f.jsx(_i.span,{id:l.textId,...i,ref:h}),l.isSelected&&a.valueNode&&!a.valueNodeHasChildren?dl.createPortal(i.children,a.valueNode):null]})});hte.displayName=hx;var pte="SelectItemIndicator",mte=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return dte(pte,n).isSelected?f.jsx(_i.span,{"aria-hidden":!0,...r,ref:t}):null});mte.displayName=pte;var T4="SelectScrollUpButton",gte=E.forwardRef((e,t)=>{const n=fp(T4,e.__scopeSelect),r=NF(T4,e.__scopeSelect),[s,i]=E.useState(!1),a=In(t,r.onScrollButtonChange);return si(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollTop>0;i(c)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?f.jsx(bte,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop-l.offsetHeight)}}):null});gte.displayName=T4;var A4="SelectScrollDownButton",yte=E.forwardRef((e,t)=>{const n=fp(A4,e.__scopeSelect),r=NF(A4,e.__scopeSelect),[s,i]=E.useState(!1),a=In(t,r.onScrollButtonChange);return si(()=>{if(n.viewport&&n.isPositioned){let o=function(){const c=l.scrollHeight-l.clientHeight,u=Math.ceil(l.scrollTop)<c;i(u)};const l=n.viewport;return o(),l.addEventListener("scroll",o),()=>l.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?f.jsx(bte,{...e,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:l}=n;o&&l&&(o.scrollTop=o.scrollTop+l.offsetHeight)}}):null});yte.displayName=A4;var bte=E.forwardRef((e,t)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=e,i=fp("SelectScrollButton",n),a=E.useRef(null),o=FT(n),l=E.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return E.useEffect(()=>()=>l(),[l]),si(()=>{var u;const c=o().find(d=>d.ref.current===document.activeElement);(u=c==null?void 0:c.ref.current)==null||u.scrollIntoView({block:"nearest"})},[o]),f.jsx(_i.div,{"aria-hidden":!0,...s,ref:t,style:{flexShrink:0,...s.style},onPointerDown:Wt(s.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(r,50))}),onPointerMove:Wt(s.onPointerMove,()=>{var c;(c=i.onItemLeave)==null||c.call(i),a.current===null&&(a.current=window.setInterval(r,50))}),onPointerLeave:Wt(s.onPointerLeave,()=>{l()})})}),xLe="SelectSeparator",wLe=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e;return f.jsx(_i.div,{"aria-hidden":!0,...r,ref:t})});wLe.displayName=xLe;var R4="SelectArrow",_Le=E.forwardRef((e,t)=>{const{__scopeSelect:n,...r}=e,s=LT(n),i=dp(R4,n),a=fp(R4,n);return i.open&&a.position==="popper"?f.jsx(h8e,{...s,...r,ref:t}):null});_Le.displayName=R4;var SLe="SelectBubbleInput",vte=E.forwardRef(({__scopeSelect:e,value:t,...n},r)=>{const s=E.useRef(null),i=In(r,s),a=jT(t);return E.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLSelectElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("change",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),f.jsx(_i.select,{...n,style:{...Uee,...n.style},ref:i,defaultValue:t})});vte.displayName=SLe;function xte(e){return e===""||e===void 0}function wte(e){const t=Es(e),n=E.useRef(""),r=E.useRef(0),s=E.useCallback(a=>{const o=n.current+a;t(o),function l(c){n.current=c,window.clearTimeout(r.current),c!==""&&(r.current=window.setTimeout(()=>l(""),1e3))}(o)},[t]),i=E.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return E.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function _te(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=CLe(e,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.textValue.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function CLe(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var kLe=Xee,ELe=Qee,TLe=tte,ALe=nte,RLe=rte,NLe=ste,MLe=lte,ILe=fte,jLe=hte,PLe=mte,OLe=gte,DLe=yte;function lf({...e}){return f.jsx(kLe,{"data-slot":"select",...e})}function cf({...e}){return f.jsx(TLe,{"data-slot":"select-value",...e})}function uf({className:e,size:t="default",children:n,...r}){return f.jsxs(ELe,{"data-slot":"select-trigger","data-size":t,className:Ze("border-input data-[placeholder]:text-muted-foreground [&_svg:not([class*='text-'])]:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 dark:hover:bg-input/50 flex w-fit items-center justify-between gap-2 rounded-md border bg-transparent px-3 py-2 text-sm whitespace-nowrap shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 data-[size=default]:h-9 data-[size=sm]:h-8 *:data-[slot=select-value]:line-clamp-1 *:data-[slot=select-value]:flex *:data-[slot=select-value]:items-center *:data-[slot=select-value]:gap-2 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r,children:[n,f.jsx(ALe,{asChild:!0,children:f.jsx(Ql,{className:"size-4 opacity-50"})})]})}function df({className:e,children:t,position:n="popper",...r}){return f.jsx(RLe,{children:f.jsxs(NLe,{"data-slot":"select-content",className:Ze("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 relative z-50 max-h-(--radix-select-content-available-height) min-w-[8rem] origin-(--radix-select-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border shadow-md",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",e),position:n,...r,children:[f.jsx(FLe,{}),f.jsx(MLe,{className:Ze("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)] scroll-my-1"),children:t}),f.jsx(LLe,{})]})})}function Ba({className:e,children:t,...n}){return f.jsxs(ILe,{"data-slot":"select-item",className:Ze("focus:bg-accent focus:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex w-full cursor-default items-center gap-2 rounded-sm py-1.5 pr-8 pl-2 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4 *:[span]:last:flex *:[span]:last:items-center *:[span]:last:gap-2",e),...n,children:[f.jsx("span",{className:"absolute right-2 flex size-3.5 items-center justify-center",children:f.jsx(PLe,{children:f.jsx(co,{className:"size-4"})})}),f.jsx(jLe,{children:t})]})}function FLe({className:e,...t}){return f.jsx(OLe,{"data-slot":"select-scroll-up-button",className:Ze("flex cursor-default items-center justify-center py-1",e),...t,children:f.jsx(Xh,{className:"size-4"})})}function LLe({className:e,...t}){return f.jsx(DLe,{"data-slot":"select-scroll-down-button",className:Ze("flex cursor-default items-center justify-center py-1",e),...t,children:f.jsx(Ql,{className:"size-4"})})}var BLe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],$Le=BLe.reduce((e,t)=>{const n=ju(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),zLe="Label",Ste=E.forwardRef((e,t)=>f.jsx($Le.label,{...e,ref:t,onMouseDown:n=>{var s;n.target.closest("button, input, select, textarea")||((s=e.onMouseDown)==null||s.call(e,n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));Ste.displayName=zLe;var ULe=Ste;function jt({className:e,...t}){return f.jsx(ULe,{"data-slot":"label",className:Ze("flex items-center gap-2 text-sm leading-none font-medium select-none group-data-[disabled=true]:pointer-events-none group-data-[disabled=true]:opacity-50 peer-disabled:cursor-not-allowed peer-disabled:opacity-50",e),...t})}const ji=({field:e,className:t})=>e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:`text-xs text-destructive mt-1 block ${t||""}`,children:e.state.meta.errors.map(r=>typeof r=="string"?r:typeof r=="object"&&r!==null&&"message"in r&&typeof r.message=="string"?r.message:(console.warn("[GlobalFieldMetaMessages] Encountered an unexpected error structure:",r),"Validation error")).join(", ")}):null,qLe=Ao.map(e=>e.value),pC=Ke({keyName:$e().min(1,"Key Name is required."),providerType:vl(qLe,{errorMap:()=>({message:"Provider Type is required."})}),keyValue:$e().min(1,"API Key Value is required.")}),Cte=({initialProviderType:e=null,initialName:t="",initialValue:n="",onSave:r,onCancel:s,disabled:i=!1,className:a})=>{const o=E.useRef(null),l=ii({defaultValues:{keyName:t,providerType:e,keyValue:n},validators:{onChangeAsync:pC,onChangeAsyncDebounceMs:500},onSubmit:async({value:u})=>{await r(u.keyName,u.providerType,u.keyValue)}});E.useEffect(()=>{l.reset({keyName:t,providerType:e,keyValue:n})},[t,n,e,l]);const c=(u,d)=>{var b,v;if(!u)return;const h=(b=Ao.find(x=>x.value===u))==null?void 0:b.label,m=l.getFieldValue("providerType"),y=(v=Ao.find(x=>x.value===m))==null?void 0:v.label;h&&(!(d!=null&&d.trim())||d===y)&&l.setFieldValue("keyName",h),requestAnimationFrame(()=>{var x;(x=o.current)==null||x.focus()})};return f.jsxs("form",{onSubmit:u=>{u.preventDefault(),u.stopPropagation(),l.handleSubmit()},className:Ze("space-y-6",a),children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(l.Field,{name:"providerType",validators:{onChange:pC.shape.providerType},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:u.name,children:"Provider Type"}),f.jsxs(lf,{value:u.state.value??"",onValueChange:d=>{const h=d;u.handleChange(h),u.handleBlur(),c(h,l.getFieldValue("keyName"))},disabled:i||l.state.isSubmitting,children:[f.jsx(uf,{id:u.name,children:f.jsx(cf,{placeholder:"Select Provider Type"})}),f.jsx(df,{children:Ao.map(d=>f.jsx(Ba,{value:d.value,children:d.label},d.value))})]}),f.jsx(ji,{field:u})]})}),f.jsx(l.Field,{name:"keyName",validators:{onChange:pC.shape.keyName},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:u.name,children:"Key Name"}),f.jsx(xn,{id:u.name,value:u.state.value??"",onChange:d=>u.handleChange(d.target.value),onBlur:u.handleBlur,placeholder:"e.g., My OpenAI Key",disabled:i||l.state.isSubmitting}),f.jsx(ji,{field:u})]})}),f.jsx(l.Field,{name:"keyValue",validators:{onChange:pC.shape.keyValue},children:u=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:u.name,children:"API Key Value"}),f.jsx(xn,{ref:o,id:u.name,type:"password",value:u.state.value??"",onChange:d=>u.handleChange(d.target.value),onBlur:u.handleBlur,placeholder:"Enter your API key",disabled:i||l.state.isSubmitting,autoComplete:"new-password"}),f.jsx(ji,{field:u})]})})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(ct,{variant:"ghost",size:"sm",onClick:s,disabled:i||l.state.isSubmitting,type:"button",children:[f.jsx(Pi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(l.Subscribe,{selector:u=>[u.canSubmit,u.isSubmitting,u.isValidating,u.isValid],children:([u,d,h,m])=>f.jsxs(ct,{type:"submit",size:"sm",disabled:i||!u||d||h||!m,children:[(d||h)&&f.jsx(Jn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Uu,{className:"h-4 w-4 mr-1"}),d||h?"Saving...":"Save API Key"]})})]})]})},VLe=({className:e,label:t,selectedKeyId:n,onKeySelected:r,apiKeys:s,disabled:i=!1})=>{var c;const a=u=>{r(u==="none"?null:u)},o=(c=s.find(u=>u.id===n))==null?void 0:c.name,l=n?o||`Key ID: ${n.substring(0,6)}...`:"None";return f.jsxs(lf,{value:n??"none",onValueChange:a,disabled:i||s.length===0,children:[f.jsx(uf,{className:Ze("w-full h-9 text-sm bg-background border-border text-foreground",e),"aria-label":t||"Select API Key",children:f.jsx(cf,{asChild:!0,children:f.jsxs("div",{className:"flex items-center overflow-hidden",children:[f.jsx(Zx,{className:"h-3 w-3 mr-1.5 text-muted-foreground flex-shrink-0"}),f.jsxs("span",{className:"truncate flex-grow text-left",children:[t&&f.jsxs("span",{className:"mr-1",children:[t,":"]}),s.length===0?f.jsx("span",{className:"text-muted-foreground",children:"No keys available"}):l]})]})})}),f.jsxs(df,{className:"bg-popover border-border text-popover-foreground",children:[f.jsx(Ba,{value:"none",children:f.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(u=>f.jsx(Ba,{value:u.id,children:u.name||`Key ID: ${u.id.substring(0,6)}...`},u.id))]})]})};function Zw({form:e,name:t,label:n,type:r="text",placeholder:s,disabled:i,wrapperClassName:a,className:o,...l}){return f.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="string"||typeof c.state.value=="number"?String(c.state.value):"";return f.jsxs("div",{className:Ze("space-y-1.5",a),children:[f.jsx(jt,{htmlFor:c.name,className:"text-sm",children:n}),f.jsx(xn,{id:c.name,name:c.name,type:r,value:u,onBlur:c.handleBlur,onChange:d=>c.handleChange(d.target.value),placeholder:s,disabled:i??c.form.state.isSubmitting,className:Ze(o,c.state.meta.errors.length?"border-destructive":""),...l}),f.jsx(ji,{field:c})]})}})}function Lx({form:e,name:t,label:n,options:r,placeholder:s,disabled:i,wrapperClassName:a,triggerClassName:o,contentClassName:l,...c}){return f.jsx(e.Field,{name:t,children:u=>{const d=u.state.value!==null&&u.state.value!==void 0?String(u.state.value):"";return f.jsxs("div",{className:Ze("space-y-1.5",a),children:[f.jsx(jt,{htmlFor:u.name,className:"text-sm",children:n}),f.jsxs(lf,{value:d,onValueChange:h=>u.handleChange(h),disabled:i??u.form.state.isSubmitting,...c,children:[f.jsx(uf,{id:u.name,onBlur:u.handleBlur,className:Ze(o,u.state.meta.errors.length?"border-destructive":""),children:f.jsx(cf,{placeholder:s})}),f.jsx(df,{className:l,children:r.map(h=>f.jsx(Ba,{value:String(h.value),disabled:h.disabled,children:h.label},h.value))})]}),f.jsx(ji,{field:u})]})}})}var WLe=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],kte=WLe.reduce((e,t)=>{const n=ju(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),BT="Switch",[HLe,Ldt]=Yi(BT),[GLe,KLe]=HLe(BT),Ete=E.forwardRef((e,t)=>{const{__scopeSwitch:n,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l="on",onCheckedChange:c,form:u,...d}=e,[h,m]=E.useState(null),y=In(t,S=>m(S)),b=E.useRef(!1),v=h?u||!!h.closest("form"):!0,[x,w]=Lc({prop:s,defaultProp:i??!1,onChange:c,caller:BT});return f.jsxs(GLe,{scope:n,checked:x,disabled:o,children:[f.jsx(kte.button,{type:"button",role:"switch","aria-checked":x,"aria-required":a,"data-state":Nte(x),"data-disabled":o?"":void 0,disabled:o,value:l,...d,ref:y,onClick:Wt(e.onClick,S=>{w(k=>!k),v&&(b.current=S.isPropagationStopped(),b.current||S.stopPropagation())})}),v&&f.jsx(Rte,{control:h,bubbles:!b.current,name:r,value:l,checked:x,required:a,disabled:o,form:u,style:{transform:"translateX(-100%)"}})]})});Ete.displayName=BT;var Tte="SwitchThumb",Ate=E.forwardRef((e,t)=>{const{__scopeSwitch:n,...r}=e,s=KLe(Tte,n);return f.jsx(kte.span,{"data-state":Nte(s.checked),"data-disabled":s.disabled?"":void 0,...r,ref:t})});Ate.displayName=Tte;var YLe="SwitchBubbleInput",Rte=E.forwardRef(({__scopeSwitch:e,control:t,checked:n,bubbles:r=!0,...s},i)=>{const a=E.useRef(null),o=In(a,i),l=jT(n),c=Jy(t);return E.useEffect(()=>{const u=a.current;if(!u)return;const d=window.HTMLInputElement.prototype,m=Object.getOwnPropertyDescriptor(d,"checked").set;if(l!==n&&m){const y=new Event("click",{bubbles:r});m.call(u,n),u.dispatchEvent(y)}},[l,n,r]),f.jsx("input",{type:"checkbox","aria-hidden":!0,defaultChecked:n,...s,tabIndex:-1,ref:o,style:{...s.style,...c,position:"absolute",pointerEvents:"none",opacity:0,margin:0}})});Rte.displayName=YLe;function Nte(e){return e?"checked":"unchecked"}var ZLe=Ete,XLe=Ate;function oo({className:e,...t}){return f.jsx(ZLe,{"data-slot":"switch",className:Ze("peer data-[state=checked]:bg-primary data-[state=unchecked]:bg-input focus-visible:border-ring focus-visible:ring-ring/50 dark:data-[state=unchecked]:bg-input/80 inline-flex h-[1.15rem] w-8 shrink-0 items-center rounded-full border border-transparent shadow-xs transition-all outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:f.jsx(XLe,{"data-slot":"switch-thumb",className:Ze("bg-background dark:data-[state=unchecked]:bg-foreground dark:data-[state=checked]:bg-primary-foreground pointer-events-none block size-4 rounded-full ring-0 transition-transform data-[state=checked]:translate-x-[calc(100%-2px)] data-[state=unchecked]:translate-x-0")})})}function sm({form:e,name:t,label:n,description:r,disabled:s,wrapperClassName:i,className:a,labelClassName:o,...l}){return f.jsx(e.Field,{name:t,children:c=>{const u=typeof c.state.value=="boolean"?c.state.value:!1;return f.jsxs("div",{className:Ze("space-y-1.5",i),children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(jt,{htmlFor:c.name,className:Ze("text-sm font-medium leading-none cursor-pointer",o),children:n}),f.jsx(oo,{id:c.name,name:c.name,checked:u,onCheckedChange:d=>c.handleChange(d),onBlur:c.handleBlur,disabled:s??c.form.state.isSubmitting,className:Ze(a,c.state.meta.errors.length?"border-destructive":""),...l})]}),r&&f.jsx("p",{className:"text-xs text-muted-foreground pt-1",children:r}),f.jsx(ji,{field:c})]})}})}const JLe=Ao.map(e=>e.value),QLe=Ke({name:$e().min(1,"Provider Name is required."),type:vl(JLe,{errorMap:()=>({message:"Provider Type is required."})}),isEnabled:Zn(),apiKeyId:$e().nullable(),baseURL:$e().url().nullable().or(Mn("")),autoFetchModels:Zn()}).refine(e=>z2(e.type)?!(!e.baseURL||e.baseURL.trim()===""):!0,{message:"Base URL is required and must be a valid URL for this provider type.",path:["baseURL"]}).refine(e=>ly(e.type)?!!e.apiKeyId:!0,{message:"API Key is required for this provider type.",path:["apiKeyId"]}),eBe=Ao.map(e=>({value:e.value,label:e.label})),Mte=({initialData:e,onSubmit:t,onChange:n,onCancel:r,apiKeys:s,isSavingExt:i=!1,disabled:a=!1,className:o})=>{var v;const l=ii({defaultValues:{name:(e==null?void 0:e.name)||"",type:(e==null?void 0:e.type)||((v=Ao[0])==null?void 0:v.value),isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??!1},validators:{onChangeAsync:QLe,onChangeAsyncDebounceMs:500},onSubmit:async({value:x})=>{const w={...x,baseURL:(x.baseURL===null||typeof x.baseURL=="string"&&x.baseURL.trim()==="")&&!z2(x.type)?null:x.baseURL};await t(w)}}),c=E.useRef(l.state.values);E.useEffect(()=>{const x=l.store.subscribe(()=>{const w=l.state.values,S=c.current;if(n&&S)for(const k in w){const C=k;w[C]!==S[C]&&n(C,w[C])}c.current={...w}});return l.state.values!==c.current&&(c.current=l.state.values),x},[l,n]),E.useEffect(()=>{var S,k;const x=(e==null?void 0:e.type)||((S=Ao[0])==null?void 0:S.value),w={name:(e==null?void 0:e.name)||((k=Ao.find(C=>C.value===x))==null?void 0:k.label)||"",type:x,isEnabled:(e==null?void 0:e.isEnabled)??!0,apiKeyId:(e==null?void 0:e.apiKeyId)||null,baseURL:(e==null?void 0:e.baseURL)||null,autoFetchModels:(e==null?void 0:e.autoFetchModels)??ym(x)};l.reset(w),c.current=w},[e]);const u=l.state.values.type,d=ly(u??null),h=z2(u??null),m=ym(u??null),y=E.useCallback(x=>{var S,k;if(!x)return;const w=l.state.values.type;if(x!==w){l.setFieldValue("apiKeyId",null),l.setFieldValue("baseURL",null),l.setFieldValue("autoFetchModels",ym(x));const C=(S=Ao.find(N=>N.value===x))==null?void 0:S.label,T=(k=Ao.find(N=>N.value===w))==null?void 0:k.label,A=l.state.values.name;C&&(!(A!=null&&A.trim())||A===T)&&l.setFieldValue("name",C)}},[l]);E.useEffect(()=>{const x=l.state.values.type;x!==void 0&&y(x)},[l.state.values.type,y]);const b=(s||[]).filter(x=>!u||x.providerId===u);return f.jsxs("form",{onSubmit:x=>{x.preventDefault(),x.stopPropagation(),l.handleSubmit()},className:Ze("space-y-4 border rounded-md p-4 bg-card shadow-sm",o),children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-3",children:[f.jsx(Lx,{form:l,name:"type",label:"Provider Type",options:eBe,disabled:a||i,placeholder:"Select Type",wrapperClassName:"md:col-span-1"}),f.jsx(Zw,{form:l,name:"name",label:"Provider Name",placeholder:"e.g., My Ollama",disabled:a||i,"aria-label":"Provider Name",wrapperClassName:"md:col-span-1"}),d&&f.jsx(l.Field,{name:"apiKeyId",children:x=>f.jsxs("div",{className:"space-y-1.5 md:col-span-2",children:[f.jsx(jt,{htmlFor:`${x.name}-trigger`,children:"API Key"})," ",f.jsx(VLe,{selectedKeyId:x.state.value??null,onKeySelected:w=>{x.handleChange(w),x.handleBlur()},apiKeys:b,disabled:a||i||!u}),f.jsx(ji,{field:x})]})}),h&&f.jsx(Zw,{form:l,name:"baseURL",label:"Base URL",placeholder:"e.g., http://localhost:11434",type:"url",disabled:a||i||!u,wrapperClassName:"md:col-span-2"}),m&&f.jsx(sm,{form:l,name:"autoFetchModels",label:"Auto-Fetch Models",description:"Automatically fetch and update the list of available models from this provider.",disabled:a||i||!u,wrapperClassName:"md:col-span-2"}),f.jsx(sm,{form:l,name:"isEnabled",label:"Enable Provider",description:"Allow this provider to be used for generating responses.",disabled:a||i,wrapperClassName:"md:col-span-2"})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(ct,{variant:"ghost",size:"sm",onClick:r,disabled:a||i,type:"button",children:[f.jsx(Pi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(l.Subscribe,{selector:x=>[x.canSubmit,x.isSubmitting,x.isValidating,x.isValid],children:([x,w,S,k])=>f.jsxs(ct,{type:"submit",size:"sm",disabled:a||i||!x||w||!k||S,children:[(i||w||S)&&f.jsx(Jn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Uu,{className:"h-4 w-4 mr-1"})," ",i||w||S?"Saving...":e!=null&&e.name?"Save Changes":"Add Provider"]})})]})]})},Ite=({apiKeys:e,onAddProvider:t,onCancel:n,initialType:r="openai",initialName:s="",initialApiKeyId:i=null})=>{const[a,o]=E.useState(!1),[l,c]=E.useState({name:s,type:r,isEnabled:!0,apiKeyId:i,baseURL:null,autoFetchModels:ym(r)});E.useEffect(()=>{c(h=>({...h,name:s||h.name||"",type:r||h.type||null,apiKeyId:i||h.apiKeyId||null,autoFetchModels:!1}))},[s,r,i]);const u=E.useCallback((h,m)=>new Promise(y=>{c(b=>{var w,S;const v={...b,[h]:m},x=b.name||"";if(h==="type"){const k=m,C=(w=Ao.find(A=>A.value===b.type))==null?void 0:w.label;v.apiKeyId=null,v.baseURL=null,v.autoFetchModels=k?ym(k):!1;const T=(S=Ao.find(A=>A.value===k))==null?void 0:S.label;if(T&&(!x.trim()||x===C)&&(v.name=T),k&&ly(k)){const A=(e||[]).filter(N=>N.providerId===k);A.length>0&&(v.apiKeyId=A[0].id)}}return v}),y(void 0)}),[e]),d=E.useCallback(async()=>{var h,m;if(!((h=l.name)!=null&&h.trim())||!l.type){Te.error("Provider Name and Type are required.");return}o(!0);try{const y=l.type,b=l.autoFetchModels??ym(y),v={name:l.name.trim(),type:y,isEnabled:l.isEnabled??!0,apiKeyId:l.apiKeyId??null,baseURL:((m=l.baseURL)==null?void 0:m.trim())||null,enabledModels:null,autoFetchModels:b,fetchedModels:null,modelsLastFetchedAt:null};await t(v),n()}catch(y){console.error("Failed to add provider (from form component):",y)}finally{o(!1)}},[l,t,n]);return f.jsxs("div",{className:"border border-primary rounded-md p-4 space-y-3 bg-card shadow-lg flex-shrink-0",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Provider"}),f.jsx(Mte,{initialData:l,onSubmit:d,onCancel:n,onChange:u,apiKeys:e,disabled:a})]})},Nd=Ve.forwardRef(({className:e,href:t,children:n,...r},s)=>f.jsx("a",{ref:s,href:t,target:"_blank",rel:"noopener noreferrer",className:Ze("font-medium text-primary underline-offset-4 hover:underline focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",e),...r,children:n}));Nd.displayName="Lnk";const tBe=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),f.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",fill:"none",stroke:n,strokeWidth:"4"}),f.jsx("circle",{cx:"12",cy:"12",r:"3",fill:"none",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})})]})},nBe=UP("inline-flex items-center justify-center rounded-md border px-2 py-0.5 text-xs font-medium w-fit whitespace-nowrap shrink-0 [&>svg]:size-3 gap-1 [&>svg]:pointer-events-none focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:ring-[3px] aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive transition-[color,box-shadow] overflow-hidden",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground [a&]:hover:bg-primary/90",secondary:"border-transparent bg-secondary text-secondary-foreground [a&]:hover:bg-secondary/90",destructive:"border-transparent bg-destructive text-white [a&]:hover:bg-destructive/90 focus-visible:ring-destructive/20 dark:focus-visible:ring-destructive/40 dark:bg-destructive/60",outline:"text-foreground [a&]:hover:bg-accent [a&]:hover:text-accent-foreground"}},defaultVariants:{variant:"default"}});function as({className:e,variant:t,asChild:n=!1,...r}){const s=n?aH:"span";return f.jsx(s,{"data-slot":"badge",className:Ze(nBe({variant:t}),e),...r})}const rBe=()=>{const[e,t]=E.useState(!1);E.useEffect(()=>{t(!0)},[]);const n={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.2,delayChildren:.3}}},r={hidden:{opacity:0,y:20},show:{opacity:1,y:0,transition:{duration:.5}}},s=[{word:"LiteChat",color:"bg-gradient-to-tr from-lime-500 via-amber-400 to-red-600 bg-clip-text text-transparent"},{word:"library",color:"text-emerald-500"},{word:"browser",color:"text-violet-500"},{word:"local",color:"text-amber-500"},{word:"remote",color:"text-sky-500"},{word:"providers",color:"text-purple-500"},{word:" AI ",color:"bg-gradient-to-b from-amber-300 to-rose-700 bg-clip-text text-transparent"},{word:"Open Source",color:"bg-gradient-to-r from-lime-500 to-yellow-500 bg-clip-text text-transparent"}],i=o=>{let l=[o];return s.forEach(({word:c,color:u})=>{l=l.reduce((d,h)=>typeof h!="string"?(d.push(h),d):(h.split(new RegExp(`(${c})`,"gi")).forEach((y,b)=>{y.toLowerCase()===c.toLowerCase()?d.push(f.jsx("span",{className:`${u} font-medium`,children:y},`${y}-${b}`)):d.push(y)}),d),[])}),l=l.reduce((c,u,d)=>{if(typeof u!="string")return c.push(u),c;const h=/(\([^)]*\))/g;return u.split(h).forEach((y,b)=>{h.test(y)?c.push(f.jsx("span",{className:"text-sm text-muted",children:y},`paren-${d}-${b}`)):c.push(y)}),c},[]),l},a=["Oh, hey?! Hi there!! How are you doing!?","Nice of you to pop by to checkout LiteChat!","What'd you mean you don't know what LiteChat is? Oh Boy hey, you in for a treat!","To start with, it's an(other) AI chat app (yes...shocker, right ?) and it's Open Source ! ","But, it is also an extensible library, so you can go on and create your own, AI chat app! With your own functionnalities !","(are AI chat apps the new JS frameworks?)","And cause I might be a wee bit on the reluctant side when it comes to parting with my coins, it doesn't require no servers! It all stays in your browser.","(that means I couldn't snoop on what you do here, even if I wanted to!)","While able to run LLM both local (did I tell you I ain't liking throwing coins out?) and from remote providers","(but sometimes you have to :(..)","To cap things off, there is no fancy/crazy tech involved, I just glued bricks together with AI","(kids call it vibing apparently ^^)","Enough of this interminable babble! Go setup your future chat to prompt your brains out!"];return f.jsxs(gu.div,{className:"text-center max-w-4xl mx-auto space-y-3 my-6",initial:"hidden",animate:e?"show":"hidden",variants:n,children:[f.jsx("div",{className:"flex justify-center mb-4",children:f.jsxs(as,{variant:"outline",className:"px-3 py-1 bg-black/5 dark:bg-white/10 backdrop-blur-sm border-none",children:[f.jsx(RH,{className:"w-4 h-4 mr-2 text-yellow-500"}),f.jsx("span",{className:"text-sm",children:"Welcome to your future AI chat"})]})}),a.map((o,l)=>f.jsx(gu.p,{className:`text-sm md:text-base ${l===0?"font-medium":""} leading-relaxed`,variants:r,children:i(o)},l)),f.jsxs(gu.div,{variants:r,className:"pt-2",children:[f.jsx(as,{className:"bg-gradient-to-r from-violet-600 to-primary border-none",children:"No server required!"}),f.jsx(as,{className:"ml-2 bg-gradient-to-r from-amber-500 to-emerald-500 border-none",children:"100% in-browser"})]})]})};var MF="Progress",IF=100,[sBe,Bdt]=Yi(MF),[iBe,aBe]=sBe(MF),jte=E.forwardRef((e,t)=>{const{__scopeProgress:n,value:r=null,max:s,getValueLabel:i=oBe,...a}=e;(s||s===0)&&!iq(s)&&console.error(lBe(`${s}`,"Progress"));const o=iq(s)?s:IF;r!==null&&!aq(r,o)&&console.error(cBe(`${r}`,"Progress"));const l=aq(r,o)?r:null,c=Nk(l)?i(l,o):void 0;return f.jsx(iBe,{scope:n,value:l,max:o,children:f.jsx(cr.div,{"aria-valuemax":o,"aria-valuemin":0,"aria-valuenow":Nk(l)?l:void 0,"aria-valuetext":c,role:"progressbar","data-state":Dte(l,o),"data-value":l??void 0,"data-max":o,...a,ref:t})})});jte.displayName=MF;var Pte="ProgressIndicator",Ote=E.forwardRef((e,t)=>{const{__scopeProgress:n,...r}=e,s=aBe(Pte,n);return f.jsx(cr.div,{"data-state":Dte(s.value,s.max),"data-value":s.value??void 0,"data-max":s.max,...r,ref:t})});Ote.displayName=Pte;function oBe(e,t){return`${Math.round(e/t*100)}%`}function Dte(e,t){return e==null?"indeterminate":e===t?"complete":"loading"}function Nk(e){return typeof e=="number"}function iq(e){return Nk(e)&&!isNaN(e)&&e>0}function aq(e,t){return Nk(e)&&!isNaN(e)&&e<=t&&e>=0}function lBe(e,t){return`Invalid prop \`max\` of value \`${e}\` supplied to \`${t}\`. Only numbers greater than 0 are valid max values. Defaulting to \`${IF}\`.`}function cBe(e,t){return`Invalid prop \`value\` of value \`${e}\` supplied to \`${t}\`. The \`value\` prop must be:
  - a positive number
  - less than the value passed to \`max\` (or ${IF} if no \`max\` prop is set)
  - \`null\` or \`undefined\` if the progress is indeterminate.

Defaulting to \`null\`.`}var Fte=jte,uBe=Ote;const Ry=E.forwardRef(({className:e,value:t,...n},r)=>f.jsx(Fte,{ref:r,className:Ze("relative h-4 w-full overflow-hidden rounded-full bg-secondary",e),...n,children:f.jsx(uBe,{className:"h-full w-full flex-1 bg-primary transition-all",style:{transform:`translateX(-${100-(t||0)}%)`}})}));Ry.displayName=Fte.displayName;function u0(e,t,n){let r=n.initialDeps??[],s;function i(){var a,o,l,c;let u;n.key&&((a=n.debug)!=null&&a.call(n))&&(u=Date.now());const d=e();if(!(d.length!==r.length||d.some((y,b)=>r[b]!==y)))return s;r=d;let m;if(n.key&&((o=n.debug)!=null&&o.call(n))&&(m=Date.now()),s=t(...d),n.key&&((l=n.debug)!=null&&l.call(n))){const y=Math.round((Date.now()-u)*100)/100,b=Math.round((Date.now()-m)*100)/100,v=b/16,x=(w,S)=>{for(w=String(w);w.length<S;)w=" "+w;return w};console.info(`%c ${x(b,5)} /${x(y,5)} ms`,`
            font-size: .6rem;
            font-weight: bold;
            color: hsl(${Math.max(0,Math.min(120-120*v,120))}deg 100% 31%);`,n==null?void 0:n.key)}return(c=n==null?void 0:n.onChange)==null||c.call(n,s),s}return i.updateDeps=a=>{r=a},i}function a3(e,t){if(e===void 0)throw new Error("Unexpected undefined");return e}const dBe=(e,t)=>Math.abs(e-t)<=1,fBe=(e,t,n)=>{let r;return function(...s){e.clearTimeout(r),r=e.setTimeout(()=>t.apply(this,s),n)}},oq=e=>{const{offsetWidth:t,offsetHeight:n}=e;return{width:t,height:n}},hBe=e=>e,pBe=e=>{const t=Math.max(e.startIndex-e.overscan,0),n=Math.min(e.endIndex+e.overscan,e.count-1),r=[];for(let s=t;s<=n;s++)r.push(s);return r},mBe=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;const s=a=>{const{width:o,height:l}=a;t({width:Math.round(o),height:Math.round(l)})};if(s(oq(n)),!r.ResizeObserver)return()=>{};const i=new r.ResizeObserver(a=>{const o=()=>{const l=a[0];if(l!=null&&l.borderBoxSize){const c=l.borderBoxSize[0];if(c){s({width:c.inlineSize,height:c.blockSize});return}}s(oq(n))};e.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(o):o()});return i.observe(n,{box:"border-box"}),()=>{i.unobserve(n)}},lq={passive:!0},cq=typeof window>"u"?!0:"onscrollend"in window,gBe=(e,t)=>{const n=e.scrollElement;if(!n)return;const r=e.targetWindow;if(!r)return;let s=0;const i=e.options.useScrollendEvent&&cq?()=>{}:fBe(r,()=>{t(s,!1)},e.options.isScrollingResetDelay),a=u=>()=>{const{horizontal:d,isRtl:h}=e.options;s=d?n.scrollLeft*(h&&-1||1):n.scrollTop,i(),t(s,u)},o=a(!0),l=a(!1);l(),n.addEventListener("scroll",o,lq);const c=e.options.useScrollendEvent&&cq;return c&&n.addEventListener("scrollend",l,lq),()=>{n.removeEventListener("scroll",o),c&&n.removeEventListener("scrollend",l)}},yBe=(e,t,n)=>{if(t!=null&&t.borderBoxSize){const r=t.borderBoxSize[0];if(r)return Math.round(r[n.options.horizontal?"inlineSize":"blockSize"])}return e[n.options.horizontal?"offsetWidth":"offsetHeight"]},bBe=(e,{adjustments:t=0,behavior:n},r)=>{var s,i;const a=e+t;(i=(s=r.scrollElement)==null?void 0:s.scrollTo)==null||i.call(s,{[r.options.horizontal?"left":"top"]:a,behavior:n})};class vBe{constructor(t){this.unsubs=[],this.scrollElement=null,this.targetWindow=null,this.isScrolling=!1,this.scrollToIndexTimeoutId=null,this.measurementsCache=[],this.itemSizeCache=new Map,this.pendingMeasuredCacheIndexes=[],this.scrollRect=null,this.scrollOffset=null,this.scrollDirection=null,this.scrollAdjustments=0,this.elementsCache=new Map,this.observer=(()=>{let n=null;const r=()=>n||(!this.targetWindow||!this.targetWindow.ResizeObserver?null:n=new this.targetWindow.ResizeObserver(s=>{s.forEach(i=>{const a=()=>{this._measureElement(i.target,i)};this.options.useAnimationFrameWithResizeObserver?requestAnimationFrame(a):a()})}));return{disconnect:()=>{var s;(s=r())==null||s.disconnect(),n=null},observe:s=>{var i;return(i=r())==null?void 0:i.observe(s,{box:"border-box"})},unobserve:s=>{var i;return(i=r())==null?void 0:i.unobserve(s)}}})(),this.range=null,this.setOptions=n=>{Object.entries(n).forEach(([r,s])=>{typeof s>"u"&&delete n[r]}),this.options={debug:!1,initialOffset:0,overscan:1,paddingStart:0,paddingEnd:0,scrollPaddingStart:0,scrollPaddingEnd:0,horizontal:!1,getItemKey:hBe,rangeExtractor:pBe,onChange:()=>{},measureElement:yBe,initialRect:{width:0,height:0},scrollMargin:0,gap:0,indexAttribute:"data-index",initialMeasurementsCache:[],lanes:1,isScrollingResetDelay:150,enabled:!0,isRtl:!1,useScrollendEvent:!1,useAnimationFrameWithResizeObserver:!1,...n}},this.notify=n=>{var r,s;(s=(r=this.options).onChange)==null||s.call(r,this,n)},this.maybeNotify=u0(()=>(this.calculateRange(),[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]),n=>{this.notify(n)},{key:!1,debug:()=>this.options.debug,initialDeps:[this.isScrolling,this.range?this.range.startIndex:null,this.range?this.range.endIndex:null]}),this.cleanup=()=>{this.unsubs.filter(Boolean).forEach(n=>n()),this.unsubs=[],this.observer.disconnect(),this.scrollElement=null,this.targetWindow=null},this._didMount=()=>()=>{this.cleanup()},this._willUpdate=()=>{var n;const r=this.options.enabled?this.options.getScrollElement():null;if(this.scrollElement!==r){if(this.cleanup(),!r){this.maybeNotify();return}this.scrollElement=r,this.scrollElement&&"ownerDocument"in this.scrollElement?this.targetWindow=this.scrollElement.ownerDocument.defaultView:this.targetWindow=((n=this.scrollElement)==null?void 0:n.window)??null,this.elementsCache.forEach(s=>{this.observer.observe(s)}),this._scrollToOffset(this.getScrollOffset(),{adjustments:void 0,behavior:void 0}),this.unsubs.push(this.options.observeElementRect(this,s=>{this.scrollRect=s,this.maybeNotify()})),this.unsubs.push(this.options.observeElementOffset(this,(s,i)=>{this.scrollAdjustments=0,this.scrollDirection=i?this.getScrollOffset()<s?"forward":"backward":null,this.scrollOffset=s,this.isScrolling=i,this.maybeNotify()}))}},this.getSize=()=>this.options.enabled?(this.scrollRect=this.scrollRect??this.options.initialRect,this.scrollRect[this.options.horizontal?"width":"height"]):(this.scrollRect=null,0),this.getScrollOffset=()=>this.options.enabled?(this.scrollOffset=this.scrollOffset??(typeof this.options.initialOffset=="function"?this.options.initialOffset():this.options.initialOffset),this.scrollOffset):(this.scrollOffset=null,0),this.getFurthestMeasurement=(n,r)=>{const s=new Map,i=new Map;for(let a=r-1;a>=0;a--){const o=n[a];if(s.has(o.lane))continue;const l=i.get(o.lane);if(l==null||o.end>l.end?i.set(o.lane,o):o.end<l.end&&s.set(o.lane,!0),s.size===this.options.lanes)break}return i.size===this.options.lanes?Array.from(i.values()).sort((a,o)=>a.end===o.end?a.index-o.index:a.end-o.end)[0]:void 0},this.getMeasurementOptions=u0(()=>[this.options.count,this.options.paddingStart,this.options.scrollMargin,this.options.getItemKey,this.options.enabled],(n,r,s,i,a)=>(this.pendingMeasuredCacheIndexes=[],{count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:a}),{key:!1}),this.getMeasurements=u0(()=>[this.getMeasurementOptions(),this.itemSizeCache],({count:n,paddingStart:r,scrollMargin:s,getItemKey:i,enabled:a},o)=>{if(!a)return this.measurementsCache=[],this.itemSizeCache.clear(),[];this.measurementsCache.length===0&&(this.measurementsCache=this.options.initialMeasurementsCache,this.measurementsCache.forEach(u=>{this.itemSizeCache.set(u.key,u.size)}));const l=this.pendingMeasuredCacheIndexes.length>0?Math.min(...this.pendingMeasuredCacheIndexes):0;this.pendingMeasuredCacheIndexes=[];const c=this.measurementsCache.slice(0,l);for(let u=l;u<n;u++){const d=i(u),h=this.options.lanes===1?c[u-1]:this.getFurthestMeasurement(c,u),m=h?h.end+this.options.gap:r+s,y=o.get(d),b=typeof y=="number"?y:this.options.estimateSize(u),v=m+b,x=h?h.lane:u%this.options.lanes;c[u]={index:u,start:m,size:b,end:v,key:d,lane:x}}return this.measurementsCache=c,c},{key:!1,debug:()=>this.options.debug}),this.calculateRange=u0(()=>[this.getMeasurements(),this.getSize(),this.getScrollOffset(),this.options.lanes],(n,r,s,i)=>this.range=n.length>0&&r>0?xBe({measurements:n,outerSize:r,scrollOffset:s,lanes:i}):null,{key:!1,debug:()=>this.options.debug}),this.getVirtualIndexes=u0(()=>{let n=null,r=null;const s=this.calculateRange();return s&&(n=s.startIndex,r=s.endIndex),this.maybeNotify.updateDeps([this.isScrolling,n,r]),[this.options.rangeExtractor,this.options.overscan,this.options.count,n,r]},(n,r,s,i,a)=>i===null||a===null?[]:n({startIndex:i,endIndex:a,overscan:r,count:s}),{key:!1,debug:()=>this.options.debug}),this.indexFromElement=n=>{const r=this.options.indexAttribute,s=n.getAttribute(r);return s?parseInt(s,10):(console.warn(`Missing attribute name '${r}={index}' on measured element.`),-1)},this._measureElement=(n,r)=>{const s=this.indexFromElement(n),i=this.measurementsCache[s];if(!i)return;const a=i.key,o=this.elementsCache.get(a);o!==n&&(o&&this.observer.unobserve(o),this.observer.observe(n),this.elementsCache.set(a,n)),n.isConnected&&this.resizeItem(s,this.options.measureElement(n,r,this))},this.resizeItem=(n,r)=>{const s=this.measurementsCache[n];if(!s)return;const i=this.itemSizeCache.get(s.key)??s.size,a=r-i;a!==0&&((this.shouldAdjustScrollPositionOnItemSizeChange!==void 0?this.shouldAdjustScrollPositionOnItemSizeChange(s,a,this):s.start<this.getScrollOffset()+this.scrollAdjustments)&&this._scrollToOffset(this.getScrollOffset(),{adjustments:this.scrollAdjustments+=a,behavior:void 0}),this.pendingMeasuredCacheIndexes.push(s.index),this.itemSizeCache=new Map(this.itemSizeCache.set(s.key,r)),this.notify(!1))},this.measureElement=n=>{if(!n){this.elementsCache.forEach((r,s)=>{r.isConnected||(this.observer.unobserve(r),this.elementsCache.delete(s))});return}this._measureElement(n,void 0)},this.getVirtualItems=u0(()=>[this.getVirtualIndexes(),this.getMeasurements()],(n,r)=>{const s=[];for(let i=0,a=n.length;i<a;i++){const o=n[i],l=r[o];s.push(l)}return s},{key:!1,debug:()=>this.options.debug}),this.getVirtualItemForOffset=n=>{const r=this.getMeasurements();if(r.length!==0)return a3(r[Lte(0,r.length-1,s=>a3(r[s]).start,n)])},this.getOffsetForAlignment=(n,r,s=0)=>{const i=this.getSize(),a=this.getScrollOffset();r==="auto"&&(r=n>=a+i?"end":"start"),r==="center"?n+=(s-i)/2:r==="end"&&(n-=i);const o=this.getTotalSize()-i;return Math.max(Math.min(o,n),0)},this.getOffsetForIndex=(n,r="auto")=>{n=Math.max(0,Math.min(n,this.options.count-1));const s=this.measurementsCache[n];if(!s)return;const i=this.getSize(),a=this.getScrollOffset();if(r==="auto")if(s.end>=a+i-this.options.scrollPaddingEnd)r="end";else if(s.start<=a+this.options.scrollPaddingStart)r="start";else return[a,r];const o=r==="end"?s.end+this.options.scrollPaddingEnd:s.start-this.options.scrollPaddingStart;return[this.getOffsetForAlignment(o,r,s.size),r]},this.isDynamicMode=()=>this.elementsCache.size>0,this.cancelScrollToIndex=()=>{this.scrollToIndexTimeoutId!==null&&this.targetWindow&&(this.targetWindow.clearTimeout(this.scrollToIndexTimeoutId),this.scrollToIndexTimeoutId=null)},this.scrollToOffset=(n,{align:r="start",behavior:s}={})=>{this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getOffsetForAlignment(n,r),{adjustments:void 0,behavior:s})},this.scrollToIndex=(n,{align:r="auto",behavior:s}={})=>{n=Math.max(0,Math.min(n,this.options.count-1)),this.cancelScrollToIndex(),s==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size.");const i=this.getOffsetForIndex(n,r);if(!i)return;const[a,o]=i;this._scrollToOffset(a,{adjustments:void 0,behavior:s}),s!=="smooth"&&this.isDynamicMode()&&this.targetWindow&&(this.scrollToIndexTimeoutId=this.targetWindow.setTimeout(()=>{if(this.scrollToIndexTimeoutId=null,this.elementsCache.has(this.options.getItemKey(n))){const[c]=a3(this.getOffsetForIndex(n,o)),u=this.getScrollOffset();dBe(c,u)||this.scrollToIndex(n,{align:o,behavior:s})}else this.scrollToIndex(n,{align:o,behavior:s})}))},this.scrollBy=(n,{behavior:r}={})=>{this.cancelScrollToIndex(),r==="smooth"&&this.isDynamicMode()&&console.warn("The `smooth` scroll behavior is not fully supported with dynamic size."),this._scrollToOffset(this.getScrollOffset()+n,{adjustments:void 0,behavior:r})},this.getTotalSize=()=>{var n;const r=this.getMeasurements();let s;if(r.length===0)s=this.options.paddingStart;else if(this.options.lanes===1)s=((n=r[r.length-1])==null?void 0:n.end)??0;else{const i=Array(this.options.lanes).fill(null);let a=r.length-1;for(;a>=0&&i.some(o=>o===null);){const o=r[a];i[o.lane]===null&&(i[o.lane]=o.end),a--}s=Math.max(...i.filter(o=>o!==null))}return Math.max(s-this.options.scrollMargin+this.options.paddingEnd,0)},this._scrollToOffset=(n,{adjustments:r,behavior:s})=>{this.options.scrollToFn(n,{behavior:s,adjustments:r},this)},this.measure=()=>{this.itemSizeCache=new Map,this.notify(!1)},this.setOptions(t)}}const Lte=(e,t,n,r)=>{for(;e<=t;){const s=(e+t)/2|0,i=n(s);if(i<r)e=s+1;else if(i>r)t=s-1;else return s}return e>0?e-1:0};function xBe({measurements:e,outerSize:t,scrollOffset:n,lanes:r}){const s=e.length-1,i=l=>e[l].start;if(e.length<=r)return{startIndex:0,endIndex:s};let a=Lte(0,s,i,n),o=a;if(r===1)for(;o<s&&e[o].end<n+t;)o++;else if(r>1){const l=Array(r).fill(0);for(;o<s&&l.some(u=>u<n+t);){const u=e[o];l[u.lane]=u.end,o++}const c=Array(r).fill(n+t);for(;a>=0&&c.some(u=>u>=n);){const u=e[a];c[u.lane]=u.start,a--}a=Math.max(0,a-a%r),o=Math.min(s,o+(r-1-o%r))}return{startIndex:a,endIndex:o}}const uq=typeof document<"u"?E.useLayoutEffect:E.useEffect;function wBe(e){const t=E.useReducer(()=>({}),{})[1],n={...e,onChange:(s,i)=>{var a;i?dl.flushSync(t):t(),(a=e.onChange)==null||a.call(e,s,i)}},[r]=E.useState(()=>new vBe(n));return r.setOptions(n),uq(()=>r._didMount(),[]),uq(()=>r._willUpdate()),r}function jF(e){return wBe({observeElementRect:mBe,observeElementOffset:gBe,scrollToFn:bBe,...e})}var _Be=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],ff=_Be.reduce((e,t)=>{const n=ju(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{});function SBe(e,t){e&&dl.flushSync(()=>e.dispatchEvent(t))}var CBe="DismissableLayer",N4="dismissableLayer.update",kBe="dismissableLayer.pointerDownOutside",EBe="dismissableLayer.focusOutside",dq,Bte=E.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),$te=E.forwardRef((e,t)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...l}=e,c=E.useContext(Bte),[u,d]=E.useState(null),h=(u==null?void 0:u.ownerDocument)??(globalThis==null?void 0:globalThis.document),[,m]=E.useState({}),y=In(t,A=>d(A)),b=Array.from(c.layers),[v]=[...c.layersWithOutsidePointerEventsDisabled].slice(-1),x=b.indexOf(v),w=u?b.indexOf(u):-1,S=c.layersWithOutsidePointerEventsDisabled.size>0,k=w>=x,C=RBe(A=>{const N=A.target,I=[...c.branches].some(O=>O.contains(N));!k||I||(s==null||s(A),a==null||a(A),A.defaultPrevented||o==null||o())},h),T=NBe(A=>{const N=A.target;[...c.branches].some(O=>O.contains(N))||(i==null||i(A),a==null||a(A),A.defaultPrevented||o==null||o())},h);return cO(A=>{w===c.layers.size-1&&(r==null||r(A),!A.defaultPrevented&&o&&(A.preventDefault(),o()))},h),E.useEffect(()=>{if(u)return n&&(c.layersWithOutsidePointerEventsDisabled.size===0&&(dq=h.body.style.pointerEvents,h.body.style.pointerEvents="none"),c.layersWithOutsidePointerEventsDisabled.add(u)),c.layers.add(u),fq(),()=>{n&&c.layersWithOutsidePointerEventsDisabled.size===1&&(h.body.style.pointerEvents=dq)}},[u,h,n,c]),E.useEffect(()=>()=>{u&&(c.layers.delete(u),c.layersWithOutsidePointerEventsDisabled.delete(u),fq())},[u,c]),E.useEffect(()=>{const A=()=>m({});return document.addEventListener(N4,A),()=>document.removeEventListener(N4,A)},[]),f.jsx(ff.div,{...l,ref:y,style:{pointerEvents:S?k?"auto":"none":void 0,...e.style},onFocusCapture:Wt(e.onFocusCapture,T.onFocusCapture),onBlurCapture:Wt(e.onBlurCapture,T.onBlurCapture),onPointerDownCapture:Wt(e.onPointerDownCapture,C.onPointerDownCapture)})});$te.displayName=CBe;var TBe="DismissableLayerBranch",ABe=E.forwardRef((e,t)=>{const n=E.useContext(Bte),r=E.useRef(null),s=In(t,r);return E.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),f.jsx(ff.div,{...e,ref:s})});ABe.displayName=TBe;function RBe(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1),s=E.useRef(()=>{});return E.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let l=function(){zte(kBe,n,c,{discrete:!0})};const c={originalEvent:o};o.pointerType==="touch"?(t.removeEventListener("click",s.current),s.current=l,t.addEventListener("click",s.current,{once:!0})):l()}else t.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{t.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),t.removeEventListener("pointerdown",i),t.removeEventListener("click",s.current)}},[t,n]),{onPointerDownCapture:()=>r.current=!0}}function NBe(e,t=globalThis==null?void 0:globalThis.document){const n=Es(e),r=E.useRef(!1);return E.useEffect(()=>{const s=i=>{i.target&&!r.current&&zte(EBe,n,{originalEvent:i},{discrete:!1})};return t.addEventListener("focusin",s),()=>t.removeEventListener("focusin",s)},[t,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function fq(){const e=new CustomEvent(N4);document.dispatchEvent(e)}function zte(e,t,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(e,{bubbles:!1,cancelable:!0,detail:n});t&&s.addEventListener(e,t,{once:!0}),r?SBe(s,i):s.dispatchEvent(i)}var o3="focusScope.autoFocusOnMount",l3="focusScope.autoFocusOnUnmount",hq={bubbles:!1,cancelable:!0},MBe="FocusScope",Ute=E.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=E.useState(null),c=Es(s),u=Es(i),d=E.useRef(null),h=In(t,b=>l(b)),m=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let b=function(S){if(m.paused||!o)return;const k=S.target;o.contains(k)?d.current=k:dh(d.current,{select:!0})},v=function(S){if(m.paused||!o)return;const k=S.relatedTarget;k!==null&&(o.contains(k)||dh(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const C of S)C.removedNodes.length>0&&dh(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),E.useEffect(()=>{if(o){mq.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(o3,hq);o.addEventListener(o3,c),o.dispatchEvent(x),x.defaultPrevented||(IBe(FBe(qte(o)),{select:!0}),document.activeElement===b&&dh(o))}return()=>{o.removeEventListener(o3,c),setTimeout(()=>{const x=new CustomEvent(l3,hq);o.addEventListener(l3,u),o.dispatchEvent(x),x.defaultPrevented||dh(b??document.body,{select:!0}),o.removeEventListener(l3,u),mq.remove(m)},0)}}},[o,c,u,m]);const y=E.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[S,k]=jBe(w);S&&k?!b.shiftKey&&x===k?(b.preventDefault(),n&&dh(S,{select:!0})):b.shiftKey&&x===S&&(b.preventDefault(),n&&dh(k,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(ff.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});Ute.displayName=MBe;function IBe(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(dh(r,{select:t}),document.activeElement!==n)return}function jBe(e){const t=qte(e),n=pq(t,e),r=pq(t.reverse(),e);return[n,r]}function qte(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function pq(e,t){for(const n of e)if(!PBe(n,{upTo:t}))return n}function PBe(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function OBe(e){return e instanceof HTMLInputElement&&"select"in e}function dh(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&OBe(e)&&t&&e.select()}}var mq=DBe();function DBe(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=gq(e,t),e.unshift(t)},remove(t){var n;e=gq(e,t),(n=e[0])==null||n.resume()}}}function gq(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function FBe(e){return e.filter(t=>t.tagName!=="A")}var LBe="Arrow",Vte=E.forwardRef((e,t)=>{const{children:n,width:r=10,height:s=5,...i}=e;return f.jsx(ff.svg,{...i,ref:t,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:e.asChild?n:f.jsx("polygon",{points:"0,0 30,0 15,10"})})});Vte.displayName=LBe;var BBe=Vte,PF="Popper",[Wte,Hte]=Yi(PF),[$Be,Gte]=Wte(PF),Kte=e=>{const{__scopePopper:t,children:n}=e,[r,s]=E.useState(null);return f.jsx($Be,{scope:t,anchor:r,onAnchorChange:s,children:n})};Kte.displayName=PF;var Yte="PopperAnchor",Zte=E.forwardRef((e,t)=>{const{__scopePopper:n,virtualRef:r,...s}=e,i=Gte(Yte,n),a=E.useRef(null),o=In(t,a);return E.useEffect(()=>{i.onAnchorChange((r==null?void 0:r.current)||a.current)}),r?null:f.jsx(ff.div,{...s,ref:o})});Zte.displayName=Yte;var OF="PopperContent",[zBe,UBe]=Wte(OF),Xte=E.forwardRef((e,t)=>{var Fe,Se,Ce,qe,Qe,We;const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:l=!0,collisionBoundary:c=[],collisionPadding:u=0,sticky:d="partial",hideWhenDetached:h=!1,updatePositionStrategy:m="optimized",onPlaced:y,...b}=e,v=Gte(OF,n),[x,w]=E.useState(null),S=In(t,je=>w(je)),[k,C]=E.useState(null),T=Jy(k),A=(T==null?void 0:T.width)??0,N=(T==null?void 0:T.height)??0,I=r+(i!=="center"?"-"+i:""),O=typeof u=="number"?u:{top:0,right:0,bottom:0,left:0,...u},B=Array.isArray(c)?c:[c],D=B.length>0,H={padding:O,boundary:B.filter(VBe),altBoundary:D},{refs:P,floatingStyles:K,placement:U,isPositioned:V,middlewareData:L}=bO({strategy:"fixed",placement:I,whileElementsMounted:(...je)=>yO(...je,{animationFrame:m==="always"}),elements:{reference:v.anchor},middleware:[vO({mainAxis:s+N,alignmentAxis:a}),l&&xO({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?wO():void 0,...H}),l&&_O({...H}),SO({...H,apply:({elements:je,rects:Y,availableWidth:ye,availableHeight:Ie})=>{const{width:ce,height:oe}=Y.reference,se=je.floating.style;se.setProperty("--radix-popper-available-width",`${ye}px`),se.setProperty("--radix-popper-available-height",`${Ie}px`),se.setProperty("--radix-popper-anchor-width",`${ce}px`),se.setProperty("--radix-popper-anchor-height",`${oe}px`)}}),k&&kO({element:k,padding:o}),WBe({arrowWidth:A,arrowHeight:N}),h&&CO({strategy:"referenceHidden",...H})]}),[te,W]=ene(U),Q=Es(y);si(()=>{V&&(Q==null||Q())},[V,Q]);const ee=(Fe=L.arrow)==null?void 0:Fe.x,re=(Se=L.arrow)==null?void 0:Se.y,pe=((Ce=L.arrow)==null?void 0:Ce.centerOffset)!==0,[de,Oe]=E.useState();return si(()=>{x&&Oe(window.getComputedStyle(x).zIndex)},[x]),f.jsx("div",{ref:P.setFloating,"data-radix-popper-content-wrapper":"",style:{...K,transform:V?K.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:de,"--radix-popper-transform-origin":[(qe=L.transformOrigin)==null?void 0:qe.x,(Qe=L.transformOrigin)==null?void 0:Qe.y].join(" "),...((We=L.hide)==null?void 0:We.referenceHidden)&&{visibility:"hidden",pointerEvents:"none"}},dir:e.dir,children:f.jsx(zBe,{scope:n,placedSide:te,onArrowChange:C,arrowX:ee,arrowY:re,shouldHideArrow:pe,children:f.jsx(ff.div,{"data-side":te,"data-align":W,...b,ref:S,style:{...b.style,animation:V?void 0:"none"}})})})});Xte.displayName=OF;var Jte="PopperArrow",qBe={top:"bottom",right:"left",bottom:"top",left:"right"},Qte=E.forwardRef(function(t,n){const{__scopePopper:r,...s}=t,i=UBe(Jte,r),a=qBe[i.placedSide];return f.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:f.jsx(BBe,{...s,ref:n,style:{...s.style,display:"block"}})})});Qte.displayName=Jte;function VBe(e){return e!==null}var WBe=e=>({name:"transformOrigin",options:e,fn(t){var v,x,w;const{placement:n,rects:r,middlewareData:s}=t,a=((v=s.arrow)==null?void 0:v.centerOffset)!==0,o=a?0:e.arrowWidth,l=a?0:e.arrowHeight,[c,u]=ene(n),d={start:"0%",center:"50%",end:"100%"}[u],h=(((x=s.arrow)==null?void 0:x.x)??0)+o/2,m=(((w=s.arrow)==null?void 0:w.y)??0)+l/2;let y="",b="";return c==="bottom"?(y=a?d:`${h}px`,b=`${-l}px`):c==="top"?(y=a?d:`${h}px`,b=`${r.floating.height+l}px`):c==="right"?(y=`${-l}px`,b=a?d:`${m}px`):c==="left"&&(y=`${r.floating.width+l}px`,b=a?d:`${m}px`),{data:{x:y,y:b}}}});function ene(e){const[t,n="center"]=e.split("-");return[t,n]}var HBe=Kte,tne=Zte,GBe=Xte,KBe=Qte,YBe="Portal",nne=E.forwardRef((e,t)=>{var o;const{container:n,...r}=e,[s,i]=E.useState(!1);si(()=>i(!0),[]);const a=n||s&&((o=globalThis==null?void 0:globalThis.document)==null?void 0:o.body);return a?AE.createPortal(f.jsx(ff.div,{...r,ref:t}),a):null});nne.displayName=YBe;var $T="Popover",[rne,$dt]=Yi($T,[Hte]),r_=Hte(),[ZBe,hp]=rne($T),sne=e=>{const{__scopePopover:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!1}=e,o=r_(t),l=E.useRef(null),[c,u]=E.useState(!1),[d,h]=Lc({prop:r,defaultProp:s??!1,onChange:i,caller:$T});return f.jsx(HBe,{...o,children:f.jsx(ZBe,{scope:t,contentId:ca(),triggerRef:l,open:d,onOpenChange:h,onOpenToggle:E.useCallback(()=>h(m=>!m),[h]),hasCustomAnchor:c,onCustomAnchorAdd:E.useCallback(()=>u(!0),[]),onCustomAnchorRemove:E.useCallback(()=>u(!1),[]),modal:a,children:n})})};sne.displayName=$T;var ine="PopoverAnchor",XBe=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=hp(ine,n),i=r_(n),{onCustomAnchorAdd:a,onCustomAnchorRemove:o}=s;return E.useEffect(()=>(a(),()=>o()),[a,o]),f.jsx(tne,{...i,...r,ref:t})});XBe.displayName=ine;var ane="PopoverTrigger",one=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=hp(ane,n),i=r_(n),a=In(t,s.triggerRef),o=f.jsx(ff.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":fne(s.open),...r,ref:a,onClick:Wt(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?o:f.jsx(tne,{asChild:!0,...i,children:o})});one.displayName=ane;var DF="PopoverPortal",[JBe,QBe]=rne(DF,{forceMount:void 0}),lne=e=>{const{__scopePopover:t,forceMount:n,children:r,container:s}=e,i=hp(DF,t);return f.jsx(JBe,{scope:t,forceMount:n,children:f.jsx(fa,{present:n||i.open,children:f.jsx(nne,{asChild:!0,container:s,children:r})})})};lne.displayName=DF;var Ny="PopoverContent",cne=E.forwardRef((e,t)=>{const n=QBe(Ny,e.__scopePopover),{forceMount:r=n.forceMount,...s}=e,i=hp(Ny,e.__scopePopover);return f.jsx(fa,{present:r||i.open,children:i.modal?f.jsx(t$e,{...s,ref:t}):f.jsx(n$e,{...s,ref:t})})});cne.displayName=Ny;var e$e=ju("PopoverContent.RemoveScroll"),t$e=E.forwardRef((e,t)=>{const n=hp(Ny,e.__scopePopover),r=E.useRef(null),s=In(t,r),i=E.useRef(!1);return E.useEffect(()=>{const a=r.current;if(a)return PT(a)},[]),f.jsx(n_,{as:e$e,allowPinchZoom:!0,children:f.jsx(une,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wt(e.onCloseAutoFocus,a=>{var o;a.preventDefault(),i.current||(o=n.triggerRef.current)==null||o.focus()}),onPointerDownOutside:Wt(e.onPointerDownOutside,a=>{const o=a.detail.originalEvent,l=o.button===0&&o.ctrlKey===!0,c=o.button===2||l;i.current=c},{checkForDefaultPrevented:!1}),onFocusOutside:Wt(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),n$e=E.forwardRef((e,t)=>{const n=hp(Ny,e.__scopePopover),r=E.useRef(!1),s=E.useRef(!1);return f.jsx(une,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),une=E.forwardRef((e,t)=>{const{__scopePopover:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,disableOutsidePointerEvents:a,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onInteractOutside:u,...d}=e,h=hp(Ny,n),m=r_(n);return IT(),f.jsx(Ute,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx($te,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:u,onEscapeKeyDown:o,onPointerDownOutside:l,onFocusOutside:c,onDismiss:()=>h.onOpenChange(!1),children:f.jsx(GBe,{"data-state":fne(h.open),role:"dialog",id:h.contentId,...m,...d,ref:t,style:{...d.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),dne="PopoverClose",r$e=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=hp(dne,n);return f.jsx(ff.button,{type:"button",...r,ref:t,onClick:Wt(e.onClick,()=>s.onOpenChange(!1))})});r$e.displayName=dne;var s$e="PopoverArrow",i$e=E.forwardRef((e,t)=>{const{__scopePopover:n,...r}=e,s=r_(n);return f.jsx(KBe,{...s,...r,ref:t})});i$e.displayName=s$e;function fne(e){return e?"open":"closed"}var a$e=sne,o$e=one,l$e=lne,c$e=cne;function ic({...e}){return f.jsx(a$e,{"data-slot":"popover",...e})}function ac({...e}){return f.jsx(o$e,{"data-slot":"popover-trigger",...e})}function oc({className:e,align:t="center",sideOffset:n=4,...r}){return f.jsx(l$e,{children:f.jsx(c$e,{"data-slot":"popover-content",align:t,sideOffset:n,className:Ze("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 w-72 origin-(--radix-popover-content-transform-origin) rounded-md border p-4 shadow-md outline-hidden",e),...r})})}var u$e=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","select","span","svg","ul"],FF=u$e.reduce((e,t)=>{const n=ju(`Primitive.${t}`),r=E.forwardRef((s,i)=>{const{asChild:a,...o}=s,l=a?n:t;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),f.jsx(l,{...o,ref:i})});return r.displayName=`Primitive.${t}`,{...e,[t]:r}},{}),zT="Checkbox",[d$e,zdt]=Yi(zT),[f$e,LF]=d$e(zT);function h$e(e){const{__scopeCheckbox:t,checked:n,children:r,defaultChecked:s,disabled:i,form:a,name:o,onCheckedChange:l,required:c,value:u="on",internal_do_not_use_render:d}=e,[h,m]=Lc({prop:n,defaultProp:s??!1,onChange:l,caller:zT}),[y,b]=E.useState(null),[v,x]=E.useState(null),w=E.useRef(!1),S=y?!!a||!!y.closest("form"):!0,k={checked:h,disabled:i,setChecked:m,control:y,setControl:b,name:o,form:a,value:u,hasConsumerStoppedPropagationRef:w,required:c,defaultChecked:kh(s)?!1:s,isFormControl:S,bubbleInput:v,setBubbleInput:x};return f.jsx(f$e,{scope:t,...k,children:p$e(d)?d(k):r})}var hne="CheckboxTrigger",pne=E.forwardRef(({__scopeCheckbox:e,onKeyDown:t,onClick:n,...r},s)=>{const{control:i,value:a,disabled:o,checked:l,required:c,setControl:u,setChecked:d,hasConsumerStoppedPropagationRef:h,isFormControl:m,bubbleInput:y}=LF(hne,e),b=In(s,u),v=E.useRef(l);return E.useEffect(()=>{const x=i==null?void 0:i.form;if(x){const w=()=>d(v.current);return x.addEventListener("reset",w),()=>x.removeEventListener("reset",w)}},[i,d]),f.jsx(FF.button,{type:"button",role:"checkbox","aria-checked":kh(l)?"mixed":l,"aria-required":c,"data-state":xne(l),"data-disabled":o?"":void 0,disabled:o,value:a,...r,ref:b,onKeyDown:Wt(t,x=>{x.key==="Enter"&&x.preventDefault()}),onClick:Wt(n,x=>{d(w=>kh(w)?!0:!w),y&&m&&(h.current=x.isPropagationStopped(),h.current||x.stopPropagation())})})});pne.displayName=hne;var mne=E.forwardRef((e,t)=>{const{__scopeCheckbox:n,name:r,checked:s,defaultChecked:i,required:a,disabled:o,value:l,onCheckedChange:c,form:u,...d}=e;return f.jsx(h$e,{__scopeCheckbox:n,checked:s,defaultChecked:i,disabled:o,required:a,onCheckedChange:c,name:r,form:u,value:l,internal_do_not_use_render:({isFormControl:h})=>f.jsxs(f.Fragment,{children:[f.jsx(pne,{...d,ref:t,__scopeCheckbox:n}),h&&f.jsx(vne,{__scopeCheckbox:n})]})})});mne.displayName=zT;var gne="CheckboxIndicator",yne=E.forwardRef((e,t)=>{const{__scopeCheckbox:n,forceMount:r,...s}=e,i=LF(gne,n);return f.jsx(fa,{present:r||kh(i.checked)||i.checked===!0,children:f.jsx(FF.span,{"data-state":xne(i.checked),"data-disabled":i.disabled?"":void 0,...s,ref:t,style:{pointerEvents:"none",...e.style}})})});yne.displayName=gne;var bne="CheckboxBubbleInput",vne=E.forwardRef(({__scopeCheckbox:e,...t},n)=>{const{control:r,hasConsumerStoppedPropagationRef:s,checked:i,defaultChecked:a,required:o,disabled:l,name:c,value:u,form:d,bubbleInput:h,setBubbleInput:m}=LF(bne,e),y=In(n,m),b=jT(i),v=Jy(r);E.useEffect(()=>{const w=h;if(!w)return;const S=window.HTMLInputElement.prototype,C=Object.getOwnPropertyDescriptor(S,"checked").set,T=!s.current;if(b!==i&&C){const A=new Event("click",{bubbles:T});w.indeterminate=kh(i),C.call(w,kh(i)?!1:i),w.dispatchEvent(A)}},[h,b,i,s]);const x=E.useRef(kh(i)?!1:i);return f.jsx(FF.input,{type:"checkbox","aria-hidden":!0,defaultChecked:a??x.current,required:o,disabled:l,name:c,value:u,form:d,...t,tabIndex:-1,ref:y,style:{...t.style,...v,position:"absolute",pointerEvents:"none",opacity:0,margin:0,transform:"translateX(-100%)"}})});vne.displayName=bne;function p$e(e){return typeof e=="function"}function kh(e){return e==="indeterminate"}function xne(e){return kh(e)?"indeterminate":e?"checked":"unchecked"}function zc({className:e,...t}){return f.jsx(mne,{"data-slot":"checkbox",className:Ze("peer border-input dark:bg-input/30 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground dark:data-[state=checked]:bg-primary data-[state=checked]:border-primary focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive size-4 shrink-0 rounded-[4px] border shadow-xs transition-shadow outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50",e),...t,children:f.jsx(yne,{"data-slot":"checkbox-indicator",className:"flex items-center justify-center text-current transition-none",children:f.jsx(co,{className:"size-3.5"})})})}const BF=({currentCapabilityFilters:e,onCapabilityFilterChange:t,currentSelectedProviders:n,onProviderFilterChange:r,currentEnabledFilter:s,onEnabledFilterChange:i,currentMinInputPrice:a,currentMaxInputPrice:o,currentMinOutputPrice:l,currentMaxOutputPrice:c,onPriceFilterChange:u,allProviders:d,showCapabilityFilters:h=!0,showProviderFilter:m=!1,showStatusFilter:y=!1,showPriceFilters:b=!1,disabled:v=!1,totalActiveFilters:x})=>{const[w,S]=E.useState(!1),k=E.useCallback(A=>{t({...e,[A]:!e[A]})},[e,t]),C=E.useCallback((A,N)=>{if(!n||!r)return;const I=new Set(n);N?I.add(A):I.delete(A),r(I)},[n,r]),T=E.useCallback((A,N)=>{if(!u)return;u(A==="minInput"?N:a??"",A==="maxInput"?N:o??"",A==="minOutput"?N:l??"",A==="maxOutput"?N:c??"")},[u,a,o,l,c]);return f.jsxs(ic,{open:w,onOpenChange:S,children:[f.jsx(ac,{asChild:!0,children:f.jsxs(ct,{variant:"outline",size:"sm",className:"h-9 px-3 relative",disabled:v,children:[f.jsx(Fme,{className:"h-4 w-4 mr-1"}),"Filters",x>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:x})]})}),f.jsxs(oc,{className:"p-4 space-y-4 w-72 bg-popover shadow-lg relative",style:{zIndex:9999,pointerEvents:"auto"},onMouseDown:A=>A.preventDefault(),onClick:A=>A.stopPropagation(),onPointerDown:A=>A.stopPropagation(),onPointerDownCapture:A=>A.stopPropagation(),align:"end",children:[y&&s!==void 0&&i&&f.jsxs("div",{className:"space-y-2",onClick:A=>A.stopPropagation(),children:[f.jsx(jt,{className:"text-xs font-semibold",children:"Status"}),f.jsxs("div",{className:"flex gap-1",children:[f.jsx(ct,{variant:s==="all"?"secondary":"outline",size:"sm",onClick:A=>{A.stopPropagation(),i("all")},children:"All"}),f.jsxs(ct,{variant:s==="enabled"?"secondary":"outline",size:"sm",onClick:A=>{A.stopPropagation(),i("enabled")},children:[f.jsx(co,{className:"h-3 w-3 mr-1"})," Enabled"]}),f.jsxs(ct,{variant:s==="disabled"?"secondary":"outline",size:"sm",onClick:A=>{A.stopPropagation(),i("disabled")},children:[f.jsx(Tpe,{className:"h-3 w-3 mr-1"})," Disabled"]})]})]}),m&&n&&d&&r&&f.jsxs("div",{onClick:A=>A.stopPropagation(),children:[f.jsx(jt,{className:"text-xs px-2 font-semibold block mb-1",children:"Providers"}),f.jsx(Zl,{className:"h-32 border rounded-md p-1",children:d.map(A=>f.jsxs("div",{className:"flex items-center space-x-2 p-1.5 rounded hover:bg-muted",children:[f.jsx(zc,{id:`filter-provider-${A.id}`,checked:n.has(A.id),onCheckedChange:N=>{C(A.id,!!N)}}),f.jsxs(jt,{htmlFor:`filter-provider-${A.id}`,className:"text-sm font-normal cursor-pointer",children:[A.name," (",A.type,")"]})]},A.id))})]}),h&&f.jsxs("div",{className:"space-y-2",onClick:A=>A.stopPropagation(),children:[f.jsx(jt,{className:"text-xs font-semibold",children:"Capabilities"}),f.jsxs("div",{className:"flex flex-wrap gap-1",children:[f.jsx(qn,{tooltipText:"Reasoning","aria-label":"Reasoning",icon:f.jsx(Hy,{}),onClick:A=>{A.stopPropagation(),k("reasoning")},variant:e.reasoning?"secondary":"outline",className:Ze(e.reasoning&&"text-primary")}),f.jsx(qn,{tooltipText:"Web Search","aria-label":"Web Search",icon:f.jsx(uo,{}),onClick:A=>{A.stopPropagation(),k("webSearch")},variant:e.webSearch?"secondary":"outline",className:Ze(e.webSearch&&"text-primary")}),f.jsx(qn,{tooltipText:"Tools","aria-label":"Tools",icon:f.jsx(Sm,{}),onClick:A=>{A.stopPropagation(),k("tools")},variant:e.tools?"secondary":"outline",className:Ze(e.tools&&"text-primary")}),f.jsx(qn,{tooltipText:"Multimodal","aria-label":"Multimodal",icon:f.jsx(Ah,{}),onClick:A=>{A.stopPropagation(),k("multimodal")},variant:e.multimodal?"secondary":"outline",className:Ze(e.multimodal&&"text-primary")})]})]}),b&&a!==void 0&&u&&f.jsxs("div",{className:"space-y-2",onClick:A=>A.stopPropagation(),children:[f.jsxs(jt,{className:"text-xs font-semibold flex items-center gap-1",children:[f.jsx(pme,{className:"h-3 w-3"})," Price Range ($ / 1M Tokens)"]}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx(xn,{type:"number",min:"0",step:"0.01",placeholder:"Min Input",value:a,onChange:A=>{A.stopPropagation(),T("minInput",A.target.value)},className:"h-8 text-xs"}),f.jsx(xn,{type:"number",min:"0",step:"0.01",placeholder:"Max Input",value:o,onChange:A=>{A.stopPropagation(),T("maxInput",A.target.value)},className:"h-8 text-xs"}),f.jsx(xn,{type:"number",min:"0",step:"0.01",placeholder:"Min Output",value:l,onChange:A=>{A.stopPropagation(),T("minOutput",A.target.value)},className:"h-8 text-xs"}),f.jsx(xn,{type:"number",min:"0",step:"0.01",placeholder:"Max Output",value:c,onChange:A=>{A.stopPropagation(),T("maxOutput",A.target.value)},className:"h-8 text-xs"})]})]})]})]})},yq=e=>{if(!e)return null;const t=parseFloat(e);return isNaN(t)?null:t/1e6},$F=({providerId:e,allAvailableModels:t,enabledModelIds:n,onToggleModel:r,isLoading:s=!1,disabled:i=!1,listHeightClass:a="h-[26rem]",onModelClick:o})=>{const[l,c]=E.useState(null),u=E.useCallback(K=>{if(K){const U=K.querySelector("[data-radix-scroll-area-viewport]");if(U)c(U);else{const V=new MutationObserver(()=>{const L=K.querySelector("[data-radix-scroll-area-viewport]");L&&(c(L),V.disconnect())});return V.observe(K,{childList:!0,subtree:!0}),()=>V.disconnect()}}else c(null)},[]),[d,h]=E.useState(""),[m,y]=E.useState("all"),[b,v]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),[x,w]=E.useState(""),[S,k]=E.useState(""),[C,T]=E.useState(""),[A,N]=E.useState(""),I=E.useMemo(()=>{let K=[...t];if(m==="enabled"?K=K.filter(de=>n.has(de.id)):m==="disabled"&&(K=K.filter(de=>!n.has(de.id))),d.trim()){const de=d.toLowerCase();K=K.filter(Oe=>Oe.name.toLowerCase().includes(de)||Oe.id.toLowerCase().includes(de))}const U=Object.entries(b).filter(([,de])=>de).map(([de])=>de);U.length>0&&(K=K.filter(de=>{var Se;const Oe=new Set(de.supported_parameters??[]),Fe=new Set(((Se=de.architecture)==null?void 0:Se.input_modalities)??[]);return U.every(Ce=>{switch(Ce){case"reasoning":return Oe.has("reasoning");case"webSearch":return Oe.has("web_search")||Oe.has("web_search_options");case"tools":return Oe.has("tools");case"multimodal":return Array.from(Fe).some(qe=>qe!=="text");default:return!0}})}));const V=parseFloat(x),L=parseFloat(S),te=parseFloat(C),W=parseFloat(A),Q=!isNaN(V),ee=!isNaN(L),re=!isNaN(te),pe=!isNaN(W);return(Q||ee||re||pe)&&(K=K.filter(de=>{var ye,Ie;const Oe=yq((ye=de.pricing)==null?void 0:ye.prompt),Fe=yq((Ie=de.pricing)==null?void 0:Ie.completion),Se=Q?V/1e6:-1/0,Ce=ee?L/1e6:1/0,qe=re?te/1e6:-1/0,Qe=pe?W/1e6:1/0,We=Oe!==null&&Oe>=Se&&Oe<=Ce,je=Fe!==null&&Fe>=qe&&Fe<=Qe;let Y=!0;return(Q||ee)&&Y&&(Y=We),(re||pe)&&Y&&(Y=je),Y})),K},[t,d,m,n,b,x,S,C,A]),O=jF({count:I.length,getScrollElement:()=>l,estimateSize:()=>40,overscan:10}),B=E.useCallback(K=>{v(K)},[]),D=E.useCallback(K=>{y(K)},[]),H=E.useCallback((K,U,V,L)=>{w(K),k(U),T(V),N(L)},[]),P=E.useMemo(()=>(m!=="all"?1:0)+Object.values(b).filter(Boolean).length+(x||S||C||A?1:0),[m,b,x,S,C,A]);return s?f.jsxs("div",{className:Ze("space-y-2",a),children:[f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):t.length===0?f.jsx("p",{className:"text-sm text-muted-foreground italic pt-2",children:"No models available for this provider. Try fetching models."}):f.jsxs("div",{className:"space-y-2 flex flex-col h-full",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(uo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(xn,{value:d,onChange:K=>h(K.target.value),placeholder:"Filter models by name...",className:"pl-8 h-9 w-full text-xs",type:"text",disabled:i})]}),f.jsx(BF,{currentCapabilityFilters:b,onCapabilityFilterChange:B,currentEnabledFilter:m,onEnabledFilterChange:D,currentMinInputPrice:x,currentMaxInputPrice:S,currentMinOutputPrice:C,currentMaxOutputPrice:A,onPriceFilterChange:H,showStatusFilter:!0,showCapabilityFilters:!0,showPriceFilters:!0,disabled:i,totalActiveFilters:P})]}),f.jsxs(Zl,{className:Ze("w-full rounded-md border border-border p-1 bg-background/50 flex-grow",a),ref:u,children:[l&&f.jsx("div",{style:{height:`${O.getTotalSize()}px`,width:"100%",position:"relative"},children:I.length===0&&!s?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match the current filters."}):O.getVirtualItems().map(K=>{const U=I[K.index];return U?f.jsxs("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${K.size}px`,transform:`translateY(${K.start}px)`},className:"flex items-center justify-between space-x-2 p-1.5 rounded hover:bg-muted/50",children:[f.jsx(oo,{id:`enable-model-${e}-${U.id}`,checked:n.has(U.id),onCheckedChange:V=>r(U.id,V),disabled:i,"aria-label":`Enable model ${U.name||U.id}`,className:"flex-shrink-0",onClick:V=>V.stopPropagation()}),f.jsx(jt,{htmlFor:`enable-model-${e}-${U.id}`,className:"text-sm font-normal text-card-foreground flex-grow cursor-pointer truncate pl-2",title:U.name||U.id,onClick:o?()=>o(U.id):void 0,children:U.name||U.id})]},U.id):null})}),!l&&!s&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},m$e=({stepNumber:e,title:t,description:n,isComplete:r,isActive:s,openOnComplete:i=!1,contentClassName:a="",icon:o,children:l})=>{const[c,u]=E.useState(!1);return E.useEffect(()=>{u(s||r&&i)},[s,r,i]),f.jsxs(Fo,{className:`border border-border/40 bg-card/50 backdrop-blur-sm shadow-lg ${r?"border-l-4 border-l-green-500/70":s?"border-l-4 border-l-primary/70":""}`,children:[f.jsx(Lo,{className:"pb-2",children:f.jsxs("div",{className:"flex items-center space-x-3",children:[f.jsx("div",{className:`flex h-8 w-8 shrink-0 items-center justify-center rounded-full ${r?"bg-green-500/20 text-green-500":s?"bg-primary/20 text-primary":"bg-muted text-muted-foreground"}`,children:r?f.jsx(xE,{className:"h-5 w-5"}):f.jsx("div",{className:"flex items-center justify-center",children:o})}),f.jsxs("div",{className:"flex-1",children:[f.jsxs("div",{className:"flex items-center justify-between cursor-pointer",onClick:()=>u(!c),children:[f.jsxs(Bo,{className:"text-base",children:[f.jsxs("span",{className:"opacity-60 mr-2",children:[e,"."]}),t]}),f.jsx("button",{className:`p-1 rounded-full transition-all ${c?"rotate-90":""} hover:bg-muted/60`,children:f.jsx(VP,{className:"h-4 w-4"})})]}),!c&&f.jsx(Au,{className:"text-xs mt-1",children:typeof n=="string"?n.substring(0,60)+(n.length>60?"...":""):"Click to expand"})]})]})}),f.jsx(BPe,{children:c&&f.jsx(gu.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},transition:{duration:.3},className:"overflow-hidden",children:f.jsxs($o,{className:"pt-2",children:[typeof n=="string"?f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:n}):f.jsx("div",{className:"text-sm text-muted-foreground mb-4",children:n}),f.jsx("div",{className:a,children:l})]})})})]})},g$e=()=>{const{apiKeys:e,addApiKey:t,providers:n,addProviderConfig:r,updateProviderConfig:s,getAllAvailableModelDefsForProvider:i,isLoading:a,enableApiKeyManagement:o}=Qn(yn(re=>({apiKeys:re.dbApiKeys,addApiKey:re.addApiKey,providers:re.dbProviderConfigs,addProviderConfig:re.addProviderConfig,updateProviderConfig:re.updateProviderConfig,getAllAvailableModelDefsForProvider:re.getAllAvailableModelDefsForProvider,isLoading:re.isLoading,enableApiKeyManagement:re.enableApiKeyManagement}))),{addConversation:l,selectItem:c}=Vn(yn(re=>({addConversation:re.addConversation,selectItem:re.selectItem}))),[u,d]=E.useState(!1),[h,m]=E.useState(!1),[y,b]=E.useState(!1),[v,x]=E.useState(!1),[w,S]=E.useState(!1),k=E.useMemo(()=>!o||e.length>0,[o,e]),C=E.useMemo(()=>n.length>0,[n]),T=E.useMemo(()=>n.some(re=>re.isEnabled&&re.enabledModels&&re.enabledModels.length>0),[n]),A=E.useMemo(()=>{const re=[...n].sort((pe,de)=>de.createdAt.getTime()-pe.createdAt.getTime());return re.length>0?re[0]:null},[n]),N=E.useMemo(()=>A?i(A.id):[],[A,i]),I=E.useMemo(()=>new Set((A==null?void 0:A.enabledModels)??[]),[A]),{initialProviderTypeForForm:O,initialProviderNameForForm:B,initialApiKeyIdForForm:D}=E.useMemo(()=>{var re;if(C)return{type:void 0,name:void 0,keyId:void 0};if(e.length>0){const de=[...e].sort((Oe,Fe)=>Fe.createdAt.getTime()-Oe.createdAt.getTime()).find(Oe=>ly(Oe.providerId));if(de){const Oe=de.providerId,Fe=((re=Ao.find(Se=>Se.value===Oe))==null?void 0:re.label)||Oe;return{initialProviderTypeForForm:Oe,initialProviderNameForForm:Fe,initialApiKeyIdForForm:de.id}}}return{initialProviderTypeForForm:void 0,initialProviderNameForForm:void 0,initialApiKeyIdForForm:void 0}},[e,C]),H=E.useCallback(async(re,pe,de)=>{d(!0);try{await t(re,pe,de),Te.success("API key added successfully!")}finally{d(!1)}},[t]),P=E.useCallback(async re=>{m(!0);try{const pe={...re,apiKeyId:re.apiKeyId??(ly(re.type)?D??null:null)},de=await r(pe);return Te.success("Provider added successfully!"),de}finally{m(!1)}},[r,D]),K=E.useCallback(async(re,pe)=>{if(!A)return;x(!0);const de=new Set(A.enabledModels??[]);pe?de.add(re):de.delete(re);const Oe=Array.from(de);try{await s(A.id,{enabledModels:Oe}),Te.success(pe?"Model enabled successfully!":"Model disabled successfully!")}catch(Fe){Te.error("Failed to update model status."),console.error("Failed to save model toggle:",Fe)}finally{x(!1)}},[A,s]),U=E.useCallback(async()=>{b(!0),S(!0);try{await new Promise(pe=>setTimeout(pe,800));const re=await l({title:"New Chat"});await c(re,"conversation"),Te.success("Welcome to your first chat!")}catch(re){Te.error("Failed to start your first chat."),console.error("Failed to start first chat:",re),b(!1),S(!1)}},[l,c]),V=()=>{Re.emit(Tr.openModalRequest,{modalId:"settingsModal",initialTab:"providers"})},L=[k,C,T].filter(Boolean).length,te=o?3:2,W=L/te*100,Q=[...o?[{id:"api-key",title:"Add API Key",description:f.jsxs("div",{className:"space-y-2",children:[f.jsxs("p",{children:["To use providers like"," ",f.jsx(Nd,{href:"https://platform.openai.com/api-keys",className:"text-blue-500 hover:text-blue-700 transition-colors",children:"OpenAI"}),","," ",f.jsx(Nd,{href:"https://aistudio.google.com/app/apikey",className:"text-green-600 hover:text-green-700 transition-colors",children:"Google"}),","," ",f.jsx(Nd,{href:"https://console.anthropic.com/settings/keys",className:"text-purple-500 hover:text-purple-700 transition-colors",children:"Anthropic (Claude)"}),", or"," ",f.jsx(Nd,{href:"https://openrouter.ai/keys",className:"text-orange-500 hover:text-orange-700 transition-colors",children:"OpenRouter"})," ","or any OpenAI API compatible provider, add an API key. Keys are stored securely in your browser."]}),f.jsxs("p",{children:['If you want truly local AI, "no internet required", you can setup'," ",f.jsx(Nd,{href:"https://www.ollama.com/",className:"text-teal-500 hover:text-teal-700 transition-colors",children:"Ollama"})," ","or,"," ",f.jsx(Nd,{href:"https://lmstudio.ai/",className:"text-indigo-500 hover:text-indigo-700 transition-colors",children:"LMStudio"})," ","(or any other local LLM solution with an OpenAI compatible API). These typically don't require API keys so see you in step 2."]})]}),isComplete:k,content:f.jsx(Cte,{onSave:H,onCancel:()=>{},disabled:u,className:"border-none shadow-none p-0",initialProviderType:O}),icon:f.jsx(Zx,{className:"h-4 w-4"})}]:[],{id:"add-provider",title:"Add AI Provider",description:f.jsxs("div",{className:"space-y-2",children:[f.jsx("p",{children:"Connect to an AI provider you configured the key for..."}),f.jsx("p",{children:"This might look redundant, but it allows you to have multiple keys for the same provider (personal, professional, etc.)"})]}),isComplete:C,content:f.jsx(Ite,{apiKeys:e,onAddProvider:P,onCancel:()=>{},initialType:O,initialName:B,initialApiKeyId:D}),icon:f.jsx(ry,{className:"h-4 w-4"})},{id:"enable-models",title:"Enable Models",description:f.jsxs("div",{className:"space-y-2",children:[f.jsxs("p",{children:["Enable models for the provider you just added (",f.jsx("span",{className:"font-medium text-primary",children:(A==null?void 0:A.name)||"..."}),")."]}),f.jsx("p",{children:"Enabling specific models improves the UI by reducing clutter and choice paralysis. You can enable more later in Settings."}),f.jsx("p",{children:"And just like before, you can choose to activate a model for a certain combination of key/provider!"})]}),isComplete:T,content:A?f.jsx("div",{className:"bg-card/40 rounded-lg p-3 border border-border/30 shadow-inner",children:f.jsx($F,{providerId:A.id,allAvailableModels:N,enabledModelIds:I,onToggleModel:K,isLoading:a||v,listHeightClass:"h-[26rem]"})}):f.jsxs("p",{className:"text-sm text-muted-foreground italic flex items-center",children:[f.jsx(Kl,{className:"h-4 w-4 mr-2 text-amber-500"}),"Add a provider in Step ",o?"2":"1"," first."]}),icon:f.jsx(Hy,{className:"h-4 w-4"})},{id:"start-chat",title:"Start Chatting",description:"You're all set! Click below to start your first chat.",isComplete:!1,content:f.jsxs("div",{children:[w&&f.jsx(gu.div,{initial:{opacity:0},animate:{opacity:1},className:"mb-4",children:f.jsx(Ry,{value:y?void 0:100,className:"h-2"})}),f.jsxs(ct,{onClick:U,disabled:y||!T,className:"w-full bg-gradient-to-r from-indigo-500 to-primary hover:opacity-90 transition-all",children:[f.jsx(cge,{className:"mr-2 h-4 w-4"}),y?"Launching...":"Start First Chat"]}),f.jsx(WJ,{})]}),contentClassName:"p-4",icon:f.jsx(jge,{className:"h-4 w-4"})}],ee=Q.findIndex(re=>!re.isComplete);return a?f.jsx("div",{className:"flex h-full flex-col items-center justify-center p-4 space-y-4 max-w-4xl mx-auto w-full",children:f.jsxs(gu.div,{initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},className:"w-full",children:[f.jsx(Gr,{className:"h-12 w-1/2 mx-auto mb-6"}),f.jsx(Gr,{className:"h-8 w-3/4 mx-auto mb-2"}),f.jsx(Gr,{className:"h-4 w-1/2 mx-auto mb-8"}),f.jsx(Gr,{className:"h-20 w-full mb-6"}),f.jsx(Gr,{className:"h-20 w-full mb-6"}),f.jsx(Gr,{className:"h-20 w-full"})]})}):f.jsx("div",{className:"flex h-full flex-col items-center justify-start p-4 bg-gradient-to-b from-background to-background/80",children:f.jsxs("div",{className:"w-full max-w-4xl space-y-6 pt-8",children:[f.jsxs("div",{className:"text-center mb-8",children:[f.jsx(gu.div,{initial:{scale:.9,opacity:0},animate:{scale:1,opacity:1},transition:{type:"spring",stiffness:500,damping:30},children:f.jsxs("div",{className:"relative mx-auto w-16 h-16 mb-4",children:[f.jsx("div",{className:"absolute inset-0 bg-primary/20 rounded-full blur-xl"}),f.jsx("div",{className:"relative bg-gradient-to-br from-primary to-indigo-600 p-3 rounded-full",children:f.jsx(tBe,{className:"h-10 w-10 text-white"})})]})}),f.jsx("h2",{className:"text-3xl font-bold mb-3 bg-gradient-to-r from-primary to-indigo-500 bg-clip-text text-transparent",children:"Welcome to LiteChat"}),f.jsx(rBe,{})]}),f.jsxs(gu.div,{className:"space-y-4",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5},children:[f.jsx(wr,{children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsxs("div",{className:"mt-6 bg-card/40 backdrop-blur-sm border border-border/30 rounded-xl p-3 w-3/4 mx-auto",children:[f.jsx(Ry,{value:W,className:"h-1.5"}),f.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Setup Progress: ",Math.round(W),"%"]})]})}),f.jsx(Cr,{children:f.jsxs("p",{children:["Steps completed: ",L," of ",te]})})]})}),Q.map((re,pe)=>{const de=pe===ee;return f.jsx(gu.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:pe*.1,duration:.3},children:f.jsx(m$e,{stepNumber:pe+1,title:re.title,description:re.description,isComplete:re.id!=="start-chat"&&re.isComplete,isActive:de,openOnComplete:re.id==="enable-models",contentClassName:re.id==="add-provider"||re.id==="api-key"?"p-0 border-none shadow-none bg-transparent":re.contentClassName,icon:re.icon,children:re.content})},re.id)})]}),!a&&!C&&ee===-1&&f.jsxs(gu.div,{className:"text-center mt-6 p-4 bg-red-500/10 rounded-lg border border-red-500/30",initial:{opacity:0},animate:{opacity:1},transition:{delay:.5},children:[f.jsx(Kl,{className:"h-8 w-8 text-red-500 mx-auto mb-2"}),f.jsx("p",{className:"text-sm mb-3",children:"Configuration issue detected. Please review provider settings."}),f.jsx(ct,{variant:"outline",size:"sm",onClick:V,className:"border-red-500/50 hover:bg-red-500/20 transition-colors",children:"Open Provider Settings"})]})]})})},mC=["conversation.title_generation","conversation.compact"],y$e=({conversationId:e,interactions:t,status:n,className:r})=>{const s=E.useRef(null),i=E.useRef(null),[a,o]=E.useState(!1),l=E.useRef(null),c=un(P=>P.streamingInteractionIds),{chatMaxWidth:u,autoScrollInterval:d,enableAutoScrollOnStream:h}=pr(yn(P=>({chatMaxWidth:P.chatMaxWidth,autoScrollInterval:P.autoScrollInterval,enableAutoScrollOnStream:P.enableAutoScrollOnStream}))),m=pr(P=>P.setEnableAutoScrollOnStream),y=E.useMemo(()=>P=>({isLoading:P.isLoading}),[]),b=E.useMemo(()=>P=>({conversationCount:P.conversations.length,isConversationLoading:P.isLoading}),[]),{isLoading:v}=Qn(yn(y)),{conversationCount:x,isConversationLoading:w}=Vn(yn(b)),{projectCount:S,isProjectLoading:k}=yl(yn(P=>({projectCount:P.projects.length,isProjectLoading:P.isLoading}))),C=E.useMemo(()=>v||w||k?!1:x===0&&S===0,[x,S,v,w,k]),T=E.useMemo(()=>t.filter(U=>U.parentId===null&&!mC.includes(U.type)).sort((U,V)=>U.index-V.index).map(U=>{const V=t.filter(L=>L.parentId===U.id&&!mC.includes(L.type)).sort((L,te)=>L.index-te.index);return[U,...V]}),[t]),A=Wi(yn(P=>Object.values(P.canvasControls))),N=E.useCallback((P,K,U,V)=>A.filter(te=>{const W=te.type===P,Q=te.targetSlot===K,ee=!!te.renderer;return W&&Q&&ee}).map(te=>{if(te.renderer){const Q={...{interaction:U,interactionId:U==null?void 0:U.id,responseContent:typeof(U==null?void 0:U.response)=="string"?U.response:void 0,canvasContextType:P},...V};return f.jsx(Ve.Fragment,{children:te.renderer(Q)},te.id)}return null}).filter(Boolean),[A]),I=(P="smooth")=>{if(i.current){i.current.scrollTo({top:i.current.scrollHeight,behavior:P});return}if(s.current){const K=s.current.querySelector("[data-radix-scroll-area-viewport]");if(K){i.current=K,K.scrollTo({top:K.scrollHeight,behavior:P});return}}s.current&&s.current.scrollTo({top:s.current.scrollHeight,behavior:P})};E.useEffect(()=>{if(i.current){const{scrollHeight:P,clientHeight:K,scrollTop:U}=i.current;(P-K<=U+150||n!=="streaming")&&requestAnimationFrame(()=>{I(n==="streaming"?"smooth":"auto")})}},[T.length,n,c]),E.useEffect(()=>(n==="streaming"&&h?(l.current&&clearInterval(l.current),l.current=setInterval(()=>{I("smooth")},d)):l.current&&(clearInterval(l.current),l.current=null),()=>{l.current&&clearInterval(l.current)}),[n,d,h]),E.useEffect(()=>{const P=i.current;if(!P)return;const K=()=>{if(!i.current)return;const{scrollHeight:U,clientHeight:V,scrollTop:L}=i.current,te=L<U-V-V*.5;o(te)};return P.addEventListener("scroll",K,{passive:!0}),K(),()=>{i.current&&i.current.removeEventListener("scroll",K)}},[]),E.useEffect(()=>{if(s.current){const P=s.current.querySelector("[data-radix-scroll-area-viewport]");P&&(i.current=P)}},[]);const O=E.useMemo(()=>{const P=[];return[...t].sort((V,L)=>{var te,W;return V.index!==L.index?V.index-L.index:V.parentId===null&&L.parentId!==null?-1:V.parentId!==null&&L.parentId===null?1:V.parentId!==null&&L.parentId!==null&&V.parentId===L.parentId?V.index-L.index:(((te=V.startedAt)==null?void 0:te.getTime())??0)-(((W=L.startedAt)==null?void 0:W.getTime())??0)}).filter(V=>V.parentId===null&&!mC.includes(V.type)).forEach(V=>{var Q,ee;let L=null;if(V.type==="message.user_assistant"&&V.prompt)L=V.prompt;else if(V.type==="message.assistant_regen"&&((Q=V.metadata)!=null&&Q.regeneratedFromId)){let re,pe=V;const de=new Set;for(;pe&&!de.has(pe.id);){if(de.add(pe.id),pe.type==="message.user_assistant"&&pe.prompt){re=pe;break}if((ee=pe.metadata)!=null&&ee.regeneratedFromId)pe=t.find(Oe=>Oe.id===pe.metadata.regeneratedFromId);else break}re?L=re.prompt:V.prompt?L=V.prompt:console.warn(`[ChatCanvas] Could not reliably find user prompt for active interaction ${V.id} of type ${V.type}. Displaying turn without prompt.`)}if(L)P.push(f.jsx(wT,{turnData:L,timestamp:V.startedAt,isAssistantComplete:V.status==="COMPLETED"||V.status==="ERROR",interactionId:V.id},`prompt-${V.id}`));else if(V.type!=="message.user_assistant"&&V.type!=="message.assistant_regen"){console.log("[ChatCanvas] Skipping active interaction on spine due to no user prompt and non-standard type:",V.id,V.type);return}const te=t.filter(re=>re.parentId===V.id&&!mC.includes(re.type)).sort((re,pe)=>re.index-pe.index),W=[V,...te];W.length>0&&P.push(f.jsx(mPe,{interactionGroup:W,renderSlot:(re,pe,de)=>N("interaction",re,pe,de),activeStreamingInteractionId:c.find(re=>W.some(pe=>pe.id===re))},`tabs-${V.id}`))}),P},[t,N,c]),B=E.useMemo(()=>c.filter(P=>!t.some(K=>K.id===P)).map(P=>f.jsx(bk,{interactionId:P,renderSlot:(K,U,V)=>N("interaction",K,U,V)},`${P}-streaming-new`)),[c,t,N]),D=()=>v||w||k?f.jsxs("div",{className:"space-y-4 p-2 md:p-4",children:[f.jsx(Gr,{className:"h-24 w-full"}),f.jsx(Gr,{className:"h-32 w-full"}),f.jsx(Gr,{className:"h-20 w-full"})]}):e?T.length===0&&n!=="streaming"&&c.length===0?f.jsx(S7,{}):f.jsxs("div",{className:"space-y-4 p-2 md:p-4 break-words",children:[O,B]}):f.jsx(S7,{}),H=u||"max-w-7xl";return f.jsx("div",{className:Ze("flex-grow relative",r),children:C?f.jsx(Zl,{className:"h-full w-full",children:f.jsx("div",{className:Ze("mx-auto w-full",H),children:f.jsx(g$e,{})})}):f.jsxs(f.Fragment,{children:[f.jsx(Zl,{className:"h-full w-full",ref:s,children:f.jsx("div",{className:Ze("mx-auto w-full",H),children:D()})}),a&&f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{variant:"outline",size:"icon",className:"absolute bottom-4 right-4 z-20 h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>I(),"aria-label":"Scroll to bottom",children:f.jsx(wH,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"left",children:"Scroll to Bottom"})]})}),n==="streaming"&&f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{variant:"outline",size:"icon",className:"absolute bottom-4 right-14 z-20 h-8 w-8 rounded-full shadow-md bg-background/80 backdrop-blur-sm hover:bg-muted",onClick:()=>m(!h),"aria-label":h?"Disable follow stream":"Enable follow stream",children:h?f.jsx(_ge,{className:"h-4 w-4"}):f.jsx(kge,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"left",children:h?"Stop Following Stream":"Follow Stream"})]})})]})})},b$e=Ve.memo(y$e),d0=({controls:e,panelId:t,renderMode:n="full",className:r})=>{const s=e.filter(i=>(i.panel??"main")===t&&(i.show?i.show():!0));return s.length===0?null:f.jsx("div",{className:Ze(r),children:s.map(i=>{const a=n==="icon"?i.iconRenderer:i.renderer;return f.jsx(Ve.Fragment,{children:a?a():null},i.id)})})},Xw=Wo(Ho((e,t)=>({isChatControlPanelOpen:{},isPromptControlPanelOpen:{},isSidebarCollapsed:!1,globalLoading:!1,globalError:null,focusInputOnNextRender:!1,toggleChatControlPanel:(n,r)=>{const s=t().isChatControlPanelOpen[n]??!1,i=r??!s;s!==i&&(e(a=>{a.isChatControlPanelOpen[n]=i}),Re.emit(Tr.chatControlPanelVisibilityChanged,{panelId:n,isOpen:i}))},togglePromptControlPanel:(n,r)=>{const s=t().isPromptControlPanelOpen[n]??!1,i=r??!s;s!==i&&(e(a=>{a.isPromptControlPanelOpen[n]=i}),Re.emit(Tr.promptControlPanelVisibilityChanged,{controlId:n,isOpen:i}))},toggleSidebar:n=>{const r=t().isSidebarCollapsed,s=n??!r;r!==s&&(e({isSidebarCollapsed:s}),Re.emit(Tr.sidebarVisibilityChanged,{isCollapsed:s}))},setGlobalLoading:n=>{t().globalLoading!==n&&(e({globalLoading:n}),Re.emit(Tr.globalLoadingChanged,{loading:n}))},setGlobalError:n=>{t().globalError!==n&&(e({globalError:n}),Re.emit(Tr.globalErrorChanged,{error:n}))},setFocusInputFlag:n=>{t().focusInputOnNextRender!==n&&(e({focusInputOnNextRender:n}),Re.emit(Tr.focusInputFlagChanged,{focus:n}))},getRegisteredActionHandlers:()=>{const n="uiStateStore",r=t();return[{eventName:Tr.toggleSidebarRequest,handler:s=>r.toggleSidebar(s==null?void 0:s.isCollapsed),storeId:n},{eventName:Tr.toggleChatControlPanelRequest,handler:s=>r.toggleChatControlPanel(s.panelId,s.isOpen),storeId:n},{eventName:Tr.togglePromptControlPanelRequest,handler:s=>r.togglePromptControlPanel(s.controlId,s.isOpen),storeId:n},{eventName:Tr.setGlobalLoadingRequest,handler:s=>r.setGlobalLoading(s.loading),storeId:n},{eventName:Tr.setGlobalErrorRequest,handler:s=>r.setGlobalError(s.error),storeId:n},{eventName:Tr.setFocusInputFlagRequest,handler:s=>r.setFocusInputFlag(s.focus),storeId:n}]}})));var v$e=(e,t,n,r,s,i,a,o)=>{let l=document.documentElement,c=["light","dark"];function u(m){(Array.isArray(e)?e:[e]).forEach(y=>{let b=y==="class",v=b&&i?s.map(x=>i[x]||x):s;b?(l.classList.remove(...v),l.classList.add(i&&i[m]?i[m]:m)):l.setAttribute(y,m)}),d(m)}function d(m){o&&c.includes(m)&&(l.style.colorScheme=m)}function h(){return window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light"}if(r)u(r);else try{let m=localStorage.getItem(t)||n,y=a&&m==="system"?h():m;u(y)}catch{}},x$e=E.createContext(void 0),w$e={setTheme:e=>{},themes:[]},_$e=()=>{var e;return(e=E.useContext(x$e))!=null?e:w$e};E.memo(({forcedTheme:e,storageKey:t,attribute:n,enableSystem:r,enableColorScheme:s,defaultTheme:i,value:a,themes:o,nonce:l,scriptProps:c})=>{let u=JSON.stringify([n,t,i,e,o,a,r,s]).slice(1,-1);return E.createElement("script",{...c,suppressHydrationWarning:!0,nonce:typeof window>"u"?l:"",dangerouslySetInnerHTML:{__html:`(${v$e.toString()})(${u})`}})});const S$e=({...e})=>{const{theme:t="system"}=_$e();return f.jsx(aye,{theme:t,className:"toaster group",style:{"--normal-bg":"var(--popover)","--normal-text":"var(--popover-foreground)","--normal-border":"var(--border)"},...e})};function qa({className:e,...t}){return f.jsx("textarea",{"data-slot":"textarea",className:Ze("border-input placeholder:text-muted-foreground focus-visible:border-ring focus-visible:ring-ring/50 aria-invalid:ring-destructive/20 dark:aria-invalid:ring-destructive/40 aria-invalid:border-destructive dark:bg-input/30 flex field-sizing-content min-h-16 w-full rounded-md border bg-transparent px-3 py-2 text-base shadow-xs transition-[color,box-shadow] outline-none focus-visible:ring-[3px] disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",e),...t})}const wne=E.memo(E.forwardRef(({initialValue:e="",onSubmit:t,disabled:n,placeholder:r="Type message... (Shift+Enter for new line)",className:s,onValueChange:i,...a},o)=>{const l=E.useRef(null),[c,u]=E.useState(e);E.useImperativeHandle(o,()=>({getValue:()=>c,setValue:m=>{u(m),i&&i(m),Re.emit(sn.inputChanged,{value:m}),requestAnimationFrame(()=>{const y=l.current;y&&(y.style.height="auto",y.style.height=`${y.scrollHeight}px`,y.style.overflowY=y.scrollHeight>250?"auto":"hidden")})},focus:()=>{var m;return(m=l.current)==null?void 0:m.focus()},clearValue:()=>{u(""),i&&i(""),Re.emit(sn.inputChanged,{value:""}),requestAnimationFrame(()=>{const m=l.current;m&&(m.style.height="auto",m.style.height=`${m.scrollHeight}px`,m.style.overflowY="hidden")})}}));const d=m=>{var y;if(m.key==="Enter"&&!m.shiftKey&&!n){m.preventDefault();const b=Nh.getState().attachedFilesMetadata.length>0;(c.trim().length>0||b)&&(t(),(y=o==null?void 0:o.current)==null||y.clearValue())}},h=m=>{const y=m.target.value;u(y),i&&i(y),Re.emit(sn.inputChanged,{value:y})};return E.useEffect(()=>{const m=l.current;if(m){m.style.height="auto";const y=m.scrollHeight,b=250;m.style.height=`${Math.min(y,b)}px`,m.style.overflowY=y>b?"auto":"hidden"}},[c]),E.useEffect(()=>{e!==c&&(u(e),i&&i(e))},[e,i]),E.useEffect(()=>{const m=y=>{u(y.text),i&&i(y.text),Re.emit(sn.inputChanged,{value:y.text}),requestAnimationFrame(()=>{const b=l.current;b&&(b.style.height="auto",b.style.height=`${b.scrollHeight}px`,b.style.overflowY=b.scrollHeight>250?"auto":"hidden")})};return Re.on(sn.setInputTextRequest,m),()=>{Re.off(sn.setInputTextRequest,m)}},[i]),f.jsx(qa,{ref:l,value:c,onChange:h,onKeyDown:d,disabled:n,placeholder:r,rows:1,className:Ze("w-full p-3 border rounded bg-input text-foreground resize-none focus:ring-2 focus:ring-primary outline-none disabled:opacity-50 overflow-y-auto","min-h-[40px] max-h-[250px]",s),"aria-label":"Chat input",...a})}));wne.displayName="InputArea";const Ai={dbModsLoaded:"mod.db.mods.loaded",loadedInstancesChanged:"mod.loaded.instances.changed",settingsTabsChanged:"mod.settings.tabs.changed",loadingStateChanged:"mod.loading.state.changed",modLoaded:"mod.sdk.loaded",modError:"mod.sdk.error",loadDbModsRequest:"mod.load.db.mods.request",addDbModRequest:"mod.add.db.mod.request",updateDbModRequest:"mod.update.db.mod.request",deleteDbModRequest:"mod.delete.db.mod.request"},Wh=Wo(Ho((e,t)=>({dbMods:[],loadedMods:[],modSettingsTabs:[],isLoading:!1,error:null,loadDbMods:async()=>{e({isLoading:!0,error:null});try{const n=await bt.loadMods();e({dbMods:n,isLoading:!1}),Re.emit(Ai.dbModsLoaded,{dbMods:n})}catch(n){const r="Failed to load mods";console.error("ModStore: Error loading mods",n),e({error:r,isLoading:!1}),Re.emit(Ai.loadingStateChanged,{isLoading:!1,error:r}),Te.error(r)}},addDbMod:async n=>{const r=qr(),s={id:r,createdAt:new Date,...n,loadOrder:n.loadOrder??Date.now()};e(i=>{i.dbMods.push(s),i.dbMods.sort((a,o)=>a.loadOrder-o.loadOrder)});try{return await bt.saveMod(s),Te.success(`Mod "${s.name}" added.`),Re.emit(Ai.dbModsLoaded,{dbMods:t().dbMods}),r}catch(i){const a="Failed to save new mod";throw console.error("ModStore: Error adding mod",i),e(o=>{o.dbMods=o.dbMods.filter(l=>l.id!==r),o.error=a}),Re.emit(Ai.loadingStateChanged,{isLoading:t().isLoading,error:a}),Te.error(a),i}},updateDbMod:async(n,r)=>{let s,i=-1;e(o=>{i=o.dbMods.findIndex(l=>l.id===n),i!==-1?(s={...o.dbMods[i]},o.dbMods[i]={...o.dbMods[i],...r},r.loadOrder!==void 0&&o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder)):console.warn(`ModStore: Mod ${n} not found for update.`)});const a=i!==-1?t().dbMods[i]:void 0;if(a)try{await bt.saveMod(a),Te.success(`Mod "${a.name}" updated.`),Re.emit(Ai.dbModsLoaded,{dbMods:t().dbMods})}catch(o){const l="Failed to save mod update";throw console.error("ModStore: Error updating mod",o),e(c=>{const u=c.dbMods.findIndex(d=>d.id===n);u!==-1&&s&&(c.dbMods[u]=s,c.dbMods.sort((d,h)=>d.loadOrder-h.loadOrder)),c.error=l}),Re.emit(Ai.loadingStateChanged,{isLoading:t().isLoading,error:l}),Te.error(l),o}},deleteDbMod:async n=>{const r=t().dbMods.find(i=>i.id===n);if(!r){console.warn(`ModStore: Mod ${n} not found for deletion.`);return}const s=r.name;e(i=>({dbMods:i.dbMods.filter(a=>a.id!==n)}));try{await bt.deleteMod(n),Te.success(`Mod "${s}" deleted.`),Re.emit(Ai.dbModsLoaded,{dbMods:t().dbMods})}catch(i){const a="Failed to delete mod";throw console.error("ModStore: Error deleting mod",i),e(o=>{o.dbMods.push(r),o.dbMods.sort((l,c)=>l.loadOrder-c.loadOrder),o.error=a}),Re.emit(Ai.loadingStateChanged,{isLoading:t().isLoading,error:a}),Te.error(a),i}},setLoadedMods:n=>{e({loadedMods:n}),Re.emit(Ai.loadedInstancesChanged,{loadedMods:n})},_addSettingsTab:n=>{e(r=>{if(!r.modSettingsTabs.some(s=>s.id===n.id))r.modSettingsTabs.push(n),r.modSettingsTabs.sort((s,i)=>(s.order??999)-(i.order??999));else{console.warn(`ModStore: Settings tab with ID "${n.id}" already registered. Overwriting.`);const s=r.modSettingsTabs.findIndex(i=>i.id===n.id);r.modSettingsTabs[s]=n,r.modSettingsTabs.sort((i,a)=>(i.order??999)-(a.order??999))}}),Re.emit(Ai.settingsTabsChanged,{tabs:t().modSettingsTabs})},_removeSettingsTab:n=>{e(r=>{r.modSettingsTabs=r.modSettingsTabs.filter(s=>s.id!==n)}),Re.emit(Ai.settingsTabsChanged,{tabs:t().modSettingsTabs})},getRegisteredActionHandlers:()=>{const n="modStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:Ai.loadDbModsRequest,handler:r.loadDbMods,storeId:n},{eventName:Ai.addDbModRequest,handler:s(r.addDbMod),storeId:n},{eventName:Ai.updateDbModRequest,handler:i=>r.updateDbMod(i.id,i.changes),storeId:n},{eventName:Ai.deleteDbModRequest,handler:i=>r.deleteDbMod(i.id),storeId:n}]}}))),pp={loaded:"app.loaded",errorBoundaryTriggered:"app.error.boundary.triggered",initializationPhaseCompleted:"app.initialization.phase.completed"};function M4(e){const t=e.id,n=e.name;return{modId:t,modName:n,registerPromptControl:s=>(Re.emit(zr.registerPromptControlRequest,{control:s}),()=>Re.emit(zr.unregisterPromptControlRequest,{id:s.id})),registerChatControl:s=>{const i={...s,status:s.status??(()=>"ready")};return Re.emit(zr.registerChatControlRequest,{control:i}),()=>Re.emit(zr.unregisterChatControlRequest,{id:s.id})},registerCanvasControl:s=>(Re.emit(zr.registerCanvasControlRequest,{control:s}),()=>Re.emit(zr.unregisterCanvasControlRequest,{id:s.id})),registerBlockRenderer:s=>(Re.emit(w0.registerBlockRendererRequest,{renderer:s}),()=>Re.emit(w0.unregisterBlockRendererRequest,{id:s.id})),registerTool:(s,i,a)=>(console.log(`[${n}] Registering tool: ${s}`),Re.emit(zr.registerToolRequest,{modId:t,toolName:s,definition:i,implementation:a}),()=>Re.emit(zr.unregisterToolRequest,{toolName:s})),on:(s,i)=>(Re.on(s,i),()=>Re.off(s,i)),emit:(s,i)=>{Re.emit(s,i)},addMiddleware:(s,i)=>(Re.emit(zr.registerMiddlewareRequest,{hookName:s,modId:t,callback:i}),()=>Re.emit(zr.unregisterMiddlewareRequest,{hookName:s,modId:t,callback:i})),registerSettingsTab:s=>(Wh.getState()._addSettingsTab(s),()=>Wh.getState()._removeSettingsTab(s.id)),getContextSnapshot:()=>{const s=un.getState(),i=Vn.getState(),a=pr.getState(),o=Qn.getState(),{providerId:l}=Ac(o.selectedModelId),c=i.selectedItemType==="conversation"?i.selectedItemId:null;return Object.freeze({selectedConversationId:c,interactions:Object.freeze(s.currentConversationId===c?s.interactions.map(u=>Object.freeze({...u})):[]),isStreaming:s.status==="streaming",selectedProviderId:l,selectedModelId:o.selectedModelId,activeSystemPrompt:a.globalSystemPrompt,temperature:a.temperature,maxTokens:a.maxTokens,theme:a.theme,gitUserName:a.gitUserName,gitUserEmail:a.gitUserEmail})},showToast:(s,i)=>{Te[s](`[Mod: ${n}] ${i}`)},log:(s,...i)=>{console[s](`[Mod: ${n}]`,...i)},registerModalProvider:(s,i)=>(Re.emit(zr.registerModalProviderRequest,{modalId:s,provider:i}),()=>Re.emit(zr.unregisterModalProviderRequest,{modalId:s})),getVfsInstance:async s=>ei.getState().initializeVFS(s,{force:!0})}}async function C$e(e){const t=e.filter(r=>r.enabled),n=await Promise.all(t.map(async r=>{let s=r.scriptContent,i=null,a=null;try{if(i=M4(r),r.sourceUrl){console.log(`[ModLoader] Fetching script for ${r.name} from ${r.sourceUrl}`);try{const c=await fetch(r.sourceUrl);if(!c.ok)throw new Error(`Failed to fetch mod script: ${c.status} ${c.statusText}`);s=await c.text(),console.log(`[ModLoader] Successfully fetched script for ${r.name}`)}catch(c){throw console.error(`[ModLoader] Error fetching script from ${r.sourceUrl}:`,c),c}}if(!s)throw new Error("Mod script content is empty.");new Function("modApi",s)(i),console.log(`[ModLoader] Successfully executed script for ${r.name}`)}catch(l){a=l instanceof Error?l:String(l),console.error(`[ModLoader] Error loading mod "${r.name}":`,l),Te.error(`Error loading mod "${r.name}": ${a instanceof Error?a.message:a}`)}i||(i=M4(r));const o={id:r.id,name:r.name,api:i,error:a};return Re.emit(o.error?Ai.modError:Ai.modLoaded,{id:r.id,name:r.name,error:o.error??"unknown error"}),o}));return Re.emit(pp.loaded,void 0),console.log(`[ModLoader] Finished processing ${n.length} mods.`),n}const vr={dataLoaded:"rules.data.loaded",ruleSaved:"rules.rule.saved",ruleDeleted:"rules.rule.deleted",tagSaved:"rules.tag.saved",tagDeleted:"rules.tag.deleted",linkSaved:"rules.link.saved",linkDeleted:"rules.link.deleted",loadingStateChanged:"rules.loading.state.changed",loadRulesAndTagsRequest:"rules.load.rules.and.tags.request",addRuleRequest:"rules.add.rule.request",updateRuleRequest:"rules.update.rule.request",deleteRuleRequest:"rules.delete.rule.request",addTagRequest:"rules.add.tag.request",updateTagRequest:"rules.update.tag.request",deleteTagRequest:"rules.delete.tag.request",linkTagToRuleRequest:"rules.link.tag.to.rule.request",unlinkTagFromRuleRequest:"rules.unlink.tag.from.rule.request"},bq=null;class k$e{static async applyBundledConfig(t){{console.log("[BundledConfig] No bundled user configuration found, skipping...");return}}static hasBundledConfig(){return bq!==null}static getBundledConfig(){return bq}}class Jw{static async syncAll(t={}){const n={syncRepos:!0,syncConversations:!0,continueOnError:!0,maxConcurrent:3,...t};if(this.isRunning){Te.warning("Bulk sync already in progress");return}this.isRunning=!0,this.abortController=new AbortController;const r=Vn.getState(),s=r.syncRepos,i=r.conversations.filter(o=>o.syncRepoId),a={totalRepos:n.syncRepos?s.length:0,completedRepos:0,totalConversations:n.syncConversations?i.length:0,completedConversations:0,currentOperation:"Starting bulk sync...",errors:[]};try{Re.emit(ds.bulkSyncStarted,{progress:a}),Te.info(`Starting bulk sync: ${s.length} repositories, ${i.length} conversations`),n.syncRepos&&s.length>0&&await this.syncRepositoriesInBatches(s,n,a),n.syncConversations&&i.length>0&&await this.syncConversationsInBatches(i,n,a);const o=a.errors.length>0;Re.emit(ds.bulkSyncCompleted,{progress:a,success:!o}),o?(Te.warning(`Bulk sync completed with ${a.errors.length} errors. Check console for details.`),console.warn("Bulk sync errors:",a.errors)):Te.success("Bulk sync completed successfully!")}catch(o){console.error("Bulk sync failed:",o),Te.error(`Bulk sync failed: ${o instanceof Error?o.message:"Unknown error"}`),Re.emit(ds.bulkSyncFailed,{progress:a,error:String(o)})}finally{this.isRunning=!1,this.abortController=null}}static async syncPendingConversations(){const t=Vn.getState(),n=t.conversations.filter(r=>{const s=t.conversationSyncStatus[r.id];return r.syncRepoId&&s==="needs-sync"});if(n.length===0){Te.info("No conversations need syncing");return}Te.info(`Syncing ${n.length} pending conversations...`),await this.syncAll({syncRepos:!1,syncConversations:!0,continueOnError:!0,maxConcurrent:2})}static async initializeAllRepositories(){const n=Vn.getState().syncRepos;if(n.length===0){Te.info("No repositories configured");return}Te.info(`Initializing ${n.length} repositories...`),await this.syncAll({syncRepos:!0,syncConversations:!1,continueOnError:!0,maxConcurrent:2})}static abort(){this.isRunning&&this.abortController&&(this.abortController.abort(),Te.info("Bulk sync operation cancelled"))}static isActive(){return this.isRunning}static async syncRepositoriesInBatches(t,n,r){var i;r.currentOperation="Initializing repositories...",Re.emit(ds.bulkSyncProgress,{progress:r});const s=this.createBatches(t,n.maxConcurrent);for(const a of s){if((i=this.abortController)!=null&&i.signal.aborted)throw new Error("Operation cancelled");const o=a.map(async l=>{try{r.currentOperation=`Syncing repository: ${l.name}`,Re.emit(ds.bulkSyncProgress,{progress:r}),await Vn.getState().initializeOrSyncRepo(l.id,!0),r.completedRepos++}catch(c){const u=c instanceof Error?c.message:String(c);if(r.errors.push({type:"repo",id:l.id,error:u}),console.error(`Failed to sync repository ${l.name}:`,c),!n.continueOnError)throw c}});await Promise.all(o),Re.emit(ds.bulkSyncProgress,{progress:r})}}static async syncConversationsInBatches(t,n,r){var i;r.currentOperation="Syncing conversations...",Re.emit(ds.bulkSyncProgress,{progress:r});const s=this.createBatches(t,n.maxConcurrent);for(const a of s){if((i=this.abortController)!=null&&i.signal.aborted)throw new Error("Operation cancelled");const o=a.map(async l=>{try{r.currentOperation=`Syncing conversation: ${l.title}`,Re.emit(ds.bulkSyncProgress,{progress:r}),await Vn.getState().syncConversation(l.id,!0),r.completedConversations++}catch(c){const u=c instanceof Error?c.message:String(c);if(r.errors.push({type:"conversation",id:l.id,error:u}),console.error(`Failed to sync conversation ${l.title}:`,c),!n.continueOnError)throw c}});await Promise.all(o),Re.emit(ds.bulkSyncProgress,{progress:r})}}static createBatches(t,n){const r=[];for(let s=0;s<t.length;s+=n)r.push(t.slice(s,s+n));return r}}ue(Jw,"isRunning",!1),ue(Jw,"abortController",null);const U0=Object.freeze(Object.defineProperty({__proto__:null,BulkSyncService:Jw},Symbol.toStringTag,{value:"Module"}));class _ne{static async runStartupSync(){if(!this.hasRunStartupSync){this.hasRunStartupSync=!0;try{const t=Vn.getState(),n=pr.getState();await new Promise(o=>setTimeout(o,1e3));const r=t.syncRepos,s=t.conversations.filter(o=>o.syncRepoId);if(r.length===0){console.log("[StartupSync] No repositories configured, skipping startup sync");return}console.log(`[StartupSync] Found ${r.length} repositories and ${s.length} synced conversations`);const i=r.filter(o=>{const l=t.repoInitializationStatus[o.id];return!l||l==="error"});i.length>0&&n.autoInitializeReposOnStartup?(console.log(`[StartupSync] Initializing ${i.length} repositories in background`),setTimeout(async()=>{try{await Jw.syncAll({syncRepos:!0,syncConversations:!1,continueOnError:!0,maxConcurrent:1})}catch(o){console.warn("[StartupSync] Background repo initialization failed:",o)}},2e3)):i.length>0&&console.log(`[StartupSync] Found ${i.length} uninitialized repositories, but auto-initialization is disabled`);const a=s.filter(o=>t.conversationSyncStatus[o.id]==="needs-sync");a.length>0&&n.autoSyncOnStreamComplete&&(console.log(`[StartupSync] Found ${a.length} conversations pending sync`),setTimeout(async()=>{try{await Jw.syncPendingConversations()}catch(o){console.warn("[StartupSync] Background conversation sync failed:",o)}},5e3))}catch(t){console.error("[StartupSync] Startup sync failed:",t)}}}static reset(){this.hasRunStartupSync=!1}}ue(_ne,"hasRunStartupSync",!1);function E$e(e){const t=new Map(e.map(a=>[a.id,a])),n=new Set,r=new Set,s=[];function i(a){if(n.has(a.id))return!0;if(r.has(a.id))return console.error(`[Init] Circular dependency detected involving module: ${a.id}`),Te.error("Initialization Error: Circular dependency in controls."),!1;r.add(a.id);for(const o of a.dependencies??[]){const l=t.get(o);if(!l)return console.error(`[Init] Missing dependency "${o}" for module "${a.id}"`),Te.error(`Initialization Error: Missing dependency "${o}" for "${a.id}".`),r.delete(a.id),!1;if(!i(l))return r.delete(a.id),!1}return r.delete(a.id),n.add(a.id),s.push(a),!0}for(const a of e)if(!n.has(a.id)&&!i(a))return null;return s}async function T$e(e,t){console.log("[Init] Core Data: Applying bundled configuration..."),await k$e.applyBundledConfig(),console.log("[Init] Core Data: Requesting loads..."),t.emit(an.loadSettingsRequest,void 0),t.emit(Wn.loadInitialDataRequest,void 0),t.emit(vr.loadRulesAndTagsRequest,void 0),t.emit(er.loadConversationsRequest,void 0),t.emit(Sa.loadProjectsRequest,void 0),await new Promise(n=>{let r=!1,s=!1,i=!1,a=!1,o=!1;const l=()=>{r&&s&&i&&a&&o&&n()},c=t.on(an.loaded,()=>{r=!0,c(),l()}),u=t.on(Wn.initialDataLoaded,()=>{s=!0,u(),l()}),d=t.on(vr.dataLoaded,()=>{i=!0,d(),l()}),h=t.on(er.conversationsLoaded,()=>{a=!0,h(),l()}),m=t.on(Sa.loaded,()=>{o=!0,m(),l()})}),Re.emit(pp.initializationPhaseCompleted,{phase:"coreData"}),console.log("[Init] Core Data: Loaded (or load requested)."),setTimeout(()=>{_ne.runStartupSync().catch(n=>{console.warn("[Init] Startup sync failed:",n)})},1e3)}async function A$e(e,t){console.log("[Init] Control Modules: Instantiation & Dependency Resolution START");const n=e.map(s=>new s),r=E$e(n);if(!r)throw console.error("[Init] Control Modules: Dependency resolution FAILED."),new Error("Failed to resolve control module dependency order.");console.log(`[Init] Control Modules: Dependency order resolved (${r.length} modules):`,r.map(s=>s.id)),console.log("[Init] Control Modules: Instantiation & Dependency Resolution COMPLETE"),console.log("[Init] Control Modules: Initialization START");for(const s of r)try{await s.initialize(t)}catch(i){console.error(`[Init] Error initializing module "${s.id}":`,i),Te.error(`Module Init Error (${s.id}): ${i instanceof Error?i.message:String(i)}`)}return Re.emit(pp.initializationPhaseCompleted,{phase:"controlModulesInit"}),console.log("[Init] Control Modules: Initialization COMPLETE."),r}function R$e(e,t){console.log("[Init] Control Modules: Registration START");for(const n of e)try{n.register(t)}catch(r){console.error(`[Init] Error registering module "${n.id}":`,r),Te.error(`Module Registration Error (${n.id}): ${r instanceof Error?r.message:String(r)}`)}Re.emit(pp.initializationPhaseCompleted,{phase:"controlModulesRegister"}),console.log("[Init] Control Modules: Registration COMPLETE.")}async function N$e(e,t){console.log("[Init] External Mods: Loading DB records..."),t.emit(Ai.loadDbModsRequest,void 0),await new Promise(s=>{const i=t.on(Ai.dbModsLoaded,()=>{i(),s()})});const n=Wh.getState().dbMods;console.log(`[Init] External Mods: Processing ${n.length} mods...`);const r=await C$e(n);Wh.getState().setLoadedMods(r),Re.emit(pp.initializationPhaseCompleted,{phase:"externalMods"}),console.log(`[Init] External Mods: ${r.length} mods processed.`)}function M$e(e,t){var a;console.log("[Init] Core UI States: Initializing...");const n=e.selectedItemId,r=e.selectedItemType,s=r==="project"?n:r==="conversation"?((a=e.getConversationById(n))==null?void 0:a.projectId)??null:null,i=e.getEffectiveProjectSettings(s);t.emit(sn.initializePromptStateRequest,{effectiveSettings:i}),Re.emit(pp.initializationPhaseCompleted,{phase:"uiStateSync"}),console.log("[Init] Core UI States: Initial prompt state synchronization requested.")}async function I$e(e,t){console.log("[Init] LiteChat Full Initialization START"),Sc.initializeCanvasEventHandlers();const n={requestLoadSettings:()=>t.emit(an.loadSettingsRequest,void 0),requestLoadProviderData:()=>t.emit(Wn.loadInitialDataRequest,void 0),requestLoadRulesAndTags:()=>t.emit(vr.loadRulesAndTagsRequest,void 0),requestLoadConversations:()=>t.emit(er.loadConversationsRequest,void 0),requestLoadProjects:()=>t.emit(Sa.loadProjectsRequest,void 0),requestLoadDbMods:()=>t.emit(Ai.loadDbModsRequest,void 0),setLoadedMods:Wh.getState().setLoadedMods,getConversationById:Vn.getState().getConversationById,getEffectiveProjectSettings:yl.getState().getEffectiveProjectSettings,initializePromptState:Yl.getState().initializePromptState,selectedItemId:Vn.getState().selectedItemId,selectedItemType:Vn.getState().selectedItemType};let r=[];try{await T$e(n,t),r=await A$e(e,t),R$e(r,t),await N$e(n,t),M$e(n,t),Re.emit(pp.initializationPhaseCompleted,{phase:"all"}),console.log("LiteChat: Full initialization sequence COMPLETE.")}catch(s){throw console.error("LiteChat: Full initialization sequence FAILED:",s),Te.error(`Initialization sequence failed: ${s instanceof Error?s.message:String(s)}`),Xw.getState().setGlobalError("Initialization sequence failed."),s}return r}const Sne=Wo(Ho((e,t)=>({rules:[],tags:[],tagRuleLinks:[],isLoading:!1,error:null,loadRulesAndTags:async()=>{e({isLoading:!0,error:null});try{const[n,r,s]=await Promise.all([bt.loadRules(),bt.loadTags(),bt.loadTagRuleLinks()]);e({rules:n,tags:r,tagRuleLinks:s,isLoading:!1}),Re.emit(vr.dataLoaded,{rules:n,tags:r,links:s})}catch(n){console.error("RulesStore: Error loading rules and tags",n),e({error:"Failed load rules/tags",isLoading:!1}),Te.error("Failed to load rules and tags."),Re.emit(vr.loadingStateChanged,{isLoading:!1,error:"Failed load rules/tags"})}},addRule:async n=>{const r=qr(),s=new Date,i={id:r,createdAt:s,updatedAt:s,...n};e(a=>{a.rules.push(i),a.rules.sort((o,l)=>o.name.localeCompare(l.name))});try{await bt.saveRule(i),Te.success(`Rule "${i.name}" added.`),Re.emit(vr.ruleSaved,{rule:i});const{rules:a,tags:o,tagRuleLinks:l}=t();return Re.emit(vr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding rule",a),e(o=>({error:"Failed to save new rule",rules:o.rules.filter(l=>l.id!==r)})),Te.error("Failed to save new rule."),a}},updateRule:async(n,r)=>{const s=t().rules.find(a=>a.id===n);if(!s)throw Te.error("Rule not found for update."),new Error("Rule not found");const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.rules.findIndex(l=>l.id===n);o!==-1&&(a.rules[o]=i,a.rules.sort((l,c)=>l.name.localeCompare(c.name)))});try{await bt.saveRule(i),Te.success(`Rule "${i.name}" updated.`),Re.emit(vr.ruleSaved,{rule:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Re.emit(vr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating rule",a),e(o=>{const l=o.rules.findIndex(c=>c.id===n);l!==-1&&(o.rules[l]=s,o.rules.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save rule update"}),Te.error("Failed to save rule update."),a}},deleteRule:async n=>{const r=t().rules.find(a=>a.id===n);if(!r)throw Te.error("Rule not found for deletion."),new Error("Rule not found");const s=[...t().tagRuleLinks.filter(a=>a.ruleId===n)],i={...r};e(a=>{a.rules=a.rules.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.ruleId!==n)});try{await bt.deleteRule(n),Te.success(`Rule "${r.name}" deleted.`),Re.emit(vr.ruleDeleted,{ruleId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();Re.emit(vr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting rule",a),e(o=>{o.rules.find(l=>l.id===i.id)||(o.rules.push(i),o.rules.sort((l,c)=>l.name.localeCompare(c.name))),s.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete rule"}),Te.error("Failed to delete rule."),a}},addTag:async n=>{const r=qr(),s=new Date,i={id:r,createdAt:s,updatedAt:s,...n};e(a=>{a.tags.push(i),a.tags.sort((o,l)=>o.name.localeCompare(l.name))});try{await bt.saveTag(i),Te.success(`Tag "${i.name}" added.`),Re.emit(vr.tagSaved,{tag:i});const{rules:a,tags:o,tagRuleLinks:l}=t();return Re.emit(vr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]}),r}catch(a){throw console.error("RulesStore: Error adding tag",a),e(o=>({error:"Failed to save new tag",tags:o.tags.filter(l=>l.id!==r)})),Te.error("Failed to save new tag."),a}},updateTag:async(n,r)=>{const s=t().tags.find(a=>a.id===n);if(!s)throw Te.error("Tag not found for update."),new Error("Tag not found");const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.tags.findIndex(l=>l.id===n);o!==-1&&(a.tags[o]=i,a.tags.sort((l,c)=>l.name.localeCompare(c.name)))});try{await bt.saveTag(i),Te.success(`Tag "${i.name}" updated.`),Re.emit(vr.tagSaved,{tag:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Re.emit(vr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error updating tag",a),e(o=>{const l=o.tags.findIndex(c=>c.id===n);l!==-1&&(o.tags[l]=s,o.tags.sort((c,u)=>c.name.localeCompare(u.name))),o.error="Failed to save tag update"}),Te.error("Failed to save tag update."),a}},deleteTag:async n=>{const r=t().tags.find(a=>a.id===n);if(!r)throw Te.error("Tag not found for deletion."),new Error("Tag not found");const s={...r},i=[...t().tagRuleLinks.filter(a=>a.tagId===n)];e(a=>{a.tags=a.tags.filter(o=>o.id!==n),a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.tagId!==n)});try{await bt.deleteTag(n),Te.success(`Tag "${r.name}" deleted.`),Re.emit(vr.tagDeleted,{tagId:n});const{rules:a,tags:o,tagRuleLinks:l}=t();Re.emit(vr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error deleting tag",a),e(o=>{o.tags.find(l=>l.id===s.id)||(o.tags.push(s),o.tags.sort((l,c)=>l.name.localeCompare(c.name))),i.forEach(l=>{o.tagRuleLinks.find(c=>c.tagId===l.tagId&&c.ruleId===l.ruleId)||o.tagRuleLinks.push(l)}),o.error="Failed to delete tag"}),Te.error("Failed to delete tag."),a}},linkTagToRule:async(n,r)=>{const s=`${n}-${r}`;if(t().tagRuleLinks.some(a=>a.id===s)){Te.info("Link already exists.");return}const i={id:s,tagId:n,ruleId:r};e(a=>{a.tagRuleLinks.push(i)});try{await bt.saveTagRuleLink(i),Te.success("Tag linked to rule."),vr.linkSaved&&Re.emit(vr.linkSaved,{link:i});const{rules:a,tags:o,tagRuleLinks:l}=t();Re.emit(vr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error linking tag to rule",a),e(o=>{o.tagRuleLinks=o.tagRuleLinks.filter(l=>l.id!==s),o.error="Failed to link tag to rule"}),Te.error("Failed to link tag to rule."),a}},unlinkTagFromRule:async(n,r)=>{const s=`${n}-${r}`,i=t().tagRuleLinks.find(a=>a.id===s);i||Te.info("Link not found for unlinking."),e(a=>{a.tagRuleLinks=a.tagRuleLinks.filter(o=>o.id!==s)});try{await bt.deleteTagRuleLink(s),Te.success("Tag unlinked from rule."),vr.linkDeleted&&Re.emit(vr.linkDeleted,{linkId:s});const{rules:a,tags:o,tagRuleLinks:l}=t();Re.emit(vr.dataLoaded,{rules:[...a],tags:[...o],links:[...l]})}catch(a){throw console.error("RulesStore: Error unlinking tag from rule",a),i&&e(o=>{o.tagRuleLinks.some(l=>l.id===i.id)||o.tagRuleLinks.push(i),o.error="Failed to unlink tag from rule"}),Te.error("Failed to unlink tag from rule."),a}},getRulesForTag:n=>{const r=t(),s=new Set(r.tagRuleLinks.filter(i=>i.tagId===n).map(i=>i.ruleId));return r.rules.filter(i=>s.has(i.id))},getTagsForRule:n=>{const r=t(),s=new Set(r.tagRuleLinks.filter(i=>i.ruleId===n).map(i=>i.tagId));return r.tags.filter(i=>s.has(i.id))},getRuleById:n=>t().rules.find(r=>r.id===n),getTagById:n=>t().tags.find(r=>r.id===n),getRulesByIds:n=>{const r=new Set(n);return t().rules.filter(s=>r.has(s.id))},getRegisteredActionHandlers:()=>{const n="rulesStore",r=t(),s=i=>async a=>{await i(a)};return[{eventName:vr.loadRulesAndTagsRequest,handler:r.loadRulesAndTags,storeId:n},{eventName:vr.addRuleRequest,handler:s(r.addRule),storeId:n},{eventName:vr.updateRuleRequest,handler:i=>r.updateRule(i.id,i.updates),storeId:n},{eventName:vr.deleteRuleRequest,handler:i=>r.deleteRule(i.id),storeId:n},{eventName:vr.addTagRequest,handler:s(r.addTag),storeId:n},{eventName:vr.updateTagRequest,handler:i=>r.updateTag(i.id,i.updates),storeId:n},{eventName:vr.deleteTagRequest,handler:i=>r.deleteTag(i.id),storeId:n},{eventName:vr.linkTagToRuleRequest,handler:i=>r.linkTagToRule(i.tagId,i.ruleId),storeId:n},{eventName:vr.unlinkTagFromRuleRequest,handler:i=>r.unlinkTagFromRule(i.tagId,i.ruleId),storeId:n}]}}))),to={promptTemplatesChanged:"prompt-template.prompts.changed",promptTemplateAdded:"prompt-template.added",promptTemplateUpdated:"prompt-template.updated",promptTemplateDeleted:"prompt-template.deleted",loadPromptTemplatesRequest:"prompt-template.load.request",addPromptTemplateRequest:"prompt-template.add.request",updatePromptTemplateRequest:"prompt-template.update.request",deletePromptTemplateRequest:"prompt-template.delete.request",selectPromptTemplateRequest:"prompt-template.select.request",compilePromptTemplateRequest:"prompt-template.compile.request"},Om=Wo(Ho((e,t)=>({promptTemplates:[],loading:!1,error:null,loadPromptTemplates:async()=>{e(n=>{n.loading=!0,n.error=null});try{const n=await bt.loadPromptTemplates();e(r=>{r.promptTemplates=n,r.loading=!1}),Re.emit(to.promptTemplatesChanged,{promptTemplates:n})}catch(n){const r=n instanceof Error?n.message:"Failed to load prompt templates";e(s=>{s.error=r,s.loading=!1}),Te.error(r)}},addPromptTemplate:async n=>{const r={id:qr(),createdAt:new Date,updatedAt:new Date,...n};e(s=>{s.promptTemplates.push(r)});try{return await bt.savePromptTemplate(r),Re.emit(to.promptTemplateAdded,{promptTemplate:r}),Te.success("Prompt template created successfully"),r.id}catch(s){e(a=>{a.promptTemplates=a.promptTemplates.filter(o=>o.id!==r.id)});const i=s instanceof Error?s.message:"Failed to create prompt template";throw e(a=>{a.error=i}),Te.error(i),s}},updatePromptTemplate:async(n,r)=>{const s=t().promptTemplates.find(a=>a.id===n);if(!s){Te.error("Prompt template not found");return}const i={...s,...r,updatedAt:new Date};e(a=>{const o=a.promptTemplates.findIndex(l=>l.id===n);o!==-1&&(a.promptTemplates[o]=i)});try{await bt.savePromptTemplate(i),Re.emit(to.promptTemplateUpdated,{promptTemplate:i}),Te.success("Prompt template updated successfully")}catch(a){e(l=>{const c=l.promptTemplates.findIndex(u=>u.id===n);c!==-1&&(l.promptTemplates[c]=s)});const o=a instanceof Error?a.message:"Failed to update prompt template";throw e(l=>{l.error=o}),Te.error(o),a}},deletePromptTemplate:async n=>{const r=t().promptTemplates.find(s=>s.id===n);if(!r){Te.error("Prompt template not found");return}e(s=>{s.promptTemplates=s.promptTemplates.filter(i=>i.id!==n)});try{await bt.deletePromptTemplate(n),Re.emit(to.promptTemplateDeleted,{id:n}),Te.success("Prompt template deleted successfully")}catch(s){e(a=>{a.promptTemplates.push(r)});const i=s instanceof Error?s.message:"Failed to delete prompt template";throw e(a=>{a.error=i}),Te.error(i),s}},compilePromptTemplate:async(n,r)=>{const s=t().promptTemplates.find(i=>i.id===n);if(!s)throw new Error("Template not found");try{let i=s.prompt;for(const o of s.variables){const l=r[o.name],c=[new RegExp(`{{\\s*${o.name}\\s*}}`,"g"),new RegExp(`{{${o.name}}}`,"g"),new RegExp(`{{ ${o.name} }}`,"g")];if(l!=null){let u;typeof l=="object"?u=JSON.stringify(l):u=String(l);for(const d of c){const h=i;i=i.replace(d,u),h!==i&&console.log(`Replaced "${o.name}" using pattern ${d} in:`,h,"",i)}}else{if(o.required)throw new Error(`Required variable "${o.name}" is missing`);if(o.default)for(const u of c)i=i.replace(u,o.default)}}return{content:i,selectedTools:s.tools,selectedRules:s.rules}}catch(i){const a=i instanceof Error?i.message:"Failed to compile prompt template";throw Te.error(a),i}},getTemplatesByType:n=>t().promptTemplates.filter(r=>(r.type||"prompt")===n),getAgents:()=>t().promptTemplates.filter(n=>(n.type||"prompt")==="agent"),getTasksForAgent:n=>t().promptTemplates.filter(r=>(r.type||"prompt")==="task"&&r.parentId===n),getAvailableFollowUps:(n,r)=>{const s=t().promptTemplates,i=s.find(a=>a.id===n);return r==="task"&&(i!=null&&i.parentId)?s.filter(a=>(a.type||"prompt")==="task"&&a.parentId===i.parentId&&a.id!==n):s.filter(a=>(a.type||"prompt")==="prompt"&&a.id!==n)},getRegisteredActionHandlers:()=>{const n=t();return[{eventName:to.loadPromptTemplatesRequest,handler:()=>n.loadPromptTemplates(),storeId:"promptTemplateStore"},{eventName:to.addPromptTemplateRequest,handler:async r=>{await n.addPromptTemplate(r.promptTemplate)},storeId:"promptTemplateStore"},{eventName:to.updatePromptTemplateRequest,handler:r=>n.updatePromptTemplate(r.id,r.updates),storeId:"promptTemplateStore"},{eventName:to.deletePromptTemplateRequest,handler:r=>n.deletePromptTemplate(r.id),storeId:"promptTemplateStore"},{eventName:to.compilePromptTemplateRequest,handler:async r=>{await n.compilePromptTemplate(r.templateId,r.formData)},storeId:"promptTemplateStore"}]}}))),Er={serversChanged:"mcp.servers.changed",serverAdded:"mcp.server.added",serverUpdated:"mcp.server.updated",serverDeleted:"mcp.server.deleted",serverConnectionChanged:"mcp.server.connection.changed",toolsChanged:"mcp.tools.changed",retryAttemptsChanged:"mcp.retry.attempts.changed",retryDelayChanged:"mcp.retry.delay.changed",connectionTimeoutChanged:"mcp.connection.timeout.changed",maxResponseSizeChanged:"mcp.max.response.size.changed",bridgeConfigChanged:"mcp.bridge.config.changed",beforeToolCall:"mcp.tool.before.call",afterToolCall:"mcp.tool.after.call",toolCallFailed:"mcp.tool.call.failed",beforeToolExecution:"mcp.tool.before.execution",toolDiscovered:"mcp.tool.discovered",toolRegistered:"mcp.tool.registered",toolUnregistered:"mcp.tool.unregistered",setServersRequest:"mcp.set.servers.request",addServerRequest:"mcp.add.server.request",updateServerRequest:"mcp.update.server.request",deleteServerRequest:"mcp.delete.server.request",connectServerRequest:"mcp.connect.server.request",disconnectServerRequest:"mcp.disconnect.server.request",refreshToolsRequest:"mcp.refresh.tools.request",loadMcpStateRequest:"mcp.load.state.request",resetMcpStateRequest:"mcp.reset.state.request",setRetryAttemptsRequest:"mcp.set.retry.attempts.request",setRetryDelayRequest:"mcp.set.retry.delay.request",setConnectionTimeoutRequest:"mcp.set.connection.timeout.request",setMaxResponseSizeRequest:"mcp.set.max.response.size.request"},px=3,mx=2e3,gx=1e4,yx=128e3,j$e={servers:[],serverStatuses:{},loading:!1,error:null,retryAttempts:px,retryDelay:mx,connectionTimeout:gx,maxResponseSize:yx,bridgeConfig:{}},ll=Wo(Ho((e,t)=>({...j$e,setServers:n=>{e(r=>{r.servers=n,r.error=null}),bt.saveSetting("mcpServers",n).catch(r=>{console.error("Failed to persist MCP servers:",r)}),Re.emit(Er.serversChanged,{servers:n})},addServer:n=>{const r={...n,id:`mcp_${Date.now()}_${Math.random().toString(36).substr(2,9)}`};e(i=>{i.servers.push(r),i.error=null});const s=t().servers;bt.saveSetting("mcpServers",s).catch(i=>{console.error("Failed to persist MCP servers:",i)}),Re.emit(Er.serverAdded,{server:r}),Re.emit(Er.serversChanged,{servers:s})},updateServer:(n,r)=>{let s=null;if(e(i=>{const a=i.servers.findIndex(o=>o.id===n);a!==-1&&(i.servers[a]={...i.servers[a],...r},s=i.servers[a],i.error=null)}),s){const i=t().servers;bt.saveSetting("mcpServers",i).catch(a=>{console.error("Failed to persist MCP servers:",a)}),Re.emit(Er.serverUpdated,{server:s}),Re.emit(Er.serversChanged,{servers:i})}},deleteServer:n=>{e(s=>{s.servers=s.servers.filter(i=>i.id!==n),delete s.serverStatuses[n],s.error=null});const r=t().servers;bt.saveSetting("mcpServers",r).catch(s=>{console.error("Failed to persist MCP servers:",s)}),Re.emit(Er.serverDeleted,{serverId:n}),Re.emit(Er.serversChanged,{servers:r})},setServerStatus:n=>{e(r=>{r.serverStatuses[n.serverId]=n}),Re.emit(Er.serverConnectionChanged,{serverId:n.serverId,connected:n.connected,error:n.error}),n.tools.length>0&&Re.emit(Er.toolsChanged,{serverId:n.serverId,tools:n.tools})},clearServerStatus:n=>{e(r=>{delete r.serverStatuses[n]}),Re.emit(Er.serverConnectionChanged,{serverId:n,connected:!1})},setRetryAttempts:n=>{const r=Math.max(0,Math.min(10,n));e(s=>{s.retryAttempts=r}),bt.saveSetting("mcpRetryAttempts",r).catch(s=>{console.error("Failed to persist MCP retry attempts:",s)}),Re.emit(Er.retryAttemptsChanged,{attempts:r})},setRetryDelay:n=>{const r=Math.max(500,Math.min(3e4,n));e(s=>{s.retryDelay=r}),bt.saveSetting("mcpRetryDelay",r).catch(s=>{console.error("Failed to persist MCP retry delay:",s)}),Re.emit(Er.retryDelayChanged,{delay:r})},setConnectionTimeout:n=>{const r=Math.max(1e3,Math.min(6e4,n));e(s=>{s.connectionTimeout=r}),bt.saveSetting("mcpConnectionTimeout",r).catch(s=>{console.error("Failed to persist MCP connection timeout:",s)}),Re.emit(Er.connectionTimeoutChanged,{timeout:r})},setMaxResponseSize:n=>{const r=Math.max(1e3,Math.min(1e7,n));e(s=>{s.maxResponseSize=r}),bt.saveSetting("mcpMaxResponseSize",r).catch(s=>{console.error("Failed to persist MCP max response size:",s)}),Re.emit(Er.maxResponseSizeChanged,{size:r})},setBridgeConfig:n=>{e(r=>{r.bridgeConfig={...n}}),bt.saveSetting("mcpBridgeConfig",n).catch(r=>{console.error("Failed to persist MCP bridge config:",r)}),Re.emit(Er.bridgeConfigChanged,{config:n})},setLoading:n=>{e(r=>{r.loading=n})},setError:n=>{e(r=>{r.error=n})},loadMcpState:async()=>{try{e(l=>{l.loading=!0,l.error=null});const[n,r,s,i,a,o]=await Promise.all([bt.loadSetting("mcpServers",[]),bt.loadSetting("mcpRetryAttempts",px),bt.loadSetting("mcpRetryDelay",mx),bt.loadSetting("mcpConnectionTimeout",gx),bt.loadSetting("mcpMaxResponseSize",yx),bt.loadSetting("mcpBridgeConfig",{})]);e(l=>{l.servers=n||[],l.retryAttempts=r,l.retryDelay=s,l.connectionTimeout=i,l.maxResponseSize=a,l.bridgeConfig=o||{},l.loading=!1}),Re.emit(Er.serversChanged,{servers:n||[]}),Re.emit(Er.retryAttemptsChanged,{attempts:r}),Re.emit(Er.retryDelayChanged,{delay:s}),Re.emit(Er.connectionTimeoutChanged,{timeout:i}),Re.emit(Er.maxResponseSizeChanged,{size:a}),Re.emit(Er.bridgeConfigChanged,{config:o||{}})}catch(n){console.error("Failed to load MCP state:",n),e(r=>{r.error=n.message||"Failed to load MCP state",r.loading=!1})}},resetMcpState:()=>{e(n=>{n.servers=[],n.serverStatuses={},n.retryAttempts=px,n.retryDelay=mx,n.connectionTimeout=gx,n.maxResponseSize=yx,n.bridgeConfig={},n.loading=!1,n.error=null}),Promise.all([bt.saveSetting("mcpServers",[]),bt.saveSetting("mcpRetryAttempts",px),bt.saveSetting("mcpRetryDelay",mx),bt.saveSetting("mcpConnectionTimeout",gx),bt.saveSetting("mcpMaxResponseSize",yx)]).catch(n=>{console.error("Failed to clear MCP settings from storage:",n)}),Re.emit(Er.serversChanged,{servers:[]}),Re.emit(Er.retryAttemptsChanged,{attempts:px}),Re.emit(Er.retryDelayChanged,{delay:mx}),Re.emit(Er.connectionTimeoutChanged,{timeout:gx}),Re.emit(Er.maxResponseSizeChanged,{size:yx})},getRegisteredActionHandlers:()=>{const n=t();return[{eventName:Er.setServersRequest,handler:r=>n.setServers(r.servers),storeId:"mcpStore"},{eventName:Er.addServerRequest,handler:r=>n.addServer(r.server),storeId:"mcpStore"},{eventName:Er.updateServerRequest,handler:r=>n.updateServer(r.id,r.updates),storeId:"mcpStore"},{eventName:Er.deleteServerRequest,handler:r=>n.deleteServer(r.id),storeId:"mcpStore"},{eventName:Er.setRetryAttemptsRequest,handler:r=>n.setRetryAttempts(r.attempts),storeId:"mcpStore"},{eventName:Er.setRetryDelayRequest,handler:r=>n.setRetryDelay(r.delay),storeId:"mcpStore"},{eventName:Er.setConnectionTimeoutRequest,handler:r=>n.setConnectionTimeout(r.timeout),storeId:"mcpStore"},{eventName:Er.setMaxResponseSizeRequest,handler:r=>n.setMaxResponseSize(r.size),storeId:"mcpStore"},{eventName:Er.loadMcpStateRequest,handler:()=>n.loadMcpState(),storeId:"mcpStore"},{eventName:Er.resetMcpStateRequest,handler:()=>n.resetMcpState(),storeId:"mcpStore"}]},exportProxyConfig:()=>t().servers.map(r=>({id:r.id,name:r.name,url:r.url,enabled:r.enabled}))}))),P$e=[pr,Qn,Sne,Vn,yl,un,Nh,Yl,Wh,Xw,ei,Wi,Om,ll];class Cne{static initialize(){if(this.isInitialized){console.warn("[Coordinator] Already initialized. Skipping re-initialization.");return}console.log("[Coordinator] Initializing dynamic event listeners for action requests...");const t=[];P$e.forEach(n=>{const r=n.getState();if(r&&typeof r.getRegisteredActionHandlers=="function")try{const s=r.getRegisteredActionHandlers();Array.isArray(s)?t.push(...s):console.warn(`[Coordinator] getRegisteredActionHandlers for store did not return an array. Store ID: ${r.id||"Unknown"}`)}catch(s){console.error("[Coordinator] Error calling getRegisteredActionHandlers for a store:",s)}}),t.length===0?console.warn("[Coordinator] No action handlers were registered by any store."):t.forEach(n=>{n&&n.eventName&&typeof n.handler=="function"?Re.on(n.eventName,n.handler):console.error("[Coordinator] Invalid action handler structure encountered:",n)}),this.isInitialized=!0,console.log(`[Coordinator] Dynamic event listeners initialized. Total handlers: ${t.length}.`)}}ue(Cne,"isInitialized",!1);const O$e=()=>{const[e,t]=E.useState({}),n=Wi(r=>r.modalProviders);return E.useEffect(()=>{const r=i=>{t(a=>({...a,[i.modalId]:{...i,isOpen:!0}})),Re.emit(Tr.modalStateChanged,{...i,isOpen:!0})},s=i=>{t(a=>{const o={...a};return o[i.modalId]&&(o[i.modalId].isOpen=!1),o}),Re.emit(Tr.modalStateChanged,{modalId:i.modalId,isOpen:!1})};return Re.on(Tr.openModalRequest,r),Re.on(Tr.closeModalRequest,s),()=>{Re.off(Tr.openModalRequest,r),Re.off(Tr.closeModalRequest,s)}},[]),f.jsx(f.Fragment,{children:Object.entries(e).map(([r,s])=>{if(!s.isOpen)return null;const i=n[r];if(!i)return console.warn(`[ModalManager] No provider for modalId: ${r}`),null;const a={isOpen:!0,onClose:()=>Re.emit(Tr.closeModalRequest,{modalId:r}),modalProps:s.modalProps,targetId:s.targetId,initialTab:s.initialTab,initialSubTab:s.initialSubTab};return f.jsx(i,{...a},r)})})};let vq=[],xq=null,xd=!1;const D$e=({controls:e=[]})=>{const[t,n]=E.useState(!0),[r,s]=E.useState(!1),i=E.useRef(null),a=E.useRef(null),{selectedItemId:o,selectedItemType:l,getConversationById:c}=Vn(yn(I=>({selectedItemId:I.selectedItemId,selectedItemType:I.selectedItemType,getConversationById:I.getConversationById}))),{getEffectiveProjectSettings:u}=yl(yn(I=>({getEffectiveProjectSettings:I.getEffectiveProjectSettings}))),{interactions:d,status:h}=un(yn(I=>({interactions:I.interactions,status:I.status}))),{globalError:m,isSidebarCollapsed:y,isChatControlPanelOpen:b}=Xw(yn(I=>({globalError:I.globalError,isSidebarCollapsed:I.isSidebarCollapsed,isChatControlPanelOpen:I.isChatControlPanelOpen}))),v=Wi(yn(I=>Object.values(I.chatControls))),x=E.useMemo(()=>v.filter(I=>(I.panel??"main")==="sidebar"&&(I.show?I.show():!0)),[v]),w=E.useMemo(()=>v.filter(I=>I.panel==="sidebar-footer"&&(I.show?I.show():!0)),[v]),S=E.useMemo(()=>v.filter(I=>I.panel==="header"&&(I.show?I.show():!0)),[v]),k=E.useCallback(()=>{s(I=>!I)},[]);E.useEffect(()=>{r&&o&&(l==="conversation"||l==="project")&&s(!1)},[o,l]),E.useEffect(()=>{a.current||(a.current=M4({id:"core-litechat-app",name:"LiteChat App Core"}));const I=a.current;Cne.initialize(),xq||(xq=(async()=>{if(xd){n(!1);return}n(!0);try{vq=await I$e(e,I),xd=!0}catch(B){console.error("[LiteChat] App: Top-level initialization error:",B),xd=!1}finally{n(!1)}})().then(()=>vq))},[e]);const C=E.useRef({itemId:null,itemType:null,effectiveSettingsString:""});E.useEffect(()=>{if(t||!xd||!a.current)return;const I=a.current,O={itemId:o,itemType:l};let B=null;if(l==="project")B=o;else if(l==="conversation"&&o){const P=c(o);B=(P==null?void 0:P.projectId)??null}const D=u(B),H=JSON.stringify(D);(O.itemId!==C.current.itemId||O.itemType!==C.current.itemType||H!==C.current.effectiveSettingsString)&&(I.emit(sn.initializePromptStateRequest,{effectiveSettings:D}),I.emit(Tr.contextChanged,{selectedItemId:o,selectedItemType:l}),C.current={...O,effectiveSettingsString:H})},[o,l,c,u,t,xd]),E.useEffect(()=>{if(t||!xd||!a.current)return;const I=a.current,O=()=>{let K=null;if(l==="project")K=o;else if(l==="conversation"&&o){const V=c(o);K=(V==null?void 0:V.projectId)??null}const U=u(K);I.emit(sn.initializePromptStateRequest,{effectiveSettings:U})},B=I.on(an.loaded,O),D=I.on(Sa.updated,O),H=I.on(an.globalSystemPromptChanged,O),P=I.on(an.temperatureChanged,O);return()=>{B(),D(),H(),P()}},[o,l,c,u,t,xd]),E.useEffect(()=>{if(t||!xd||!a.current)return;const I=a.current;let O=null;if(b["core-vfs-modal-panel"]||l==="project")if(l==="project")O=o;else if(l==="conversation"){const H=c(o);O=(H==null?void 0:H.projectId)??"orphan"}else O="orphan";else if(l==="conversation"){const H=c(o);O=(H==null?void 0:H.projectId)??"orphan"}let D=null;typeof O=="string"?D=O:O===null?D=null:(console.warn(`[LiteChatVFS] Calculated VFS key was not a string or null. Type: ${typeof O}, Value:`,O,"Defaulting to 'orphan'."),D="orphan"),ei.getState().vfsKey!==D&&I.emit(hn.setVfsKeyRequest,{key:D})},[o,l,c,t,xd,b]);const T=async I=>{const O=Vn.getState(),B=await O.addConversation(I);return console.log("New conversation ID:",B),await O.selectItem(B,"conversation"),console.log("conv selected:",B),B},A=E.useCallback(async I=>{var H;if(!a.current){Te.error("Application core not ready. Please try again.");return}const O=Vn.getState();let B=O.selectedItemType==="conversation"?O.selectedItemId:null;const D=O.selectedItemType==="project"?O.selectedItemId:O.selectedItemType==="conversation"?((H=O.getConversationById(O.selectedItemId))==null?void 0:H.projectId)??null:null;if(!B)try{B=await T({title:"New Chat",projectId:D}),console.log("New conversation ID 2:",B)}catch(P){console.error("[LiteChat] App: Failed to create new conversation",P),Te.error("Failed to start new chat.");return}try{const P=Yl.getState(),K={...I,metadata:{...I.metadata,modelId:P.modelId}};await gh.submitPrompt(K)}catch(P){console.error("[LiteChat] App: Error submitting prompt:",P),Te.error("Failed to send message.")}},[]),N=l==="conversation"?o:null;return t?f.jsx("div",{className:"flex items-center justify-center h-screen w-screen bg-background text-foreground",children:f.jsxs("div",{className:"flex flex-col items-center gap-4",children:[f.jsx(Jn,{className:"h-12 w-12 animate-spin text-primary"}),f.jsx("p",{className:"text-lg text-muted-foreground",children:"Initializing LiteChat..."})]})}):f.jsxs(f.Fragment,{children:[f.jsx(O$e,{}),f.jsxs("div",{className:"flex h-full w-full border border-border rounded-lg overflow-hidden bg-background text-foreground",children:[f.jsxs("div",{className:Ze("hidden md:flex flex-col border-r border-border bg-card","transition-[width] duration-300 ease-in-out","flex-shrink-0 overflow-hidden",y?"w-16":"w-64"),children:[f.jsxs("div",{className:"flex-grow overflow-y-auto overflow-x-hidden",children:[f.jsx("div",{className:Ze(y?"hidden":"block"),children:f.jsx(d0,{controls:x,panelId:"sidebar",renderMode:"full",className:"h-full"})}),f.jsx("div",{className:Ze(y?"block":"hidden"),children:f.jsx(d0,{controls:x,panelId:"sidebar",renderMode:"icon",className:"flex flex-col items-center gap-2 p-2"})})]}),f.jsx("div",{className:Ze("flex-shrink-0 border-t border-border p-2",y?"flex flex-col items-center gap-2":"flex items-center justify-center"),children:f.jsx(d0,{controls:w,panelId:"sidebar-footer",renderMode:y?"icon":"full",className:Ze("flex",y?"flex-col gap-2 items-center":"items-center gap-1 justify-center")})})]}),r&&f.jsxs("div",{className:"md:hidden fixed inset-0 z-40 flex",children:[f.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm animate-fadeIn",onClick:k}),f.jsxs("div",{className:"relative w-4/5 max-w-sm bg-card border-r border-border h-full flex flex-col animate-slideInFromLeft shadow-2xl",children:[f.jsxs("div",{className:"sticky top-0 z-10 flex justify-between items-center p-4 border-b border-border bg-card",children:[f.jsx("h2",{className:"font-semibold text-card-foreground",children:"LiteChat Menu"}),f.jsx("button",{onClick:k,className:"p-2 rounded-md hover:bg-muted text-card-foreground touch-manipulation","aria-label":"Close menu",style:{minHeight:"44px",minWidth:"44px"},children:f.jsx(Pi,{className:"h-5 w-5"})})]}),f.jsx("div",{className:"flex-grow overflow-y-auto overflow-x-hidden bg-card",children:x.length>0?f.jsx(d0,{controls:x,panelId:"sidebar",renderMode:"full",className:"h-full"}):f.jsxs("div",{className:"p-4 text-center text-muted-foreground",children:[f.jsx("p",{className:"text-sm",children:"Loading menu..."}),f.jsx("p",{className:"text-xs mt-2",children:"Please wait while the application initializes."})]})}),f.jsx("div",{className:"flex-shrink-0 border-t border-border p-4 bg-card",children:w.length>0?f.jsx(d0,{controls:w,panelId:"sidebar-footer",renderMode:"full",className:"flex items-center justify-between"}):f.jsx("div",{className:"text-center text-muted-foreground text-xs",children:"Footer controls loading..."})})]})]}),f.jsxs("div",{className:"flex flex-col flex-grow min-w-0",children:[f.jsxs("div",{className:"flex items-center justify-between p-2 border-b border-border bg-card flex-shrink-0",children:[f.jsx("button",{className:Ze("md:hidden p-3 rounded-md hover:bg-muted active:bg-muted/80 transition-colors touch-manipulation",r&&"bg-muted"),onClick:k,"aria-label":r?"Close menu":"Open menu",style:{minHeight:"44px",minWidth:"44px"},children:r?f.jsx(Pi,{className:"h-6 w-6"}):f.jsx(oge,{className:"h-6 w-6"})}),f.jsx(d0,{controls:S,panelId:"header",className:"flex items-center justify-end gap-1 flex-grow"})]}),f.jsx(b$e,{conversationId:N,interactions:d,status:h,className:"flex-grow overflow-y-hidden"}),m&&f.jsxs("div",{className:"p-2 bg-destructive text-destructive-foreground text-sm text-center",children:["Error: ",m]}),f.jsx(Txe,{InputAreaRenderer:wne,onSubmit:A,className:"border-t border-border bg-card flex-shrink-0",inputAreaRef:i,selectedItemId:o,selectedItemType:l})]})]}),f.jsx(S$e,{richColors:!0,position:"bottom-right",closeButton:!0})]})},F$e="prism-theme-link",L$e="prism-default-light-theme-link",B$e="prism-default-dark-theme-link",$$e="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css",z$e="https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css",c3=e=>{let t=document.getElementById(e);return t||(t=document.createElement("link"),t.id=e,t.rel="stylesheet",document.head.appendChild(t)),t},U$e=()=>{const{prismThemeUrl:e,theme:t}=pr(yn(s=>({prismThemeUrl:s.prismThemeUrl,theme:s.theme}))),n=E.useMemo(()=>typeof window>"u"?"light":window.matchMedia("(prefers-color-scheme: dark)").matches?"dark":"light",[]),r=E.useMemo(()=>{const s=t==="system"?n:t;return s==="dark"||s==="TijuDark"?"dark":"light"},[t,n]);return E.useEffect(()=>{if(typeof window>"u")return;const s=c3(L$e),i=c3(B$e),a=c3(F$e);return s.disabled=!0,i.disabled=!0,a.disabled=!0,s.href=$$e,i.href=z$e,e?(a.href=e,a.disabled=!1):r==="dark"?i.disabled=!1:s.disabled=!1,()=>{}},[e,r]),null},u3=e=>e.replace(/([a-z0-9]|(?=[A-Z]))([A-Z])/g,"$1-$2").toLowerCase(),d3=["background","foreground","card","cardForeground","popover","popoverForeground","primary","primaryForeground","secondary","secondaryForeground","muted","mutedForeground","accent","accentForeground","destructive","destructiveForeground","border","input","ring","chart1","chart2","chart3","chart4","chart5","sidebar","sidebarForeground","sidebarPrimary","sidebarPrimaryForeground","sidebarAccent","sidebarAccentForeground","sidebarBorder","sidebarRing"],q$e=()=>{const{theme:e,customFontFamily:t,customFontSize:n,customThemeColors:r}=pr(yn(s=>({theme:s.theme,customFontFamily:s.customFontFamily,customFontSize:s.customFontSize,customThemeColors:s.customThemeColors})));return E.useEffect(()=>{const s=document.body,i=document.documentElement;s.classList.remove("light","dark","TijuLight","TijuDark","custom"),d3.forEach(a=>{i.style.removeProperty(`--${u3(a)}`)}),i.style.removeProperty("--custom-font-family"),i.style.removeProperty("--custom-font-size"),e==="light"?s.classList.add("light"):e==="dark"?s.classList.add("dark"):e==="TijuLight"?s.classList.add("TijuLight"):e==="TijuDark"?s.classList.add("TijuDark"):e==="custom"?(s.classList.add("custom"),t?i.style.setProperty("--custom-font-family",t):i.style.removeProperty("--custom-font-family"),n?i.style.setProperty("--custom-font-size",`${n}px`):i.style.removeProperty("--custom-font-size"),r&&Object.entries(r).forEach(([a,o])=>{if(o&&d3.includes(a)){const l=`--${u3(a)}`;i.style.setProperty(l,o)}else if(d3.includes(a)){const l=`--${u3(a)}`;i.style.removeProperty(l)}})):window.matchMedia("(prefers-color-scheme: dark)").matches?s.classList.add("dark"):s.classList.add("light")},[e,t,n,r]),null},V$e=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsxs("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:[f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`})}),f.jsxs("g",{transform:"translate(165, 220) scale(2.5)",children:[f.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),f.jsxs("g",{transform:"translate(290, 220) scale(2.5)",children:[f.jsx("path",{d:"M5 5l14 14",stroke:n,strokeWidth:"4"}),f.jsx("path",{d:"M18 5l-14 14",stroke:n,strokeWidth:"4"})]}),f.jsx("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:f.jsx("path",{d:`M2147 1750 c-26 15 -48 65 -41 94
             15 61 181 167 304 196
             30 7 100 12 155 12
             81 -1 115 -6 178 -27
             135 -45 247 -133 249 -194
             2 -60 -48 -103 -104 -88
             -13 3 -50 25 -83 50
             -85 64 -172 90 -280 84
             -92 -6 -165 -35 -259 -103
             -49 -35 -86 -43 -119 -24z`})})]})},wq="0.1.0-dev",_q="https://github.com/DimitriGilbert/LiteChat",Sq=({textToCopy:e,label:t,className:n})=>{const[r,s]=E.useState(!1),i=async()=>{try{await navigator.clipboard.writeText(e),s(!0),Te.success(`${t} copied to clipboard!`),setTimeout(()=>s(!1),2e3)}catch(a){Te.error(`Failed to copy ${t.toLowerCase()}.`),console.error(`Clipboard copy failed for ${t}:`,a)}};return f.jsxs(ct,{variant:"outline",onClick:i,className:n,children:[r?f.jsx(co,{className:"mr-2 h-4 w-4 text-green-500"}):f.jsx(fme,{className:"mr-2 h-4 w-4"}),r?"Copied!":`Copy ${t}`]})};class W$e extends E.Component{constructor(){super(...arguments);ue(this,"state",{hasError:!1,error:null,errorInfo:null});ue(this,"handleReportOnGitHub",async()=>{const n=this.generateErrorReport(!0);try{await navigator.clipboard.writeText(n),Te.success("Error report copied to clipboard. Paste it into the GitHub issue body.");const r=`${_q}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(r,"_blank","noopener,noreferrer")}catch(r){Te.error("Failed to copy error report. Please copy manually."),console.error("Clipboard copy failed for GitHub report:",r);const s=`${_q}/issues/new?title=${encodeURIComponent(this.getGitHubIssueTitle())}`;window.open(s,"_blank","noopener,noreferrer")}})}static getDerivedStateFromError(n){return{hasError:!0,error:n,errorInfo:null}}componentDidCatch(n,r){console.error("Uncaught error:",n,r),this.setState({errorInfo:r})}getGitHubIssueTitle(){var i;const{error:n,errorInfo:r}=this.state;let s="Crash Report: ";if(r!=null&&r.componentStack){const a=(i=r.componentStack.trim().split(/\s+at\s+/)[1])==null?void 0:i.split(" ")[0];a&&(s+=`Error in <${a}> - `)}return s+=(n==null?void 0:n.message.substring(0,70))??"Unknown Error",n&&n.message.length>70&&(s+="..."),s}generateErrorReport(n=!1){const{error:r,errorInfo:s}=this.state,i=`
`,a=n?"```":"";let o=`## LiteChat Error Report${i}${i}`;return o+=`**Version:** ${wq}${i}`,o+=`**Timestamp:** ${new Date().toISOString()}${i}`,o+=`**User Agent:** ${typeof navigator<"u"?navigator.userAgent:"N/A"}${i}${i}`,r?o+=`**Error Message:**${i}${a}${i}${r.message}${i}${a}${i}${i}`:o+=`**Error Message:** Unknown Error${i}${i}`,s!=null&&s.componentStack&&(o+=`**Component Stack:**${i}${a}text${i}${s.componentStack.trim()}${i}${a}${i}${i}`),r!=null&&r.stack&&(o+=`**Error Stack Trace:**${i}${a}text${i}${r.stack.trim()}${i}${a}${i}${i}`),o+=`**Steps to Reproduce (Please Describe):**${i}1. ...${i}2. ...${i}${i}`,o+=`**Expected Behavior:**${i}...${i}${i}`,o+=`**Actual Behavior:**${i}...${i}`,o}generateAIPrompt(){var i,a;const{error:n,errorInfo:r}=this.state;return`I encountered an error in a React application (LiteChat v${wq}). Please help me debug it.

Error Message:
\`\`\`
${(n==null?void 0:n.message)??"Unknown Error"}
\`\`\`

Component Stack (if available):
\`\`\`
${((i=r==null?void 0:r.componentStack)==null?void 0:i.trim())??"Not available"}
\`\`\`

Error Stack Trace (if available):
\`\`\`
${((a=n==null?void 0:n.stack)==null?void 0:a.trim())??"Not available"}
\`\`\`

Based on this information, what are the likely causes and potential solutions? Focus on React-specific issues if the component stack is present.`}render(){var n;return this.state.hasError?this.props.fallback?this.props.fallback:f.jsx("div",{role:"alert",className:"flex flex-col items-center justify-center h-screen w-screen p-4 bg-background text-foreground",children:f.jsxs("div",{className:"max-w-2xl w-full border border-destructive bg-destructive/10 rounded-lg p-6 text-center shadow-lg",children:[f.jsx(V$e,{className:"h-24 w-24 text-destructive mx-auto mb-4"}),f.jsx("h1",{className:"text-2xl font-semibold text-destructive mb-2",children:"Oops! Something went wrong."}),f.jsx("p",{className:"text-destructive/90 mb-4",children:"LiteChat encountered an unexpected error. Please try refreshing the page. If the problem persists, consider reporting the issue. Copy the details and paste them into the GitHub issue."}),f.jsx("pre",{className:"text-left text-xs bg-destructive/10 border border-destructive/30 rounded p-3 max-h-32 overflow-auto mb-4 font-mono text-destructive/80",children:((n=this.state.error)==null?void 0:n.message)??"Unknown Error"}),f.jsxs("div",{className:"flex flex-wrap justify-center gap-2",children:[f.jsx(ct,{variant:"destructive",onClick:()=>window.location.reload(),children:"Refresh Page"}),f.jsx(Sq,{textToCopy:this.generateErrorReport(),label:"Details"}),f.jsx(Sq,{textToCopy:this.generateAIPrompt(),label:"AI Debug Prompt"}),f.jsxs(ct,{variant:"outline",onClick:this.handleReportOnGitHub,children:[f.jsx(_E,{className:"mr-2 h-4 w-4"})," Report on GitHub"]})]})]})}):this.props.children}}const kne=(e,t)=>{if(!t)return null;let n=jc,r="text-muted-foreground/70",s=`Linked to ${t}`;switch(e){case"syncing":n=Jn,r="animate-spin text-blue-500",s=`Syncing with ${t}...`;break;case"error":n=Kl,r="text-destructive",s=`Sync error with ${t}`;break;case"needs-sync":n=ZP,r="text-orange-500",s=`Needs sync with ${t}`;break;case"idle":n=xE,r="text-green-500",s=`Synced with ${t}`;break;default:n=jc,r="text-muted-foreground/70",s=`Linked to ${t} (Status: ${e??"Unknown"})`;break}return f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(n,{className:Ze("h-3 w-3 ml-1 flex-shrink-0",r)})}),f.jsx(Cr,{side:"right",children:s})]})})},Ene=E.memo(({item:e,level:t,selectedItemId:n,conversationSyncStatus:r,repoNameMap:s,onSelectItem:i,onDeleteConversation:a,onDeleteProject:o,onExportConversation:l,onExportProject:c,expandedProjects:u,toggleProjectExpansion:d,editingItemId:h,editingItemType:m,handleStartEditing:y,handleSaveEdit:b,handleCancelEdit:v,isSavingEdit:x,originalNameToCompare:w})=>{const S=e.id===n,k=e.itemType==="project",C=e.id===h&&e.itemType===m,[T,A]=E.useState(k?e.name:e.title),N=E.useRef(null);E.useEffect(()=>{if(C){const de=k?e.name:e.title;A(de),requestAnimationFrame(()=>{var Oe,Fe;(Oe=N.current)==null||Oe.focus(),(Fe=N.current)==null||Fe.select()})}},[C,e,k]),E.useEffect(()=>{if(!C){const de=k?e.name:e.title;T!==de&&A(de)}},[k?e.name:e.title,C,T,k]);const I=k&&u.has(e.id),O=k,B=!k&&e.syncRepoId?r[e.id]:void 0,D=!k&&e.syncRepoId?s.get(e.syncRepoId):void 0,H=!k&&D?kne(B,D):null,P=de=>{de.stopPropagation(),Re.emit(Tr.openModalRequest,{modalId:"projectSettingsModal",targetId:e.id})},K=()=>{C||(k&&d(e.id),i(e.id,e.itemType))},U=de=>{de.stopPropagation(),k?window.confirm(`Delete project "${e.name}" and ALL its contents (sub-projects and conversations)? This cannot be undone.`)&&o(e.id,de):a(e.id,de)},V=de=>{de.stopPropagation(),y(e)},L=()=>{A(w),v(e.itemType==="project"&&w==="New Project")},te=async()=>{if(x)return;const de=T.trim();await b(e.id,e.itemType,de)},W=()=>{var Fe;if(x)return;const de=T.trim(),Oe=e.itemType==="project"&&w==="New Project";if(!de){w!=="New Project"?(Te.error("Name cannot be empty."),A(w),(Fe=N.current)==null||Fe.focus()):L();return}de!==w||Oe?te():L()},Q=de=>{de.key==="Enter"?(de.preventDefault(),te()):de.key==="Escape"&&(de.preventDefault(),L())},ee=k?e.name:e.title,re=x?Jn:co,pe=x?"h-3 w-3 animate-spin":"h-3 w-3";return f.jsxs("li",{className:Ze("relative flex justify-between items-center group p-1.5 text-xs rounded","border border-transparent",!C&&"hover:bg-muted/50 hover:text-primary/80",S&&!C?"bg-primary/10 text-primary font-medium border-primary dark:bg-primary/20 dark:border-primary/70":"",C&&"bg-muted ring-1 ring-primary",!C&&"cursor-pointer"),style:{paddingLeft:`${.375+t*.75}rem`},onClick:K,title:C?"":ee,children:[f.jsxs("div",{className:"flex items-center min-w-0 gap-1 flex-grow mr-1",children:[O&&f.jsx("span",{className:"flex-shrink-0 w-3 cursor-pointer p-0.5 -ml-0.5",onClick:de=>{de.stopPropagation(),d(e.id)},children:I?f.jsx(Ql,{className:"h-3 w-3 text-muted-foreground"}):f.jsx(VP,{className:"h-3 w-3 text-muted-foreground"})}),!O&&f.jsx("span",{className:"w-3 flex-shrink-0"}),k?f.jsx(Th,{className:"h-3.5 w-3.5 text-yellow-500 flex-shrink-0"}):f.jsx(rj,{className:"h-3.5 w-3.5 text-blue-400 flex-shrink-0"}),C?f.jsx(xn,{ref:N,value:T,onChange:de=>A(de.target.value),onKeyDown:Q,onBlur:W,className:"h-6 px-1 py-0 text-xs flex-grow min-w-0",onClick:de=>de.stopPropagation(),disabled:x}):f.jsx("span",{className:"truncate min-w-0 flex-1",children:ee}),H]}),f.jsx("div",{className:Ze("items-center flex-shrink-0 ml-1",C?"flex":"hidden group-hover:flex transition-all duration-150"),onClick:de=>de.stopPropagation(),children:C?f.jsxs(f.Fragment,{children:[f.jsx(qn,{tooltipText:"Save (Enter)",onClick:de=>{de.stopPropagation(),te()},disabled:x||!T.trim(),"aria-label":"Save changes",icon:f.jsx(re,{}),iconClassName:pe,className:"h-5 w-5 text-green-500 hover:text-green-600"}),f.jsx(qn,{tooltipText:"Cancel (Esc)",onClick:de=>{de.stopPropagation(),L()},disabled:x,"aria-label":"Cancel edit",icon:f.jsx(Pi,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"})]}):f.jsxs(f.Fragment,{children:[k&&f.jsx(qn,{tooltipText:"Project Settings",onClick:P,"aria-label":`Settings for ${ee}`,icon:f.jsx(lme,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),f.jsx(qn,{tooltipText:"Edit",onClick:V,"aria-label":`Edit ${ee}`,icon:f.jsx(y1,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}),k?f.jsx(qn,{tooltipText:"Export Project (JSON)",onClick:de=>c(e.id,de),"aria-label":`Export project ${ee}`,icon:f.jsx(Sme,{}),className:"h-5 w-5 text-muted-foreground hover:text-foreground"}):f.jsxs("div",{className:"relative group/export",children:[f.jsx(qn,{tooltipText:"Export Conversation","aria-label":`Export ${ee}`,icon:f.jsx(Tc,{}),className:"h-5 w-5 text-muted-foreground group-hover/export:text-foreground"}),f.jsxs("div",{className:`absolute right-0 top-full mt-1 hidden group-hover/export:flex
                                 bg-popover border border-border rounded-md shadow-lg p-0.5 z-10 gap-0.5`,onClick:de=>de.stopPropagation(),children:[f.jsx(ct,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:de=>l(e.id,"json",de),children:"JSON"}),f.jsx(ct,{variant:"ghost",size:"sm",className:"h-5 px-1.5 text-xs",onClick:de=>l(e.id,"md",de),children:"MD"})]})]}),f.jsx(qn,{tooltipText:"Delete",onClick:U,"aria-label":`Delete ${ee}`,icon:f.jsx(Po,{}),className:"h-5 w-5 text-destructive hover:text-destructive/80"})]})})]})});Ene.displayName="ConversationItemRenderer";function H$e({updateProject:e,updateConversation:t,deleteProject:n}){const[r,s]=E.useState(null),[i,a]=E.useState(null),[o,l]=E.useState(""),[c,u]=E.useState(!1),d=E.useCallback(y=>{s(y.id),a(y.itemType);const b=y.itemType==="project"?y.name:y.title;l(b),u(!1)},[]),h=E.useCallback(y=>{const b=r,v=y??(i==="project"&&o==="New Project");s(null),a(null),l(""),u(!1),v&&b&&n(b).catch(x=>{console.error("Failed to delete new project on cancel:",x),Te.error("Failed to clean up cancelled new project.")})},[r,i,o,n]),m=E.useCallback(async(y,b,v)=>{if(y!==r||b!==i||c)return;const x=v==null?void 0:v.trim();if(!x){Te.error("Name cannot be empty.");return}if(x===o&&!(b==="project"&&o==="New Project")){h();return}u(!0);try{b==="project"?await e(y,{name:x}):await t(y,{title:x}),Te.success("Item renamed successfully."),s(null),a(null),l("")}catch(S){console.error("Failed to save item name:",S),Te.error(`Failed to rename item: ${S instanceof Error?S.message:String(S)}`)}finally{u(!1)}},[r,i,c,e,t,h,o]);return{editingItemId:r,editingItemType:i,isSavingEdit:c,handleStartEditing:d,handleSaveEdit:m,handleCancelEdit:h,originalNameToCompare:o}}const Tne=(e,t,n,r,s,i,a,o,l)=>{if(!n)return!0;const c=`${t}-${e}`;if(l[c]!==void 0)return l[c];let u=!1;{const d=i.get(e);if(d)if(d.name.toLowerCase().includes(n))u=!0;else{const h=o.get(e)||[],m=a.get(e)||[];for(const y of m)if(y.title.toLowerCase().includes(n)){u=!0;break}if(!u){for(const y of h)if(Tne(y.id,"project",n,r,s,i,a,o,l)){u=!0;break}}}}return l[c]=u,u},G$e=({module:e})=>{const t=E.useRef(null),n=E.useRef(null),[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>i({})),e.isLoading&&!Vn.getState().isLoading&&!yl.getState().isLoading&&e.setIsLoading(!1),()=>e.setNotifyCallback(null)),[e]),E.useEffect(()=>{const ye=t.current;if(ye){const Ie=ye.querySelector("[data-radix-scroll-area-viewport]");if(Ie&&n.current!==Ie?(n.current=Ie,r||s(!0),i({})):!Ie&&n.current&&(n.current=null,s(!1)),!n.current){const ce=new MutationObserver(()=>{const oe=ye.querySelector("[data-radix-scroll-area-viewport]");oe&&n.current!==oe&&(n.current=oe,s(!0),i({}),ce.disconnect())});return ce.observe(ye,{childList:!0,subtree:!0}),()=>ce.disconnect()}}},[t.current,r]);const{selectedItemId:a,selectedItemType:o,conversations:l,syncRepos:c,conversationSyncStatus:u,selectItem:d,addConversation:h,updateConversation:m,deleteConversation:y,exportConversation:b,exportProject:v,getConversationById:x}=Vn(yn(ye=>({selectedItemId:ye.selectedItemId,selectedItemType:ye.selectedItemType,conversations:ye.conversations,syncRepos:ye.syncRepos,conversationSyncStatus:ye.conversationSyncStatus,selectItem:ye.selectItem,addConversation:ye.addConversation,updateConversation:ye.updateConversation,deleteConversation:ye.deleteConversation,exportConversation:ye.exportConversation,exportProject:ye.exportProject,getConversationById:ye.getConversationById}))),{projects:w,addProject:S,updateProject:k,deleteProject:C,getProjectById:T}=yl(yn(ye=>({projects:ye.projects,addProject:ye.addProject,updateProject:ye.updateProject,deleteProject:ye.deleteProject,getProjectById:ye.getProjectById}))),A=e.isLoading,[N,I]=Ve.useState(new Set),[O,B]=E.useState(""),D=H$e({updateProject:k,updateConversation:m,deleteProject:C}),{editingItemId:H,editingItemType:P,isSavingEdit:K,handleStartEditing:U,handleSaveEdit:V,handleCancelEdit:L,originalNameToCompare:te}=D,W=E.useCallback(ye=>{I(Ie=>{const ce=new Set(Ie);return ce.has(ye)?ce.delete(ye):ce.add(ye),ce})},[]),Q=E.useCallback(()=>{if(o==="project")return a;if(o==="conversation"&&a){const ye=x(a);return(ye==null?void 0:ye.projectId)??null}return null},[a,o,x]),ee=E.useCallback(async()=>{if(!H)try{const ye=Q(),Ie=await h({title:"New Chat",projectId:ye});d(Ie,"conversation")}catch(ye){console.error("Failed to create new chat:",ye),Te.error("Failed to create new chat.")}},[H,Q,h,d]),re=E.useCallback(async()=>{if(!H)try{const ye=Q(),Ie=await S({name:"New Project",parentId:ye});d(Ie,"project"),ye&&I(ce=>new Set(ce).add(ye)),setTimeout(()=>{const ce=T(Ie);ce&&U({...ce,itemType:"project"})},50)}catch(ye){console.error("Failed to create new project:",ye)}},[H,Q,S,d,T,U]),pe=E.useCallback((ye,Ie)=>{ye===H&&Ie===P||(H&&(ye!==H||Ie!==P)&&L(),(ye!==a||Ie!==o)&&d(ye,Ie))},[H,P,a,o,L,d]),de=E.useCallback((ye,Ie)=>{Ie.stopPropagation(),window.confirm("Delete this conversation? This cannot be undone.")&&y(ye).catch(ce=>{console.error("Failed to delete conversation:",ce),Te.error("Failed to delete conversation.")})},[y]),Oe=E.useCallback((ye,Ie)=>{Ie.stopPropagation(),C(ye).catch(ce=>{console.error("Failed to delete project:",ce),Te.error("Failed to delete project.")})},[C]),Fe=E.useCallback(async(ye,Ie,ce)=>{ce.stopPropagation();try{await b(ye,Ie)}catch(oe){console.error(`Failed to export conversation as ${Ie}:`,oe)}},[b]),Se=E.useCallback(async(ye,Ie)=>{Ie.stopPropagation();try{await v(ye)}catch(ce){console.error("Failed to export project:",ce)}},[v]),Ce=E.useMemo(()=>new Map((c||[]).map(ye=>[ye.id,ye.name])),[c]),{projectsById:qe,conversationsByProjectId:Qe,projectsByParentId:We}=E.useMemo(()=>{const ye=new Map(w.map(oe=>[oe.id,oe])),Ie=new Map;l.forEach(oe=>{const se=oe.projectId??null;Ie.has(se)||Ie.set(se,[]),Ie.get(se).push(oe)});const ce=new Map;return w.forEach(oe=>{const se=oe.parentId??null;ce.has(se)||ce.set(se,[]),ce.get(se).push(oe)}),{projectsById:ye,conversationsByProjectId:Ie,projectsByParentId:ce}},[w,l]),je=E.useMemo(()=>{const ye=[],Ie=O.toLowerCase(),ce={};function oe(se,Me){const Be=(We.get(se)||[]).filter(Tt=>Tne(Tt.id,"project",Ie,w,l,qe,Qe,We,ce)),Ae=(Qe.get(se)||[]).filter(Tt=>Tt.title.toLowerCase().includes(Ie)),lt=[...Be,...Ae];lt.sort((Tt,dt)=>new Date(dt.updatedAt).getTime()-new Date(Tt.updatedAt).getTime()),lt.forEach(Tt=>{"path"in Tt?(ye.push({id:`project-${Tt.id}`,originalId:Tt.id,type:"project",level:Me,data:Tt,updatedAt:Tt.updatedAt}),N.has(Tt.id)&&oe(Tt.id,Me+1)):ye.push({id:`conversation-${Tt.id}`,originalId:Tt.id,type:"conversation",level:Me,data:Tt,updatedAt:Tt.updatedAt})})}return oe(null,0),ye},[w,l,O,N,qe,Qe,We]),Y=jF({count:je.length,getScrollElement:()=>n.current,estimateSize:()=>30,overscan:10});return f.jsxs("div",{className:"p-2 border-r border-[--border] bg-card text-card-foreground h-full flex flex-col",children:[f.jsxs("div",{className:"flex justify-between items-center mb-2 flex-shrink-0 px-1",children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx("h3",{className:"text-sm font-semibold",children:"LiteChat"}),f.jsx(Nd,{href:"https://github.com/DimitriGilbert/LiteChat",target:"_blank",rel:"noopener noreferrer","aria-label":"GitHub Repository",children:f.jsx(ct,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",children:f.jsx(Vme,{className:"h-4 w-4"})})}),f.jsx(Nd,{href:"release/latest.zip",download:"LiteChat.zip","aria-label":"Download LiteChat",children:f.jsx(ct,{size:"sm",variant:"ghost",className:"h-4 w-4 p-0",children:f.jsx(Tc,{className:"h-4 w-4"})})})]}),f.jsxs("div",{className:"flex items-center",children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{size:"sm",variant:"ghost",onClick:re,"aria-label":"New Project",disabled:A||!!H,className:"h-7 w-7 p-0",children:f.jsx(CH,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"bottom",children:"New Project"})]})}),f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{size:"sm",variant:"ghost",onClick:ee,"aria-label":"New Chat",disabled:A||!!H,className:"h-7 w-7 p-0",children:f.jsx(Pc,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"bottom",children:"New Chat"})]})})]})]}),f.jsxs("div",{className:"relative mb-2 px-1 flex-shrink-0",children:[f.jsx(uo,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),f.jsx(xn,{type:"search",placeholder:"Filter...",value:O,onChange:ye=>B(ye.target.value),className:"h-8 text-xs pl-8",disabled:A})]}),f.jsxs(Zl,{className:"flex-grow",ref:t,children:[A&&je.length===0?f.jsxs("div",{className:"space-y-1 p-1",children:[f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"}),f.jsx("div",{className:"h-8 w-full bg-muted rounded animate-pulse"})]}):!A&&je.length===0?f.jsx("p",{className:"text-xs text-muted-foreground p-2 text-center",children:O.trim()!==""?"No items match your filter.":"Workspace is empty."}):r&&f.jsx("div",{style:{height:`${Y.getTotalSize()}px`,width:"100%",position:"relative"},children:Y.getVirtualItems().map(ye=>{const Ie=je[ye.index];if(!Ie)return null;const ce={...Ie.data,itemType:Ie.type};return f.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${ye.size}px`,transform:`translateY(${ye.start}px)`},className:"px-1",children:f.jsx(Ene,{item:ce,level:Ie.level,selectedItemId:a,conversationSyncStatus:u,repoNameMap:Ce,onSelectItem:()=>pe(Ie.originalId,Ie.type),onDeleteConversation:de,onDeleteProject:Oe,onExportConversation:Fe,onExportProject:Se,expandedProjects:N,toggleProjectExpansion:W,editingItemId:H,editingItemType:P,handleStartEditing:U,handleSaveEdit:V,handleCancelEdit:L,isSavingEdit:K,originalNameToCompare:te})},Ie.id)})}),!r&&!A&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},K$e=({module:e})=>{const{selectedItemType:t}=Vn(yn(r=>({selectedItemType:r.selectedItemType})));return e.isLoading?f.jsx(Jn,{className:"h-5 w-5 animate-spin text-muted-foreground"}):t==="project"?f.jsx(Th,{className:"h-5 w-5 text-primary"}):t==="conversation"?f.jsx(RB,{className:"h-5 w-5 text-primary"}):f.jsx(RB,{className:"h-5 w-5 text-muted-foreground"})};class Y$e{constructor(){ue(this,"id","core-conversation-list");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"isLoading",!0);ue(this,"conversationsLoading",!0);ue(this,"projectsLoading",!0);ue(this,"notifyComponentUpdate",null);ue(this,"setIsLoading",t=>{var n;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.conversationsLoading=Vn.getState().isLoading,this.projectsLoading=yl.getState().isLoading,this.updateCombinedLoadingState(),t.emit(er.loadConversationsRequest,void 0),t.emit(Sa.loadProjectsRequest,void 0);const n=t.on(er.conversationsLoaded,()=>{this.conversationsLoading=!1,this.updateCombinedLoadingState()}),r=t.on(Sa.loaded,()=>{this.projectsLoading=!1,this.updateCombinedLoadingState()}),s=t.on(er.loadingStateChanged,a=>{a.isLoading!==this.conversationsLoading&&(this.conversationsLoading=a.isLoading,this.updateCombinedLoadingState())}),i=t.on(Sa.loadingStateChanged,a=>{a.isLoading!==this.projectsLoading&&(this.projectsLoading=a.isLoading,this.updateCombinedLoadingState())});this.eventUnsubscribers.push(n,r,s,i)}updateCombinedLoadingState(){var n;const t=this.conversationsLoading||this.projectsLoading;this.isLoading!==t&&(this.isLoading=t,(n=this.notifyComponentUpdate)==null||n.call(this))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Module "${this.id}" already registered. Skipping.`);return}this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar",status:()=>this.isLoading?"loading":"ready",renderer:()=>Ve.createElement(G$e,{module:this}),iconRenderer:()=>Ve.createElement(K$e,{module:this}),show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const Cq=({module:e})=>{const t=(n,r)=>{e.openSettingsModal(n,r)};return f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{variant:"ghost",size:"icon",onClick:()=>t(),className:"h-8 w-8","aria-label":"Open Settings",children:f.jsx(Rh,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"top",children:"Settings"})]})})};var f3="focusScope.autoFocusOnMount",h3="focusScope.autoFocusOnUnmount",kq={bubbles:!1,cancelable:!0},Z$e="FocusScope",zF=E.forwardRef((e,t)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=e,[o,l]=E.useState(null),c=Es(s),u=Es(i),d=E.useRef(null),h=In(t,b=>l(b)),m=E.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;E.useEffect(()=>{if(r){let b=function(S){if(m.paused||!o)return;const k=S.target;o.contains(k)?d.current=k:fh(d.current,{select:!0})},v=function(S){if(m.paused||!o)return;const k=S.relatedTarget;k!==null&&(o.contains(k)||fh(d.current,{select:!0}))},x=function(S){if(document.activeElement===document.body)for(const C of S)C.removedNodes.length>0&&fh(o)};document.addEventListener("focusin",b),document.addEventListener("focusout",v);const w=new MutationObserver(x);return o&&w.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",b),document.removeEventListener("focusout",v),w.disconnect()}}},[r,o,m.paused]),E.useEffect(()=>{if(o){Tq.add(m);const b=document.activeElement;if(!o.contains(b)){const x=new CustomEvent(f3,kq);o.addEventListener(f3,c),o.dispatchEvent(x),x.defaultPrevented||(X$e(n9e(Ane(o)),{select:!0}),document.activeElement===b&&fh(o))}return()=>{o.removeEventListener(f3,c),setTimeout(()=>{const x=new CustomEvent(h3,kq);o.addEventListener(h3,u),o.dispatchEvent(x),x.defaultPrevented||fh(b??document.body,{select:!0}),o.removeEventListener(h3,u),Tq.remove(m)},0)}}},[o,c,u,m]);const y=E.useCallback(b=>{if(!n&&!r||m.paused)return;const v=b.key==="Tab"&&!b.altKey&&!b.ctrlKey&&!b.metaKey,x=document.activeElement;if(v&&x){const w=b.currentTarget,[S,k]=J$e(w);S&&k?!b.shiftKey&&x===k?(b.preventDefault(),n&&fh(S,{select:!0})):b.shiftKey&&x===S&&(b.preventDefault(),n&&fh(k,{select:!0})):x===w&&b.preventDefault()}},[n,r,m.paused]);return f.jsx(cr.div,{tabIndex:-1,...a,ref:h,onKeyDown:y})});zF.displayName=Z$e;function X$e(e,{select:t=!1}={}){const n=document.activeElement;for(const r of e)if(fh(r,{select:t}),document.activeElement!==n)return}function J$e(e){const t=Ane(e),n=Eq(t,e),r=Eq(t.reverse(),e);return[n,r]}function Ane(e){const t=[],n=document.createTreeWalker(e,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)t.push(n.currentNode);return t}function Eq(e,t){for(const n of e)if(!Q$e(n,{upTo:t}))return n}function Q$e(e,{upTo:t}){if(getComputedStyle(e).visibility==="hidden")return!0;for(;e;){if(t!==void 0&&e===t)return!1;if(getComputedStyle(e).display==="none")return!0;e=e.parentElement}return!1}function e9e(e){return e instanceof HTMLInputElement&&"select"in e}function fh(e,{select:t=!1}={}){if(e&&e.focus){const n=document.activeElement;e.focus({preventScroll:!0}),e!==n&&e9e(e)&&t&&e.select()}}var Tq=t9e();function t9e(){let e=[];return{add(t){const n=e[0];t!==n&&(n==null||n.pause()),e=Aq(e,t),e.unshift(t)},remove(t){var n;e=Aq(e,t),(n=e[0])==null||n.resume()}}}function Aq(e,t){const n=[...e],r=n.indexOf(t);return r!==-1&&n.splice(r,1),n}function n9e(e){return e.filter(t=>t.tagName!=="A")}function r9e(e){const t=s9e(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(a9e);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function s9e(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=l9e(s),o=o9e(i,s.props);return s.type!==E.Fragment&&(o.ref=r?pl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var i9e=Symbol("radix.slottable");function a9e(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===i9e}function o9e(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function l9e(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var UT="Dialog",[Rne,Udt]=Yi(UT),[c9e,Hc]=Rne(UT),Nne=e=>{const{__scopeDialog:t,children:n,open:r,defaultOpen:s,onOpenChange:i,modal:a=!0}=e,o=E.useRef(null),l=E.useRef(null),[c,u]=Lc({prop:r,defaultProp:s??!1,onChange:i,caller:UT});return f.jsx(c9e,{scope:t,triggerRef:o,contentRef:l,contentId:ca(),titleId:ca(),descriptionId:ca(),open:c,onOpenChange:u,onOpenToggle:E.useCallback(()=>u(d=>!d),[u]),modal:a,children:n})};Nne.displayName=UT;var Mne="DialogTrigger",u9e=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Hc(Mne,n),i=In(t,s.triggerRef);return f.jsx(cr.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":VF(s.open),...r,ref:i,onClick:Wt(e.onClick,s.onOpenToggle)})});u9e.displayName=Mne;var UF="DialogPortal",[d9e,Ine]=Rne(UF,{forceMount:void 0}),jne=e=>{const{__scopeDialog:t,forceMount:n,children:r,container:s}=e,i=Hc(UF,t);return f.jsx(d9e,{scope:t,forceMount:n,children:E.Children.map(r,a=>f.jsx(fa,{present:n||i.open,children:f.jsx($E,{asChild:!0,container:s,children:a})}))})};jne.displayName=UF;var Mk="DialogOverlay",Pne=E.forwardRef((e,t)=>{const n=Ine(Mk,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=Hc(Mk,e.__scopeDialog);return i.modal?f.jsx(fa,{present:r||i.open,children:f.jsx(h9e,{...s,ref:t})}):null});Pne.displayName=Mk;var f9e=r9e("DialogOverlay.RemoveScroll"),h9e=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Hc(Mk,n);return f.jsx(n_,{as:f9e,allowPinchZoom:!0,shards:[s.contentRef],children:f.jsx(cr.div,{"data-state":VF(s.open),...r,ref:t,style:{pointerEvents:"auto",...r.style}})})}),Dm="DialogContent",One=E.forwardRef((e,t)=>{const n=Ine(Dm,e.__scopeDialog),{forceMount:r=n.forceMount,...s}=e,i=Hc(Dm,e.__scopeDialog);return f.jsx(fa,{present:r||i.open,children:i.modal?f.jsx(p9e,{...s,ref:t}):f.jsx(m9e,{...s,ref:t})})});One.displayName=Dm;var p9e=E.forwardRef((e,t)=>{const n=Hc(Dm,e.__scopeDialog),r=E.useRef(null),s=In(t,n.contentRef,r);return E.useEffect(()=>{const i=r.current;if(i)return PT(i)},[]),f.jsx(Dne,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:Wt(e.onCloseAutoFocus,i=>{var a;i.preventDefault(),(a=n.triggerRef.current)==null||a.focus()}),onPointerDownOutside:Wt(e.onPointerDownOutside,i=>{const a=i.detail.originalEvent,o=a.button===0&&a.ctrlKey===!0;(a.button===2||o)&&i.preventDefault()}),onFocusOutside:Wt(e.onFocusOutside,i=>i.preventDefault())})}),m9e=E.forwardRef((e,t)=>{const n=Hc(Dm,e.__scopeDialog),r=E.useRef(!1),s=E.useRef(!1);return f.jsx(Dne,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:i=>{var a,o;(a=e.onCloseAutoFocus)==null||a.call(e,i),i.defaultPrevented||(r.current||(o=n.triggerRef.current)==null||o.focus(),i.preventDefault()),r.current=!1,s.current=!1},onInteractOutside:i=>{var l,c;(l=e.onInteractOutside)==null||l.call(e,i),i.defaultPrevented||(r.current=!0,i.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const a=i.target;((c=n.triggerRef.current)==null?void 0:c.contains(a))&&i.preventDefault(),i.detail.originalEvent.type==="focusin"&&s.current&&i.preventDefault()}})}),Dne=E.forwardRef((e,t)=>{const{__scopeDialog:n,trapFocus:r,onOpenAutoFocus:s,onCloseAutoFocus:i,...a}=e,o=Hc(Dm,n),l=E.useRef(null),c=In(t,l);return IT(),f.jsxs(f.Fragment,{children:[f.jsx(zF,{asChild:!0,loop:!0,trapped:r,onMountAutoFocus:s,onUnmountAutoFocus:i,children:f.jsx(OE,{role:"dialog",id:o.contentId,"aria-describedby":o.descriptionId,"aria-labelledby":o.titleId,"data-state":VF(o.open),...a,ref:c,onDismiss:()=>o.onOpenChange(!1)})}),f.jsxs(f.Fragment,{children:[f.jsx(g9e,{titleId:o.titleId}),f.jsx(b9e,{contentRef:l,descriptionId:o.descriptionId})]})]})}),qF="DialogTitle",Fne=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Hc(qF,n);return f.jsx(cr.h2,{id:s.titleId,...r,ref:t})});Fne.displayName=qF;var Lne="DialogDescription",Bne=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Hc(Lne,n);return f.jsx(cr.p,{id:s.descriptionId,...r,ref:t})});Bne.displayName=Lne;var $ne="DialogClose",zne=E.forwardRef((e,t)=>{const{__scopeDialog:n,...r}=e,s=Hc($ne,n);return f.jsx(cr.button,{type:"button",...r,ref:t,onClick:Wt(e.onClick,()=>s.onOpenChange(!1))})});zne.displayName=$ne;function VF(e){return e?"open":"closed"}var Une="DialogTitleWarning",[qdt,qne]=Axe(Une,{contentName:Dm,titleName:qF,docsSlug:"dialog"}),g9e=({titleId:e})=>{const t=qne(Une),n=`\`${t.contentName}\` requires a \`${t.titleName}\` for the component to be accessible for screen reader users.

If you want to hide the \`${t.titleName}\`, you can wrap it with our VisuallyHidden component.

For more information, see https://radix-ui.com/primitives/docs/components/${t.docsSlug}`;return E.useEffect(()=>{e&&(document.getElementById(e)||console.error(n))},[n,e]),null},y9e="DialogDescriptionWarning",b9e=({contentRef:e,descriptionId:t})=>{const r=`Warning: Missing \`Description\` or \`aria-describedby={undefined}\` for {${qne(y9e).contentName}}.`;return E.useEffect(()=>{var i;const s=(i=e.current)==null?void 0:i.getAttribute("aria-describedby");t&&s&&(document.getElementById(t)||console.warn(r))},[r,e,t]),null},Vne=Nne,Wne=jne,Hne=Pne,Gne=One,v9e=Fne,x9e=Bne,Kne=zne;function hf({...e}){return f.jsx(Vne,{"data-slot":"dialog",...e})}function w9e({...e}){return f.jsx(Wne,{"data-slot":"dialog-portal",...e})}function _9e({...e}){return f.jsx(Kne,{"data-slot":"dialog-close",...e})}function S9e({className:e,...t}){return f.jsx(Hne,{"data-slot":"dialog-overlay",className:Ze("data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 fixed inset-0 z-50 bg-black/50",e),...t})}function pf({className:e,children:t,...n}){return f.jsxs(w9e,{"data-slot":"dialog-portal",children:[f.jsx(S9e,{}),f.jsxs(Gne,{"data-slot":"dialog-content",className:Ze("bg-background data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 fixed top-[50%] left-[50%] z-50 grid w-full max-w-[calc(100%-2rem)] translate-x-[-50%] translate-y-[-50%] gap-4 rounded-lg border p-6 shadow-lg duration-200 sm:max-w-lg",e),...n,children:[t,f.jsxs(Kne,{className:"ring-offset-background focus:ring-ring data-[state=open]:bg-accent data-[state=open]:text-muted-foreground absolute top-4 right-4 rounded-xs opacity-70 transition-opacity hover:opacity-100 focus:ring-2 focus:ring-offset-2 focus:outline-hidden disabled:pointer-events-none [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",children:[f.jsx(Pi,{}),f.jsx("span",{className:"sr-only",children:"Close"})]})]})]})}function mf({className:e,...t}){return f.jsx("div",{"data-slot":"dialog-header",className:Ze("flex flex-col gap-2 text-center sm:text-left",e),...t})}function xb({className:e,...t}){return f.jsx("div",{"data-slot":"dialog-footer",className:Ze("flex flex-col-reverse gap-2 sm:flex-row sm:justify-end",e),...t})}function gf({className:e,...t}){return f.jsx(v9e,{"data-slot":"dialog-title",className:Ze("text-lg leading-none font-semibold",e),...t})}function mp({className:e,...t}){return f.jsx(x9e,{"data-slot":"dialog-description",className:Ze("text-muted-foreground text-sm",e),...t})}function Rq(e){const t=C9e(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(E9e);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function C9e(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=A9e(s),o=T9e(i,s.props);return s.type!==E.Fragment&&(o.ref=r?pl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var k9e=Symbol("radix.slottable");function E9e(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===k9e}function T9e(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function A9e(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}function WF(e){const t=e+"CollectionProvider",[n,r]=Yi(t),[s,i]=n(t,{collectionRef:{current:null},itemMap:new Map}),a=b=>{const{scope:v,children:x}=b,w=Ve.useRef(null),S=Ve.useRef(new Map).current;return f.jsx(s,{scope:v,itemMap:S,collectionRef:w,children:x})};a.displayName=t;const o=e+"CollectionSlot",l=Rq(o),c=Ve.forwardRef((b,v)=>{const{scope:x,children:w}=b,S=i(o,x),k=In(v,S.collectionRef);return f.jsx(l,{ref:k,children:w})});c.displayName=o;const u=e+"CollectionItemSlot",d="data-radix-collection-item",h=Rq(u),m=Ve.forwardRef((b,v)=>{const{scope:x,children:w,...S}=b,k=Ve.useRef(null),C=In(v,k),T=i(u,x);return Ve.useEffect(()=>(T.itemMap.set(k,{ref:k,...S}),()=>void T.itemMap.delete(k))),f.jsx(h,{[d]:"",ref:C,children:w})});m.displayName=u;function y(b){const v=i(e+"CollectionConsumer",b);return Ve.useCallback(()=>{const w=v.collectionRef.current;if(!w)return[];const S=Array.from(w.querySelectorAll(`[${d}]`));return Array.from(v.itemMap.values()).sort((T,A)=>S.indexOf(T.ref.current)-S.indexOf(A.ref.current))},[v.collectionRef,v.itemMap])}return[{Provider:a,Slot:c,ItemSlot:m},y,r]}var p3="rovingFocusGroup.onEntryFocus",R9e={bubbles:!1,cancelable:!0},s_="RovingFocusGroup",[I4,Yne,N9e]=WF(s_),[M9e,qT]=Yi(s_,[N9e]),[I9e,j9e]=M9e(s_),Zne=E.forwardRef((e,t)=>f.jsx(I4.Provider,{scope:e.__scopeRovingFocusGroup,children:f.jsx(I4.Slot,{scope:e.__scopeRovingFocusGroup,children:f.jsx(P9e,{...e,ref:t})})}));Zne.displayName=s_;var P9e=E.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,orientation:r,loop:s=!1,dir:i,currentTabStopId:a,defaultCurrentTabStopId:o,onCurrentTabStopIdChange:l,onEntryFocus:c,preventScrollOnEntryFocus:u=!1,...d}=e,h=E.useRef(null),m=In(t,h),y=mb(i),[b,v]=Lc({prop:a,defaultProp:o??null,onChange:l,caller:s_}),[x,w]=E.useState(!1),S=Es(c),k=Yne(n),C=E.useRef(!1),[T,A]=E.useState(0);return E.useEffect(()=>{const N=h.current;if(N)return N.addEventListener(p3,S),()=>N.removeEventListener(p3,S)},[S]),f.jsx(I9e,{scope:n,orientation:r,dir:y,loop:s,currentTabStopId:b,onItemFocus:E.useCallback(N=>v(N),[v]),onItemShiftTab:E.useCallback(()=>w(!0),[]),onFocusableItemAdd:E.useCallback(()=>A(N=>N+1),[]),onFocusableItemRemove:E.useCallback(()=>A(N=>N-1),[]),children:f.jsx(cr.div,{tabIndex:x||T===0?-1:0,"data-orientation":r,...d,ref:m,style:{outline:"none",...e.style},onMouseDown:Wt(e.onMouseDown,()=>{C.current=!0}),onFocus:Wt(e.onFocus,N=>{const I=!C.current;if(N.target===N.currentTarget&&I&&!x){const O=new CustomEvent(p3,R9e);if(N.currentTarget.dispatchEvent(O),!O.defaultPrevented){const B=k().filter(U=>U.focusable),D=B.find(U=>U.active),H=B.find(U=>U.id===b),K=[D,H,...B].filter(Boolean).map(U=>U.ref.current);Qne(K,u)}}C.current=!1}),onBlur:Wt(e.onBlur,()=>w(!1))})})}),Xne="RovingFocusGroupItem",Jne=E.forwardRef((e,t)=>{const{__scopeRovingFocusGroup:n,focusable:r=!0,active:s=!1,tabStopId:i,children:a,...o}=e,l=ca(),c=i||l,u=j9e(Xne,n),d=u.currentTabStopId===c,h=Yne(n),{onFocusableItemAdd:m,onFocusableItemRemove:y,currentTabStopId:b}=u;return E.useEffect(()=>{if(r)return m(),()=>y()},[r,m,y]),f.jsx(I4.ItemSlot,{scope:n,id:c,focusable:r,active:s,children:f.jsx(cr.span,{tabIndex:d?0:-1,"data-orientation":u.orientation,...o,ref:t,onMouseDown:Wt(e.onMouseDown,v=>{r?u.onItemFocus(c):v.preventDefault()}),onFocus:Wt(e.onFocus,()=>u.onItemFocus(c)),onKeyDown:Wt(e.onKeyDown,v=>{if(v.key==="Tab"&&v.shiftKey){u.onItemShiftTab();return}if(v.target!==v.currentTarget)return;const x=F9e(v,u.orientation,u.dir);if(x!==void 0){if(v.metaKey||v.ctrlKey||v.altKey||v.shiftKey)return;v.preventDefault();let S=h().filter(k=>k.focusable).map(k=>k.ref.current);if(x==="last")S.reverse();else if(x==="prev"||x==="next"){x==="prev"&&S.reverse();const k=S.indexOf(v.currentTarget);S=u.loop?L9e(S,k+1):S.slice(k+1)}setTimeout(()=>Qne(S))}}),children:typeof a=="function"?a({isCurrentTabStop:d,hasTabStop:b!=null}):a})})});Jne.displayName=Xne;var O9e={ArrowLeft:"prev",ArrowUp:"prev",ArrowRight:"next",ArrowDown:"next",PageUp:"first",Home:"first",PageDown:"last",End:"last"};function D9e(e,t){return t!=="rtl"?e:e==="ArrowLeft"?"ArrowRight":e==="ArrowRight"?"ArrowLeft":e}function F9e(e,t,n){const r=D9e(e.key,n);if(!(t==="vertical"&&["ArrowLeft","ArrowRight"].includes(r))&&!(t==="horizontal"&&["ArrowUp","ArrowDown"].includes(r)))return O9e[r]}function Qne(e,t=!1){const n=document.activeElement;for(const r of e)if(r===n||(r.focus({preventScroll:t}),document.activeElement!==n))return}function L9e(e,t){return e.map((n,r)=>e[(t+r)%e.length])}var ere=Zne,tre=Jne,VT="Tabs",[B9e,Vdt]=Yi(VT,[qT]),nre=qT(),[$9e,HF]=B9e(VT),rre=E.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,onValueChange:s,defaultValue:i,orientation:a="horizontal",dir:o,activationMode:l="automatic",...c}=e,u=mb(o),[d,h]=Lc({prop:r,onChange:s,defaultProp:i??"",caller:VT});return f.jsx($9e,{scope:n,baseId:ca(),value:d,onValueChange:h,orientation:a,dir:u,activationMode:l,children:f.jsx(cr.div,{dir:u,"data-orientation":a,...c,ref:t})})});rre.displayName=VT;var sre="TabsList",ire=E.forwardRef((e,t)=>{const{__scopeTabs:n,loop:r=!0,...s}=e,i=HF(sre,n),a=nre(n);return f.jsx(ere,{asChild:!0,...a,orientation:i.orientation,dir:i.dir,loop:r,children:f.jsx(cr.div,{role:"tablist","aria-orientation":i.orientation,...s,ref:t})})});ire.displayName=sre;var are="TabsTrigger",ore=E.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,disabled:s=!1,...i}=e,a=HF(are,n),o=nre(n),l=ure(a.baseId,r),c=dre(a.baseId,r),u=r===a.value;return f.jsx(tre,{asChild:!0,...o,focusable:!s,active:u,children:f.jsx(cr.button,{type:"button",role:"tab","aria-selected":u,"aria-controls":c,"data-state":u?"active":"inactive","data-disabled":s?"":void 0,disabled:s,id:l,...i,ref:t,onMouseDown:Wt(e.onMouseDown,d=>{!s&&d.button===0&&d.ctrlKey===!1?a.onValueChange(r):d.preventDefault()}),onKeyDown:Wt(e.onKeyDown,d=>{[" ","Enter"].includes(d.key)&&a.onValueChange(r)}),onFocus:Wt(e.onFocus,()=>{const d=a.activationMode!=="manual";!u&&!s&&d&&a.onValueChange(r)})})})});ore.displayName=are;var lre="TabsContent",cre=E.forwardRef((e,t)=>{const{__scopeTabs:n,value:r,forceMount:s,children:i,...a}=e,o=HF(lre,n),l=ure(o.baseId,r),c=dre(o.baseId,r),u=r===o.value,d=E.useRef(u);return E.useEffect(()=>{const h=requestAnimationFrame(()=>d.current=!1);return()=>cancelAnimationFrame(h)},[]),f.jsx(fa,{present:s||u,children:({present:h})=>f.jsx(cr.div,{"data-state":u?"active":"inactive","data-orientation":o.orientation,role:"tabpanel","aria-labelledby":l,hidden:!h,id:c,tabIndex:0,...a,ref:t,style:{...e.style,animationDuration:d.current?"0s":void 0},children:h&&i})})});cre.displayName=lre;function ure(e,t){return`${e}-trigger-${t}`}function dre(e,t){return`${e}-content-${t}`}var z9e=rre,U9e=ire,q9e=ore,V9e=cre;function W9e({className:e,...t}){return f.jsx(z9e,{"data-slot":"tabs",className:Ze("flex flex-col gap-2",e),...t})}function H9e({className:e,...t}){return f.jsx(U9e,{"data-slot":"tabs-list",className:Ze("bg-muted text-muted-foreground inline-flex h-9 w-fit items-center justify-center rounded-lg p-[3px]",e),...t})}function G9e({className:e,...t}){return f.jsx(q9e,{"data-slot":"tabs-trigger",className:Ze("data-[state=active]:bg-background dark:data-[state=active]:text-foreground focus-visible:border-ring focus-visible:ring-ring/50 focus-visible:outline-ring dark:data-[state=active]:border-input dark:data-[state=active]:bg-input/30 text-foreground dark:text-muted-foreground inline-flex h-[calc(100%-1px)] flex-1 items-center justify-center gap-1.5 rounded-md border border-transparent px-2 py-1 text-sm font-medium whitespace-nowrap transition-[color,box-shadow] focus-visible:ring-[3px] focus-visible:outline-1 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:shadow-sm [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}function K9e({className:e,...t}){return f.jsx(V9e,{"data-slot":"tabs-content",className:Ze("flex-1 outline-none",e),...t})}const xl=({tabs:e,defaultValue:t,initialValue:n,onValueChange:r,className:s,listClassName:i,contentContainerClassName:a,scrollable:o})=>{var m;const[l,c]=E.useState(n??t??((m=e[0])==null?void 0:m.value));E.useEffect(()=>{n!==void 0&&n!==l&&c(n)},[n,l]);const u=y=>{c(y),r&&r(y)},d=Ze("px-1 py-0.25 text-xs sm:px-3 sm:py-1.5 sm:text-sm font-medium rounded-md","text-muted-foreground","border border-transparent","focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2","data-[state=active]:bg-primary/10 data-[state=active]:text-primary","data-[state=active]:border-primary","dark:data-[state=active]:bg-primary/20 dark:data-[state=active]:text-primary","dark:data-[state=active]:border-primary/70","hover:bg-muted/50 hover:text-primary/80"),h=({children:y})=>{const v=Ze(o?"flex-grow overflow-y-auto pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2":"flex-grow pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",a);return o?f.jsx(Zl,{className:v,children:y}):f.jsx("div",{className:v,children:y})};return f.jsxs(W9e,{value:l,onValueChange:u,defaultValue:t,className:Ze("flex flex-col h-full",s),children:[f.jsx(H9e,{className:Ze("flex-shrink-0 sticky top-0 bg-background z-10 flex-wrap h-auto justify-start border-b gap-0.5 sm:gap-1 p-0.5 sm:p-1 px-2 sm:px-6",i),children:e.map(y=>f.jsx(G9e,{value:y.value,disabled:y.disabled,className:d,children:y.label},y.value))}),f.jsx(h,{children:e.map(y=>f.jsx(K9e,{value:y.value,className:"data-[state=inactive]:hidden h-full",children:y.content},y.value))})]})},fre=E.memo(({isOpen:e,onClose:t,initialTab:n})=>{const{modSettingsTabs:r}=Wh(yn(u=>({modSettingsTabs:u.modSettingsTabs||[]}))),s=E.useMemo(()=>[...r.map(h=>{const m=h.component;return{value:h.id,label:h.title,content:f.jsx(m,{}),order:h.order??999}})].sort((h,m)=>(h.order??999)-(m.order??999)),[r]),i=E.useCallback(()=>s.length>0?s[0].value:"general",[s]),[a,o]=E.useState(i());E.useEffect(()=>{if(e){let u=i();n&&s.some(d=>d.value===n)?u=n:n&&(console.warn(`[SettingsModal] Initial tab "${n}" not found. Defaulting to "${u}".`),Te.error(`Settings tab "${n}" not found. Opening default tab.`)),o(u)}},[e,n,s,i]);const l=u=>{u||t()},c=u=>{o(u)};return f.jsx(hf,{open:e,onOpenChange:l,children:f.jsxs(pf,{className:Ze("min-w-[95vw] h-[95vh] flex flex-col p-0"),children:[f.jsxs(mf,{className:"p-4 md:p-6 pb-2 md:pb-4 flex-shrink-0",children:[f.jsx(gf,{children:"Settings"}),f.jsx(mp,{children:"Manage application settings, AI behavior, API keys, providers, and data."})]}),s.length>0?f.jsx(xl,{tabs:s,initialValue:a,onValueChange:c,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"flex-grow overflow-y-auto pb-4 md:pb-6",scrollable:!1},a):f.jsx("div",{className:"flex-grow flex items-center justify-center text-muted-foreground p-4",children:"No settings tabs available or still loading. Check console for module registration errors."}),f.jsx(xb,{className:"flex-shrink-0 border-t p-4 md:p-6 pt-3 md:pt-4 mt-auto",children:f.jsx(ct,{variant:"outline",onClick:()=>l(!1),children:"Close"})})]})})});fre.displayName="SettingsModalComponent";const Y9e=fre;class Z9e{constructor(){ue(this,"id","core-settings-trigger");ue(this,"modalId","settingsModal");ue(this,"unregisterChatControlCallback",null);ue(this,"unregisterModalProviderCallback",null);ue(this,"modApiRef",null);ue(this,"openSettingsModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Tr.openModalRequest,{modalId:this.modalId,initialTab:t||"general",initialSubTab:n})});ue(this,"closeSettingsModal",()=>{var t;(t=this.modApiRef)==null||t.emit(Tr.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterChatControlCallback&&this.unregisterModalProviderCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterChatControlCallback||(this.unregisterChatControlCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:()=>Ve.createElement(Cq,{module:this}),iconRenderer:()=>Ve.createElement(Cq,{module:this}),show:()=>!0})),this.unregisterModalProviderCallback||(this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>Ve.createElement(Y9e,{isOpen:n.isOpen,onClose:n.onClose,initialTab:n.initialTab,initialSubTab:n.initialSubTab})))}destroy(){this.unregisterChatControlCallback&&(this.unregisterChatControlCallback(),this.unregisterChatControlCallback=null),this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const X9e=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsSidebarCollapsed();return f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{variant:"ghost",size:"icon",onClick:()=>e.toggleSidebar(),className:"h-8 w-8","aria-label":n?"Expand Sidebar":"Collapse Sidebar",children:n?f.jsx(vge,{className:"h-4 w-4"}):f.jsx(yge,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"top",children:n?"Expand Sidebar":"Collapse Sidebar"})]})})};class J9e{constructor(){ue(this,"id","core-sidebar-toggle");ue(this,"unregisterCallback",null);ue(this,"notifyComponentUpdate",null);ue(this,"modApiRef",null);ue(this,"getIsSidebarCollapsed",()=>Xw.getState().isSidebarCollapsed);ue(this,"toggleSidebar",t=>{var s,i;const n=Xw.getState().isSidebarCollapsed,r=t??!n;n!==r&&((s=this.modApiRef)==null||s.emit(Tr.toggleSidebarRequest,{isCollapsed:r}),(i=this.notifyComponentUpdate)==null||i.call(this))});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>Ve.createElement(X9e,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}function My({form:e,name:t,label:n,placeholder:r,disabled:s,wrapperClassName:i,allowNull:a=!1,min:o,max:l,step:c,className:u,onBlurInput:d,...h}){return f.jsx(e.Field,{name:t,children:m=>{const y=x=>{const w=x.target.value;if(w===""&&a)m.handleChange(null);else{const S=parseFloat(w);isNaN(S)?w===""&&!a&&m.handleChange(w):m.handleChange(S)}},b=typeof m.state.value=="number"?m.state.value.toString():(m.state.value===null&&a,""),v=x=>{m.handleBlur(),d&&d(x)};return f.jsxs("div",{className:Ze("space-y-1.5",i),children:[" ",f.jsx(jt,{htmlFor:m.name,className:"text-sm",children:n}),f.jsx(xn,{id:m.name,name:m.name,type:"number",value:b,onBlur:v,onChange:y,placeholder:r,disabled:s??m.form.state.isSubmitting,min:o,max:l,step:c,className:Ze(u,m.state.meta.errors.length?"border-destructive":""),...h}),f.jsx(ji,{field:m})]})}})}var hre=["PageUp","PageDown"],pre=["ArrowUp","ArrowDown","ArrowLeft","ArrowRight"],mre={"from-left":["Home","PageDown","ArrowDown","ArrowLeft"],"from-right":["Home","PageDown","ArrowDown","ArrowRight"],"from-bottom":["Home","PageDown","ArrowDown","ArrowLeft"],"from-top":["Home","PageDown","ArrowUp","ArrowLeft"]},wb="Slider",[j4,Q9e,eze]=WF(wb),[gre,Wdt]=Yi(wb,[eze]),[tze,WT]=gre(wb),yre=E.forwardRef((e,t)=>{const{name:n,min:r=0,max:s=100,step:i=1,orientation:a="horizontal",disabled:o=!1,minStepsBetweenThumbs:l=0,defaultValue:c=[r],value:u,onValueChange:d=()=>{},onValueCommit:h=()=>{},inverted:m=!1,form:y,...b}=e,v=E.useRef(new Set),x=E.useRef(0),S=a==="horizontal"?nze:rze,[k=[],C]=Lc({prop:u,defaultProp:c,onChange:B=>{var H;(H=[...v.current][x.current])==null||H.focus(),d(B)}}),T=E.useRef(k);function A(B){const D=lze(k,B);O(B,D)}function N(B){O(B,x.current)}function I(){const B=T.current[x.current];k[x.current]!==B&&h(k)}function O(B,D,{commit:H}={commit:!1}){const P=fze(i),K=hze(Math.round((B-r)/i)*i+r,P),U=zw(K,[r,s]);C((V=[])=>{const L=aze(V,U,D);if(dze(L,l*i)){x.current=L.indexOf(U);const te=String(L)!==String(V);return te&&H&&h(L),te?L:V}else return V})}return f.jsx(tze,{scope:e.__scopeSlider,name:n,disabled:o,min:r,max:s,valueIndexToChangeRef:x,thumbs:v.current,values:k,orientation:a,form:y,children:f.jsx(j4.Provider,{scope:e.__scopeSlider,children:f.jsx(j4.Slot,{scope:e.__scopeSlider,children:f.jsx(S,{"aria-disabled":o,"data-disabled":o?"":void 0,...b,ref:t,onPointerDown:Wt(b.onPointerDown,()=>{o||(T.current=k)}),min:r,max:s,inverted:m,onSlideStart:o?void 0:A,onSlideMove:o?void 0:N,onSlideEnd:o?void 0:I,onHomeKeyDown:()=>!o&&O(r,0,{commit:!0}),onEndKeyDown:()=>!o&&O(s,k.length-1,{commit:!0}),onStepKeyDown:({event:B,direction:D})=>{if(!o){const K=hre.includes(B.key)||B.shiftKey&&pre.includes(B.key)?10:1,U=x.current,V=k[U],L=i*K*D;O(V+L,U,{commit:!0})}}})})})})});yre.displayName=wb;var[bre,vre]=gre(wb,{startEdge:"left",endEdge:"right",size:"width",direction:1}),nze=E.forwardRef((e,t)=>{const{min:n,max:r,dir:s,inverted:i,onSlideStart:a,onSlideMove:o,onSlideEnd:l,onStepKeyDown:c,...u}=e,[d,h]=E.useState(null),m=In(t,S=>h(S)),y=E.useRef(void 0),b=mb(s),v=b==="ltr",x=v&&!i||!v&&i;function w(S){const k=y.current||d.getBoundingClientRect(),C=[0,k.width],A=GF(C,x?[n,r]:[r,n]);return y.current=k,A(S-k.left)}return f.jsx(bre,{scope:e.__scopeSlider,startEdge:x?"left":"right",endEdge:x?"right":"left",direction:x?1:-1,size:"width",children:f.jsx(xre,{dir:b,"data-orientation":"horizontal",...u,ref:m,style:{...u.style,"--radix-slider-thumb-transform":"translateX(-50%)"},onSlideStart:S=>{const k=w(S.clientX);a==null||a(k)},onSlideMove:S=>{const k=w(S.clientX);o==null||o(k)},onSlideEnd:()=>{y.current=void 0,l==null||l()},onStepKeyDown:S=>{const C=mre[x?"from-left":"from-right"].includes(S.key);c==null||c({event:S,direction:C?-1:1})}})})}),rze=E.forwardRef((e,t)=>{const{min:n,max:r,inverted:s,onSlideStart:i,onSlideMove:a,onSlideEnd:o,onStepKeyDown:l,...c}=e,u=E.useRef(null),d=In(t,u),h=E.useRef(void 0),m=!s;function y(b){const v=h.current||u.current.getBoundingClientRect(),x=[0,v.height],S=GF(x,m?[r,n]:[n,r]);return h.current=v,S(b-v.top)}return f.jsx(bre,{scope:e.__scopeSlider,startEdge:m?"bottom":"top",endEdge:m?"top":"bottom",size:"height",direction:m?1:-1,children:f.jsx(xre,{"data-orientation":"vertical",...c,ref:d,style:{...c.style,"--radix-slider-thumb-transform":"translateY(50%)"},onSlideStart:b=>{const v=y(b.clientY);i==null||i(v)},onSlideMove:b=>{const v=y(b.clientY);a==null||a(v)},onSlideEnd:()=>{h.current=void 0,o==null||o()},onStepKeyDown:b=>{const x=mre[m?"from-bottom":"from-top"].includes(b.key);l==null||l({event:b,direction:x?-1:1})}})})}),xre=E.forwardRef((e,t)=>{const{__scopeSlider:n,onSlideStart:r,onSlideMove:s,onSlideEnd:i,onHomeKeyDown:a,onEndKeyDown:o,onStepKeyDown:l,...c}=e,u=WT(wb,n);return f.jsx(cr.span,{...c,ref:t,onKeyDown:Wt(e.onKeyDown,d=>{d.key==="Home"?(a(d),d.preventDefault()):d.key==="End"?(o(d),d.preventDefault()):hre.concat(pre).includes(d.key)&&(l(d),d.preventDefault())}),onPointerDown:Wt(e.onPointerDown,d=>{const h=d.target;h.setPointerCapture(d.pointerId),d.preventDefault(),u.thumbs.has(h)?h.focus():r(d)}),onPointerMove:Wt(e.onPointerMove,d=>{d.target.hasPointerCapture(d.pointerId)&&s(d)}),onPointerUp:Wt(e.onPointerUp,d=>{const h=d.target;h.hasPointerCapture(d.pointerId)&&(h.releasePointerCapture(d.pointerId),i(d))})})}),wre="SliderTrack",_re=E.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=WT(wre,n);return f.jsx(cr.span,{"data-disabled":s.disabled?"":void 0,"data-orientation":s.orientation,...r,ref:t})});_re.displayName=wre;var P4="SliderRange",Sre=E.forwardRef((e,t)=>{const{__scopeSlider:n,...r}=e,s=WT(P4,n),i=vre(P4,n),a=E.useRef(null),o=In(t,a),l=s.values.length,c=s.values.map(h=>Ere(h,s.min,s.max)),u=l>1?Math.min(...c):0,d=100-Math.max(...c);return f.jsx(cr.span,{"data-orientation":s.orientation,"data-disabled":s.disabled?"":void 0,...r,ref:o,style:{...e.style,[i.startEdge]:u+"%",[i.endEdge]:d+"%"}})});Sre.displayName=P4;var O4="SliderThumb",Cre=E.forwardRef((e,t)=>{const n=Q9e(e.__scopeSlider),[r,s]=E.useState(null),i=In(t,o=>s(o)),a=E.useMemo(()=>r?n().findIndex(o=>o.ref.current===r):-1,[n,r]);return f.jsx(sze,{...e,ref:i,index:a})}),sze=E.forwardRef((e,t)=>{const{__scopeSlider:n,index:r,name:s,...i}=e,a=WT(O4,n),o=vre(O4,n),[l,c]=E.useState(null),u=In(t,w=>c(w)),d=l?a.form||!!l.closest("form"):!0,h=Jy(l),m=a.values[r],y=m===void 0?0:Ere(m,a.min,a.max),b=oze(r,a.values.length),v=h==null?void 0:h[o.size],x=v?cze(v,y,o.direction):0;return E.useEffect(()=>{if(l)return a.thumbs.add(l),()=>{a.thumbs.delete(l)}},[l,a.thumbs]),f.jsxs("span",{style:{transform:"var(--radix-slider-thumb-transform)",position:"absolute",[o.startEdge]:`calc(${y}% + ${x}px)`},children:[f.jsx(j4.ItemSlot,{scope:e.__scopeSlider,children:f.jsx(cr.span,{role:"slider","aria-label":e["aria-label"]||b,"aria-valuemin":a.min,"aria-valuenow":m,"aria-valuemax":a.max,"aria-orientation":a.orientation,"data-orientation":a.orientation,"data-disabled":a.disabled?"":void 0,tabIndex:a.disabled?void 0:0,...i,ref:u,style:m===void 0?{display:"none"}:e.style,onFocus:Wt(e.onFocus,()=>{a.valueIndexToChangeRef.current=r})})}),d&&f.jsx(kre,{name:s??(a.name?a.name+(a.values.length>1?"[]":""):void 0),form:a.form,value:m},r)]})});Cre.displayName=O4;var ize="RadioBubbleInput",kre=E.forwardRef(({__scopeSlider:e,value:t,...n},r)=>{const s=E.useRef(null),i=In(s,r),a=jT(t);return E.useEffect(()=>{const o=s.current;if(!o)return;const l=window.HTMLInputElement.prototype,u=Object.getOwnPropertyDescriptor(l,"value").set;if(a!==t&&u){const d=new Event("input",{bubbles:!0});u.call(o,t),o.dispatchEvent(d)}},[a,t]),f.jsx(cr.input,{style:{display:"none"},...n,ref:i,defaultValue:t})});kre.displayName=ize;function aze(e=[],t,n){const r=[...e];return r[n]=t,r.sort((s,i)=>s-i)}function Ere(e,t,n){const i=100/(n-t)*(e-t);return zw(i,[0,100])}function oze(e,t){return t>2?`Value ${e+1} of ${t}`:t===2?["Minimum","Maximum"][e]:void 0}function lze(e,t){if(e.length===1)return 0;const n=e.map(s=>Math.abs(s-t)),r=Math.min(...n);return n.indexOf(r)}function cze(e,t,n){const r=e/2,i=GF([0,50],[0,r]);return(r-i(t)*n)*n}function uze(e){return e.slice(0,-1).map((t,n)=>e[n+1]-t)}function dze(e,t){if(t>0){const n=uze(e);return Math.min(...n)>=t}return!0}function GF(e,t){return n=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const r=(t[1]-t[0])/(e[1]-e[0]);return t[0]+r*(n-e[0])}}function fze(e){return(String(e).split(".")[1]||"").length}function hze(e,t){const n=Math.pow(10,t);return Math.round(e*n)/n}var pze=yre,mze=_re,gze=Sre,yze=Cre;function I0({className:e,defaultValue:t,value:n,min:r=0,max:s=100,...i}){const a=E.useMemo(()=>Array.isArray(n)?n:Array.isArray(t)?t:[r,s],[n,t,r,s]);return f.jsxs(pze,{"data-slot":"slider",defaultValue:t,value:n,min:r,max:s,className:Ze("relative flex w-full touch-none items-center select-none data-[disabled]:opacity-50 data-[orientation=vertical]:h-full data-[orientation=vertical]:min-h-44 data-[orientation=vertical]:w-auto data-[orientation=vertical]:flex-col",e),...i,children:[f.jsx(mze,{"data-slot":"slider-track",className:Ze("bg-muted relative grow overflow-hidden rounded-full data-[orientation=horizontal]:h-1.5 data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-1.5"),children:f.jsx(gze,{"data-slot":"slider-range",className:Ze("bg-primary absolute data-[orientation=horizontal]:h-full data-[orientation=vertical]:w-full")})}),Array.from({length:a.length},(o,l)=>f.jsx(yze,{"data-slot":"slider-thumb",className:"border-primary bg-background ring-ring/50 block size-4 shrink-0 rounded-full border shadow-sm transition-[color,box-shadow] hover:ring-4 focus-visible:ring-4 focus-visible:outline-hidden disabled:pointer-events-none disabled:opacity-50"},l))]})}function Cc({form:e,name:t,label:n,valueLabelPrefix:r="",valueLabelSuffix:s="",valueDisplayPrecision:i=2,showRawValue:a=!1,disabled:o,wrapperClassName:l,className:c,min:u,max:d,step:h,...m}){return f.jsx(e.Field,{name:t,children:y=>{const b=typeof y.state.value=="number"?y.state.value:u??0,v=b.toFixed(i);return f.jsxs("div",{className:Ze("space-y-1.5",l),children:[f.jsxs(jt,{htmlFor:y.name,className:"text-sm",children:[n," (",r,v,s,")",a&&f.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(Raw: ",y.state.value,")"]})]}),f.jsx(I0,{id:y.name,name:y.name,value:[b],onValueChange:x=>y.handleChange(x[0]),onBlur:y.handleBlur,disabled:o??y.form.state.isSubmitting,min:u,max:d,step:h,className:Ze(c,y.state.meta.errors.length?"border-destructive":""),...m}),f.jsx(ji,{field:y})]})}})}const bze=Ke({temperature:At().min(0).max(1),topP:At().min(0).max(1),maxTokens:At().min(1).nullable(),topK:At().min(1).nullable(),presencePenalty:At().min(-2).max(2),frequencyPenalty:At().min(-2).max(2)}),vze=({module:e,className:t})=>{const n=ii({defaultValues:{temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0},validators:{onChangeAsync:bze,onChangeAsyncDebounceMs:500}});E.useEffect(()=>{n.reset({temperature:e.temperature??e.defaultTemperature??.7,topP:e.topP??e.defaultTopP??1,maxTokens:e.maxTokens??e.defaultMaxTokens??null,topK:e.topK??e.defaultTopK??null,presencePenalty:e.presencePenalty??e.defaultPresencePenalty??0,frequencyPenalty:e.frequencyPenalty??e.defaultFrequencyPenalty??0})},[e.temperature,e.defaultTemperature,e.topP,e.defaultTopP,e.maxTokens,e.defaultMaxTokens,e.topK,e.defaultTopK,e.presencePenalty,e.defaultPresencePenalty,e.frequencyPenalty,e.defaultFrequencyPenalty]);const[,r]=Ve.useState({});E.useEffect(()=>{const u=()=>r({});return e.setNotifyCallback(u),()=>e.setNotifyCallback(null)},[e]);const s=E.useCallback((u,d,h)=>{var m;((m=n.getFieldMeta(u))==null?void 0:m.errors.length)===0&&d(h)},[n,e]),i=E.useCallback((u,d)=>{var h;if(((h=n.getFieldMeta(u))==null?void 0:h.errors.length)===0){const m=n.getFieldValue(u);d(m)}},[n,e]),a=E.useCallback((u,d,h)=>{n.setFieldValue(u,h),d(null)},[n,e]),o=e.supportedParams,l=e.defaultTemperature!==void 0||e.defaultTopP!==void 0||e.defaultMaxTokens!==void 0||e.defaultTopK!==void 0||e.defaultPresencePenalty!==void 0||e.defaultFrequencyPenalty!==void 0,c=(u,d,h,m,y="N/A")=>{var b;return!l||m===void 0?null:f.jsxs(ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a(u,h,m??null),disabled:d===null,children:["Use Default (",((b=m==null?void 0:m.toFixed)==null?void 0:b.call(m,2))??y,")"]})};return f.jsxs("div",{className:Ze("space-y-4 p-4",t),children:[o.has("temperature")&&f.jsxs("div",{className:"space-y-0.5",children:[" ",f.jsx(Cc,{form:n,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("temperature",e.setTemperature,u[0]),wrapperClassName:"text-xs"}),c("temperature",e.temperature,e.setTemperature,e.defaultTemperature,"0.70")]}),o.has("top_p")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Cc,{form:n,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("topP",e.setTopP,u[0]),wrapperClassName:"text-xs"}),c("topP",e.topP,e.setTopP,e.defaultTopP,"1.00")]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-start",children:[" ",o.has("max_tokens")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(My,{form:n,name:"maxTokens",label:"Max Tokens",placeholder:`Default: ${e.defaultMaxTokens??"None"}`,min:1,allowNull:!0,onBlurInput:()=>i("maxTokens",e.setMaxTokens),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("maxTokens",e.maxTokens,e.setMaxTokens,e.defaultMaxTokens,"None")]}),o.has("top_k")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(My,{form:n,name:"topK",label:"Top K",placeholder:`Default: ${e.defaultTopK??"None"}`,min:1,allowNull:!0,onBlurInput:()=>i("topK",e.setTopK),className:"h-8 text-xs",wrapperClassName:"text-xs"}),c("topK",e.topK,e.setTopK,e.defaultTopK,"None")]})]}),o.has("presence_penalty")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Cc,{form:n,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("presencePenalty",e.setPresencePenalty,u[0]),wrapperClassName:"text-xs"}),c("presencePenalty",e.presencePenalty,e.setPresencePenalty,e.defaultPresencePenalty,"0.00")]}),o.has("frequency_penalty")&&f.jsxs("div",{className:"space-y-0.5",children:[f.jsx(Cc,{form:n,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,onValueCommit:u=>s("frequencyPenalty",e.setFrequencyPenalty,u[0]),wrapperClassName:"text-xs"}),c("frequencyPenalty",e.frequencyPenalty,e.setFrequencyPenalty,e.defaultFrequencyPenalty,"0.00")]})]})},xze=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getIsStreaming();return e.getIsVisible()?f.jsxs(ic,{children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ac,{asChild:!0,children:f.jsx(ct,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:n,"aria-label":"Adjust Advanced Parameters",children:f.jsx(qge,{className:"h-4 w-4"})})})}),f.jsx(Cr,{side:"top",children:"Advanced Parameters"})]})}),f.jsx(oc,{className:"w-auto p-0",align:"start",children:f.jsx(vze,{module:e})})]}):null};class wze{constructor(){ue(this,"id","core-parameters");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"temperature",null);ue(this,"topP",null);ue(this,"maxTokens",null);ue(this,"topK",null);ue(this,"presencePenalty",null);ue(this,"frequencyPenalty",null);ue(this,"defaultTemperature",null);ue(this,"defaultTopP",null);ue(this,"defaultMaxTokens",null);ue(this,"defaultTopK",null);ue(this,"defaultPresencePenalty",null);ue(this,"defaultFrequencyPenalty",null);ue(this,"isStreaming",!1);ue(this,"isVisible",!0);ue(this,"supportedParams",new Set);ue(this,"notifyComponentUpdate",null);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"getIsVisible",()=>this.isVisible);ue(this,"setTemperature",t=>{var n,r;this.temperature=t,(n=this.modApiRef)==null||n.emit(sn.setTemperatureRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setTopP",t=>{var n,r;this.topP=t,(n=this.modApiRef)==null||n.emit(sn.setTopPRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setMaxTokens",t=>{var n,r;this.maxTokens=t,(n=this.modApiRef)==null||n.emit(sn.setMaxTokensRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setTopK",t=>{var n,r;this.topK=t,(n=this.modApiRef)==null||n.emit(sn.setTopKRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setPresencePenalty",t=>{var n,r;this.presencePenalty=t,(n=this.modApiRef)==null||n.emit(sn.setPresencePenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setFrequencyPenalty",t=>{var n,r;this.frequencyPenalty=t,(n=this.modApiRef)==null||n.emit(sn.setFrequencyPenaltyRequest,{value:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState(),this.updateSupportedParams();const n=t.on(En.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Wn.selectedModelChanged,()=>{var a;this.updateSupportedParams(),this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(an.enableAdvancedSettingsChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(sn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;let c=!1;"temperature"in l&&this.temperature!==l.temperature&&(this.temperature=l.temperature??null,c=!0),"topP"in l&&this.topP!==l.topP&&(this.topP=l.topP??null,c=!0),"maxTokens"in l&&this.maxTokens!==l.maxTokens&&(this.maxTokens=l.maxTokens??null,c=!0),"topK"in l&&this.topK!==l.topK&&(this.topK=l.topK??null,c=!0),"presencePenalty"in l&&this.presencePenalty!==l.presencePenalty&&(this.presencePenalty=l.presencePenalty??null,c=!0),"frequencyPenalty"in l&&this.frequencyPenalty!==l.frequencyPenalty&&(this.frequencyPenalty=l.frequencyPenalty??null,c=!0),c&&((o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s,i)}loadInitialState(){const t=pr.getState(),n=Yl.getState();this.isStreaming=un.getState().status==="streaming",this.temperature=n.temperature,this.topP=n.topP,this.maxTokens=n.maxTokens,this.topK=n.topK,this.presencePenalty=n.presencePenalty,this.frequencyPenalty=n.frequencyPenalty,this.defaultTemperature=t.temperature,this.defaultTopP=t.topP,this.defaultMaxTokens=t.maxTokens,this.defaultTopK=t.topK,this.defaultPresencePenalty=t.presencePenalty,this.defaultFrequencyPenalty=t.frequencyPenalty,this.updateVisibility()}updateSupportedParams(){var o;const t=Qn.getState();if(!t.selectedModelId){this.supportedParams=new Set;return}const{providerId:n,modelId:r}=Ac(t.selectedModelId);if(!n||!r){this.supportedParams=new Set;return}const s=t.dbProviderConfigs.find(l=>l.id===n);if(!s){this.supportedParams=new Set;return}const i=t.dbApiKeys.find(l=>l.id===s.apiKeyId),a=zG(s,r,i==null?void 0:i.value);this.supportedParams=new Set(((o=a==null?void 0:a.metadata)==null?void 0:o.supported_parameters)??[])}updateVisibility(){const r=pr.getState().enableAdvancedSettings&&["temperature","top_p","max_tokens","top_k","presence_penalty","frequency_penalty"].some(s=>this.supportedParams.has(s));this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(xze,{module:this}),getParameters:()=>{const n={},r=(s,i)=>{i!==null&&(n[s]=i)};return r("temperature",this.temperature),r("top_p",this.topP),r("max_tokens",this.maxTokens),r("top_k",this.topK),r("presence_penalty",this.presencePenalty),r("frequency_penalty",this.frequencyPenalty),Object.keys(n).length>0?n:void 0}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const _ze=({module:e})=>{const t=E.useRef(null),[,n]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>n({})),()=>e.setNotifyCallback(null)),[e]);const r=e.getIsStreaming(),s=e.getModelSupportsNonText(),i=E.useCallback(async l=>{const c=l.target.files;if(c){for(const u of Array.from(c))try{let d={};const h=e.isLikelyTextFile(u.name,u.type),m=u.type.startsWith("image/");if(h)d.contentText=await u.text();else if(m&&s){const y=new FileReader,b=new Promise((x,w)=>{y.onload=()=>x(y.result),y.onerror=S=>w(S)});y.readAsDataURL(u);const v=await b;v&&v.includes(",")&&(d.contentBase64=v.split(",")[1])}e.onFileAdd({source:"direct",name:u.name,type:u.type||"application/octet-stream",size:u.size,...d})}catch(d){console.error(`Error processing file ${u.name}:`,d),Te.error(`Failed to process file "${u.name}": ${d instanceof Error?d.message:String(d)}`)}l.target&&(l.target.value="")}},[e,s]),a=()=>{var l;(l=t.current)==null||l.click()},o=s?"Attach Files (Text, Images, etc.)":"Attach Text Files";return f.jsxs(f.Fragment,{children:[f.jsx("input",{type:"file",ref:t,onChange:i,multiple:!0,className:"hidden",disabled:r}),f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{type:"button",variant:"ghost",size:"icon",onClick:a,disabled:r,className:"h-8 w-8","aria-label":o,children:f.jsx(SE,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"top",children:o})]})})]})},Sze=({module:e})=>{const[,t]=E.useState({}),n=e.getAttachedFiles(),r=e.getIsStreaming();return E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),n.length===0?null:f.jsx("div",{className:Ze("max-h-40 overflow-y-auto pr-1","flex flex-wrap gap-1"),children:n.map(s=>f.jsx(PZ,{fileMeta:s,onRemove:e.onFileRemove,isReadOnly:r},s.id))})},Tre=20,Cze=Tre*1024*1024;class kze{constructor(){ue(this,"id","core-file-attachment");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"isStreaming",!1);ue(this,"modelSupportsNonText",!0);ue(this,"attachedFiles",[]);ue(this,"notifyComponentUpdate",null);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"getModelSupportsNonText",()=>this.modelSupportsNonText);ue(this,"getAttachedFiles",()=>this.attachedFiles);ue(this,"isLikelyTextFile",(t,n)=>tw(t,n));ue(this,"onFileAdd",t=>{var r;if(t.size>Cze){Te.error(`File "${t.name}" exceeds the ${Tre}MB limit.`);return}if(!tw(t.name,t.type)&&!this.modelSupportsNonText){Te.warning(`File "${t.name}" (${t.type}) cannot be uploaded. The current model only supports text input.`);return}(r=this.modApiRef)==null||r.emit(Ul.addAttachedFileRequest,t)});ue(this,"onFileRemove",t=>{var n;(n=this.modApiRef)==null||n.emit(Ul.removeAttachedFileRequest,{attachmentId:t})});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.isStreaming=un.getState().status==="streaming",this.attachedFiles=Nh.getState().attachedFilesMetadata,this.updateModelSupport(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(En.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Wn.selectedModelChanged,()=>{var a;this.updateModelSupport(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(Ul.attachedFilesChanged,a=>{var o;typeof a=="object"&&a&&"files"in a&&JSON.stringify(this.attachedFiles)!==JSON.stringify(a.files)&&(this.attachedFiles=a.files,(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(n,r,s)}updateModelSupport(){var i,a;const{getSelectedModel:t}=Qn.getState(),n=t(),r=(a=(i=n==null?void 0:n.metadata)==null?void 0:i.architecture)==null?void 0:a.input_modalities,s=!r||r.some(o=>o!=="text");this.modelSupportsNonText!==s&&(this.modelSupportsNonText=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>Ve.createElement(_ze,{module:this}),renderer:()=>Ve.createElement(Sze,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Eze=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>{if(e&&typeof e.setNotifyTriggerUpdate=="function")return e.setNotifyTriggerUpdate(()=>t({})),()=>{e&&typeof e.setNotifyTriggerUpdate=="function"&&e.setNotifyTriggerUpdate(null)}},[e]);const n=e&&typeof e.getIsVfsModalOpen=="function"?e.getIsVfsModalOpen():!1,r=e&&typeof e.getSelectedFileIdsCount=="function"?e.getSelectedFileIdsCount():0,s=e&&typeof e.getEnableVfs=="function"?e.getEnableVfs():!1,i=Nh.getState().addAttachedFile,a=()=>{const o=ei.getState().selectedFileIds;if(o.size===0){Te.info("No files selected in VFS to attach.");return}let l=0;const c=e.getVfsNodes();o.forEach(u=>{const d=c[u];d&&d.type==="file"&&(i({source:"vfs",name:d.name,type:d.mimeType||"application/octet-stream",size:d.size,path:d.path}),l++)}),l>0?(Te.success(`Attached ${l} file(s) from VFS to the next prompt.`),typeof e.clearVfsSelection=="function"&&e.clearVfsSelection(),e.toggleVfsModal):Te.warning("No valid files were selected to attach.")};return s?f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{variant:"ghost",size:"icon",className:Ze("h-8 w-8",n&&"bg-muted text-primary"),onClick:()=>e&&typeof e.toggleVfsModal=="function"&&e.toggleVfsModal(),"aria-label":"Toggle Virtual File System",children:f.jsx(GP,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"top",children:"Virtual Filesystem"})]})}),r>0&&f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsxs(ct,{variant:"secondary",size:"sm",className:"h-8 animate-fadeIn px-2",onClick:a,"aria-label":`Attach ${r} selected VFS file(s)`,children:[f.jsx(SE,{className:"h-4 w-4 mr-1"}),"Attach (",r,")"]})}),f.jsx(Cr,{side:"top",children:"Attach selected VFS files to prompt"})]})})]}):null};function yf({className:e,...t}){return f.jsx("div",{"data-slot":"table-container",className:"relative w-full overflow-x-auto",children:f.jsx("table",{"data-slot":"table",className:Ze("w-full caption-bottom text-sm",e),...t})})}function gp({className:e,...t}){return f.jsx("thead",{"data-slot":"table-header",className:Ze("[&_tr]:border-b",e),...t})}function bf({className:e,...t}){return f.jsx("tbody",{"data-slot":"table-body",className:Ze("[&_tr:last-child]:border-0",e),...t})}function Ts({className:e,...t}){return f.jsx("tr",{"data-slot":"table-row",className:Ze("hover:bg-muted/50 data-[state=selected]:bg-muted border-b transition-colors",e),...t})}function Rr({className:e,...t}){return f.jsx("th",{"data-slot":"table-head",className:Ze("text-foreground h-10 px-2 text-left align-middle font-medium whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function Ln({className:e,...t}){return f.jsx("td",{"data-slot":"table-cell",className:Ze("p-2 align-middle whitespace-nowrap [&:has([role=checkbox])]:pr-0 [&>[role=checkbox]]:translate-y-[2px]",e),...t})}function Tze({className:e,...t}){return f.jsx("caption",{"data-slot":"table-caption",className:Ze("text-muted-foreground mt-4 text-sm",e),...t})}const Are=({newFolderName:e,setNewFolderName:t,handleCreateFolder:n,cancelCreatingFolder:r,newFolderInputRef:s,isOperationLoading:i,isMobile:a=!1})=>{const o=l=>{l.key==="Enter"?n():l.key==="Escape"&&r()};return a?f.jsxs("div",{className:"flex items-center gap-2 p-1",children:[f.jsx(Th,{className:"h-5 w-5 text-yellow-400 flex-shrink-0"}),f.jsx(xn,{ref:s,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary flex-grow",placeholder:"New folder name",disabled:i}),f.jsxs("div",{className:"flex items-center gap-0.5 flex-shrink-0",children:[f.jsx(ct,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?f.jsx(Jn,{className:"h-4 w-4 animate-spin"}):f.jsx(co,{className:"h-4 w-4"})}),f.jsx(ct,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:f.jsx(Pi,{className:"h-4 w-4"})})]})]}):f.jsxs(Ts,{className:"bg-muted/30",children:[f.jsx(Ln,{className:"px-2 py-1"}),f.jsx(Ln,{className:"px-2 py-1",children:f.jsx(Th,{className:"h-5 w-5 text-yellow-400"})}),f.jsx(Ln,{className:"py-1 px-2",colSpan:3,children:f.jsx(xn,{ref:s,value:e,onChange:l=>t(l.target.value),onBlur:n,onKeyDown:o,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",placeholder:"New folder name",disabled:i})}),f.jsx(Ln,{className:"text-right pr-4 py-1",children:f.jsxs("div",{className:"flex items-center justify-end gap-0.5",children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{variant:"ghost",size:"icon",className:"h-6 w-6 text-green-500 hover:text-green-400",onClick:n,"aria-label":"Create folder",disabled:i||!e.trim(),children:i?f.jsx(Jn,{className:"h-4 w-4 animate-spin"}):f.jsx(co,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"top",children:"Create (Enter)"})]})}),f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{variant:"ghost",size:"icon",className:"h-6 w-6 text-muted-foreground hover:text-foreground",onClick:r,"aria-label":"Cancel create folder",disabled:i,children:f.jsx(Pi,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"top",children:"Cancel (Esc)"})]})})]})})]})};function Aze(e){const t=Rze(e),n=E.forwardRef((r,s)=>{const{children:i,...a}=r,o=E.Children.toArray(i),l=o.find(Mze);if(l){const c=l.props.children,u=o.map(d=>d===l?E.Children.count(c)>1?E.Children.only(null):E.isValidElement(c)?c.props.children:null:d);return f.jsx(t,{...a,ref:s,children:E.isValidElement(c)?E.cloneElement(c,void 0,u):null})}return f.jsx(t,{...a,ref:s,children:i})});return n.displayName=`${e}.Slot`,n}function Rze(e){const t=E.forwardRef((n,r)=>{const{children:s,...i}=n;if(E.isValidElement(s)){const a=jze(s),o=Ize(i,s.props);return s.type!==E.Fragment&&(o.ref=r?pl(r,a):a),E.cloneElement(s,o)}return E.Children.count(s)>1?E.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Nze=Symbol("radix.slottable");function Mze(e){return E.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Nze}function Ize(e,t){const n={...t};for(const r in t){const s=e[r],i=t[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...e,...n}}function jze(e){var r,s;let t=(r=Object.getOwnPropertyDescriptor(e.props,"ref"))==null?void 0:r.get,n=t&&"isReactWarning"in t&&t.isReactWarning;return n?e.ref:(t=(s=Object.getOwnPropertyDescriptor(e,"ref"))==null?void 0:s.get,n=t&&"isReactWarning"in t&&t.isReactWarning,n?e.props.ref:e.props.ref||e.ref)}var D4=["Enter"," "],Pze=["ArrowDown","PageUp","Home"],Rre=["ArrowUp","PageDown","End"],Oze=[...Pze,...Rre],Dze={ltr:[...D4,"ArrowRight"],rtl:[...D4,"ArrowLeft"]},Fze={ltr:["ArrowLeft"],rtl:["ArrowRight"]},i_="Menu",[Qw,Lze,Bze]=WF(i_),[sg,HT]=Yi(i_,[Bze,BE,qT]),GT=BE(),Nre=qT(),[$ze,ig]=sg(i_),[zze,a_]=sg(i_),Mre=e=>{const{__scopeMenu:t,open:n=!1,children:r,dir:s,onOpenChange:i,modal:a=!0}=e,o=GT(t),[l,c]=E.useState(null),u=E.useRef(!1),d=Es(i),h=mb(s);return E.useEffect(()=>{const m=()=>{u.current=!0,document.addEventListener("pointerdown",y,{capture:!0,once:!0}),document.addEventListener("pointermove",y,{capture:!0,once:!0})},y=()=>u.current=!1;return document.addEventListener("keydown",m,{capture:!0}),()=>{document.removeEventListener("keydown",m,{capture:!0}),document.removeEventListener("pointerdown",y,{capture:!0}),document.removeEventListener("pointermove",y,{capture:!0})}},[]),f.jsx(fK,{...o,children:f.jsx($ze,{scope:t,open:n,onOpenChange:d,content:l,onContentChange:c,children:f.jsx(zze,{scope:t,onClose:E.useCallback(()=>d(!1),[d]),isUsingKeyboardRef:u,dir:h,modal:a,children:r})})})};Mre.displayName=i_;var Uze="MenuAnchor",KF=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=GT(n);return f.jsx(hK,{...s,...r,ref:t})});KF.displayName=Uze;var YF="MenuPortal",[qze,Ire]=sg(YF,{forceMount:void 0}),jre=e=>{const{__scopeMenu:t,forceMount:n,children:r,container:s}=e,i=ig(YF,t);return f.jsx(qze,{scope:t,forceMount:n,children:f.jsx(fa,{present:n||i.open,children:f.jsx($E,{asChild:!0,container:s,children:r})})})};jre.displayName=YF;var Gl="MenuContent",[Vze,ZF]=sg(Gl),Pre=E.forwardRef((e,t)=>{const n=Ire(Gl,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=ig(Gl,e.__scopeMenu),a=a_(Gl,e.__scopeMenu);return f.jsx(Qw.Provider,{scope:e.__scopeMenu,children:f.jsx(fa,{present:r||i.open,children:f.jsx(Qw.Slot,{scope:e.__scopeMenu,children:a.modal?f.jsx(Wze,{...s,ref:t}):f.jsx(Hze,{...s,ref:t})})})})}),Wze=E.forwardRef((e,t)=>{const n=ig(Gl,e.__scopeMenu),r=E.useRef(null),s=In(t,r);return E.useEffect(()=>{const i=r.current;if(i)return PT(i)},[]),f.jsx(XF,{...e,ref:s,trapFocus:n.open,disableOutsidePointerEvents:n.open,disableOutsideScroll:!0,onFocusOutside:Wt(e.onFocusOutside,i=>i.preventDefault(),{checkForDefaultPrevented:!1}),onDismiss:()=>n.onOpenChange(!1)})}),Hze=E.forwardRef((e,t)=>{const n=ig(Gl,e.__scopeMenu);return f.jsx(XF,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,disableOutsideScroll:!1,onDismiss:()=>n.onOpenChange(!1)})}),Gze=Aze("MenuContent.ScrollLock"),XF=E.forwardRef((e,t)=>{const{__scopeMenu:n,loop:r=!1,trapFocus:s,onOpenAutoFocus:i,onCloseAutoFocus:a,disableOutsidePointerEvents:o,onEntryFocus:l,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:m,disableOutsideScroll:y,...b}=e,v=ig(Gl,n),x=a_(Gl,n),w=GT(n),S=Nre(n),k=Lze(n),[C,T]=E.useState(null),A=E.useRef(null),N=In(t,A,v.onContentChange),I=E.useRef(0),O=E.useRef(""),B=E.useRef(0),D=E.useRef(null),H=E.useRef("right"),P=E.useRef(0),K=y?n_:E.Fragment,U=y?{as:Gze,allowPinchZoom:!0}:void 0,V=te=>{var Fe,Se;const W=O.current+te,Q=k().filter(Ce=>!Ce.disabled),ee=document.activeElement,re=(Fe=Q.find(Ce=>Ce.ref.current===ee))==null?void 0:Fe.textValue,pe=Q.map(Ce=>Ce.textValue),de=i7e(pe,W,re),Oe=(Se=Q.find(Ce=>Ce.textValue===de))==null?void 0:Se.ref.current;(function Ce(qe){O.current=qe,window.clearTimeout(I.current),qe!==""&&(I.current=window.setTimeout(()=>Ce(""),1e3))})(W),Oe&&setTimeout(()=>Oe.focus())};E.useEffect(()=>()=>window.clearTimeout(I.current),[]),IT();const L=E.useCallback(te=>{var Q,ee;return H.current===((Q=D.current)==null?void 0:Q.side)&&o7e(te,(ee=D.current)==null?void 0:ee.area)},[]);return f.jsx(Vze,{scope:n,searchRef:O,onItemEnter:E.useCallback(te=>{L(te)&&te.preventDefault()},[L]),onItemLeave:E.useCallback(te=>{var W;L(te)||((W=A.current)==null||W.focus(),T(null))},[L]),onTriggerLeave:E.useCallback(te=>{L(te)&&te.preventDefault()},[L]),pointerGraceTimerRef:B,onPointerGraceIntentChange:E.useCallback(te=>{D.current=te},[]),children:f.jsx(K,{...U,children:f.jsx(zF,{asChild:!0,trapped:s,onMountAutoFocus:Wt(i,te=>{var W;te.preventDefault(),(W=A.current)==null||W.focus({preventScroll:!0})}),onUnmountAutoFocus:a,children:f.jsx(OE,{asChild:!0,disableOutsidePointerEvents:o,onEscapeKeyDown:c,onPointerDownOutside:u,onFocusOutside:d,onInteractOutside:h,onDismiss:m,children:f.jsx(ere,{asChild:!0,...S,dir:x.dir,orientation:"vertical",loop:r,currentTabStopId:C,onCurrentTabStopIdChange:T,onEntryFocus:Wt(l,te=>{x.isUsingKeyboardRef.current||te.preventDefault()}),preventScrollOnEntryFocus:!0,children:f.jsx(pK,{role:"menu","aria-orientation":"vertical","data-state":Zre(v.open),"data-radix-menu-content":"",dir:x.dir,...w,...b,ref:N,style:{outline:"none",...b.style},onKeyDown:Wt(b.onKeyDown,te=>{const Q=te.target.closest("[data-radix-menu-content]")===te.currentTarget,ee=te.ctrlKey||te.altKey||te.metaKey,re=te.key.length===1;Q&&(te.key==="Tab"&&te.preventDefault(),!ee&&re&&V(te.key));const pe=A.current;if(te.target!==pe||!Oze.includes(te.key))return;te.preventDefault();const Oe=k().filter(Fe=>!Fe.disabled).map(Fe=>Fe.ref.current);Rre.includes(te.key)&&Oe.reverse(),r7e(Oe)}),onBlur:Wt(e.onBlur,te=>{te.currentTarget.contains(te.target)||(window.clearTimeout(I.current),O.current="")}),onPointerMove:Wt(e.onPointerMove,e1(te=>{const W=te.target,Q=P.current!==te.clientX;if(te.currentTarget.contains(W)&&Q){const ee=te.clientX>P.current?"right":"left";H.current=ee,P.current=te.clientX}}))})})})})})})});Pre.displayName=Gl;var Kze="MenuGroup",JF=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(cr.div,{role:"group",...r,ref:t})});JF.displayName=Kze;var Yze="MenuLabel",Ore=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(cr.div,{...r,ref:t})});Ore.displayName=Yze;var Ik="MenuItem",Nq="menu.itemSelect",KT=E.forwardRef((e,t)=>{const{disabled:n=!1,onSelect:r,...s}=e,i=E.useRef(null),a=a_(Ik,e.__scopeMenu),o=ZF(Ik,e.__scopeMenu),l=In(t,i),c=E.useRef(!1),u=()=>{const d=i.current;if(!n&&d){const h=new CustomEvent(Nq,{bubbles:!0,cancelable:!0});d.addEventListener(Nq,m=>r==null?void 0:r(m),{once:!0}),qG(d,h),h.defaultPrevented?c.current=!1:a.onClose()}};return f.jsx(Dre,{...s,ref:l,disabled:n,onClick:Wt(e.onClick,u),onPointerDown:d=>{var h;(h=e.onPointerDown)==null||h.call(e,d),c.current=!0},onPointerUp:Wt(e.onPointerUp,d=>{var h;c.current||(h=d.currentTarget)==null||h.click()}),onKeyDown:Wt(e.onKeyDown,d=>{const h=o.searchRef.current!=="";n||h&&d.key===" "||D4.includes(d.key)&&(d.currentTarget.click(),d.preventDefault())})})});KT.displayName=Ik;var Dre=E.forwardRef((e,t)=>{const{__scopeMenu:n,disabled:r=!1,textValue:s,...i}=e,a=ZF(Ik,n),o=Nre(n),l=E.useRef(null),c=In(t,l),[u,d]=E.useState(!1),[h,m]=E.useState("");return E.useEffect(()=>{const y=l.current;y&&m((y.textContent??"").trim())},[i.children]),f.jsx(Qw.ItemSlot,{scope:n,disabled:r,textValue:s??h,children:f.jsx(tre,{asChild:!0,...o,focusable:!r,children:f.jsx(cr.div,{role:"menuitem","data-highlighted":u?"":void 0,"aria-disabled":r||void 0,"data-disabled":r?"":void 0,...i,ref:c,onPointerMove:Wt(e.onPointerMove,e1(y=>{r?a.onItemLeave(y):(a.onItemEnter(y),y.defaultPrevented||y.currentTarget.focus({preventScroll:!0}))})),onPointerLeave:Wt(e.onPointerLeave,e1(y=>a.onItemLeave(y))),onFocus:Wt(e.onFocus,()=>d(!0)),onBlur:Wt(e.onBlur,()=>d(!1))})})})}),Zze="MenuCheckboxItem",Fre=E.forwardRef((e,t)=>{const{checked:n=!1,onCheckedChange:r,...s}=e;return f.jsx(Ure,{scope:e.__scopeMenu,checked:n,children:f.jsx(KT,{role:"menuitemcheckbox","aria-checked":jk(n)?"mixed":n,...s,ref:t,"data-state":e6(n),onSelect:Wt(s.onSelect,()=>r==null?void 0:r(jk(n)?!0:!n),{checkForDefaultPrevented:!1})})})});Fre.displayName=Zze;var Lre="MenuRadioGroup",[Xze,Jze]=sg(Lre,{value:void 0,onValueChange:()=>{}}),Bre=E.forwardRef((e,t)=>{const{value:n,onValueChange:r,...s}=e,i=Es(r);return f.jsx(Xze,{scope:e.__scopeMenu,value:n,onValueChange:i,children:f.jsx(JF,{...s,ref:t})})});Bre.displayName=Lre;var $re="MenuRadioItem",zre=E.forwardRef((e,t)=>{const{value:n,...r}=e,s=Jze($re,e.__scopeMenu),i=n===s.value;return f.jsx(Ure,{scope:e.__scopeMenu,checked:i,children:f.jsx(KT,{role:"menuitemradio","aria-checked":i,...r,ref:t,"data-state":e6(i),onSelect:Wt(r.onSelect,()=>{var a;return(a=s.onValueChange)==null?void 0:a.call(s,n)},{checkForDefaultPrevented:!1})})})});zre.displayName=$re;var QF="MenuItemIndicator",[Ure,Qze]=sg(QF,{checked:!1}),qre=E.forwardRef((e,t)=>{const{__scopeMenu:n,forceMount:r,...s}=e,i=Qze(QF,n);return f.jsx(fa,{present:r||jk(i.checked)||i.checked===!0,children:f.jsx(cr.span,{...s,ref:t,"data-state":e6(i.checked)})})});qre.displayName=QF;var e7e="MenuSeparator",Vre=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e;return f.jsx(cr.div,{role:"separator","aria-orientation":"horizontal",...r,ref:t})});Vre.displayName=e7e;var t7e="MenuArrow",Wre=E.forwardRef((e,t)=>{const{__scopeMenu:n,...r}=e,s=GT(n);return f.jsx(mK,{...s,...r,ref:t})});Wre.displayName=t7e;var n7e="MenuSub",[Hdt,Hre]=sg(n7e),bx="MenuSubTrigger",Gre=E.forwardRef((e,t)=>{const n=ig(bx,e.__scopeMenu),r=a_(bx,e.__scopeMenu),s=Hre(bx,e.__scopeMenu),i=ZF(bx,e.__scopeMenu),a=E.useRef(null),{pointerGraceTimerRef:o,onPointerGraceIntentChange:l}=i,c={__scopeMenu:e.__scopeMenu},u=E.useCallback(()=>{a.current&&window.clearTimeout(a.current),a.current=null},[]);return E.useEffect(()=>u,[u]),E.useEffect(()=>{const d=o.current;return()=>{window.clearTimeout(d),l(null)}},[o,l]),f.jsx(KF,{asChild:!0,...c,children:f.jsx(Dre,{id:s.triggerId,"aria-haspopup":"menu","aria-expanded":n.open,"aria-controls":s.contentId,"data-state":Zre(n.open),...e,ref:pl(t,s.onTriggerChange),onClick:d=>{var h;(h=e.onClick)==null||h.call(e,d),!(e.disabled||d.defaultPrevented)&&(d.currentTarget.focus(),n.open||n.onOpenChange(!0))},onPointerMove:Wt(e.onPointerMove,e1(d=>{i.onItemEnter(d),!d.defaultPrevented&&!e.disabled&&!n.open&&!a.current&&(i.onPointerGraceIntentChange(null),a.current=window.setTimeout(()=>{n.onOpenChange(!0),u()},100))})),onPointerLeave:Wt(e.onPointerLeave,e1(d=>{var m,y;u();const h=(m=n.content)==null?void 0:m.getBoundingClientRect();if(h){const b=(y=n.content)==null?void 0:y.dataset.side,v=b==="right",x=v?-5:5,w=h[v?"left":"right"],S=h[v?"right":"left"];i.onPointerGraceIntentChange({area:[{x:d.clientX+x,y:d.clientY},{x:w,y:h.top},{x:S,y:h.top},{x:S,y:h.bottom},{x:w,y:h.bottom}],side:b}),window.clearTimeout(o.current),o.current=window.setTimeout(()=>i.onPointerGraceIntentChange(null),300)}else{if(i.onTriggerLeave(d),d.defaultPrevented)return;i.onPointerGraceIntentChange(null)}})),onKeyDown:Wt(e.onKeyDown,d=>{var m;const h=i.searchRef.current!=="";e.disabled||h&&d.key===" "||Dze[r.dir].includes(d.key)&&(n.onOpenChange(!0),(m=n.content)==null||m.focus(),d.preventDefault())})})})});Gre.displayName=bx;var Kre="MenuSubContent",Yre=E.forwardRef((e,t)=>{const n=Ire(Gl,e.__scopeMenu),{forceMount:r=n.forceMount,...s}=e,i=ig(Gl,e.__scopeMenu),a=a_(Gl,e.__scopeMenu),o=Hre(Kre,e.__scopeMenu),l=E.useRef(null),c=In(t,l);return f.jsx(Qw.Provider,{scope:e.__scopeMenu,children:f.jsx(fa,{present:r||i.open,children:f.jsx(Qw.Slot,{scope:e.__scopeMenu,children:f.jsx(XF,{id:o.contentId,"aria-labelledby":o.triggerId,...s,ref:c,align:"start",side:a.dir==="rtl"?"left":"right",disableOutsidePointerEvents:!1,disableOutsideScroll:!1,trapFocus:!1,onOpenAutoFocus:u=>{var d;a.isUsingKeyboardRef.current&&((d=l.current)==null||d.focus()),u.preventDefault()},onCloseAutoFocus:u=>u.preventDefault(),onFocusOutside:Wt(e.onFocusOutside,u=>{u.target!==o.trigger&&i.onOpenChange(!1)}),onEscapeKeyDown:Wt(e.onEscapeKeyDown,u=>{a.onClose(),u.preventDefault()}),onKeyDown:Wt(e.onKeyDown,u=>{var m;const d=u.currentTarget.contains(u.target),h=Fze[a.dir].includes(u.key);d&&h&&(i.onOpenChange(!1),(m=o.trigger)==null||m.focus(),u.preventDefault())})})})})})});Yre.displayName=Kre;function Zre(e){return e?"open":"closed"}function jk(e){return e==="indeterminate"}function e6(e){return jk(e)?"indeterminate":e?"checked":"unchecked"}function r7e(e){const t=document.activeElement;for(const n of e)if(n===t||(n.focus(),document.activeElement!==t))return}function s7e(e,t){return e.map((n,r)=>e[(t+r)%e.length])}function i7e(e,t,n){const s=t.length>1&&Array.from(t).every(c=>c===t[0])?t[0]:t,i=n?e.indexOf(n):-1;let a=s7e(e,Math.max(i,0));s.length===1&&(a=a.filter(c=>c!==n));const l=a.find(c=>c.toLowerCase().startsWith(s.toLowerCase()));return l!==n?l:void 0}function a7e(e,t){const{x:n,y:r}=e;let s=!1;for(let i=0,a=t.length-1;i<t.length;a=i++){const o=t[i],l=t[a],c=o.x,u=o.y,d=l.x,h=l.y;u>r!=h>r&&n<(d-c)*(r-u)/(h-u)+c&&(s=!s)}return s}function o7e(e,t){if(!t)return!1;const n={x:e.clientX,y:e.clientY};return a7e(n,t)}function e1(e){return t=>t.pointerType==="mouse"?e(t):void 0}var Xre=Mre,Jre=KF,Qre=jre,ese=Pre,tse=JF,nse=Ore,rse=KT,sse=Fre,ise=Bre,ase=zre,ose=qre,lse=Vre,cse=Wre,use=Gre,dse=Yre,t6="ContextMenu",[l7e,Gdt]=Yi(t6,[HT]),bo=HT(),[c7e,fse]=l7e(t6),hse=e=>{const{__scopeContextMenu:t,children:n,onOpenChange:r,dir:s,modal:i=!0}=e,[a,o]=E.useState(!1),l=bo(t),c=Es(r),u=E.useCallback(d=>{o(d),c(d)},[c]);return f.jsx(c7e,{scope:t,open:a,onOpenChange:u,modal:i,children:f.jsx(Xre,{...l,dir:s,open:a,onOpenChange:u,modal:i,children:n})})};hse.displayName=t6;var pse="ContextMenuTrigger",mse=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,disabled:r=!1,...s}=e,i=fse(pse,n),a=bo(n),o=E.useRef({x:0,y:0}),l=E.useRef({getBoundingClientRect:()=>DOMRect.fromRect({width:0,height:0,...o.current})}),c=E.useRef(0),u=E.useCallback(()=>window.clearTimeout(c.current),[]),d=h=>{o.current={x:h.clientX,y:h.clientY},i.onOpenChange(!0)};return E.useEffect(()=>u,[u]),E.useEffect(()=>void(r&&u()),[r,u]),f.jsxs(f.Fragment,{children:[f.jsx(Jre,{...a,virtualRef:l}),f.jsx(cr.span,{"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,...s,ref:t,style:{WebkitTouchCallout:"none",...e.style},onContextMenu:r?e.onContextMenu:Wt(e.onContextMenu,h=>{u(),d(h),h.preventDefault()}),onPointerDown:r?e.onPointerDown:Wt(e.onPointerDown,gC(h=>{u(),c.current=window.setTimeout(()=>d(h),700)})),onPointerMove:r?e.onPointerMove:Wt(e.onPointerMove,gC(u)),onPointerCancel:r?e.onPointerCancel:Wt(e.onPointerCancel,gC(u)),onPointerUp:r?e.onPointerUp:Wt(e.onPointerUp,gC(u))})]})});mse.displayName=pse;var u7e="ContextMenuPortal",gse=e=>{const{__scopeContextMenu:t,...n}=e,r=bo(t);return f.jsx(Qre,{...r,...n})};gse.displayName=u7e;var yse="ContextMenuContent",bse=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=fse(yse,n),i=bo(n),a=E.useRef(!1);return f.jsx(ese,{...i,...r,ref:t,side:"right",sideOffset:2,align:"start",onCloseAutoFocus:o=>{var l;(l=e.onCloseAutoFocus)==null||l.call(e,o),!o.defaultPrevented&&a.current&&o.preventDefault(),a.current=!1},onInteractOutside:o=>{var l;(l=e.onInteractOutside)==null||l.call(e,o),!o.defaultPrevented&&!s.modal&&(a.current=!0)},style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});bse.displayName=yse;var d7e="ContextMenuGroup",f7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=bo(n);return f.jsx(tse,{...s,...r,ref:t})});f7e.displayName=d7e;var h7e="ContextMenuLabel",p7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=bo(n);return f.jsx(nse,{...s,...r,ref:t})});p7e.displayName=h7e;var m7e="ContextMenuItem",vse=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=bo(n);return f.jsx(rse,{...s,...r,ref:t})});vse.displayName=m7e;var g7e="ContextMenuCheckboxItem",y7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=bo(n);return f.jsx(sse,{...s,...r,ref:t})});y7e.displayName=g7e;var b7e="ContextMenuRadioGroup",v7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=bo(n);return f.jsx(ise,{...s,...r,ref:t})});v7e.displayName=b7e;var x7e="ContextMenuRadioItem",w7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=bo(n);return f.jsx(ase,{...s,...r,ref:t})});w7e.displayName=x7e;var _7e="ContextMenuItemIndicator",S7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=bo(n);return f.jsx(ose,{...s,...r,ref:t})});S7e.displayName=_7e;var C7e="ContextMenuSeparator",xse=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=bo(n);return f.jsx(lse,{...s,...r,ref:t})});xse.displayName=C7e;var k7e="ContextMenuArrow",E7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=bo(n);return f.jsx(cse,{...s,...r,ref:t})});E7e.displayName=k7e;var T7e="ContextMenuSubTrigger",A7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=bo(n);return f.jsx(use,{...s,...r,ref:t})});A7e.displayName=T7e;var R7e="ContextMenuSubContent",N7e=E.forwardRef((e,t)=>{const{__scopeContextMenu:n,...r}=e,s=bo(n);return f.jsx(dse,{...s,...r,ref:t,style:{...e.style,"--radix-context-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-context-menu-content-available-width":"var(--radix-popper-available-width)","--radix-context-menu-content-available-height":"var(--radix-popper-available-height)","--radix-context-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-context-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});N7e.displayName=R7e;function gC(e){return t=>t.pointerType!=="mouse"?e(t):void 0}var M7e=hse,I7e=mse,j7e=gse,P7e=bse,O7e=vse,D7e=xse;function Mq({...e}){return f.jsx(M7e,{"data-slot":"context-menu",...e})}function Iq({...e}){return f.jsx(I7e,{"data-slot":"context-menu-trigger",...e})}function jq({className:e,...t}){return f.jsx(j7e,{children:f.jsx(P7e,{"data-slot":"context-menu-content",className:Ze("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-context-menu-content-available-height) min-w-[8rem] origin-(--radix-context-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...t})})}function il({className:e,inset:t,variant:n="default",...r}){return f.jsx(O7e,{"data-slot":"context-menu-item","data-inset":t,"data-variant":n,className:Ze("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function Pq({className:e,...t}){return f.jsx(D7e,{"data-slot":"context-menu-separator",className:Ze("bg-border -mx-1 my-1 h-px",e),...t})}const F7e=({entry:e,isEditingThis:t,isChecked:n,isGitRepo:r,newName:s,isOperationLoading:i,creatingFolder:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,handleDownload:h,handleDelete:m,setNewName:y,renameInputRef:b,handleGitInit:v,handleGitPull:x,handleGitCommit:w,handleGitPush:S,handleGitStatus:k})=>{const C=e.type==="folder",T=B=>{B.target.closest('input[type="checkbox"], button, input[type="text"], [data-radix-context-menu-trigger]')||t||i||(C?o(e):l(!n,e.id))},A=B=>{B.key==="Enter"?d():B.key==="Escape"&&u()},N=C?r?SH:Th:_H,I=C?r?"text-green-400":"text-yellow-400":"text-blue-400",O=f.jsxs(Ts,{className:Ze("group hover:bg-muted/50",t&&"bg-muted ring-1 ring-primary",i&&"opacity-70 cursor-not-allowed",!C&&"cursor-pointer"),onClick:T,onDoubleClick:()=>!i&&!t&&o(e),children:[f.jsx(Ln,{className:"px-2 py-1",children:f.jsx(zc,{checked:n,onCheckedChange:B=>l(!!B,e.id),"aria-label":`Select ${e.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",disabled:i||C})}),f.jsx(Ln,{className:"px-2 py-1",children:f.jsx(N,{className:Ze("h-5 w-5",I)})}),f.jsx(Ln,{className:"py-1 px-2",children:t?f.jsx(xn,{ref:b,value:s,onChange:B=>y(B.target.value),onBlur:d,onKeyDown:A,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:B=>B.stopPropagation(),disabled:i}):f.jsx("span",{className:Ze("truncate",C&&"cursor-pointer hover:underline"),title:e.name,onClick:B=>{C&&(B.stopPropagation(),o(e))},children:e.name})}),f.jsx(Ln,{className:"text-right py-1 px-2 text-xs text-muted-foreground",children:e.type==="file"&&e.size!==void 0?yw(e.size):""}),f.jsx(Ln,{className:"text-right text-xs text-muted-foreground py-1 px-2",children:new Date(e.lastModified).toLocaleString()}),f.jsx(Ln,{className:"text-right pr-4 py-1",children:f.jsx("div",{className:Ze("flex items-center justify-end gap-0.5 opacity-0 group-hover:opacity-100 focus-within:opacity-100 transition-opacity",t&&"opacity-100",i&&"opacity-30"),children:t?f.jsxs(f.Fragment,{children:[f.jsx(qn,{tooltipText:"Save (Enter)",onClick:B=>{B.stopPropagation(),d()},"aria-label":"Save name",disabled:i||!s.trim(),icon:i?f.jsx(Jn,{className:"h-4 w-4 animate-spin"}):f.jsx(co,{}),className:"h-6 w-6 text-green-500 hover:text-green-400"}),f.jsx(qn,{tooltipText:"Cancel (Esc)",onClick:B=>{B.stopPropagation(),u()},"aria-label":"Cancel edit",disabled:i,icon:f.jsx(Pi,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})]}):f.jsxs(f.Fragment,{children:[f.jsx(qn,{tooltipText:"Rename",onClick:B=>{B.stopPropagation(),c(e)},"aria-label":"Rename",disabled:i||a,icon:f.jsx(Ch,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),f.jsx(qn,{tooltipText:C?"Download folder (.zip)":"Download file",onClick:B=>{B.stopPropagation(),h(e)},"aria-label":C?"Download folder as ZIP":"Download file",disabled:i,icon:f.jsx(Tc,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"}),f.jsx(qn,{tooltipText:"Delete",onClick:B=>{B.stopPropagation(),m(e)},"aria-label":`Delete ${C?"folder":"file"}`,disabled:i,icon:f.jsx(Po,{}),className:"h-6 w-6 text-destructive hover:text-destructive/80"})]})})})]},e.id);return C?f.jsxs(Mq,{children:[f.jsx(Iq,{disabled:t||i,asChild:!0,children:O}),f.jsxs(jq,{children:[f.jsx(il,{onSelect:()=>o(e),disabled:t||i,children:"Open Folder"}),f.jsx(Pq,{}),r?f.jsxs(f.Fragment,{children:[f.jsxs(il,{onSelect:()=>x(e.path),disabled:i,children:[f.jsx(TH,{className:"mr-2 h-4 w-4"}),"Git Pull"]}),f.jsxs(il,{onSelect:()=>w(e.path),disabled:i,children:[f.jsx(kH,{className:"mr-2 h-4 w-4"}),"Git Commit..."]}),f.jsxs(il,{onSelect:()=>S(e.path),disabled:i,children:[f.jsx(HP,{className:"mr-2 h-4 w-4"}),"Git Push"]}),f.jsxs(il,{onSelect:()=>k(e.path),disabled:i,children:[f.jsx(KP,{className:"mr-2 h-4 w-4"}),"Git Status"]})]}):f.jsxs(il,{onSelect:()=>v(e.path),disabled:i,children:[f.jsx(jc,{className:"mr-2 h-4 w-4"}),"Initialize Git Repository"]}),f.jsx(Pq,{}),f.jsxs(il,{onSelect:()=>c(e),disabled:i,children:[f.jsx(Ch,{className:"mr-2 h-4 w-4"}),"Rename"]}),f.jsxs(il,{onSelect:()=>h(e),disabled:i,children:[f.jsx(Tc,{className:"mr-2 h-4 w-4"}),"Download as ZIP"]}),f.jsxs(il,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>m(e),disabled:i,children:[f.jsx(Po,{className:"mr-2 h-4 w-4"}),"Delete Folder"]})]})]},e.id):f.jsxs(Mq,{children:[f.jsx(Iq,{disabled:t||i,asChild:!0,children:O}),f.jsxs(jq,{children:[f.jsxs(il,{onSelect:()=>l(!n,e.id),disabled:i,children:[n?"Deselect":"Select"," File"]}),f.jsxs(il,{onSelect:()=>c(e),disabled:i,children:[f.jsx(Ch,{className:"mr-2 h-4 w-4"}),"Rename"]}),f.jsxs(il,{onSelect:()=>h(e),disabled:i,children:[f.jsx(Tc,{className:"mr-2 h-4 w-4"}),"Download File"]}),f.jsxs(il,{className:"text-red-600 focus:text-red-600 focus:bg-red-100 dark:focus:bg-red-900/20",onSelect:()=>m(e),disabled:i,children:[f.jsx(Po,{className:"mr-2 h-4 w-4"}),"Delete File"]})]})]},e.id)},L7e=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:s,selectedFileIds:i,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,cancelCreatingFolder:h,handleCreateFolder:m,handleDownload:y,handleDelete:b,setNewName:v,setNewFolderName:x,renameInputRef:w,newFolderInputRef:S,gitRepoStatus:k,handleGitInit:C,handleGitPull:T,handleGitCommit:A,handleGitPush:N,handleGitStatus:I})=>{const O=E.useMemo(()=>e,[e]);return a&&e.length===0&&!r?f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Loading..."}):f.jsx("div",{className:"relative h-full",children:f.jsxs(yf,{className:"w-full text-sm",children:[f.jsx(gp,{className:"sticky top-0 bg-card z-10",children:f.jsxs(Ts,{className:"hover:bg-card",children:[f.jsx(Rr,{className:"w-[40px] px-2"}),f.jsx(Rr,{className:"w-[40px] px-2"}),f.jsx(Rr,{children:"Name"}),f.jsx(Rr,{className:"w-[100px] text-right",children:"Size"}),f.jsx(Rr,{className:"w-[150px] text-right",children:"Modified"}),f.jsx(Rr,{className:"w-[100px] text-right pr-4",children:"Actions"})]})}),f.jsxs(bf,{children:[r&&f.jsx(Are,{newFolderName:s,setNewFolderName:x,handleCreateFolder:m,cancelCreatingFolder:h,newFolderInputRef:S,isOperationLoading:a}),O.map(B=>{const D=t===B.path,H=i.has(B.id),P=k[B.path]??!1;return f.jsx(F7e,{entry:B,isEditingThis:D,isChecked:H,isGitRepo:P,newName:D?n:"",isOperationLoading:a,creatingFolder:r,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,handleDownload:y,handleDelete:b,setNewName:v,renameInputRef:w,handleGitInit:C,handleGitPull:T,handleGitCommit:A,handleGitPush:N,handleGitStatus:I},B.id)}),e.length===0&&!r&&!a&&f.jsx(Ts,{children:f.jsx(Ln,{colSpan:6,className:"h-24 text-center text-muted-foreground",children:"Folder is empty"})})]})]})})},B7e=({currentPath:e,isAnyLoading:t,isOperationLoading:n,entries:r,editingPath:s,creatingFolder:i,handleNavigateHome:a,handleNavigateUp:o,handleRefresh:l,startCreatingFolder:c,handleUploadClick:u,handleFolderUploadClick:d,handleArchiveUploadClick:h,handleDownloadAll:m,handleCloneClick:y,fileInputRef:b,folderInputRef:v,archiveInputRef:x,handleFileChange:w,handleArchiveChange:S})=>f.jsxs(f.Fragment,{children:[f.jsx("input",{type:"file",ref:b,onChange:w,className:"hidden",multiple:!0,disabled:t}),f.jsx("input",{type:"file",ref:v,onChange:w,className:"hidden",webkitdirectory:"true",mozdirectory:"true",directory:"true",disabled:t}),f.jsx("input",{type:"file",ref:x,onChange:S,className:"hidden",accept:".zip",disabled:t}),f.jsxs("div",{className:"flex items-center gap-1 p-2 border-b border-border flex-shrink-0 flex-wrap",children:[f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0",children:[f.jsx(ct,{variant:"ghost",size:"icon",onClick:k=>{k.preventDefault(),k.stopPropagation(),a()},disabled:e==="/"||t,title:"Go to root directory",className:"h-8 w-8",type:"button",children:f.jsx(Jme,{className:"h-4 w-4"})}),f.jsx(ct,{variant:"ghost",size:"icon",onClick:k=>{k.preventDefault(),k.stopPropagation(),o()},disabled:e==="/"||t,title:"Go up one level",className:"h-8 w-8",type:"button",children:f.jsx(Pme,{className:"h-4 w-4"})}),f.jsx("span",{className:"text-sm font-mono text-muted-foreground truncate flex-shrink min-w-0 px-2 py-1 rounded bg-muted/50 max-w-[150px] sm:max-w-xs md:max-w-sm lg:max-w-md",title:e,children:e})]}),f.jsx("div",{className:"flex-grow"}),f.jsxs("div",{className:"flex items-center gap-1 flex-shrink-0 flex-wrap justify-end",children:[" ",f.jsx(ct,{variant:"ghost",size:"icon",onClick:k=>{k.preventDefault(),k.stopPropagation(),l()},disabled:t,title:"Refresh current directory",className:"h-8 w-8",type:"button",children:n?f.jsx(Jn,{className:"h-4 w-4 animate-spin"}):f.jsx(_m,{className:"h-4 w-4"})}),f.jsxs(ct,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),c()},disabled:t||i||!!s,className:"h-8",title:"Create New Folder",type:"button",children:[n&&i?f.jsx(Jn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(CH,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),f.jsxs(ct,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),u()},disabled:t,className:"h-8",title:"Upload Files",type:"button",children:[n?f.jsx(Jn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(WP,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Files"})," "]}),f.jsxs(ct,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),d()},disabled:t,className:"h-8",title:"Upload Folder",type:"button",children:[n?f.jsx(Jn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(Th,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Folder"})," "]}),f.jsxs(ct,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),h()},disabled:t,className:"h-8",title:"Upload & Extract ZIP",type:"button",children:[n?f.jsx(Jn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(vme,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"ZIP"})," "]}),f.jsxs(ct,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),y()},disabled:t,className:"h-8",title:"Clone Git Repository",type:"button",children:[n?f.jsx(Jn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(jc,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Clone"})," "]}),f.jsxs(ct,{variant:"outline",size:"sm",onClick:k=>{k.preventDefault(),k.stopPropagation(),m()},disabled:t||r.length===0,className:"h-8",title:"Download Current Directory as ZIP",type:"button",children:[n?f.jsx(Jn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(xH,{className:"h-4 w-4 mr-1"}),f.jsx("span",{className:"hidden sm:inline",children:"Export"})," "]})]})]})]}),wse=({isOpen:e,onOpenChange:t,title:n,description:r,children:s,submitLabel:i="Submit",onSubmit:a,isSubmitting:o,submitDisabled:l=!1,className:c,contentClassName:u})=>{const d=async h=>{h==null||h.preventDefault(),!(o||l)&&await a()};return f.jsx(hf,{open:e,onOpenChange:t,children:f.jsxs(pf,{className:Ze(c),children:[f.jsxs(mf,{children:[f.jsx(gf,{children:n}),r&&f.jsx(mp,{children:r})]}),f.jsx("div",{className:Ze("py-4",u),children:s}),f.jsxs(xb,{children:[f.jsx(_9e,{asChild:!0,children:f.jsx(ct,{variant:"outline",disabled:o,children:"Cancel"})}),f.jsxs(ct,{onClick:d,disabled:o||l,children:[o&&f.jsx(Jn,{className:"mr-2 h-4 w-4 animate-spin"}),o?"Submitting...":i]})]})]})})},$7e=({isOpen:e,onOpenChange:t,cloneRepoUrl:n,setCloneRepoUrl:r,cloneBranch:s,setCloneBranch:i,isCloning:a,onSubmitClone:o,currentPath:l})=>f.jsx(wse,{isOpen:e,onOpenChange:t,title:"Clone Git Repository",description:f.jsxs(f.Fragment,{children:["Enter the repository URL. It will be cloned into a new folder named after the repository within ",f.jsx("code",{children:l}),"."]}),submitLabel:"Clone",onSubmit:o,isSubmitting:a,submitDisabled:!n.trim(),children:f.jsxs("div",{className:"grid gap-4",children:[f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(jt,{htmlFor:"clone-url",className:"text-right",children:"URL"}),f.jsx(xn,{id:"clone-url",value:n,onChange:c=>r(c.target.value),className:"col-span-3",placeholder:"https://github.com/user/repo.git",disabled:a})]}),f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(jt,{htmlFor:"clone-branch",className:"text-right",children:"Branch"}),f.jsx(xn,{id:"clone-branch",value:s,onChange:c=>i(c.target.value),className:"col-span-3",placeholder:"main (default)",disabled:a})]})]})}),z7e=({isOpen:e,onOpenChange:t,commitPath:n,commitMessage:r,setCommitMessage:s,isCommitting:i,onSubmitCommit:a})=>f.jsx(wse,{isOpen:e,onOpenChange:t,title:"Commit Changes",description:f.jsxs(f.Fragment,{children:["Enter a commit message for the changes in ",f.jsx("code",{children:n}),". All current changes in this directory will be staged and committed."]}),submitLabel:"Commit",onSubmit:a,isSubmitting:i,submitDisabled:!r.trim(),children:f.jsx("div",{className:"grid gap-4",children:f.jsxs("div",{className:"grid grid-cols-4 items-center gap-4",children:[f.jsx(jt,{htmlFor:"commit-msg",className:"text-right",children:"Message"}),f.jsx(xn,{id:"commit-msg",value:r,onChange:o=>s(o.target.value),className:"col-span-3",placeholder:"e.g., Add feature X",disabled:i})]})})});var YT="DropdownMenu",[U7e,Kdt]=Yi(YT,[HT]),vo=HT(),[q7e,_se]=U7e(YT),Sse=e=>{const{__scopeDropdownMenu:t,children:n,dir:r,open:s,defaultOpen:i,onOpenChange:a,modal:o=!0}=e,l=vo(t),c=E.useRef(null),[u,d]=Lc({prop:s,defaultProp:i??!1,onChange:a,caller:YT});return f.jsx(q7e,{scope:t,triggerId:ca(),triggerRef:c,contentId:ca(),open:u,onOpenChange:d,onOpenToggle:E.useCallback(()=>d(h=>!h),[d]),modal:o,children:f.jsx(Xre,{...l,open:u,onOpenChange:d,dir:r,modal:o,children:n})})};Sse.displayName=YT;var Cse="DropdownMenuTrigger",kse=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,disabled:r=!1,...s}=e,i=_se(Cse,n),a=vo(n);return f.jsx(Jre,{asChild:!0,...a,children:f.jsx(cr.button,{type:"button",id:i.triggerId,"aria-haspopup":"menu","aria-expanded":i.open,"aria-controls":i.open?i.contentId:void 0,"data-state":i.open?"open":"closed","data-disabled":r?"":void 0,disabled:r,...s,ref:pl(t,i.triggerRef),onPointerDown:Wt(e.onPointerDown,o=>{!r&&o.button===0&&o.ctrlKey===!1&&(i.onOpenToggle(),i.open||o.preventDefault())}),onKeyDown:Wt(e.onKeyDown,o=>{r||(["Enter"," "].includes(o.key)&&i.onOpenToggle(),o.key==="ArrowDown"&&i.onOpenChange(!0),["Enter"," ","ArrowDown"].includes(o.key)&&o.preventDefault())})})})});kse.displayName=Cse;var V7e="DropdownMenuPortal",Ese=e=>{const{__scopeDropdownMenu:t,...n}=e,r=vo(t);return f.jsx(Qre,{...r,...n})};Ese.displayName=V7e;var Tse="DropdownMenuContent",Ase=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=_se(Tse,n),i=vo(n),a=E.useRef(!1);return f.jsx(ese,{id:s.contentId,"aria-labelledby":s.triggerId,...i,...r,ref:t,onCloseAutoFocus:Wt(e.onCloseAutoFocus,o=>{var l;a.current||(l=s.triggerRef.current)==null||l.focus(),a.current=!1,o.preventDefault()}),onInteractOutside:Wt(e.onInteractOutside,o=>{const l=o.detail.originalEvent,c=l.button===0&&l.ctrlKey===!0,u=l.button===2||c;(!s.modal||u)&&(a.current=!0)}),style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});Ase.displayName=Tse;var W7e="DropdownMenuGroup",H7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=vo(n);return f.jsx(tse,{...s,...r,ref:t})});H7e.displayName=W7e;var G7e="DropdownMenuLabel",K7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=vo(n);return f.jsx(nse,{...s,...r,ref:t})});K7e.displayName=G7e;var Y7e="DropdownMenuItem",Rse=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=vo(n);return f.jsx(rse,{...s,...r,ref:t})});Rse.displayName=Y7e;var Z7e="DropdownMenuCheckboxItem",X7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=vo(n);return f.jsx(sse,{...s,...r,ref:t})});X7e.displayName=Z7e;var J7e="DropdownMenuRadioGroup",Q7e=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=vo(n);return f.jsx(ise,{...s,...r,ref:t})});Q7e.displayName=J7e;var eUe="DropdownMenuRadioItem",tUe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=vo(n);return f.jsx(ase,{...s,...r,ref:t})});tUe.displayName=eUe;var nUe="DropdownMenuItemIndicator",rUe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=vo(n);return f.jsx(ose,{...s,...r,ref:t})});rUe.displayName=nUe;var sUe="DropdownMenuSeparator",Nse=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=vo(n);return f.jsx(lse,{...s,...r,ref:t})});Nse.displayName=sUe;var iUe="DropdownMenuArrow",aUe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=vo(n);return f.jsx(cse,{...s,...r,ref:t})});aUe.displayName=iUe;var oUe="DropdownMenuSubTrigger",lUe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=vo(n);return f.jsx(use,{...s,...r,ref:t})});lUe.displayName=oUe;var cUe="DropdownMenuSubContent",uUe=E.forwardRef((e,t)=>{const{__scopeDropdownMenu:n,...r}=e,s=vo(n);return f.jsx(dse,{...s,...r,ref:t,style:{...e.style,"--radix-dropdown-menu-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-dropdown-menu-content-available-width":"var(--radix-popper-available-width)","--radix-dropdown-menu-content-available-height":"var(--radix-popper-available-height)","--radix-dropdown-menu-trigger-width":"var(--radix-popper-anchor-width)","--radix-dropdown-menu-trigger-height":"var(--radix-popper-anchor-height)"}})});uUe.displayName=cUe;var dUe=Sse,fUe=kse,hUe=Ese,pUe=Ase,mUe=Rse,gUe=Nse;function yUe({...e}){return f.jsx(dUe,{"data-slot":"dropdown-menu",...e})}function bUe({...e}){return f.jsx(fUe,{"data-slot":"dropdown-menu-trigger",...e})}function vUe({className:e,sideOffset:t=4,...n}){return f.jsx(hUe,{children:f.jsx(pUe,{"data-slot":"dropdown-menu-content",sideOffset:t,className:Ze("bg-popover text-popover-foreground data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2 z-50 max-h-(--radix-dropdown-menu-content-available-height) min-w-[8rem] origin-(--radix-dropdown-menu-content-transform-origin) overflow-x-hidden overflow-y-auto rounded-md border p-1 shadow-md",e),...n})})}function ou({className:e,inset:t,variant:n="default",...r}){return f.jsx(mUe,{"data-slot":"dropdown-menu-item","data-inset":t,"data-variant":n,className:Ze("focus:bg-accent focus:text-accent-foreground data-[variant=destructive]:text-destructive data-[variant=destructive]:focus:bg-destructive/10 dark:data-[variant=destructive]:focus:bg-destructive/20 data-[variant=destructive]:focus:text-destructive data-[variant=destructive]:*:[svg]:!text-destructive [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled]:pointer-events-none data-[disabled]:opacity-50 data-[inset]:pl-8 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...r})}function Oq({className:e,...t}){return f.jsx(gUe,{"data-slot":"dropdown-menu-separator",className:Ze("bg-border -mx-1 my-1 h-px",e),...t})}const xUe=({entries:e,editingPath:t,newName:n,creatingFolder:r,newFolderName:s,selectedFileIds:i,isOperationLoading:a,handleNavigate:o,handleCheckboxChange:l,startEditing:c,cancelEditing:u,handleRename:d,cancelCreatingFolder:h,handleCreateFolder:m,handleDownload:y,handleDelete:b,setNewName:v,setNewFolderName:x,renameInputRef:w,newFolderInputRef:S,gitRepoStatus:k,handleGitInit:C,handleGitPull:T,handleGitCommit:A,handleGitPush:N,handleGitStatus:I})=>{const O=B=>{B.key==="Enter"?d():B.key==="Escape"&&u()};return a&&e.length===0&&!r?f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground p-4",children:"Loading..."}):f.jsxs("div",{className:"p-2 space-y-1",children:[r&&f.jsx("div",{className:"border rounded-md p-2 bg-muted/30",children:f.jsx(Are,{newFolderName:s,setNewFolderName:x,handleCreateFolder:m,cancelCreatingFolder:h,newFolderInputRef:S,isOperationLoading:a,isMobile:!0})}),e.map(B=>{const D=t===B.path,H=i.has(B.id),P=k[B.path]??!1,K=B.type==="folder",U=K?P?SH:Th:_H,V=K?P?"text-green-400":"text-yellow-400":"text-blue-400";return f.jsxs("div",{className:Ze("flex items-center justify-between p-2 border rounded-md",D&&"bg-muted ring-1 ring-primary",a&&"opacity-70 cursor-not-allowed",!D&&"hover:bg-muted/50",!D&&"cursor-pointer"),onClick:()=>{D||a||(K?o(B):l(!H,B.id))},children:[f.jsxs("div",{className:"flex items-center gap-2 flex-grow min-w-0",children:[!K&&f.jsx(zc,{checked:H,onCheckedChange:L=>l(!!L,B.id),"aria-label":`Select ${B.name}`,className:"border-border data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground flex-shrink-0",disabled:a,onClick:L=>L.stopPropagation()}),K&&f.jsx("div",{className:"w-6 flex-shrink-0"}),f.jsx(U,{className:Ze("h-5 w-5 flex-shrink-0",V)}),f.jsxs("div",{className:"flex flex-col min-w-0 flex-grow",children:[D?f.jsx(xn,{ref:w,value:n,onChange:L=>v(L.target.value),onBlur:d,onKeyDown:O,className:"h-7 px-2 py-1 text-sm bg-input border-border focus:ring-1 focus:ring-primary w-full",onClick:L=>L.stopPropagation(),disabled:a}):f.jsx("span",{className:"text-sm font-medium truncate",title:B.name,children:B.name}),f.jsx("span",{className:"text-xs text-muted-foreground",children:B.type==="file"&&B.size!==void 0?yw(B.size):B.type==="folder"?P?"Git Repository":"Folder":""})]})]}),f.jsx("div",{className:"flex items-center flex-shrink-0 ml-2",children:D?f.jsxs(f.Fragment,{children:[f.jsx(ct,{variant:"ghost",size:"icon",className:"h-7 w-7 text-green-500 hover:text-green-600",onClick:L=>{L.stopPropagation(),d()},disabled:a||!n.trim(),"aria-label":"Save name",children:a?f.jsx(Jn,{className:"h-4 w-4 animate-spin"}):f.jsx(co,{className:"h-4 w-4"})}),f.jsx(ct,{variant:"ghost",size:"icon",className:"h-7 w-7 text-muted-foreground hover:text-foreground",onClick:L=>{L.stopPropagation(),u()},disabled:a,"aria-label":"Cancel edit",children:f.jsx(Pi,{className:"h-4 w-4"})})]}):f.jsxs(yUe,{children:[f.jsx(bUe,{asChild:!0,children:f.jsx(ct,{variant:"ghost",size:"icon",className:"h-7 w-7",onClick:L=>L.stopPropagation(),disabled:a,"aria-label":"More actions",children:f.jsx(yme,{className:"h-4 w-4"})})}),f.jsxs(vUe,{align:"end",onClick:L=>L.stopPropagation(),children:[K&&f.jsx(ou,{onSelect:()=>o(B),children:"Open Folder"}),!K&&f.jsxs(ou,{onSelect:()=>l(!H,B.id),children:[H?"Deselect":"Select"," File"]}),f.jsxs(ou,{onSelect:()=>c(B),children:[f.jsx(Ch,{className:"mr-2 h-4 w-4"})," Rename"]}),f.jsxs(ou,{onSelect:()=>y(B),children:[f.jsx(Tc,{className:"mr-2 h-4 w-4"})," Download"," ",K?"as ZIP":""]}),K&&f.jsx(Oq,{}),K&&P&&f.jsxs(f.Fragment,{children:[f.jsxs(ou,{onSelect:()=>T(B.path),children:[f.jsx(TH,{className:"mr-2 h-4 w-4"})," Git Pull"]}),f.jsxs(ou,{onSelect:()=>A(B.path),children:[f.jsx(kH,{className:"mr-2 h-4 w-4"})," Git Commit..."]}),f.jsxs(ou,{onSelect:()=>N(B.path),children:[f.jsx(HP,{className:"mr-2 h-4 w-4"})," Git Push"]}),f.jsxs(ou,{onSelect:()=>I(B.path),children:[f.jsx(KP,{className:"mr-2 h-4 w-4"})," Git Status"]})]}),K&&!P&&f.jsxs(ou,{onSelect:()=>C(B.path),children:[f.jsx(jc,{className:"mr-2 h-4 w-4"})," Initialize Git Repo"]}),f.jsx(Oq,{}),f.jsxs(ou,{className:"text-red-600 focus:text-red-600",onSelect:()=>b(B),children:[f.jsx(Po,{className:"mr-2 h-4 w-4"})," Delete"]})]})]})})]},B.id)}),e.length===0&&!r&&!a&&f.jsx("div",{className:"p-4 text-center text-sm text-muted-foreground",children:"Folder is empty"})]})},n6=E.memo(()=>{const{nodes:e,childrenMap:t,currentParentId:n,loading:r,operationLoading:s,error:i,rootId:a,selectedFileIds:o,vfsKey:l,configuredVfsKey:c,initializingKey:u}=ei(yn(_e=>({nodes:_e.nodes,childrenMap:_e.childrenMap,currentParentId:_e.currentParentId,selectedFileIds:_e.selectedFileIds,loading:_e.loading,operationLoading:_e.operationLoading,error:_e.error,rootId:_e.rootId,vfsKey:_e.vfsKey,configuredVfsKey:_e.configuredVfsKey,initializingKey:_e.initializingKey}))),[d,h]=E.useState(""),[m,y]=E.useState(null),[b,v]=E.useState(!1),[x,w]=E.useState(""),[S,k]=E.useState({}),[C,T]=E.useState(!1),[A,N]=E.useState(""),[I,O]=E.useState(""),[B,D]=E.useState(!1),[H,P]=E.useState(!1),[K,U]=E.useState(null),[V,L]=E.useState(""),[te,W]=E.useState(!1),[Q,ee]=E.useState({}),re=E.useRef(null),pe=E.useRef(null),de=E.useRef(null),Oe=E.useRef(null),Fe=E.useRef(null),Se=n?e[n]:null,Ce=Se?Se.path:"/",Qe=(t[n||a||""]||[]).map(_e=>e[_e]).filter(_e=>!!_e).sort((_e,ze)=>_e.type==="folder"&&ze.type==="file"?-1:_e.type==="file"&&ze.type==="folder"?1:_e.name.localeCompare(ze.name)),We=E.useMemo(()=>Qe.filter(_e=>_e.type==="folder").map(_e=>_e.path),[Qe]),je=r||u!==null||l!==c,Y=s||B||te||Object.values(Q).some(Boolean);E.useEffect(()=>{n!==null&&!t[n]&&!je&&c===l?Re.emit(hn.fetchNodesRequest,{parentId:n}):n===null&&a&&!t[a]&&!je&&c===l&&Re.emit(hn.fetchNodesRequest,{parentId:a})},[n,t,a,je,c,l]),E.useEffect(()=>{var _e,ze;m&&((_e=Oe.current)==null||_e.focus(),(ze=Oe.current)==null||ze.select())},[m]),E.useEffect(()=>{var _e;b&&((_e=Fe.current)==null||_e.focus())},[b]),E.useEffect(()=>{(async()=>{if(je||We.length===0)return;const ze={};let Ct=!1;for(const fe of We)try{const Z=await CTe(fe);S[fe]!==Z&&(ze[fe]=Z,Ct=!0)}catch(Z){console.error(`Error checking git status for ${fe}:`,Z),S[fe]!==!1&&(ze[fe]=!1,Ct=!0)}Ct&&k(fe=>({...fe,...ze}))})()},[We,je,S]);const ye=E.useCallback(async(_e,ze,Ct)=>{if(!(Y||je)){Ct!==!1&&Re.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{Re.emit(_e,ze)}catch(fe){console.error("[FileManager Operation Error]:",fe),Re.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:s,error:fe instanceof Error?fe.message:String(fe)})}finally{Ct!==!1&&Re.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}}},[Y,je,r,s,i]),Ie=E.useCallback(_e=>{Y||je||m||_e.type==="folder"&&ye(hn.setCurrentPathRequest,{path:_e.path},!1)},[Y,je,m,ye]),ce=E.useCallback(()=>{if(Y||je||Ce==="/")return;const _e=oT(Ce);ye(hn.setCurrentPathRequest,{path:_e},!1)},[Y,je,Ce,ye]),oe=E.useCallback(()=>{Y||je||Ce==="/"||ye(hn.setCurrentPathRequest,{path:"/"},!1)},[Y,je,Ce,ye]),se=E.useCallback(()=>{je||ye(hn.fetchNodesRequest,{parentId:n},!1)},[ye,n,je]),Me=E.useCallback((_e,ze)=>{const Ct=e[ze];Ct&&Ct.type==="file"?_e?Re.emit(hn.selectFileRequest,{fileId:ze}):Re.emit(hn.deselectFileRequest,{fileId:ze}):Ct&&Ct.type==="folder"&&Te.info("Folders cannot be attached to the prompt.")},[e]),Be=E.useCallback(_e=>{Y||je||b||(y(_e.path),h(_e.name),v(!1))},[Y,je,b]),Ae=E.useCallback(()=>{y(null),h("")},[]),lt=E.useCallback(async()=>{if(!m||!d.trim()){Ae();return}const _e=Object.values(e).find(ze=>ze.path===m);_e&&_e.name!==d.trim()&&await ye(hn.renameNodeRequest,{id:_e.id,newName:d.trim()}),Ae()},[m,d,e,Ae,ye]),Tt=E.useCallback(()=>{Y||je||m||(v(!0),w(""),y(null))},[Y,je,m]),dt=E.useCallback(()=>{v(!1),w("")},[]),Pt=E.useCallback(async()=>{if(!x.trim()){dt();return}await ye(hn.createDirectoryRequest,{parentId:n,name:x.trim()}),dt()},[x,n,dt,ye]),qt=()=>{var _e;return(_e=re.current)==null?void 0:_e.click()},Ft=()=>{var _e;return(_e=pe.current)==null?void 0:_e.click()},Ht=()=>{var _e;return(_e=de.current)==null?void 0:_e.click()},we=E.useCallback(async _e=>{const ze=_e.target.files;ze&&ze.length>0&&(await ye(hn.uploadFilesRequest,{parentId:n,files:ze}),_e.target&&(_e.target.value=""))},[n,ye]),F=E.useCallback(async _e=>{var Ct;const ze=(Ct=_e.target.files)==null?void 0:Ct[0];if(ze){Re.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{await TTe(ze,Ce),Re.emit(hn.fetchNodesRequest,{parentId:n})}catch(fe){console.error("Archive upload error:",fe)}finally{Re.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i}),_e.target&&(_e.target.value="")}}},[Ce,n,r,i]),X=E.useCallback(async _e=>{window.confirm(`Delete ${_e.type} "${_e.name}"?${_e.type==="folder"?`

WARNING: This will delete all contents inside`:""}`)&&await ye(hn.deleteNodesRequest,{ids:[_e.id]})},[ye]),be=E.useCallback(async _e=>{Re.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{_e.type==="file"?await ETe(_e.path):await Iz(`${_e.name}.zip`,_e.path)}catch(ze){console.error("Download error:",ze)}finally{Re.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}},[r,i]),ke=E.useCallback(async()=>{if(Qe.length!==0){Re.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!0,error:null});try{const _e=vi(Ce)||"root";await Iz(`${_e}_export.zip`,Ce)}catch(_e){console.error("Download all error:",_e)}finally{Re.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:!1,error:i})}}},[Ce,Qe.length,r,i]),ge=E.useCallback(async(_e,ze)=>{if(!(Q[_e]||je||s)){ee(Ct=>({...Ct,[_e]:!0})),Re.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{await ze()}catch(Ct){console.error(`[FileManager Git Op Error @ ${_e}]:`,Ct)}finally{ee(Ct=>({...Ct,[_e]:!1}))}}},[Q,je,s,r]),Ee=E.useCallback(_e=>{ge(_e,async()=>{await RZ(_e),k(ze=>({...ze,[_e]:!0}))})},[ge]),le=E.useCallback(_e=>{Te.info("Pulling default branch (auth not implemented yet)..."),ge(_e,()=>hT(_e,"main"))},[ge]),ft=E.useCallback(_e=>{U(_e),L(""),P(!0)},[]),et=E.useCallback(_e=>{Te.info("Pushing default branch (auth not implemented yet)..."),ge(_e,()=>_D(_e,"main"))},[ge]),$=E.useCallback(_e=>{ge(_e,()=>NZ(_e))},[ge]),Ue=E.useCallback(()=>{N(""),O(""),T(!0)},[]),tt=E.useCallback(async()=>{if(!A.trim()){Te.error("Repository URL cannot be empty.");return}D(!0),Re.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{const _e=vi(A.trim().replace(/\.git$/,""))||"cloned_repo",ze=Fj(Ce,_e);await AZ(ze,A.trim(),I.trim()||void 0),T(!1),Re.emit(hn.fetchNodesRequest,{parentId:n})}catch{}finally{D(!1)}},[A,I,Ce,n,r,s]),ve=E.useCallback(async()=>{if(!K||!V.trim()){Te.error("Commit message cannot be empty.");return}W(!0),Re.emit(hn.loadingStateChanged,{isLoading:r,operationLoading:s,error:null});try{await wD(K,V.trim()),P(!1)}catch{}finally{W(!1)}},[K,V,r,s]);return je?f.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-muted-foreground p-4",children:[f.jsx(Jn,{className:"h-8 w-8 animate-spin mb-2"}),f.jsx("p",{children:u?`Initializing filesystem: ${u}`:"Loading filesystem..."}),i&&f.jsxs("p",{className:"text-destructive mt-2",children:["Error: ",i]})]}):i&&!je?f.jsxs("div",{className:"flex h-full flex-col items-center justify-center bg-card text-destructive p-4",children:[f.jsxs("p",{children:["Error loading filesystem: ",i]}),f.jsx(ct,{variant:"outline",size:"sm",onClick:()=>Re.emit(hn.initializeVFSRequest,{vfsKey:l||"default_fallback_key"}),className:"mt-2",children:"Retry"})]}):f.jsxs("div",{className:Ze("flex h-full flex-col bg-card text-card-foreground"),children:[f.jsx(B7e,{currentPath:Ce,isAnyLoading:Y||je,isOperationLoading:s,entries:Qe,editingPath:m,creatingFolder:b,handleNavigateHome:oe,handleNavigateUp:ce,handleRefresh:se,startCreatingFolder:Tt,handleUploadClick:qt,handleFolderUploadClick:Ft,handleArchiveUploadClick:Ht,handleDownloadAll:ke,handleCloneClick:Ue,fileInputRef:re,folderInputRef:pe,archiveInputRef:de,handleFileChange:we,handleArchiveChange:F}),f.jsx("div",{className:"flex-grow overflow-auto hidden md:block",children:f.jsx(L7e,{entries:Qe,editingPath:m,newName:d,creatingFolder:b,newFolderName:x,selectedFileIds:o,isOperationLoading:Y,handleNavigate:Ie,handleCheckboxChange:Me,startEditing:Be,cancelEditing:Ae,handleRename:lt,cancelCreatingFolder:dt,handleCreateFolder:Pt,handleDownload:be,handleDelete:X,setNewName:h,setNewFolderName:w,renameInputRef:Oe,newFolderInputRef:Fe,gitRepoStatus:S,handleGitInit:Ee,handleGitPull:le,handleGitCommit:ft,handleGitPush:et,handleGitStatus:$})}),f.jsx("div",{className:"flex-grow overflow-auto block md:hidden",children:f.jsx(xUe,{entries:Qe,editingPath:m,newName:d,creatingFolder:b,newFolderName:x,selectedFileIds:o,isOperationLoading:Y,handleNavigate:Ie,handleCheckboxChange:Me,startEditing:Be,cancelEditing:Ae,handleRename:lt,cancelCreatingFolder:dt,handleCreateFolder:Pt,handleDownload:be,handleDelete:X,setNewName:h,setNewFolderName:w,renameInputRef:Oe,newFolderInputRef:Fe,gitRepoStatus:S,handleGitInit:Ee,handleGitPull:le,handleGitCommit:ft,handleGitPush:et,handleGitStatus:$})}),f.jsx($7e,{isOpen:C,onOpenChange:T,cloneRepoUrl:A,setCloneRepoUrl:N,cloneBranch:I,setCloneBranch:O,isCloning:B,onSubmitClone:tt,currentPath:Ce}),f.jsx(z7e,{isOpen:H,onOpenChange:P,commitPath:K,commitMessage:V,setCommitMessage:L,isCommitting:te,onSubmitCommit:ve})]})});n6.displayName="FileManager";const wUe=({vfsKey:e,selectedItemType:t})=>e==="orphan"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(OB,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Shared VFS:"})," All chats ",f.jsx("i",{children:"not"})," in a project share this filesystem."]})]}):e&&t==="conversation"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(OB,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Project-shared VFS:"})," All chats in this project share this filesystem."]})]}):e&&t==="project"?f.jsxs("div",{className:"flex items-center gap-2 text-xs text-blue-300 bg-blue-900/40 px-2 py-1 rounded mb-1",children:[f.jsx(Th,{className:"h-4 w-4"}),f.jsxs("span",{children:[f.jsx("b",{children:"Project VFS:"})," Filesystem for this project and all its chats."]})]}):null,_Ue=({module:e,isOpen:t,onClose:n})=>{const[r,s]=E.useState(e.getSelectedFileIdsCount()),[i,a]=E.useState(null);E.useEffect(()=>{const u=h=>{s(h.selectedFileIds.length)},d=h=>{a(h.itemType)};return Re.on(hn.selectionChanged,u),Re.on(er.selectedItemChanged,d),()=>{Re.off(hn.selectionChanged,u),Re.off(er.selectedItemChanged,d)}},[]);const o=ei.getState().vfsKey,l=()=>{const u=ei.getState().selectedFileIds,d=e.getVfsNodes();if(u.size===0){Te.info("No files selected in VFS to attach.");return}let h=0;u.forEach(m=>{const y=d[m];y&&y.type==="file"&&(Re.emit(Ul.addAttachedFileRequest,{source:"vfs",name:y.name,type:y.mimeType||"application/octet-stream",size:y.size,path:y.path}),h++)}),h>0?(Te.success(`Attached ${h} file(s) from VFS to the next prompt.`),e.clearVfsSelection(),n()):Te.warning("No valid files were selected to attach.")},c=()=>{e.clearVfsSelection(),n()};return f.jsx(hf,{open:t,onOpenChange:u=>!u&&c(),children:f.jsxs(pf,{className:"sm:max-w-[90vw] md:max-w-[80vw] lg:max-w-[70vw] w-[90vw] h-[80vh] min-h-[500px] max-h-[90vh] flex flex-col p-0 gap-0",children:[f.jsxs(mf,{className:"p-4 pb-2 border-b flex-shrink-0",children:[f.jsx(gf,{children:"Virtual Filesystem"}),f.jsx(mp,{children:"Manage files associated with the current context. Select files to attach them to your next prompt."}),f.jsx(wUe,{vfsKey:o,selectedItemType:i})]}),f.jsx("div",{className:"flex-grow overflow-hidden",children:f.jsx(n6,{})}),f.jsxs(xb,{className:"p-4 pt-2 border-t flex-shrink-0",children:[f.jsx(ct,{variant:"outline",onClick:c,children:"Close"}),f.jsxs(ct,{onClick:l,disabled:r===0,children:[f.jsx(SE,{className:"h-4 w-4 mr-2"}),"Attach Selected (",r,")"]})]})]})})};class SUe{constructor(){ue(this,"id","core-vfs");ue(this,"modalId","core-vfs-modal-panel");ue(this,"unregisterCallbacks",[]);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"notifyTriggerUpdate",null);ue(this,"isModalOpenByManager",!1);ue(this,"getEnableVfs",()=>ei.getState().enableVfs);ue(this,"getIsVfsModalOpen",()=>this.isModalOpenByManager);ue(this,"getSelectedFileIdsCount",()=>ei.getState().selectedFileIds.size);ue(this,"toggleVfsModal",()=>{var t,n;this.isModalOpenByManager?(t=this.modApiRef)==null||t.emit(Tr.closeModalRequest,{modalId:this.modalId}):(n=this.modApiRef)==null||n.emit(Tr.openModalRequest,{modalId:this.modalId})});ue(this,"clearVfsSelection",()=>{var t;(t=this.modApiRef)==null||t.emit(hn.clearSelectionRequest,void 0)});ue(this,"getVfsNodes",()=>ei.getState().nodes);ue(this,"setNotifyTriggerUpdate",t=>{this.notifyTriggerUpdate=t})}async initialize(t){this.modApiRef=t,this.updateVfsKeyBasedOnContext();const n=t.on(Tr.contextChanged,()=>{var s;this.updateVfsKeyBasedOnContext(),(s=this.notifyTriggerUpdate)==null||s.call(this)}),r=t.on(Tr.modalStateChanged,s=>{var i;if(s.modalId===this.modalId){const a=s.isOpen;this.isModalOpenByManager!==a&&(this.isModalOpenByManager=a,(i=this.notifyTriggerUpdate)==null||i.call(this),a&&this.updateVfsKeyBasedOnContext())}});this.eventUnsubscribers.push(n,r)}updateVfsKeyBasedOnContext(){var i;const{selectedItemId:t,selectedItemType:n}=Vn.getState(),r=ei.getState().vfsKey;let s=null;if(this.isModalOpenByManager)if(n==="project")s=t;else if(n==="conversation"){const a=Vn.getState().getConversationById(t);s=(a==null?void 0:a.projectId)??"orphan"}else s="orphan";else if(n==="project")s=t;else if(n==="conversation"){const a=Vn.getState().getConversationById(t);s=(a==null?void 0:a.projectId)??"orphan"}else s="orphan";r!==s&&(console.log(`[${this.id}] Updating VFS key from "${r}" to "${s}"`),(i=this.modApiRef)==null||i.emit(hn.setVfsKeyRequest,{key:s}))}register(t){if(this.modApiRef=t,this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=t.registerPromptControl({id:"core-vfs-prompt-trigger",triggerRenderer:()=>Ve.createElement(Eze,{module:this})});this.unregisterCallbacks.push(n);const r=t.registerModalProvider(this.modalId,s=>Ve.createElement(_Ue,{module:this,...s}));this.unregisterCallbacks.push(r)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],this.notifyTriggerUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const CUe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.selectedItemId,r=e.selectedItemType,s=e.syncRepos,i=e.conversationSyncStatus,a=e.isStreaming,[o,l]=E.useState(null),[c,u]=E.useState("idle"),[d,h]=E.useState(!1),[m,y]=E.useState(!1);E.useEffect(()=>{if(r==="conversation"&&n){const T=e.getConversationById(n);l((T==null?void 0:T.syncRepoId)??null),u(i[n]??"idle")}else l(null),u("idle")},[n,r,i,e]);const b=Ve.useMemo(()=>new Map(s.map(T=>[T.id,T.name])),[s]),v=o?b.get(o):void 0,x=E.useCallback(async T=>{if(!n||r!=="conversation")return;h(!0);const A=T==="none"?null:T;await e.linkConversationToRepo(n,A),h(!1)},[n,r,e]),w=E.useCallback(async()=>{!n||!o||(y(!0),await e.syncConversation(n),y(!1))},[n,o,e]),S=kne(c,v),k=!o||m||d||a||c==="syncing";return r==="conversation"&&s.length>0?f.jsxs(ic,{children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ac,{asChild:!0,children:f.jsx(ct,{variant:o?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:a||d||m,"aria-label":"Configure Git Sync",children:c==="syncing"||m||d?f.jsx(Jn,{className:"h-4 w-4 animate-spin"}):f.jsx(jc,{className:"h-4 w-4"})})})}),f.jsx(Cr,{side:"top",children:o?`Sync Status: ${c}`:"Link to Sync Repo"})]})}),f.jsxs(oc,{className:"w-64 p-4 space-y-3",align:"start",children:[f.jsx(jt,{htmlFor:"sync-repo-select",className:"text-sm font-medium",children:"Link to Repository"}),f.jsxs(lf,{value:o??"none",onValueChange:x,disabled:d||m||a,children:[f.jsx(uf,{id:"sync-repo-select",className:"w-full h-9",children:f.jsx(cf,{placeholder:"Select repository..."})}),f.jsxs(df,{children:[f.jsx(Ba,{value:"none",children:f.jsx("span",{className:"text-muted-foreground",children:"None"})}),s.map(T=>f.jsx(Ba,{value:T.id,children:T.name},T.id))]})]}),f.jsxs("div",{className:"flex items-center justify-between pt-2",children:[f.jsxs("div",{className:"flex items-center gap-1 text-xs text-muted-foreground",children:["Status: ",S||"Not Linked"]}),f.jsxs(ct,{size:"sm",variant:"outline",onClick:w,disabled:k,className:"h-8",children:[m||c==="syncing"?f.jsx(Jn,{className:"h-4 w-4 mr-1 animate-spin"}):f.jsx(HP,{className:"h-4 w-4 mr-1"}),"Sync Now"]})]})]})]}):null},vx=({title:e,description:t,children:n,className:r,titleClassName:s,descriptionClassName:i,contentClassName:a})=>f.jsxs("div",{className:Ze("space-y-2",r),children:[f.jsxs("div",{children:[f.jsx("h3",{className:Ze("text-lg font-medium",s),children:e}),t&&f.jsx("p",{className:Ze("text-sm text-muted-foreground",i),children:t})]}),f.jsx("div",{className:Ze(a),children:n})]}),kUe=Ke({gitUserName:$e().min(1,"User name cannot be empty."),gitUserEmail:$e().email("Invalid email address.")});function Dq({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.map(t=>typeof t=="string"?t:typeof t=="object"&&t!==null&&"message"in t&&typeof t.message=="string"?t.message:(console.warn("FieldMetaMessages encountered an unexpected error object:",t),"Invalid input")).join(", ")}):null})}const EUe=()=>{const{gitUserName:e,setGitUserName:t,gitUserEmail:n,setGitUserEmail:r}=pr(yn(i=>({gitUserName:i.gitUserName,setGitUserName:i.setGitUserName,gitUserEmail:i.gitUserEmail,setGitUserEmail:i.setGitUserEmail}))),s=ii({defaultValues:{gitUserName:e??"",gitUserEmail:n??""},validators:{onChange:kUe},onSubmit:async({value:i})=>{try{t(i.gitUserName),r(i.gitUserEmail),Te.success("Git user configuration updated!")}catch(a){Te.error("Failed to update Git configuration."),console.error("Error submitting Git config form:",a)}}});return E.useEffect(()=>{s.reset({gitUserName:e??"",gitUserEmail:n??""})},[e,n,s]),f.jsx("div",{className:"space-y-4 p-1",children:f.jsx(vx,{title:"Git User Configuration",description:"Set your user name and email for Git commits made within the VFS. This is required for committing changes.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-3",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(s.Field,{name:"gitUserName",children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:i.name,children:"Git User Name"}),f.jsx(xn,{id:i.name,value:i.state.value,onBlur:i.handleBlur,onChange:a=>i.handleChange(a.target.value),placeholder:"Your Name",className:i.state.meta.errors.length?"border-destructive":""}),f.jsx(Dq,{field:i})]})}),f.jsx(s.Field,{name:"gitUserEmail",children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:i.name,children:"Git User Email"}),f.jsx(xn,{id:i.name,type:"email",value:i.state.value,onBlur:i.handleBlur,onChange:a=>i.handleChange(a.target.value),placeholder:"your.email@example.com",className:i.state.meta.errors.length?"border-destructive":""}),f.jsx(Dq,{field:i})]})})]}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsx(ct,{type:"submit",size:"sm",disabled:!i||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Git Config"})})})]})})})},TUe=Ve.memo(EUe),AUe=UP("relative w-full rounded-lg border px-4 py-3 text-sm grid has-[>svg]:grid-cols-[calc(var(--spacing)*4)_1fr] grid-cols-[0_1fr] has-[>svg]:gap-x-3 gap-y-0.5 items-start [&>svg]:size-4 [&>svg]:translate-y-0.5 [&>svg]:text-current",{variants:{variant:{default:"bg-card text-card-foreground",destructive:"text-destructive bg-card [&>svg]:text-current *:data-[slot=alert-description]:text-destructive/90"}},defaultVariants:{variant:"default"}});function Mse({className:e,variant:t,...n}){return f.jsx("div",{"data-slot":"alert",role:"alert",className:Ze(AUe({variant:t}),e),...n})}function Ise({className:e,...t}){return f.jsx("div",{"data-slot":"alert-title",className:Ze("col-start-2 line-clamp-1 min-h-4 font-medium tracking-tight",e),...t})}function jse({className:e,...t}){return f.jsx("div",{"data-slot":"alert-description",className:Ze("text-muted-foreground col-start-2 grid justify-items-start gap-1 text-sm [&_p]:leading-relaxed",e),...t})}var RUe="Separator",Fq="horizontal",NUe=["horizontal","vertical"],Pse=E.forwardRef((e,t)=>{const{decorative:n,orientation:r=Fq,...s}=e,i=MUe(r)?r:Fq,o=n?{role:"none"}:{"aria-orientation":i==="vertical"?i:void 0,role:"separator"};return f.jsx(cr.div,{"data-orientation":i,...o,...s,ref:t})});Pse.displayName=RUe;function MUe(e){return NUe.includes(e)}var IUe=Pse;function Fm({className:e,orientation:t="horizontal",decorative:n=!0,...r}){return f.jsx(IUe,{"data-slot":"separator-root",decorative:n,orientation:t,className:Ze("bg-border shrink-0 data-[orientation=horizontal]:h-px data-[orientation=horizontal]:w-full data-[orientation=vertical]:h-full data-[orientation=vertical]:w-px",e),...r})}const jUe=({onSyncAll:e,onSyncPending:t,onInitializeRepos:n,onAbortSync:r,isRunning:s=!1,totalRepos:i,totalConversations:a,pendingConversations:o})=>{const[l,c]=E.useState(null),[u,d]=E.useState(!1);E.useEffect(()=>{const S=A=>{A&&A.progress&&(c(A.progress),d(!0))},k=A=>{A&&A.progress&&c(A.progress)},C=A=>{A&&A.progress&&(c(A.progress),setTimeout(()=>{c(null),d(!1)},2e3))},T=A=>{A&&A.progress&&(c(A.progress),setTimeout(()=>{c(null),d(!1)},5e3))};return Re.on(ds.bulkSyncStarted,S),Re.on(ds.bulkSyncProgress,k),Re.on(ds.bulkSyncCompleted,C),Re.on(ds.bulkSyncFailed,T),()=>{Re.off(ds.bulkSyncStarted,S),Re.off(ds.bulkSyncProgress,k),Re.off(ds.bulkSyncCompleted,C),Re.off(ds.bulkSyncFailed,T)}},[]);const h=s||u,m=l?l.completedRepos/Math.max(l.totalRepos,1)*100:0,y=l?l.completedConversations/Math.max(l.totalConversations,1)*100:0,b=async()=>{d(!0);try{await e()}catch(S){console.error("Sync all failed:",S),d(!1)}},v=async()=>{d(!0);try{await t()}catch(S){console.error("Sync pending failed:",S),d(!1)}},x=async()=>{d(!0);try{await n()}catch(S){console.error("Initialize repos failed:",S),d(!1)}},w=async()=>{try{await r()}catch(S){console.error("Abort sync failed:",S)}};return f.jsxs(Fo,{className:"w-full",children:[f.jsxs(Lo,{className:"pb-3",children:[f.jsxs(Bo,{className:"flex items-center gap-2",children:[f.jsx(jc,{className:"h-5 w-5"}),"Bulk Git Sync"]}),f.jsx(Au,{children:"Manage synchronization across all repositories and conversations"})]}),f.jsxs($o,{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-medium text-lg",children:i}),f.jsx("div",{className:"text-muted-foreground",children:"Repositories"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:"font-medium text-lg",children:a}),f.jsx("div",{className:"text-muted-foreground",children:"Total Conversations"})]}),f.jsxs("div",{className:"text-center",children:[f.jsx("div",{className:Ze("font-medium text-lg",o>0?"text-orange-600":"text-green-600"),children:o}),f.jsx("div",{className:"text-muted-foreground",children:"Pending Sync"})]})]}),f.jsx(Fm,{}),l&&f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between text-sm",children:[f.jsx("span",{className:"font-medium",children:"Current Operation"}),f.jsx(as,{variant:l.errors.length>0?"destructive":"default",children:l.errors.length>0?"Errors":"Running"})]}),f.jsx("div",{className:"text-sm text-muted-foreground bg-muted p-2 rounded",children:l.currentOperation}),l.totalRepos>0&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Repository Progress"}),f.jsxs("span",{children:[l.completedRepos,"/",l.totalRepos]})]}),f.jsx(Ry,{value:m,className:"h-2"})]}),l.totalConversations>0&&f.jsxs("div",{className:"space-y-2",children:[f.jsxs("div",{className:"flex justify-between text-sm",children:[f.jsx("span",{children:"Conversation Progress"}),f.jsxs("span",{children:[l.completedConversations,"/",l.totalConversations]})]}),f.jsx(Ry,{value:y,className:"h-2"})]}),l.errors.length>0&&f.jsxs("div",{className:"mt-2",children:[f.jsxs("div",{className:"flex items-center gap-2 text-sm text-destructive mb-2",children:[f.jsx(Kl,{className:"h-4 w-4"}),l.errors.length," Error",l.errors.length!==1?"s":""]}),f.jsxs("div",{className:"max-h-24 overflow-y-auto space-y-1",children:[l.errors.slice(0,5).map((S,k)=>f.jsxs("div",{className:"text-xs text-muted-foreground bg-destructive/10 p-2 rounded",children:[f.jsxs("span",{className:"font-medium",children:[S.type,":"]})," ",S.error]},k)),l.errors.length>5&&f.jsxs("div",{className:"text-xs text-muted-foreground",children:["...and ",l.errors.length-5," more errors"]})]})]})]}),f.jsx(Fm,{}),f.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[f.jsx(wr,{children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsxs(ct,{onClick:x,disabled:h||i===0,variant:"outline",size:"sm",className:"w-full",children:[f.jsx(Tc,{className:"h-4 w-4 mr-1"}),"Clone Repos"]})}),f.jsx(Cr,{children:"Initialize/clone all configured repositories"})]})}),f.jsx(wr,{children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsxs(ct,{onClick:v,disabled:h||o===0,variant:"outline",size:"sm",className:"w-full",children:[f.jsx(NH,{className:"h-4 w-4 mr-1"}),"Sync Pending"]})}),f.jsx(Cr,{children:"Sync only conversations that need syncing"})]})}),f.jsx(wr,{children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsxs(ct,{onClick:b,disabled:h||i===0&&a===0,size:"sm",className:"w-full",children:[f.jsx(_m,{className:Ze("h-4 w-4 mr-1",h&&"animate-spin")}),"Sync All"]})}),f.jsx(Cr,{children:"Sync all repositories and conversations"})]})}),f.jsxs(ct,{onClick:w,disabled:!h,variant:"destructive",size:"sm",className:"w-full",children:[f.jsx(Xpe,{className:"h-4 w-4 mr-1"}),"Stop"]})]})]})]})},PUe=Ke({name:$e().min(1,"Repository Name is required."),remoteUrl:$e().min(1,"Remote URL is required.").url("Invalid URL format (e.g., https://github.com/user/repo.git)"),branch:$e().min(1,"Branch name is required (e.g., main)."),username:$e().nullable().optional(),password:$e().nullable().optional()}),yC={name:"",remoteUrl:"",branch:"main",username:null,password:null},OUe=()=>{const{syncRepos:e,addSyncRepo:t,updateSyncRepo:n,repoInitializationStatus:r,isLoading:s}=Vn(yn(k=>({syncRepos:k.syncRepos,addSyncRepo:k.addSyncRepo,updateSyncRepo:k.updateSyncRepo,repoInitializationStatus:k.repoInitializationStatus,isLoading:k.isLoading}))),{autoSyncOnStreamComplete:i,setAutoSyncOnStreamComplete:a}=pr(yn(k=>({autoSyncOnStreamComplete:k.autoSyncOnStreamComplete,setAutoSyncOnStreamComplete:k.setAutoSyncOnStreamComplete}))),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState({});E.useEffect(()=>{const k=C=>{C&&C.action==="deleted"&&C.repoId&&h(T=>({...T,[C.repoId]:!1}))};return Re.on(ds.repoChanged,k),()=>Re.off(ds.repoChanged,k)},[]);const m=ii({defaultValues:yC,validators:{onChangeAsync:PUe,onChangeAsyncDebounceMs:500},onSubmit:async({value:k})=>{var C,T,A,N;if(!((C=k.name)!=null&&C.trim())||!((T=k.remoteUrl)!=null&&T.trim())){Te.error("Repository Name and Remote URL are required.");return}try{const I={name:k.name.trim(),remoteUrl:k.remoteUrl.trim(),branch:((A=k.branch)==null?void 0:A.trim())||"main",username:((N=k.username)==null?void 0:N.trim())||null,password:k.password||null};c?await n(c,I):await t(I),y()}catch(I){console.error("Failed to save sync repo:",I)}}}),y=E.useCallback(()=>{m.reset(yC),l(!1),u(null)},[m]);E.useEffect(()=>{if(c){const k=e.find(C=>C.id===c);k?(m.reset({name:k.name,remoteUrl:k.remoteUrl,branch:k.branch||"main",username:k.username??null,password:k.password??null}),l(!1)):y()}else o||m.reset(yC)},[c,e,m,o,y]);const b=k=>{u(k.id),l(!1)},v=E.useCallback((k,C)=>{if(window.confirm(`Are you sure you want to delete the sync repository "${C}"? This will unlink it from any conversations and remove the local copy.`)){h(T=>({...T,[k]:!0}));try{Re.emit(er.deleteSyncRepoRequest,{id:k}),c===k&&y()}catch(T){console.error("Failed to delete sync repo:",T),h(A=>({...A,[k]:!1}))}}},[c,y]),x=E.useCallback(k=>{Re.emit(er.initializeOrSyncRepoRequest,{repoId:k})},[]),w=()=>{u(null),m.reset(yC),l(!0)},S=()=>f.jsxs("form",{onSubmit:k=>{k.preventDefault(),k.stopPropagation(),m.handleSubmit()},className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:c?"Edit Sync Repository":"Add New Sync Repository"}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[f.jsx(m.Field,{name:"name",children:k=>f.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[f.jsx(jt,{htmlFor:k.name,children:"Name"}),f.jsx(xn,{id:k.name,value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"e.g., My Backup",disabled:m.state.isSubmitting}),f.jsx(ji,{field:k})]})}),f.jsx(m.Field,{name:"remoteUrl",children:k=>f.jsxs("div",{className:"sm:col-span-2 space-y-1.5",children:[f.jsx(jt,{htmlFor:k.name,children:"Remote URL (HTTPS)"}),f.jsx(xn,{id:k.name,type:"url",value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"https://github.com/user/repo.git",disabled:m.state.isSubmitting}),f.jsx(ji,{field:k})]})}),f.jsx(m.Field,{name:"branch",children:k=>f.jsxs("div",{className:"sm:col-span-1 space-y-1.5",children:[f.jsx(jt,{htmlFor:k.name,children:"Branch"}),f.jsx(xn,{id:k.name,value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"main",disabled:m.state.isSubmitting}),f.jsx(ji,{field:k})]})})]}),f.jsxs("div",{className:"pt-2",children:[f.jsx(jt,{className:"text-sm font-medium",children:"Authentication (Optional - Basic Auth/Token)"}),f.jsxs(Mse,{variant:"destructive",className:"mt-2 mb-3",children:[f.jsx(ZP,{className:"h-4 w-4"}),f.jsx(Ise,{children:"Security Warning"}),f.jsx(jse,{className:"text-xs",children:"Storing credentials directly is insecure. Use a Personal Access Token (PAT) as the password if possible. Credentials are required only for private repositories."})]}),f.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[f.jsx(m.Field,{name:"username",children:k=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:k.name,children:"Username"}),f.jsx(xn,{id:k.name,value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"Git Username (Optional)",disabled:m.state.isSubmitting,autoComplete:"off"}),f.jsx(ji,{field:k})]})}),f.jsx(m.Field,{name:"password",children:k=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:k.name,children:"Password / Token"}),f.jsx(xn,{id:k.name,type:"password",value:k.state.value??"",onChange:C=>k.handleChange(C.target.value),onBlur:k.handleBlur,placeholder:"Password or PAT (Optional)",disabled:m.state.isSubmitting,autoComplete:"new-password"}),f.jsx(ji,{field:k})]})})]})]}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(ct,{variant:"ghost",size:"sm",onClick:y,disabled:m.state.isSubmitting,type:"button",children:[f.jsx(Pi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(m.Subscribe,{selector:k=>[k.canSubmit,k.isSubmitting,k.isValidating,k.isValid],children:([k,C,T,A])=>f.jsxs(ct,{variant:"secondary",size:"sm",type:"submit",disabled:C||!k||!A||T,children:[(C||T)&&f.jsx(Jn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Uu,{className:"h-4 w-4 mr-1"})," ",C||T?"Saving...":"Save Repository"]})})]})]});return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:"Sync Repositories"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Configure remote Git repositories to synchronize conversations. Link conversations to a repo using the sync control in the chat input area. Use the 'Sync/Clone' button to initialize the local copy or pull updates."}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx(jt,{htmlFor:"auto-sync-toggle",className:"text-sm font-medium",children:"Auto-sync after stream completion"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically sync conversations with linked repositories when a message stream completes"})]}),f.jsx(oo,{id:"auto-sync-toggle",checked:i,onCheckedChange:a})]}),f.jsxs("div",{className:"flex items-center justify-between p-4 border rounded-lg bg-card",children:[f.jsxs("div",{className:"space-y-1",children:[f.jsx(jt,{htmlFor:"auto-init-repos-toggle",className:"text-sm font-medium",children:"Auto-initialize repositories on startup"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Automatically clone/initialize configured repositories when the app starts (off by default)"})]}),f.jsx(oo,{id:"auto-init-repos-toggle",checked:pr(k=>k.autoInitializeReposOnStartup),onCheckedChange:pr.getState().setAutoInitializeReposOnStartup})]})]}),e.length>0&&f.jsx(jUe,{onSyncAll:async()=>{await Vn.getState().syncAllConversations()},onSyncPending:async()=>{await Vn.getState().syncPendingConversations()},onInitializeRepos:async()=>{await Vn.getState().initializeAllRepositories()},onAbortSync:async()=>{const{BulkSyncService:k}=await Dr(async()=>{const{BulkSyncService:C}=await Promise.resolve().then(()=>U0);return{BulkSyncService:C}},void 0);k.abort()},totalRepos:e.length,totalConversations:Vn.getState().conversations.filter(k=>k.syncRepoId).length,pendingConversations:Vn.getState().conversations.filter(k=>{const C=Vn.getState().conversationSyncStatus[k.id];return k.syncRepoId&&C==="needs-sync"}).length})]}),!o&&!c&&f.jsxs(ct,{onClick:w,variant:"outline",className:"w-full mb-4",disabled:s,children:[f.jsx(Pc,{className:"h-4 w-4 mr-1"})," Add Sync Repository"]}),(o||c)&&S(),f.jsxs("div",{children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Configured Repositories"}),s&&!o&&!c?f.jsxs("div",{className:"space-y-2",children:[f.jsx(Gr,{className:"h-10 w-full"}),f.jsx(Gr,{className:"h-10 w-full"}),f.jsx(Gr,{className:"h-10 w-full"})]}):e.length===0&&!o&&!c?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured yet."}):f.jsx("div",{className:"border rounded-md overflow-x-auto",children:f.jsxs(yf,{children:[f.jsx(gp,{children:f.jsxs(Ts,{children:[f.jsx(Rr,{children:"Name"}),f.jsx(Rr,{className:"hidden md:table-cell",children:"Remote URL"}),f.jsx(Rr,{className:"hidden lg:table-cell",children:"Branch"}),f.jsx(Rr,{className:"hidden lg:table-cell",children:"Auth"}),f.jsx(Rr,{className:"text-right",children:"Actions"})]})}),f.jsx(bf,{children:e.map(k=>{const C=d[k.id],T=c===k.id,A=!!k.username||!!k.password,N=r[k.id]||"idle",I=N==="syncing",O=C||m.state.isSubmitting||!!c||I;let B=null,D="Initialize/Sync Repository";return N==="syncing"?(B=f.jsx(Jn,{className:"h-4 w-4 animate-spin mr-1"}),D="Initializing/Syncing..."):N==="idle"?(B=f.jsx(xE,{className:"h-4 w-4 text-green-500 mr-1"}),D="Sync Successful / Ready"):N==="error"?(B=f.jsx(Kl,{className:"h-4 w-4 text-destructive mr-1"}),D="Sync Failed"):B=f.jsx(_m,{className:"h-4 w-4 mr-1"}),f.jsxs(Ts,{className:Ze(T?"bg-muted/50":"",O&&!T?"opacity-70":""),children:[f.jsx(Ln,{className:"font-medium truncate max-w-[100px] sm:max-w-xs",children:k.name}),f.jsx(Ln,{className:"text-xs truncate max-w-[100px] sm:max-w-xs hidden md:table-cell",children:k.remoteUrl}),f.jsx(Ln,{className:"hidden lg:table-cell",children:k.branch||"main"}),f.jsx(Ln,{className:"text-xs hidden lg:table-cell",children:A?"Configured":"None"}),f.jsxs(Ln,{className:"text-right space-x-1",children:[f.jsx(qn,{tooltipText:D,onClick:()=>x(k.id),"aria-label":`Initialize or Sync repo ${k.name}`,disabled:O,icon:B,variant:"outline",className:"h-8 w-8"}),f.jsx(qn,{tooltipText:"Edit",onClick:()=>b(k),"aria-label":`Edit repo ${k.name}`,disabled:O,icon:f.jsx(y1,{}),className:"h-8 w-8"}),f.jsx(qn,{tooltipText:"Delete",onClick:()=>v(k.id,k.name),"aria-label":`Delete repo ${k.name}`,disabled:O,icon:C?f.jsx(Jn,{className:"h-4 w-4 animate-spin"}):f.jsx(Po,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})]})]},k.id)})})]})})]})]})},DUe=Ve.memo(OUe),FUe=()=>{const e=E.useMemo(()=>[{value:"config",label:"User Config",content:f.jsx(TUe,{})},{value:"sync",label:"Sync Repositories",content:f.jsx(DUe,{})}],[]);return f.jsx(xl,{tabs:e,defaultValue:"config",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},LUe=Ve.memo(FUe);class BUe{constructor(){ue(this,"id","core-git-sync");ue(this,"unregisterPromptControlCallback",null);ue(this,"unregisterSettingsTabCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"selectedItemId",null);ue(this,"selectedItemType",null);ue(this,"syncRepos",[]);ue(this,"conversationSyncStatus",{});ue(this,"isStreaming",!1);ue(this,"autoSyncEnabled",!1);ue(this,"isBulkSyncing",!1);ue(this,"bulkSyncProgress",null);ue(this,"notifyComponentUpdate",null);ue(this,"linkConversationToRepo",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(er.linkConversationToRepoRequest,{conversationId:t,repoId:n})});ue(this,"syncConversation",t=>{var n;(n=this.modApiRef)==null||n.emit(er.syncConversationRequest,{conversationId:t})});ue(this,"getConversationById",t=>Vn.getState().getConversationById(t));ue(this,"syncAllConversations",async()=>{await Vn.getState().syncAllConversations()});ue(this,"syncPendingConversations",async()=>{await Vn.getState().syncPendingConversations()});ue(this,"initializeAllRepositories",async()=>{await Vn.getState().initializeAllRepositories()});ue(this,"abortBulkSync",async()=>{const{BulkSyncService:t}=await Dr(async()=>{const{BulkSyncService:n}=await Promise.resolve().then(()=>U0);return{BulkSyncService:n}},void 0);t.abort()});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(Tr.contextChanged,m=>{var y;this.selectedItemId=m.selectedItemId,this.selectedItemType=m.selectedItemType,(y=this.notifyComponentUpdate)==null||y.call(this)}),r=t.on(ds.repoChanged,()=>{var m;this.syncRepos=Vn.getState().syncRepos,(m=this.notifyComponentUpdate)==null||m.call(this)}),s=t.on(er.conversationSyncStatusChanged,m=>{var y;typeof m=="object"&&m&&"conversationId"in m&&"status"in m&&(this.conversationSyncStatus={...this.conversationSyncStatus,[m.conversationId]:m.status},(y=this.notifyComponentUpdate)==null||y.call(this))}),i=t.on(En.statusChanged,m=>{var y;typeof m=="object"&&m&&"status"in m&&(this.isStreaming=m.status==="streaming",(y=this.notifyComponentUpdate)==null||y.call(this))}),a=t.on(En.completed,async m=>{typeof m=="object"&&m&&"interactionId"in m&&"status"in m&&m.status==="COMPLETED"&&this.autoSyncEnabled&&await this.handleAutoSync()}),o=t.on(an.autoSyncOnStreamCompleteChanged,m=>{var y;typeof m=="object"&&m&&"enabled"in m&&(this.autoSyncEnabled=m.enabled,(y=this.notifyComponentUpdate)==null||y.call(this))}),l=t.on(ds.bulkSyncStarted,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!0,this.bulkSyncProgress=m.progress,(y=this.notifyComponentUpdate)==null||y.call(this))}),c=t.on(ds.bulkSyncProgress,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.bulkSyncProgress=m.progress,(y=this.notifyComponentUpdate)==null||y.call(this))}),u=t.on(ds.bulkSyncCompleted,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!1,this.bulkSyncProgress=null,(y=this.notifyComponentUpdate)==null||y.call(this))}),d=t.on(ds.bulkSyncFailed,m=>{var y;typeof m=="object"&&m&&"progress"in m&&(this.isBulkSyncing=!1,this.bulkSyncProgress=null,(y=this.notifyComponentUpdate)==null||y.call(this))}),h=t.on(er.conversationUpdated,m=>{var y;typeof m=="object"&&m&&"conversationId"in m&&"updates"in m&&m.conversationId===this.selectedItemId&&m.updates.syncRepoId!==void 0&&(this.loadInitialState(),(y=this.notifyComponentUpdate)==null||y.call(this))});this.eventUnsubscribers.push(n,r,s,i,a,o,l,c,u,d,h)}loadInitialState(){const t=Vn.getState();this.selectedItemId=t.selectedItemId,this.selectedItemType=t.selectedItemType,this.syncRepos=t.syncRepos,this.conversationSyncStatus=t.conversationSyncStatus,this.isStreaming=un.getState().status==="streaming",this.autoSyncEnabled=pr.getState().autoSyncOnStreamComplete}async handleAutoSync(){if(!this.selectedItemId||this.selectedItemType!=="conversation")return;const t=this.getConversationById(this.selectedItemId);if(!(t!=null&&t.syncRepoId))return;const n=this.conversationSyncStatus[this.selectedItemId];if(!(n==="syncing"||n==="idle")){console.log(`[GitSyncControlModule] Auto-syncing conversation ${this.selectedItemId}`);try{await this.syncConversation(this.selectedItemId)}catch(r){console.error("[GitSyncControlModule] Auto-sync failed:",r)}}}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>Ve.createElement(CUe,{module:this})})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"git",title:"Git",component:LUe,order:60}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const $Ue=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const{syncRepos:n,repoInitializationStatus:r}=Vn(yn(c=>({syncRepos:c.syncRepos,repoInitializationStatus:c.repoInitializationStatus}))),s=()=>{e.syncAllRepos()},i=c=>{e.syncRepo(c)},a=e.isSyncing,o=n.length>0,l=Object.values(r).some(c=>c==="syncing");return f.jsx(wr,{delayDuration:100,children:f.jsxs(ic,{children:[f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ac,{asChild:!0,children:f.jsx(ct,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:!o,"aria-label":"Manual Git Sync",children:a||l?f.jsx(Jn,{className:"h-4 w-4 animate-spin"}):f.jsx(jc,{className:"h-4 w-4"})})})}),f.jsx(Cr,{side:"top",children:o?"Manual Git Sync":"No sync repositories configured"})]}),f.jsx(oc,{className:"w-80 p-4",align:"start",children:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"font-semibold text-sm",children:"Git Sync Repositories"}),f.jsxs(ct,{variant:"outline",size:"sm",onClick:s,disabled:!o||a||l,className:"h-8",children:[a||l?f.jsx(Jn,{className:"h-3 w-3 mr-1 animate-spin"}):f.jsx(_m,{className:"h-3 w-3 mr-1"}),"Sync All"]})]}),o?f.jsx("div",{className:"space-y-2",children:n.map(c=>{const u=r[c.id]||"idle",d=u==="syncing";return f.jsxs("div",{className:Ze("flex items-center justify-between p-3 border rounded-lg","bg-card hover:bg-muted/50 transition-colors"),children:[f.jsxs("div",{className:"min-w-0 flex-1",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx("span",{className:"text-sm font-medium truncate",children:c.name}),f.jsx(as,{variant:u==="idle"?"secondary":u==="syncing"?"default":u==="error"?"destructive":"outline",className:"text-xs",children:u==="idle"?"Ready":u==="syncing"?"Syncing":u==="error"?"Error":"Unknown"})]}),f.jsx("p",{className:"text-xs text-muted-foreground truncate",children:c.branch||"main"})]}),f.jsx(ct,{variant:"ghost",size:"sm",onClick:()=>i(c.id),disabled:d||a,className:"h-8 w-8 p-0",children:d?f.jsx(Jn,{className:"h-3 w-3 animate-spin"}):f.jsx(_m,{className:"h-3 w-3"})})]},c.id)})}):f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No sync repositories configured. Go to Settings  Git  Sync Repositories to add one."})]})})]})})};class zUe{constructor(){ue(this,"id","core-manual-git-sync-sidebar");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"syncRepos",[]);ue(this,"repoInitializationStatus",{});ue(this,"isSyncing",!1);ue(this,"notifyComponentUpdate",null);ue(this,"syncAllRepos",async()=>{var t,n;if(!(this.isSyncing||this.syncRepos.length===0)){this.isSyncing=!0,(t=this.notifyComponentUpdate)==null||t.call(this);try{console.log("[ManualSyncSidebarControlModule] Starting bulk sync for all repositories and conversations");const{BulkSyncService:r}=await Dr(async()=>{const{BulkSyncService:s}=await Promise.resolve().then(()=>U0);return{BulkSyncService:s}},void 0);await r.syncAll({syncRepos:!0,syncConversations:!0,continueOnError:!0,maxConcurrent:3}),console.log("[ManualSyncSidebarControlModule] Completed bulk sync")}catch(r){console.error("[ManualSyncSidebarControlModule] Error in bulk sync:",r)}finally{this.isSyncing=!1,(n=this.notifyComponentUpdate)==null||n.call(this)}}});ue(this,"syncRepo",async t=>{var r;const n=this.syncRepos.find(s=>s.id===t);if(!n){console.warn(`[ManualSyncSidebarControlModule] Repository ${t} not found`);return}console.log(`[ManualSyncSidebarControlModule] Starting sync for repository: ${n.name}`),(r=this.modApiRef)==null||r.emit(er.initializeOrSyncRepoRequest,{repoId:t})});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.loadInitialState();const n=t.on(ds.repoChanged,()=>{var i;this.syncRepos=Vn.getState().syncRepos,(i=this.notifyComponentUpdate)==null||i.call(this)}),r=t.on(ds.repoInitStatusChanged,i=>{var a;typeof i=="object"&&i&&"repoId"in i&&"status"in i&&(this.repoInitializationStatus={...this.repoInitializationStatus,[i.repoId]:i.status},(a=this.notifyComponentUpdate)==null||a.call(this))}),s=t.on(er.syncReposLoaded,()=>{var i;this.loadInitialState(),(i=this.notifyComponentUpdate)==null||i.call(this)});this.eventUnsubscribers.push(n,r,s)}loadInitialState(){const t=Vn.getState();this.syncRepos=t.syncRepos,this.repoInitializationStatus=t.repoInitializationStatus}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>Ve.createElement($Ue,{module:this});this.unregisterCallback=t.registerChatControl({id:this.id,panel:"sidebar-footer",status:()=>"ready",renderer:n,iconRenderer:n,show:()=>!0})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const UUe=Ke({path:$e().optional().describe("The directory path to list within the VFS. Defaults to the current directory if omitted.")}),qUe=Ke({path:$e().describe("The path of the file to read within the VFS."),encoding:vl(["utf-8","base64"]).optional().default("utf-8").describe("Encoding for reading the file (utf-8 or base64).")}),VUe=Ke({path:$e().describe("The path where the file should be written."),content:$e().describe("The content to write to the file."),encoding:vl(["utf-8","base64"]).optional().default("utf-8").describe("Encoding of the provided content (utf-8 or base64).")}),WUe=Ke({path:$e().describe("The path of the file or directory to delete."),recursive:Zn().optional().default(!1).describe("Whether to delete directories recursively.")}),HUe=Ke({path:$e().describe("The path of the directory to create (including parents).")}),GUe=Ke({oldPath:$e().describe("The current path of the item to rename."),newName:$e().describe("The new name for the item.")});class KUe{constructor(){ue(this,"id","core-vfs-tools");ue(this,"unregisterCallbacks",[])}async initialize(t){console.log(`[${this.id}] Initialized.`)}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}console.log(`[${this.id}] Registering Core VFS Tools...`);const n={description:"List files and directories in a specified VFS path, or the current path if none is given.",parameters:UUe};this.unregisterCallbacks.push(t.registerTool("vfsListFiles",n,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=Ur(l||"/");try{const h=await SD(d,{fsInstance:u});return{success:!0,path:d,entries:h.map(m=>({name:m.name,type:m.isDirectory?"folder":"file",size:m.size,lastModified:m.lastModified.toISOString()}))}}catch(h){return{success:!1,path:d,error:h.message}}}));const r={description:"Read the content of a file from the VFS.",parameters:qUe};this.unregisterCallbacks.push(t.registerTool("vfsReadFile",r,async({path:l,encoding:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=Ur(l);try{const m=await lp(h,{fsInstance:d});let y;return c==="base64"?y=btoa(String.fromCharCode(...m)):y=new TextDecoder().decode(m),{success:!0,path:h,content:y,encoding:c}}catch(m){return{success:!1,path:h,error:m.message}}}));const s={description:"Write content to a file in the VFS.",parameters:VUe};this.unregisterCallbacks.push(t.registerTool("vfsWriteFile",s,async({path:l,content:c,encoding:u},d)=>{const h=d==null?void 0:d.fsInstance;if(!h)return{success:!1,error:"Filesystem instance not available in context."};const m=Ur(l);try{let y;if(u==="base64"){const b=atob(c),v=b.length,x=new Uint8Array(v);for(let w=0;w<v;w++)x[w]=b.charCodeAt(w);y=x}else y=c;return await pT(m,y,{fsInstance:h}),{success:!0,path:m}}catch(y){return{success:!1,path:m,error:y.message}}}));const i={description:"Delete a file or directory from the VFS.",parameters:WUe};this.unregisterCallbacks.push(t.registerTool("vfsDelete",i,async({path:l,recursive:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=Ur(l);try{return await CD(h,c,{fsInstance:d}),{success:!0,path:h}}catch(m){return{success:!1,path:h,error:m.message}}}));const a={description:"Create a directory (including parents) in the VFS.",parameters:HUe};this.unregisterCallbacks.push(t.registerTool("vfsCreateDirectory",a,async({path:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=Ur(l);try{return await MZ(d,{fsInstance:u}),{success:!0,path:d}}catch(h){return{success:!1,path:d,error:h.message}}}));const o={description:"Rename a file or directory in the VFS.",parameters:GUe};this.unregisterCallbacks.push(t.registerTool("vfsRename",o,async({oldPath:l,newName:c},u)=>{const d=u==null?void 0:u.fsInstance;if(!d)return{success:!1,error:"Filesystem instance not available in context."};const h=Ur(l),m=Ur(h.substring(0,h.lastIndexOf("/"))||"/"),y=Lu(m,c);try{return await jZ(h,y,{fsInstance:d}),{success:!0,oldPath:h,newPath:y}}catch(b){return{success:!1,oldPath:h,newName:c,error:b.message}}})),console.log(`[${this.id}] Core VFS Tools Registered.`)}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}const YUe=Ke({path:$e().describe("The directory path within the VFS to initialize as a Git repository.")}),ZUe=Ke({path:$e().describe("The directory path of the Git repository within the VFS to commit."),message:$e().describe("The commit message.")}),XUe=Ke({path:$e().describe("The directory path of the Git repository within the VFS to pull from."),branch:$e().optional().describe("The branch name to pull.")}),JUe=Ke({path:$e().describe("The directory path of the Git repository within the VFS to push."),branch:$e().optional().describe("The branch name to push.")}),QUe=Ke({path:$e().describe("The directory path of the Git repository within the VFS to check status.")});class eqe{constructor(){ue(this,"id","core-git-tools");ue(this,"unregisterCallbacks",[])}async initialize(t){}register(t){if(this.unregisterCallbacks.length>0){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={description:"Initialize an empty Git repository in a VFS directory.",parameters:YUe};this.unregisterCallbacks.push(t.registerTool("gitInit",n,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await RZ(o,{fsInstance:c}),{success:!0,message:`Repository initialized at ${o}`}}catch(u){return{success:!1,error:u.message}}}));const r={description:"Stage all changes and commit them in a VFS Git repository.",parameters:ZUe};this.unregisterCallbacks.push(t.registerTool("gitCommit",r,async({path:o,message:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};const d=pr.getState();if(!d.gitUserName||!d.gitUserEmail)return{success:!1,error:"Git user name and email not configured in settings. Cannot commit."};try{return await wD(o,l,{fsInstance:u}),{success:!0,message:`Changes committed in ${o}`}}catch(h){return{success:!1,error:h.message}}}));const s={description:"Pull changes from the remote repository for the specified branch.",parameters:XUe};this.unregisterCallbacks.push(t.registerTool("gitPull",s,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await hT(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pulled changes for ${o}`}}catch(d){return{success:!1,error:d.message}}}));const i={description:"Push committed changes from the local branch to the remote repository.",parameters:JUe};this.unregisterCallbacks.push(t.registerTool("gitPush",i,async({path:o,branch:l},c)=>{const u=c==null?void 0:c.fsInstance;if(!u)return{success:!1,error:"Filesystem instance not available in context."};try{return await _D(o,l||"main",void 0,{fsInstance:u}),{success:!0,message:`Pushed changes for ${o}`}}catch(d){return{success:!1,error:d.message}}}));const a={description:"Get the Git status for a VFS repository.",parameters:QUe};this.unregisterCallbacks.push(t.registerTool("gitStatus",a,async({path:o},l)=>{const c=l==null?void 0:l.fsInstance;if(!c)return{success:!1,error:"Filesystem instance not available in context."};try{return await NZ(o,{fsInstance:c}),{success:!0,message:`Status checked for ${o}`}}catch(u){return{success:!1,error:u.message}}}))}destroy(){this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],console.log(`[${this.id}] Destroyed.`)}}class tqe{constructor(){ue(this,"id","core-mcp-tools");ue(this,"unregisterCallbacks",[]);ue(this,"mcpToolUnregisterCallbacks",[]);ue(this,"mcpClients",new Map);ue(this,"modApi");ue(this,"connectionAttempts",new Map);ue(this,"retryTimeouts",new Map)}async initialize(t){this.modApi=t,globalThis.mcpToolsModuleInstance=this,Re.emit(Er.loadMcpStateRequest,void 0),this.setupEventListeners(),await this.initializeMcpClients()}register(t){}destroy(){this.retryTimeouts.forEach(t=>{clearTimeout(t)}),this.retryTimeouts.clear(),this.connectionAttempts.clear(),this.mcpClients.forEach(t=>{try{t.client&&typeof t.client.disconnect=="function"&&t.client.disconnect()}catch(n){console.error(`[${this.id}] Error disconnecting MCP client ${t.id}:`,n)}}),this.mcpClients.clear(),this.unregisterCallbacks.forEach(t=>t()),this.unregisterCallbacks=[],this.mcpToolUnregisterCallbacks.forEach(t=>t()),this.mcpToolUnregisterCallbacks=[]}setupEventListeners(){const t=n=>{this.initializeMcpClients().catch(r=>{console.error(`[${this.id}] Error reinitializing MCP clients:`,r)})};Re.on(Er.serversChanged,t),this.unregisterCallbacks.push(()=>{Re.off(Er.serversChanged,t)})}getRetryConfig(){const t=ll.getState();return{maxAttempts:t.retryAttempts,baseDelay:t.retryDelay,timeout:t.connectionTimeout}}async initializeMcpClients(){try{const n=ll.getState().servers.filter(r=>r.enabled);this.connectionAttempts.clear(),this.retryTimeouts.forEach(r=>{clearTimeout(r)}),this.retryTimeouts.clear(),this.mcpClients.forEach(r=>{try{r.client&&typeof r.client.disconnect=="function"&&r.client.disconnect()}catch(s){console.error(`[${this.id}] Error disconnecting existing MCP client ${r.id}:`,s)}}),this.mcpClients.clear(),this.mcpToolUnregisterCallbacks.forEach(r=>r()),this.mcpToolUnregisterCallbacks=[];for(const r of n)this.connectToMcpServerWithRetry(r)}catch(t){console.error(`[${this.id}] Error initializing MCP clients:`,t),Te.error("Failed to initialize MCP clients",{description:t instanceof Error?t.message:"Unknown error occurred"})}}async connectToMcpServerWithRetry(t){const n=this.getRetryConfig(),r=this.connectionAttempts.get(t.id)||0;try{await this.connectToMcpServer(t),this.connectionAttempts.delete(t.id);const s=this.retryTimeouts.get(t.id);s&&(clearTimeout(s),this.retryTimeouts.delete(t.id)),Te.success(`Connected to MCP server: ${t.name}`,{description:"Successfully connected and loaded tools"})}catch(s){if(console.error(`[${this.id}] Failed to connect to MCP server ${t.name} (attempt ${r+1}):`,s),ll.getState().setServerStatus({serverId:t.id,connected:!1,error:s instanceof Error?s.message:"Connection failed",lastConnected:void 0,toolCount:0,tools:[]}),r<n.maxAttempts){this.connectionAttempts.set(t.id,r+1);const a=r+1,o=n.baseDelay*Math.pow(1.5,r),l=setTimeout(()=>{this.retryTimeouts.delete(t.id),this.connectToMcpServerWithRetry(t)},o);this.retryTimeouts.set(t.id,l),Te.warning(`MCP server connection failed: ${t.name}`,{description:`Retrying in ${Math.round(o/1e3)}s (attempt ${a+1}/${n.maxAttempts+1})`})}else{this.connectionAttempts.delete(t.id);const a=s instanceof Error?s.message:"Connection failed";Te.error(`Failed to connect to MCP server: ${t.name}`,{description:`All ${n.maxAttempts+1} connection attempts failed. ${a}`,duration:1e4}),console.error(`[${this.id}] All retry attempts exhausted for MCP server ${t.name}`)}}}async connectToMcpServer(t){const n=this.getRetryConfig();try{let r,s="streamable-http";if(t.url.startsWith("stdio://"))r=await this.connectWithStdioTransport(t),s="stdio";else{const i=new Promise((a,o)=>{setTimeout(()=>{o(new Error(`Connection timeout after ${n.timeout}ms`))},n.timeout)});try{r=await Promise.race([this.connectWithStreamableHttp(t),i]),s="streamable-http"}catch{r=await Promise.race([this.connectWithSseTransport(t),i]),s="sse"}}await this.handleSuccessfulConnection(t,r,s)}catch(r){let s=r;throw r instanceof Error&&(r.message.includes("Bridge service not healthy")||r.message.includes("stdio bridge connection failed")?s=new Error("Stdio MCP server requires LiteChat MCP Bridge. Please install and start the bridge service: npm install -g litechat-mcp-bridge && litechat-mcp-bridge"):r.message.includes("fetch")?s=new Error(`Network error: Unable to reach MCP server at ${t.url}. Please check if the server is running and accessible.`):r.message.includes("timeout")?s=new Error(`Connection timeout: MCP server at ${t.url} did not respond within ${n.timeout}ms.`):r.message.includes("401")||r.message.includes("403")?s=new Error(`Authentication error: Invalid credentials for MCP server at ${t.url}.`):r.message.includes("404")?s=new Error(`Server not found: MCP server endpoint ${t.url} does not exist.`):r.message.includes("500")&&(s=new Error(`Server error: MCP server at ${t.url} returned an internal server error.`))),console.error(`[${this.id}] Failed to connect to MCP server ${t.name}:`,s),s}}async connectWithStreamableHttp(t){const n=this.createStreamableHttpTransport(t);return v7({transport:n})}async getBridgeUrl(){const n=ll.getState().bridgeConfig||{};if(n.url)return n.url;if(n.host||n.port){const r=n.host||"localhost",s=n.port||3001;return`http://${r}:${s}`}return"http://localhost:3001"}async connectWithStdioTransport(t){var o;if(!t.url.startsWith("stdio://"))throw new Error("Not a stdio server configuration");const n=new URL(t.url),r=n.hostname||n.pathname.replace("//",""),s=n.searchParams.get("args")||"";if(!r)throw new Error("stdio:// URL must specify a command (e.g., stdio://npx?args=-y,@modelcontextprotocol/server-filesystem,.)");const i=await this.getBridgeUrl(),a=`${r}-${Date.now()}`;try{const l=new URLSearchParams;l.set("command",r),s&&l.set("args",s);const c=`${i}/servers/${a}/mcp?${l.toString()}`,u=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json",...t.headers||{}},body:JSON.stringify({jsonrpc:"2.0",id:1,method:"tools/list",params:{}})});if(!u.ok)throw new Error(`Failed to get tools: ${u.status} ${u.statusText}`);const d=await u.json();if(d.error)throw new Error(`Tools request failed: ${d.error.message}`);let h=0;return{tools:((o=d.result)==null?void 0:o.tools)||[],serverEndpoint:c,callTool:async m=>{const y=`${Date.now()}_${++h}`,b=await fetch(c,{method:"POST",headers:{"Content-Type":"application/json",...t.headers||{}},body:JSON.stringify({jsonrpc:"2.0",id:y,method:"tools/call",params:{name:m.name,arguments:m.arguments}})});if(!b.ok)throw new Error(`Tool call failed: ${b.status} ${b.statusText}`);const v=await b.json();if(v.error)throw new Error(`Tool execution failed: ${v.error.message}`);return v.result}}}catch(l){throw new Error(`Bridge connection failed: ${l instanceof Error?l.message:l}. Ensure bridge is running with: npm run mcp-proxy. Command: ${r}, Args: ${s||"none"}`)}}async connectWithSseTransport(t){return v7({transport:{type:"sse",url:t.url,headers:t.headers||{}}})}createStreamableHttpTransport(t){let n=null,r=!1;return{async start(){const s=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, text/event-stream",Origin:window.location.origin,...t.headers},body:JSON.stringify({jsonrpc:"2.0",id:`init_${Date.now()}`,method:"initialize",params:{protocolVersion:"2025-03-26",capabilities:{tools:{}},clientInfo:{name:"LiteChat",version:"1.0.0"}}})});if(!s.ok)throw new Error(`HTTP ${s.status}: ${s.statusText}`);n=s.headers.get("Mcp-Session-Id");const i=await s.json();if(i.error)throw new Error(`MCP Initialize Error: ${i.error.message}`);const a=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json",Origin:window.location.origin,...n&&{"Mcp-Session-Id":n},...t.headers},body:JSON.stringify({jsonrpc:"2.0",method:"initialized",params:{}})});if(!a.ok)throw new Error(`Failed to send initialized notification: ${a.status}`);r=!0},async send(s){var o,l;if(!r)throw new Error("Transport not connected");const i=await fetch(t.url,{method:"POST",headers:{"Content-Type":"application/json",Accept:"application/json, text/event-stream",Origin:window.location.origin,...n&&{"Mcp-Session-Id":n},...t.headers},body:JSON.stringify(s)});if(!i.ok)throw i.status===404&&n?(n=null,r=!1,new Error("Session expired, reinitializing connection")):new Error(`HTTP ${i.status}: ${i.statusText}`);const a=i.headers.get("Content-Type")||"";if(a.includes("text/event-stream"))(o=i.body)==null||o.getReader();else if(a.includes("application/json")){const c=await i.json();(l=this.onmessage)==null||l.call(this,c)}},async close(){var s;if(n)try{await fetch(t.url,{method:"DELETE",headers:{Origin:window.location.origin,"Mcp-Session-Id":n,...t.headers}})}catch{}r=!1,n=null,(s=this.onclose)==null||s.call(this)},onclose:void 0,onerror:void 0,onmessage:void 0}}async handleSuccessfulConnection(t,n,r){let s;try{if(n.tools&&Array.isArray(n.tools))s={},n.tools.forEach(l=>{s[l.name]={description:l.description,parameters:l.inputSchema}});else throw console.error(`[${this.id}] Bridge client missing tools array:`,n),new Error("Bridge client missing tools array")}catch(l){throw console.error(`[${this.id}] Failed to retrieve tools from ${t.name}:`,l),console.error(`[${this.id}] Error stack:`,l instanceof Error?l.stack:"No stack trace available"),l}const i={id:t.id,name:t.name,client:n,tools:s,transport:r};this.mcpClients.set(t.id,i),i.tools=s,this.modApi&&Object.entries(s).forEach(([l,c])=>{const u=`mcp_${t.name}_${l}`,d=c;let h;if(d.parameters&&typeof d.parameters=="object"&&d.parameters.properties){const v={},x=d.parameters.required||[];for(const[w,S]of Object.entries(d.parameters.properties)){let k;switch(S.type){case"string":k=$e();break;case"number":k=At();break;case"boolean":k=Zn();break;case"array":k=ln(Gd());break;case"object":k=Ke({}).passthrough();break;default:k=Gd()}S.description&&(k=k.describe(S.description)),x.includes(w)||(k=k.optional()),v[w]=k}h=Ke(v)}else h=Ke({});const m={description:d.description||`MCP tool ${l} from ${t.name}`,parameters:h},y=async v=>{const x=await i.client.callTool({name:l,arguments:v});return x&&x.content?Array.isArray(x.content)?x.content.map(S=>S.type==="text"?S.text:S.type==="image"?`[Image: ${S.mimeType||"unknown format"}]`:JSON.stringify(S)).join(`
`):typeof x.content=="string"?x.content:JSON.stringify(x.content):JSON.stringify(x)},b=this.modApi.registerTool(u,m,y);this.mcpToolUnregisterCallbacks.push(b),Re.emit(Er.toolDiscovered,{toolName:l,serverId:t.id,serverName:t.name,toolDefinition:d})}),ll.getState().setServerStatus({serverId:t.id,connected:!0,error:void 0,lastConnected:new Date,toolCount:Object.keys(s).length,tools:Object.keys(s)});const o={"streamable-http":"Streamable HTTP (latest)",sse:"SSE (legacy)",stdio:"Stdio (local bridge)"};Te.success(`Connected to MCP server: ${t.name}`,{description:`Using ${o[r]} transport with ${Object.keys(s).length} tools`})}retryServerConnection(t){const r=ll.getState().servers.find(a=>a.id===t);if(!r){console.error(`[${this.id}] Server with ID ${t} not found`);return}if(!r.enabled)return;this.connectionAttempts.delete(t);const s=this.retryTimeouts.get(t);s&&(clearTimeout(s),this.retryTimeouts.delete(t));const i=this.mcpClients.get(t);if(i){try{i.client&&typeof i.client.disconnect=="function"&&i.client.disconnect()}catch(a){console.error(`[${this.id}] Error disconnecting existing client for ${r.name}:`,a)}this.mcpClients.delete(t)}this.connectToMcpServerWithRetry(r)}getConnectionStatus(){const t={},n=ll.getState();return n.servers.forEach(r=>{const s=n.serverStatuses[r.id];t[r.id]={connected:(s==null?void 0:s.connected)||!1,error:s==null?void 0:s.error,toolCount:(s==null?void 0:s.toolCount)||0}}),t}registerMcpToolWithAI(t,n){const r=this.mcpClients.get(t);if(!r)return console.error(`[${this.id}] No MCP client found for server ${t}`),()=>{};const s=r.tools[n];if(!s)return console.error(`[${this.id}] Tool ${n} not found in server ${r.name}`),()=>{};if(!this.modApi)return console.error(`[${this.id}] ModApi not available for tool registration`),()=>{};const i=`mcp_${r.name}_${n}`;try{const a={description:s.description||`MCP tool ${n} from ${r.name}`,parameters:s.parameters||Ke({})},o=async c=>{const u=await r.client.callTool({name:n,arguments:c});let d="";u&&u.content?Array.isArray(u.content)?d=u.content.map(m=>m.type==="text"?m.text:m.type==="image"?`[Image: ${m.mimeType||"unknown format"}]`:JSON.stringify(m)).join(`
`):typeof u.content=="string"?d=u.content:d=JSON.stringify(u.content):d=JSON.stringify(u);const{maxResponseSize:h}=ll.getState();return d.length>h&&(d=d.substring(0,h)+`

[... response truncated due to size ...]`),d},l=this.modApi.registerTool(i,a,o);return this.mcpToolUnregisterCallbacks.push(l),Re.emit(Er.toolRegistered,{toolName:n,serverId:r.id,serverName:r.name,prefixedToolName:i}),l}catch(a){return console.error(`[${this.id}] Error registering MCP tool ${n} with AI SDK:`,a),()=>{}}}unregisterMcpToolFromAI(t,n){const r=this.mcpClients.get(t);if(!r){console.error(`[${this.id}] No MCP client found for server ${t}`);return}const s=`mcp_${r.name}_${n}`;Re.emit(Er.toolUnregistered,{toolName:n,serverId:r.id,prefixedToolName:s})}}const nqe=(e,t=80)=>e.length<=t?e:e.slice(0,t).trim()+"...",Ose=({enabledTools:e,onToggleTool:t,onToggleAll:n,disabled:r=!1,className:s,maxSteps:i,onMaxStepsChange:a,globalDefaultMaxSteps:o=5,showMaxSteps:l=!1,disabledMessage:c})=>{const u=Wi(x=>x.tools),[d,h]=E.useState(""),m=E.useMemo(()=>Object.entries(u).map(([x,{definition:w,modId:S}])=>({name:x,description:w.description??"No description provided.",modId:S})).sort((x,w)=>x.name.localeCompare(w.name)),[u]),y=E.useMemo(()=>{const x=d.trim().toLowerCase();return x?m.filter(w=>w.name.toLowerCase().includes(x)||w.description.toLowerCase().includes(x)||w.modId.toLowerCase().includes(x)):m},[m,d]),b=E.useCallback(x=>{if(!a)return;const w=x.target.value;if(w===""){a(null);return}const S=parseInt(w,10);if(isNaN(S))a(null);else{const k=Math.max(1,Math.min(20,S));a(k)}},[a]),v=i===null?"":String(i);return f.jsxs("div",{className:Ze("p-4 max-w-2xl space-y-3",s),children:[f.jsx("h4",{className:"text-sm font-medium",children:"Available Tools"}),f.jsxs("div",{className:"relative",children:[f.jsx(uo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(xn,{type:"search",placeholder:"Filter tools...",value:d,onChange:x=>h(x.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsxs("div",{className:"flex justify-between items-center",children:[f.jsxs(jt,{className:"text-xs text-muted-foreground",children:[y.length," tools shown (",e.size," enabled)"]}),f.jsxs("div",{className:"space-x-2",children:[f.jsx(ct,{variant:"outline",size:"sm",onClick:()=>n(!0,m.map(x=>x.name)),disabled:r||m.length===0,children:"Enable All"}),f.jsx(ct,{variant:"outline",size:"sm",onClick:()=>n(!1,m.map(x=>x.name)),disabled:r||m.length===0||e.size===0,children:"Disable All"})]})]}),f.jsx("div",{className:"border rounded-md bg-background/50",children:r&&c?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:c}):m.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools registered."}):y.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No tools match filter."}):f.jsx(Zl,{className:"h-96 w-full",children:f.jsx("div",{className:"p-2 space-y-1",children:y.map(x=>f.jsxs("div",{className:"flex items-center justify-between p-1.5 rounded hover:bg-muted",children:[f.jsx(oo,{id:`tool-switch-${x.name}`,checked:e.has(x.name),onCheckedChange:w=>t(x.name,w),className:"flex-shrink-0",disabled:r}),f.jsxs("div",{className:"flex-grow pl-2 space-y-0.5",children:[f.jsx(jt,{htmlFor:`tool-switch-${x.name}`,className:Ze("block text-sm font-medium",r?"cursor-not-allowed":"cursor-pointer"),children:x.name}),f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx("span",{className:"block text-xs text-muted-foreground break-words cursor-help",children:nqe(x.description)})}),f.jsx(Cr,{side:"bottom",className:"max-w-sm",children:f.jsxs("div",{className:"space-y-1",children:[f.jsx("div",{className:"font-medium",children:x.name}),f.jsxs("div",{className:"text-xs opacity-90",children:["From: ",x.modId]}),f.jsx("div",{className:"text-xs",children:x.description})]})})]})]})]},x.name))})})}),l&&f.jsxs("div",{className:"pt-2",children:[f.jsx(jt,{htmlFor:"local-max-steps",className:"text-xs font-medium",children:"Max Tool Steps (This Turn)"}),f.jsx(xn,{id:"local-max-steps",type:"number",min:"1",max:"20",step:"1",value:v,onChange:b,className:"w-20 h-8 text-xs mt-1",placeholder:String(o),disabled:r}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Overrides the global setting for the next message only (1-20). Leave blank to use default."})]})]})},rqe=({module:e,popoverMaxSteps:t,setPopoverMaxSteps:n,className:r})=>{const s=e.getEnabledTools(),i=e.getSelectedItemId(),a=e.getSelectedItemType(),o=e.getGlobalDefaultMaxSteps(),l=E.useCallback((h,m)=>{e.setEnabledTools(y=>{const b=new Set(y);return m?b.add(h):b.delete(h),b})},[e]),c=E.useCallback((h,m)=>{e.setEnabledTools(()=>h?new Set(m):new Set)},[e]),u=a!=="conversation"||!i;return f.jsx(Ose,{enabledTools:s,onToggleTool:l,onToggleAll:c,disabled:u,className:r,maxSteps:t,onMaxStepsChange:n,globalDefaultMaxSteps:o,showMaxSteps:!0,disabledMessage:"Select a conversation to manage tools."})},sqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=E.useState(!1),[s,i]=E.useState(e.getMaxStepsOverride()),a=e.getEnabledTools(),o=e.getMaxStepsOverride(),l=e.getIsStreaming(),c=e.getIsVisible();E.useEffect(()=>{i(e.getMaxStepsOverride())},[e.getMaxStepsOverride()]);const u=m=>{r(m),!m&&s!==e.getMaxStepsOverride()&&e.setMaxStepsOverride(s)},d=a.size>0||o!==null,h=l;return c?f.jsxs(ic,{open:n,onOpenChange:u,children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ac,{asChild:!0,children:f.jsx(ct,{variant:d?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:h,"aria-label":"Configure Tools",children:f.jsx(Sm,{className:"h-4 w-4"})})})}),f.jsx(Cr,{side:"top",children:`Tools (${a.size} enabled)`})]})}),f.jsx(oc,{className:"w-auto p-0",align:"start",children:f.jsx(rqe,{module:e,popoverMaxSteps:s,setPopoverMaxSteps:i})})]}):null};class iqe{constructor(){ue(this,"id","core-tool-selector");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"transientEnabledTools",new Set);ue(this,"transientMaxStepsOverride",null);ue(this,"isStreaming",!1);ue(this,"isVisible",!0);ue(this,"selectedItemId",null);ue(this,"selectedItemType",null);ue(this,"allToolsCount",0);ue(this,"globalDefaultMaxSteps",5);ue(this,"notifyComponentUpdate",null);ue(this,"getEnabledTools",()=>this.transientEnabledTools);ue(this,"getMaxStepsOverride",()=>this.transientMaxStepsOverride);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"getIsVisible",()=>this.isVisible);ue(this,"getSelectedItemId",()=>this.selectedItemId);ue(this,"getSelectedItemType",()=>this.selectedItemType);ue(this,"getAllToolsCount",()=>this.allToolsCount);ue(this,"getGlobalDefaultMaxSteps",()=>this.globalDefaultMaxSteps);ue(this,"setEnabledTools",t=>{var n;this.transientEnabledTools=t(this.transientEnabledTools),(n=this.notifyComponentUpdate)==null||n.call(this)});ue(this,"setMaxStepsOverride",t=>{var n;this.transientMaxStepsOverride=t,(n=this.notifyComponentUpdate)==null||n.call(this)});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var o;this.loadInitialState(),this.updateVisibility(),(o=this.notifyComponentUpdate)==null||o.call(this);const n=t.on(En.statusChanged,l=>{var c;typeof l=="object"&&l&&"status"in l&&this.isStreaming!==(l.status==="streaming")&&(this.isStreaming=l.status==="streaming",(c=this.notifyComponentUpdate)==null||c.call(this))}),r=t.on(Wn.selectedModelChanged,()=>{var l;this.updateVisibility(),(l=this.notifyComponentUpdate)==null||l.call(this)}),s=t.on(Tr.contextChanged,l=>{var c;this.selectedItemId=l.selectedItemId,this.selectedItemType=l.selectedItemType,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this)}),i=t.on(an.toolMaxStepsChanged,l=>{var c;typeof l=="object"&&l&&"steps"in l&&(this.globalDefaultMaxSteps=l.steps,(c=this.notifyComponentUpdate)==null||c.call(this))}),a=t.on(zr.toolsChanged,l=>{var c;if(l&&typeof l.tools=="object"){const u=Object.keys(l.tools).length;this.allToolsCount!==u&&(this.allToolsCount=u,this.updateVisibility(),(c=this.notifyComponentUpdate)==null||c.call(this))}});this.eventUnsubscribers.push(n,r,s,i,a)}loadInitialState(){this.isStreaming=un.getState().status==="streaming",this.selectedItemId=Vn.getState().selectedItemId,this.selectedItemType=Vn.getState().selectedItemType,this.allToolsCount=Object.keys(Wi.getState().tools).length,this.globalDefaultMaxSteps=pr.getState().toolMaxSteps}updateVisibility(){var a,o;const{getSelectedModel:t}=Qn.getState(),n=t(),r=this.allToolsCount>0,s=((o=(a=n==null?void 0:n.metadata)==null?void 0:a.supported_parameters)==null?void 0:o.includes("tools"))??!1,i=r&&s;this.isVisible!==i&&(this.isVisible=i)}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,triggerRenderer:()=>Ve.createElement(sqe,{module:this}),getMetadata:()=>{if(this.transientEnabledTools.size>0||this.transientMaxStepsOverride!==null)return{enabledTools:Array.from(this.transientEnabledTools),...this.transientMaxStepsOverride!==null&&{maxSteps:this.transientMaxStepsOverride}}},clearOnSubmit:()=>{var r;let n=!1;this.transientEnabledTools.size>0&&(this.transientEnabledTools=new Set,n=!0),this.transientMaxStepsOverride!==null&&(this.transientMaxStepsOverride=null,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}var Lq=1,aqe=.9,oqe=.8,lqe=.17,m3=.1,g3=.999,cqe=.9999,uqe=.99,dqe=/[\\\/_+.#"@\[\(\{&]/,fqe=/[\\\/_+.#"@\[\(\{&]/g,hqe=/[\s-]/,Dse=/[\s-]/g;function F4(e,t,n,r,s,i,a){if(i===t.length)return s===e.length?Lq:uqe;var o=`${s},${i}`;if(a[o]!==void 0)return a[o];for(var l=r.charAt(i),c=n.indexOf(l,s),u=0,d,h,m,y;c>=0;)d=F4(e,t,n,r,c+1,i+1,a),d>u&&(c===s?d*=Lq:dqe.test(e.charAt(c-1))?(d*=oqe,m=e.slice(s,c-1).match(fqe),m&&s>0&&(d*=Math.pow(g3,m.length))):hqe.test(e.charAt(c-1))?(d*=aqe,y=e.slice(s,c-1).match(Dse),y&&s>0&&(d*=Math.pow(g3,y.length))):(d*=lqe,s>0&&(d*=Math.pow(g3,c-s))),e.charAt(c)!==t.charAt(i)&&(d*=cqe)),(d<m3&&n.charAt(c-1)===r.charAt(i+1)||r.charAt(i+1)===r.charAt(i)&&n.charAt(c-1)!==r.charAt(i))&&(h=F4(e,t,n,r,c+1,i+2,a),h*m3>d&&(d=h*m3)),d>u&&(u=d),c=n.indexOf(l,c+1);return a[o]=u,u}function Bq(e){return e.toLowerCase().replace(Dse," ")}function pqe(e,t,n){return e=n&&n.length>0?`${e+" "+n.join(" ")}`:e,F4(e,t,Bq(e),Bq(t),0,0,{})}var Gv='[cmdk-group=""]',y3='[cmdk-group-items=""]',mqe='[cmdk-group-heading=""]',Fse='[cmdk-item=""]',$q=`${Fse}:not([aria-disabled="true"])`,L4="cmdk-item-select",y0="data-value",gqe=(e,t,n)=>pqe(e,t,n),Lse=E.createContext(void 0),o_=()=>E.useContext(Lse),Bse=E.createContext(void 0),r6=()=>E.useContext(Bse),$se=E.createContext(void 0),zse=E.forwardRef((e,t)=>{let n=b0(()=>{var ee,re;return{search:"",value:(re=(ee=e.value)!=null?ee:e.defaultValue)!=null?re:"",selectedItemId:void 0,filtered:{count:0,items:new Map,groups:new Set}}}),r=b0(()=>new Set),s=b0(()=>new Map),i=b0(()=>new Map),a=b0(()=>new Set),o=Use(e),{label:l,children:c,value:u,onValueChange:d,filter:h,shouldFilter:m,loop:y,disablePointerSelection:b=!1,vimBindings:v=!0,...x}=e,w=ca(),S=ca(),k=ca(),C=E.useRef(null),T=Tqe();Lm(()=>{if(u!==void 0){let ee=u.trim();n.current.value=ee,A.emit()}},[u]),Lm(()=>{T(6,H)},[]);let A=E.useMemo(()=>({subscribe:ee=>(a.current.add(ee),()=>a.current.delete(ee)),snapshot:()=>n.current,setState:(ee,re,pe)=>{var de,Oe,Fe,Se;if(!Object.is(n.current[ee],re)){if(n.current[ee]=re,ee==="search")D(),O(),T(1,B);else if(ee==="value"){if(document.activeElement.hasAttribute("cmdk-input")||document.activeElement.hasAttribute("cmdk-root")){let Ce=document.getElementById(k);Ce?Ce.focus():(de=document.getElementById(w))==null||de.focus()}if(T(7,()=>{var Ce;n.current.selectedItemId=(Ce=P())==null?void 0:Ce.id,A.emit()}),pe||T(5,H),((Oe=o.current)==null?void 0:Oe.value)!==void 0){let Ce=re??"";(Se=(Fe=o.current).onValueChange)==null||Se.call(Fe,Ce);return}}A.emit()}},emit:()=>{a.current.forEach(ee=>ee())}}),[]),N=E.useMemo(()=>({value:(ee,re,pe)=>{var de;re!==((de=i.current.get(ee))==null?void 0:de.value)&&(i.current.set(ee,{value:re,keywords:pe}),n.current.filtered.items.set(ee,I(re,pe)),T(2,()=>{O(),A.emit()}))},item:(ee,re)=>(r.current.add(ee),re&&(s.current.has(re)?s.current.get(re).add(ee):s.current.set(re,new Set([ee]))),T(3,()=>{D(),O(),n.current.value||B(),A.emit()}),()=>{i.current.delete(ee),r.current.delete(ee),n.current.filtered.items.delete(ee);let pe=P();T(4,()=>{D(),(pe==null?void 0:pe.getAttribute("id"))===ee&&B(),A.emit()})}),group:ee=>(s.current.has(ee)||s.current.set(ee,new Set),()=>{i.current.delete(ee),s.current.delete(ee)}),filter:()=>o.current.shouldFilter,label:l||e["aria-label"],getDisablePointerSelection:()=>o.current.disablePointerSelection,listId:w,inputId:k,labelId:S,listInnerRef:C}),[]);function I(ee,re){var pe,de;let Oe=(de=(pe=o.current)==null?void 0:pe.filter)!=null?de:gqe;return ee?Oe(ee,n.current.search,re):0}function O(){if(!n.current.search||o.current.shouldFilter===!1)return;let ee=n.current.filtered.items,re=[];n.current.filtered.groups.forEach(de=>{let Oe=s.current.get(de),Fe=0;Oe.forEach(Se=>{let Ce=ee.get(Se);Fe=Math.max(Ce,Fe)}),re.push([de,Fe])});let pe=C.current;K().sort((de,Oe)=>{var Fe,Se;let Ce=de.getAttribute("id"),qe=Oe.getAttribute("id");return((Fe=ee.get(qe))!=null?Fe:0)-((Se=ee.get(Ce))!=null?Se:0)}).forEach(de=>{let Oe=de.closest(y3);Oe?Oe.appendChild(de.parentElement===Oe?de:de.closest(`${y3} > *`)):pe.appendChild(de.parentElement===pe?de:de.closest(`${y3} > *`))}),re.sort((de,Oe)=>Oe[1]-de[1]).forEach(de=>{var Oe;let Fe=(Oe=C.current)==null?void 0:Oe.querySelector(`${Gv}[${y0}="${encodeURIComponent(de[0])}"]`);Fe==null||Fe.parentElement.appendChild(Fe)})}function B(){let ee=K().find(pe=>pe.getAttribute("aria-disabled")!=="true"),re=ee==null?void 0:ee.getAttribute(y0);A.setState("value",re||void 0)}function D(){var ee,re,pe,de;if(!n.current.search||o.current.shouldFilter===!1){n.current.filtered.count=r.current.size;return}n.current.filtered.groups=new Set;let Oe=0;for(let Fe of r.current){let Se=(re=(ee=i.current.get(Fe))==null?void 0:ee.value)!=null?re:"",Ce=(de=(pe=i.current.get(Fe))==null?void 0:pe.keywords)!=null?de:[],qe=I(Se,Ce);n.current.filtered.items.set(Fe,qe),qe>0&&Oe++}for(let[Fe,Se]of s.current)for(let Ce of Se)if(n.current.filtered.items.get(Ce)>0){n.current.filtered.groups.add(Fe);break}n.current.filtered.count=Oe}function H(){var ee,re,pe;let de=P();de&&(((ee=de.parentElement)==null?void 0:ee.firstChild)===de&&((pe=(re=de.closest(Gv))==null?void 0:re.querySelector(mqe))==null||pe.scrollIntoView({block:"nearest"})),de.scrollIntoView({block:"nearest"}))}function P(){var ee;return(ee=C.current)==null?void 0:ee.querySelector(`${Fse}[aria-selected="true"]`)}function K(){var ee;return Array.from(((ee=C.current)==null?void 0:ee.querySelectorAll($q))||[])}function U(ee){let re=K()[ee];re&&A.setState("value",re.getAttribute(y0))}function V(ee){var re;let pe=P(),de=K(),Oe=de.findIndex(Se=>Se===pe),Fe=de[Oe+ee];(re=o.current)!=null&&re.loop&&(Fe=Oe+ee<0?de[de.length-1]:Oe+ee===de.length?de[0]:de[Oe+ee]),Fe&&A.setState("value",Fe.getAttribute(y0))}function L(ee){let re=P(),pe=re==null?void 0:re.closest(Gv),de;for(;pe&&!de;)pe=ee>0?kqe(pe,Gv):Eqe(pe,Gv),de=pe==null?void 0:pe.querySelector($q);de?A.setState("value",de.getAttribute(y0)):V(ee)}let te=()=>U(K().length-1),W=ee=>{ee.preventDefault(),ee.metaKey?te():ee.altKey?L(1):V(1)},Q=ee=>{ee.preventDefault(),ee.metaKey?U(0):ee.altKey?L(-1):V(-1)};return E.createElement(cr.div,{ref:t,tabIndex:-1,...x,"cmdk-root":"",onKeyDown:ee=>{var re;(re=x.onKeyDown)==null||re.call(x,ee);let pe=ee.nativeEvent.isComposing||ee.keyCode===229;if(!(ee.defaultPrevented||pe))switch(ee.key){case"n":case"j":{v&&ee.ctrlKey&&W(ee);break}case"ArrowDown":{W(ee);break}case"p":case"k":{v&&ee.ctrlKey&&Q(ee);break}case"ArrowUp":{Q(ee);break}case"Home":{ee.preventDefault(),U(0);break}case"End":{ee.preventDefault(),te();break}case"Enter":{ee.preventDefault();let de=P();if(de){let Oe=new Event(L4);de.dispatchEvent(Oe)}}}}},E.createElement("label",{"cmdk-label":"",htmlFor:N.inputId,id:N.labelId,style:Rqe},l),ZT(e,ee=>E.createElement(Bse.Provider,{value:A},E.createElement(Lse.Provider,{value:N},ee))))}),yqe=E.forwardRef((e,t)=>{var n,r;let s=ca(),i=E.useRef(null),a=E.useContext($se),o=o_(),l=Use(e),c=(r=(n=l.current)==null?void 0:n.forceMount)!=null?r:a==null?void 0:a.forceMount;Lm(()=>{if(!c)return o.item(s,a==null?void 0:a.id)},[c]);let u=qse(s,i,[e.value,e.children,i],e.keywords),d=r6(),h=Hh(T=>T.value&&T.value===u.current),m=Hh(T=>c||o.filter()===!1?!0:T.search?T.filtered.items.get(s)>0:!0);E.useEffect(()=>{let T=i.current;if(!(!T||e.disabled))return T.addEventListener(L4,y),()=>T.removeEventListener(L4,y)},[m,e.onSelect,e.disabled]);function y(){var T,A;b(),(A=(T=l.current).onSelect)==null||A.call(T,u.current)}function b(){d.setState("value",u.current,!0)}if(!m)return null;let{disabled:v,value:x,onSelect:w,forceMount:S,keywords:k,...C}=e;return E.createElement(cr.div,{ref:pl(i,t),...C,id:s,"cmdk-item":"",role:"option","aria-disabled":!!v,"aria-selected":!!h,"data-disabled":!!v,"data-selected":!!h,onPointerMove:v||o.getDisablePointerSelection()?void 0:b,onClick:v?void 0:y},e.children)}),bqe=E.forwardRef((e,t)=>{let{heading:n,children:r,forceMount:s,...i}=e,a=ca(),o=E.useRef(null),l=E.useRef(null),c=ca(),u=o_(),d=Hh(m=>s||u.filter()===!1?!0:m.search?m.filtered.groups.has(a):!0);Lm(()=>u.group(a),[]),qse(a,o,[e.value,e.heading,l]);let h=E.useMemo(()=>({id:a,forceMount:s}),[s]);return E.createElement(cr.div,{ref:pl(o,t),...i,"cmdk-group":"",role:"presentation",hidden:d?void 0:!0},n&&E.createElement("div",{ref:l,"cmdk-group-heading":"","aria-hidden":!0,id:c},n),ZT(e,m=>E.createElement("div",{"cmdk-group-items":"",role:"group","aria-labelledby":n?c:void 0},E.createElement($se.Provider,{value:h},m))))}),vqe=E.forwardRef((e,t)=>{let{alwaysRender:n,...r}=e,s=E.useRef(null),i=Hh(a=>!a.search);return!n&&!i?null:E.createElement(cr.div,{ref:pl(s,t),...r,"cmdk-separator":"",role:"separator"})}),xqe=E.forwardRef((e,t)=>{let{onValueChange:n,...r}=e,s=e.value!=null,i=r6(),a=Hh(c=>c.search),o=Hh(c=>c.selectedItemId),l=o_();return E.useEffect(()=>{e.value!=null&&i.setState("search",e.value)},[e.value]),E.createElement(cr.input,{ref:t,...r,"cmdk-input":"",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"aria-autocomplete":"list",role:"combobox","aria-expanded":!0,"aria-controls":l.listId,"aria-labelledby":l.labelId,"aria-activedescendant":o,id:l.inputId,type:"text",value:s?e.value:a,onChange:c=>{s||i.setState("search",c.target.value),n==null||n(c.target.value)}})}),wqe=E.forwardRef((e,t)=>{let{children:n,label:r="Suggestions",...s}=e,i=E.useRef(null),a=E.useRef(null),o=Hh(c=>c.selectedItemId),l=o_();return E.useEffect(()=>{if(a.current&&i.current){let c=a.current,u=i.current,d,h=new ResizeObserver(()=>{d=requestAnimationFrame(()=>{let m=c.offsetHeight;u.style.setProperty("--cmdk-list-height",m.toFixed(1)+"px")})});return h.observe(c),()=>{cancelAnimationFrame(d),h.unobserve(c)}}},[]),E.createElement(cr.div,{ref:pl(i,t),...s,"cmdk-list":"",role:"listbox",tabIndex:-1,"aria-activedescendant":o,"aria-label":r,id:l.listId},ZT(e,c=>E.createElement("div",{ref:pl(a,l.listInnerRef),"cmdk-list-sizer":""},c)))}),_qe=E.forwardRef((e,t)=>{let{open:n,onOpenChange:r,overlayClassName:s,contentClassName:i,container:a,...o}=e;return E.createElement(Vne,{open:n,onOpenChange:r},E.createElement(Wne,{container:a},E.createElement(Hne,{"cmdk-overlay":"",className:s}),E.createElement(Gne,{"aria-label":e.label,"cmdk-dialog":"",className:i},E.createElement(zse,{ref:t,...o}))))}),Sqe=E.forwardRef((e,t)=>Hh(n=>n.filtered.count===0)?E.createElement(cr.div,{ref:t,...e,"cmdk-empty":"",role:"presentation"}):null),Cqe=E.forwardRef((e,t)=>{let{progress:n,children:r,label:s="Loading...",...i}=e;return E.createElement(cr.div,{ref:t,...i,"cmdk-loading":"",role:"progressbar","aria-valuenow":n,"aria-valuemin":0,"aria-valuemax":100,"aria-label":s},ZT(e,a=>E.createElement("div",{"aria-hidden":!0},a)))}),_b=Object.assign(zse,{List:wqe,Item:yqe,Input:xqe,Group:bqe,Separator:vqe,Dialog:_qe,Empty:Sqe,Loading:Cqe});function kqe(e,t){let n=e.nextElementSibling;for(;n;){if(n.matches(t))return n;n=n.nextElementSibling}}function Eqe(e,t){let n=e.previousElementSibling;for(;n;){if(n.matches(t))return n;n=n.previousElementSibling}}function Use(e){let t=E.useRef(e);return Lm(()=>{t.current=e}),t}var Lm=typeof window>"u"?E.useEffect:E.useLayoutEffect;function b0(e){let t=E.useRef();return t.current===void 0&&(t.current=e()),t}function Hh(e){let t=r6(),n=()=>e(t.snapshot());return E.useSyncExternalStore(t.subscribe,n,n)}function qse(e,t,n,r=[]){let s=E.useRef(),i=o_();return Lm(()=>{var a;let o=(()=>{var c;for(let u of n){if(typeof u=="string")return u.trim();if(typeof u=="object"&&"current"in u)return u.current?(c=u.current.textContent)==null?void 0:c.trim():s.current}})(),l=r.map(c=>c.trim());i.value(e,o,l),(a=t.current)==null||a.setAttribute(y0,o),s.current=o}),s}var Tqe=()=>{let[e,t]=E.useState(),n=b0(()=>new Map);return Lm(()=>{n.current.forEach(r=>r()),n.current=new Map},[e]),(r,s)=>{n.current.set(r,s),t({})}};function Aqe(e){let t=e.type;return typeof t=="function"?t(e.props):"render"in t?t.render(e.props):e}function ZT({asChild:e,children:t},n){return e&&E.isValidElement(t)?E.cloneElement(Aqe(t),{ref:t.ref},n(t.props.children)):n(t)}var Rqe={position:"absolute",width:"1px",height:"1px",padding:"0",margin:"-1px",overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",borderWidth:"0"};function Vse({className:e,...t}){return f.jsx(_b,{"data-slot":"command",className:Ze("bg-popover text-popover-foreground flex h-full w-full flex-col overflow-hidden rounded-md",e),...t})}function Wse({className:e,...t}){return f.jsxs("div",{"data-slot":"command-input-wrapper",className:"flex h-9 items-center gap-2 border-b px-3",children:[f.jsx(uo,{className:"size-4 shrink-0 opacity-50"}),f.jsx(_b.Input,{"data-slot":"command-input",className:Ze("placeholder:text-muted-foreground flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-hidden disabled:cursor-not-allowed disabled:opacity-50",e),...t})]})}function Hse({className:e,...t}){return f.jsx(_b.List,{"data-slot":"command-list",className:Ze("max-h-[300px] scroll-py-1 overflow-x-hidden overflow-y-auto",e),...t})}function Gse({...e}){return f.jsx(_b.Empty,{"data-slot":"command-empty",className:"py-6 text-center text-sm",...e})}function Kse({className:e,...t}){return f.jsx(_b.Group,{"data-slot":"command-group",className:Ze("text-foreground [&_[cmdk-group-heading]]:text-muted-foreground overflow-hidden p-1 [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium",e),...t})}function Yse({className:e,...t}){return f.jsx(_b.Item,{"data-slot":"command-item",className:Ze("data-[selected=true]:bg-accent data-[selected=true]:text-accent-foreground [&_svg:not([class*='text-'])]:text-muted-foreground relative flex cursor-default items-center gap-2 rounded-sm px-2 py-1.5 text-sm outline-hidden select-none data-[disabled=true]:pointer-events-none data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:shrink-0 [&_svg:not([class*='size-'])]:size-4",e),...t})}const ag=({models:e,value:t,onChange:n,className:r,disabled:s,isLoading:i})=>{const[a,o]=E.useState(!1),[l,c]=E.useState(""),[u,d]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1,imageGeneration:!1}),h=E.useMemo(()=>{let w=e;if(l.trim()){const k=l.toLowerCase();w=e.filter(C=>C.name.toLowerCase().includes(k)||C.providerName.toLowerCase().includes(k)||C.id.toLowerCase().includes(k))}const S=Object.entries(u).filter(([,k])=>k).map(([k])=>k);return S.length===0?w:w.filter(k=>{var N,I,O;const C=new Set(((N=k.metadataSummary)==null?void 0:N.supported_parameters)??[]),T=new Set(((I=k.metadataSummary)==null?void 0:I.input_modalities)??[]),A=new Set(((O=k.metadataSummary)==null?void 0:O.output_modalities)??[]);return S.every(B=>{switch(B){case"reasoning":return C.has("reasoning");case"webSearch":return C.has("web_search")||C.has("web_search_options");case"tools":return C.has("tools");case"multimodal":return Array.from(T).some(D=>D!=="text");case"imageGeneration":return A.has("image");default:return!0}})})},[e,l,u]),m=E.useMemo(()=>e.find(w=>w.id===t),[e,t]),y=E.useCallback(w=>{const S=w===t?null:w;n==null||n(S),o(!1),c("")},[t,n]),b=w=>{d(S=>({...S,[w]:!S[w]}))};if(i)return f.jsx(Gr,{className:Ze("h-9 w-[250px]",r)});const x=Object.values(u).filter(Boolean).length;return f.jsxs(ic,{open:a,onOpenChange:o,children:[f.jsx(ac,{asChild:!0,children:f.jsxs(ct,{variant:"outline",role:"combobox","aria-expanded":a,disabled:s||e.length===0,className:Ze("w-auto justify-between h-9 text-sm font-normal relative",r),children:[f.jsx("span",{className:"truncate max-w-[200px] sm:max-w-[300px]",children:m?`${m.name} (${m.providerName})`:"Select Model..."}),f.jsx(vE,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"}),x>0&&f.jsx("span",{className:"absolute -top-1 -right-1 inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:x})]})}),f.jsx(oc,{className:"w-[--radix-popover-trigger-width] p-0",style:{maxHeight:"min(40vh, 400px)",overflow:"hidden",zIndex:9999,pointerEvents:"auto"},onMouseDown:w=>w.preventDefault(),onClick:w=>w.stopPropagation(),onPointerDown:w=>w.stopPropagation(),onPointerDownCapture:w=>w.stopPropagation(),children:f.jsxs(Vse,{shouldFilter:!1,children:[f.jsxs("div",{className:"flex items-center border-b px-3",children:[f.jsx(uo,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),f.jsx(Wse,{placeholder:"Search model...",value:l,onValueChange:c,className:"flex h-10 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50 border-0 focus-visible:ring-0 focus-visible:ring-offset-0"}),f.jsxs("div",{className:"flex items-center gap-0.5 ml-auto pl-2",children:[f.jsx(ct,{variant:u.reasoning?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",u.reasoning&&"text-primary"),onClick:()=>b("reasoning"),title:"Filter: Reasoning","aria-label":"Filter by reasoning capability",children:f.jsx(f2,{className:"h-4 w-4"})}),f.jsx(ct,{variant:u.webSearch?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",u.webSearch&&"text-primary"),onClick:()=>b("webSearch"),title:"Filter: Web Search","aria-label":"Filter by web search capability",children:f.jsx(h2,{className:"h-4 w-4"})}),f.jsx(ct,{variant:u.tools?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",u.tools&&"text-primary"),onClick:()=>b("tools"),title:"Filter: Tools","aria-label":"Filter by tool usage capability",children:f.jsx(Sm,{className:"h-4 w-4"})}),f.jsx(ct,{variant:u.multimodal?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",u.multimodal&&"text-primary"),onClick:()=>b("multimodal"),title:"Filter: Multimodal","aria-label":"Filter by multimodal capability",children:f.jsx(Ah,{className:"h-4 w-4"})}),f.jsx(ct,{variant:u.imageGeneration?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",u.imageGeneration&&"text-primary"),onClick:()=>b("imageGeneration"),title:"Filter: Image Generation","aria-label":"Filter by image generation capability",children:f.jsx(ny,{className:"h-4 w-4"})})]})]}),f.jsxs(Hse,{className:"max-h-[calc(min(40vh,400px)-70px)] overflow-y-auto",children:[f.jsx(Gse,{children:x>0?"No models match all active filters.":e.length===0?"No models available.":"No model found."}),f.jsx(Kse,{children:h.map(w=>{var S,k,C,T,A,N,I,O,B,D,H,P;return f.jsx(Yse,{value:w.id,onSelect:y,className:"flex items-center",children:f.jsxs("div",{className:"flex-1 truncate flex justify-between items-center",children:[f.jsxs("div",{children:[f.jsx("div",{className:"text-sm font-medium",children:w.name}),f.jsx("div",{className:"text-xs text-muted-foreground",children:w.providerName})]}),f.jsxs("div",{className:"flex gap-1 ml-2",children:[((k=(S=w.metadataSummary)==null?void 0:S.supported_parameters)==null?void 0:k.includes("reasoning"))&&f.jsx(f2,{className:"h-3.5 w-3.5 text-purple-500"}),(((T=(C=w.metadataSummary)==null?void 0:C.supported_parameters)==null?void 0:T.includes("web_search"))||((N=(A=w.metadataSummary)==null?void 0:A.supported_parameters)==null?void 0:N.includes("web_search_options")))&&f.jsx(h2,{className:"h-3.5 w-3.5 text-blue-500"}),((O=(I=w.metadataSummary)==null?void 0:I.supported_parameters)==null?void 0:O.includes("tools"))&&f.jsx(Sm,{className:"h-3.5 w-3.5 text-orange-500"}),((D=(B=w.metadataSummary)==null?void 0:B.input_modalities)==null?void 0:D.some(K=>K!=="text"))&&f.jsx(Ah,{className:"h-3.5 w-3.5 text-green-500"}),((P=(H=w.metadataSummary)==null?void 0:H.output_modalities)==null?void 0:P.includes("image"))&&f.jsx(ny,{className:"h-3.5 w-3.5 text-pink-500"})]})]})},w.id)})})]})]})})]})},b3=Ke({systemPrompt:$e().nullable(),modelId:$e().nullable()}),Nqe=({initialSystemPrompt:e,initialModelId:t,onSave:n,effectiveSystemPrompt:r,effectiveModelId:s,isParentSaving:i=!1})=>{var u;const{getAvailableModelListItems:a}=Qn(yn(d=>({getAvailableModelListItems:d.getAvailableModelListItems}))),o=a(),l=((u=o.find(d=>d.id===s))==null?void 0:u.name)||s,c=ii({defaultValues:{systemPrompt:e??null,modelId:t??null},validators:{onChangeAsync:b3,onChangeAsyncDebounceMs:500},onSubmit:async({value:d})=>{await n({systemPrompt:d.systemPrompt,modelId:d.modelId})}});return E.useEffect(()=>{c.reset({systemPrompt:e??null,modelId:t??null})},[e,t,c]),f.jsxs("form",{onSubmit:d=>{d.preventDefault(),d.stopPropagation(),c.handleSubmit()},className:"space-y-6",children:[f.jsx(c.Field,{name:"systemPrompt",validators:{onChange:b3.shape.systemPrompt},children:d=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:`${d.name}-textarea`,children:"System Prompt (Overrides Parent/Global)"}),f.jsx(qa,{id:`${d.name}-textarea`,placeholder:`Inherited: ${(r==null?void 0:r.substring(0,100))||"Default"}${r&&r.length>100?"...":""}`,value:d.state.value??"",onChange:h=>d.handleChange(h.target.value),onBlur:d.handleBlur,rows:6,disabled:c.state.isSubmitting||i,className:"mt-1"}),f.jsx(ji,{field:d}),f.jsx(ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("systemPrompt",null),disabled:c.state.isSubmitting||i||d.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),f.jsx(c.Field,{name:"modelId",validators:{onChange:b3.shape.modelId},children:d=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{children:"Default Model (Overrides Parent/Global)"}),f.jsx(ag,{models:o,value:d.state.value,onChange:h=>{d.handleChange(h),d.handleBlur()},disabled:c.state.isSubmitting||i,className:"w-full mt-1"}),f.jsx(ji,{field:d}),f.jsxs(ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>c.setFieldValue("modelId",null),disabled:c.state.isSubmitting||i||d.state.value===null,type:"button",children:["Use Inherited/Default (",l||"Global Default",")"]})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(c.Subscribe,{selector:d=>[d.canSubmit,d.isSubmitting,d.isValidating,d.isValid],children:([d,h,m,y])=>f.jsxs(ct,{type:"submit",size:"sm",disabled:i||!d||h||m||!y,children:[(h||m)&&f.jsx(Jn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Uu,{className:"h-4 w-4 mr-1"}),h||m?"Saving...":"Save Prompt Settings"]})})})]})};function f0({field:e}){return e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive pt-1 block",children:e.state.meta.errors.join(", ")}):null}const Mqe=({form:e,isSaving:t,effectiveTemperature:n,effectiveMaxTokens:r,effectiveTopP:s,effectiveTopK:i,effectivePresencePenalty:a,effectiveFrequencyPenalty:o})=>f.jsxs("div",{className:"space-y-4",children:[f.jsx(e.Field,{name:"temperature",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(jt,{htmlFor:l.name,className:"text-xs",children:["Temperature (",(l.state.value??n??.7).toFixed(2),")"]}),f.jsx(I0,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??n??.7],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(n==null?void 0:n.toFixed(2))??"N/A",")"]}),f.jsx(f0,{field:l})]})}),f.jsx(e.Field,{name:"topP",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(jt,{htmlFor:l.name,className:"text-xs",children:["Top P (",(l.state.value??s??1).toFixed(2),")"]}),f.jsx(I0,{id:l.name,min:0,max:1,step:.01,value:[l.state.value??s??1],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(s==null?void 0:s.toFixed(2))??"N/A",")"]}),f.jsx(f0,{field:l})]})}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[f.jsx(e.Field,{name:"maxTokens",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:l.name,className:"text-xs",children:"Max Tokens"}),f.jsx(xn,{id:l.name,type:"number",placeholder:`Inherited: ${r??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),f.jsx(ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),f.jsx(f0,{field:l})]})}),f.jsx(e.Field,{name:"topK",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:l.name,className:"text-xs",children:"Top K"}),f.jsx(xn,{id:l.name,type:"number",placeholder:`Inherited: ${i??"Default"}`,value:l.state.value??"",onChange:c=>l.handleChange(c.target.value===""?null:parseInt(c.target.value,10)),onBlur:l.handleBlur,min:"1",className:"h-8 text-xs",disabled:t}),f.jsx(ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:"Use Inherited/Default"}),f.jsx(f0,{field:l})]})})]}),f.jsx(e.Field,{name:"presencePenalty",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(jt,{htmlFor:l.name,className:"text-xs",children:["Presence Penalty (",(l.state.value??a??0).toFixed(2),")"]}),f.jsx(I0,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??a??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(a==null?void 0:a.toFixed(2))??"N/A",")"]}),f.jsx(f0,{field:l})]})}),f.jsx(e.Field,{name:"frequencyPenalty",children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsxs(jt,{htmlFor:l.name,className:"text-xs",children:["Frequency Penalty (",(l.state.value??o??0).toFixed(2),")"]}),f.jsx(I0,{id:l.name,min:-2,max:2,step:.01,value:[l.state.value??o??0],onValueChange:c=>l.handleChange(c[0]),onBlur:l.handleBlur,disabled:t}),f.jsxs(ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 text-muted-foreground",onClick:()=>l.handleChange(null),disabled:t||l.state.value===null,children:["Use Inherited/Default (",(o==null?void 0:o.toFixed(2))??"N/A",")"]}),f.jsx(f0,{field:l})]})})]}),zq=Ke({syncRepoId:$e().nullable()}),Iqe=({initialSyncRepoId:e,onSave:t,effectiveSyncRepoId:n,syncRepos:r,isParentSaving:s=!1})=>{var o;const i=((o=r.find(l=>l.id===n))==null?void 0:o.name)??"None",a=ii({defaultValues:{syncRepoId:e??null},validators:{onChangeAsync:zq,onChangeAsyncDebounceMs:500},onSubmit:async({value:l})=>{await t(l)}});return E.useEffect(()=>{a.reset({syncRepoId:e??null})},[e,a]),f.jsxs("form",{onSubmit:l=>{l.preventDefault(),l.stopPropagation(),a.handleSubmit()},className:"space-y-6",children:[f.jsx(a.Field,{name:"syncRepoId",validators:{onChange:zq.shape.syncRepoId},children:l=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:l.name,children:"Sync Repository (Overrides Parent/Global)"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-1",children:"Link this project to a sync repository. All new conversations created within this project will automatically inherit this link."}),f.jsxs(lf,{value:l.state.value??"none",onValueChange:c=>{l.handleChange(c==="none"?null:c),l.handleBlur()},disabled:a.state.isSubmitting||s||r.length===0,children:[f.jsx(uf,{id:l.name,children:f.jsx(cf,{placeholder:r.length===0?"No sync repos configured":`Inherited: ${i}`})}),f.jsxs(df,{children:[f.jsx(Ba,{value:"none",children:f.jsxs("span",{className:"text-muted-foreground",children:["Use Inherited/Default (",i,")"]})}),r.map(c=>f.jsx(Ba,{value:c.id,children:c.name},c.id))]})]}),f.jsx(ji,{field:l}),f.jsx(ct,{variant:"link",size:"sm",className:"text-xs h-auto p-0 mt-1 text-muted-foreground",onClick:()=>a.setFieldValue("syncRepoId",null),disabled:a.state.isSubmitting||s||l.state.value===null,type:"button",children:"Use Inherited/Default"})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(a.Subscribe,{selector:l=>[l.canSubmit,l.isSubmitting,l.isValidating,l.isValid],children:([l,c,u,d])=>f.jsxs(ct,{type:"submit",size:"sm",disabled:s||!l||c||u||!d||r.length===0,children:[(c||u)&&f.jsx(Jn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Uu,{className:"h-4 w-4 mr-1"}),c||u?"Saving...":"Save Sync Settings"]})})})]})},jqe=({projectId:e})=>{const t=E.useMemo(()=>[{value:"manage",label:"Manage Files",content:f.jsx("div",{className:"flex-grow border rounded-md overflow-hidden h-full",children:e?f.jsx(n6,{}):f.jsx("div",{className:"p-4 text-center text-muted-foreground",children:"Invalid Project ID. Cannot load filesystem."})})},{value:"settings",label:"Settings",content:f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx(jt,{children:"Project Filesystem Info"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Each project has its own dedicated Virtual File System (VFS)."}),f.jsxs("div",{className:"p-3 border rounded bg-muted/30 text-sm mb-2 break-all",children:[" ",f.jsxs("p",{children:[f.jsx("span",{className:"font-medium",children:"Project ID (VFS Key):"})," ",f.jsx("code",{className:"text-xs",children:e||"N/A"})]})]})]}),f.jsxs("div",{className:"border-t pt-4 border-destructive/50 mt-4 flex-shrink-0",children:[f.jsx(jt,{className:"text-destructive",children:"Danger Zone"}),f.jsx("p",{className:"text-xs text-destructive/90 mb-2",children:"Clearing the VFS will permanently delete all files stored specifically for this project. This cannot be undone."})]})]})}],[e]);return f.jsx(xl,{tabs:t,defaultValue:"manage",className:"h-full flex flex-col",listClassName:Ze("bg-muted/50 rounded-md","flex-wrap justify-start h-auto","p-1 gap-1"),contentContainerClassName:"mt-3 flex-grow flex flex-col overflow-y-auto"})},Pqe=({allRules:e,selectedRuleIds:t,onSelectionChange:n,disabled:r=!1})=>{const[s,i]=E.useState(""),a=E.useMemo(()=>{const o=s.toLowerCase();return o?e.filter(l=>l.name.toLowerCase().includes(o)||l.content.toLowerCase().includes(o)||l.type.toLowerCase().includes(o)):e},[e,s]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(uo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(xn,{type:"search",placeholder:"Filter rules...",value:s,onChange:o=>i(o.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsx(Zl,{className:"h-48 border rounded-md p-2 bg-background/50",children:a.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No rules defined globally.":"No rules match filter."}):f.jsx("div",{className:"space-y-1",children:a.map(o=>f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(zc,{id:`project-default-rule-${o.id}`,checked:t.has(o.id),onCheckedChange:l=>n(o.id,!!l),className:"mt-0.5",disabled:r}),f.jsxs(jt,{htmlFor:`project-default-rule-${o.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:o.name}),f.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",o.type]}),f.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",o.content]})]})]})},o.id))})})]})},Oqe=({defaultRuleIds:e,setDefaultRuleIds:t,isSaving:n,allRules:r})=>{const s=E.useMemo(()=>new Set(e??[]),[e]),i=E.useCallback((a,o)=>{const l=new Set(s);o?l.add(a):l.delete(a);const c=Array.from(l);t(c.length>0?c:null)},[s,t]);return f.jsxs("div",{className:"space-y-4",children:[f.jsx(jt,{children:"Default Rules for this Project"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Select rules that will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),f.jsx(Pqe,{allRules:r,selectedRuleIds:s,onSelectionChange:i,disabled:n})]})},Dqe=({allTags:e,selectedTagIds:t,onSelectionChange:n,disabled:r=!1,getRulesForTag:s})=>{const[i,a]=E.useState(""),o=E.useMemo(()=>{const l=i.toLowerCase();return l?e.filter(c=>{var u;return c.name.toLowerCase().includes(l)||((u=c.description)==null?void 0:u.toLowerCase().includes(l))}):e},[e,i]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"relative",children:[f.jsx(uo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(xn,{type:"search",placeholder:"Filter tags...",value:i,onChange:l=>a(l.target.value),className:"pl-8 h-9",disabled:r})]}),f.jsx(Zl,{className:"h-48 border rounded-md p-2 bg-background/50",children:o.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:e.length===0?"No tags defined globally.":"No tags match filter."}):f.jsx("div",{className:"space-y-1",children:o.map(l=>{const c=s(l.id);return f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(zc,{id:`project-default-tag-${l.id}`,checked:t.has(l.id),onCheckedChange:u=>n(l.id,!!u),className:"mt-0.5",disabled:r}),f.jsxs(jt,{htmlFor:`project-default-tag-${l.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:l.name}),l.description&&f.jsx("span",{className:"block text-xs text-muted-foreground",children:l.description}),c.length>0&&f.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",c.map(u=>u.name).join(", ")]})]})]})},l.id)})})})]})},Fqe=({defaultTagIds:e,setDefaultTagIds:t,isSaving:n,allTags:r,getRulesForTag:s})=>{const i=E.useMemo(()=>new Set(e??[]),[e]),a=E.useCallback((o,l)=>{const c=new Set(i);l?c.add(o):c.delete(o);const u=Array.from(c);t(u.length>0?u:null)},[i,t]);return f.jsxs("div",{className:"space-y-4",children:[f.jsx(jt,{children:"Default Tags for this Project"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Select tags whose rules will be automatically applied to new conversations within this project. These can be overridden per-conversation or per-turn."}),f.jsx(Dqe,{allTags:r,selectedTagIds:i,onSelectionChange:a,disabled:n,getRulesForTag:s})]})},Lqe=Ke({temperature:At().min(0).max(1),topP:At().min(0).max(1),maxTokens:At().min(1).nullable(),topK:At().min(1).nullable(),presencePenalty:At().min(-2).max(2),frequencyPenalty:At().min(-2).max(2)}),Bqe=({isOpen:e,onClose:t,projectId:n,module:r})=>{const{getProjectById:s,updateProject:i}=yl(yn(U=>({getProjectById:U.getProjectById,updateProject:U.updateProject}))),a=yl(U=>U.getEffectiveProjectSettings),o=Vn(U=>U.syncRepos),l=pr(yn(U=>({globalSystemPrompt:U.globalSystemPrompt,temperature:U.temperature,maxTokens:U.maxTokens,topP:U.topP,topK:U.topK,presencePenalty:U.presencePenalty,frequencyPenalty:U.frequencyPenalty}))),c=Qn(U=>U.selectedModelId),u=ei(U=>U.setVfsKey),[d,h]=E.useState(null),[m,y]=E.useState(null),[b,v]=E.useState(null),[x,w]=E.useState(null),[S,k]=E.useState(null),[C,T]=E.useState(!1),[A,N]=E.useState("prompt"),{project:I,effectiveSettings:O}=E.useMemo(()=>{const U=n?s(n):null,V=n?a(n):null;return{project:U,effectiveSettings:V}},[n,s,a]),B=ii({defaultValues:{temperature:(I==null?void 0:I.temperature)??.7,topP:(I==null?void 0:I.topP)??1,maxTokens:(I==null?void 0:I.maxTokens)??null,topK:(I==null?void 0:I.topK)??null,presencePenalty:(I==null?void 0:I.presencePenalty)??0,frequencyPenalty:(I==null?void 0:I.presencePenalty)??0},validators:{onChangeAsync:Lqe,onChangeAsyncDebounceMs:500}}),D=E.useCallback(U=>{var L;if(!U)return null;const V=s(U);return V?((L=V.metadata)==null?void 0:L.syncRepoId)!==void 0?V.metadata.syncRepoId:D(V.parentId):null},[s]),H=n?D(n):null;E.useEffect(()=>{var U;e&&n&&I&&O?(u(n),h(I.systemPrompt??null),y(I.modelId??null),v(((U=I.metadata)==null?void 0:U.syncRepoId)??null),w(I.defaultTagIds??null),k(I.defaultRuleIds??null),B.reset({temperature:I.temperature??.7,topP:I.topP??1,maxTokens:I.maxTokens??null,topK:I.topK??null,presencePenalty:I.presencePenalty??0,frequencyPenalty:I.frequencyPenalty??0}),N("prompt")):e||(u(null),h(null),y(null),v(null),w(null),k(null),B.reset({temperature:.7,topP:1,maxTokens:null,topK:null,presencePenalty:0,frequencyPenalty:0}))},[e,n,I,O,u,B]);const P=async()=>{if(!(!n||!I)){T(!0);try{const U=I.parentId?a(I.parentId):{systemPrompt:l.globalSystemPrompt,modelId:c,temperature:l.temperature,maxTokens:l.maxTokens,topP:l.topP,topK:l.topK,presencePenalty:l.presencePenalty,frequencyPenalty:l.frequencyPenalty,defaultTagIds:null,defaultRuleIds:null},V=I.parentId?D(I.parentId):null,L={},te={...I.metadata??{}},W=B.state.values;d!==U.systemPrompt?L.systemPrompt=d:L.systemPrompt=void 0,m!==U.modelId?L.modelId=m:L.modelId=void 0,W.temperature!==U.temperature?L.temperature=W.temperature:L.temperature=void 0,W.maxTokens!==U.maxTokens?L.maxTokens=W.maxTokens:L.maxTokens=void 0,W.topP!==U.topP?L.topP=W.topP:L.topP=void 0,W.topK!==U.topK?L.topK=W.topK:L.topK=void 0,W.presencePenalty!==U.presencePenalty?L.presencePenalty=W.presencePenalty:L.presencePenalty=void 0,W.frequencyPenalty!==U.frequencyPenalty?L.frequencyPenalty=W.frequencyPenalty:L.frequencyPenalty=void 0,b!==V?te.syncRepoId=b:delete te.syncRepoId,JSON.stringify(x)!==JSON.stringify(U.defaultTagIds)?L.defaultTagIds=x:L.defaultTagIds=void 0,JSON.stringify(S)!==JSON.stringify(U.defaultRuleIds)?L.defaultRuleIds=S:L.defaultRuleIds=void 0,L.metadata=te,await i(n,L),Te.success(`Project "${I.name}" settings updated.`),t()}catch(U){Te.error("Failed to save project settings."),console.error("Failed to save project settings:",U)}finally{T(!1)}}},K=E.useMemo(()=>[{value:"prompt",label:"Prompt & Model",content:f.jsx(Nqe,{initialSystemPrompt:d,initialModelId:m,onSave:({systemPrompt:U,modelId:V})=>{h(U),y(V)},effectiveSystemPrompt:(O==null?void 0:O.systemPrompt)??l.globalSystemPrompt,effectiveModelId:(O==null?void 0:O.modelId)??c,isParentSaving:C})},{value:"params",label:"Parameters",content:f.jsx(Mqe,{form:B,effectiveTemperature:(O==null?void 0:O.temperature)??l.temperature,effectiveMaxTokens:(O==null?void 0:O.maxTokens)??l.maxTokens,effectiveTopP:(O==null?void 0:O.topP)??l.topP??1,effectiveTopK:(O==null?void 0:O.topK)??l.topK,effectivePresencePenalty:(O==null?void 0:O.presencePenalty)??l.presencePenalty??0,effectiveFrequencyPenalty:(O==null?void 0:O.frequencyPenalty)??l.frequencyPenalty??0,isSaving:C})},{value:"rules-tags",label:"Rules & Tags",content:f.jsxs("div",{className:"space-y-6",children:[f.jsx(Oqe,{defaultRuleIds:S,setDefaultRuleIds:k,isSaving:C,allRules:r.getAllRules()}),f.jsx(Fqe,{defaultTagIds:x,setDefaultTagIds:w,isSaving:C,allTags:r.getAllTags(),getRulesForTag:r.getRulesForTag})]})},{value:"sync",label:"Sync",content:f.jsx(Iqe,{initialSyncRepoId:b,onSave:({syncRepoId:U})=>{v(U)},effectiveSyncRepoId:H,syncRepos:o,isParentSaving:C})},{value:"vfs",label:"Filesystem",content:f.jsx(jqe,{projectId:n,projectName:(I==null?void 0:I.name)??null,isSaving:C})}],[d,m,b,x,S,B,O,l,c,C,H,o,n,I==null?void 0:I.name,r]);return f.jsx(hf,{open:e,onOpenChange:t,children:f.jsxs(pf,{className:Ze("w-[95vw] h-[85vh] flex flex-col p-0","sm:w-[90vw] sm:max-w-[800px]","md:h-[75vh]","min-h-[500px] max-h-[90vh]"),children:[f.jsxs(mf,{className:"p-4 md:p-6 pb-2 md:pb-4 flex-shrink-0",children:[f.jsxs(gf,{children:["Project Settings: ",I==null?void 0:I.name]}),f.jsx(mp,{children:"Configure default settings for this project. Settings inherit from parent projects or global defaults if not set here."})]}),f.jsx(xl,{tabs:K,initialValue:A,onValueChange:N,className:"flex-grow overflow-hidden px-4 md:px-6",listClassName:"-mx-4 md:-mx-6 px-2 md:px-6 py-1 md:py-0",contentContainerClassName:"pb-4 md:pb-6 overflow-y-auto",scrollable:!1}),f.jsxs(xb,{className:"flex-shrink-0 border-t p-4 md:p-6 pt-3 md:pt-4 mt-auto",children:[f.jsx(ct,{variant:"outline",onClick:t,disabled:C,children:"Cancel"}),f.jsxs(ct,{onClick:P,disabled:C,children:[C&&f.jsx(Jn,{className:"mr-2 h-4 w-4 animate-spin"}),"Save Project Settings"]})]})]})})};class $qe{constructor(){ue(this,"id","core-project-settings");ue(this,"modalId","projectSettingsModal");ue(this,"unregisterModalProviderCallback",null);ue(this,"modApiRef",null);ue(this,"eventUnsubscribers",[]);ue(this,"allRules",[]);ue(this,"allTags",[]);ue(this,"tagRuleLinks",[]);ue(this,"getAllRules",()=>this.allRules);ue(this,"getAllTags",()=>this.allTags);ue(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});ue(this,"openModal",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(Tr.openModalRequest,{modalId:this.modalId,targetId:t,initialTab:n})});ue(this,"closeModal",()=>{var t;(t=this.modApiRef)==null||t.emit(Tr.closeModalRequest,{modalId:this.modalId})})}async initialize(t){this.modApiRef=t;const n=t.on(vr.dataLoaded,r=>{r&&(this.allRules=r.rules||[],this.allTags=r.tags||[],this.tagRuleLinks=(r.links||[]).map(s=>({tagId:s.tagId,ruleId:s.ruleId})))});this.eventUnsubscribers.push(n),t.emit(vr.loadRulesAndTagsRequest,void 0),console.log(`[${this.id}] Initialized.`)}register(t){if(this.modApiRef=t,this.unregisterModalProviderCallback){console.warn(`[${this.id}] Modal provider already registered. Skipping.`);return}this.unregisterModalProviderCallback=t.registerModalProvider(this.modalId,n=>Ve.createElement(Bqe,{isOpen:n.isOpen,onClose:n.onClose,projectId:n.targetId||null,module:this})),console.log(`[${this.id}] Modal provider registered for ${this.modalId}.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterModalProviderCallback&&(this.unregisterModalProviderCallback(),this.unregisterModalProviderCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const s6=Ve.memo(({module:e,value:t,onChange:n,className:r,disabled:s})=>{const[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=!!e,o=a?e.selectedModelId:t,l=a?e.isStreaming:s,c=a?e.isLoadingProviders:!1,u=a?e.globallyEnabledModels:Qn(h=>h.getGloballyEnabledModelDefinitions()),d=E.useCallback(h=>{a&&e?e.handleSelectionChange(h):n&&n(h)},[a,e,n]);return f.jsx(ag,{models:u,value:o,onChange:d,className:r,disabled:l,isLoading:c})});s6.displayName="GlobalModelSelector";class zqe{constructor(){ue(this,"id","core-global-model-selector");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"selectedModelId",null);ue(this,"isStreaming",!1);ue(this,"isLoadingProviders",!0);ue(this,"globallyEnabledModels",[]);ue(this,"notifyComponentUpdate",null);ue(this,"handleSelectionChange",t=>{var n,r;(n=this.modApiRef)==null||n.emit(Wn.selectModelRequest,{modelId:t}),(r=this.modApiRef)==null||r.emit(sn.setModelIdRequest,{id:t})});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t;const n=Qn.getState();this.isLoadingProviders=n.isLoading,this.selectedModelId=n.selectedModelId,this.isStreaming=un.getState().status==="streaming",this.isLoadingProviders||(this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions());const r=t.on(En.statusChanged,o=>{var l;if(typeof o=="object"&&o&&"status"in o){const c=o.status==="streaming";this.isStreaming!==c&&(this.isStreaming=c,(l=this.notifyComponentUpdate)==null||l.call(this))}}),s=t.on(Wn.selectedModelChanged,o=>{var l,c;typeof o=="object"&&o&&"modelId"in o&&this.selectedModelId!==o.modelId&&(this.selectedModelId=o.modelId,(l=this.modApiRef)==null||l.emit(sn.setModelIdRequest,{id:o.modelId}),(c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(Wn.globallyEnabledModelsUpdated,o=>{var d,h;let l=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(o.models)&&(this.globallyEnabledModels=o.models,l=!0);const c=Qn.getState().isLoading;this.isLoadingProviders!==c&&(this.isLoadingProviders=c,l=!0);const u=Qn.getState().selectedModelId;this.selectedModelId!==u&&(this.selectedModelId=u,(d=this.modApiRef)==null||d.emit(sn.setModelIdRequest,{id:this.selectedModelId}),l=!0),l&&((h=this.notifyComponentUpdate)==null||h.call(this))}),a=t.on(Wn.initialDataLoaded,()=>{var u,d;const o=Qn.getState();let l=!1;this.isLoadingProviders!==o.isLoading&&(this.isLoadingProviders=o.isLoading,l=!0),this.selectedModelId!==o.selectedModelId&&(this.selectedModelId=o.selectedModelId,(u=this.modApiRef)==null||u.emit(sn.setModelIdRequest,{id:this.selectedModelId}),l=!0);const c=o.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(c)&&(this.globallyEnabledModels=c,l=!0),l&&((d=this.notifyComponentUpdate)==null||d.call(this))});this.eventUnsubscribers.push(r,s,i,a)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingProviders?"loading":"ready",triggerRenderer:()=>Ve.createElement(s6,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Uqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=E.useState(!1),[s,i]=E.useState(e.getTurnSystemPrompt()),a=e.getEffectiveSystemPrompt(),o=e.getIsStreaming(),l=e.getTurnSystemPrompt();E.useEffect(()=>{n&&i(e.getTurnSystemPrompt())},[n,e]);const c=E.useCallback(()=>{e.setTurnSystemPrompt(s.trim()),r(!1)},[s,e]),u=E.useCallback(()=>{i(""),e.setTurnSystemPrompt(""),r(!1)},[e]),d=m=>{m&&i(e.getTurnSystemPrompt()),r(m)},h=l.trim().length>0;return f.jsxs(ic,{open:n,onOpenChange:d,children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ac,{asChild:!0,children:f.jsx(ct,{variant:h?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:o,"aria-label":"Set System Prompt for Next Turn",children:f.jsx(Jge,{className:"h-4 w-4"})})})}),f.jsx(Cr,{side:"top",children:h?"System Prompt Override Active":"Set System Prompt (Next Turn)"})]})}),f.jsxs(oc,{className:"w-80 p-4 space-y-3",align:"start",children:[f.jsx(jt,{htmlFor:"turn-system-prompt",children:"System Prompt (Overrides Project/Global for Next Turn)"}),f.jsx(qa,{id:"turn-system-prompt",placeholder:`Inherited: ${(a==null?void 0:a.substring(0,50))||"Default"}${a&&a.length>50?"...":""}`,value:s,onChange:m=>i(m.target.value),rows:5,className:"text-sm"}),f.jsxs("div",{className:"flex justify-between",children:[f.jsx(ct,{variant:"outline",size:"sm",onClick:u,disabled:!s.trim(),children:"Clear Override"}),f.jsx(ct,{size:"sm",onClick:c,children:"Set for Next Turn"})]})]})]})};class qqe{constructor(){ue(this,"id","core-system-prompt");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"turnSystemPromptValue","");ue(this,"effectiveSystemPrompt",null);ue(this,"isStreaming",!1);ue(this,"notifyComponentUpdate",null);ue(this,"getTurnSystemPrompt",()=>this.turnSystemPromptValue);ue(this,"getEffectiveSystemPrompt",()=>this.effectiveSystemPrompt);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"setTurnSystemPrompt",t=>{var n;this.turnSystemPromptValue!==t&&(this.turnSystemPromptValue=t,(n=this.notifyComponentUpdate)==null||n.call(this))});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=un.getState().status==="streaming",this.updateEffectivePrompt();const n=t.on(En.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Tr.contextChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(Sa.updated,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)}),i=t.on(an.globalSystemPromptChanged,()=>{var a;this.updateEffectivePrompt(),(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r,s,i)}updateEffectivePrompt(){var a;const t=Vn.getState(),n=yl.getState(),r=pr.getState(),s=t.selectedItemType==="project"?t.selectedItemId:t.selectedItemType==="conversation"?((a=t.getConversationById(t.selectedItemId))==null?void 0:a.projectId)??null:null,i=n.getEffectiveProjectSettings(s).systemPrompt??r.globalSystemPrompt;this.effectiveSystemPrompt!==i&&(this.effectiveSystemPrompt=i)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(Uqe,{module:this}),getMetadata:()=>{const n=this.turnSystemPromptValue.trim();return n?{turnSystemPrompt:n}:void 0},clearOnSubmit:()=>{var n;this.turnSystemPromptValue!==""&&(this.turnSystemPromptValue="",(n=this.notifyComponentUpdate)==null||n.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Vqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getStructuredOutputJson(),[r,s]=E.useState(!1),[i,a]=E.useState(n??""),[o,l]=E.useState(""),[c,u]=E.useState([]),d=E.useCallback(()=>{try{JSON.parse(i),e.setStructuredOutputJson(i.trim()||null),s(!1),Te.success("Structured output applied for next turn.")}catch{Te.error("Invalid JSON format.")}},[i,e]),h=E.useCallback(()=>{a(""),e.setStructuredOutputJson(null),s(!1),Te.info("Structured output cleared.")},[e]),m=E.useCallback(()=>{if(!o.trim()){Te.error("Please provide a name to save to the library.");return}try{JSON.parse(i);const w={id:Date.now().toString(),name:o.trim(),json:i};u(S=>[...S,w]),l(""),Te.success(`"${w.name}" saved to library.`)}catch{Te.error("Cannot save invalid JSON to library.")}},[i,o]),y=E.useCallback(w=>{a(w.json),e.setStructuredOutputJson(w.json),s(!1),Te.success(`Loaded "${w.name}" from library.`)},[e]),b=E.useCallback(w=>{u(S=>S.filter(k=>k.id!==w)),Te.info("Item removed from library.")},[]);E.useEffect(()=>{r&&a(e.getStructuredOutputJson()??"")},[r,e]);const v=[{value:"entry",label:"Entry",content:f.jsxs("div",{className:"space-y-3 p-1",children:[f.jsx(jt,{htmlFor:"structured-output-entry",children:"JSON Output Schema"}),f.jsx(qa,{id:"structured-output-entry",placeholder:'e.g., {"type": "object", "properties": {"name": {"type": "string"}}}',value:i,onChange:w=>a(w.target.value),rows:8,className:"font-mono text-xs"}),f.jsxs("div",{className:"flex justify-between items-end gap-2",children:[f.jsxs("div",{className:"flex-grow space-y-1",children:[f.jsx(jt,{htmlFor:"structured-output-name",className:"text-xs",children:"Save to Library (Optional Name)"}),f.jsx(xn,{id:"structured-output-name",value:o,onChange:w=>l(w.target.value),placeholder:"Schema Name",className:"h-8 text-xs"})]}),f.jsxs(ct,{size:"sm",variant:"outline",onClick:m,disabled:!o.trim()||!i.trim(),className:"h-8",children:[f.jsx(Uu,{className:"h-3.5 w-3.5 mr-1"})," Save"]})]}),f.jsxs("div",{className:"flex justify-end gap-2 pt-2",children:[f.jsx(ct,{variant:"outline",size:"sm",onClick:h,disabled:!n,children:"Clear Applied Schema"}),f.jsx(ct,{size:"sm",onClick:d,disabled:!i,children:"Apply for Next Turn"})]})]})},{value:"library",label:"Library",content:f.jsx("div",{className:"space-y-2 p-1",children:c.length===0?f.jsx("p",{className:"text-xs text-muted-foreground text-center py-4",children:"No saved schemas yet."}):c.map(w=>f.jsxs("div",{className:"flex items-center justify-between p-2 border rounded hover:bg-muted/50",children:[f.jsx("span",{className:"text-sm font-medium truncate flex-grow mr-2",children:w.name}),f.jsxs("div",{className:"flex gap-1 flex-shrink-0",children:[f.jsx(ct,{size:"sm",variant:"outline",onClick:()=>y(w),className:"h-7 px-2 text-xs",children:"Use"}),f.jsx(ct,{size:"icon",variant:"ghost",onClick:()=>b(w.id),className:"h-7 w-7 text-destructive",children:f.jsx(Po,{className:"h-3.5 w-3.5"})})]})]},w.id))})}],x=!!n;return f.jsxs(ic,{open:r,onOpenChange:s,children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ac,{asChild:!0,children:f.jsx(ct,{variant:x?"secondary":"ghost",size:"icon",className:"h-8 w-8","aria-label":"Set Structured Output",children:f.jsx(_E,{className:"h-4 w-4"})})})}),f.jsx(Cr,{side:"top",children:x?"Structured Output Active":"Set Structured Output (JSON Schema)"})]})}),f.jsx(oc,{className:"w-[450px] p-0",align:"start",children:f.jsx(xl,{tabs:v,defaultValue:"entry"})})]})},Wqe=({module:e})=>{const[,t]=E.useState({});return E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]),e.getIsVisible()?f.jsx(Vqe,{module:e}):null};class Hqe{constructor(){ue(this,"id","core-structured-output");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"structuredOutputJson",null);ue(this,"isVisible",!0);ue(this,"notifyComponentUpdate",null);ue(this,"getStructuredOutputJson",()=>this.structuredOutputJson);ue(this,"getIsVisible",()=>this.isVisible);ue(this,"setStructuredOutputJson",t=>{var n,r;this.structuredOutputJson=t,(n=this.modApiRef)==null||n.emit(sn.setStructuredOutputJsonRequest,{json:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var s;this.modApiRef=t,this.structuredOutputJson=Yl.getState().structuredOutputJson,this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this);const n=t.on(Wn.selectedModelChanged,()=>{var i;this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this)}),r=t.on(sn.parameterChanged,i=>{var a;if(typeof i=="object"&&i&&"params"in i){const o=i.params;"structuredOutputJson"in o&&this.structuredOutputJson!==(o.structuredOutputJson??null)&&(this.structuredOutputJson=o.structuredOutputJson??null,(a=this.notifyComponentUpdate)==null||a.call(this))}});this.eventUnsubscribers.push(n,r)}updateVisibility(){var i;const{getSelectedModel:t}=Qn.getState(),n=t(),r=(i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters,s=Array.isArray(r)&&r.includes("structured_output");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(Wqe,{module:this}),getParameters:()=>{if(this.structuredOutputJson)try{return{structured_output:JSON.parse(this.structuredOutputJson)}}catch(n){console.error("Invalid JSON in structured output state:",n);return}},clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(sn.setStructuredOutputJsonRequest,{json:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Gqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.contextLength,r=e.getEstimatedInputTokens(),s=e.getTotalEstimatedTokens(),i=e.getContextPercentage(),a=e.historyTokens,o=e.selectedModelId,l=E.useMemo(()=>i>85?"text-red-600 dark:text-red-500":i>70?"text-orange-500 dark:text-orange-400":i>40?"text-yellow-500 dark:text-yellow-400":"text-green-600 dark:text-green-500",[i]);if(!(o!==null&&n>0))return null;const u=`Context: ~${s.toLocaleString()} / ${n.toLocaleString()} tokens (${i}%) [History: ${a}, Input: ${r}]`;return f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx("div",{className:"flex items-center justify-center h-8 w-8 px-2",children:f.jsx(Qpe,{className:Ze("h-3 w-3 fill-current",l)})})}),f.jsx(Cr,{side:"top",children:u})]})})},Zse=4,Kqe=e=>{let t=0;return e.forEach(n=>{var r,s,i,a;(r=n.prompt)!=null&&r.content&&(t+=new TextEncoder().encode(n.prompt.content).length),(a=(i=(s=n.prompt)==null?void 0:s.metadata)==null?void 0:i.attachedFiles)==null||a.forEach(o=>{t+=o.size}),n.response&&typeof n.response=="string"&&(t+=new TextEncoder().encode(n.response).length)}),Math.ceil(t/Zse)};class Yqe{constructor(){ue(this,"id","core-usage-display");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"currentInputText","");ue(this,"historyTokens",0);ue(this,"attachedFiles",[]);ue(this,"selectedModelId",null);ue(this,"contextLength",0);ue(this,"notifyComponentUpdate",null);ue(this,"getEstimatedInputTokens",()=>{const t=new TextEncoder().encode(this.currentInputText).length,n=this.attachedFiles.reduce((r,s)=>r+s.size,0);return Math.ceil((t+n)/Zse)});ue(this,"getTotalEstimatedTokens",()=>this.historyTokens+this.getEstimatedInputTokens());ue(this,"getContextPercentage",()=>this.contextLength?Math.min(100,Math.round(this.getTotalEstimatedTokens()/this.contextLength*100)):0);ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.loadInitialState(),this.updateContextLength();const n=t.on(sn.inputChanged,o=>{var l;typeof o=="object"&&o&&"value"in o&&(this.currentInputText=o.value,(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(Ul.attachedFilesChanged,o=>{var l;typeof o=="object"&&o&&"files"in o&&(this.attachedFiles=o.files,(l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(Wn.selectedModelChanged,o=>{var l;typeof o=="object"&&o&&"modelId"in o&&(this.selectedModelId=o.modelId,this.updateContextLength(),(l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(En.completed,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)}),a=t.on(Tr.contextChanged,()=>{var o;this.updateHistoryTokens(),(o=this.notifyComponentUpdate)==null||o.call(this)});this.eventUnsubscribers.push(n,r,s,i,a),console.log(`[${this.id}] Initialized.`)}loadInitialState(){const t=Nh.getState(),n=Qn.getState();this.attachedFiles=t.attachedFilesMetadata,this.selectedModelId=n.selectedModelId,this.updateHistoryTokens()}updateHistoryTokens(){const t=un.getState();if(t.currentConversationId){const n=t.interactions.filter(r=>r.status==="COMPLETED");this.historyTokens=Kqe(n)}else this.historyTokens=0}updateContextLength(){var c;if(!this.selectedModelId){this.contextLength=0;return}const{dbProviderConfigs:t,dbApiKeys:n}=Qn.getState(),{providerId:r,modelId:s}=Ac(this.selectedModelId);if(!r||!s){this.contextLength=0;return}const i=t.find(u=>u.id===r);if(!i){this.contextLength=0;return}const a=n.find(u=>u.id===i.apiKeyId),o=zG(i,s,a==null?void 0:a.value),l=o==null?void 0:o.metadata;this.contextLength=((c=l==null?void 0:l.top_provider)==null?void 0:c.context_length)??(l==null?void 0:l.context_length)??0}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(Gqe,{module:this})}),console.log(`[${this.id}] Registered.`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}const Zqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getReasoningEnabled(),r=e.getIsStreaming(),s=e.getIsVisible(),i=n===!0,a=E.useCallback(()=>{const o=i?null:!0;e.setReasoningEnabled(o)},[i,e]);return s?f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{variant:i?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":i?"Disable Reasoning for Next Turn":"Enable Reasoning for Next Turn",children:f.jsx(Hy,{className:Ze("h-4 w-4",i?"text-primary":"text-muted-foreground")})})}),f.jsx(Cr,{side:"top",children:i?"Reasoning Enabled (Click to Disable)":"Reasoning Disabled (Click to Enable)"})]})}):null};class Xqe{constructor(){ue(this,"id","core-reasoning");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"reasoningEnabled",null);ue(this,"isStreaming",!1);ue(this,"isVisible",!0);ue(this,"notifyComponentUpdate",null);ue(this,"getReasoningEnabled",()=>this.reasoningEnabled);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"getIsVisible",()=>this.isVisible);ue(this,"setReasoningEnabled",t=>{var n,r;this.reasoningEnabled=t,(n=this.modApiRef)==null||n.emit(sn.setReasoningEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.reasoningEnabled=Yl.getState().reasoningEnabled,this.isStreaming=un.getState().status==="streaming",this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(En.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Wn.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(sn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"reasoningEnabled"in l&&this.reasoningEnabled!==l.reasoningEnabled&&(this.reasoningEnabled=l.reasoningEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s)}updateVisibility(){var s,i;const{getSelectedModel:t}=Qn.getState(),n=t(),r=((i=(s=n==null?void 0:n.metadata)==null?void 0:s.supported_parameters)==null?void 0:i.includes("reasoning"))??!1;this.isVisible!==r&&(this.isVisible=r)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(Zqe,{module:this}),getMetadata:()=>this.reasoningEnabled===!0?{reasoningEnabled:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(sn.setReasoningEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Jqe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getWebSearchEnabled(),r=e.getIsStreaming(),s=e.getIsVisible(),i=n===!0,a=E.useCallback(()=>{const o=i?null:!0;e.setWebSearchEnabled(o)},[i,e]);return s?f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{variant:i?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:a,disabled:r,"aria-label":i?"Disable Web Search for Next Turn":"Enable Web Search for Next Turn",children:f.jsx(uo,{className:Ze("h-4 w-4",i?"text-primary":"text-muted-foreground")})})}),f.jsx(Cr,{side:"top",children:i?"Web Search Enabled (Click to Disable)":"Web Search Disabled (Click to Enable)"})]})}):null};class Qqe{constructor(){ue(this,"id","core-web-search");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"webSearchEnabled",null);ue(this,"isStreaming",!1);ue(this,"isVisible",!0);ue(this,"notifyComponentUpdate",null);ue(this,"getWebSearchEnabled",()=>this.webSearchEnabled);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"getIsVisible",()=>this.isVisible);ue(this,"setWebSearchEnabled",t=>{var n,r;this.webSearchEnabled=t,(n=this.modApiRef)==null||n.emit(sn.setWebSearchEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var i;this.modApiRef=t,this.webSearchEnabled=Yl.getState().webSearchEnabled,this.isStreaming=un.getState().status==="streaming",this.updateVisibility(),(i=this.notifyComponentUpdate)==null||i.call(this);const n=t.on(En.statusChanged,a=>{var o;typeof a=="object"&&a&&"status"in a&&this.isStreaming!==(a.status==="streaming")&&(this.isStreaming=a.status==="streaming",(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(Wn.selectedModelChanged,()=>{var a;this.updateVisibility(),(a=this.notifyComponentUpdate)==null||a.call(this)}),s=t.on(sn.parameterChanged,a=>{var o;if(typeof a=="object"&&a&&"params"in a){const l=a.params;"webSearchEnabled"in l&&this.webSearchEnabled!==l.webSearchEnabled&&(this.webSearchEnabled=l.webSearchEnabled??null,(o=this.notifyComponentUpdate)==null||o.call(this))}});this.eventUnsubscribers.push(n,r,s)}updateVisibility(){var i;const{getSelectedModel:t}=Qn.getState(),n=t(),r=((i=n==null?void 0:n.metadata)==null?void 0:i.supported_parameters)??[],s=r.includes("web_search")||r.includes("web_search_options");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(Jqe,{module:this}),getParameters:()=>this.webSearchEnabled===!0?{web_search:!0}:void 0,clearOnSubmit:()=>{var n;(n=this.modApiRef)==null||n.emit(sn.setWebSearchEnabledRequest,{enabled:null})}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const Xse=({activeTagIds:e,activeRuleIds:t,onToggleTag:n,onToggleRule:r,allRules:s,allTags:i,getRulesForTag:a})=>{const[o,l]=E.useState(""),[c,u]=E.useState(""),d=E.useMemo(()=>{const S=o.toLowerCase();return S?i.filter(k=>{var C;return k.name.toLowerCase().includes(S)||((C=k.description)==null?void 0:C.toLowerCase().includes(S))}):i},[i,o]),h=E.useMemo(()=>{const S=c.toLowerCase();return S?s.filter(k=>k.name.toLowerCase().includes(S)||k.content.toLowerCase().includes(S)||k.type.toLowerCase().includes(S)):s},[s,c]),m=E.useCallback((S,k)=>{n(S,k)},[n]),y=E.useCallback((S,k)=>{r(S,k)},[r]),b=()=>{Re.emit(Tr.openModalRequest,{modalId:"settingsModal",initialTab:"rules-tags"})},v=()=>f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(uo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(xn,{type:"search",placeholder:"Filter tags...",value:o,onChange:S=>l(S.target.value),className:"pl-8 h-9"})]}),f.jsxs(ct,{variant:"outline",size:"sm",onClick:b,className:"h-9 px-3",title:"Open Rules Settings",children:[f.jsx(Rh,{className:"h-4 w-4 mr-1"}),"Manage"]})]}),f.jsx("div",{className:"border rounded-md p-2 bg-background/50",children:d.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:i.length===0?"No tags defined.":"No tags match filter."}):f.jsx("div",{className:"space-y-1",children:d.map(S=>{const k=a(S.id);return f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(zc,{id:`tag-activate-${S.id}`,checked:e.has(S.id),onCheckedChange:C=>m(S.id,!!C),className:"mt-0.5"}),f.jsxs(jt,{htmlFor:`tag-activate-${S.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:S.name}),S.description&&f.jsx("span",{className:"block text-xs text-muted-foreground",children:S.description}),k.length>0&&f.jsxs("span",{className:"block text-xs text-blue-500 dark:text-blue-400",children:["Includes: ",k.map(C=>C.name).join(", ")]})]})]})},S.id)})})})]}),w=[{value:"rules",label:"Activate Rules",content:f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(uo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(xn,{type:"search",placeholder:"Filter rules...",value:c,onChange:S=>u(S.target.value),className:"pl-8 h-9"})]}),f.jsxs(ct,{variant:"outline",size:"sm",onClick:b,className:"h-9 px-3",title:"Open Rules Settings",children:[f.jsx(Rh,{className:"h-4 w-4 mr-1"}),"Manage"]})]}),f.jsx("div",{className:"border rounded-md p-2 bg-background/50",children:h.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:s.length===0?"No rules defined.":"No rules match filter."}):f.jsx("div",{className:"space-y-1",children:h.map(S=>f.jsx("div",{className:"flex items-start justify-between p-1.5 rounded hover:bg-muted",children:f.jsxs("div",{className:"flex items-center space-x-2 flex-grow mr-2",children:[f.jsx(zc,{id:`rule-activate-${S.id}`,checked:t.has(S.id),onCheckedChange:k=>y(S.id,!!k),className:"mt-0.5"}),f.jsxs(jt,{htmlFor:`rule-activate-${S.id}`,className:"text-sm font-normal cursor-pointer space-y-0.5",children:[f.jsx("span",{className:"block font-medium",children:S.name}),f.jsxs("span",{className:"block text-xs text-muted-foreground",children:["Type: ",S.type]}),f.jsxs("span",{className:"block text-xs text-muted-foreground truncate max-w-xs",children:["Content: ",S.content]})]})]})},S.id))})})]})},{value:"tags",label:"Activate Tags",content:v()}];return f.jsx("div",{className:"p-0 max-w-lg",children:f.jsx(xl,{tabs:w,defaultValue:"rules",scrollable:!1})})},eVe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const[n,r]=E.useState(!1),s=e.getActiveTagIds(),i=e.getActiveRuleIds(),a=e.getIsStreaming(),o=e.getHasRulesOrTags(),l=e.getAllRules(),c=e.getAllTags(),u=e.getRulesForTag,d=E.useCallback((v,x)=>{e.setActiveTagIds(w=>{const S=new Set(w);return x?S.add(v):S.delete(v),S})},[e]),h=E.useCallback((v,x)=>{e.setActiveRuleIds(w=>{const S=new Set(w);return x?S.add(v):S.delete(v),S})},[e]),m=()=>{o?r(v=>!v):e.handleTriggerClick()&&r(!1)},y=s.size>0||i.size>0,b=a;return f.jsxs(ic,{open:n,onOpenChange:r,children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:o?f.jsx(ac,{asChild:!0,children:f.jsx(ct,{variant:y?"secondary":"ghost",size:"icon",className:"h-8 w-8",disabled:b,"aria-label":"Configure Rules & Tags for Next Turn",onClick:m,children:f.jsx(IB,{className:"h-4 w-4"})})}):f.jsx(ct,{variant:"ghost",size:"icon",className:"h-8 w-8",disabled:b,"aria-label":"Add Rules & Tags (Opens Settings)",onClick:m,children:f.jsx(IB,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"top",children:o?y?`Rules/Tags Active (${s.size} tags, ${i.size} rules)`:"Activate Rules/Tags (Next Turn)":"Add Rules/Tags (Opens Settings)"})]})}),o&&f.jsx(oc,{className:"w-auto p-0",align:"start",children:f.jsx(Xse,{activeTagIds:s,activeRuleIds:i,onToggleTag:d,onToggleRule:h,allRules:l,allTags:c,getRulesForTag:u})})]})};function tVe({form:e,name:t,label:n,description:r,placeholder:s,disabled:i,wrapperClassName:a,className:o,rows:l,...c}){return f.jsx(e.Field,{name:t,children:u=>{const d=typeof u.state.value=="string"||typeof u.state.value=="number"?String(u.state.value):"";return f.jsxs("div",{className:Ze("space-y-1.5",a),children:[f.jsx(jt,{htmlFor:u.name,className:"text-sm",children:n}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsx(qa,{id:u.name,name:u.name,value:d,onBlur:u.handleBlur,onChange:h=>u.handleChange(h.target.value),placeholder:s,disabled:i??u.form.state.isSubmitting,rows:l,className:Ze(o,u.state.meta.errors.length?"border-destructive":""),...c}),f.jsx(ji,{field:u})]})}})}const nVe=Ke({name:$e().min(1,"Rule Name is required."),content:$e().min(1,"Rule Content is required."),type:vl(["system","before","after"],{errorMap:()=>({message:"Rule Type is required."})})}),rVe=[{value:"system",label:"System Prompt"},{value:"before",label:"Before User Prompt"},{value:"after",label:"After User Prompt"}],sVe=({initialData:e,isSavingExt:t,onSave:n,onCancel:r})=>{const s=ii({defaultValues:{name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"},validators:{onChangeAsync:nVe,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{await n({name:i.name.trim(),content:i.content.trim(),type:i.type})}});return E.useEffect(()=>{s.reset({name:(e==null?void 0:e.name)||"",content:(e==null?void 0:e.content)||"",type:(e==null?void 0:e.type)||"before"})},[e,s]),f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Rule":"Add New Rule"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[f.jsx(Zw,{form:s,name:"name",label:"Rule Name",placeholder:"e.g., Always respond in JSON",required:!0,disabled:t,wrapperClassName:"md:col-span-2"}),f.jsx(Lx,{form:s,name:"type",label:"Rule Type",options:rVe,placeholder:"Select Type",disabled:t})]}),f.jsx(tVe,{form:s,name:"content",label:"Rule Content",placeholder:"Enter the rule text to be injected...",required:!0,rows:4,disabled:t,className:"font-mono text-xs"}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(ct,{variant:"ghost",size:"sm",onClick:r,disabled:t,type:"button",children:[f.jsx(Pi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsxs(ct,{variant:"secondary",size:"sm",type:"submit",disabled:t||!i||a||!l||o,children:[(t||a||o)&&f.jsx(Jn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Uu,{className:"h-4 w-4 mr-1"})," ",t||a||o?"Saving...":"Save Rule"]})})]})]})},iVe=({rules:e,isLoading:t,isDeleting:n,onEdit:r,onDelete:s})=>{const i=a=>{window.confirm(`Are you sure you want to delete the rule "${a.name}"? This will also remove it from any tags.`)&&s(a.id,a.name)};return f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(yf,{children:[f.jsx(gp,{children:f.jsxs(Ts,{children:[f.jsx(Rr,{children:"Name"}),f.jsx(Rr,{children:"Type"}),f.jsx(Rr,{children:"Content Preview"}),f.jsx(Rr,{className:"text-right",children:"Actions"})]})}),f.jsx(bf,{children:t?f.jsxs(f.Fragment,{children:[f.jsx(Ts,{children:f.jsx(Ln,{colSpan:4,children:f.jsx(Gr,{className:"h-10 w-full"})})}),f.jsx(Ts,{children:f.jsx(Ln,{colSpan:4,children:f.jsx(Gr,{className:"h-10 w-full"})})})]}):e.length===0?f.jsx(Ts,{children:f.jsx(Ln,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No rules defined yet."})}):e.map(a=>{const o=n[a.id];return f.jsxs(Ts,{children:[f.jsx(Ln,{className:"font-medium",children:a.name}),f.jsx(Ln,{className:"capitalize",children:a.type}),f.jsx(Ln,{className:"text-xs text-muted-foreground truncate max-w-xs",children:a.content}),f.jsxs(Ln,{className:"text-right space-x-1",children:[f.jsx(qn,{tooltipText:"Edit Rule",onClick:()=>r(a),disabled:o,icon:f.jsx(y1,{}),className:"h-8 w-8","aria-label":`Edit rule ${a.name}`}),f.jsx(qn,{tooltipText:"Delete Rule",onClick:()=>i(a),disabled:o,icon:o?f.jsx(Jn,{className:"h-4 w-4 animate-spin"}):f.jsx(Po,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete rule ${a.name}`})]})]},a.id)})})]})})},aVe=({module:e})=>{const[,t]=E.useState(Date.now()),n=e.getAllRules(),r=e.getIsLoadingRules(),[s,i]=E.useState(!1),[a,o]=E.useState(null),[l,c]=E.useState(!1),[u,d]=E.useState({});E.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const h=()=>{o(null),i(!0)},m=x=>{o(x),i(!0)},y=E.useCallback(()=>{i(!1),o(null),c(!1)},[]),b=E.useCallback(async x=>{c(!0);try{a?e.updateRule(a.id,x):e.addRule(x),y()}catch{}finally{c(!1)}},[e,a,y]),v=E.useCallback(async x=>{d(w=>({...w,[x]:!0}));try{e.deleteRule(x),(a==null?void 0:a.id)===x&&y()}catch{}finally{d(w=>({...w,[x]:!1}))}},[e,a,y]);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Rules"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Create reusable text snippets (rules) that can be automatically injected into prompts based on assigned tags. Rules can modify the system prompt, or be added before/after the user's input."})]}),!s&&f.jsxs(ct,{onClick:h,variant:"outline",className:"w-full",disabled:r,children:[f.jsx(Pc,{className:"h-4 w-4 mr-1"})," Add New Rule"]}),s&&f.jsx(sVe,{initialData:a??void 0,isSavingExt:l,onSave:b,onCancel:y}),f.jsxs("div",{className:"pt-4",children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Rules"}),f.jsx(iVe,{rules:n,isLoading:r,isDeleting:u,onEdit:m,onDelete:v})]})]})},v3=Ke({name:$e().min(1,"Tag Name is required."),description:$e().nullable()}),oVe=({initialData:e,isParentSaving:t=!1,onSave:n,onCancel:r})=>{const s=ii({defaultValues:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null},validators:{onChangeAsync:v3,onChangeAsyncDebounceMs:500},onSubmit:async({value:i})=>{var a;await n({name:i.name.trim(),description:((a=i.description)==null?void 0:a.trim())||null})}});return E.useEffect(()=>{s.reset({name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||null})},[e,s]),f.jsxs("form",{onSubmit:i=>{i.preventDefault(),i.stopPropagation(),s.handleSubmit()},className:"space-y-4 border rounded-md p-4 bg-card shadow-md",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:e!=null&&e.id?"Edit Tag":"Add New Tag"}),f.jsx(s.Field,{name:"name",validators:{onChange:v3.shape.name},children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:i.name,children:"Tag Name"}),f.jsx(xn,{id:i.name,value:i.state.value??"",onChange:a=>i.handleChange(a.target.value),onBlur:i.handleBlur,placeholder:"e.g., Code Generation, Summarization",disabled:s.state.isSubmitting||t}),f.jsx(ji,{field:i})]})}),f.jsx(s.Field,{name:"description",validators:{onChange:v3.shape.description},children:i=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:i.name,children:"Description (Optional)"}),f.jsx(qa,{id:i.name,value:i.state.value??"",onChange:a=>i.handleChange(a.target.value),onBlur:i.handleBlur,placeholder:"Describe when to use this tag...",rows:2,disabled:s.state.isSubmitting||t}),f.jsx(ji,{field:i})]})}),f.jsxs("div",{className:"flex justify-end space-x-2 pt-2",children:[f.jsxs(ct,{variant:"ghost",size:"sm",onClick:r,disabled:s.state.isSubmitting||t,type:"button",children:[f.jsx(Pi,{className:"h-4 w-4 mr-1"})," Cancel"]}),f.jsx(s.Subscribe,{selector:i=>[i.canSubmit,i.isSubmitting,i.isValidating,i.isValid],children:([i,a,o,l])=>f.jsxs(ct,{variant:"secondary",size:"sm",type:"submit",disabled:t||!i||a||o||!l,children:[(a||o)&&f.jsx(Jn,{className:"h-4 w-4 mr-1 animate-spin"}),f.jsx(Uu,{className:"h-4 w-4 mr-1"})," ",a||o?"Saving...":"Save Tag"]})})]})]})},lVe=({tags:e,rulesByTagId:t,isLoading:n,isDeleting:r,onEdit:s,onDelete:i})=>{const a=o=>{window.confirm(`Are you sure you want to delete the tag "${o.name}"? This will remove it from all rules.`)&&i(o.id,o.name)};return f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(yf,{children:[f.jsx(gp,{children:f.jsxs(Ts,{children:[f.jsx(Rr,{children:"Name"}),f.jsx(Rr,{children:"Description"}),f.jsx(Rr,{children:"Linked Rules"}),f.jsx(Rr,{className:"text-right",children:"Actions"})]})}),f.jsx(bf,{children:n?f.jsxs(f.Fragment,{children:[f.jsx(Ts,{children:f.jsx(Ln,{colSpan:4,children:f.jsx(Gr,{className:"h-10 w-full"})})}),f.jsx(Ts,{children:f.jsx(Ln,{colSpan:4,children:f.jsx(Gr,{className:"h-10 w-full"})})})]}):e.length===0?f.jsx(Ts,{children:f.jsx(Ln,{colSpan:4,className:"h-24 text-center text-muted-foreground",children:"No tags defined yet."})}):e.map(o=>{const l=r[o.id],c=t.get(o.id)||[];return f.jsxs(Ts,{children:[f.jsx(Ln,{className:"font-medium",children:o.name}),f.jsx(Ln,{className:"text-xs text-muted-foreground truncate max-w-xs",children:o.description||"-"}),f.jsx(Ln,{className:"text-xs",children:c.length>0?c.map(u=>u.name).join(", "):"None"}),f.jsxs(Ln,{className:"text-right space-x-1",children:[f.jsx(qn,{tooltipText:"Edit Tag & Rules",onClick:()=>s(o),disabled:l,icon:f.jsx(y1,{}),className:"h-8 w-8","aria-label":`Edit tag ${o.name}`}),f.jsx(qn,{tooltipText:"Delete Tag",onClick:()=>a(o),disabled:l,icon:l?f.jsx(Jn,{className:"h-4 w-4 animate-spin"}):f.jsx(Po,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":`Delete tag ${o.name}`})]})]},o.id)})})]})})},cVe=({tag:e,allRules:t,linkedRuleIds:n,onLinkChange:r,disabled:s=!1})=>{const[i,a]=E.useState(!1),[o,l]=E.useState(""),c=E.useMemo(()=>[...t].sort((y,b)=>y.name.localeCompare(b.name)),[t]),u=E.useMemo(()=>{const y=o.toLowerCase();return y?c.filter(b=>b.name.toLowerCase().includes(y)||b.content.toLowerCase().includes(y)||b.type.toLowerCase().includes(y)):c},[c,o]),d=E.useCallback(y=>{const b=n.has(y);r(e.id,y,!b),l("")},[n,r,e.id]),h=E.useCallback((y,b)=>{b.stopPropagation(),r(e.id,y,!1)},[r,e.id]),m=E.useMemo(()=>c.filter(y=>n.has(y.id)),[c,n]);return f.jsxs("div",{className:"space-y-3",children:[f.jsxs(jt,{className:"font-medium",children:['Associated Rules for "',e.name,'"']}),f.jsxs(ic,{open:i,onOpenChange:a,children:[f.jsx(ac,{asChild:!0,children:f.jsxs(ct,{variant:"outline",role:"combobox","aria-expanded":i,className:"w-full justify-between h-9",disabled:s||t.length===0,children:[f.jsx("span",{className:"truncate",children:m.length>0?`${m.length} rule(s) selected`:"Select rules..."}),f.jsx(vE,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),f.jsx(oc,{className:"w-[--radix-popover-trigger-width] p-0",children:f.jsxs(Vse,{shouldFilter:!1,children:[f.jsx(Wse,{placeholder:"Search rules...",value:o,onValueChange:l}),f.jsxs(Hse,{children:[f.jsx(Gse,{children:t.length===0?"No rules defined.":"No rules found."}),f.jsx(Kse,{children:u.map(y=>{const b=n.has(y.id);return f.jsxs(Yse,{value:y.id,onSelect:()=>d(y.id),className:"cursor-pointer",children:[f.jsx(co,{className:Ze("mr-2 h-4 w-4",b?"opacity-100":"opacity-0")}),f.jsx("span",{className:"truncate",children:y.name}),f.jsxs("span",{className:"ml-2 text-xs text-muted-foreground",children:["(",y.type,")"]})]},y.id)})})]})]})})]}),m.length>0&&f.jsx("div",{className:"flex flex-wrap gap-1 pt-2",children:m.map(y=>f.jsxs(as,{variant:"secondary",className:"flex items-center gap-1",children:[f.jsx("span",{className:"truncate",children:y.name}),f.jsx(ct,{variant:"ghost",size:"icon",className:"h-4 w-4 p-0 text-muted-foreground hover:text-destructive hover:bg-transparent",onClick:b=>h(y.id,b),disabled:s,"aria-label":`Unlink rule ${y.name}`,children:f.jsx(Pi,{className:"h-3 w-3"})})]},y.id))})]})},uVe=({module:e})=>{const[,t]=E.useState(Date.now()),n=e.getAllTags(),r=e.getAllRules(),s=e.getTagRuleLinks(),i=e.getRulesForTag,a=e.getIsLoadingRules(),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState(!1),[m,y]=E.useState({});E.useEffect(()=>(e.setNotifySettingsCallback(()=>t(Date.now())),()=>{e.setNotifySettingsCallback(null)}),[e]);const b=()=>{u(null),l(!0)},v=A=>{u(A),l(!0)},x=E.useCallback(()=>{l(!1),u(null),h(!1)},[]),w=E.useCallback(async A=>{h(!0);try{c?e.updateTag(c.id,A):e.addTag(A),c||x()}catch{}finally{h(!1)}},[e,c,x]),S=E.useCallback(async A=>{y(N=>({...N,[A]:!0}));try{e.deleteTag(A),(c==null?void 0:c.id)===A&&x()}catch{}finally{y(N=>({...N,[A]:!1}))}},[e,c,x]),k=E.useCallback(async(A,N,I)=>{try{I?e.linkTagToRule(A,N):e.unlinkTagFromRule(A,N)}catch{}},[e]),C=E.useMemo(()=>{const A=new Map;return n.forEach(N=>{A.set(N.id,i(N.id))}),A},[n,i]),T=E.useMemo(()=>c?new Set(s.filter(A=>A.tagId===c.id).map(A=>A.ruleId)):new Set,[c,s]);return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Manage Tags"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Create tags to group related rules. You can activate tags before sending a prompt to apply their associated rules."})]}),!o&&f.jsxs(ct,{onClick:b,variant:"outline",className:"w-full",disabled:a,children:[f.jsx(Pc,{className:"h-4 w-4 mr-1"})," Add New Tag"]}),o&&f.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[f.jsx(oVe,{initialData:c??void 0,isParentSaving:d,onSave:w,onCancel:x}),c&&f.jsx(cVe,{tag:c,allRules:r,linkedRuleIds:T,onLinkChange:k,disabled:d})]}),f.jsx(Fm,{}),f.jsxs("div",{className:"pt-4",children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Existing Tags"}),f.jsx(lVe,{tags:n,rulesByTagId:C,isLoading:a,isDeleting:m,onEdit:v,onDelete:S})]})]})},dVe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifySettingsCallback(()=>t({})),()=>e.setNotifySettingsCallback(null)),[e]);const n=E.useMemo(()=>[{value:"rules",label:"Rules",content:f.jsx(aVe,{module:e})},{value:"tags",label:"Tags",content:f.jsx(uVe,{module:e})}],[e]);return f.jsx(xl,{tabs:n,defaultValue:"rules",className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})};class fVe{constructor(){ue(this,"id","core-rules-tags");ue(this,"unregisterPromptControlCallback",null);ue(this,"unregisterSettingsTabCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"allRules",[]);ue(this,"allTags",[]);ue(this,"tagRuleLinks",[]);ue(this,"transientActiveTagIds",new Set);ue(this,"transientActiveRuleIds",new Set);ue(this,"isStreaming",!1);ue(this,"hasRulesOrTags",!1);ue(this,"isLoadingRules",!0);ue(this,"notifyComponentUpdate",null);ue(this,"notifySettingsComponentUpdate",null);ue(this,"getAllRules",()=>this.allRules);ue(this,"getAllTags",()=>this.allTags);ue(this,"getTagRuleLinks",()=>this.tagRuleLinks);ue(this,"getRulesForTag",t=>{const n=new Set(this.tagRuleLinks.filter(r=>r.tagId===t).map(r=>r.ruleId));return this.allRules.filter(r=>n.has(r.id))});ue(this,"getRuleById",t=>this.allRules.find(n=>n.id===t));ue(this,"getTagById",t=>this.allTags.find(n=>n.id===t));ue(this,"getRulesByIds",t=>{const n=new Set(t);return this.allRules.filter(r=>n.has(r.id))});ue(this,"addRule",t=>{var n;(n=this.modApiRef)==null||n.emit(vr.addRuleRequest,t)});ue(this,"updateRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(vr.updateRuleRequest,{id:t,updates:n})});ue(this,"deleteRule",t=>{var n;(n=this.modApiRef)==null||n.emit(vr.deleteRuleRequest,{id:t})});ue(this,"addTag",t=>{var n;(n=this.modApiRef)==null||n.emit(vr.addTagRequest,t)});ue(this,"updateTag",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(vr.updateTagRequest,{id:t,updates:n})});ue(this,"deleteTag",t=>{var n;(n=this.modApiRef)==null||n.emit(vr.deleteTagRequest,{id:t})});ue(this,"linkTagToRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(vr.linkTagToRuleRequest,{tagId:t,ruleId:n})});ue(this,"unlinkTagFromRule",(t,n)=>{var r;(r=this.modApiRef)==null||r.emit(vr.unlinkTagFromRuleRequest,{tagId:t,ruleId:n})});ue(this,"handleTriggerClick",()=>!this.hasRulesOrTags&&this.modApiRef?(this.modApiRef.emit(Tr.openModalRequest,{modalId:"settingsModal",initialTab:"rules-tags"}),!0):!1);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"getHasRulesOrTags",()=>this.hasRulesOrTags);ue(this,"getIsLoadingRules",()=>this.isLoadingRules);ue(this,"getActiveTagIds",()=>this.transientActiveTagIds);ue(this,"getActiveRuleIds",()=>this.transientActiveRuleIds);ue(this,"setActiveTagIds",t=>{var n;this.transientActiveTagIds=t(this.transientActiveTagIds),(n=this.notifyComponentUpdate)==null||n.call(this)});ue(this,"setActiveRuleIds",t=>{var n;this.transientActiveRuleIds=t(this.transientActiveRuleIds),(n=this.notifyComponentUpdate)==null||n.call(this)});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});ue(this,"setNotifySettingsCallback",t=>{this.notifySettingsComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isStreaming=t.getContextSnapshot().isStreaming,t.emit(vr.loadRulesAndTagsRequest,void 0);const n=t.on(En.statusChanged,s=>{var i;typeof s=="object"&&s&&"status"in s&&this.isStreaming!==(s.status==="streaming")&&(this.isStreaming=s.status==="streaming",(i=this.notifyComponentUpdate)==null||i.call(this))}),r=t.on(vr.dataLoaded,s=>{var i,a;s&&(this.allRules=s.rules||[],this.allTags=s.tags||[],this.tagRuleLinks=(s.links||[]).map(o=>({tagId:o.tagId,ruleId:o.ruleId}))),this.updateHasRulesOrTags(),this.isLoadingRules=!1,(i=this.notifyComponentUpdate)==null||i.call(this),(a=this.notifySettingsComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(n,r)}updateHasRulesOrTags(){const t=this.allRules.length>0||this.allTags.length>0;this.hasRulesOrTags!==t&&(this.hasRulesOrTags=t)}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,status:()=>this.isLoadingRules?"loading":"ready",triggerRenderer:()=>Ve.createElement(eVe,{module:this}),getMetadata:()=>{const n=Array.from(this.transientActiveTagIds),r=Array.from(this.transientActiveRuleIds),s=[],i=new Set(r);if(n.forEach(a=>{this.getRulesForTag(a).forEach(o=>i.add(o.id))}),i.forEach(a=>{const o=this.getRuleById(a);o&&s.push({type:o.type,content:o.content,sourceRuleId:o.id})}),n.length>0||r.length>0||s.length>0)return{activeTagIds:n,activeRuleIds:r,effectiveRulesContent:s}},clearOnSubmit:()=>{var r;let n=!1;this.transientActiveTagIds.size>0&&(this.transientActiveTagIds=new Set,n=!0),this.transientActiveRuleIds.size>0&&(this.transientActiveRuleIds=new Set,n=!0),n&&((r=this.notifyComponentUpdate)==null||r.call(this))}})),this.unregisterSettingsTabCallback||(this.unregisterSettingsTabCallback=t.registerSettingsTab({id:"rules-tags",title:"Rules & Tags",component:()=>Ve.createElement(dVe,{module:this}),order:50}))}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.unregisterSettingsTabCallback&&(this.unregisterSettingsTabCallback(),this.unregisterSettingsTabCallback=null),this.notifyComponentUpdate=null,this.notifySettingsComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const hVe=({module:e})=>{const[,t]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>t({})),()=>e.setNotifyCallback(null)),[e]);const n=e.getTurnEnabled(),r=e.getIsStreaming(),s=e.getGlobalAutoTitleEnabled()&&e.getIsFirstInteraction(),i=E.useCallback(()=>{const a=!n;e.setTurnEnabled(a)},[n,e]);return s?f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{variant:n?"secondary":"ghost",size:"icon",className:"h-8 w-8",onClick:i,disabled:r,"aria-label":n?"Disable Auto-Title for this Chat":"Enable Auto-Title for this Chat",children:f.jsx(Dpe,{className:Ze("h-4 w-4",n?"text-primary":"text-muted-foreground")})})}),f.jsx(Cr,{side:"top",children:n?"Auto-Title Enabled (Click to Disable)":"Auto-Title Disabled (Click to Enable)"})]})}):null};class pVe{constructor(){ue(this,"id","core-auto-title");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"turnAutoTitleEnabled",!1);ue(this,"isStreaming",!1);ue(this,"isFirstInteraction",!1);ue(this,"globalAutoTitleEnabled",!0);ue(this,"notifyComponentUpdate",null);ue(this,"getTurnEnabled",()=>this.turnAutoTitleEnabled);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"getIsFirstInteraction",()=>this.isFirstInteraction);ue(this,"getGlobalAutoTitleEnabled",()=>this.globalAutoTitleEnabled);ue(this,"setTurnEnabled",t=>{var n;this.turnAutoTitleEnabled!==t&&(this.turnAutoTitleEnabled=t,(n=this.notifyComponentUpdate)==null||n.call(this))});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){var a;this.turnAutoTitleEnabled=!1,this.isStreaming=un.getState().status==="streaming",this.globalAutoTitleEnabled=pr.getState().autoTitleEnabled,this.checkFirstInteraction(),(a=this.notifyComponentUpdate)==null||a.call(this);const n=t.on(En.statusChanged,o=>{var l;typeof o=="object"&&o&&"status"in o&&this.isStreaming!==(o.status==="streaming")&&(this.isStreaming=o.status==="streaming",(l=this.notifyComponentUpdate)==null||l.call(this))}),r=t.on(Tr.contextChanged,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),s=t.on(En.completed,()=>{var l;const o=this.isFirstInteraction;this.checkFirstInteraction(),o!==this.isFirstInteraction&&((l=this.notifyComponentUpdate)==null||l.call(this))}),i=t.on(an.autoTitleEnabledChanged,o=>{var l;typeof o=="object"&&o&&"enabled"in o&&this.globalAutoTitleEnabled!==o.enabled&&(this.globalAutoTitleEnabled=o.enabled,(l=this.notifyComponentUpdate)==null||l.call(this))});this.eventUnsubscribers.push(n,r,s,i)}checkFirstInteraction(){const t=un.getState(),n=t.currentConversationId===null||t.interactions.filter(r=>r.conversationId===t.currentConversationId).length===0;this.isFirstInteraction!==n&&(this.isFirstInteraction=n,!n&&this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1))}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n=()=>Ve.createElement(hVe,{module:this});this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:n,getMetadata:()=>this.turnAutoTitleEnabled?{autoTitleEnabledForTurn:!0}:void 0,clearOnSubmit:()=>{var r;this.turnAutoTitleEnabled&&(this.turnAutoTitleEnabled=!1,(r=this.notifyComponentUpdate)==null||r.call(this))}})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,console.log(`[${this.id}] Destroyed.`)}}function mVe(){const e=new URLSearchParams(window.location.search),t=e.get("q")??void 0,n=e.get("m")??void 0,r=e.getAll("vfs").filter(Boolean),s=e.get("s")??"1";return{query:t,modelId:n,vfsFiles:r.length>0?r:void 0,submit:s}}class gVe{constructor(){ue(this,"id","core-url-parameters");ue(this,"modApiRef",null)}async initialize(t){this.modApiRef=t,console.log(`[${this.id}] Initializing...`),t.on(pp.initializationPhaseCompleted,n=>{n.phase==="all"&&this.processUrlParameters().catch(r=>{console.error(`[${this.id}] Error processing URL parameters:`,r),Te.error("Failed to process URL parameters.")})}),console.log(`[${this.id}] Initialized, awaiting full app load.`)}register(t){}destroy(){this.modApiRef=null}async processUrlParameters(){var r,s;if(!this.modApiRef){console.warn(`[${this.id}] ModAPI not available, cannot process URL parameters.`);return}const t=this.modApiRef,n=mVe();if(!(!n.query&&!n.modelId&&!((r=n.vfsFiles)!=null&&r.length))){Te.info("Processing parameters from URL...");try{const i=await new Promise((a,o)=>{const l=t.on(er.conversationAdded,c=>{c.conversation.title.startsWith("From URL:")&&(l(),a(c.conversation.id))});setTimeout(()=>{l(),o(new Error("Timeout waiting for conversation creation event."))},5e3),t.emit(er.addConversationRequest,{title:n.query?`From URL: ${n.query.substring(0,30)}...`:"From URL Parameters"})});if(t.emit(er.selectItemRequest,{id:i,type:"conversation"}),n.modelId){const a=Qn.getState().getAvailableModelListItems();let o=null;const l=n.modelId.toLowerCase();if(n.modelId.includes(":")){const c=a.find(u=>u.id===n.modelId);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase()===l);c&&(o=c.id)}if(!o){const c=a.find(u=>u.name.toLowerCase().startsWith(l));c&&(o=c.id)}if(!o){const c=a.find(u=>{const d=u.id.toLowerCase().split("/");return d.length>1&&d[1].startsWith(l)});c&&(o=c.id)}if(o){t.emit(sn.setModelIdRequest,{id:o}),t.emit(Wn.selectModelRequest,{modelId:o});const c=a.find(u=>u.id===o);Te.success(`Model set to: ${c==null?void 0:c.name} (${c==null?void 0:c.providerName})`)}else Te.warning(`Model matching "${n.modelId}" not found or not enabled. Using default.`)}if(n.vfsFiles&&n.vfsFiles.length>0){const a="orphan";let o;try{if(o=await t.getVfsInstance(a),!o)throw new Error("Failed to get VFS instance via ModAPI.")}catch(l){Te.error(`Failed to initialize VFS for URL files: ${l instanceof Error?l.message:String(l)}`)}if(o)for(const l of n.vfsFiles)try{const c=await lp(l,{fsInstance:o}),u=await o.promises.stat(l),d=vi(l),h="application/octet-stream",m=tw(d,h);let y={};if(m)y.contentText=new TextDecoder().decode(c);else{let b="";const v=c.byteLength;for(let x=0;x<v;x++)b+=String.fromCharCode(c[x]);y.contentBase64=window.btoa(b)}t.emit(Ul.addAttachedFileRequest,{source:"vfs",name:d,type:h,size:u.size,path:l,...y}),Te.success(`Attached VFS file: ${d}`)}catch(c){c.code==="ENOENT"?Te.warning(`VFS file not found: ${l}`):Te.warning(`Failed to attach VFS file "${l}": ${c.message}`),console.error(`Error processing VFS file ${l}:`,c)}}if(n.query)if(n.submit==="0")t.emit(sn.inputChanged,{value:n.query}),Te.info("Query from URL loaded into input area."),window.history.replaceState({},document.title,window.location.pathname);else{let a={},o={};const l=Nh.getState().attachedFilesMetadata;l.length>0&&(o.attachedFiles=[...l]);let c={id:qr(),content:n.query,parameters:a,metadata:o};t.emit(sn.submitted,{turnData:c});const u=await U2(cy.PROMPT_TURN_FINALIZE,{turnData:c});if(u===!1){Te.warning("Prompt submission from URL cancelled by middleware.");return}const d=u&&typeof u=="object"?u.turnData:c;await gh.submitPrompt(d),window.history.replaceState({},document.title,window.location.pathname)}else(n.modelId||(s=n.vfsFiles)!=null&&s.length)&&(Te.info("Model and/or VFS files from URL applied. Type your message."),window.history.replaceState({},document.title,window.location.pathname))}catch(i){Te.error(`Failed to process URL parameters: ${i instanceof Error?i.message:String(i)}`),console.error("Error processing URL parameters:",i)}}}}const yVe=({module:e})=>{const[t,n]=E.useState(!1),[,r]=E.useState({});E.useEffect(()=>(e.setNotifyCallback(()=>r({})),()=>e.setNotifyCallback(null)),[e]),E.useEffect(()=>{const o=e.getImageGenerationEnabled();n(o===!0)},[e]);const s=e.getIsVisible(),i=e.getIsStreaming(),a=E.useCallback(()=>{const o=!t;e.setImageGenerationEnabled(o?!0:null),n(o)},[t,e]);return s?f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx(ct,{variant:t?"secondary":"ghost",size:"icon",onClick:a,disabled:i,className:"h-8 w-8","aria-label":t?"Disable Image Generation for Next Turn":"Enable Image Generation for Next Turn",children:f.jsx(ny,{className:Ze("h-4 w-4",t?"text-primary":"text-muted-foreground")})})}),f.jsx(Cr,{side:"top",children:t?"Image Generation Enabled (Click to Disable)":"Image Generation Disabled (Click to Enable)"})]})}):null};class bVe{constructor(){ue(this,"id","core-image-generation");ue(this,"modApiRef",null);ue(this,"isImageGenerationEnabled",null);ue(this,"unregisterCallback",null);ue(this,"notifyComponentUpdate",null);ue(this,"eventUnsubscribers",[]);ue(this,"isVisible",!1);ue(this,"isStreaming",!1);ue(this,"getImageGenerationEnabled",()=>this.isImageGenerationEnabled);ue(this,"getIsVisible",()=>this.isVisible);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"setImageGenerationEnabled",t=>{var n,r;this.isImageGenerationEnabled=t,(n=this.modApiRef)==null||n.emit(sn.setImageGenerationEnabledRequest,{enabled:t}),(r=this.notifyComponentUpdate)==null||r.call(this)});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t})}async initialize(t){this.modApiRef=t,this.isImageGenerationEnabled=null,this.isStreaming=un.getState().status==="streaming",this.updateVisibility();const n=t.on(Wn.selectedModelChanged,()=>{var s;this.updateVisibility(),(s=this.notifyComponentUpdate)==null||s.call(this)}),r=t.on(En.statusChanged,s=>{var i;typeof s=="object"&&s&&"status"in s&&this.isStreaming!==(s.status==="streaming")&&(this.isStreaming=s.status==="streaming",(i=this.notifyComponentUpdate)==null||i.call(this))});this.eventUnsubscribers.push(n,r),console.log(`[${this.id}] Initialized.`)}updateVisibility(){var i,a;const{getSelectedModel:t}=Qn.getState(),n=t(),s=(((a=(i=n==null?void 0:n.metadata)==null?void 0:i.architecture)==null?void 0:a.output_modalities)??[]).includes("image");this.isVisible!==s&&(this.isVisible=s)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(yVe,{module:this}),getMetadata:()=>this.isImageGenerationEnabled===!0?{imageGenerationEnabled:!0}:void 0,clearOnSubmit:()=>{var s;(s=this.modApiRef)==null||s.emit(sn.setImageGenerationEnabledRequest,{enabled:null})}});const n=s=>{var i;s.enabled!==this.isImageGenerationEnabled&&(this.isImageGenerationEnabled=s.enabled,(i=this.notifyComponentUpdate)==null||i.call(this))},r=this.modApiRef.on(sn.setImageGenerationEnabledRequest,n);this.eventUnsubscribers.push(r),console.log(`[${this.id}] Registered successfully`)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.notifyComponentUpdate=null,this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const vVe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState([]),[i,a]=E.useState(250),[o,l]=E.useState(120),[c,u]=E.useState(!1),[d,h]=E.useState(null),[m,y]=E.useState(`You are a helpful assistant that analyzes and combines multiple AI model responses. Below are responses from different models to the same prompt. Please provide a comprehensive combined response that incorporates the best insights from each model while maintaining coherence and accuracy.

Please analyze the responses and provide a single, well-structured answer that combines their strengths.`),[b,v]=E.useState(""),[x,w]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1,imageGeneration:!1}),[,S]=E.useState({}),{status:k}=un(yn(K=>({status:K.status})));E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>S({})),()=>e.setNotifyCallback(null)},[e]);const C=E.useMemo(()=>{let K=e.globallyEnabledModels;if(b.trim()){const V=b.toLowerCase();K=e.globallyEnabledModels.filter(L=>L.name.toLowerCase().includes(V)||L.providerName.toLowerCase().includes(V)||L.id.toLowerCase().includes(V))}const U=Object.entries(x).filter(([,V])=>V).map(([V])=>V);return U.length===0?K:K.filter(V=>{var Q,ee,re;const L=new Set(((Q=V.metadataSummary)==null?void 0:Q.supported_parameters)??[]),te=new Set(((ee=V.metadataSummary)==null?void 0:ee.input_modalities)??[]),W=new Set(((re=V.metadataSummary)==null?void 0:re.output_modalities)??[]);return U.every(pe=>{switch(pe){case"reasoning":return L.has("reasoning");case"webSearch":return L.has("web_search")||L.has("web_search_options");case"tools":return L.has("tools");case"multimodal":return Array.from(te).some(de=>de!=="text");case"imageGeneration":return W.has("image");default:return!0}})})},[e.globallyEnabledModels,b,x]),T=K=>{w(U=>({...U,[K]:!U[K]}))},N=Object.values(x).filter(Boolean).length,I=(K,U)=>{s(V=>U?[...V,K]:V.filter(L=>L!==K))},O=()=>{if(r.length<1){Te.error("Please select at least 1 model to race");return}if(c&&!d){Te.error("Please select a model for combining");return}e.setRaceMode(!0,{modelIds:r,staggerMs:i,raceTimeoutSec:o,combineEnabled:c,combineModelId:d||void 0,combinePrompt:m}),n(!1),Te.info(`Race mode enabled! Send your prompt to race ${r.length} models.`),s([]),a(250),l(120),v(""),w({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1,imageGeneration:!1}),u(!1),h(null),y(`You are a helpful assistant that analyzes and combines multiple AI model responses. Below are responses from different models to the same prompt. Please provide a comprehensive combined response that incorporates the best insights from each model while maintaining coherence and accuracy.

Please analyze the responses and provide a single, well-structured answer that combines their strengths.`)},B=()=>{e.setRaceMode(!1),Te.info("Race mode disabled")},D=K=>{if(K.stopPropagation(),e.isRaceModeActive){B();return}if(k==="streaming"){Te.info("Cannot start race while another response is streaming");return}if(e.globallyEnabledModels.length<2){Te.info("Need at least 2 models enabled to race");return}n(!0)},H=k!=="streaming"&&e.globallyEnabledModels.length>=2,P=()=>e.isRaceModeActive?"Race mode active - click to cancel, or send your prompt to race models":k==="streaming"?"Cannot race while streaming":e.globallyEnabledModels.length<2?`Need at least 2 models enabled to race (currently have ${e.globallyEnabledModels.length})`:"Race multiple models with your prompt";return f.jsxs(f.Fragment,{children:[f.jsx(qn,{tooltipText:P(),onClick:D,"aria-label":"Race Multiple Models Against Each Other",disabled:!H,icon:f.jsx(AH,{}),className:`h-5 w-5 md:h-6 md:w-6 ${e.isRaceModeActive?"bg-primary text-primary-foreground":""}`}),f.jsx(hf,{open:t,onOpenChange:n,children:f.jsxs(pf,{className:"min-w-[65vw] max-h-[75vh] flex flex-col p-4",children:[f.jsxs(mf,{children:[f.jsx(gf,{children:"Race Models"}),f.jsx(mp,{children:'Select multiple models to race against each other. After clicking "Enable Race Mode", send your prompt and all selected models will respond.'})]}),f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"space-y-2",children:f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(uo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(xn,{type:"search",placeholder:"Search models...",value:b,onChange:K=>v(K.target.value),className:"pl-8 h-9"})]}),f.jsxs("div",{className:"flex items-center gap-0.5",children:[f.jsx(ct,{variant:x.reasoning?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",x.reasoning&&"text-primary"),onClick:()=>T("reasoning"),title:"Filter: Reasoning","aria-label":"Filter by reasoning capability",children:f.jsx(f2,{className:"h-4 w-4"})}),f.jsx(ct,{variant:x.webSearch?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",x.webSearch&&"text-primary"),onClick:()=>T("webSearch"),title:"Filter: Web Search","aria-label":"Filter by web search capability",children:f.jsx(h2,{className:"h-4 w-4"})}),f.jsx(ct,{variant:x.tools?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",x.tools&&"text-primary"),onClick:()=>T("tools"),title:"Filter: Tools","aria-label":"Filter by tool usage capability",children:f.jsx(Sm,{className:"h-4 w-4"})}),f.jsx(ct,{variant:x.multimodal?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",x.multimodal&&"text-primary"),onClick:()=>T("multimodal"),title:"Filter: Multimodal","aria-label":"Filter by multimodal capability",children:f.jsx(Ah,{className:"h-4 w-4"})}),f.jsx(ct,{variant:x.imageGeneration?"secondary":"ghost",size:"sm",className:Ze("h-7 w-7 p-0",x.imageGeneration&&"text-primary"),onClick:()=>T("imageGeneration"),title:"Filter: Image Generation","aria-label":"Filter by image generation capability",children:f.jsx(ny,{className:"h-4 w-4"})})]}),N>0&&f.jsx("span",{className:"inline-flex items-center justify-center px-1.5 py-0.5 text-xs font-semibold leading-none text-white bg-primary rounded-full",children:N})]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsxs(jt,{children:["Select Models to Race (",r.length," selected)"]}),f.jsx(Zl,{className:"h-48 w-full border rounded-md p-3",children:f.jsx("div",{className:"space-y-2",children:C.length===0?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:N>0?"No models match all active filters.":e.globallyEnabledModels.length===0?"No models available.":"No models match search."}):C.map(K=>{var U,V,L,te,W,Q,ee,re,pe,de,Oe,Fe;return f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(zc,{id:`model-${K.id}`,checked:r.includes(K.id),onCheckedChange:Se=>I(K.id,Se===!0)}),f.jsxs(jt,{htmlFor:`model-${K.id}`,className:"text-sm cursor-pointer flex-1 min-w-0 flex justify-between items-center",children:[f.jsxs("div",{className:"truncate",children:[f.jsx("span",{className:"font-medium",children:K.name}),f.jsxs("span",{className:"text-muted-foreground ml-2",children:["(",K.providerName,")"]})]}),f.jsxs("div",{className:"flex gap-1 ml-2",children:[((V=(U=K.metadataSummary)==null?void 0:U.supported_parameters)==null?void 0:V.includes("reasoning"))&&f.jsx(f2,{className:"h-3.5 w-3.5 text-purple-500"}),(((te=(L=K.metadataSummary)==null?void 0:L.supported_parameters)==null?void 0:te.includes("web_search"))||((Q=(W=K.metadataSummary)==null?void 0:W.supported_parameters)==null?void 0:Q.includes("web_search_options")))&&f.jsx(h2,{className:"h-3.5 w-3.5 text-blue-500"}),((re=(ee=K.metadataSummary)==null?void 0:ee.supported_parameters)==null?void 0:re.includes("tools"))&&f.jsx(Sm,{className:"h-3.5 w-3.5 text-orange-500"}),((de=(pe=K.metadataSummary)==null?void 0:pe.input_modalities)==null?void 0:de.some(Se=>Se!=="text"))&&f.jsx(Ah,{className:"h-3.5 w-3.5 text-green-500"}),((Fe=(Oe=K.metadataSummary)==null?void 0:Oe.output_modalities)==null?void 0:Fe.includes("image"))&&f.jsx(ny,{className:"h-3.5 w-3.5 text-pink-500"})]})]})]},K.id)})})})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[f.jsxs("div",{children:[f.jsx(jt,{htmlFor:"stagger-ms",children:"Stagger (ms)"}),f.jsx(xn,{id:"stagger-ms",type:"number",value:i,onChange:K=>a(parseInt(K.target.value,10)),className:"mt-1"})]}),f.jsxs("div",{children:[f.jsx(jt,{htmlFor:"race-timeout",children:"Timeout (s)"}),f.jsx(xn,{id:"race-timeout",type:"number",value:o,onChange:K=>l(parseInt(K.target.value,10)||120),className:"mt-1"})]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:"combine-switch",children:"Combine Models"}),f.jsx(oo,{id:"combine-switch",checked:c,onCheckedChange:K=>u(K)})]}),c&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:"combine-model-selector",children:"Combine with Model"}),f.jsx(ag,{models:e.globallyEnabledModels,value:d,onChange:K=>h(K),isLoading:e.isLoadingProviders})]}),c&&f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:"combine-prompt",children:"Combine Prompt"}),f.jsx(qa,{id:"combine-prompt",value:m,onChange:K=>y(K.target.value),placeholder:"Enter a prompt to combine models",className:"w-full"})]})]}),f.jsxs(xb,{children:[f.jsx(ct,{variant:"outline",onClick:()=>n(!1),children:"Cancel"}),f.jsx(ct,{onClick:O,disabled:r.length<1||e.isLoadingProviders,children:"Enable Race Mode"})]})]})})]})};class xVe{constructor(){ue(this,"id","race-prompt-control");ue(this,"eventUnsubscribers",[]);ue(this,"modApi",null);ue(this,"notifyComponentUpdate",null);ue(this,"isRaceMode",!1);ue(this,"raceConfig",{modelIds:[],staggerMs:250,raceTimeoutSec:120,combineEnabled:!1});ue(this,"globallyEnabledModels",[]);ue(this,"isLoadingProviders",!1)}async initialize(t){this.modApi=t;const n=Qn.getState();this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions(),this.isLoadingProviders=n.isLoading;const r=t.on(Wn.globallyEnabledModelsUpdated,a=>{var o;this.globallyEnabledModels=a.models,(o=this.notifyComponentUpdate)==null||o.call(this)}),s=t.on(Wn.initialDataLoaded,a=>{var o;a.globallyEnabledModels&&(this.globallyEnabledModels=a.globallyEnabledModels,this.isLoadingProviders=!1,(o=this.notifyComponentUpdate)==null||o.call(this))}),i=t.addMiddleware(cy.INTERACTION_BEFORE_START,a=>{if(this.isRaceMode){const o={...this.raceConfig};return this.setRaceMode(!1),this.handleRaceConversion(a.prompt,a.conversationId,o),!1}return a});this.eventUnsubscribers.push(r,s,i)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null,this.modApi=null}setNotifyCallback(t){this.notifyComponentUpdate=t}setRaceMode(t,n){var r;this.isRaceMode=t,t&&n?this.raceConfig={...n,raceTimeoutSec:n.raceTimeoutSec||120}:this.raceConfig={modelIds:[],staggerMs:250,raceTimeoutSec:120,combineEnabled:!1},(r=this.notifyComponentUpdate)==null||r.call(this)}get isRaceModeActive(){return this.isRaceMode}async handleRaceConversion(t,n,r){var s,i;try{const{modelIds:a,staggerMs:o,combineEnabled:l,combineModelId:c}=r;if(a.length===0)throw new Error("No additional models selected for race");if(l&&!c)throw new Error("Combine model not selected");const u=un.getState(),d=t.messages[t.messages.length-1];if(!d||d.role!=="user")throw new Error("Could not find user message in prompt");let h="";typeof d.content=="string"?h=d.content:Array.isArray(d.content)&&(h=d.content.filter(b=>b.type==="text").map(b=>b.text).join(""));const m={id:"",content:h,parameters:t.parameters||{},metadata:{...t.metadata,modelId:((s=t.metadata)==null?void 0:s.modelId)||""}},y=(i=t.metadata)==null?void 0:i.modelId;if(!y)throw new Error("No model ID available in prompt metadata");if(l){const{nanoid:b}=await Dr(async()=>{const{nanoid:O}=await Promise.resolve().then(()=>kN);return{nanoid:O}},void 0),v=b(),x={...m,id:v,metadata:{...m.metadata,modelId:c,isRaceCombining:!0,raceParticipantCount:a.length+1,raceConfig:r}},S=u.interactions.filter(O=>O.conversationId===n).reduce((O,B)=>Math.max(O,B.index),-1)+1,k={id:v,conversationId:n,type:"message.user_assistant",prompt:{...x},response:null,status:"STREAMING",startedAt:new Date,endedAt:null,metadata:{...x.metadata,isRaceCombining:!0,raceParticipantCount:a.length+1,toolCalls:[],toolResults:[]},index:S,parentId:null};u._addInteractionToState(k),u._addStreamingId(k.id),u.setActiveStreamBuffer(k.id," Starting race with "+(a.length+1)+` models...

 Collecting responses for combination...`),await bt.saveInteraction(k),Re.emit(En.added,{interaction:k}),Re.emit(En.started,{interactionId:k.id,conversationId:k.conversationId,type:k.type});const T=[y,...a].map((O,B)=>new Promise(D=>{setTimeout(async()=>{try{const H=b(),P={...m,id:H,metadata:{...m.metadata,modelId:O,raceTab:!0,raceParticipantIndex:B+1,raceMainInteractionId:k.id}},K={...t,metadata:{...t.metadata,modelId:O}},U=await Sc.startInteraction(K,n,P,"message.assistant_regen");if(U){const V={parentId:k.id,index:B+1};u._updateInteractionInState(U.id,V),await bt.saveInteraction({...U,...V})}D({interaction:U,modelId:O})}catch(H){console.error(`[RacePromptControlModule] Error creating child interaction for ${O}:`,H),D({interaction:null,modelId:O})}},B*o)})),I=(await Promise.all(T)).filter(O=>O.interaction!==null).map(O=>O.interaction.id);await this.waitForRaceCompletion(k.id,I,r.raceTimeoutSec)}else{const{nanoid:b}=await Dr(async()=>{const{nanoid:T}=await Promise.resolve().then(()=>kN);return{nanoid:T}},void 0),v=b(),x={...m,id:v,metadata:{...m.metadata,modelId:y,raceTab:!0,raceParticipantIndex:1,raceMainInteractionId:v}},w=await Sc.startInteraction(t,n,x,"message.user_assistant");if(!w)throw new Error("Could not create main race interaction");const S=a.map((T,A)=>new Promise(N=>{setTimeout(async()=>{try{const I=b(),O={...m,id:I,metadata:{...m.metadata,modelId:T,raceTab:!0,raceParticipantIndex:A+2,raceMainInteractionId:w.id}},B={...t,metadata:{...t.metadata,modelId:T}},D=await Sc.startInteraction(B,n,O,"message.assistant_regen");if(D){const H={parentId:w.id,index:A+1};u._updateInteractionInState(D.id,H),await bt.saveInteraction({...D,...H})}N({interaction:D,modelId:T})}catch(I){console.error(`[RacePromptControlModule] Error creating child interaction for ${T}:`,I),N({interaction:null,modelId:T})}},A*o)})),C=(await Promise.all(S)).filter(T=>T.interaction!==null);Te.success(`Race started! Original model + ${C.length} additional race models responding in tabs.`)}}catch(a){Te.error(`Race conversion failed: ${String(a)}`),console.error("[RacePromptControlModule] Error during race conversion:",a)}}async waitForRaceCompletion(t,n,r=120){return new Promise(s=>{let i=0;const a=n.length;let o=null;const l=()=>{o&&(clearTimeout(o),o=null),Re.off(En.completed,c)},c=u=>{if(n.includes(u.interactionId)&&(u.status==="COMPLETED"||u.status==="ERROR")){i++;const d=un.getState(),h=` Race progress: ${i}/${a} models completed

 ${i===a?"Combining responses...":"Waiting for remaining responses..."}`;d.setActiveStreamBuffer(t,h);const m={metadata:{isRaceCombining:!0,raceCompletedCount:i,raceParticipantCount:a}};d._updateInteractionInState(t,m),i===a&&(l(),this.startCombineProcess(t,n),s())}};Re.on(En.completed,c),o=setTimeout(()=>{console.warn(`[RacePromptControlModule] Race timed out for main interaction ${t}.`),l();const u=un.getState(),d=` Race timed out. Only ${i}/${a} models responded within ${r} seconds.`;u.setActiveStreamBuffer(t,d),u._updateInteractionInState(t,{status:"ERROR",endedAt:new Date,metadata:{isRaceCombining:!1,combineError:"Race timed out"}}),u._removeStreamingId(t),s()},r*1e3)})}async startCombineProcess(t,n){var r;try{const s=un.getState(),i=s.interactions.find(v=>v.id===t),a=(r=i==null?void 0:i.metadata)==null?void 0:r.raceConfig,{combineModelId:o,combinePrompt:l}=a||{};if(!o)throw new Error("Combine model not configured");const c=s.currentConversationId;if(!c)throw new Error("No current conversation ID available for combine process");const u=n.map((v,x)=>{var T;const w=s.interactions.find(A=>A.id===v),S=((T=w==null?void 0:w.metadata)==null?void 0:T.modelId)||`Model ${x+1}`,k=(w==null?void 0:w.response)||"No response",C=(w==null?void 0:w.status)||"UNKNOWN";return`**${S}** (${C}):
${k}`}).join(`

---

`),m={system:"You are an expert at analyzing and synthesizing multiple AI responses into comprehensive, unified answers.",messages:[{role:"user",content:`${l||`Please analyze and combine the following AI responses to provide a comprehensive, well-structured answer. 

Take the best insights from each response, resolve any contradictions, and present a unified, clear, and complete answer. If responses differ significantly, explain the different perspectives and provide your reasoned conclusion.

Focus on accuracy, completeness, and clarity in your combined response.`}

Here are the responses to combine:

${u}`}],parameters:{temperature:.3,max_tokens:4e3},metadata:{modelId:o,isCompactGeneration:!0}},{nanoid:y}=await Dr(async()=>{const{nanoid:v}=await Promise.resolve().then(()=>kN);return{nanoid:v}},void 0),b={id:y(),content:`[Internal combine generation for race interaction ${t}]`,parameters:m.parameters,metadata:{modelId:o,targetUserInteractionId:t,targetConversationId:c}};await Sc.startInteraction(m,c,b,"conversation.compact")}catch(s){const i=un.getState();i._updateInteractionInState(t,{response:` Failed to combine responses: ${String(s)}`,status:"ERROR",endedAt:new Date,metadata:{isRaceCombining:!1,combineError:String(s)}}),i._removeStreamingId(t)}}register(t){t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(vVe,{module:this})})}}const xx=({fieldApi:e,label:t,description:n,placeholder:r,inputClassName:s,labelClassName:i,wrapperClassName:a,type:o="text"})=>{const{name:l,state:c,handleChange:u,handleBlur:d}=e,h=c.value,m=y=>{u(y.target.value)};return f.jsxs("div",{className:Ze("space-y-1.5",a),children:[t&&f.jsx(jt,{htmlFor:l,className:Ze("text-sm font-medium",i),children:t}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(xn,{id:l,name:l,type:o,value:h==null?"":String(h),onBlur:d,onChange:m,placeholder:r,className:Ze(s,c.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),c.meta.isTouched&&c.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:c.meta.errors.map((y,b)=>f.jsx("p",{children:typeof y=="string"?y:(y==null?void 0:y.message)||"Invalid"},b))})]})},wVe=({fieldApi:e,label:t,placeholder:n,description:r,rows:s=3,inputClassName:i,labelClassName:a,wrapperClassName:o})=>f.jsxs("div",{className:Ze("space-y-1.5",o),children:[t&&f.jsx(jt,{htmlFor:e.name,className:Ze("text-sm font-medium",a),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsx(qa,{id:e.name,name:e.name,value:e.state.value||"",onBlur:e.handleBlur,onChange:l=>e.handleChange(l.target.value),placeholder:n,rows:s,className:Ze(i,e.state.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((l,c)=>f.jsx("p",{children:String(l)},c))})]}),_Ve=({fieldApi:e,label:t,placeholder:n,description:r,options:s=[],inputClassName:i,labelClassName:a,wrapperClassName:o})=>f.jsxs("div",{className:Ze("space-y-1.5",o),children:[t&&f.jsx(jt,{htmlFor:e.name+"-trigger",className:Ze("text-sm font-medium",a),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsxs(lf,{value:e.state.value||"",onValueChange:l=>e.handleChange(l),disabled:e.form.state.isSubmitting,children:[f.jsx(uf,{id:e.name+"-trigger",onBlur:e.handleBlur,className:Ze(i,e.state.meta.errors.length?"border-destructive":""),children:f.jsx(cf,{placeholder:n||"Select an option"})}),f.jsx(df,{children:s.map((l,c)=>{const u=typeof l=="string"?l:l.value,d=typeof l=="string"?l:l.label;return f.jsx(Ba,{value:u,children:d},u+c)})})]}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((l,c)=>f.jsx("p",{children:String(l)},c))})]}),SVe=({fieldApi:e,label:t,description:n,labelClassName:r,wrapperClassName:s})=>f.jsxs("div",{className:Ze("space-y-1.5",s),children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(zc,{id:e.name,checked:!!e.state.value,onCheckedChange:i=>e.handleChange(!!i),onBlur:e.handleBlur,disabled:e.form.state.isSubmitting,"aria-describedby":n?`${e.name}-description`:void 0}),t&&f.jsx(jt,{htmlFor:e.name,className:Ze("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),children:t})]}),n&&f.jsx("p",{id:`${e.name}-description`,className:"text-xs text-muted-foreground",children:n}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((i,a)=>f.jsx("p",{children:String(i)},a))})]}),CVe=({fieldApi:e,label:t,description:n,labelClassName:r,wrapperClassName:s})=>f.jsxs("div",{className:Ze("space-y-1.5",s),children:[f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(oo,{id:e.name,checked:!!e.state.value,onCheckedChange:i=>e.handleChange(i),onBlur:e.handleBlur,disabled:e.form.state.isSubmitting,"aria-describedby":n?`${e.name}-description`:void 0}),t&&f.jsx(jt,{htmlFor:e.name,className:Ze("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70",r),children:t})]}),n&&f.jsx("p",{id:`${e.name}-description`,className:"text-xs text-muted-foreground",children:n}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((i,a)=>f.jsx("p",{children:String(i)},a))})]}),kVe=({fieldApi:e,label:t,description:n,placeholder:r,inputClassName:s,labelClassName:i,wrapperClassName:a,min:o,max:l,step:c})=>{const{name:u,state:d,handleChange:h,handleBlur:m}=e,y=d.value,b=x=>{const w=x.target.value;if(w==="")h(void 0);else{const S=parseFloat(w);h(isNaN(S)?w:S)}};let v="";return(typeof y=="number"||typeof y=="string")&&(v=y),f.jsxs("div",{className:Ze("space-y-1.5",a),children:[t&&f.jsx(jt,{htmlFor:u,className:Ze("text-sm font-medium",i),children:t}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(xn,{id:u,name:u,type:"number",value:v,onBlur:m,onChange:b,placeholder:r,min:o,max:l,step:c,className:Ze(s,d.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting}),d.meta.isTouched&&d.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:d.meta.errors.map((x,w)=>f.jsx("p",{children:typeof x=="string"?x:(x==null?void 0:x.message)||"Invalid"},w))})]})},x3={},wx={};function Bx(e,t){try{const r=(x3[e]||(x3[e]=new Intl.DateTimeFormat("en-GB",{timeZone:e,hour:"numeric",timeZoneName:"longOffset"}).format))(t).split("GMT")[1]||"";return r in wx?wx[r]:Uq(r,r.split(":"))}catch{if(e in wx)return wx[e];const n=e==null?void 0:e.match(EVe);return n?Uq(e,n.slice(1)):NaN}}const EVe=/([+-]\d\d):?(\d\d)?/;function Uq(e,t){const n=+t[0],r=+(t[1]||0);return wx[e]=n>0?n*60+r:n*60-r}class Cu extends Date{constructor(...t){super(),t.length>1&&typeof t[t.length-1]=="string"&&(this.timeZone=t.pop()),this.internal=new Date,isNaN(Bx(this.timeZone,this))?this.setTime(NaN):t.length?typeof t[0]=="number"&&(t.length===1||t.length===2&&typeof t[1]!="number")?this.setTime(t[0]):typeof t[0]=="string"?this.setTime(+new Date(t[0])):t[0]instanceof Date?this.setTime(+t[0]):(this.setTime(+new Date(...t)),Jse(this),B4(this)):this.setTime(Date.now())}static tz(t,...n){return n.length?new Cu(...n,t):new Cu(Date.now(),t)}withTimeZone(t){return new Cu(+this,t)}getTimezoneOffset(){return-Bx(this.timeZone,this)}setTime(t){return Date.prototype.setTime.apply(this,arguments),B4(this),+this}[Symbol.for("constructDateFrom")](t){return new Cu(+new Date(t),this.timeZone)}}const qq=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(e=>{if(!qq.test(e))return;const t=e.replace(qq,"$1UTC");Cu.prototype[t]&&(e.startsWith("get")?Cu.prototype[e]=function(){return this.internal[t]()}:(Cu.prototype[e]=function(){return Date.prototype[t].apply(this.internal,arguments),TVe(this),+this},Cu.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),B4(this),+this}))});function B4(e){e.internal.setTime(+e),e.internal.setUTCMinutes(e.internal.getUTCMinutes()-e.getTimezoneOffset())}function TVe(e){Date.prototype.setFullYear.call(e,e.internal.getUTCFullYear(),e.internal.getUTCMonth(),e.internal.getUTCDate()),Date.prototype.setHours.call(e,e.internal.getUTCHours(),e.internal.getUTCMinutes(),e.internal.getUTCSeconds(),e.internal.getUTCMilliseconds()),Jse(e)}function Jse(e){const t=Bx(e.timeZone,e),n=new Date(+e);n.setUTCHours(n.getUTCHours()-1);const r=-new Date(+e).getTimezoneOffset(),s=-new Date(+n).getTimezoneOffset(),i=r-s,a=Date.prototype.getHours.apply(e)!==e.internal.getUTCHours();i&&a&&e.internal.setUTCMinutes(e.internal.getUTCMinutes()+i);const o=r-t;o&&Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+o);const l=Bx(e.timeZone,e),u=-new Date(+e).getTimezoneOffset()-l,d=l!==t,h=u-o;if(d&&h){Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+h);const m=Bx(e.timeZone,e),y=l-m;y&&(e.internal.setUTCMinutes(e.internal.getUTCMinutes()+y),Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+y))}}class Oa extends Cu{static tz(t,...n){return n.length?new Oa(...n,t):new Oa(Date.now(),t)}toISOString(){const[t,n,r]=this.tzComponents(),s=`${t}${n}:${r}`;return this.internal.toISOString().slice(0,-1)+s}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[t,n,r,s]=this.internal.toUTCString().split(" ");return`${t==null?void 0:t.slice(0,-1)} ${r} ${n} ${s}`}toTimeString(){const t=this.internal.toUTCString().split(" ")[4],[n,r,s]=this.tzComponents();return`${t} GMT${n}${r}${s} (${AVe(this.timeZone,this)})`}toLocaleString(t,n){return Date.prototype.toLocaleString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}toLocaleDateString(t,n){return Date.prototype.toLocaleDateString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}toLocaleTimeString(t,n){return Date.prototype.toLocaleTimeString.call(this,t,{...n,timeZone:(n==null?void 0:n.timeZone)||this.timeZone})}tzComponents(){const t=this.getTimezoneOffset(),n=t>0?"-":"+",r=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),s=String(Math.abs(t)%60).padStart(2,"0");return[n,r,s]}withTimeZone(t){return new Oa(+this,t)}[Symbol.for("constructDateFrom")](t){return new Oa(+new Date(t),this.timeZone)}}function AVe(e,t){return new Intl.DateTimeFormat("en-GB",{timeZone:e,timeZoneName:"long"}).format(t).slice(12)}var $n;(function(e){e.Root="root",e.Chevron="chevron",e.Day="day",e.DayButton="day_button",e.CaptionLabel="caption_label",e.Dropdowns="dropdowns",e.Dropdown="dropdown",e.DropdownRoot="dropdown_root",e.Footer="footer",e.MonthGrid="month_grid",e.MonthCaption="month_caption",e.MonthsDropdown="months_dropdown",e.Month="month",e.Months="months",e.Nav="nav",e.NextMonthButton="button_next",e.PreviousMonthButton="button_previous",e.Week="week",e.Weeks="weeks",e.Weekday="weekday",e.Weekdays="weekdays",e.WeekNumber="week_number",e.WeekNumberHeader="week_number_header",e.YearsDropdown="years_dropdown"})($n||($n={}));var Qs;(function(e){e.disabled="disabled",e.hidden="hidden",e.outside="outside",e.focused="focused",e.today="today"})(Qs||(Qs={}));var kc;(function(e){e.range_end="range_end",e.range_middle="range_middle",e.range_start="range_start",e.selected="selected"})(kc||(kc={}));var cl;(function(e){e.weeks_before_enter="weeks_before_enter",e.weeks_before_exit="weeks_before_exit",e.weeks_after_enter="weeks_after_enter",e.weeks_after_exit="weeks_after_exit",e.caption_after_enter="caption_after_enter",e.caption_after_exit="caption_after_exit",e.caption_before_enter="caption_before_enter",e.caption_before_exit="caption_before_exit"})(cl||(cl={}));const Vq=5,RVe=4;function NVe(e,t){const n=t.startOfMonth(e),r=n.getDay()>0?n.getDay():7,s=t.addDays(e,-r+1),i=t.addDays(s,Vq*7-1);return t.getMonth(e)===t.getMonth(i)?Vq:RVe}function Qse(e,t){const n=t.startOfMonth(e),r=n.getDay();return r===1?n:r===0?t.addDays(n,-1*6):t.addDays(n,-1*(r-1))}function MVe(e,t){const n=Qse(e,t),r=NVe(e,t);return t.addDays(n,r*7-1)}class vf{constructor(t,n){this.Date=Date,this.today=()=>{var r;return(r=this.overrides)!=null&&r.today?this.overrides.today():this.options.timeZone?Oa.tz(this.options.timeZone):new this.Date},this.newDate=(r,s,i)=>{var a;return(a=this.overrides)!=null&&a.newDate?this.overrides.newDate(r,s,i):this.options.timeZone?new Oa(r,s,i,this.options.timeZone):new Date(r,s,i)},this.addDays=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addDays?this.overrides.addDays(r,s):LZ(r,s)},this.addMonths=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addMonths?this.overrides.addMonths(r,s):BZ(r,s)},this.addWeeks=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addWeeks?this.overrides.addWeeks(r,s):jTe(r,s)},this.addYears=(r,s)=>{var i;return(i=this.overrides)!=null&&i.addYears?this.overrides.addYears(r,s):PTe(r,s)},this.differenceInCalendarDays=(r,s)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarDays?this.overrides.differenceInCalendarDays(r,s):zZ(r,s)},this.differenceInCalendarMonths=(r,s)=>{var i;return(i=this.overrides)!=null&&i.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(r,s):qZ(r,s)},this.eachMonthOfInterval=r=>{var s;return(s=this.overrides)!=null&&s.eachMonthOfInterval?this.overrides.eachMonthOfInterval(r):GTe(r)},this.endOfBroadcastWeek=r=>{var s;return(s=this.overrides)!=null&&s.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(r):MVe(r,this)},this.endOfISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.endOfISOWeek?this.overrides.endOfISOWeek(r):ZTe(r)},this.endOfMonth=r=>{var s;return(s=this.overrides)!=null&&s.endOfMonth?this.overrides.endOfMonth(r):VZ(r)},this.endOfWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.endOfWeek?this.overrides.endOfWeek(r,s):HZ(r,this.options)},this.endOfYear=r=>{var s;return(s=this.overrides)!=null&&s.endOfYear?this.overrides.endOfYear(r):YTe(r)},this.format=(r,s,i)=>{var o;const a=(o=this.overrides)!=null&&o.format?this.overrides.format(r,s,this.options):jd(r,s,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(a):a},this.getISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.getISOWeek?this.overrides.getISOWeek(r):GZ(r)},this.getMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getMonth?this.overrides.getMonth(r,this.options):KAe(r,this.options)},this.getYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getYear?this.overrides.getYear(r,this.options):YAe(r,this.options)},this.getWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.getWeek?this.overrides.getWeek(r,this.options):YZ(r,this.options)},this.isAfter=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isAfter?this.overrides.isAfter(r,s):ZAe(r,s)},this.isBefore=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isBefore?this.overrides.isBefore(r,s):XAe(r,s)},this.isDate=r=>{var s;return(s=this.overrides)!=null&&s.isDate?this.overrides.isDate(r):UZ(r)},this.isSameDay=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameDay?this.overrides.isSameDay(r,s):LTe(r,s)},this.isSameMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameMonth?this.overrides.isSameMonth(r,s):JAe(r,s)},this.isSameYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.isSameYear?this.overrides.isSameYear(r,s):QAe(r,s)},this.max=r=>{var s;return(s=this.overrides)!=null&&s.max?this.overrides.max(r):OTe(r)},this.min=r=>{var s;return(s=this.overrides)!=null&&s.min?this.overrides.min(r):DTe(r)},this.setMonth=(r,s)=>{var i;return(i=this.overrides)!=null&&i.setMonth?this.overrides.setMonth(r,s):gRe(r,s)},this.setYear=(r,s)=>{var i;return(i=this.overrides)!=null&&i.setYear?this.overrides.setYear(r,s):yRe(r,s)},this.startOfBroadcastWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(r,this):Qse(r,this)},this.startOfDay=r=>{var s;return(s=this.overrides)!=null&&s.startOfDay?this.overrides.startOfDay(r):Tw(r)},this.startOfISOWeek=r=>{var s;return(s=this.overrides)!=null&&s.startOfISOWeek?this.overrides.startOfISOWeek(r):Ew(r)},this.startOfMonth=r=>{var s;return(s=this.overrides)!=null&&s.startOfMonth?this.overrides.startOfMonth(r):KTe(r)},this.startOfWeek=(r,s)=>{var i;return(i=this.overrides)!=null&&i.startOfWeek?this.overrides.startOfWeek(r,this.options):Cy(r,this.options)},this.startOfYear=r=>{var s;return(s=this.overrides)!=null&&s.startOfYear?this.overrides.startOfYear(r):WZ(r)},this.options={locale:mT,...t},this.overrides=n}getDigitMap(){const{numerals:t="latn"}=this.options,n=new Intl.NumberFormat("en-US",{numberingSystem:t}),r={};for(let s=0;s<10;s++)r[s.toString()]=n.format(s);return r}replaceDigits(t){const n=this.getDigitMap();return t.replace(/\d/g,r=>n[r]||r)}formatNumber(t){return this.replaceDigits(t.toString())}}const Gu=new vf;class eie{constructor(t,n,r=Gu){this.date=t,this.displayMonth=n,this.outside=!!(n&&!r.isSameMonth(t,n)),this.dateLib=r}isEqualTo(t){return this.dateLib.isSameDay(t.date,this.date)&&this.dateLib.isSameMonth(t.displayMonth,this.displayMonth)}}class IVe{constructor(t,n){this.date=t,this.weeks=n}}class jVe{constructor(t,n){this.days=n,this.weekNumber=t}}function Pd(e,t,n=!1,r=Gu){let{from:s,to:i}=e;const{differenceInCalendarDays:a,isSameDay:o}=r;return s&&i?(a(i,s)<0&&([s,i]=[i,s]),a(t,s)>=(n?1:0)&&a(i,t)>=(n?1:0)):!n&&i?o(i,t):!n&&s?o(s,t):!1}function tie(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function i6(e){return!!(e&&typeof e=="object"&&"from"in e)}function nie(e){return!!(e&&typeof e=="object"&&"after"in e)}function rie(e){return!!(e&&typeof e=="object"&&"before"in e)}function sie(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function iie(e,t){return Array.isArray(e)&&e.every(t.isDate)}function Od(e,t,n=Gu){const r=Array.isArray(t)?t:[t],{isSameDay:s,differenceInCalendarDays:i,isAfter:a}=n;return r.some(o=>{if(typeof o=="boolean")return o;if(n.isDate(o))return s(e,o);if(iie(o,n))return o.includes(e);if(i6(o))return Pd(o,e,!1,n);if(sie(o))return Array.isArray(o.dayOfWeek)?o.dayOfWeek.includes(e.getDay()):o.dayOfWeek===e.getDay();if(tie(o)){const l=i(o.before,e),c=i(o.after,e),u=l>0,d=c<0;return a(o.before,o.after)?d&&u:u||d}return nie(o)?i(e,o.after)>0:rie(o)?i(o.before,e)>0:typeof o=="function"?o(e):!1})}function PVe(e,t,n){const{disabled:r,hidden:s,modifiers:i,showOutsideDays:a,broadcastCalendar:o,today:l}=t,{isSameDay:c,isSameMonth:u,startOfMonth:d,isBefore:h,endOfMonth:m,isAfter:y}=n,b=t.startMonth&&d(t.startMonth),v=t.endMonth&&m(t.endMonth),x={[Qs.focused]:[],[Qs.outside]:[],[Qs.disabled]:[],[Qs.hidden]:[],[Qs.today]:[]},w={};for(const S of e){const{date:k,displayMonth:C}=S,T=!!(C&&!u(k,C)),A=!!(b&&h(k,b)),N=!!(v&&y(k,v)),I=!!(r&&Od(k,r,n)),O=!!(s&&Od(k,s,n))||A||N||!o&&!a&&T||o&&a===!1&&T,B=c(k,l??n.today());T&&x.outside.push(S),I&&x.disabled.push(S),O&&x.hidden.push(S),B&&x.today.push(S),i&&Object.keys(i).forEach(D=>{const H=i==null?void 0:i[D];H&&Od(k,H,n)&&(w[D]?w[D].push(S):w[D]=[S])})}return S=>{const k={[Qs.focused]:!1,[Qs.disabled]:!1,[Qs.hidden]:!1,[Qs.outside]:!1,[Qs.today]:!1},C={};for(const T in x){const A=x[T];k[T]=A.some(N=>N===S)}for(const T in w)C[T]=w[T].some(A=>A===S);return{...k,...C}}}function OVe(e,t,n={}){return Object.entries(e).filter(([,s])=>s===!0).reduce((s,[i])=>(n[i]?s.push(n[i]):t[Qs[i]]?s.push(t[Qs[i]]):t[kc[i]]&&s.push(t[kc[i]]),s),[t[$n.Day]])}function DVe(e){return Ve.createElement("button",{...e})}function FVe(e){return Ve.createElement("span",{...e})}function LVe(e){const{size:t=24,orientation:n="left",className:r}=e;return Ve.createElement("svg",{className:r,width:t,height:t,viewBox:"0 0 24 24"},n==="up"&&Ve.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),n==="down"&&Ve.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),n==="left"&&Ve.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),n==="right"&&Ve.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function BVe(e){const{day:t,modifiers:n,...r}=e;return Ve.createElement("td",{...r})}function $Ve(e){const{day:t,modifiers:n,...r}=e,s=Ve.useRef(null);return Ve.useEffect(()=>{var i;n.focused&&((i=s.current)==null||i.focus())},[n.focused]),Ve.createElement("button",{ref:s,...r})}function zVe(e){const{options:t,className:n,components:r,classNames:s,...i}=e,a=[s[$n.Dropdown],n].join(" "),o=t==null?void 0:t.find(({value:l})=>l===i.value);return Ve.createElement("span",{"data-disabled":i.disabled,className:s[$n.DropdownRoot]},Ve.createElement(r.Select,{className:a,...i},t==null?void 0:t.map(({value:l,label:c,disabled:u})=>Ve.createElement(r.Option,{key:l,value:l,disabled:u},c))),Ve.createElement("span",{className:s[$n.CaptionLabel],"aria-hidden":!0},o==null?void 0:o.label,Ve.createElement(r.Chevron,{orientation:"down",size:18,className:s[$n.Chevron]})))}function UVe(e){return Ve.createElement("div",{...e})}function qVe(e){return Ve.createElement("div",{...e})}function VVe(e){const{calendarMonth:t,displayIndex:n,...r}=e;return Ve.createElement("div",{...r},e.children)}function WVe(e){const{calendarMonth:t,displayIndex:n,...r}=e;return Ve.createElement("div",{...r})}function HVe(e){return Ve.createElement("table",{...e})}function GVe(e){return Ve.createElement("div",{...e})}const aie=E.createContext(void 0);function l_(){const e=E.useContext(aie);if(e===void 0)throw new Error("useDayPicker() must be used within a custom component.");return e}function KVe(e){const{components:t}=l_();return Ve.createElement(t.Dropdown,{...e})}function YVe(e){const{onPreviousClick:t,onNextClick:n,previousMonth:r,nextMonth:s,...i}=e,{components:a,classNames:o,labels:{labelPrevious:l,labelNext:c}}=l_(),u=E.useCallback(h=>{s&&(n==null||n(h))},[s,n]),d=E.useCallback(h=>{r&&(t==null||t(h))},[r,t]);return Ve.createElement("nav",{...i},Ve.createElement(a.PreviousMonthButton,{type:"button",className:o[$n.PreviousMonthButton],tabIndex:r?void 0:-1,"aria-disabled":r?void 0:!0,"aria-label":l(r),onClick:d},Ve.createElement(a.Chevron,{disabled:r?void 0:!0,className:o[$n.Chevron],orientation:"left"})),Ve.createElement(a.NextMonthButton,{type:"button",className:o[$n.NextMonthButton],tabIndex:s?void 0:-1,"aria-disabled":s?void 0:!0,"aria-label":c(s),onClick:u},Ve.createElement(a.Chevron,{disabled:s?void 0:!0,orientation:"right",className:o[$n.Chevron]})))}function ZVe(e){const{components:t}=l_();return Ve.createElement(t.Button,{...e})}function XVe(e){return Ve.createElement("option",{...e})}function JVe(e){const{components:t}=l_();return Ve.createElement(t.Button,{...e})}function QVe(e){const{rootRef:t,...n}=e;return Ve.createElement("div",{...n,ref:t})}function eWe(e){return Ve.createElement("select",{...e})}function tWe(e){const{week:t,...n}=e;return Ve.createElement("tr",{...n})}function nWe(e){return Ve.createElement("th",{...e})}function rWe(e){return Ve.createElement("thead",{"aria-hidden":!0},Ve.createElement("tr",{...e}))}function sWe(e){const{week:t,...n}=e;return Ve.createElement("th",{...n})}function iWe(e){return Ve.createElement("th",{...e})}function aWe(e){return Ve.createElement("tbody",{...e})}function oWe(e){const{components:t}=l_();return Ve.createElement(t.Dropdown,{...e})}const lWe=Object.freeze(Object.defineProperty({__proto__:null,Button:DVe,CaptionLabel:FVe,Chevron:LVe,Day:BVe,DayButton:$Ve,Dropdown:zVe,DropdownNav:UVe,Footer:qVe,Month:VVe,MonthCaption:WVe,MonthGrid:HVe,Months:GVe,MonthsDropdown:KVe,Nav:YVe,NextMonthButton:ZVe,Option:XVe,PreviousMonthButton:JVe,Root:QVe,Select:eWe,Week:tWe,WeekNumber:sWe,WeekNumberHeader:iWe,Weekday:nWe,Weekdays:rWe,Weeks:aWe,YearsDropdown:oWe},Symbol.toStringTag,{value:"Module"}));function cWe(e){return{...lWe,...e}}function uWe(e){const t={"data-mode":e.mode??void 0,"data-required":"required"in e?e.required:void 0,"data-multiple-months":e.numberOfMonths&&e.numberOfMonths>1||void 0,"data-week-numbers":e.showWeekNumber||void 0,"data-broadcast-calendar":e.broadcastCalendar||void 0,"data-nav-layout":e.navLayout||void 0};return Object.entries(e).forEach(([n,r])=>{n.startsWith("data-")&&(t[n]=r)}),t}function a6(){const e={};for(const t in $n)e[$n[t]]=`rdp-${$n[t]}`;for(const t in Qs)e[Qs[t]]=`rdp-${Qs[t]}`;for(const t in kc)e[kc[t]]=`rdp-${kc[t]}`;for(const t in cl)e[cl[t]]=`rdp-${cl[t]}`;return e}function oie(e,t,n){return(n??new vf(t)).format(e,"LLLL y")}const dWe=oie;function fWe(e,t,n){return(n??new vf(t)).format(e,"d")}function hWe(e,t=Gu){return t.format(e,"LLLL")}function pWe(e,t=Gu){return e<10?t.formatNumber(`0${e.toLocaleString()}`):t.formatNumber(`${e.toLocaleString()}`)}function mWe(){return""}function gWe(e,t,n){return(n??new vf(t)).format(e,"cccccc")}function lie(e,t=Gu){return t.format(e,"yyyy")}const yWe=lie,bWe=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:oie,formatDay:fWe,formatMonthCaption:dWe,formatMonthDropdown:hWe,formatWeekNumber:pWe,formatWeekNumberHeader:mWe,formatWeekdayName:gWe,formatYearCaption:yWe,formatYearDropdown:lie},Symbol.toStringTag,{value:"Module"}));function vWe(e){return e!=null&&e.formatMonthCaption&&!e.formatCaption&&(e.formatCaption=e.formatMonthCaption),e!=null&&e.formatYearCaption&&!e.formatYearDropdown&&(e.formatYearDropdown=e.formatYearCaption),{...bWe,...e}}function xWe(e,t,n,r,s){const{startOfMonth:i,startOfYear:a,endOfYear:o,eachMonthOfInterval:l,getMonth:c}=s;return l({start:a(e),end:o(e)}).map(h=>{const m=r.formatMonthDropdown(h,s),y=c(h),b=t&&h<i(t)||n&&h>i(n)||!1;return{value:y,label:m,disabled:b}})}function wWe(e,t={},n={}){let r={...t==null?void 0:t[$n.Day]};return Object.entries(e).filter(([,s])=>s===!0).forEach(([s])=>{r={...r,...n==null?void 0:n[s]}}),r}function _We(e,t,n){const r=e.today(),s=t?e.startOfISOWeek(r):e.startOfWeek(r),i=[];for(let a=0;a<7;a++){const o=e.addDays(s,a);i.push(o)}return i}function SWe(e,t,n,r){if(!e||!t)return;const{startOfYear:s,endOfYear:i,addYears:a,getYear:o,isBefore:l,isSameYear:c}=r,u=s(e),d=i(t),h=[];let m=u;for(;l(m,d)||c(m,d);)h.push(m),m=a(m,1);return h.map(y=>{const b=n.formatYearDropdown(y,r);return{value:o(y),label:b,disabled:!1}})}function cie(e,t,n){return(n??new vf(t)).format(e,"LLLL y")}const CWe=cie;function kWe(e,t,n,r){let s=(r??new vf(n)).format(e,"PPPP");return t!=null&&t.today&&(s=`Today, ${s}`),s}function uie(e,t,n,r){let s=(r??new vf(n)).format(e,"PPPP");return t.today&&(s=`Today, ${s}`),t.selected&&(s=`${s}, selected`),s}const EWe=uie;function TWe(){return""}function AWe(e){return"Choose the Month"}function RWe(e){return"Go to the Next Month"}function NWe(e){return"Go to the Previous Month"}function MWe(e,t,n){return(n??new vf(t)).format(e,"cccc")}function IWe(e,t){return`Week ${e}`}function jWe(e){return"Week Number"}function PWe(e){return"Choose the Year"}const OWe=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:CWe,labelDay:EWe,labelDayButton:uie,labelGrid:cie,labelGridcell:kWe,labelMonthDropdown:AWe,labelNav:TWe,labelNext:RWe,labelPrevious:NWe,labelWeekNumber:IWe,labelWeekNumberHeader:jWe,labelWeekday:MWe,labelYearDropdown:PWe},Symbol.toStringTag,{value:"Module"})),c_=e=>e instanceof HTMLElement?e:null,w3=e=>[...e.querySelectorAll("[data-animated-month]")??[]],DWe=e=>c_(e.querySelector("[data-animated-month]")),_3=e=>c_(e.querySelector("[data-animated-caption]")),S3=e=>c_(e.querySelector("[data-animated-weeks]")),FWe=e=>c_(e.querySelector("[data-animated-nav]")),LWe=e=>c_(e.querySelector("[data-animated-weekdays]"));function BWe(e,t,{classNames:n,months:r,focused:s,dateLib:i}){const a=E.useRef(null),o=E.useRef(r),l=E.useRef(!1);E.useLayoutEffect(()=>{const c=o.current;if(o.current=r,!t||!e.current||!(e.current instanceof HTMLElement)||r.length===0||c.length===0||r.length!==c.length)return;const u=i.isSameMonth(r[0].date,c[0].date),d=i.isAfter(r[0].date,c[0].date),h=d?n[cl.caption_after_enter]:n[cl.caption_before_enter],m=d?n[cl.weeks_after_enter]:n[cl.weeks_before_enter],y=a.current,b=e.current.cloneNode(!0);if(b instanceof HTMLElement?(w3(b).forEach(S=>{if(!(S instanceof HTMLElement))return;const k=DWe(S);k&&S.contains(k)&&S.removeChild(k);const C=_3(S);C&&C.classList.remove(h);const T=S3(S);T&&T.classList.remove(m)}),a.current=b):a.current=null,l.current||u||s)return;const v=y instanceof HTMLElement?w3(y):[],x=w3(e.current);if(x&&x.every(w=>w instanceof HTMLElement)&&v&&v.every(w=>w instanceof HTMLElement)){l.current=!0,e.current.style.isolation="isolate";const w=FWe(e.current);w&&(w.style.zIndex="1"),x.forEach((S,k)=>{const C=v[k];if(!C)return;S.style.position="relative",S.style.overflow="hidden";const T=_3(S);T&&T.classList.add(h);const A=S3(S);A&&A.classList.add(m);const N=()=>{l.current=!1,e.current&&(e.current.style.isolation=""),w&&(w.style.zIndex=""),T&&T.classList.remove(h),A&&A.classList.remove(m),S.style.position="",S.style.overflow="",S.contains(C)&&S.removeChild(C)};C.style.pointerEvents="none",C.style.position="absolute",C.style.overflow="hidden",C.setAttribute("aria-hidden","true");const I=LWe(C);I&&(I.style.opacity="0");const O=_3(C);O&&(O.classList.add(d?n[cl.caption_before_exit]:n[cl.caption_after_exit]),O.addEventListener("animationend",N));const B=S3(C);B&&B.classList.add(d?n[cl.weeks_before_exit]:n[cl.weeks_after_exit]),S.insertBefore(C,S.firstChild)})}})}function $We(e,t,n,r){const s=e[0],i=e[e.length-1],{ISOWeek:a,fixedWeeks:o,broadcastCalendar:l}=n??{},{addDays:c,differenceInCalendarDays:u,differenceInCalendarMonths:d,endOfBroadcastWeek:h,endOfISOWeek:m,endOfMonth:y,endOfWeek:b,isAfter:v,startOfBroadcastWeek:x,startOfISOWeek:w,startOfWeek:S}=r,k=l?x(s,r):a?w(s):S(s),C=l?h(i):a?m(y(i)):b(y(i)),T=u(C,k),A=d(i,s)+1,N=[];for(let B=0;B<=T;B++){const D=c(k,B);if(t&&v(D,t))break;N.push(D)}const O=(l?35:42)*A;if(o&&N.length<O){const B=O-N.length;for(let D=0;D<B;D++){const H=c(N[N.length-1],1);N.push(H)}}return N}function zWe(e){const t=[];return e.reduce((n,r)=>{const s=r.weeks.reduce((i,a)=>[...i,...a.days],t);return[...n,...s]},t)}function UWe(e,t,n,r){const{numberOfMonths:s=1}=n,i=[];for(let a=0;a<s;a++){const o=r.addMonths(e,a);if(t&&o>t)break;i.push(o)}return i}function Wq(e,t){const{month:n,defaultMonth:r,today:s=t.today(),numberOfMonths:i=1,endMonth:a,startMonth:o}=e;let l=n||r||s;const{differenceInCalendarMonths:c,addMonths:u,startOfMonth:d}=t;if(a&&c(a,l)<0){const h=-1*(i-1);l=u(a,h)}return o&&c(l,o)<0&&(l=o),d(l)}function qWe(e,t,n,r){const{addDays:s,endOfBroadcastWeek:i,endOfISOWeek:a,endOfMonth:o,endOfWeek:l,getISOWeek:c,getWeek:u,startOfBroadcastWeek:d,startOfISOWeek:h,startOfWeek:m}=r,y=e.reduce((b,v)=>{const x=n.broadcastCalendar?d(v,r):n.ISOWeek?h(v):m(v),w=n.broadcastCalendar?i(v):n.ISOWeek?a(o(v)):l(o(v)),S=t.filter(A=>A>=x&&A<=w),k=n.broadcastCalendar?35:42;if(n.fixedWeeks&&S.length<k){const A=t.filter(N=>{const I=k-S.length;return N>w&&N<=s(w,I)});S.push(...A)}const C=S.reduce((A,N)=>{const I=n.ISOWeek?c(N):u(N),O=A.find(D=>D.weekNumber===I),B=new eie(N,v,r);return O?O.days.push(B):A.push(new jVe(I,[B])),A},[]),T=new IVe(v,C);return b.push(T),b},[]);return n.reverseMonths?y.reverse():y}function VWe(e,t){let{startMonth:n,endMonth:r}=e;const{startOfYear:s,startOfDay:i,startOfMonth:a,endOfMonth:o,addYears:l,endOfYear:c,newDate:u,today:d}=t,{fromYear:h,toYear:m,fromMonth:y,toMonth:b}=e;!n&&y&&(n=y),!n&&h&&(n=t.newDate(h,0,1)),!r&&b&&(r=b),!r&&m&&(r=u(m,11,31));const v=e.captionLayout==="dropdown"||e.captionLayout==="dropdown-years";return n?n=a(n):h?n=u(h,0,1):!n&&v&&(n=s(l(e.today??d(),-100))),r?r=o(r):m?r=u(m,11,31):!r&&v&&(r=c(e.today??d())),[n&&i(n),r&&i(r)]}function WWe(e,t,n,r){if(n.disableNavigation)return;const{pagedNavigation:s,numberOfMonths:i=1}=n,{startOfMonth:a,addMonths:o,differenceInCalendarMonths:l}=r,c=s?i:1,u=a(e);if(!t)return o(u,c);if(!(l(t,e)<i))return o(u,c)}function HWe(e,t,n,r){if(n.disableNavigation)return;const{pagedNavigation:s,numberOfMonths:i}=n,{startOfMonth:a,addMonths:o,differenceInCalendarMonths:l}=r,c=s?i??1:1,u=a(e);if(!t)return o(u,-c);if(!(l(u,t)<=0))return o(u,-c)}function GWe(e){const t=[];return e.reduce((n,r)=>[...n,...r.weeks],t)}function XT(e,t){const[n,r]=E.useState(e);return[t===void 0?n:t,r]}function KWe(e,t){const[n,r]=VWe(e,t),{startOfMonth:s,endOfMonth:i}=t,a=Wq(e,t),[o,l]=XT(a,e.month?a:void 0);E.useEffect(()=>{const T=Wq(e,t);l(T)},[e.timeZone]);const c=UWe(o,r,e,t),u=$We(c,e.endMonth?i(e.endMonth):void 0,e,t),d=qWe(c,u,e,t),h=GWe(d),m=zWe(d),y=HWe(o,n,e,t),b=WWe(o,r,e,t),{disableNavigation:v,onMonthChange:x}=e,w=T=>h.some(A=>A.days.some(N=>N.isEqualTo(T))),S=T=>{if(v)return;let A=s(T);n&&A<s(n)&&(A=s(n)),r&&A>s(r)&&(A=s(r)),l(A),x==null||x(A)};return{months:d,weeks:h,days:m,navStart:n,navEnd:r,previousMonth:y,nextMonth:b,goToMonth:S,goToDay:T=>{w(T)||S(T.date)}}}var fu;(function(e){e[e.Today=0]="Today",e[e.Selected=1]="Selected",e[e.LastFocused=2]="LastFocused",e[e.FocusedModifier=3]="FocusedModifier"})(fu||(fu={}));function Hq(e){return!e[Qs.disabled]&&!e[Qs.hidden]&&!e[Qs.outside]}function YWe(e,t,n,r){let s,i=-1;for(const a of e){const o=t(a);Hq(o)&&(o[Qs.focused]&&i<fu.FocusedModifier?(s=a,i=fu.FocusedModifier):r!=null&&r.isEqualTo(a)&&i<fu.LastFocused?(s=a,i=fu.LastFocused):n(a.date)&&i<fu.Selected?(s=a,i=fu.Selected):o[Qs.today]&&i<fu.Today&&(s=a,i=fu.Today))}return s||(s=e.find(a=>Hq(t(a)))),s}function ZWe(e,t,n,r,s,i,a){const{ISOWeek:o,broadcastCalendar:l}=i,{addDays:c,addMonths:u,addWeeks:d,addYears:h,endOfBroadcastWeek:m,endOfISOWeek:y,endOfWeek:b,max:v,min:x,startOfBroadcastWeek:w,startOfISOWeek:S,startOfWeek:k}=a;let T={day:c,week:d,month:u,year:h,startOfWeek:A=>l?w(A,a):o?S(A):k(A),endOfWeek:A=>l?m(A):o?y(A):b(A)}[e](n,t==="after"?1:-1);return t==="before"&&r?T=v([r,T]):t==="after"&&s&&(T=x([s,T])),T}function die(e,t,n,r,s,i,a,o=0){if(o>365)return;const l=ZWe(e,t,n.date,r,s,i,a),c=!!(i.disabled&&Od(l,i.disabled,a)),u=!!(i.hidden&&Od(l,i.hidden,a)),d=l,h=new eie(l,d,a);return!c&&!u?h:die(e,t,h,r,s,i,a,o+1)}function XWe(e,t,n,r,s){const{autoFocus:i}=e,[a,o]=E.useState(),l=YWe(t.days,n,r||(()=>!1),a),[c,u]=E.useState(i?l:void 0);return{isFocusTarget:b=>!!(l!=null&&l.isEqualTo(b)),setFocused:u,focused:c,blur:()=>{o(c),u(void 0)},moveFocus:(b,v)=>{if(!c)return;const x=die(b,v,c,t.navStart,t.navEnd,e,s);x&&(t.goToDay(x),u(x))}}}function JWe(e,t){const{selected:n,required:r,onSelect:s}=e,[i,a]=XT(n,s?n:void 0),o=s?n:i,{isSameDay:l}=t,c=m=>(o==null?void 0:o.some(y=>l(y,m)))??!1,{min:u,max:d}=e;return{selected:o,select:(m,y,b)=>{let v=[...o??[]];if(c(m)){if((o==null?void 0:o.length)===u||r&&(o==null?void 0:o.length)===1)return;v=o==null?void 0:o.filter(x=>!l(x,m))}else(o==null?void 0:o.length)===d?v=[m]:v=[...v,m];return s||a(v),s==null||s(v,m,y,b),v},isSelected:c}}function QWe(e,t,n=0,r=0,s=!1,i=Gu){const{from:a,to:o}=t||{},{isSameDay:l,isAfter:c,isBefore:u}=i;let d;if(!a&&!o)d={from:e,to:n>0?void 0:e};else if(a&&!o)l(a,e)?s?d={from:a,to:void 0}:d=void 0:u(e,a)?d={from:e,to:a}:d={from:a,to:e};else if(a&&o)if(l(a,e)&&l(o,e))s?d={from:a,to:o}:d=void 0;else if(l(a,e))d={from:a,to:n>0?void 0:e};else if(l(o,e))d={from:e,to:n>0?void 0:e};else if(u(e,a))d={from:e,to:o};else if(c(e,a))d={from:a,to:e};else if(c(e,o))d={from:a,to:e};else throw new Error("Invalid range");if(d!=null&&d.from&&(d!=null&&d.to)){const h=i.differenceInCalendarDays(d.to,d.from);r>0&&h>r?d={from:e,to:void 0}:n>1&&h<n&&(d={from:e,to:void 0})}return d}function eHe(e,t,n=Gu){const r=Array.isArray(t)?t:[t];let s=e.from;const i=n.differenceInCalendarDays(e.to,e.from),a=Math.min(i,6);for(let o=0;o<=a;o++){if(r.includes(s.getDay()))return!0;s=n.addDays(s,1)}return!1}function Gq(e,t,n=Gu){return Pd(e,t.from,!1,n)||Pd(e,t.to,!1,n)||Pd(t,e.from,!1,n)||Pd(t,e.to,!1,n)}function tHe(e,t,n=Gu){const r=Array.isArray(t)?t:[t];if(r.filter(o=>typeof o!="function").some(o=>typeof o=="boolean"?o:n.isDate(o)?Pd(e,o,!1,n):iie(o,n)?o.some(l=>Pd(e,l,!1,n)):i6(o)?o.from&&o.to?Gq(e,{from:o.from,to:o.to},n):!1:sie(o)?eHe(e,o.dayOfWeek,n):tie(o)?n.isAfter(o.before,o.after)?Gq(e,{from:n.addDays(o.after,1),to:n.addDays(o.before,-1)},n):Od(e.from,o,n)||Od(e.to,o,n):nie(o)||rie(o)?Od(e.from,o,n)||Od(e.to,o,n):!1))return!0;const a=r.filter(o=>typeof o=="function");if(a.length){let o=e.from;const l=n.differenceInCalendarDays(e.to,e.from);for(let c=0;c<=l;c++){if(a.some(u=>u(o)))return!0;o=n.addDays(o,1)}}return!1}function nHe(e,t){const{disabled:n,excludeDisabled:r,selected:s,required:i,onSelect:a}=e,[o,l]=XT(s,a?s:void 0),c=a?s:o;return{selected:c,select:(h,m,y)=>{const{min:b,max:v}=e,x=h?QWe(h,c,b,v,i,t):void 0;return r&&n&&(x!=null&&x.from)&&x.to&&tHe({from:x.from,to:x.to},n,t)&&(x.from=h,x.to=void 0),a||l(x),a==null||a(x,h,m,y),x},isSelected:h=>c&&Pd(c,h,!1,t)}}function rHe(e,t){const{selected:n,required:r,onSelect:s}=e,[i,a]=XT(n,s?n:void 0),o=s?n:i,{isSameDay:l}=t;return{selected:o,select:(d,h,m)=>{let y=d;return!r&&o&&o&&l(d,o)&&(y=void 0),s||a(y),s==null||s(y,d,h,m),y},isSelected:d=>o?l(o,d):!1}}function sHe(e,t){const n=rHe(e,t),r=JWe(e,t),s=nHe(e,t);switch(e.mode){case"single":return n;case"multiple":return r;case"range":return s;default:return}}function iHe(e){var ft;let t=e;t.timeZone&&(t={...e},t.today&&(t.today=new Oa(t.today,t.timeZone)),t.month&&(t.month=new Oa(t.month,t.timeZone)),t.defaultMonth&&(t.defaultMonth=new Oa(t.defaultMonth,t.timeZone)),t.startMonth&&(t.startMonth=new Oa(t.startMonth,t.timeZone)),t.endMonth&&(t.endMonth=new Oa(t.endMonth,t.timeZone)),t.mode==="single"&&t.selected?t.selected=new Oa(t.selected,t.timeZone):t.mode==="multiple"&&t.selected?t.selected=(ft=t.selected)==null?void 0:ft.map(et=>new Oa(et,t.timeZone)):t.mode==="range"&&t.selected&&(t.selected={from:t.selected.from?new Oa(t.selected.from,t.timeZone):void 0,to:t.selected.to?new Oa(t.selected.to,t.timeZone):void 0}));const{components:n,formatters:r,labels:s,dateLib:i,locale:a,classNames:o}=E.useMemo(()=>{const et={...mT,...t.locale};return{dateLib:new vf({locale:et,weekStartsOn:t.broadcastCalendar?1:t.weekStartsOn,firstWeekContainsDate:t.firstWeekContainsDate,useAdditionalWeekYearTokens:t.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:t.useAdditionalDayOfYearTokens,timeZone:t.timeZone,numerals:t.numerals},t.dateLib),components:cWe(t.components),formatters:vWe(t.formatters),labels:{...OWe,...t.labels},locale:et,classNames:{...a6(),...t.classNames}}},[t.locale,t.broadcastCalendar,t.weekStartsOn,t.firstWeekContainsDate,t.useAdditionalWeekYearTokens,t.useAdditionalDayOfYearTokens,t.timeZone,t.numerals,t.dateLib,t.components,t.formatters,t.labels,t.classNames]),{captionLayout:l,mode:c,navLayout:u,numberOfMonths:d=1,onDayBlur:h,onDayClick:m,onDayFocus:y,onDayKeyDown:b,onDayMouseEnter:v,onDayMouseLeave:x,onNextClick:w,onPrevClick:S,showWeekNumber:k,styles:C}=t,{formatCaption:T,formatDay:A,formatMonthDropdown:N,formatWeekNumber:I,formatWeekNumberHeader:O,formatWeekdayName:B,formatYearDropdown:D}=r,H=KWe(t,i),{days:P,months:K,navStart:U,navEnd:V,previousMonth:L,nextMonth:te,goToMonth:W}=H,Q=PVe(P,t,i),{isSelected:ee,select:re,selected:pe}=sHe(t,i)??{},{blur:de,focused:Oe,isFocusTarget:Fe,moveFocus:Se,setFocused:Ce}=XWe(t,H,Q,ee??(()=>!1),i),{labelDayButton:qe,labelGridcell:Qe,labelGrid:We,labelMonthDropdown:je,labelNav:Y,labelPrevious:ye,labelNext:Ie,labelWeekday:ce,labelWeekNumber:oe,labelWeekNumberHeader:se,labelYearDropdown:Me}=s,Be=E.useMemo(()=>_We(i,t.ISOWeek),[i,t.ISOWeek]),Ae=c!==void 0||m!==void 0,lt=E.useCallback(()=>{L&&(W(L),S==null||S(L))},[L,W,S]),Tt=E.useCallback(()=>{te&&(W(te),w==null||w(te))},[W,te,w]),dt=E.useCallback((et,$)=>Ue=>{Ue.preventDefault(),Ue.stopPropagation(),Ce(et),re==null||re(et.date,$,Ue),m==null||m(et.date,$,Ue)},[re,m,Ce]),Pt=E.useCallback((et,$)=>Ue=>{Ce(et),y==null||y(et.date,$,Ue)},[y,Ce]),qt=E.useCallback((et,$)=>Ue=>{de(),h==null||h(et.date,$,Ue)},[de,h]),Ft=E.useCallback((et,$)=>Ue=>{const tt={ArrowLeft:["day",t.dir==="rtl"?"after":"before"],ArrowRight:["day",t.dir==="rtl"?"before":"after"],ArrowDown:["week","after"],ArrowUp:["week","before"],PageUp:[Ue.shiftKey?"year":"month","before"],PageDown:[Ue.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(tt[Ue.key]){Ue.preventDefault(),Ue.stopPropagation();const[ve,_e]=tt[Ue.key];Se(ve,_e)}b==null||b(et.date,$,Ue)},[Se,b,t.dir]),Ht=E.useCallback((et,$)=>Ue=>{v==null||v(et.date,$,Ue)},[v]),we=E.useCallback((et,$)=>Ue=>{x==null||x(et.date,$,Ue)},[x]),F=E.useCallback(et=>$=>{const Ue=Number($.target.value),tt=i.setMonth(i.startOfMonth(et),Ue);W(tt)},[i,W]),X=E.useCallback(et=>$=>{const Ue=Number($.target.value),tt=i.setYear(i.startOfMonth(et),Ue);W(tt)},[i,W]),{className:be,style:ke}=E.useMemo(()=>({className:[o[$n.Root],t.className].filter(Boolean).join(" "),style:{...C==null?void 0:C[$n.Root],...t.style}}),[o,t.className,t.style,C]),ge=uWe(t),Ee=E.useRef(null);BWe(Ee,!!t.animate,{classNames:o,months:K,focused:Oe,dateLib:i});const le={dayPickerProps:t,selected:pe,select:re,isSelected:ee,months:K,nextMonth:te,previousMonth:L,goToMonth:W,getModifiers:Q,components:n,classNames:o,styles:C,labels:s,formatters:r};return Ve.createElement(aie.Provider,{value:le},Ve.createElement(n.Root,{rootRef:t.animate?Ee:void 0,className:be,style:ke,dir:t.dir,id:t.id,lang:t.lang,nonce:t.nonce,title:t.title,role:t.role,"aria-label":t["aria-label"],...ge},Ve.createElement(n.Months,{className:o[$n.Months],style:C==null?void 0:C[$n.Months]},!t.hideNavigation&&!u&&Ve.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:o[$n.Nav],style:C==null?void 0:C[$n.Nav],"aria-label":Y(),onPreviousClick:lt,onNextClick:Tt,previousMonth:L,nextMonth:te}),K.map((et,$)=>{const Ue=xWe(et.date,U,V,r,i),tt=SWe(U,V,r,i);return Ve.createElement(n.Month,{"data-animated-month":t.animate?"true":void 0,className:o[$n.Month],style:C==null?void 0:C[$n.Month],key:$,displayIndex:$,calendarMonth:et},u==="around"&&!t.hideNavigation&&$===0&&Ve.createElement(n.PreviousMonthButton,{type:"button",className:o[$n.PreviousMonthButton],tabIndex:L?void 0:-1,"aria-disabled":L?void 0:!0,"aria-label":ye(L),onClick:lt,"data-animated-button":t.animate?"true":void 0},Ve.createElement(n.Chevron,{disabled:L?void 0:!0,className:o[$n.Chevron],orientation:t.dir==="rtl"?"right":"left"})),Ve.createElement(n.MonthCaption,{"data-animated-caption":t.animate?"true":void 0,className:o[$n.MonthCaption],style:C==null?void 0:C[$n.MonthCaption],calendarMonth:et,displayIndex:$},l!=null&&l.startsWith("dropdown")?Ve.createElement(n.DropdownNav,{className:o[$n.Dropdowns],style:C==null?void 0:C[$n.Dropdowns]},l==="dropdown"||l==="dropdown-months"?Ve.createElement(n.MonthsDropdown,{className:o[$n.MonthsDropdown],"aria-label":je(),classNames:o,components:n,disabled:!!t.disableNavigation,onChange:F(et.date),options:Ue,style:C==null?void 0:C[$n.Dropdown],value:i.getMonth(et.date)}):Ve.createElement("span",null,N(et.date,i)),l==="dropdown"||l==="dropdown-years"?Ve.createElement(n.YearsDropdown,{className:o[$n.YearsDropdown],"aria-label":Me(i.options),classNames:o,components:n,disabled:!!t.disableNavigation,onChange:X(et.date),options:tt,style:C==null?void 0:C[$n.Dropdown],value:i.getYear(et.date)}):Ve.createElement("span",null,D(et.date,i)),Ve.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},T(et.date,i.options,i))):Ve.createElement(n.CaptionLabel,{className:o[$n.CaptionLabel],role:"status","aria-live":"polite"},T(et.date,i.options,i))),u==="around"&&!t.hideNavigation&&$===d-1&&Ve.createElement(n.NextMonthButton,{type:"button",className:o[$n.NextMonthButton],tabIndex:te?void 0:-1,"aria-disabled":te?void 0:!0,"aria-label":Ie(te),onClick:Tt,"data-animated-button":t.animate?"true":void 0},Ve.createElement(n.Chevron,{disabled:te?void 0:!0,className:o[$n.Chevron],orientation:t.dir==="rtl"?"left":"right"})),$===d-1&&u==="after"&&!t.hideNavigation&&Ve.createElement(n.Nav,{"data-animated-nav":t.animate?"true":void 0,className:o[$n.Nav],style:C==null?void 0:C[$n.Nav],"aria-label":Y(),onPreviousClick:lt,onNextClick:Tt,previousMonth:L,nextMonth:te}),Ve.createElement(n.MonthGrid,{role:"grid","aria-multiselectable":c==="multiple"||c==="range","aria-label":We(et.date,i.options,i)||void 0,className:o[$n.MonthGrid],style:C==null?void 0:C[$n.MonthGrid]},!t.hideWeekdays&&Ve.createElement(n.Weekdays,{"data-animated-weekdays":t.animate?"true":void 0,className:o[$n.Weekdays],style:C==null?void 0:C[$n.Weekdays]},k&&Ve.createElement(n.WeekNumberHeader,{"aria-label":se(i.options),className:o[$n.WeekNumberHeader],style:C==null?void 0:C[$n.WeekNumberHeader],scope:"col"},O()),Be.map((ve,_e)=>Ve.createElement(n.Weekday,{"aria-label":ce(ve,i.options,i),className:o[$n.Weekday],key:_e,style:C==null?void 0:C[$n.Weekday],scope:"col"},B(ve,i.options,i)))),Ve.createElement(n.Weeks,{"data-animated-weeks":t.animate?"true":void 0,className:o[$n.Weeks],style:C==null?void 0:C[$n.Weeks]},et.weeks.map((ve,_e)=>Ve.createElement(n.Week,{className:o[$n.Week],key:ve.weekNumber,style:C==null?void 0:C[$n.Week],week:ve},k&&Ve.createElement(n.WeekNumber,{week:ve,style:C==null?void 0:C[$n.WeekNumber],"aria-label":oe(ve.weekNumber,{locale:a}),className:o[$n.WeekNumber],scope:"row",role:"rowheader"},I(ve.weekNumber,i)),ve.days.map(ze=>{const{date:Ct}=ze,fe=Q(ze);if(fe[Qs.focused]=!fe.hidden&&!!(Oe!=null&&Oe.isEqualTo(ze)),fe[kc.selected]=(ee==null?void 0:ee(Ct))||fe.selected,i6(pe)){const{from:xe,to:De}=pe;fe[kc.range_start]=!!(xe&&De&&i.isSameDay(Ct,xe)),fe[kc.range_end]=!!(xe&&De&&i.isSameDay(Ct,De)),fe[kc.range_middle]=Pd(pe,Ct,!0,i)}const Z=wWe(fe,C,t.modifiersStyles),G=OVe(fe,o,t.modifiersClassNames),J=!Ae&&!fe.hidden?Qe(Ct,fe,i.options,i):void 0;return Ve.createElement(n.Day,{key:`${i.format(Ct,"yyyy-MM-dd")}_${i.format(ze.displayMonth,"yyyy-MM")}`,day:ze,modifiers:fe,className:G.join(" "),style:Z,role:"gridcell","aria-selected":fe.selected||void 0,"aria-label":J,"data-day":i.format(Ct,"yyyy-MM-dd"),"data-month":ze.outside?i.format(Ct,"yyyy-MM"):void 0,"data-selected":fe.selected||void 0,"data-disabled":fe.disabled||void 0,"data-hidden":fe.hidden||void 0,"data-outside":ze.outside||void 0,"data-focused":fe.focused||void 0,"data-today":fe.today||void 0},!fe.hidden&&Ae?Ve.createElement(n.DayButton,{className:o[$n.DayButton],style:C==null?void 0:C[$n.DayButton],type:"button",day:ze,modifiers:fe,disabled:fe.disabled||void 0,tabIndex:Fe(ze)?0:-1,"aria-label":qe(Ct,fe,i.options,i),onClick:dt(ze,fe),onBlur:qt(ze,fe),onFocus:Pt(ze,fe),onKeyDown:Ft(ze,fe),onMouseEnter:Ht(ze,fe),onMouseLeave:we(ze,fe)},A(Ct,i.options,i)):!fe.hidden&&A(ze.date,i.options,i))}))))))})),t.footer&&Ve.createElement(n.Footer,{className:o[$n.Footer],style:C==null?void 0:C[$n.Footer],role:"status","aria-live":"polite"},t.footer)))}function aHe({className:e,classNames:t,showOutsideDays:n=!0,captionLayout:r="label",buttonVariant:s="ghost",formatters:i,components:a,...o}){const l=a6();return f.jsx(iHe,{showOutsideDays:n,className:Ze("bg-background group/calendar p-3 [--cell-size:--spacing(8)] [[data-slot=card-content]_&]:bg-transparent [[data-slot=popover-content]_&]:bg-transparent",String.raw`rtl:**:[.rdp-button\_next>svg]:rotate-180`,String.raw`rtl:**:[.rdp-button\_previous>svg]:rotate-180`,e),captionLayout:r,formatters:{formatMonthDropdown:c=>c.toLocaleString("default",{month:"short"}),...i},classNames:{root:Ze("w-fit",l.root),months:Ze("flex gap-4 flex-col md:flex-row relative",l.months),month:Ze("flex flex-col w-full gap-4",l.month),nav:Ze("flex items-center gap-1 w-full absolute top-0 inset-x-0 justify-between",l.nav),button_previous:Ze(tj({variant:s}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",l.button_previous),button_next:Ze(tj({variant:s}),"size-(--cell-size) aria-disabled:opacity-50 p-0 select-none",l.button_next),month_caption:Ze("flex items-center justify-center h-(--cell-size) w-full px-(--cell-size)",l.month_caption),dropdowns:Ze("w-full flex items-center text-sm font-medium justify-center h-(--cell-size) gap-1.5",l.dropdowns),dropdown_root:Ze("relative has-focus:border-ring border border-input shadow-xs has-focus:ring-ring/50 has-focus:ring-[3px] rounded-md",l.dropdown_root),dropdown:Ze("absolute inset-0 opacity-0",l.dropdown),caption_label:Ze("select-none font-medium",r==="label"?"text-sm":"rounded-md pl-2 pr-1 flex items-center gap-1 text-sm h-8 [&>svg]:text-muted-foreground [&>svg]:size-3.5",l.caption_label),table:"w-full border-collapse",weekdays:Ze("flex",l.weekdays),weekday:Ze("text-muted-foreground rounded-md flex-1 font-normal text-[0.8rem] select-none",l.weekday),week:Ze("flex w-full mt-2",l.week),week_number_header:Ze("select-none w-(--cell-size)",l.week_number_header),week_number:Ze("text-[0.8rem] select-none text-muted-foreground",l.week_number),day:Ze("relative w-full h-full p-0 text-center [&:first-child[data-selected=true]_button]:rounded-l-md [&:last-child[data-selected=true]_button]:rounded-r-md group/day aspect-square select-none",l.day),range_start:Ze("rounded-l-md bg-accent",l.range_start),range_middle:Ze("rounded-none",l.range_middle),range_end:Ze("rounded-r-md bg-accent",l.range_end),today:Ze("bg-accent text-accent-foreground rounded-md data-[selected=true]:rounded-none",l.today),outside:Ze("text-muted-foreground aria-selected:text-muted-foreground",l.outside),disabled:Ze("text-muted-foreground opacity-50",l.disabled),hidden:Ze("invisible",l.hidden),...t},components:{Root:({className:c,rootRef:u,...d})=>f.jsx("div",{"data-slot":"calendar",ref:u,className:Ze(c),...d}),Chevron:({className:c,orientation:u,...d})=>u==="left"?f.jsx($pe,{className:Ze("size-4",c),...d}):u==="right"?f.jsx(VP,{className:Ze("size-4",c),...d}):f.jsx(Ql,{className:Ze("size-4",c),...d}),DayButton:oHe,WeekNumber:({children:c,...u})=>f.jsx("td",{...u,children:f.jsx("div",{className:"flex size-(--cell-size) items-center justify-center text-center",children:c})}),...a},...o})}function oHe({className:e,day:t,modifiers:n,...r}){const s=a6(),i=E.useRef(null);return E.useEffect(()=>{var a;n.focused&&((a=i.current)==null||a.focus())},[n.focused]),f.jsx(ct,{ref:i,variant:"ghost",size:"icon","data-day":t.date.toLocaleDateString(),"data-selected-single":n.selected&&!n.range_start&&!n.range_end&&!n.range_middle,"data-range-start":n.range_start,"data-range-end":n.range_end,"data-range-middle":n.range_middle,className:Ze("data-[selected-single=true]:bg-primary data-[selected-single=true]:text-primary-foreground data-[range-middle=true]:bg-accent data-[range-middle=true]:text-accent-foreground data-[range-start=true]:bg-primary data-[range-start=true]:text-primary-foreground data-[range-end=true]:bg-primary data-[range-end=true]:text-primary-foreground group-data-[focused=true]/day:border-ring group-data-[focused=true]/day:ring-ring/50 dark:hover:text-accent-foreground flex aspect-square size-auto w-full min-w-(--cell-size) flex-col gap-1 leading-none font-normal group-data-[focused=true]/day:relative group-data-[focused=true]/day:z-10 group-data-[focused=true]/day:ring-[3px] data-[range-end=true]:rounded-md data-[range-end=true]:rounded-r-md data-[range-middle=true]:rounded-none data-[range-start=true]:rounded-md data-[range-start=true]:rounded-l-md [&>span]:text-xs [&>span]:opacity-70",s.day,e),...r})}const lHe=({fieldApi:e,label:t,placeholder:n="Pick a date",description:r,inputClassName:s,labelClassName:i,wrapperClassName:a})=>{const[o,l]=Ve.useState(!1),c=e.state.value?e.state.value instanceof Date?e.state.value:typeof e.state.value=="string"?eRe(e.state.value):void 0:void 0,u=d=>{e.handleChange(d),e.handleBlur(),l(!1)};return f.jsxs("div",{className:Ze("space-y-1.5",a),children:[t&&f.jsx(jt,{htmlFor:e.name+"-trigger",className:Ze("text-sm font-medium",i),children:t}),r&&f.jsx("p",{className:"text-xs text-muted-foreground",children:r}),f.jsxs(ic,{open:o,onOpenChange:l,children:[f.jsx(ac,{asChild:!0,children:f.jsxs(ct,{id:e.name+"-trigger",variant:"outline",className:Ze("w-full justify-start text-left font-normal",!c&&"text-muted-foreground",s,e.state.meta.errors.length?"border-destructive":""),disabled:e.form.state.isSubmitting,onBlur:e.handleBlur,children:[f.jsx(Ppe,{className:"mr-2 h-4 w-4"}),c?jd(c,"PPP"):f.jsx("span",{children:n})]})}),f.jsx(oc,{className:"w-auto p-0",children:f.jsx(aHe,{mode:"single",selected:c,onSelect:u,initialFocus:!0,disabled:e.form.state.isSubmitting})})]}),e.state.meta.isTouched&&e.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:e.state.meta.errors.map((d,h)=>f.jsx("p",{children:String(d)},h))})]})},cHe=({fieldApi:e,label:t,description:n,min:r=0,max:s=100,step:i=1,valueLabelPrefix:a="",valueLabelSuffix:o="",valueDisplayPrecision:l=0,showRawValue:c=!1,wrapperClassName:u,inputClassName:d,labelClassName:h})=>{const{name:m,state:y,handleChange:b,handleBlur:v}=e,x=typeof y.value=="number"?y.value:r,w=x.toFixed(l);return f.jsxs("div",{className:Ze("space-y-1.5",u),children:[t&&f.jsxs(jt,{htmlFor:m,className:Ze("text-sm font-medium",h),children:[t," (",a,w,o,")",c&&f.jsxs("span",{className:"text-xs text-muted-foreground ml-2",children:["(Raw: ",y.value,")"]})]}),n&&f.jsx("p",{className:"text-xs text-muted-foreground",children:n}),f.jsx(I0,{id:m,name:m,value:[x],onValueChange:S=>b(S[0]),onBlur:v,disabled:e.form.state.isSubmitting,min:r,max:s,step:i,className:Ze(d,y.meta.errors.length?"border-destructive":"")}),y.meta.isTouched&&y.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:y.meta.errors.map((S,k)=>f.jsx("p",{children:typeof S=="string"?S:(S==null?void 0:S.message)||"Invalid"},k))})]})},uHe=({fieldApi:e,label:t,accept:n,className:r,wrapperClassName:s,description:i})=>{const{name:a,state:o,handleChange:l,handleBlur:c}=e,u=o.value,d=y=>{var v;const b=((v=y.target.files)==null?void 0:v[0])??null;l(b),c()},h=()=>{l(null);const y=document.getElementById(a);y&&(y.value=""),c()},m=()=>{const y=document.getElementById(a);y==null||y.click()};return f.jsxs("div",{className:Ze("space-y-1.5",s),children:[t&&f.jsx(jt,{className:"text-sm font-medium cursor-pointer",onClick:m,children:t}),i&&f.jsx("p",{className:"text-xs text-muted-foreground",children:i}),f.jsx(xn,{id:a,name:a,type:"file",accept:n,onChange:d,className:"hidden"}),u?f.jsxs("div",{className:"flex items-center justify-between p-2.5 border rounded-lg bg-muted/40 shadow-sm hover:shadow-md transition-shadow",children:[f.jsxs("div",{className:"flex items-center gap-2 text-sm overflow-hidden",children:[f.jsx(SE,{className:"h-5 w-5 text-primary shrink-0"}),f.jsx("span",{className:"truncate",title:u.name,children:u.name}),f.jsxs("span",{className:"text-xs text-muted-foreground whitespace-nowrap",children:["(",(u.size/1024).toFixed(1)," KB)"]})]}),f.jsx(ct,{type:"button",variant:"ghost",size:"icon",onClick:h,className:"h-7 w-7 text-destructive hover:bg-destructive/10 shrink-0","aria-label":"Remove file",children:f.jsx(Pi,{className:"h-4 w-4"})})]}):f.jsxs("button",{type:"button",onClick:m,className:Ze("w-full flex flex-col items-center justify-center p-4 border-2 border-dashed rounded-lg hover:border-primary transition-colors cursor-pointer bg-background hover:bg-muted/50",r,o.meta.errors.length?"border-destructive hover:border-destructive":"border-muted-foreground/50"),children:[f.jsx(WP,{className:"h-8 w-8 text-muted-foreground mb-2"}),f.jsx("span",{className:"text-sm font-medium text-muted-foreground",children:"Click or drag and drop a file"}),n&&f.jsxs("span",{className:"text-xs text-muted-foreground/80 mt-1",children:["Accepted types: ",n]})]}),o.meta.isTouched&&o.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:o.meta.errors.map((y,b)=>f.jsx("p",{children:typeof y=="string"?y:(y==null?void 0:y.message)||"Invalid"},b))})]})},dHe={text:xx,email:xx,password:xx,url:xx,textarea:wVe,select:_Ve,checkbox:SVe,switch:CVe,number:kVe,date:lHe,slider:cHe,file:uHe},fHe=({value:e,currentPage:t,totalPages:n,className:r})=>f.jsxs("div",{className:Ze("space-y-2",r),children:[f.jsxs("div",{className:"flex justify-between text-sm text-muted-foreground",children:[f.jsxs("span",{children:["Step ",t," of ",n]}),f.jsxs("span",{children:[Math.round(e),"%"]})]}),f.jsx(Ry,{value:e,className:"h-2"})]}),hHe=({children:e,title:t,description:n})=>f.jsxs("div",{className:"space-y-6",children:[(t||n)&&f.jsxs("div",{className:"space-y-2",children:[t&&f.jsx("h3",{className:"text-lg font-semibold",children:t}),n&&f.jsx("p",{className:"text-muted-foreground",children:n})]}),f.jsx("div",{className:"space-y-4",children:e})]});function u_(e){const{fields:t=[],schema:n,submitLabel:r="Submit",nextLabel:s="Next",previousLabel:i="Previous",formClassName:a,fieldClassName:o,pages:l=[],progress:c,defaultComponents:u={},globalWrapper:d,formOptions:h,onPageChange:m,autoSubmitOnChange:y=!1,autoSubmitDebounceMs:b=1e3,disabled:v=!1,loading:x=!1,resetOnSubmitSuccess:w=!1}=e,[S,k]=E.useState(1),C={...dHe,...u},T=E.useMemo(()=>{const te={};return t.forEach(W=>{const Q=W.page||1;te[Q]||(te[Q]=[]),te[Q].push(W)}),te},[t]),A=Math.max(...Object.keys(T).map(Number),1),N=A>1,I=N?(S-1)/(A-1)*100:100,O={...h,...n&&{validators:{onChange:n,...h==null?void 0:h.validators}},...w&&(h==null?void 0:h.onSubmit)&&{onSubmit:async te=>{try{const W=await h.onSubmit(te);return B.reset(),W}catch(W){throw W}}}},B=ii(O);Ve.useEffect(()=>{const te=[];let W,Q;if(h!=null&&h.onChange||y){const ee=B.store.subscribe(()=>{const re=B,pe=re.state.values;h!=null&&h.onChange&&re.state.isValid&&(clearTimeout(Q),Q=setTimeout(()=>{h.onChange({value:pe,formApi:re})},300)),y&&!v&&!x&&(clearTimeout(W),W=setTimeout(()=>{B.state.canSubmit&&B.handleSubmit()},b))});te.push(ee)}return te.push(()=>{clearTimeout(W),clearTimeout(Q)}),()=>{te.forEach(ee=>ee())}},[B,y,b,v,x]);const D=()=>T[S]||[],H=()=>l.find(te=>te.page===S),P=()=>{if(S<A){const te=S+1;k(te),m==null||m(te,"next")}},K=()=>{if(S>1){const te=S-1;k(te),m==null||m(te,"previous")}},U=S===A,V=S===1;return{form:B,Form:({className:te,children:W,onSubmit:Q})=>{const ee=Se=>{Se.preventDefault(),Se.stopPropagation(),Q?Q(Se):U?B.handleSubmit():P()},re=Ze("space-y-6",a,te),pe=Se=>{const{name:Ce,type:qe,label:Qe,placeholder:We,description:je,options:Y,min:ye,max:Ie,step:ce,accept:oe,multiple:se,component:Me,wrapper:Be,conditional:Ae,validation:lt}=Se;return f.jsx(B.Field,{name:Ce,validators:lt?{onChange:lt}:void 0,children:Tt=>{const dt=Tt.form.state.values;if(Ae&&!Ae(dt))return null;const Pt={fieldApi:Tt,label:Qe,placeholder:We,description:je,wrapperClassName:o,min:ye,max:Ie,step:ce,accept:oe,multiple:se,disabled:v||x||Tt.form.state.isSubmitting},qt=Me||C[qe]||xx,Ft=qe==="select"?{...Pt,options:Y||[]}:{...Pt,type:["text","email","password","url"].includes(qe)?qe:void 0},Ht=f.jsx(qt,{...Ft}),we=Be||d;return we?f.jsx(we,{field:Se,children:Ht}):Ht}},Ce)},de=()=>{const Se=D(),Ce=H(),qe=Se.map(We=>pe(We)).filter(Boolean),Qe=(Ce==null?void 0:Ce.component)||hHe;return f.jsx(Qe,{title:Ce==null?void 0:Ce.title,description:Ce==null?void 0:Ce.description,page:S,totalPages:A,children:qe})},Oe=()=>{if(!N||!c)return null;const Se=c.component||fHe;return f.jsx(Se,{value:I,currentPage:S,totalPages:A,className:c.className})},Fe=()=>N?f.jsx(B.Subscribe,{selector:Se=>({canSubmit:Se.canSubmit,isSubmitting:Se.isSubmitting}),children:Se=>{const{canSubmit:Ce,isSubmitting:qe}=Se;return f.jsxs("div",{className:"flex justify-between gap-4",children:[f.jsx(ct,{type:"button",variant:"outline",onClick:K,disabled:V||v||x,className:V?"invisible":"",children:i}),f.jsx(ct,{type:"submit",disabled:(!Ce||qe||v||x)&&U,className:"flex-1 max-w-xs",children:x&&U?"Loading...":qe&&U?"Submitting...":U?r:s})]})}}):f.jsx(B.Subscribe,{selector:Se=>({canSubmit:Se.canSubmit,isSubmitting:Se.isSubmitting}),children:Se=>{const{canSubmit:Ce,isSubmitting:qe}=Se;return f.jsx(ct,{type:"submit",disabled:!Ce||qe||v||x,className:"w-full",children:x?"Loading...":qe?"Submitting...":r})}});return f.jsx("form",{onSubmit:ee,className:re,children:W||f.jsxs(f.Fragment,{children:[Oe(),de(),Fe()]})})},currentPage:S,totalPages:A,goToNextPage:P,goToPreviousPage:K,setCurrentPage:k,isFirstPage:V,isLastPage:U,progressValue:I}}const pHe=Ke({selectedModelId:$e().min(1,"Please select a model"),originalPrompt:$e().min(1,"Please enter a prompt to enhance"),customSystemPrompt:$e().optional()}),mHe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState("setup"),[,i]=E.useState({}),[a,o]=E.useState(!1),[l,c]=E.useState(""),[u,d]=E.useState(null),{status:h}=un(yn(C=>({status:C.status})));E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]),E.useEffect(()=>{const C=()=>{o(!0),d(null)},T=N=>{o(!1),c(N.enhancedPrompt),s("result"),Te.success("Prompt enhancement completed!")},A=N=>{o(!1),d(N.error),Te.error(`Enhancement failed: ${N.error}`)};return Re.on(sn.enhancementStarted,C),Re.on(sn.enhancementCompleted,T),Re.on(sn.enhancementFailed,A),()=>{Re.off(sn.enhancementStarted,C),Re.off(sn.enhancementCompleted,T),Re.off(sn.enhancementFailed,A)}},[]);const m=({fieldApi:C,label:T})=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:"model-selector",children:T}),f.jsx(ag,{models:e.globallyEnabledModels,value:C.state.value,onChange:C.handleChange,isLoading:e.isLoadingProviders,className:"w-full"}),C.state.meta.isTouched&&C.state.meta.errors.length>0&&f.jsx("div",{className:"text-xs text-destructive pt-1",children:C.state.meta.errors.map((A,N)=>f.jsx("p",{children:String(A)},N))})]}),{Form:y}=u_({schema:pHe,fields:[{name:"selectedModelId",type:"custom",label:"Select Enhancement Model",component:m},{name:"originalPrompt",type:"textarea",label:"Original Prompt",placeholder:"Enter the prompt you want to enhance...",description:"This will be enhanced using AI"},{name:"customSystemPrompt",type:"textarea",label:"Custom System Prompt (Optional)",placeholder:"Leave empty to use default prompt engineering instructions...",description:"Custom instructions for how to enhance the prompt"}],defaultComponents:{custom:m},submitLabel:a?"Enhancing...":"Enhance Prompt",formOptions:{defaultValues:{selectedModelId:"",originalPrompt:e.currentPromptText,customSystemPrompt:""},onSubmit:async({value:C})=>{var T;if(!C.selectedModelId){Te.error("Please select a model");return}if(!C.originalPrompt.trim()){Te.error("Please enter a prompt to enhance");return}Re.emit(sn.enhancePromptRequest,{prompt:C.originalPrompt.trim(),modelId:C.selectedModelId,systemPrompt:((T=C.customSystemPrompt)==null?void 0:T.trim())||void 0})}}}),b=()=>{Re.emit(sn.setInputTextRequest,{text:l}),n(!1),Te.success("Enhanced prompt applied!"),v()},v=()=>{s("setup"),o(!1),c(""),d(null)},x=C=>{if(C.stopPropagation(),h==="streaming"){Te.info("Cannot enhance prompt while another response is streaming");return}if(e.globallyEnabledModels.length===0){Te.info("No models available for prompt enhancement");return}n(!0)},w=h!=="streaming"&&e.globallyEnabledModels.length>0,S=()=>h==="streaming"?"Cannot enhance prompt while streaming":e.globallyEnabledModels.length===0?"No models available for enhancement":"Improve your prompt with AI assistance",k=[{value:"setup",label:"Setup",content:f.jsx("div",{className:"space-y-4",children:f.jsx(y,{})})},{value:"result",label:"Result",content:f.jsx("div",{className:"space-y-4",children:u?f.jsx("div",{className:"p-4 bg-destructive/10 border border-destructive/20 rounded-lg",children:f.jsxs("p",{className:"text-sm text-destructive",children:["Enhancement failed: ",u]})}):l?f.jsxs(f.Fragment,{children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{children:"Enhanced Prompt"}),f.jsx("div",{className:"p-3 bg-primary/5 border border-primary/20 rounded-lg text-sm",children:l})]}),f.jsx(ct,{onClick:b,className:"w-full",children:"Use Enhanced Prompt"})]}):f.jsx("div",{className:"text-center text-muted-foreground py-8",children:a?"Enhancing your prompt...":"No enhancement result yet. Run the enhancement first."})})}];return f.jsxs(f.Fragment,{children:[f.jsx(qn,{tooltipText:S(),onClick:x,"aria-label":"Improve Prompt with AI",disabled:!w,icon:f.jsx(RH,{}),className:"h-5 w-5 md:h-6 md:w-6"}),f.jsx(hf,{open:t,onOpenChange:n,children:f.jsxs(pf,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col p-4",children:[f.jsxs(mf,{children:[f.jsx(gf,{children:"Improve Prompt"}),f.jsx(mp,{children:"Use AI to enhance your prompt for better results. Select a model and optionally customize the enhancement instructions."})]}),f.jsx("div",{className:"flex-1 min-h-0",children:f.jsx(xl,{tabs:k,initialValue:r,onValueChange:s,scrollable:!1})})]})})]})};class fie{static initialize(){Re.on(sn.enhancePromptRequest,async t=>{await this.handlePromptEnhancement(t)})}static async handlePromptEnhancement(t){try{const{prompt:n,modelId:r,systemPrompt:s}=t,i=un.getState(),a=i.currentConversationId;if(!a){Te.error("No active conversation for prompt enhancement");return}const o=qr();Re.emit(sn.enhancementStarted,{interactionId:o,originalPrompt:n});const l=i.interactions.filter(v=>v.conversationId===a&&v.status==="COMPLETED"&&v.type==="message.user_assistant"&&v.parentId===null).sort((v,x)=>v.index-x.index),c=FC(l),d=s||`You are an expert prompt engineer. Your task is to improve and enhance the given user prompt to make it more effective, specific, and likely to produce better results from AI models.

Please analyze the user's prompt and enhance it by:
1. Making it more specific and detailed
2. Adding relevant context or constraints if helpful
3. Improving clarity and structure
4. Suggesting better formatting if needed
5. Maintaining the original intent and requirements

Return ONLY the enhanced prompt without any explanations, comments, or additional text.`,h={role:"user",content:[{type:"text",text:`Please enhance this prompt:

${n}`}]},m={system:d,messages:[...c,h],parameters:{temperature:.3,max_tokens:1e3},metadata:{modelId:r,isPromptEnhancement:!0}},y={id:o,content:`Enhance prompt: ${n}`,parameters:{temperature:.3,max_tokens:1e3},metadata:{modelId:r,isPromptEnhancement:!0,originalPrompt:n}};if(!await Sc.startInteraction(m,a,y,"prompt.enhance"))throw new Error("Failed to create prompt enhancement interaction");Te.info("Enhancing your prompt...")}catch(n){const r=n instanceof Error?n.message:String(n);console.error("[PromptEnhancementService] Error during prompt enhancement:",n),Re.emit(sn.enhancementFailed,{interactionId:"unknown",error:r}),Te.error(`Prompt enhancement failed: ${r}`)}}static async handleEnhancementCompletion(t,n){try{Re.emit(sn.enhancementCompleted,{interactionId:t,enhancedPrompt:n}),Te.success("Prompt enhanced successfully!")}catch(r){console.error("[PromptEnhancementService] Error handling enhancement completion:",r)}}}const gHe=Object.freeze(Object.defineProperty({__proto__:null,PromptEnhancementService:fie},Symbol.toStringTag,{value:"Module"}));class yHe{constructor(){ue(this,"id","improve-prompt-control");ue(this,"eventUnsubscribers",[]);ue(this,"modApi",null);ue(this,"notifyComponentUpdate",null);ue(this,"globallyEnabledModels",[]);ue(this,"isLoadingProviders",!1);ue(this,"currentPromptText","")}async initialize(t){this.modApi=t,fie.initialize();const n=Qn.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on(Wn.globallyEnabledModelsUpdated,o=>{var u;let l=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(o.models)&&(this.globallyEnabledModels=o.models,l=!0);const c=Qn.getState().isLoading;this.isLoadingProviders!==c&&(this.isLoadingProviders=c,l=!0),l&&((u=this.notifyComponentUpdate)==null||u.call(this))}),s=t.on(Wn.initialDataLoaded,()=>{var u;const o=Qn.getState();let l=!1;this.isLoadingProviders!==o.isLoading&&(this.isLoadingProviders=o.isLoading,l=!0);const c=o.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(c)&&(this.globallyEnabledModels=c,l=!0),l&&((u=this.notifyComponentUpdate)==null||u.call(this))}),i=t.on(sn.inputTextStateChanged,o=>{this.currentPromptText=o.value}),a=t.on(sn.inputChanged,o=>{this.currentPromptText=o.value});this.eventUnsubscribers.push(r,s,i,a)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null,this.modApi=null}setNotifyCallback(t){this.notifyComponentUpdate=t}getCurrentPromptText(){return this.currentPromptText}register(t){t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(mHe,{module:this})})}}function bHe({templates:e,onSelect:t}){const[n,r]=E.useState(""),s=e.filter(a=>a.name.toLowerCase().includes(n.toLowerCase())||a.description.toLowerCase().includes(n.toLowerCase())||a.tags.some(o=>o.toLowerCase().includes(n.toLowerCase()))),i=()=>{Re.emit(Tr.openModalRequest,{modalId:"settingsModal",initialTab:"assistant",initialSubTab:"prompts"})};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"flex-grow",children:[f.jsx(jt,{htmlFor:"search",children:"Search Templates"}),f.jsx(xn,{id:"search",placeholder:"Search by name, description, or tags...",value:n,onChange:a=>r(a.target.value)})]}),f.jsx("div",{className:"pt-6",children:f.jsxs(ct,{variant:"outline",size:"sm",onClick:i,className:"h-9 px-3",title:"Open Template Settings",children:[f.jsx(Rh,{className:"h-4 w-4 mr-1"}),"Manage"]})})]}),f.jsx("div",{className:"grid gap-3",children:s.length===0?f.jsx("div",{className:"text-center py-8 text-muted-foreground",children:n?"No templates match your search.":"No templates available."}):s.map(a=>f.jsxs(Fo,{className:"cursor-pointer hover:bg-muted/50 transition-colors",onClick:()=>t(a),children:[f.jsx(Lo,{className:"pb-3",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsx(Bo,{className:"text-sm",children:a.name}),f.jsx(Au,{className:"text-xs",children:a.description})]}),a.isPublic&&f.jsx(as,{variant:"default",className:"text-xs",children:"Public"})]})}),f.jsx($o,{className:"pt-0",children:f.jsxs("div",{className:"flex flex-wrap gap-1",children:[a.tags.map(o=>f.jsx(as,{variant:"outline",className:"text-xs",children:o},o)),a.variables.length>0&&f.jsxs(as,{variant:"secondary",className:"text-xs",children:[a.variables.length," variables"]}),a.tools&&a.tools.length>0&&f.jsxs(as,{variant:"secondary",className:"text-xs",children:[a.tools.length," tools"]}),a.rules&&a.rules.length>0&&f.jsxs(as,{variant:"secondary",className:"text-xs",children:[a.rules.length," rules"]})]})})]},a.id))})]})}function vHe({template:e,onSubmit:t,onBack:n,previewElementRef:r,onCompile:s}){const i=e.variables.map(l=>({name:l.name,type:l.type==="boolean"?"switch":l.type==="number"?"number":l.type==="array"?"textarea":"text",label:l.name,placeholder:l.default||`Enter ${l.name}`,description:l.description||l.instructions,required:l.required})),a=e.variables.reduce((l,c)=>{if(c.default)if(c.type==="number")l[c.name]=parseFloat(c.default)||0;else if(c.type==="boolean")l[c.name]=c.default.toLowerCase()==="true";else if(c.type==="array")try{l[c.name]=JSON.parse(c.default)}catch{l[c.name]=c.default.split(",").map(u=>u.trim())}else l[c.name]=c.default;return l},{}),{Form:o}=u_({fields:i,submitLabel:"Proompt !",formOptions:{defaultValues:a,onSubmit:async({value:l})=>{t(l)},onChange:async({value:l})=>{await s(l)}}});return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center gap-3",children:[f.jsx(ct,{variant:"outline",size:"sm",onClick:n,children:" Back"}),f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:e.name}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e.description})]})]}),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsxs("div",{className:"text-center",children:[f.jsx("p",{className:"text-muted-foreground",children:"This template has no variables defined. The template will be applied as-is."}),f.jsx(ct,{onClick:()=>t({}),className:"mt-3",children:"Proompt !"})]}):f.jsxs(f.Fragment,{children:[f.jsx(jt,{className:"text-sm font-medium mb-4 block",children:"Template Variables"}),f.jsx(o,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(jt,{className:"text-sm font-medium",children:"Live Preview"}),f.jsx("div",{ref:r,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto",children:e.prompt})]})]})]})}const xHe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState(null),i=E.useRef(null),{loadPromptTemplates:a,getTemplatesByType:o}=Om(yn(m=>({loadPromptTemplates:m.loadPromptTemplates,getTemplatesByType:m.getTemplatesByType}))),l=o("prompt");E.useEffect(()=>{t&&a()},[t,a]);const c=m=>{s(m),i.current&&(i.current.textContent=m.prompt)},u=async m=>{if(r)try{await e.applyTemplate(r.id,m),n(!1),s(null),Te.success("Template applied to input area!")}catch(y){console.error("Failed to Proompt :",y),Te.error("Failed to Proompt !")}},d=()=>{s(null)},h=async m=>{if(!(!r||!i.current))try{const y=await e.compileTemplate(r.id,m);i.current.textContent=y.content}catch(y){i.current.textContent=`Error: ${y instanceof Error?y.message:"Compilation failed"}`}};return f.jsxs(f.Fragment,{children:[f.jsx(ct,{variant:"ghost",size:"sm",onClick:()=>n(!0),className:"h-8 w-8 p-0",title:"Open Prompt Library",children:f.jsx(Rpe,{className:"h-4 w-4"})}),f.jsx(hf,{open:t,onOpenChange:n,children:f.jsxs(pf,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsxs(mf,{children:[f.jsx(gf,{children:r?"Fill Template Variables":"Prompt Library"}),f.jsx(mp,{children:r?"Provide values for the template variables below.":"Select a prompt template to use. Templates can include dynamic variables, auto-select tools, and rules."})]}),f.jsx("div",{className:"flex-1 overflow-hidden",children:r?f.jsx(vHe,{template:r,onSubmit:u,onBack:d,module:e,previewElementRef:i,onCompile:h}):f.jsx(bHe,{templates:l,onSelect:c})})]})})]})};class wHe{constructor(){ue(this,"id","core-prompt-library");ue(this,"unregisterCallback",null);ue(this,"eventUnsubscribers",[]);ue(this,"notifyComponentUpdate",null);ue(this,"isStreaming",!1);ue(this,"modApiRef",null);ue(this,"getIsStreaming",()=>this.isStreaming);ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});ue(this,"compileTemplate",async(t,n)=>{const{compilePromptTemplate:r}=Om.getState();return await r(t,n)});ue(this,"applyTemplate",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);(s=this.modApiRef)==null||s.emit(sn.setInputTextRequest,{text:r.content})})}async initialize(t){this.modApiRef=t,this.isStreaming=un.getState().status==="streaming";const n=t.on(En.statusChanged,r=>{var s;typeof r=="object"&&r&&"status"in r&&this.isStreaming!==(r.status==="streaming")&&(this.isStreaming=r.status==="streaming",(s=this.notifyComponentUpdate)==null||s.call(this))});this.eventUnsubscribers.push(n)}register(t){if(this.modApiRef=t,this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(xHe,{module:this})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const _He=e=>{const{size:t=24,color:n="currentColor",...r}=e;return f.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",width:t,height:t,viewBox:"0 0 512 512",fill:"none",strokeLinecap:"round",strokeLinejoin:"round",...r,children:f.jsxs("g",{transform:"translate(0.000000,512.000000) scale(0.100000,-0.100000)",fill:n,stroke:"none",children:[f.jsx("path",{d:`M2310 5053 c-1035 -101 -1883 -794 -2159 -1764 -55 -194 -79 -338
-91 -552 -18 -323 20 -620 117 -907 92 -272 238 -543 404 -747 33 -39 59 -75
59 -78 0 -4 -49 -129 -109 -279 -252 -624 -251 -621 -196 -676 57 -56 73 -53
351 58 137 55 349 143 472 195 l223 95 77 -38 c221 -109 437 -179 680 -219
132 -23 411 -44 475 -37 23 3 85 8 137 11 404 26 806 168 1180 417 282 188
571 489 759 792 400 642 467 1498 174 2216 -179 439 -495 826 -888 1088 -361
239 -743 378 -1165 422 -88 9 -419 11 -500 3z m404 -463 c-1 -30 -17 -128 -36
-217 l-34 -163 137 0 c128 0 139 -1 149 -20 11 -21 4 -44 -22 -72 -7 -7 -68
-75 -135 -150 l-123 -136 0 -175 0 -175 238 -4 c265 -5 329 -16 469 -82 220
-105 414 -311 486 -519 l24 -68 86 -4 c129 -7 195 -43 236 -130 20 -42 21 -61
21 -300 0 -240 -1 -258 -21 -297 -46 -90 -115 -127 -235 -128 l-82 0 -11 -47
c-17 -66 -71 -179 -119 -250 -108 -159 -276 -293 -452 -361 -174 -66 -251 -72
-830 -63 l-475 8 -89 27 c-303 91 -554 328 -650 614 l-23 67 -89 5 c-98 6
-131 20 -180 72 -63 66 -64 72 -64 354 0 240 1 261 21 301 40 84 105 119 232
129 l84 7 32 80 c84 215 291 424 513 519 126 53 225 68 466 68 l212 0 0 268 0
267 -126 -3 c-108 -3 -129 -1 -145 14 -10 9 -19 25 -19 35 0 9 111 146 246
304 234 273 247 286 277 283 32 -3 32 -3 31 -58z`}),f.jsx("path",{d:`M1854 2726 c-92 -40 -150 -139 -141 -239 21 -237 343 -298 446 -84
59 123 -10 287 -138 325 -51 16 -128 15 -167 -2z`}),f.jsx("path",{d:`M3053 2719 c-81 -40 -133 -121 -133 -205 0 -102 47 -180 134 -220 95
-44 193 -27 268 47 78 78 94 181 44 278 -21 38 -76 88 -118 105 -54 23 -144
20 -195 -5z`}),f.jsx("path",{d:`M2147 1999 c-26 -15 -48 -65 -41 -94 15 -61 181 -167 304 -196 30 -7
100 -12 155 -12 81 1 115 6 178 27 135 45 247 133 249 194 2 60 -48 103 -104
88 -13 -3 -50 -25 -83 -50 -85 -64 -172 -90 -280 -84 -92 6 -165 35 -259 103
-49 35 -86 43 -119 24z`})]})})};function SHe({agents:e,onUseAgent:t,onClearAgent:n,hasActiveAgent:r,currentAgentName:s,module:i}){const[a,o]=E.useState(""),l=e.filter(u=>u.name.toLowerCase().includes(a.toLowerCase())||u.description.toLowerCase().includes(a.toLowerCase())||u.tags.some(d=>d.toLowerCase().includes(a.toLowerCase()))),c=()=>{Re.emit(Tr.openModalRequest,{modalId:"settingsModal",initialTab:"assistant",initialSubTab:"agents"})};return f.jsxs("div",{className:"space-y-4",children:[r&&f.jsxs("div",{className:"flex items-center justify-between p-3 bg-muted/50 rounded-lg",children:[f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(ty,{className:"h-4 w-4 text-primary"}),f.jsxs("span",{className:"text-sm font-medium",children:["Active Agent: ",s]})]}),f.jsx(ct,{variant:"outline",size:"sm",onClick:n,children:"Clear Agent"})]}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"flex-grow",children:[f.jsx(jt,{htmlFor:"search",children:"Search Agents"}),f.jsx(xn,{id:"search",placeholder:"Search by name, description, or tags...",value:a,onChange:u=>o(u.target.value)})]}),f.jsx("div",{className:"pt-6",children:f.jsxs(ct,{variant:"outline",size:"sm",onClick:c,className:"h-9 px-3",title:"Open Agent Settings",children:[f.jsx(Rh,{className:"h-4 w-4 mr-1"}),"Manage"]})})]}),f.jsx("div",{className:"grid gap-3",children:l.length===0?f.jsx("div",{className:"text-center py-8 text-muted-foreground",children:a?"No agents match your search.":"No agents available."}):l.map(u=>{const d=i.getTasksForAgent(u.id);return f.jsxs(Fo,{className:"hover:bg-muted/50 transition-colors",children:[f.jsx(Lo,{className:"pb-3",children:f.jsxs("div",{className:"flex items-start justify-between",children:[f.jsxs("div",{children:[f.jsxs(Bo,{className:"text-sm flex items-center gap-2",children:[f.jsx(ty,{className:"h-4 w-4"}),u.name]}),f.jsx(Au,{className:"text-xs",children:u.description})]}),u.isPublic&&f.jsx(as,{variant:"default",className:"text-xs",children:"Public"})]})}),f.jsxs($o,{className:"pt-0 space-y-3",children:[f.jsxs("div",{className:"flex flex-wrap gap-1",children:[f.jsxs(as,{variant:"secondary",className:"text-xs",children:[d.length," tasks"]}),u.tags.map(h=>f.jsx(as,{variant:"outline",className:"text-xs",children:h},h)),u.variables.length>0&&f.jsxs(as,{variant:"secondary",className:"text-xs",children:[u.variables.length," variables"]}),u.tools&&u.tools.length>0&&f.jsxs(as,{variant:"secondary",className:"text-xs",children:[u.tools.length," tools"]}),u.rules&&u.rules.length>0&&f.jsxs(as,{variant:"secondary",className:"text-xs",children:[u.rules.length," rules"]})]}),f.jsx(ct,{size:"sm",onClick:()=>t(u),className:"w-full",children:"Use Agent"})]})]},u.id)})})]})}function CHe({agent:e,onChange:t,previewElementRef:n,onCompile:r}){const s=e.variables.map(o=>({name:o.name,type:o.type==="boolean"?"switch":o.type==="number"?"number":o.type==="array"?"textarea":"text",label:o.name,placeholder:o.default||`Enter ${o.name}`,description:o.description||o.instructions,required:o.required})),i=e.variables.reduce((o,l)=>{if(l.default)if(l.type==="number")o[l.name]=parseFloat(l.default)||0;else if(l.type==="boolean")o[l.name]=l.default.toLowerCase()==="true";else if(l.type==="array")try{o[l.name]=JSON.parse(l.default)}catch{o[l.name]=l.default.split(",").map(c=>c.trim())}else o[l.name]=l.default;return o},{}),{Form:a}=u_({fields:s,submitLabel:"",formOptions:{defaultValues:i,onSubmit:async()=>{},onChange:async({value:o})=>{t(o),await r(o)}}});return E.useEffect(()=>{n.current&&(n.current.textContent=e.prompt)},[e.prompt,n]),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsx("div",{className:"text-center",children:f.jsx("p",{className:"text-muted-foreground",children:"This agent has no variables defined. The agent will be applied as-is."})}):f.jsxs(f.Fragment,{children:[f.jsx(jt,{className:"text-sm font-medium mb-4 block",children:"Agent Configuration"}),f.jsx(a,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(jt,{className:"text-sm font-medium",children:"System Prompt Preview"}),f.jsx("div",{ref:n,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto"})]})]})}function kHe({task:e,onChange:t,previewElementRef:n,onCompile:r}){const s=e.variables.map(o=>({name:o.name,type:o.type==="boolean"?"switch":o.type==="number"?"number":o.type==="array"?"textarea":"text",label:o.name,placeholder:o.default||`Enter ${o.name}`,description:o.description||o.instructions,required:o.required})),i=e.variables.reduce((o,l)=>{if(l.default)if(l.type==="number")o[l.name]=parseFloat(l.default)||0;else if(l.type==="boolean")o[l.name]=l.default.toLowerCase()==="true";else if(l.type==="array")try{o[l.name]=JSON.parse(l.default)}catch{o[l.name]=l.default.split(",").map(c=>c.trim())}else o[l.name]=l.default;return o},{}),{Form:a}=u_({fields:s,submitLabel:"",formOptions:{defaultValues:i,onSubmit:async()=>{},onChange:async({value:o})=>{t(o),await r(o)}}});return E.useEffect(()=>{n.current&&(n.current.textContent=e.prompt)},[e.prompt,n]),f.jsxs("div",{className:"md:flex md:space-x-4",children:[f.jsx("div",{className:"md:w-1/2 border rounded-lg p-4",children:e.variables.length===0?f.jsx("div",{className:"text-center",children:f.jsx("p",{className:"text-muted-foreground",children:"This task has no variables defined. The task will be executed as-is."})}):f.jsxs(f.Fragment,{children:[f.jsx(jt,{className:"text-sm font-medium mb-4 block",children:"Task Configuration"}),f.jsx(a,{})]})}),f.jsxs("div",{className:"md:w-1/2 border rounded-lg p-4",children:[f.jsx(jt,{className:"text-sm font-medium",children:"Task Prompt Preview"}),f.jsx("div",{ref:n,className:"mt-2 p-3 bg-muted rounded text-sm font-mono whitespace-pre-wrap max-h-64 overflow-y-auto"})]})]})}function EHe({agent:e,tasks:t,onSubmit:n,onBack:r,previewElementRef:s,onCompile:i,autoClearEnabled:a,onAutoClearChange:o,module:l}){const[c,u]=E.useState(""),[d,h]=E.useState({}),[m,y]=E.useState({}),b=E.useRef(null),v=t.find(A=>A.id===c),x=A=>{h(A)},w=A=>{y(A)},S=A=>{u(A),y({})},k=()=>{v?n(d,v,m):n(d)},C=async A=>{if(s.current)try{await i(A)}catch(N){s.current&&(s.current.textContent=`Error: ${N instanceof Error?N.message:"Compilation failed"}`)}},T=async A=>{if(!(!v||!b.current))try{const N=await l.compileTaskTemplate(v.id,A);b.current.textContent=N.content}catch(N){b.current.textContent=`Error: ${N instanceof Error?N.message:"Compilation failed"}`}};return f.jsxs("div",{className:"flex flex-col h-full",children:[f.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[f.jsxs(ct,{variant:"ghost",size:"sm",onClick:r,children:[f.jsx(vpe,{className:"h-4 w-4 mr-1"}),"Back to Agents"]}),f.jsx("div",{className:"flex-1"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(jt,{htmlFor:"auto-clear",className:"text-sm",children:"Auto-clear after use"}),f.jsx(oo,{id:"auto-clear",checked:a,onCheckedChange:o})]})]}),t.length>0&&f.jsxs(Fo,{className:"mb-4",children:[f.jsxs(Lo,{children:[f.jsx(Bo,{className:"text-lg",children:"Task Selection (Optional)"}),f.jsx(Au,{children:"Choose a task to execute with this agent, or leave empty to use the agent alone."})]}),f.jsx($o,{children:f.jsxs("div",{children:[f.jsx(jt,{htmlFor:"task-select",children:"Select Task"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsxs(lf,{value:c,onValueChange:S,children:[f.jsx(uf,{className:"flex-1",children:f.jsx(cf,{placeholder:"Select a task (optional)"})}),f.jsx(df,{children:t.map(A=>f.jsx(Ba,{value:A.id,children:A.name},A.id))})]}),c&&f.jsx(ct,{variant:"outline",size:"sm",onClick:()=>u(""),children:"Clear"})]})]})})]}),f.jsxs("div",{className:"flex-1 overflow-auto space-y-4",children:[f.jsxs(Fo,{children:[f.jsxs(Lo,{children:[f.jsx(Bo,{className:"text-lg",children:"Agent Configuration"}),f.jsxs(Au,{children:["Configure the system prompt and settings for ",e.name]})]}),f.jsx($o,{children:f.jsx(CHe,{agent:e,onChange:x,previewElementRef:s,onCompile:C})})]}),v&&f.jsxs(Fo,{children:[f.jsxs(Lo,{children:[f.jsx(Bo,{className:"text-lg",children:"Task Configuration"}),f.jsxs(Au,{children:["Configure the task prompt for ",v.name]})]}),f.jsx($o,{children:f.jsx(kHe,{task:v,onChange:w,previewElementRef:b,onCompile:T})})]}),f.jsx("div",{className:"flex justify-end pt-4",children:f.jsxs(ct,{onClick:k,size:"lg",children:["Use Agent ",v?`with ${v.name}`:""]})})]})]})}const THe=({module:e})=>{const[t,n]=E.useState(!1),[r,s]=E.useState(null),[i,a]=E.useState(!1),[o,l]=E.useState(0),c=E.useRef(null);E.useEffect(()=>{const C=()=>{l(T=>T+1)};return e.setNotifyCallback(C),()=>{e.setNotifyCallback(null)}},[e]),E.useEffect(()=>{t&&e.loadPromptTemplates()},[t,e]);const u=e.getAgents(),d=e.hasActiveAgent(),h=e.getCurrentAgentId(),m=h?u.find(C=>C.id===h):null;E.useEffect(()=>{},[o]);const y=C=>{s(C),a(!0)},b=async(C,T,A)=>{var N;if(r)try{T&&A?(await e.applyAgentWithTask(r.id,T.id,C,A),Te.success(`Agent "${r.name}" applied with task "${T.name}"!`)):(await e.applyAgent(r.id,C),Te.success(`Agent "${r.name}" applied!`)),e.getAutoClearEnabled()&&((N=e.clearOnSubmit)==null||N.call(e)),n(!1),s(null),a(!1)}catch(I){console.error("Failed to apply agent:",I),Te.error("Failed to apply agent!")}},v=()=>{s(null),a(!1)},x=()=>{var C;(C=e.clearOnSubmit)==null||C.call(e),Te.success("Agent cleared!")},w=async C=>{if(!(!r||!c.current))try{const T=await e.compileTemplate(r.id,C);c.current.textContent=T.content}catch(T){c.current.textContent=`Error: ${T instanceof Error?T.message:"Compilation failed"}`}},S=()=>i&&r?`Configure ${r.name}`:"Select Agent",k=()=>i&&r?"Configure the agent and optionally select a task to execute.":"Select an AI agent to work with. Each agent has specialized capabilities and tasks.";return f.jsxs(f.Fragment,{children:[f.jsx(ct,{variant:d?"secondary":"ghost",size:"sm",onClick:()=>n(!0),className:"h-8 w-8 p-0",title:d?`Active Agent: ${(m==null?void 0:m.name)||"Unknown"}`:"Select Agent",children:f.jsx(_He,{className:"h-4 w-4"})}),f.jsx(hf,{open:t,onOpenChange:n,children:f.jsxs(pf,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsxs(mf,{children:[f.jsx(gf,{children:S()}),f.jsx(mp,{children:k()})]}),f.jsx("div",{className:"flex-1 overflow-hidden",children:i&&r?f.jsx(EHe,{agent:r,tasks:e.getTasksForAgent(r.id),onSubmit:b,onBack:v,previewElementRef:c,onCompile:w,autoClearEnabled:e.getAutoClearEnabled(),onAutoClearChange:e.setAutoClearEnabled,module:e}):f.jsx(SHe,{agents:u,onUseAgent:y,onClearAgent:x,hasActiveAgent:d,currentAgentName:m==null?void 0:m.name,module:e})})]})})]})};class AHe{constructor(){ue(this,"id","agent-control");ue(this,"unregisterPromptControlCallback",null);ue(this,"unregisterCallback");ue(this,"eventUnsubscribers",[]);ue(this,"modApiRef",null);ue(this,"allTemplates",[]);ue(this,"isLoadingTemplates",!0);ue(this,"notifyComponentUpdate",null);ue(this,"currentAgentId",null);ue(this,"currentAgentSystemPrompt",null);ue(this,"autoClearEnabled",!1);ue(this,"getAllTemplates",()=>this.allTemplates);ue(this,"getAgents",()=>this.allTemplates.filter(t=>(t.type||"prompt")==="agent"));ue(this,"getTasksForAgent",t=>this.allTemplates.filter(n=>(n.type||"prompt")==="task"&&n.parentId===t));ue(this,"getIsLoadingTemplates",()=>this.isLoadingTemplates);ue(this,"compileTemplate",async(t,n)=>{const{compilePromptTemplate:r}=Om.getState();return await r(t,n)});ue(this,"compileTaskTemplate",async(t,n)=>{const{compilePromptTemplate:r}=Om.getState();return await r(t,n)});ue(this,"applyTemplate",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);(s=this.modApiRef)==null||s.emit(sn.setInputTextRequest,{text:r.content}),r.selectedTools&&r.selectedTools.length>0,r.selectedRules&&r.selectedRules.length>0});ue(this,"applyAgent",async(t,n)=>{var s;const r=await this.compileTemplate(t,n);this.currentAgentId=t,this.currentAgentSystemPrompt=r.content,(s=this.notifyComponentUpdate)==null||s.call(this),r.selectedTools&&r.selectedTools.length>0,r.selectedRules&&r.selectedRules.length>0});ue(this,"applyAgentWithTask",async(t,n,r,s)=>{var a;await this.applyAgent(t,r);const i=await this.compileTemplate(n,s);(a=this.modApiRef)==null||a.emit(sn.setInputTextRequest,{text:i.content}),i.selectedTools&&i.selectedTools.length>0,i.selectedRules&&i.selectedRules.length>0});ue(this,"getCurrentAgentId",()=>this.currentAgentId);ue(this,"getCurrentAgentSystemPrompt",()=>this.currentAgentSystemPrompt);ue(this,"hasActiveAgent",()=>this.currentAgentId!==null);ue(this,"getAutoClearEnabled",()=>this.autoClearEnabled);ue(this,"setAutoClearEnabled",t=>{this.autoClearEnabled=t});ue(this,"clearOnSubmit",()=>{var t;this.currentAgentId=null,this.currentAgentSystemPrompt=null,(t=this.notifyComponentUpdate)==null||t.call(this)});ue(this,"setNotifyCallback",t=>{this.notifyComponentUpdate=t});ue(this,"loadPromptTemplates",()=>{var t;(t=this.modApiRef)==null||t.emit(to.loadPromptTemplatesRequest,{})})}async initialize(t){this.modApiRef=t,t.emit(to.loadPromptTemplatesRequest,{});const n=t.on(to.promptTemplatesChanged,a=>{var o;a!=null&&a.promptTemplates&&(this.allTemplates=a.promptTemplates,this.isLoadingTemplates=!1,(o=this.notifyComponentUpdate)==null||o.call(this))}),r=t.on(to.promptTemplateAdded,a=>{var o;a!=null&&a.promptTemplate&&(this.allTemplates=[...this.allTemplates,a.promptTemplate],(o=this.notifyComponentUpdate)==null||o.call(this))}),s=t.on(to.promptTemplateUpdated,a=>{var o;if(a!=null&&a.promptTemplate){const l=this.allTemplates.findIndex(c=>c.id===a.promptTemplate.id);l!==-1&&(this.allTemplates[l]=a.promptTemplate,(o=this.notifyComponentUpdate)==null||o.call(this))}}),i=t.on(to.promptTemplateDeleted,a=>{var o;a!=null&&a.id&&(this.allTemplates=this.allTemplates.filter(l=>l.id!==a.id),(o=this.notifyComponentUpdate)==null||o.call(this))});this.eventUnsubscribers.push(n,r,s,i)}register(t){this.modApiRef=t,this.unregisterPromptControlCallback||(this.unregisterPromptControlCallback=t.registerPromptControl({id:this.id,status:()=>"ready",triggerRenderer:()=>Ve.createElement(THe,{module:this}),getMetadata:()=>{if(this.currentAgentSystemPrompt)return{turnSystemPrompt:this.currentAgentSystemPrompt}},clearOnSubmit:()=>{var n;this.autoClearEnabled&&(this.currentAgentId=null,this.currentAgentSystemPrompt=null,(n=this.notifyComponentUpdate)==null||n.call(this))}}))}destroy(t){this.eventUnsubscribers.forEach(n=>n()),this.eventUnsubscribers=[],this.unregisterPromptControlCallback&&(this.unregisterPromptControlCallback(),this.unregisterPromptControlCallback=null),this.modApiRef=null,this.notifyComponentUpdate=null,this.unregisterCallback&&this.unregisterCallback()}}const RHe=Ke({enableStreamingMarkdown:Zn(),enableStreamingCodeBlockParsing:Zn(),foldStreamingCodeBlocks:Zn(),foldUserMessagesOnCompletion:Zn(),enableAutoScrollOnStream:Zn(),streamingRenderFPS:At().min(3,"Min 3 FPS").max(60,"Max 60 FPS"),autoScrollInterval:At().min(50,"Min 50ms").max(5e3,"Max 5000ms")}),NHe=()=>{const e=pr(yn(s=>({setEnableStreamingMarkdown:s.setEnableStreamingMarkdown,setEnableStreamingCodeBlockParsing:s.setEnableStreamingCodeBlockParsing,setFoldStreamingCodeBlocks:s.setFoldStreamingCodeBlocks,setFoldUserMessagesOnCompletion:s.setFoldUserMessagesOnCompletion,setStreamingRenderFPS:s.setStreamingRenderFPS,setAutoScrollInterval:s.setAutoScrollInterval,setEnableAutoScrollOnStream:s.setEnableAutoScrollOnStream,resetGeneralSettings:s.resetGeneralSettings}))),t=pr(yn(s=>({enableStreamingMarkdown:s.enableStreamingMarkdown,enableStreamingCodeBlockParsing:s.enableStreamingCodeBlockParsing,foldStreamingCodeBlocks:s.foldStreamingCodeBlocks,foldUserMessagesOnCompletion:s.foldUserMessagesOnCompletion,streamingRenderFPS:s.streamingRenderFPS,autoScrollInterval:s.autoScrollInterval,enableAutoScrollOnStream:s.enableAutoScrollOnStream}))),n=ii({defaultValues:{enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!0,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3},validators:{onChangeAsync:RHe,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{e.setEnableStreamingMarkdown(s.enableStreamingMarkdown),e.setEnableStreamingCodeBlockParsing(s.enableStreamingCodeBlockParsing),e.setFoldStreamingCodeBlocks(s.foldStreamingCodeBlocks),e.setFoldUserMessagesOnCompletion(s.foldUserMessagesOnCompletion),e.setEnableAutoScrollOnStream(s.enableAutoScrollOnStream),e.setStreamingRenderFPS(s.streamingRenderFPS),e.setAutoScrollInterval(s.autoScrollInterval)}});E.useEffect(()=>{n.reset({enableStreamingMarkdown:t.enableStreamingMarkdown??!0,enableStreamingCodeBlockParsing:t.enableStreamingCodeBlockParsing??!0,foldStreamingCodeBlocks:t.foldStreamingCodeBlocks??!1,foldUserMessagesOnCompletion:t.foldUserMessagesOnCompletion??!1,enableAutoScrollOnStream:t.enableAutoScrollOnStream??!0,streamingRenderFPS:t.streamingRenderFPS??15,autoScrollInterval:t.autoScrollInterval??1e3})},[t.enableStreamingMarkdown,t.enableStreamingCodeBlockParsing,t.foldStreamingCodeBlocks,t.foldUserMessagesOnCompletion,t.enableAutoScrollOnStream,t.streamingRenderFPS,t.autoScrollInterval,n]);const r=()=>{window.confirm("Are you sure you want to reset Streaming & Display settings to their defaults?")&&e.resetGeneralSettings()};return f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),n.handleSubmit()},className:"p-1 space-y-4",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Streaming & Display"}),f.jsx(sm,{form:n,name:"enableStreamingMarkdown",label:"Parse Markdown While Streaming",description:"Render Markdown formatting as the response arrives (may impact performance slightly)."}),f.jsx(sm,{form:n,name:"enableStreamingCodeBlockParsing",label:"Use Full Code Blocks While Streaming",description:"Use the syntax-highlighting component for code blocks during streaming."}),f.jsx(sm,{form:n,name:"foldStreamingCodeBlocks",label:"Fold Code Blocks by Default During Streaming",description:"Automatically collapse code blocks as they stream in. Useful for long code outputs."}),f.jsx(sm,{form:n,name:"foldUserMessagesOnCompletion",label:"Fold User Messages After Response",description:"Automatically collapse the user's prompt message once the assistant finishes responding."}),f.jsx(sm,{form:n,name:"enableAutoScrollOnStream",label:"Auto-Scroll While Streaming",description:"Automatically scroll to the bottom as new content arrives."}),f.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[f.jsx(Cc,{form:n,name:"streamingRenderFPS",label:"Streaming Update Rate",min:3,max:60,step:1,valueLabelSuffix:" FPS"}),f.jsx(My,{form:n,name:"streamingRenderFPS",label:"FPS Input",min:3,max:60,step:1,className:"w-24 h-8 text-xs ml-auto","aria-label":"Streaming Render FPS Value"}),f.jsx("p",{className:Ze("text-sm text-muted-foreground"),children:"Controls how frequently the UI updates during streaming (3-60 FPS)."})]}),f.jsxs("div",{className:"rounded-lg border p-3 shadow-sm space-y-2",children:[f.jsx(Cc,{form:n,name:"autoScrollInterval",label:"Auto-Scroll Interval",min:50,max:5e3,step:50,valueLabelSuffix:" ms",disabled:!n.state.values.enableAutoScrollOnStream}),f.jsx(My,{form:n,name:"autoScrollInterval",label:"Interval Input (ms)",min:50,max:5e3,step:50,className:"w-24 h-8 text-xs ml-auto",disabled:!n.state.values.enableAutoScrollOnStream,"aria-label":"Auto Scroll Interval Value"}),f.jsx("p",{className:Ze("text-sm text-muted-foreground"),children:"How often to scroll to the bottom during streaming (50-5000 ms)."})]})]}),f.jsx(Fm,{}),f.jsx("div",{className:"flex items-center justify-between pt-3",children:f.jsx(n.Subscribe,{children:s=>{const i=s.canSubmit,a=s.isSubmitting,o=s.isValidating,l=s.isValid;return f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(ct,{type:"submit",size:"sm",disabled:!i||a||o||!l,children:a?"Saving...":o?"Validating...":"Save Changes"}),f.jsxs(ct,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(b1,{className:"mr-2 h-4 w-4"}),"Reset General Settings"]})]})}})})]})},MHe=Ve.memo(NHe);class IHe{constructor(){ue(this,"id","core-settings-general");ue(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"general",title:"General",component:MHe,order:10})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const jHe=({label:e,colorKey:t,value:n,onChange:r})=>{const[s,i]=E.useState(n??"");E.useEffect(()=>{i(n??"")},[n]);const a=()=>{r(t,s.trim()||null)},o=l=>{i(l.target.value)};return f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsx(jt,{htmlFor:`color-${t}`,className:"text-xs w-28 shrink-0",children:e}),f.jsx(xn,{id:`color-${t}`,type:"text",value:s,onChange:o,onBlur:a,className:"h-8 text-xs flex-grow",placeholder:"e.g., #ffffff or oklch(0.5 0.2 180)"}),f.jsx(xn,{type:"color",value:s!=null&&s.startsWith("#")?s:"#000000",onChange:l=>{i(l.target.value),r(t,l.target.value)},className:"h-8 w-10 p-1 border-none cursor-pointer bg-transparent","aria-label":`Pick ${e} color`})]})},PHe=[{label:"Default Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-light.min.css"},{label:"A11y Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-a11y-dark.min.css"},{label:"Atom Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-atom-dark.min.css"},{label:"Atelier Sulphurpool Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-base16-ateliersulphurpool.light.min.css"},{label:"CB",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-cb.min.css"},{label:"Coldark Cold",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-cold.min.css"},{label:"Coldark Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coldark-dark.min.css"},{label:"Coy (No Shadow)",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-coy-without-shadows.min.css"},{label:"Darcula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-darcula.min.css"},{label:"Dracula",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-dracula.min.css"},{label:"Duotone Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-dark.min.css"},{label:"Duotone Earth",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-earth.min.css"},{label:"Duotone Forest",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-forest.min.css"},{label:"Duotone Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-light.min.css"},{label:"Duotone Sea",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-sea.min.css"},{label:"Duotone Space",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-duotone-space.min.css"},{label:"GH Colors",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-ghcolors.min.css"},{label:"Gruvbox Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-dark.min.css"},{label:"Gruvbox Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-gruvbox-light.min.css"},{label:"Holi",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-holi-theme.min.css"},{label:"Hopscotch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-hopscotch.min.css"},{label:"Lucario",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-lucario.min.css"},{label:"Material Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-dark.min.css"},{label:"Material Oceanic",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-material-oceanic.min.css"},{label:"Night Owl",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-night-owl.min.css"},{label:"Nord",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-nord.min.css"},{label:"One Dark",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-dark.min.css"},{label:"One Light",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-one-light.min.css"},{label:"Pojoaque",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-pojoaque.min.css"},{label:"Shades of Purple",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-shades-of-purple.min.css"},{label:"Solarized Dark Atom",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-solarized-dark-atom.min.css"},{label:"Synthwave '84",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-synthwave84.min.css"},{label:"VS",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vs.min.css"},{label:"VSC Dark Plus",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-vsc-dark-plus.min.css"},{label:"Xonokai",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-xonokai.min.css"},{label:"Z-Touch",value:"https://cdnjs.cloudflare.com/ajax/libs/prism-themes/1.9.0/prism-z-touch.min.css"}],OHe=vl(["system","light","dark","TijuLight","TijuDark","custom"]),DHe=Ke({theme:OHe,prismThemeUrl:$e(),customFontFamily:$e(),customFontSize:At().min(12).max(20),chatMaxWidth:$e(),customThemeColors:Ih($e(),$e().nullable())}),FHe=()=>{const e=pr(yn(a=>({setTheme:a.setTheme,setPrismThemeUrl:a.setPrismThemeUrl,setCustomFontFamily:a.setCustomFontFamily,setCustomFontSize:a.setCustomFontSize,setChatMaxWidth:a.setChatMaxWidth,setCustomThemeColor:a.setCustomThemeColor,resetThemeSettings:a.resetThemeSettings}))),t=pr(yn(a=>({theme:a.theme,prismThemeUrl:a.prismThemeUrl,customFontFamily:a.customFontFamily,customFontSize:a.customFontSize,chatMaxWidth:a.chatMaxWidth,_rawCustomThemeColors:a.customThemeColors}))),n=ii({defaultValues:{theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}},onSubmit:async({value:a})=>{e.setTheme(a.theme),e.setPrismThemeUrl(a.prismThemeUrl||null),e.setCustomFontFamily(a.customFontFamily),e.setCustomFontSize(a.customFontSize),e.setChatMaxWidth(a.chatMaxWidth),a.customThemeColors&&Object.entries(a.customThemeColors).forEach(([o,l])=>{e.setCustomThemeColor(o,l)})},validators:{onChangeAsync:DHe,onChangeAsyncDebounceMs:300}});E.useEffect(()=>{n.reset({theme:t.theme??"system",prismThemeUrl:t.prismThemeUrl??"",customFontFamily:t.customFontFamily??"",customFontSize:t.customFontSize??16,chatMaxWidth:t.chatMaxWidth??"max-w-7xl",customThemeColors:t._rawCustomThemeColors??{}})},[t.theme,t.prismThemeUrl,t.customFontFamily,t.customFontSize,t.chatMaxWidth,t._rawCustomThemeColors]);const r=()=>{window.confirm("Are you sure you want to reset all Theme settings to their defaults?")&&e.resetThemeSettings()},s=[{value:"max-w-3xl",label:"Very Small"},{value:"max-w-4xl",label:"Small"},{value:"max-w-5xl",label:"Medium"},{value:"max-w-6xl",label:"Large"},{value:"max-w-7xl",label:"Very Large"},{value:"max-w-full",label:"Full Width"}],i=[{key:"background",label:"Background"},{key:"foreground",label:"Foreground"},{key:"card",label:"Card BG"},{key:"cardForeground",label:"Card FG"},{key:"popover",label:"Popover BG"},{key:"popoverForeground",label:"Popover FG"},{key:"primary",label:"Primary"},{key:"primaryForeground",label:"Primary FG"},{key:"secondary",label:"Secondary"},{key:"secondaryForeground",label:"Secondary FG"},{key:"muted",label:"Muted BG"},{key:"mutedForeground",label:"Muted FG"},{key:"accent",label:"Accent"},{key:"accentForeground",label:"Accent FG"},{key:"destructive",label:"Destructive"},{key:"destructiveForeground",label:"Destructive FG"},{key:"border",label:"Border"},{key:"input",label:"Input BG"},{key:"ring",label:"Ring (Focus)"},{key:"sidebar",label:"Sidebar BG"},{key:"sidebarForeground",label:"Sidebar FG"},{key:"sidebarPrimary",label:"Sidebar Primary"},{key:"sidebarPrimaryForeground",label:"Sidebar Primary FG"},{key:"sidebarAccent",label:"Sidebar Accent"},{key:"sidebarAccentForeground",label:"Sidebar Accent FG"},{key:"sidebarBorder",label:"Sidebar Border"},{key:"sidebarRing",label:"Sidebar Ring"},{key:"chart1",label:"Chart 1"},{key:"chart2",label:"Chart 2"},{key:"chart3",label:"Chart 3"},{key:"chart4",label:"Chart 4"},{key:"chart5",label:"Chart 5"}];return f.jsxs("form",{onSubmit:a=>{a.preventDefault(),a.stopPropagation(),n.handleSubmit()},className:"space-y-4 p-1",children:[f.jsx(vx,{title:"Base Theme",description:"Select the overall look and feel.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx(jt,{htmlFor:"theme-select",className:"font-medium",children:"Theme"}),f.jsx(Lx,{form:n,name:"theme",label:"Theme",options:[{value:"light",label:"Default Light"},{value:"dark",label:"Default Dark"},{value:"system",label:"System"},{value:"TijuLight",label:"Tiju Light"},{value:"TijuDark",label:"Tiju Dark"},{value:"custom",label:"User Custom"}],triggerClassName:"w-[180px]"})]})}),f.jsxs(vx,{title:"Font & Layout",description:"Customize typography and content width.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card space-y-3",children:[f.jsxs("div",{children:[f.jsx(Zw,{form:n,name:"customFontFamily",label:"Custom Font Family",placeholder:"e.g., 'Inter', sans-serif (Leave blank for default)",className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Applies only when 'User Custom' theme is selected. Ensure the font is available (system or web font)."})]}),f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(Cc,{form:n,name:"customFontSize",label:`Base Font Size (${n.getFieldValue("customFontSize")}px)`,min:12,max:20,step:1,className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Applies only when 'User Custom' theme is selected. Affects base text size (Default: 16px)."})]}),f.jsxs("div",{children:[f.jsx(Lx,{form:n,name:"chatMaxWidth",label:"Chat Content Max Width",options:s,triggerClassName:"w-full mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Controls the maximum width of the main chat message area."})]})]}),f.jsxs(vx,{title:"Code Block Theme",description:"Customize syntax highlighting appearance.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card space-y-3",children:[f.jsx(Lx,{form:n,name:"prismThemeUrl",label:"Code Block Theme",options:PHe,triggerClassName:"w-full"}),f.jsx(Zw,{form:n,name:"prismThemeUrl",label:"Or paste custom theme URL here...",placeholder:"Or paste custom theme URL here...",type:"url",className:"mt-1"}),f.jsx("p",{className:"text-xs text-muted-foreground mt-1",children:"Select a preset theme or paste a URL to a PrismJS CSS file. Leave blank or select 'Default' to use themes matching light/dark mode."})]}),n.getFieldValue("theme")==="custom"&&f.jsx(vx,{title:"Custom Theme Colors",description:"Define custom colors. Use valid CSS color values (hex, rgb, oklch, etc.). Leave blank to use default light/dark theme colors.",contentClassName:"rounded-lg border p-3 shadow-sm bg-card",children:f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-4 gap-y-2",children:i.map(({key:a,label:o})=>{var l;return f.jsx(jHe,{label:o,colorKey:a,value:(l=n.getFieldValue("customThemeColors"))==null?void 0:l[a],onChange:(c,u)=>n.setFieldValue(`customThemeColors.${c}`,u===null?"":u)},a)})})}),f.jsx(Fm,{}),f.jsxs("div",{className:"flex justify-between pt-3",children:[f.jsxs(ct,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(b1,{className:"mr-2 h-4 w-4"}),"Reset Theme Settings"]}),f.jsx(ct,{type:"submit",size:"sm",className:"bg-primary text-primary-foreground hover:bg-primary/90",children:"Apply Theme Settings"})]})]})},LHe=Ve.memo(FHe);class BHe{constructor(){ue(this,"id","core-settings-theme");ue(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"theme",title:"Theme",component:LHe,order:20})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const $He=({provider:e,apiKeys:t,onEdit:n,onDelete:r,onFetchModels:s,onUpdate:i,fetchStatus:a,isDeleting:o,allAvailableModelsForView:l})=>{var N,I;const[c,u]=E.useState(!0),d=ly(e.type),h=z2(e.type),m=ym(e.type),y=a==="fetching"||o,b=o||a==="fetching",v=o||a==="fetching",x=E.useMemo(()=>new Set(e.enabledModels??[]),[e.enabledModels]),w=e.apiKeyId?t.some(O=>O.id===e.apiKeyId):!1,S=d&&!w,k=E.useCallback(async(O,B)=>{const D=new Set(e.enabledModels??[]);B?D.add(O):D.delete(O);const H=Array.from(D);try{await i(e.id,{enabledModels:H})}catch(P){Te.error("Failed to update model status."),console.error("Failed to save model toggle:",P)}},[e.enabledModels,e.id,i]),C=()=>u(O=>!O),T=((N=e.enabledModels)==null?void 0:N.length)??0,A=l.length;return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center space-x-3 min-w-0",children:[f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{children:f.jsx("span",{className:Ze("h-2.5 w-2.5 rounded-full flex-shrink-0 block",a==="error"?"bg-destructive animate-pulse":e.isEnabled?"bg-green-500":"bg-muted-foreground")})}),f.jsx(Cr,{side:"top",children:a==="error"?"Error fetching models":e.isEnabled?"Enabled":"Disabled"})]})}),f.jsx("h3",{className:"font-semibold text-lg text-card-foreground truncate",children:e.name}),f.jsxs("span",{className:"text-sm text-muted-foreground flex-shrink-0",children:["(",e.type,")"]}),S&&f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{children:f.jsx(Kl,{className:"h-4 w-4 text-amber-500 flex-shrink-0"})}),f.jsx(Cr,{side:"top",children:f.jsx("p",{children:"API Key required but none linked/found."})})]})})]}),f.jsxs("div",{className:"flex items-center space-x-1 flex-shrink-0",children:[f.jsx(qn,{tooltipText:"Edit",onClick:n,disabled:b,"aria-label":"Edit provider",icon:f.jsx(y1,{}),className:"h-8 w-8"}),f.jsx(qn,{tooltipText:"Delete",onClick:r,disabled:v,className:"text-destructive hover:text-destructive/80 h-8 w-8","aria-label":"Delete provider",icon:o?f.jsx(Jn,{className:"h-4 w-4 animate-spin"}):f.jsx(Po,{})})]})]}),f.jsxs("div",{className:"text-sm text-muted-foreground mt-1 space-y-1 pl-5",children:[d&&f.jsxs("div",{children:["API Key:"," ",e.apiKeyId?w?f.jsx("span",{className:"text-green-400",children:((I=t.find(O=>O.id===e.apiKeyId))==null?void 0:I.name)||"Linked (Unnamed Key)"}):f.jsx("span",{className:"text-destructive",children:"Linked Key Missing!"}):f.jsx("span",{className:"text-amber-400",children:"Not Linked"})]}),h&&f.jsxs("div",{children:["Base URL: ",e.baseURL||"Not Set"]}),f.jsxs("div",{children:["Auto-fetch Models:"," ",e.autoFetchModels?f.jsx("span",{className:"text-green-400",children:"Enabled"}):f.jsx("span",{className:"text-muted-foreground/80",children:"Disabled"}),e.fetchedModels&&f.jsxs("span",{className:"text-xs text-muted-foreground/80 ml-2",children:["(Last fetched:"," ",e.modelsLastFetchedAt?new Date(e.modelsLastFetchedAt).toLocaleString():"Never",")"]})]}),m&&f.jsx("div",{className:"pt-1",children:f.jsxs(ct,{variant:"outline",size:"sm",onClick:s,disabled:y,className:"text-xs h-7 px-2",children:[a==="fetching"&&f.jsx(Jn,{className:"h-3 w-3 mr-1 animate-spin"}),a==="success"&&f.jsx(co,{className:"h-3 w-3 mr-1 text-green-500"}),a==="error"&&f.jsx(Kl,{className:"h-3 w-3 mr-1 text-destructive"}),a==="idle"&&f.jsx(_m,{className:"h-3 w-3 mr-1"}),a==="fetching"?"Fetching...":a==="error"?"Fetch Failed":"Fetch Models Now"]})})]}),f.jsxs("div",{className:"space-y-1 pt-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("span",{className:"font-medium text-card-foreground text-sm",children:["Model Enablement (",T," / ",A," enabled)"]}),f.jsx(qn,{tooltipText:c?"Show Models":"Hide Models",onClick:C,"aria-label":c?"Show model list":"Hide model list",icon:c?f.jsx(Ql,{}):f.jsx(Xh,{}),className:"h-6 w-6"})]}),!c&&f.jsx($F,{providerId:e.id,allAvailableModels:l,enabledModelIds:x,onToggleModel:k,isLoading:a==="fetching",disabled:o,listHeightClass:"h-[26rem]"})]})]})},zHe=Ve.memo($He),UHe=({providerId:e,editData:t,apiKeys:n,allAvailableModels:r,isSaving:s,onCancel:i,onSave:a,onChange:o})=>{const l=E.useMemo(()=>new Set(t.enabledModels??[]),[t.enabledModels]),c=E.useCallback((d,h)=>{const m=new Set(t.enabledModels??[]);h?m.add(d):m.delete(d);const y=Array.from(m);o("enabledModels",y)},[t.enabledModels,o]),u=E.useCallback((d,h)=>new Promise(m=>{o(d,h),m(void 0)}),[o]);return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-md font-semibold text-card-foreground mb-2",children:"Basic Configuration"}),f.jsx(Mte,{initialData:t,onChange:u,onSubmit:a,onCancel:i,apiKeys:n,disabled:s})]}),f.jsxs("div",{className:"space-y-3",children:[f.jsx("h4",{className:"text-md font-semibold text-card-foreground",children:"Model Enablement"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Toggle models on/off for global use. Changes will be saved with the form."}),f.jsx($F,{providerId:e,allAvailableModels:r,enabledModelIds:l,onToggleModel:c,disabled:s,listHeightClass:"h-[calc(100%-8rem)]"})]})]})})},qHe=Ve.memo(UHe),VHe=({provider:e,apiKeys:t,onUpdate:n,onDelete:r,onFetchModels:s,fetchStatus:i,onSelectModelForDetails:a})=>{const[o,l]=E.useState(!1),[c,u]=E.useState(!1),[d,h]=E.useState(!1),[m,y]=E.useState({name:"placeholder"}),b=Qn(I=>I.getAllAvailableModelDefsForProvider),[v,x]=E.useState([]),w=E.useMemo(()=>[...b(e.id)].sort((O,B)=>(O.name||O.id).localeCompare(B.name||B.id)),[e.id,b]);E.useEffect(()=>{if(o){const I=b(e.id);x([...I].sort((O,B)=>(O.name||O.id).localeCompare(B.name||B.id))),y({name:e.name,type:e.type,isEnabled:e.isEnabled,apiKeyId:e.apiKeyId,baseURL:e.baseURL,enabledModels:e.enabledModels??[],autoFetchModels:e.autoFetchModels})}else x([])},[o,e.id,e.name,e.type,e.isEnabled,e.apiKeyId,e.baseURL,e.enabledModels,e.autoFetchModels,b]);const S=()=>l(!0),k=()=>{l(!1),y({}),u(!1)},C=E.useCallback(async()=>{u(!0);try{const I=m.enabledModels&&m.enabledModels.length>0?m.enabledModels:null,O={name:m.name,type:m.type,isEnabled:m.isEnabled,apiKeyId:m.apiKeyId,baseURL:m.baseURL,autoFetchModels:m.autoFetchModels,enabledModels:I};Object.keys(O).forEach(B=>{O[B]===void 0&&delete O[B]}),await n(e.id,O),l(!1),y({}),Te.success(`Provider "${O.name||e.name}" updated.`)}catch(I){console.error("Failed to save provider update:",I),Te.error("Failed to save provider configuration.")}finally{u(!1)}},[m,n,e.id,e.name]),T=E.useCallback((I,O)=>{y(B=>({...B,[I]:O}))},[]),A=E.useCallback(async()=>{if(window.confirm(`Delete provider "${e.name}"?`)){h(!0);try{await r(e.id)}catch(I){console.error("Failed to delete provider:",I),h(!1)}}},[r,e.id,e.name]),N=E.useCallback(async()=>{if(await s(e.id),o){const I=b(e.id);x([...I].sort((O,B)=>(O.name||O.id).localeCompare(B.name||B.id)))}},[s,e.id,o,b]);return f.jsx("div",{className:"border border-border p-4 space-y-3 bg-card rounded-md shadow-sm",children:o?f.jsx(qHe,{providerId:e.id,editData:m,apiKeys:t,allAvailableModels:v,isSaving:c,onCancel:k,onSave:C,onChange:T}):f.jsx(zHe,{provider:e,apiKeys:t,onEdit:S,onDelete:A,onFetchModels:N,onUpdate:n,fetchStatus:i,isDeleting:d,onSelectModelForDetails:a,allAvailableModelsForView:w})})},WHe=Ve.memo(VHe);function HHe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return E.useMemo(()=>r=>{t.forEach(s=>s(r))},t)}const JT=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Sb(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function o6(e){return"nodeType"in e}function Ko(e){var t,n;return e?Sb(e)?e:o6(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function l6(e){const{Document:t}=Ko(e);return e instanceof t}function d_(e){return Sb(e)?!1:e instanceof Ko(e).HTMLElement}function hie(e){return e instanceof Ko(e).SVGElement}function Cb(e){return e?Sb(e)?e.document:o6(e)?l6(e)?e:d_(e)||hie(e)?e.ownerDocument:document:document:document}const Bu=JT?E.useLayoutEffect:E.useEffect;function c6(e){const t=E.useRef(e);return Bu(()=>{t.current=e}),E.useCallback(function(){for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return t.current==null?void 0:t.current(...r)},[])}function GHe(){const e=E.useRef(null),t=E.useCallback((r,s)=>{e.current=setInterval(r,s)},[]),n=E.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function t1(e,t){t===void 0&&(t=[e]);const n=E.useRef(e);return Bu(()=>{n.current!==e&&(n.current=e)},t),n}function f_(e,t){const n=E.useRef();return E.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function Pk(e){const t=c6(e),n=E.useRef(null),r=E.useCallback(s=>{s!==n.current&&(t==null||t(s,n.current)),n.current=s},[]);return[n,r]}function $4(e){const t=E.useRef();return E.useEffect(()=>{t.current=e},[e]),t.current}let C3={};function h_(e,t){return E.useMemo(()=>{if(t)return t;const n=C3[e]==null?0:C3[e]+1;return C3[e]=n,e+"-"+n},[e,t])}function pie(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return r.reduce((i,a)=>{const o=Object.entries(a);for(const[l,c]of o){const u=i[l];u!=null&&(i[l]=u+e*c)}return i},{...t})}}const q0=pie(1),n1=pie(-1);function KHe(e){return"clientX"in e&&"clientY"in e}function u6(e){if(!e)return!1;const{KeyboardEvent:t}=Ko(e.target);return t&&e instanceof t}function YHe(e){if(!e)return!1;const{TouchEvent:t}=Ko(e.target);return t&&e instanceof t}function z4(e){if(YHe(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return KHe(e)?{x:e.clientX,y:e.clientY}:null}const r1=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[r1.Translate.toString(e),r1.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),Kq="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function ZHe(e){return e.matches(Kq)?e:e.querySelector(Kq)}const XHe={display:"none"};function JHe(e){let{id:t,value:n}=e;return Ve.createElement("div",{id:t,style:XHe},n)}function QHe(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const s={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return Ve.createElement("div",{id:t,style:s,role:"status","aria-live":r,"aria-atomic":!0},n)}function eGe(){const[e,t]=E.useState("");return{announce:E.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const mie=E.createContext(null);function tGe(e){const t=E.useContext(mie);E.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function nGe(){const[e]=E.useState(()=>new Set),t=E.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[E.useCallback(r=>{let{type:s,event:i}=r;e.forEach(a=>{var o;return(o=a[s])==null?void 0:o.call(a,i)})},[e]),t]}const rGe={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},sGe={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function iGe(e){let{announcements:t=sGe,container:n,hiddenTextDescribedById:r,screenReaderInstructions:s=rGe}=e;const{announce:i,announcement:a}=eGe(),o=h_("DndLiveRegion"),[l,c]=E.useState(!1);if(E.useEffect(()=>{c(!0)},[]),tGe(E.useMemo(()=>({onDragStart(d){let{active:h}=d;i(t.onDragStart({active:h}))},onDragMove(d){let{active:h,over:m}=d;t.onDragMove&&i(t.onDragMove({active:h,over:m}))},onDragOver(d){let{active:h,over:m}=d;i(t.onDragOver({active:h,over:m}))},onDragEnd(d){let{active:h,over:m}=d;i(t.onDragEnd({active:h,over:m}))},onDragCancel(d){let{active:h,over:m}=d;i(t.onDragCancel({active:h,over:m}))}}),[i,t])),!l)return null;const u=Ve.createElement(Ve.Fragment,null,Ve.createElement(JHe,{id:r,value:s.draggable}),Ve.createElement(QHe,{id:o,announcement:a}));return n?dl.createPortal(u,n):u}var Ui;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Ui||(Ui={}));function Ok(){}function Yq(e,t){return E.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function aGe(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return E.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const Uc=Object.freeze({x:0,y:0});function gie(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function yie(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function oGe(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function Zq(e){let{left:t,top:n,height:r,width:s}=e;return[{x:t,y:n},{x:t+s,y:n},{x:t,y:n+r},{x:t+s,y:n+r}]}function bie(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function Xq(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const lGe=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=Xq(t,t.left,t.top),i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=gie(Xq(l),s);i.push({id:o,data:{droppableContainer:a,value:c}})}}return i.sort(yie)},cGe=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=Zq(t),i=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const c=Zq(l),u=s.reduce((h,m,y)=>h+gie(c[y],m),0),d=Number((u/4).toFixed(4));i.push({id:o,data:{droppableContainer:a,value:d}})}}return i.sort(yie)};function uGe(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),s=Math.min(t.left+t.width,e.left+e.width),i=Math.min(t.top+t.height,e.top+e.height),a=s-r,o=i-n;if(r<s&&n<i){const l=t.width*t.height,c=e.width*e.height,u=a*o,d=u/(l+c-u);return Number(d.toFixed(4))}return 0}const dGe=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const s=[];for(const i of r){const{id:a}=i,o=n.get(a);if(o){const l=uGe(o,t);l>0&&s.push({id:a,data:{droppableContainer:i,value:l}})}}return s.sort(oGe)};function fGe(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function vie(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:Uc}function hGe(e){return function(n){for(var r=arguments.length,s=new Array(r>1?r-1:0),i=1;i<r;i++)s[i-1]=arguments[i];return s.reduce((a,o)=>({...a,top:a.top+e*o.y,bottom:a.bottom+e*o.y,left:a.left+e*o.x,right:a.right+e*o.x}),{...n})}}const pGe=hGe(1);function mGe(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function gGe(e,t,n){const r=mGe(t);if(!r)return e;const{scaleX:s,scaleY:i,x:a,y:o}=r,l=e.left-a-(1-s)*parseFloat(n),c=e.top-o-(1-i)*parseFloat(n.slice(n.indexOf(" ")+1)),u=s?e.width/s:e.width,d=i?e.height/i:e.height;return{width:u,height:d,top:c,right:l+u,bottom:c+d,left:l}}const yGe={ignoreTransform:!1};function kb(e,t){t===void 0&&(t=yGe);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:c,transformOrigin:u}=Ko(e).getComputedStyle(e);c&&(n=gGe(n,c,u))}const{top:r,left:s,width:i,height:a,bottom:o,right:l}=n;return{top:r,left:s,width:i,height:a,bottom:o,right:l}}function Jq(e){return kb(e,{ignoreTransform:!0})}function bGe(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function vGe(e,t){return t===void 0&&(t=Ko(e).getComputedStyle(e)),t.position==="fixed"}function xGe(e,t){t===void 0&&(t=Ko(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(s=>{const i=t[s];return typeof i=="string"?n.test(i):!1})}function QT(e,t){const n=[];function r(s){if(t!=null&&n.length>=t||!s)return n;if(l6(s)&&s.scrollingElement!=null&&!n.includes(s.scrollingElement))return n.push(s.scrollingElement),n;if(!d_(s)||hie(s)||n.includes(s))return n;const i=Ko(e).getComputedStyle(s);return s!==e&&xGe(s,i)&&n.push(s),vGe(s,i)?n:r(s.parentNode)}return e?r(e):n}function xie(e){const[t]=QT(e,1);return t??null}function k3(e){return!JT||!e?null:Sb(e)?e:o6(e)?l6(e)||e===Cb(e).scrollingElement?window:d_(e)?e:null:null}function wie(e){return Sb(e)?e.scrollX:e.scrollLeft}function _ie(e){return Sb(e)?e.scrollY:e.scrollTop}function U4(e){return{x:wie(e),y:_ie(e)}}var aa;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(aa||(aa={}));function Sie(e){return!JT||!e?!1:e===document.scrollingElement}function Cie(e){const t={x:0,y:0},n=Sie(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},s=e.scrollTop<=t.y,i=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,o=e.scrollLeft>=r.x;return{isTop:s,isLeft:i,isBottom:a,isRight:o,maxScroll:r,minScroll:t}}const wGe={x:.2,y:.2};function _Ge(e,t,n,r,s){let{top:i,left:a,right:o,bottom:l}=n;r===void 0&&(r=10),s===void 0&&(s=wGe);const{isTop:c,isBottom:u,isLeft:d,isRight:h}=Cie(e),m={x:0,y:0},y={x:0,y:0},b={height:t.height*s.y,width:t.width*s.x};return!c&&i<=t.top+b.height?(m.y=aa.Backward,y.y=r*Math.abs((t.top+b.height-i)/b.height)):!u&&l>=t.bottom-b.height&&(m.y=aa.Forward,y.y=r*Math.abs((t.bottom-b.height-l)/b.height)),!h&&o>=t.right-b.width?(m.x=aa.Forward,y.x=r*Math.abs((t.right-b.width-o)/b.width)):!d&&a<=t.left+b.width&&(m.x=aa.Backward,y.x=r*Math.abs((t.left+b.width-a)/b.width)),{direction:m,speed:y}}function SGe(e){if(e===document.scrollingElement){const{innerWidth:i,innerHeight:a}=window;return{top:0,left:0,right:i,bottom:a,width:i,height:a}}const{top:t,left:n,right:r,bottom:s}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:s,width:e.clientWidth,height:e.clientHeight}}function kie(e){return e.reduce((t,n)=>q0(t,U4(n)),Uc)}function CGe(e){return e.reduce((t,n)=>t+wie(n),0)}function kGe(e){return e.reduce((t,n)=>t+_ie(n),0)}function EGe(e,t){if(t===void 0&&(t=kb),!e)return;const{top:n,left:r,bottom:s,right:i}=t(e);xie(e)&&(s<=0||i<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const TGe=[["x",["left","right"],CGe],["y",["top","bottom"],kGe]];class d6{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=QT(n),s=kie(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[i,a,o]of TGe)for(const l of a)Object.defineProperty(this,l,{get:()=>{const c=o(r),u=s[i]-c;return this.rect[l]+u},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class $x{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var s;(s=this.target)==null||s.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function AGe(e){const{EventTarget:t}=Ko(e);return e instanceof t?e:Cb(e)}function E3(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var zl;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(zl||(zl={}));function Qq(e){e.preventDefault()}function RGe(e){e.stopPropagation()}var Hr;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Hr||(Hr={}));const Eie={start:[Hr.Space,Hr.Enter],cancel:[Hr.Esc],end:[Hr.Space,Hr.Enter,Hr.Tab]},NGe=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Hr.Right:return{...n,x:n.x+25};case Hr.Left:return{...n,x:n.x-25};case Hr.Down:return{...n,y:n.y+25};case Hr.Up:return{...n,y:n.y-25}}};class f6{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new $x(Cb(n)),this.windowListeners=new $x(Ko(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(zl.Resize,this.handleCancel),this.windowListeners.add(zl.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(zl.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&EGe(r),n(Uc)}handleKeyDown(t){if(u6(t)){const{active:n,context:r,options:s}=this.props,{keyboardCodes:i=Eie,coordinateGetter:a=NGe,scrollBehavior:o="smooth"}=s,{code:l}=t;if(i.end.includes(l)){this.handleEnd(t);return}if(i.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:c}=r.current,u=c?{x:c.left,y:c.top}:Uc;this.referenceCoordinates||(this.referenceCoordinates=u);const d=a(t,{active:n,context:r.current,currentCoordinates:u});if(d){const h=n1(d,u),m={x:0,y:0},{scrollableAncestors:y}=r.current;for(const b of y){const v=t.code,{isTop:x,isRight:w,isLeft:S,isBottom:k,maxScroll:C,minScroll:T}=Cie(b),A=SGe(b),N={x:Math.min(v===Hr.Right?A.right-A.width/2:A.right,Math.max(v===Hr.Right?A.left:A.left+A.width/2,d.x)),y:Math.min(v===Hr.Down?A.bottom-A.height/2:A.bottom,Math.max(v===Hr.Down?A.top:A.top+A.height/2,d.y))},I=v===Hr.Right&&!w||v===Hr.Left&&!S,O=v===Hr.Down&&!k||v===Hr.Up&&!x;if(I&&N.x!==d.x){const B=b.scrollLeft+h.x,D=v===Hr.Right&&B<=C.x||v===Hr.Left&&B>=T.x;if(D&&!h.y){b.scrollTo({left:B,behavior:o});return}D?m.x=b.scrollLeft-B:m.x=v===Hr.Right?b.scrollLeft-C.x:b.scrollLeft-T.x,m.x&&b.scrollBy({left:-m.x,behavior:o});break}else if(O&&N.y!==d.y){const B=b.scrollTop+h.y,D=v===Hr.Down&&B<=C.y||v===Hr.Up&&B>=T.y;if(D&&!h.x){b.scrollTo({top:B,behavior:o});return}D?m.y=b.scrollTop-B:m.y=v===Hr.Down?b.scrollTop-C.y:b.scrollTop-T.y,m.y&&b.scrollBy({top:-m.y,behavior:o});break}}this.handleMove(t,q0(n1(d,this.referenceCoordinates),m))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}f6.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=Eie,onActivation:s}=t,{active:i}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const o=i.activatorNode.current;return o&&e.target!==o?!1:(e.preventDefault(),s==null||s({event:e.nativeEvent}),!0)}return!1}}];function eV(e){return!!(e&&"distance"in e)}function tV(e){return!!(e&&"delay"in e)}class h6{constructor(t,n,r){var s;r===void 0&&(r=AGe(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:i}=t,{target:a}=i;this.props=t,this.events=n,this.document=Cb(a),this.documentListeners=new $x(this.document),this.listeners=new $x(r),this.windowListeners=new $x(Ko(a)),this.initialCoordinates=(s=z4(i))!=null?s:Uc,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(zl.Resize,this.handleCancel),this.windowListeners.add(zl.DragStart,Qq),this.windowListeners.add(zl.VisibilityChange,this.handleCancel),this.windowListeners.add(zl.ContextMenu,Qq),this.documentListeners.add(zl.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(tV(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(eV(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:s}=this.props;s(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(zl.Click,RGe,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(zl.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:s,props:i}=this,{onMove:a,options:{activationConstraint:o}}=i;if(!s)return;const l=(n=z4(t))!=null?n:Uc,c=n1(s,l);if(!r&&o){if(eV(o)){if(o.tolerance!=null&&E3(c,o.tolerance))return this.handleCancel();if(E3(c,o.distance))return this.handleStart()}if(tV(o)&&E3(c,o.tolerance))return this.handleCancel();this.handlePending(o,c);return}t.cancelable&&t.preventDefault(),a(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===Hr.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const MGe={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class p6 extends h6{constructor(t){const{event:n}=t,r=Cb(n.target);super(t,MGe,r)}}p6.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const IGe={move:{name:"mousemove"},end:{name:"mouseup"}};var q4;(function(e){e[e.RightClick=2]="RightClick"})(q4||(q4={}));class jGe extends h6{constructor(t){super(t,IGe,Cb(t.event.target))}}jGe.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===q4.RightClick?!1:(r==null||r({event:n}),!0)}}];const T3={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class PGe extends h6{constructor(t){super(t,T3)}static setup(){return window.addEventListener(T3.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(T3.move.name,t)};function t(){}}}PGe.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:s}=n;return s.length>1?!1:(r==null||r({event:n}),!0)}}];var zx;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(zx||(zx={}));var Dk;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(Dk||(Dk={}));function OGe(e){let{acceleration:t,activator:n=zx.Pointer,canScroll:r,draggingRect:s,enabled:i,interval:a=5,order:o=Dk.TreeOrder,pointerCoordinates:l,scrollableAncestors:c,scrollableAncestorRects:u,delta:d,threshold:h}=e;const m=FGe({delta:d,disabled:!i}),[y,b]=GHe(),v=E.useRef({x:0,y:0}),x=E.useRef({x:0,y:0}),w=E.useMemo(()=>{switch(n){case zx.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case zx.DraggableRect:return s}},[n,s,l]),S=E.useRef(null),k=E.useCallback(()=>{const T=S.current;if(!T)return;const A=v.current.x*x.current.x,N=v.current.y*x.current.y;T.scrollBy(A,N)},[]),C=E.useMemo(()=>o===Dk.TreeOrder?[...c].reverse():c,[o,c]);E.useEffect(()=>{if(!i||!c.length||!w){b();return}for(const T of C){if((r==null?void 0:r(T))===!1)continue;const A=c.indexOf(T),N=u[A];if(!N)continue;const{direction:I,speed:O}=_Ge(T,N,w,t,h);for(const B of["x","y"])m[B][I[B]]||(O[B]=0,I[B]=0);if(O.x>0||O.y>0){b(),S.current=T,y(k,a),v.current=O,x.current=I;return}}v.current={x:0,y:0},x.current={x:0,y:0},b()},[t,k,r,b,i,a,JSON.stringify(w),JSON.stringify(m),y,c,C,u,JSON.stringify(h)])}const DGe={x:{[aa.Backward]:!1,[aa.Forward]:!1},y:{[aa.Backward]:!1,[aa.Forward]:!1}};function FGe(e){let{delta:t,disabled:n}=e;const r=$4(t);return f_(s=>{if(n||!r||!s)return DGe;const i={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[aa.Backward]:s.x[aa.Backward]||i.x===-1,[aa.Forward]:s.x[aa.Forward]||i.x===1},y:{[aa.Backward]:s.y[aa.Backward]||i.y===-1,[aa.Forward]:s.y[aa.Forward]||i.y===1}}},[n,t,r])}function LGe(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return f_(s=>{var i;return t==null?null:(i=r??s)!=null?i:null},[r,t])}function BGe(e,t){return E.useMemo(()=>e.reduce((n,r)=>{const{sensor:s}=r,i=s.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...i]},[]),[e,t])}var s1;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(s1||(s1={}));var V4;(function(e){e.Optimized="optimized"})(V4||(V4={}));const nV=new Map;function $Ge(e,t){let{dragging:n,dependencies:r,config:s}=t;const[i,a]=E.useState(null),{frequency:o,measure:l,strategy:c}=s,u=E.useRef(e),d=v(),h=t1(d),m=E.useCallback(function(x){x===void 0&&(x=[]),!h.current&&a(w=>w===null?x:w.concat(x.filter(S=>!w.includes(S))))},[h]),y=E.useRef(null),b=f_(x=>{if(d&&!n)return nV;if(!x||x===nV||u.current!==e||i!=null){const w=new Map;for(let S of e){if(!S)continue;if(i&&i.length>0&&!i.includes(S.id)&&S.rect.current){w.set(S.id,S.rect.current);continue}const k=S.node.current,C=k?new d6(l(k),k):null;S.rect.current=C,C&&w.set(S.id,C)}return w}return x},[e,i,n,d,l]);return E.useEffect(()=>{u.current=e},[e]),E.useEffect(()=>{d||m()},[n,d]),E.useEffect(()=>{i&&i.length>0&&a(null)},[JSON.stringify(i)]),E.useEffect(()=>{d||typeof o!="number"||y.current!==null||(y.current=setTimeout(()=>{m(),y.current=null},o))},[o,d,m,...r]),{droppableRects:b,measureDroppableContainers:m,measuringScheduled:i!=null};function v(){switch(c){case s1.Always:return!1;case s1.BeforeDragging:return n;default:return!n}}}function Tie(e,t){return f_(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function zGe(e,t){return Tie(e,t)}function UGe(e){let{callback:t,disabled:n}=e;const r=c6(t),s=E.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:i}=window;return new i(r)},[r,n]);return E.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function eA(e){let{callback:t,disabled:n}=e;const r=c6(t),s=E.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:i}=window;return new i(r)},[n]);return E.useEffect(()=>()=>s==null?void 0:s.disconnect(),[s]),s}function qGe(e){return new d6(kb(e),e)}function rV(e,t,n){t===void 0&&(t=qGe);const[r,s]=E.useState(null);function i(){s(l=>{if(!e)return null;if(e.isConnected===!1){var c;return(c=l??n)!=null?c:null}const u=t(e);return JSON.stringify(l)===JSON.stringify(u)?l:u})}const a=UGe({callback(l){if(e)for(const c of l){const{type:u,target:d}=c;if(u==="childList"&&d instanceof HTMLElement&&d.contains(e)){i();break}}}}),o=eA({callback:i});return Bu(()=>{i(),e?(o==null||o.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(o==null||o.disconnect(),a==null||a.disconnect())},[e]),r}function VGe(e){const t=Tie(e);return vie(e,t)}const sV=[];function WGe(e){const t=E.useRef(e),n=f_(r=>e?r&&r!==sV&&e&&t.current&&e.parentNode===t.current.parentNode?r:QT(e):sV,[e]);return E.useEffect(()=>{t.current=e},[e]),n}function HGe(e){const[t,n]=E.useState(null),r=E.useRef(e),s=E.useCallback(i=>{const a=k3(i.target);a&&n(o=>o?(o.set(a,U4(a)),new Map(o)):null)},[]);return E.useEffect(()=>{const i=r.current;if(e!==i){a(i);const o=e.map(l=>{const c=k3(l);return c?(c.addEventListener("scroll",s,{passive:!0}),[c,U4(c)]):null}).filter(l=>l!=null);n(o.length?new Map(o):null),r.current=e}return()=>{a(e),a(i)};function a(o){o.forEach(l=>{const c=k3(l);c==null||c.removeEventListener("scroll",s)})}},[s,e]),E.useMemo(()=>e.length?t?Array.from(t.values()).reduce((i,a)=>q0(i,a),Uc):kie(e):Uc,[e,t])}function iV(e,t){t===void 0&&(t=[]);const n=E.useRef(null);return E.useEffect(()=>{n.current=null},t),E.useEffect(()=>{const r=e!==Uc;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?n1(e,n.current):Uc}function GGe(e){E.useEffect(()=>{if(!JT)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function KGe(e,t){return E.useMemo(()=>e.reduce((n,r)=>{let{eventName:s,handler:i}=r;return n[s]=a=>{i(a,t)},n},{}),[e,t])}function Aie(e){return E.useMemo(()=>e?bGe(e):null,[e])}const aV=[];function YGe(e,t){t===void 0&&(t=kb);const[n]=e,r=Aie(n?Ko(n):null),[s,i]=E.useState(aV);function a(){i(()=>e.length?e.map(l=>Sie(l)?r:new d6(t(l),l)):aV)}const o=eA({callback:a});return Bu(()=>{o==null||o.disconnect(),a(),e.forEach(l=>o==null?void 0:o.observe(l))},[e]),s}function ZGe(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return d_(t)?t:e}function XGe(e){let{measure:t}=e;const[n,r]=E.useState(null),s=E.useCallback(c=>{for(const{target:u}of c)if(d_(u)){r(d=>{const h=t(u);return d?{...d,width:h.width,height:h.height}:h});break}},[t]),i=eA({callback:s}),a=E.useCallback(c=>{const u=ZGe(c);i==null||i.disconnect(),u&&(i==null||i.observe(u)),r(u?t(u):null)},[t,i]),[o,l]=Pk(a);return E.useMemo(()=>({nodeRef:o,rect:n,setRef:l}),[n,o,l])}const JGe=[{sensor:p6,options:{}},{sensor:f6,options:{}}],QGe={current:{}},YC={draggable:{measure:Jq},droppable:{measure:Jq,strategy:s1.WhileDragging,frequency:V4.Optimized},dragOverlay:{measure:kb}};class Ux extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const eKe={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Ux,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:Ok},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:YC,measureDroppableContainers:Ok,windowRect:null,measuringScheduled:!1},tKe={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:Ok,draggableNodes:new Map,over:null,measureDroppableContainers:Ok},tA=E.createContext(tKe),Rie=E.createContext(eKe);function nKe(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Ux}}}function rKe(e,t){switch(t.type){case Ui.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Ui.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Ui.DragEnd:case Ui.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Ui.RegisterDroppable:{const{element:n}=t,{id:r}=n,s=new Ux(e.droppable.containers);return s.set(r,n),{...e,droppable:{...e.droppable,containers:s}}}case Ui.SetDroppableDisabled:{const{id:n,key:r,disabled:s}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const a=new Ux(e.droppable.containers);return a.set(n,{...i,disabled:s}),{...e,droppable:{...e.droppable,containers:a}}}case Ui.UnregisterDroppable:{const{id:n,key:r}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const i=new Ux(e.droppable.containers);return i.delete(n),{...e,droppable:{...e.droppable,containers:i}}}default:return e}}function sKe(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:s}=E.useContext(tA),i=$4(r),a=$4(n==null?void 0:n.id);return E.useEffect(()=>{if(!t&&!r&&i&&a!=null){if(!u6(i)||document.activeElement===i.target)return;const o=s.get(a);if(!o)return;const{activatorNode:l,node:c}=o;if(!l.current&&!c.current)return;requestAnimationFrame(()=>{for(const u of[l.current,c.current]){if(!u)continue;const d=ZHe(u);if(d){d.focus();break}}})}},[r,t,s,a,i]),null}function iKe(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((s,i)=>i({transform:s,...r}),n):n}function aKe(e){return E.useMemo(()=>({draggable:{...YC.draggable,...e==null?void 0:e.draggable},droppable:{...YC.droppable,...e==null?void 0:e.droppable},dragOverlay:{...YC.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function oKe(e){let{activeNode:t,measure:n,initialRect:r,config:s=!0}=e;const i=E.useRef(!1),{x:a,y:o}=typeof s=="boolean"?{x:s,y:s}:s;Bu(()=>{if(!a&&!o||!t){i.current=!1;return}if(i.current||!r)return;const c=t==null?void 0:t.node.current;if(!c||c.isConnected===!1)return;const u=n(c),d=vie(u,r);if(a||(d.x=0),o||(d.y=0),i.current=!0,Math.abs(d.x)>0||Math.abs(d.y)>0){const h=xie(c);h&&h.scrollBy({top:d.y,left:d.x})}},[t,a,o,r,n])}const Nie=E.createContext({...Uc,scaleX:1,scaleY:1});var yh;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(yh||(yh={}));const lKe=E.memo(function(t){var n,r,s,i;let{id:a,accessibility:o,autoScroll:l=!0,children:c,sensors:u=JGe,collisionDetection:d=dGe,measuring:h,modifiers:m,...y}=t;const b=E.useReducer(rKe,void 0,nKe),[v,x]=b,[w,S]=nGe(),[k,C]=E.useState(yh.Uninitialized),T=k===yh.Initialized,{draggable:{active:A,nodes:N,translate:I},droppable:{containers:O}}=v,B=A!=null?N.get(A):null,D=E.useRef({initial:null,translated:null}),H=E.useMemo(()=>{var tt;return A!=null?{id:A,data:(tt=B==null?void 0:B.data)!=null?tt:QGe,rect:D}:null},[A,B]),P=E.useRef(null),[K,U]=E.useState(null),[V,L]=E.useState(null),te=t1(y,Object.values(y)),W=h_("DndDescribedBy",a),Q=E.useMemo(()=>O.getEnabled(),[O]),ee=aKe(h),{droppableRects:re,measureDroppableContainers:pe,measuringScheduled:de}=$Ge(Q,{dragging:T,dependencies:[I.x,I.y],config:ee.droppable}),Oe=LGe(N,A),Fe=E.useMemo(()=>V?z4(V):null,[V]),Se=Ue(),Ce=zGe(Oe,ee.draggable.measure);oKe({activeNode:A!=null?N.get(A):null,config:Se.layoutShiftCompensation,initialRect:Ce,measure:ee.draggable.measure});const qe=rV(Oe,ee.draggable.measure,Ce),Qe=rV(Oe?Oe.parentElement:null),We=E.useRef({activatorEvent:null,active:null,activeNode:Oe,collisionRect:null,collisions:null,droppableRects:re,draggableNodes:N,draggingNode:null,draggingNodeRect:null,droppableContainers:O,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),je=O.getNodeFor((n=We.current.over)==null?void 0:n.id),Y=XGe({measure:ee.dragOverlay.measure}),ye=(r=Y.nodeRef.current)!=null?r:Oe,Ie=T?(s=Y.rect)!=null?s:qe:null,ce=!!(Y.nodeRef.current&&Y.rect),oe=VGe(ce?null:qe),se=Aie(ye?Ko(ye):null),Me=WGe(T?je??Oe:null),Be=YGe(Me),Ae=iKe(m,{transform:{x:I.x-oe.x,y:I.y-oe.y,scaleX:1,scaleY:1},activatorEvent:V,active:H,activeNodeRect:qe,containerNodeRect:Qe,draggingNodeRect:Ie,over:We.current.over,overlayNodeRect:Y.rect,scrollableAncestors:Me,scrollableAncestorRects:Be,windowRect:se}),lt=Fe?q0(Fe,I):null,Tt=HGe(Me),dt=iV(Tt),Pt=iV(Tt,[qe]),qt=q0(Ae,dt),Ft=Ie?pGe(Ie,Ae):null,Ht=H&&Ft?d({active:H,collisionRect:Ft,droppableRects:re,droppableContainers:Q,pointerCoordinates:lt}):null,we=bie(Ht,"id"),[F,X]=E.useState(null),be=ce?Ae:q0(Ae,Pt),ke=fGe(be,(i=F==null?void 0:F.rect)!=null?i:null,qe),ge=E.useRef(null),Ee=E.useCallback((tt,ve)=>{let{sensor:_e,options:ze}=ve;if(P.current==null)return;const Ct=N.get(P.current);if(!Ct)return;const fe=tt.nativeEvent,Z=new _e({active:P.current,activeNode:Ct,event:fe,options:ze,context:We,onAbort(J){if(!N.get(J))return;const{onDragAbort:De}=te.current,He={id:J};De==null||De(He),w({type:"onDragAbort",event:He})},onPending(J,xe,De,He){if(!N.get(J))return;const{onDragPending:Qt}=te.current,On={id:J,constraint:xe,initialCoordinates:De,offset:He};Qt==null||Qt(On),w({type:"onDragPending",event:On})},onStart(J){const xe=P.current;if(xe==null)return;const De=N.get(xe);if(!De)return;const{onDragStart:He}=te.current,wt={activatorEvent:fe,active:{id:xe,data:De.data,rect:D}};dl.unstable_batchedUpdates(()=>{He==null||He(wt),C(yh.Initializing),x({type:Ui.DragStart,initialCoordinates:J,active:xe}),w({type:"onDragStart",event:wt}),U(ge.current),L(fe)})},onMove(J){x({type:Ui.DragMove,coordinates:J})},onEnd:G(Ui.DragEnd),onCancel:G(Ui.DragCancel)});ge.current=Z;function G(J){return async function(){const{active:De,collisions:He,over:wt,scrollAdjustedTranslate:Qt}=We.current;let On=null;if(De&&Qt){const{cancelDrop:Zt}=te.current;On={activatorEvent:fe,active:De,collisions:He,delta:Qt,over:wt},J===Ui.DragEnd&&typeof Zt=="function"&&await Promise.resolve(Zt(On))&&(J=Ui.DragCancel)}P.current=null,dl.unstable_batchedUpdates(()=>{x({type:J}),C(yh.Uninitialized),X(null),U(null),L(null),ge.current=null;const Zt=J===Ui.DragEnd?"onDragEnd":"onDragCancel";if(On){const nn=te.current[Zt];nn==null||nn(On),w({type:Zt,event:On})}})}}},[N]),le=E.useCallback((tt,ve)=>(_e,ze)=>{const Ct=_e.nativeEvent,fe=N.get(ze);if(P.current!==null||!fe||Ct.dndKit||Ct.defaultPrevented)return;const Z={active:fe};tt(_e,ve.options,Z)===!0&&(Ct.dndKit={capturedBy:ve.sensor},P.current=ze,Ee(_e,ve))},[N,Ee]),ft=BGe(u,le);GGe(u),Bu(()=>{qe&&k===yh.Initializing&&C(yh.Initialized)},[qe,k]),E.useEffect(()=>{const{onDragMove:tt}=te.current,{active:ve,activatorEvent:_e,collisions:ze,over:Ct}=We.current;if(!ve||!_e)return;const fe={active:ve,activatorEvent:_e,collisions:ze,delta:{x:qt.x,y:qt.y},over:Ct};dl.unstable_batchedUpdates(()=>{tt==null||tt(fe),w({type:"onDragMove",event:fe})})},[qt.x,qt.y]),E.useEffect(()=>{const{active:tt,activatorEvent:ve,collisions:_e,droppableContainers:ze,scrollAdjustedTranslate:Ct}=We.current;if(!tt||P.current==null||!ve||!Ct)return;const{onDragOver:fe}=te.current,Z=ze.get(we),G=Z&&Z.rect.current?{id:Z.id,rect:Z.rect.current,data:Z.data,disabled:Z.disabled}:null,J={active:tt,activatorEvent:ve,collisions:_e,delta:{x:Ct.x,y:Ct.y},over:G};dl.unstable_batchedUpdates(()=>{X(G),fe==null||fe(J),w({type:"onDragOver",event:J})})},[we]),Bu(()=>{We.current={activatorEvent:V,active:H,activeNode:Oe,collisionRect:Ft,collisions:Ht,droppableRects:re,draggableNodes:N,draggingNode:ye,draggingNodeRect:Ie,droppableContainers:O,over:F,scrollableAncestors:Me,scrollAdjustedTranslate:qt},D.current={initial:Ie,translated:Ft}},[H,Oe,Ht,Ft,N,ye,Ie,re,O,F,Me,qt]),OGe({...Se,delta:I,draggingRect:Ft,pointerCoordinates:lt,scrollableAncestors:Me,scrollableAncestorRects:Be});const et=E.useMemo(()=>({active:H,activeNode:Oe,activeNodeRect:qe,activatorEvent:V,collisions:Ht,containerNodeRect:Qe,dragOverlay:Y,draggableNodes:N,droppableContainers:O,droppableRects:re,over:F,measureDroppableContainers:pe,scrollableAncestors:Me,scrollableAncestorRects:Be,measuringConfiguration:ee,measuringScheduled:de,windowRect:se}),[H,Oe,qe,V,Ht,Qe,Y,N,O,re,F,pe,Me,Be,ee,de,se]),$=E.useMemo(()=>({activatorEvent:V,activators:ft,active:H,activeNodeRect:qe,ariaDescribedById:{draggable:W},dispatch:x,draggableNodes:N,over:F,measureDroppableContainers:pe}),[V,ft,H,qe,x,W,N,F,pe]);return Ve.createElement(mie.Provider,{value:S},Ve.createElement(tA.Provider,{value:$},Ve.createElement(Rie.Provider,{value:et},Ve.createElement(Nie.Provider,{value:ke},c)),Ve.createElement(sKe,{disabled:(o==null?void 0:o.restoreFocus)===!1})),Ve.createElement(iGe,{...o,hiddenTextDescribedById:W}));function Ue(){const tt=(K==null?void 0:K.autoScrollEnabled)===!1,ve=typeof l=="object"?l.enabled===!1:l===!1,_e=T&&!tt&&!ve;return typeof l=="object"?{...l,enabled:_e}:{enabled:_e}}}),cKe=E.createContext(null),oV="button",uKe="Draggable";function dKe(e){let{id:t,data:n,disabled:r=!1,attributes:s}=e;const i=h_(uKe),{activators:a,activatorEvent:o,active:l,activeNodeRect:c,ariaDescribedById:u,draggableNodes:d,over:h}=E.useContext(tA),{role:m=oV,roleDescription:y="draggable",tabIndex:b=0}=s??{},v=(l==null?void 0:l.id)===t,x=E.useContext(v?Nie:cKe),[w,S]=Pk(),[k,C]=Pk(),T=KGe(a,t),A=t1(n);Bu(()=>(d.set(t,{id:t,key:i,node:w,activatorNode:k,data:A}),()=>{const I=d.get(t);I&&I.key===i&&d.delete(t)}),[d,t]);const N=E.useMemo(()=>({role:m,tabIndex:b,"aria-disabled":r,"aria-pressed":v&&m===oV?!0:void 0,"aria-roledescription":y,"aria-describedby":u.draggable}),[r,m,b,v,y,u.draggable]);return{active:l,activatorEvent:o,activeNodeRect:c,attributes:N,isDragging:v,listeners:r?void 0:T,node:w,over:h,setNodeRef:S,setActivatorNodeRef:C,transform:x}}function fKe(){return E.useContext(Rie)}const hKe="Droppable",pKe={timeout:25};function mKe(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:s}=e;const i=h_(hKe),{active:a,dispatch:o,over:l,measureDroppableContainers:c}=E.useContext(tA),u=E.useRef({disabled:n}),d=E.useRef(!1),h=E.useRef(null),m=E.useRef(null),{disabled:y,updateMeasurementsFor:b,timeout:v}={...pKe,...s},x=t1(b??r),w=E.useCallback(()=>{if(!d.current){d.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{c(Array.isArray(x.current)?x.current:[x.current]),m.current=null},v)},[v]),S=eA({callback:w,disabled:y||!a}),k=E.useCallback((N,I)=>{S&&(I&&(S.unobserve(I),d.current=!1),N&&S.observe(N))},[S]),[C,T]=Pk(k),A=t1(t);return E.useEffect(()=>{!S||!C.current||(S.disconnect(),d.current=!1,S.observe(C.current))},[C,S]),E.useEffect(()=>(o({type:Ui.RegisterDroppable,element:{id:r,key:i,disabled:n,node:C,rect:h,data:A}}),()=>o({type:Ui.UnregisterDroppable,key:i,id:r})),[r]),E.useEffect(()=>{n!==u.current.disabled&&(o({type:Ui.SetDroppableDisabled,id:r,key:i,disabled:n}),u.current.disabled=n)},[r,i,n,o]),{active:a,rect:h,isOver:(l==null?void 0:l.id)===r,node:C,over:l,setNodeRef:T}}function qx(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function gKe(e,t){return e.reduce((n,r,s)=>{const i=t.get(r);return i&&(n[s]=i),n},Array(e.length))}function bC(e){return e!==null&&e>=0}function yKe(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function bKe(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const Mie=e=>{let{rects:t,activeIndex:n,overIndex:r,index:s}=e;const i=qx(t,r,n),a=t[s],o=i[s];return!o||!a?null:{x:o.left-a.left,y:o.top-a.top,scaleX:o.width/a.width,scaleY:o.height/a.height}},vC={scaleX:1,scaleY:1},vKe=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:s,rects:i,overIndex:a}=e;const o=(t=i[n])!=null?t:r;if(!o)return null;if(s===n){const c=i[a];return c?{x:0,y:n<a?c.top+c.height-(o.top+o.height):c.top-o.top,...vC}:null}const l=xKe(i,s,n);return s>n&&s<=a?{x:0,y:-o.height-l,...vC}:s<n&&s>=a?{x:0,y:o.height+l,...vC}:{x:0,y:0,...vC}};function xKe(e,t,n){const r=e[t],s=e[t-1],i=e[t+1];return r?n<t?s?r.top-(s.top+s.height):i?i.top-(r.top+r.height):0:i?i.top-(r.top+r.height):s?r.top-(s.top+s.height):0:0}const Iie="Sortable",jie=Ve.createContext({activeIndex:-1,containerId:Iie,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:Mie,disabled:{draggable:!1,droppable:!1}});function wKe(e){let{children:t,id:n,items:r,strategy:s=Mie,disabled:i=!1}=e;const{active:a,dragOverlay:o,droppableRects:l,over:c,measureDroppableContainers:u}=fKe(),d=h_(Iie,n),h=o.rect!==null,m=E.useMemo(()=>r.map(T=>typeof T=="object"&&"id"in T?T.id:T),[r]),y=a!=null,b=a?m.indexOf(a.id):-1,v=c?m.indexOf(c.id):-1,x=E.useRef(m),w=!yKe(m,x.current),S=v!==-1&&b===-1||w,k=bKe(i);Bu(()=>{w&&y&&u(m)},[w,m,y,u]),E.useEffect(()=>{x.current=m},[m]);const C=E.useMemo(()=>({activeIndex:b,containerId:d,disabled:k,disableTransforms:S,items:m,overIndex:v,useDragOverlay:h,sortedRects:gKe(m,l),strategy:s}),[b,d,k.draggable,k.droppable,S,m,v,l,h,s]);return Ve.createElement(jie.Provider,{value:C},t)}const _Ke=e=>{let{id:t,items:n,activeIndex:r,overIndex:s}=e;return qx(n,r,s).indexOf(t)},SKe=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:s,items:i,newIndex:a,previousItems:o,previousContainerId:l,transition:c}=e;return!c||!r||o!==i&&s===a?!1:n?!0:a!==s&&t===l},CKe={duration:200,easing:"ease"},Pie="transform",kKe=r1.Transition.toString({property:Pie,duration:0,easing:"linear"}),EKe={roleDescription:"sortable"};function TKe(e){let{disabled:t,index:n,node:r,rect:s}=e;const[i,a]=E.useState(null),o=E.useRef(n);return Bu(()=>{if(!t&&n!==o.current&&r.current){const l=s.current;if(l){const c=kb(r.current,{ignoreTransform:!0}),u={x:l.left-c.left,y:l.top-c.top,scaleX:l.width/c.width,scaleY:l.height/c.height};(u.x||u.y)&&a(u)}}n!==o.current&&(o.current=n)},[t,n,r,s]),E.useEffect(()=>{i&&a(null)},[i]),i}function AKe(e){let{animateLayoutChanges:t=SKe,attributes:n,disabled:r,data:s,getNewIndex:i=_Ke,id:a,strategy:o,resizeObserverConfig:l,transition:c=CKe}=e;const{items:u,containerId:d,activeIndex:h,disabled:m,disableTransforms:y,sortedRects:b,overIndex:v,useDragOverlay:x,strategy:w}=E.useContext(jie),S=RKe(r,m),k=u.indexOf(a),C=E.useMemo(()=>({sortable:{containerId:d,index:k,items:u},...s}),[d,s,k,u]),T=E.useMemo(()=>u.slice(u.indexOf(a)),[u,a]),{rect:A,node:N,isOver:I,setNodeRef:O}=mKe({id:a,data:C,disabled:S.droppable,resizeObserverConfig:{updateMeasurementsFor:T,...l}}),{active:B,activatorEvent:D,activeNodeRect:H,attributes:P,setNodeRef:K,listeners:U,isDragging:V,over:L,setActivatorNodeRef:te,transform:W}=dKe({id:a,data:C,attributes:{...EKe,...n},disabled:S.draggable}),Q=HHe(O,K),ee=!!B,re=ee&&!y&&bC(h)&&bC(v),pe=!x&&V,de=pe&&re?W:null,Fe=re?de??(o??w)({rects:b,activeNodeRect:H,activeIndex:h,overIndex:v,index:k}):null,Se=bC(h)&&bC(v)?i({id:a,items:u,activeIndex:h,overIndex:v}):k,Ce=B==null?void 0:B.id,qe=E.useRef({activeId:Ce,items:u,newIndex:Se,containerId:d}),Qe=u!==qe.current.items,We=t({active:B,containerId:d,isDragging:V,isSorting:ee,id:a,index:k,items:u,newIndex:qe.current.newIndex,previousItems:qe.current.items,previousContainerId:qe.current.containerId,transition:c,wasDragging:qe.current.activeId!=null}),je=TKe({disabled:!We,index:k,node:N,rect:A});return E.useEffect(()=>{ee&&qe.current.newIndex!==Se&&(qe.current.newIndex=Se),d!==qe.current.containerId&&(qe.current.containerId=d),u!==qe.current.items&&(qe.current.items=u)},[ee,Se,d,u]),E.useEffect(()=>{if(Ce===qe.current.activeId)return;if(Ce!=null&&qe.current.activeId==null){qe.current.activeId=Ce;return}const ye=setTimeout(()=>{qe.current.activeId=Ce},50);return()=>clearTimeout(ye)},[Ce]),{active:B,activeIndex:h,attributes:P,data:C,rect:A,index:k,newIndex:Se,items:u,isOver:I,isSorting:ee,isDragging:V,listeners:U,node:N,overIndex:v,over:L,setNodeRef:Q,setActivatorNodeRef:te,setDroppableNodeRef:O,setDraggableNodeRef:K,transform:je??Fe,transition:Y()};function Y(){if(je||Qe&&qe.current.newIndex===k)return kKe;if(!(pe&&!u6(D)||!c)&&(ee||We))return r1.Transition.toString({...c,property:Pie})}}function RKe(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}function Fk(e){if(!e)return!1;const t=e.data.current;return!!(t&&"sortable"in t&&typeof t.sortable=="object"&&"containerId"in t.sortable&&"items"in t.sortable&&"index"in t.sortable)}const NKe=[Hr.Down,Hr.Right,Hr.Up,Hr.Left],MKe=(e,t)=>{let{context:{active:n,collisionRect:r,droppableRects:s,droppableContainers:i,over:a,scrollableAncestors:o}}=t;if(NKe.includes(e.code)){if(e.preventDefault(),!n||!r)return;const l=[];i.getEnabled().forEach(d=>{if(!d||d!=null&&d.disabled)return;const h=s.get(d.id);if(h)switch(e.code){case Hr.Down:r.top<h.top&&l.push(d);break;case Hr.Up:r.top>h.top&&l.push(d);break;case Hr.Left:r.left>h.left&&l.push(d);break;case Hr.Right:r.left<h.left&&l.push(d);break}});const c=cGe({collisionRect:r,droppableRects:s,droppableContainers:l});let u=bie(c,"id");if(u===(a==null?void 0:a.id)&&c.length>1&&(u=c[1].id),u!=null){const d=i.get(n.id),h=i.get(u),m=h?s.get(h.id):null,y=h==null?void 0:h.node.current;if(y&&m&&d&&h){const v=QT(y).some((T,A)=>o[A]!==T),x=Oie(d,h),w=IKe(d,h),S=v||!x?{x:0,y:0}:{x:w?r.width-m.width:0,y:w?r.height-m.height:0},k={x:m.left,y:m.top};return S.x&&S.y?k:n1(k,S)}}}};function Oie(e,t){return!Fk(e)||!Fk(t)?!1:e.data.current.sortable.containerId===t.data.current.sortable.containerId}function IKe(e,t){return!Fk(e)||!Fk(t)||!Oie(e,t)?!1:e.data.current.sortable.index<t.data.current.sortable.index}const jKe=({id:e,modelDetails:t,buttonsDisabled:n,onMoveToTop:r,onMoveUp:s,onMoveDown:i,isFirst:a,isLast:o})=>{var C,T,A;const{attributes:l,listeners:c,setNodeRef:u,transform:d,transition:h,isDragging:m}=AKe({id:e,disabled:!1}),y={transform:r1.Transform.toString(d),transition:h,zIndex:m?10:void 0},b=new Set(((C=t.metadataSummary)==null?void 0:C.supported_parameters)??[]),v=new Set(((T=t.metadataSummary)==null?void 0:T.input_modalities)??[]),x=b.has("reasoning"),w=b.has("web_search")||b.has("web_search_options"),S=b.has("tools"),k=Array.from(v).some(N=>N!=="text");return f.jsxs("div",{ref:u,style:y,className:Ze("flex items-center space-x-2 p-2 rounded border border-transparent bg-muted/50 hover:bg-muted mb-1",m&&"shadow-lg border-primary bg-card","cursor-grab active:cursor-grabbing"),"aria-label":`Drag to reorder model ${t.name}`,children:[f.jsx("button",{...l,...c,type:"button",className:Ze("p-1 flex-shrink-0","hover:text-foreground"),"aria-hidden":"true",tabIndex:-1,children:f.jsx(Gme,{className:"h-5 w-5 text-muted-foreground"})}),f.jsxs("div",{className:"flex-grow min-w-0",children:[f.jsxs(jt,{className:Ze("text-sm font-normal text-foreground flex-grow truncate pointer-events-none"),children:[t.name," ",f.jsxs("span",{className:"text-xs text-muted-foreground",children:["(",t.providerName,")"]})]}),f.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[x&&f.jsx(Hy,{className:"h-3 w-3 text-blue-500"}),w&&f.jsx(uo,{className:"h-3 w-3 text-green-500"}),S&&f.jsx(Sm,{className:"h-3 w-3 text-orange-500"}),k&&f.jsx(Ah,{className:"h-3 w-3 text-purple-500"})]})]}),f.jsxs("div",{className:"flex items-center gap-0.5 ml-auto flex-shrink-0",children:[((A=t.metadataSummary)==null?void 0:A.description)&&f.jsx(wr,{delayDuration:100,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx("span",{className:"p-1 text-muted-foreground hover:text-foreground cursor-default","aria-label":"Model information",children:f.jsx(KP,{className:"h-4 w-4"})})}),f.jsx(Cr,{side:"top",align:"end",className:"max-w-xs break-words",children:f.jsx("p",{children:t.metadataSummary.description})})]})}),f.jsx(qn,{tooltipText:"Move to Top",onClick:()=>r(e),disabled:a||n,icon:f.jsx(Wpe,{}),className:"h-6 w-6"}),f.jsx(qn,{tooltipText:"Move Up",onClick:()=>s(e),disabled:a||n,icon:f.jsx(Spe,{}),className:"h-6 w-6"}),f.jsx(qn,{tooltipText:"Move Down",onClick:()=>i(e),disabled:o||n,icon:f.jsx(wH,{}),className:"h-6 w-6"})]})]})},PKe=({setGlobalModelSortOrderFromModule:e})=>{const{dbProviderConfigs:t,globalModelSortOrder:n,isLoading:r,getAvailableModelListItems:s}=Qn(yn(S=>({dbProviderConfigs:S.dbProviderConfigs,globalModelSortOrder:S.globalModelSortOrder,isLoading:S.isLoading,getAvailableModelListItems:S.getAvailableModelListItems}))),[i,a]=E.useState(""),[o,l]=E.useState(()=>new Set(t.map(S=>S.id))),[c,u]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1});E.useEffect(()=>{l(new Set(t.map(S=>S.id)))},[t]);const d=E.useMemo(()=>{const S=s(),k=new Map(S.map(I=>[I.id,I])),C=new Set;t.forEach(I=>{I.isEnabled&&I.enabledModels&&I.enabledModels.forEach(O=>{C.add(Rx(I.id,O))})});const T=S.filter(I=>C.has(I.id)),A=[],N=new Set;return n.forEach(I=>{if(C.has(I)){const O=k.get(I);O&&!N.has(I)&&(A.push(O),N.add(I))}}),T.forEach(I=>{N.has(I.id)||A.push(I)}),A},[t,n,s]),h=E.useMemo(()=>{let S=d;if(o.size!==t.length&&(S=S.filter(C=>o.has(C.providerId))),i.trim()){const C=i.toLowerCase();S=S.filter(T=>T.name.toLowerCase().includes(C)||T.providerName.toLowerCase().includes(C)||T.id.toLowerCase().includes(C))}const k=Object.entries(c).filter(([,C])=>C).map(([C])=>C);return k.length>0&&(S=S.filter(C=>{var N,I;const T=new Set(((N=C.metadataSummary)==null?void 0:N.supported_parameters)??[]),A=new Set(((I=C.metadataSummary)==null?void 0:I.input_modalities)??[]);return k.every(O=>{switch(O){case"reasoning":return T.has("reasoning");case"webSearch":return T.has("web_search")||T.has("web_search_options");case"tools":return T.has("tools");case"multimodal":return Array.from(A).some(B=>B!=="text");default:return!0}})})),S},[d,i,o,t.length,c]),m=E.useMemo(()=>i.trim().length>0||o.size!==t.length||Object.values(c).some(Boolean),[i,o,t.length,c]),y=E.useMemo(()=>{const S=o.size!==t.length?1:0,k=Object.values(c).filter(Boolean).length;return S+k},[o,t.length,c]),b=E.useMemo(()=>h.map(S=>S.id),[h]),v=E.useCallback(S=>{const{active:k,over:C}=S;if(C&&k.id!==C.id){const T=d.map(B=>B.id),A=k.id,N=C.id,I=T.indexOf(A),O=T.indexOf(N);if(I!==-1&&O!==-1){const B=qx(T,I,O);e(B)}else console.warn("DND: Could not find dragged items in the full model order. This might happen if the underlying list changed during drag or items are filtered out.")}},[d,e]),x=E.useCallback((S,k)=>{if(m)return;const C=d.map(N=>N.id),T=C.indexOf(S);if(T===-1)return;let A;if(k==="top"){if(T===0)return;const N=C.splice(T,1)[0];C.unshift(N),A=C}else if(k==="up"){if(T===0)return;A=qx(C,T,T-1)}else{if(T===C.length-1)return;A=qx(C,T,T+1)}e(A)},[d,e,m]),w=aGe(Yq(p6),Yq(f6,{coordinateGetter:MKe}));return r?f.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[f.jsx(Gr,{className:"h-8 w-1/3"}),f.jsx(Gr,{className:"h-6 w-1/2"}),f.jsx(Gr,{className:"h-64 w-full"})]}):f.jsxs("div",{className:"space-y-4 border border-border rounded-lg p-4 bg-card shadow-sm",children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Global Model Order"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Drag and drop the globally enabled models to define their display order. Filtering affects the view below. Move buttons (up/down/top) are disabled when filters are active."}),f.jsx(Fm,{}),f.jsxs("div",{className:"space-y-3",children:[f.jsx(jt,{className:"text-base font-medium text-card-foreground",children:"Enabled & Ordered Models"}),f.jsxs("div",{className:"flex items-center gap-2",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(uo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(xn,{type:"search",placeholder:"Filter models by name or provider...",value:i,onChange:S=>a(S.target.value),className:"pl-8 w-full h-9",disabled:r})]}),f.jsx(BF,{currentCapabilityFilters:c,onCapabilityFilterChange:u,currentSelectedProviders:o,onProviderFilterChange:l,allProviders:t,showProviderFilter:!0,showCapabilityFilters:!0,disabled:r||t.length===0,totalActiveFilters:y})]}),f.jsx("div",{className:"w-full rounded-md border border-border p-3 bg-background/50",children:h.length>0?f.jsx(lKe,{sensors:w,collisionDetection:lGe,onDragEnd:v,children:f.jsx(wKe,{items:b,strategy:vKe,children:h.map(S=>f.jsx(jKe,{id:S.id,modelDetails:S,onMoveToTop:()=>x(S.id,"top"),onMoveUp:()=>x(S.id,"up"),onMoveDown:()=>x(S.id,"down"),isFirst:d.findIndex(k=>k.id===S.id)===0,isLast:d.findIndex(k=>k.id===S.id)===d.length-1,buttonsDisabled:m},S.id))})}):f.jsx("div",{className:"flex items-center justify-center h-full text-sm text-muted-foreground",children:m?"No models match your filters.":"No models enabled globally. Enable models within provider configurations."})})]})]})},xC=e=>{if(!e)return"N/A";const t=parseFloat(e);return isNaN(t)?"N/A":`$${(t/1e3).toFixed(4)} / 1K tokens`},Ol=(e,t,n=!1,r="secondary")=>t==null||String(t).trim()===""?null:f.jsxs(Ts,{children:[f.jsx(Ln,{className:"font-medium text-xs w-1/3 py-1.5 px-3",children:e}),f.jsx(Ln,{className:"text-xs py-1.5 px-3 break-all",children:n?f.jsx(as,{variant:r,className:"text-xs",children:String(t)}):Array.isArray(t)?f.jsx("div",{className:"flex flex-wrap gap-1",children:t.map((s,i)=>f.jsx(as,{variant:"outline",className:"text-xs",children:String(s)},i))}):String(t)})]}),OKe=({modelId:e})=>{var m,y,b,v,x,w,S,k,C,T,A,N;const{createAiModelConfig:t,dbProviderConfigs:n,dbApiKeys:r,updateProviderConfig:s,isLoading:i}=Qn(yn(I=>({createAiModelConfig:I.createAiModelConfig,dbProviderConfigs:I.dbProviderConfigs,dbApiKeys:I.dbApiKeys,updateProviderConfig:I.updateProviderConfig,isLoading:I.isLoading}))),a=E.useMemo(()=>{if(!e)return;const{providerId:I,modelId:O}=Ac(e);if(!I||!O)return;const B=n.find(H=>H.id===I);if(!B)return;const D=r.find(H=>H.id===B.apiKeyId);return t(B,O,D==null?void 0:D.value)},[e,n,r,t]),o=a==null?void 0:a.metadata,l=E.useCallback(async()=>{if(!a||!e)return;const{providerId:I,modelId:O}=Ac(e);if(!I||!O)return;const B=n.find(K=>K.id===I);if(!B){Te.error("Provider configuration not found.");return}const D=new Set(B.enabledModels??[]),H=D.has(O);H?D.delete(O):D.add(O);const P=Array.from(D);try{await s(B.id,{enabledModels:P}),Te.success(`Model "${a.name}" ${H?"disabled":"enabled"}.`)}catch{Te.error("Failed to update model status.")}},[a,e,n,s]);if(i)return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsx(Gr,{className:"h-8 w-3/4 flex-shrink-0"}),f.jsx(Gr,{className:"h-4 w-1/2 flex-shrink-0"}),f.jsxs("div",{className:"flex-grow space-y-2",children:[f.jsx(Gr,{className:"h-10 w-full"}),f.jsx(Gr,{className:"h-10 w-full"}),f.jsx(Gr,{className:"h-10 w-full"}),f.jsx(Gr,{className:"h-10 w-full"})]})]});if(!e)return f.jsxs("div",{className:"p-4 text-center text-muted-foreground h-full flex flex-col items-center justify-center",children:[f.jsx(Kl,{className:"mx-auto h-10 w-10 mb-2 text-amber-500"}),f.jsx("p",{className:"text-sm",children:'No model selected. Click a model in the "Configuration" or "Browse Models" tab to view its details.'})]});if(!a||!o)return f.jsxs("div",{className:"p-4 text-center text-destructive h-full flex flex-col items-center justify-center",children:[f.jsx(Kl,{className:"mx-auto h-10 w-10 mb-2"}),f.jsxs("p",{className:"text-sm",children:["Details not available for model: ",e,". It might be misconfigured or no longer available."]})]});const{providerId:c,modelId:u}=Ac(e),d=n.find(I=>I.id===c),h=u!=null&&(d==null?void 0:d.isEnabled)&&((m=d==null?void 0:d.enabledModels)==null?void 0:m.includes(u))===!0;return f.jsxs("div",{className:"space-y-4 p-1 h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center justify-between flex-shrink-0",children:[f.jsxs("h4",{className:"text-lg font-semibold text-card-foreground truncate",children:[a.name,f.jsxs("span",{className:"text-sm text-muted-foreground ml-2",children:["(",a.providerName,")"]})]}),f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(jt,{htmlFor:`enable-details-${u}`,className:"text-xs",children:h?"Enabled":"Disabled"}),f.jsx(oo,{id:`enable-details-${u}`,checked:h,onCheckedChange:l,disabled:!(d!=null&&d.isEnabled),"aria-label":`Enable model ${a.name}`})]})]}),o.description&&f.jsx("p",{className:"text-xs text-muted-foreground flex-shrink-0",children:o.description}),f.jsx(Zl,{className:"flex-grow border rounded-md bg-background/30",children:f.jsxs(yf,{children:[f.jsxs(Tze,{className:"py-2 text-xs",children:["Model ID: ",o.id]}),f.jsxs(bf,{children:[Ol("Context Length",((y=o.top_provider)==null?void 0:y.context_length)??o.context_length),Ol("Max Completion Tokens",(b=o.top_provider)==null?void 0:b.max_completion_tokens),Ol("Input Modalities",(v=o.architecture)==null?void 0:v.input_modalities),Ol("Output Modalities",(x=o.architecture)==null?void 0:x.output_modalities),Ol("Tokenizer",(w=o.architecture)==null?void 0:w.tokenizer,!0),Ol("Instruct Type",(S=o.architecture)==null?void 0:S.instruct_type,!0),Ol("Pricing (Prompt)",xC((k=o.pricing)==null?void 0:k.prompt)),Ol("Pricing (Completion)",xC((C=o.pricing)==null?void 0:C.completion)),Ol("Pricing (Image)",xC((T=o.pricing)==null?void 0:T.image)),Ol("Pricing (Request)",xC((A=o.pricing)==null?void 0:A.request)),Ol("Supported Parameters",o.supported_parameters),Ol("Moderated",(N=o.top_provider)!=null&&N.is_moderated?f.jsx(xE,{className:"h-4 w-4 text-green-500"}):"No")]})]})})]})},DKe=()=>{const{apiKeys:e,addApiKey:t,deleteApiKey:n,isLoading:r}=Qn(yn(h=>({apiKeys:h.dbApiKeys,addApiKey:h.addApiKey,deleteApiKey:h.deleteApiKey,isLoading:h.isLoading}))),[s,i]=E.useState(!1),[a,o]=E.useState(!1),[l,c]=E.useState({}),u=E.useCallback(async(h,m,y)=>{o(!0);try{await t(h,m,y),i(!1)}catch(b){console.error("Failed to add API key (from component):",b)}finally{o(!1)}},[t]),d=E.useCallback(async(h,m)=>{if(window.confirm(`Are you sure you want to delete the API key "${m}"? This will unlink it from any providers using it.`)){c(y=>({...y,[h]:!0}));try{await n(h)}catch(y){console.error("Failed to delete API key (from component):",y)}finally{c(y=>({...y,[h]:!1}))}}},[n]);return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:"API Key Management"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Manage API keys for different providers. Keys are stored securely in your browser's local storage and never sent to any server other than the intended AI provider."})]}),!s&&f.jsxs(ct,{onClick:()=>i(!0),variant:"outline",className:"w-full mb-4",disabled:r,children:[f.jsx(Pc,{className:"h-4 w-4 mr-1"})," Add New API Key"]}),s&&f.jsxs("div",{className:"border rounded-md p-4 space-y-3 bg-card shadow-md mb-4",children:[f.jsx("h4",{className:"font-semibold text-card-foreground",children:"Add New Key"}),f.jsx(Cte,{onSave:u,onCancel:()=>i(!1),disabled:a})]}),f.jsxs("div",{children:[f.jsx("h4",{className:"text-md font-medium mb-2",children:"Stored API Keys"}),r&&!s?f.jsxs("div",{className:"space-y-2",children:[f.jsx(Gr,{className:"h-10 w-full"}),f.jsx(Gr,{className:"h-10 w-full"})]}):(e||[]).length===0&&!s?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:"No API keys stored yet."}):f.jsx("div",{className:"border rounded-md overflow-hidden",children:f.jsxs(yf,{children:[f.jsx(gp,{children:f.jsxs(Ts,{children:[f.jsx(Rr,{children:"Name"}),f.jsx(Rr,{children:"Provider Type"}),f.jsx(Rr,{children:"Created"}),f.jsx(Rr,{className:"text-right",children:"Actions"})]})}),f.jsx(bf,{children:(e||[]).map(h=>{const m=l[h.id];return f.jsxs(Ts,{className:m?"opacity-50":"",children:[f.jsx(Ln,{className:"font-medium",children:h.name||"Unnamed Key"}),f.jsx(Ln,{children:h.providerId||"Unknown"}),f.jsx(Ln,{className:"text-xs text-muted-foreground",children:jd(new Date(h.createdAt),"PPp")}),f.jsx(Ln,{className:"text-right",children:f.jsx(qn,{tooltipText:"Delete Key",onClick:()=>d(h.id,h.name||"Unnamed Key"),disabled:m,"aria-label":`Delete key ${h.name||"Unnamed Key"}`,icon:m?f.jsx(Jn,{className:"h-4 w-4 animate-spin"}):f.jsx(Po,{}),className:"text-destructive hover:text-destructive/80 h-8 w-8"})})]},h.id)})})]})})]})]})},FKe=Ve.memo(DKe),LKe=({onSelectModelForDetails:e})=>{const[t,n]=E.useState(null),[r,s]=E.useState(null),i=E.useCallback(C=>{if(C){n(C);const T=C.querySelector("[data-radix-scroll-area-viewport]");if(T)s(T);else{const A=new MutationObserver(()=>{const N=C.querySelector("[data-radix-scroll-area-viewport]");N&&(s(N),A.disconnect())});return A.observe(C,{childList:!0,subtree:!0}),()=>A.disconnect()}}else n(null),s(null)},[]),{getAvailableModelListItems:a,isLoading:o,dbProviderConfigs:l}=Qn(yn(C=>({getAvailableModelListItems:C.getAvailableModelListItems,isLoading:C.isLoading,dbProviderConfigs:C.dbProviderConfigs}))),[c,u]=E.useState(""),[d,h]=E.useState(()=>new Set(l.map(C=>C.id))),[m,y]=E.useState({reasoning:!1,webSearch:!1,tools:!1,multimodal:!1}),b=E.useMemo(()=>a(),[a]);E.useEffect(()=>{h(new Set(l.map(C=>C.id)))},[l]);const v=E.useMemo(()=>{let C=b;if(d.size!==l.length&&(C=C.filter(A=>d.has(A.providerId))),c.trim()){const A=c.toLowerCase();C=C.filter(N=>N.name.toLowerCase().includes(A)||N.providerName.toLowerCase().includes(A)||N.id.toLowerCase().includes(A))}const T=Object.entries(m).filter(([,A])=>A).map(([A])=>A);return T.length>0&&(C=C.filter(A=>{var O,B;const N=new Set(((O=A.metadataSummary)==null?void 0:O.supported_parameters)??[]),I=new Set(((B=A.metadataSummary)==null?void 0:B.input_modalities)??[]);return T.every(D=>{switch(D){case"reasoning":return N.has("reasoning");case"webSearch":return N.has("web_search")||N.has("web_search_options");case"tools":return N.has("tools");case"multimodal":return Array.from(I).some(H=>H!=="text");default:return!0}})})),C.sort((A,N)=>{const I=A.providerName.localeCompare(N.providerName);return I!==0?I:A.name.localeCompare(N.name)})},[b,c,d,l.length,m]),x=jF({count:v.length,getScrollElement:()=>r,estimateSize:()=>48,overscan:10}),w=E.useCallback(C=>{e(C)},[e]),S=E.useCallback(C=>{y(C)},[]),k=E.useMemo(()=>(d.size!==l.length?1:0)+Object.values(m).filter(Boolean).length,[d,l.length,m]);return o?f.jsxs("div",{className:"space-y-2 h-full flex flex-col",children:[f.jsx(Gr,{className:"h-9 w-full flex-shrink-0"}),f.jsx(Gr,{className:"h-full w-full flex-grow"})]}):f.jsxs("div",{className:"space-y-3 h-full flex flex-col",children:[f.jsxs("div",{className:"flex items-center gap-2 flex-shrink-0",children:[f.jsxs("div",{className:"relative flex-grow",children:[f.jsx(uo,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),f.jsx(xn,{type:"search",placeholder:"Filter models by name or provider...",value:c,onChange:C=>u(C.target.value),className:"pl-8 w-full h-9",disabled:o})]}),f.jsx(BF,{currentCapabilityFilters:m,onCapabilityFilterChange:S,currentSelectedProviders:d,onProviderFilterChange:h,allProviders:l,showProviderFilter:!0,showCapabilityFilters:!0,disabled:o||l.length===0,totalActiveFilters:k})]}),f.jsxs(Zl,{className:"flex-grow border rounded-md bg-background/50 h-[calc(15*2.5rem+2px)]",ref:i,children:[r&&f.jsx("div",{style:{height:`${x.getTotalSize()}px`,width:"100%",position:"relative"},children:v.length===0&&!o?f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4 absolute inset-0 flex items-center justify-center",children:"No models match your filters."}):x.getVirtualItems().map(C=>{var A;const T=v[C.index];return T?f.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:`${C.size}px`,transform:`translateY(${C.start}px)`},className:"p-1",children:f.jsx(wr,{delayDuration:300,children:f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsxs("button",{className:"w-full text-left p-1.5 rounded hover:bg-muted/50 flex flex-col",onClick:()=>w(T.id),children:[f.jsx("span",{className:"text-sm font-medium truncate",children:T.name}),f.jsx("span",{className:"text-xs text-muted-foreground truncate",children:T.providerName})]})}),((A=T.metadataSummary)==null?void 0:A.description)&&f.jsx(Cr,{side:"bottom",align:"start",className:"max-w-xs",children:f.jsx("p",{children:T.metadataSummary.description})})]})})},T.id):null})}),!r&&!o&&f.jsx("div",{className:"flex items-center justify-center h-full text-muted-foreground",children:"Initializing list..."})]})]})},BKe=({onSelectModelForDetails:e})=>{const{addDbProviderConfig:t,updateDbProviderConfig:n,deleteDbProviderConfig:r,fetchModels:s,providerFetchStatus:i,dbProviderConfigs:a,apiKeys:o,isLoading:l}=Qn(yn(b=>({addDbProviderConfig:b.addProviderConfig,updateDbProviderConfig:b.updateProviderConfig,deleteDbProviderConfig:b.deleteProviderConfig,fetchModels:b.fetchModels,providerFetchStatus:b.providerFetchStatus,dbProviderConfigs:b.dbProviderConfigs,apiKeys:b.dbApiKeys,isLoading:b.isLoading}))),[c,u]=E.useState(!1),d=()=>u(!0),h=E.useCallback(()=>u(!1),[]),m=E.useCallback(async b=>{await s(b)},[s]),y=E.useMemo(()=>a||[],[a]);return f.jsxs("div",{className:"space-y-6 h-full flex flex-col",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-semibold text-card-foreground",children:"Provider Configuration"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Add, remove, or configure connections to AI providers. Enable models within each provider's edit section. Click a model name to view its details."})]}),f.jsx("div",{className:"flex-shrink-0",children:c?f.jsx(Ite,{apiKeys:o||[],onAddProvider:t,onCancel:h}):f.jsxs(ct,{onClick:d,variant:"outline",className:"w-full",disabled:l,children:[f.jsx(Pc,{className:"h-4 w-4 mr-1"})," Add Provider Configuration"]})}),f.jsx("div",{className:"flex-grow border-t border-border pt-4 mt-4 overflow-y-auto",children:f.jsxs("div",{className:"space-y-2",children:[l&&!c?f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[f.jsx(Gr,{className:"h-24 w-full"}),f.jsx(Gr,{className:"h-24 w-full"}),f.jsx(Gr,{className:"h-24 w-full"})]}):f.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:y.map(b=>f.jsx(WHe,{provider:b,apiKeys:o||[],onUpdate:n,onDelete:r,onFetchModels:m,fetchStatus:i[b.id]||"idle",onSelectModelForDetails:e},b.id))}),!l&&y.length===0&&!c&&f.jsx("p",{className:"text-sm text-muted-foreground text-center py-4",children:'No providers configured yet. Click "Add Provider Configuration" above.'})]})})]})},$Ke=({setGlobalModelSortOrderFromModule:e})=>{const{selectedModelForDetails:t,setSelectedModelForDetails:n}=Qn(yn(o=>({selectedModelForDetails:o._selectedModelForDetails,setSelectedModelForDetails:o.setSelectedModelForDetails}))),[r,s]=E.useState("providers-config"),i=E.useCallback(o=>{n(o),o&&s("providers-details-current")},[n,s]),a=E.useMemo(()=>[{value:"providers-config",label:"Configuration",content:f.jsx(BKe,{onSelectModelForDetails:i})},{value:"providers-order",label:"Model Order",content:f.jsx(PKe,{setGlobalModelSortOrderFromModule:e})},{value:"api-keys",label:"API Keys",content:f.jsx(FKe,{})},{value:"providers-details-current",label:"Selected Model",content:f.jsx(OKe,{modelId:t})},{value:"providers-browse-all",label:"Browse Models",content:f.jsx(LKe,{onSelectModelForDetails:i}),scrollable:!1}],[t,i,e]);return f.jsx(xl,{tabs:a,initialValue:r,onValueChange:s,className:"h-full",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-4"})},zKe=Ve.memo($Ke);class UKe{constructor(){ue(this,"id","core-provider-settings");ue(this,"modApiRef",null);ue(this,"eventUnsubscribers",[]);ue(this,"setGlobalModelSortOrderFromModule",t=>{var n;(n=this.modApiRef)==null||n.emit(Wn.setGlobalModelSortOrderRequest,{ids:t})})}async initialize(t){this.modApiRef=t}register(t){this.modApiRef=t,t.registerSettingsTab({id:"providers",title:"Providers & Models",order:20,component:()=>Ve.createElement(zKe,{setGlobalModelSortOrderFromModule:this.setGlobalModelSortOrderFromModule})})}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.modApiRef=null}}const qKe=Ke({globalSystemPrompt:$e()});function VKe({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const WKe=()=>{const{globalSystemPrompt:e,setGlobalSystemPrompt:t}=pr(yn(r=>({globalSystemPrompt:r.globalSystemPrompt,setGlobalSystemPrompt:r.setGlobalSystemPrompt}))),n=ii({defaultValues:{globalSystemPrompt:e??""},validators:{onChangeAsync:qKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.globalSystemPrompt),Te.success("Global system prompt updated!")}catch(s){Te.error("Failed to update prompt. Please try again."),console.error("Error submitting assistant prompt form:",s)}}});return E.useEffect(()=>{n.state.values.globalSystemPrompt!==(e??"")&&n.reset({globalSystemPrompt:e??""})},[e,n]),f.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-3",children:[f.jsx("div",{children:f.jsx(n.Field,{name:"globalSystemPrompt",children:r=>f.jsxs(f.Fragment,{children:[f.jsx(jt,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Global System Prompt"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Default instructions for the assistant. Can be overridden per-project."}),f.jsx(qa,{id:r.name,placeholder:"Enter default system instructions for the assistant...",value:r.state.value,onBlur:r.handleBlur,onChange:s=>r.handleChange(s.target.value),rows:6,className:r.state.meta.errors.length?"border-destructive":""}),f.jsx(VKe,{field:r})]})})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>f.jsx(ct,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Prompt"})})})]})},HKe=Ke({temperature:At().min(0).max(1),topP:At().min(0).max(1),maxTokens:At().min(1).nullable(),topK:At().min(1).nullable(),presencePenalty:At().min(-2).max(2),frequencyPenalty:At().min(-2).max(2)}),GKe=()=>{const e=pr(yn(n=>({temperature:n.temperature,setTemperature:n.setTemperature,topP:n.topP,setTopP:n.setTopP,maxTokens:n.maxTokens,setMaxTokens:n.setMaxTokens,topK:n.topK,setTopK:n.setTopK,presencePenalty:n.presencePenalty,setPresencePenalty:n.setPresencePenalty,frequencyPenalty:n.frequencyPenalty,setFrequencyPenalty:n.setFrequencyPenalty}))),t=ii({defaultValues:{temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0},validators:{onChangeAsync:HKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setTemperature(n.temperature),e.setTopP(n.topP),e.setMaxTokens(n.maxTokens??null),e.setTopK(n.topK??null),e.setPresencePenalty(n.presencePenalty),e.setFrequencyPenalty(n.frequencyPenalty),Te.success("Assistant parameters updated!")}catch(r){Te.error("Failed to update parameters."),console.error("Error submitting parameters form:",r)}}});return E.useEffect(()=>{t.reset({temperature:e.temperature??.7,topP:e.topP??1,maxTokens:e.maxTokens??null,topK:e.topK??null,presencePenalty:e.presencePenalty??0,frequencyPenalty:e.frequencyPenalty??0})},[e.temperature,e.topP,e.maxTokens,e.topK,e.presencePenalty,e.frequencyPenalty,t]),f.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-4",children:[f.jsx("p",{className:"text-xs text-muted-foreground mb-3",children:"Set the default global values for AI parameters. These can be overridden per-project or per-prompt turn."}),f.jsx(Cc,{form:t,name:"temperature",label:"Temperature",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsx(Cc,{form:t,name:"topP",label:"Top P",min:0,max:1,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsxs("div",{className:"grid grid-cols-2 gap-4 items-end",children:[f.jsx(My,{form:t,name:"maxTokens",label:"Max Tokens",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"}),f.jsx(My,{form:t,name:"topK",label:"Top K",placeholder:"Default (None)",min:1,className:"h-9 text-sm",allowNull:!0,wrapperClassName:"space-y-1.5"})]}),f.jsx(Cc,{form:t,name:"presencePenalty",label:"Presence Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsx(Cc,{form:t,name:"frequencyPenalty",label:"Frequency Penalty",min:-2,max:2,step:.01,valueDisplayPrecision:2,wrapperClassName:"space-y-1.5"}),f.jsxs("div",{className:"flex justify-end space-x-2",children:[f.jsx(ct,{type:"button",variant:"ghost",onClick:()=>t.reset(),disabled:!t.state.isDirty,children:"Reset"}),f.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting],children:([n,r])=>f.jsx(ct,{type:"submit",disabled:!n||r,children:r?"Saving...":"Save Changes"})})]})]})},KKe=Ke({toolMaxSteps:At({required_error:"Max steps is required",invalid_type_error:"Max steps must be a number"}).min(1,"Must be at least 1").max(20,"Cannot exceed 20")});function YKe({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const ZKe=()=>{const{toolMaxSteps:e,setToolMaxSteps:t}=pr(yn(r=>({toolMaxSteps:r.toolMaxSteps,setToolMaxSteps:r.setToolMaxSteps}))),n=ii({defaultValues:{toolMaxSteps:e??5},validators:{onChangeAsync:KKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:r})=>{try{t(r.toolMaxSteps),Te.success("Tool settings updated!")}catch(s){Te.error("Failed to update tool settings."),console.error("Error submitting tool settings form:",s)}}});return E.useEffect(()=>{n.state.values.toolMaxSteps!==(e??5)&&n.reset({toolMaxSteps:e??5})},[e,n]),f.jsxs("form",{onSubmit:r=>{r.preventDefault(),r.stopPropagation(),n.handleSubmit()},className:"space-y-3",children:[f.jsx(n.Field,{name:"toolMaxSteps",children:r=>f.jsxs("div",{children:[f.jsx(jt,{htmlFor:r.name,className:"text-sm mb-1 block",children:"Maximum Tool Steps per Turn"}),f.jsx("p",{className:"text-xs text-muted-foreground mb-2",children:"Limits the number of sequential tool calls the AI can make before generating a final response (1-20). Higher values allow more complex tasks but increase latency and cost. (Default: 5)"}),f.jsx(xn,{id:r.name,type:"number",min:1,max:20,step:1,value:r.state.value,onBlur:r.handleBlur,onChange:s=>{const i=s.target.valueAsNumber;isNaN(i)?s.target.value===""&&r.handleChange(void 0):r.handleChange(i)},className:`w-24 ${r.state.meta.errors.length?"border-destructive":""}`}),f.jsx(YKe,{field:r})]})}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(n.Subscribe,{selector:r=>[r.canSubmit,r.isSubmitting,r.isValidating,r.isValid],children:([r,s,i,a])=>f.jsx(ct,{type:"submit",size:"sm",disabled:!r||s||i||!a,children:s?"Saving...":i?"Validating...":"Save Tool Settings"})})})]})},XKe=Ke({autoTitleEnabled:Zn(),autoTitleModelId:$e().nullable(),autoTitlePromptMaxLength:At().min(100).max(4e3),autoTitleIncludeFiles:Zn(),autoTitleIncludeRules:Zn()});function Kv({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}const JKe=()=>{const e=pr(yn(n=>({autoTitleEnabled:n.autoTitleEnabled,setAutoTitleEnabled:n.setAutoTitleEnabled,autoTitleModelId:n.autoTitleModelId,setAutoTitleModelId:n.setAutoTitleModelId,autoTitlePromptMaxLength:n.autoTitlePromptMaxLength,setAutoTitlePromptMaxLength:n.setAutoTitlePromptMaxLength,autoTitleIncludeFiles:n.autoTitleIncludeFiles,setAutoTitleIncludeFiles:n.setAutoTitleIncludeFiles,autoTitleIncludeRules:n.autoTitleIncludeRules,setAutoTitleIncludeRules:n.setAutoTitleIncludeRules}))),t=ii({defaultValues:{autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1},validators:{onChangeAsync:XKe,onChangeAsyncDebounceMs:500},onSubmit:async({value:n})=>{try{e.setAutoTitleEnabled(n.autoTitleEnabled),e.setAutoTitleModelId(n.autoTitleModelId??null),e.setAutoTitlePromptMaxLength(n.autoTitlePromptMaxLength),e.setAutoTitleIncludeFiles(n.autoTitleIncludeFiles),e.setAutoTitleIncludeRules(n.autoTitleIncludeRules),Te.success("Auto-title settings updated!")}catch(r){Te.error("Failed to update auto-title settings."),console.error("Error submitting auto-title settings form:",r)}}});return E.useEffect(()=>{t.reset({autoTitleEnabled:e.autoTitleEnabled??!1,autoTitleModelId:e.autoTitleModelId??null,autoTitlePromptMaxLength:e.autoTitlePromptMaxLength??768,autoTitleIncludeFiles:e.autoTitleIncludeFiles??!1,autoTitleIncludeRules:e.autoTitleIncludeRules??!1})},[e.autoTitleEnabled,e.autoTitleModelId,e.autoTitlePromptMaxLength,e.autoTitleIncludeFiles,e.autoTitleIncludeRules,t]),f.jsxs("form",{onSubmit:n=>{n.preventDefault(),n.stopPropagation(),t.handleSubmit()},className:"space-y-3",children:[f.jsx(t.Field,{name:"autoTitleEnabled",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(oo,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(jt,{id:`${n.name}-label`,htmlFor:n.name,children:"Enable Auto-Title Generation"}),f.jsx(Kv,{field:n})]})}),t.state.values.autoTitleEnabled&&f.jsxs("div",{className:"space-y-3 pl-6 border-l-2 border-muted",children:[f.jsx(t.Field,{name:"autoTitleModelId",children:n=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:n.name,children:"Model for Title Generation"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Choose which model to use for generating conversation titles. Uses global default model if not specified."}),f.jsx(s6,{value:n.state.value,onChange:r=>n.handleChange(r),className:"w-full"}),f.jsx(Kv,{field:n})]})}),f.jsx(t.Field,{name:"autoTitlePromptMaxLength",children:n=>f.jsxs("div",{className:"space-y-1.5",children:[f.jsx(jt,{htmlFor:n.name,children:"Conversation Content Length Limit"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Maximum characters from conversation to include in title generation prompt (100-4000)."}),f.jsx(xn,{id:n.name,type:"number",min:100,max:4e3,step:1,value:n.state.value,onBlur:n.handleBlur,onChange:r=>{const s=r.target.valueAsNumber;isNaN(s)||n.handleChange(s)},className:`w-32 ${n.state.meta.errors.length?"border-destructive":""}`}),f.jsx(Kv,{field:n})]})}),f.jsx(t.Field,{name:"autoTitleIncludeFiles",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(oo,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(jt,{id:`${n.name}-label`,htmlFor:n.name,children:"Include file context in title prompt"}),f.jsx(Kv,{field:n})]})}),f.jsx(t.Field,{name:"autoTitleIncludeRules",children:n=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(oo,{id:n.name,checked:n.state.value,onCheckedChange:n.handleChange,onBlur:n.handleBlur,"aria-labelledby":`${n.name}-label`}),f.jsx(jt,{id:`${n.name}-label`,htmlFor:n.name,children:"Include active rules in title prompt"}),f.jsx(Kv,{field:n})]})})]}),f.jsx("div",{className:"flex justify-end pt-2",children:f.jsx(t.Subscribe,{selector:n=>[n.canSubmit,n.isSubmitting,n.isValidating,n.isValid],children:([n,r,s,i])=>f.jsx(ct,{type:"submit",size:"sm",disabled:!n||r||s||!i,children:r?"Saving...":s?"Validating...":"Save Title Settings"})})})]})},QKe=({selectedTools:e,onToolsChange:t,className:n,disabled:r=!1,maxSteps:s,onMaxStepsChange:i,globalDefaultMaxSteps:a=5,showMaxSteps:o=!1})=>{const l=E.useMemo(()=>new Set(e),[e]),c=E.useCallback((d,h)=>{const m=h?[...e,d]:e.filter(y=>y!==d);t(m)},[e,t]),u=E.useCallback((d,h)=>{t(d?h:[])},[t]);return f.jsx(Ose,{enabledTools:l,onToggleTool:c,onToggleAll:u,disabled:r,className:n,maxSteps:s,onMaxStepsChange:i,globalDefaultMaxSteps:a,showMaxSteps:o})},eYe=({variables:e,onVariablesChange:t,templateId:n})=>{const[r,s]=E.useState({name:"",description:"",type:"string",required:!1,default:"",instructions:""});E.useEffect(()=>{s({name:"",description:"",type:"string",required:!1,default:"",instructions:""})},[n]),E.useEffect(()=>()=>{s({name:"",description:"",type:"string",required:!1,default:"",instructions:""})},[]);const i=()=>{r.name&&(t([...e,{...r}]),s({name:"",description:"",type:"string",required:!1,default:"",instructions:""}))},a=o=>{t(e.filter((l,c)=>c!==o))};return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(jt,{className:"text-base font-medium",children:"Variables"}),f.jsxs("div",{className:"space-y-3 mt-2",children:[e.map((o,l)=>f.jsxs("div",{className:"p-3 border rounded-lg space-y-2",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsx("h4",{className:"font-medium",children:o.name}),f.jsx(ct,{variant:"ghost",size:"sm",onClick:()=>a(l),children:f.jsx(Pi,{className:"h-4 w-4"})})]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:o.description}),f.jsxs("div",{className:"flex gap-2 text-xs",children:[f.jsx(as,{variant:o.required?"default":"secondary",children:o.required?"Required":"Optional"}),f.jsx(as,{variant:"outline",children:o.type}),o.default&&f.jsxs(as,{variant:"outline",children:["Default: ",o.default]})]})]},`${o.name}-${l}`)),f.jsxs("div",{className:"p-3 border-2 border-dashed rounded-lg space-y-3",children:[f.jsx(jt,{children:"Add New Variable"}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx(jt,{children:"Name"}),f.jsx(xn,{value:r.name,onChange:o=>s(l=>({...l,name:o.target.value})),placeholder:"Variable name"})]}),f.jsxs("div",{children:[f.jsx(jt,{children:"Type"}),f.jsxs(lf,{value:r.type,onValueChange:o=>s(l=>({...l,type:o})),children:[f.jsx(uf,{children:f.jsx(cf,{})}),f.jsxs(df,{children:[f.jsx(Ba,{value:"string",children:"String"}),f.jsx(Ba,{value:"number",children:"Number"}),f.jsx(Ba,{value:"boolean",children:"Boolean"}),f.jsx(Ba,{value:"array",children:"Array"})]})]},`new-variable-type-${n||"new"}`)]})]}),f.jsxs("div",{children:[f.jsx(jt,{children:"Description"}),f.jsx(xn,{value:r.description,onChange:o=>s(l=>({...l,description:o.target.value})),placeholder:"Describe this variable"})]}),f.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[f.jsxs("div",{children:[f.jsx(jt,{children:"Default Value"}),f.jsx(xn,{value:r.default,onChange:o=>s(l=>({...l,default:o.target.value})),placeholder:"Default value (optional)"})]}),f.jsxs("div",{className:"flex items-center space-x-2 pt-6",children:[f.jsx(zc,{checked:r.required,onCheckedChange:o=>s(l=>({...l,required:!!o}))}),f.jsx(jt,{children:"Required"})]})]}),f.jsxs(ct,{type:"button",onClick:i,className:"w-full",children:[f.jsx(Pc,{className:"h-4 w-4 mr-2"}),"Add Variable"]})]})]})]})})},tYe=({selectedFollowUps:e,onFollowUpsChange:t,followUpOptions:n,templateId:r})=>{const[s,i]=E.useState(!1),[a,o]=E.useState(""),l=E.useRef(null),c=n.filter(m=>m.id!==r&&!e.includes(m.id)),u=c.filter(m=>m.name.toLowerCase().includes(a.toLowerCase())||m.description.toLowerCase().includes(a.toLowerCase())),d=m=>{m&&!e.includes(m)&&(t([...e,m]),o(""),i(!1))};E.useEffect(()=>{const m=y=>{l.current&&!l.current.contains(y.target)&&i(!1)};return document.addEventListener("mousedown",m),()=>{document.removeEventListener("mousedown",m)}},[]);const h=m=>{t(e.filter(y=>y!==m))};return f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(jt,{className:"text-base font-medium",children:"Follow-up Templates"}),f.jsx("p",{className:"text-sm text-muted-foreground mb-4",children:"Select templates that can be suggested as follow-ups after this template is used."}),f.jsxs("div",{className:"space-y-3",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{className:"text-sm font-medium",children:"Selected Follow-ups:"}),e.length===0?f.jsx("p",{className:"text-sm text-muted-foreground",children:"No follow-ups selected yet."}):f.jsx("div",{className:"flex flex-wrap gap-2",children:e.map(m=>{const y=n.find(b=>b.id===m);return y?f.jsxs(as,{variant:"secondary",className:"flex items-center gap-1",children:[y.name,f.jsx(ct,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-destructive hover:text-destructive-foreground",onClick:()=>h(m),children:f.jsx(Pi,{className:"h-3 w-3"})})]},m):f.jsxs(as,{variant:"destructive",className:"flex items-center gap-1",children:["Unknown Template (",m,")",f.jsx(ct,{variant:"ghost",size:"sm",className:"h-4 w-4 p-0 hover:bg-destructive hover:text-destructive-foreground",onClick:()=>h(m),children:f.jsx(Pi,{className:"h-3 w-3"})})]},m)})})]}),c.length>0&&f.jsxs("div",{className:"relative",ref:l,children:[f.jsx(jt,{className:"text-sm",children:"Add Follow-up Template:"}),f.jsxs("div",{className:"relative",children:[f.jsxs("div",{className:"flex h-9 w-full items-center justify-between rounded-md border border-input bg-transparent px-3 py-2 text-sm shadow-sm cursor-pointer hover:bg-accent",onClick:()=>i(!s),children:[f.jsx("span",{className:"text-muted-foreground",children:a||"Select a template to add as follow-up"}),f.jsx(Ql,{className:"h-4 w-4 opacity-50"})]}),s&&f.jsxs("div",{className:"absolute top-full left-0 right-0 z-50 mt-1 max-h-60 overflow-auto rounded-md border bg-popover text-popover-foreground shadow-md",children:[f.jsx("div",{className:"p-2",children:f.jsx(xn,{placeholder:"Search templates...",value:a,onChange:m=>o(m.target.value),className:"h-8"})}),f.jsx("div",{className:"max-h-48 overflow-auto",children:u.length===0?f.jsx("div",{className:"px-2 py-1.5 text-sm text-muted-foreground",children:"No templates found."}):u.map(m=>f.jsxs("div",{className:"relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none hover:bg-accent hover:text-accent-foreground",onClick:()=>d(m.id),children:[m.name," - ",m.description]},m.id))})]})]})]}),c.length===0&&e.length===0&&f.jsx("p",{className:"text-sm text-muted-foreground",children:"No templates available for follow-ups. Create more templates first."}),c.length===0&&e.length>0&&f.jsx("p",{className:"text-sm text-muted-foreground",children:"All available templates have been selected as follow-ups."})]})]})})},nYe=()=>{const e=Ke({name:$e().min(1,"Name is required"),description:$e(),variables:ln(Ke({name:$e().min(1,"Variable name is required"),description:$e(),type:vl(["string","number","boolean","array"]),required:Zn(),default:$e().optional(),instructions:$e().optional()})),prompt:$e().min(1,"Prompt content is required"),tags:ln($e()),tools:ln($e()),rules:ln($e()),followUps:ln($e())});return async({value:t})=>{try{await e.parseAsync(t)}catch(n){return n instanceof Oc?n.formErrors.fieldErrors:{root:"Validation failed"}}}},j0=({template:e,onSubmit:t,onSuccess:n,type:r,showFollowUps:s=!1,showMaxSteps:i=!1,followUpOptions:a=[],additionalActions:o})=>{const[l,c]=E.useState(null),{rules:u,tags:d,tagRuleLinks:h,loadRulesAndTags:m}=Sne(yn(w=>({rules:w.rules,tags:w.tags,tagRuleLinks:w.tagRuleLinks,loadRulesAndTags:w.loadRulesAndTags})));E.useEffect(()=>{m()},[m]);const y=ii({defaultValues:{name:(e==null?void 0:e.name)||"",description:(e==null?void 0:e.description)||"",variables:(e==null?void 0:e.variables)||[],prompt:(e==null?void 0:e.prompt)||"",tags:(e==null?void 0:e.tags)||[],tools:(e==null?void 0:e.tools)||[],rules:(e==null?void 0:e.rules)||[],followUps:(e==null?void 0:e.followUps)||[]},validators:{onChangeAsync:nYe(),onChangeAsyncDebounceMs:500},onSubmit:async({value:w})=>{t(w),n()}}),b=w=>{const S=h.filter(k=>k.tagId===w).map(k=>k.ruleId);return u.filter(k=>S.includes(k.id))},v=()=>{switch(r){case"agent":return"Agent";case"task":return"Task";default:return"Template"}},x=()=>{switch(r){case"agent":return"Agent Prompt";case"task":return"Task Prompt";default:return"Prompt Template"}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:e?`Edit ${v()}`:`New ${v()}`}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e?`Update your ${r}`:`Create a new ${r}${r==="prompt"?" template with variables":""}`})]}),f.jsxs("form",{onSubmit:w=>{w.preventDefault(),w.stopPropagation(),y.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{className:"space-y-4",children:[f.jsx(y.Field,{name:"name",children:w=>f.jsxs("div",{children:[f.jsxs(jt,{htmlFor:w.name,children:[v()," Name"]}),f.jsx(xn,{id:w.name,value:w.state.value,onChange:S=>w.handleChange(S.target.value),onBlur:w.handleBlur,placeholder:`Enter ${r} name`}),w.state.meta.errors&&w.state.meta.errors.length>0&&f.jsx("p",{className:"text-xs text-destructive mt-1",children:w.state.meta.errors[0]||"Invalid input"})]})}),f.jsx(y.Field,{name:"description",children:w=>f.jsxs("div",{children:[f.jsx(jt,{htmlFor:w.name,children:"Description"}),f.jsx(qa,{id:w.name,value:w.state.value,onChange:S=>w.handleChange(S.target.value),onBlur:w.handleBlur,placeholder:`Describe what this ${r} does`,rows:3})]})}),f.jsx(y.Field,{name:"prompt",children:w=>f.jsxs("div",{children:[f.jsx(jt,{htmlFor:w.name,children:x()}),f.jsx(qa,{id:w.name,value:w.state.value,onChange:S=>w.handleChange(S.target.value),onBlur:w.handleBlur,placeholder:`Enter your ${r} prompt using {{ variable_name }} syntax`,rows:6,className:"font-mono"}),f.jsxs("p",{className:"text-xs text-muted-foreground mt-2",children:["Use double curly braces to reference variables:"," ","{{ variable_name }}"]}),w.state.meta.errors&&w.state.meta.errors.length>0&&f.jsx("p",{className:"text-xs text-destructive mt-1",children:w.state.meta.errors[0]||"Invalid input"})]})})]}),f.jsx(y.Field,{name:"variables",children:w=>f.jsx(eYe,{variables:w.state.value,onVariablesChange:S=>w.handleChange(S),templateId:e==null?void 0:e.id})}),s&&f.jsx(y.Field,{name:"followUps",children:w=>f.jsx(tYe,{selectedFollowUps:w.state.value||[],onFollowUpsChange:S=>w.handleChange(S),followUpOptions:a,templateId:e==null?void 0:e.id})}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(jt,{className:"text-base font-medium",children:"Auto-select Tools"}),f.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Choose tools that will be automatically enabled when this ",r,"is applied."]}),f.jsx(y.Field,{name:"tools",children:w=>f.jsx(QKe,{selectedTools:w.state.value,onToolsChange:S=>w.handleChange(S),className:"p-0 max-w-none",maxSteps:l,onMaxStepsChange:c,showMaxSteps:i})})]})}),f.jsx("div",{className:"space-y-4",children:f.jsxs("div",{children:[f.jsx(jt,{className:"text-base font-medium",children:"Auto-select Rules & Tags"}),f.jsxs("p",{className:"text-sm text-muted-foreground mb-4",children:["Choose rules and tags that will be automatically enabled when this",r," is applied."]}),f.jsx(Xse,{activeTagIds:new Set(y.getFieldValue("tags")),activeRuleIds:new Set(y.getFieldValue("rules")),onToggleTag:(w,S)=>{const k=y.getFieldValue("tags");S?y.setFieldValue("tags",[...k,w]):y.setFieldValue("tags",k.filter(C=>C!==w))},onToggleRule:(w,S)=>{const k=y.getFieldValue("rules");S?y.setFieldValue("rules",[...k,w]):y.setFieldValue("rules",k.filter(C=>C!==w))},allRules:u,allTags:d,getRulesForTag:b})]})}),f.jsxs("div",{className:"flex gap-3 pt-4 border-t",children:[f.jsxs(ct,{type:"submit",className:"flex-1",children:[f.jsx(Uu,{className:"h-4 w-4 mr-2"}),e?`Update ${v()}`:`Create ${v()}`]}),o]})]})]})},W4=({templates:e,onEdit:t,onDelete:n,type:r,emptyMessage:s,additionalActions:i,getTaskCount:a})=>{const o=()=>{switch(r){case"agent":return"Agents";case"task":return"Tasks";default:return"Templates"}},l=()=>{switch(r){case"agent":return"Manage your AI agents and their associated tasks";case"task":return"Manage tasks for this agent";default:return"Manage your reusable prompt templates with dynamic variables"}},c=()=>{if(s)return s;switch(r){case"agent":return"No Agents Yet";case"task":return"No Tasks Yet";default:return"No Templates Yet"}},u=()=>{switch(r){case"agent":return'Use the "New Agent" tab to create your first agent';case"task":return"Create tasks to define what this agent can do";default:return'Use the "New Template" tab to create your first template'}};return f.jsxs("div",{className:"space-y-4",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:o()}),f.jsx("p",{className:"text-sm text-muted-foreground",children:l()})]}),e.length===0?f.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[f.jsx("h4",{className:"font-medium text-muted-foreground",children:c()}),f.jsx("p",{className:"text-sm text-muted-foreground mt-1",children:u()})]}):f.jsxs(yf,{children:[f.jsx(gp,{children:f.jsxs(Ts,{children:[f.jsx(Rr,{children:"Name"}),f.jsx(Rr,{children:"Description"}),f.jsx(Rr,{children:"Variables"}),r==="agent"&&f.jsx(Rr,{children:"Tasks"}),(r==="prompt"||r==="task")&&f.jsx(Rr,{children:"Follow-ups"}),f.jsx(Rr,{children:"Tools"}),f.jsx(Rr,{children:"Rules/Tags"}),f.jsx(Rr,{className:"text-right",children:"Actions"})]})}),f.jsx(bf,{children:e.map(d=>{var h,m,y,b;return f.jsxs(Ts,{children:[f.jsx(Ln,{className:"font-medium",children:d.name}),f.jsx(Ln,{className:"max-w-xs truncate",children:d.description}),f.jsx(Ln,{children:f.jsx(as,{variant:"secondary",children:d.variables.length})}),r==="agent"&&f.jsx(Ln,{children:f.jsx(as,{variant:"secondary",children:a?a(d.id):0})}),(r==="prompt"||r==="task")&&f.jsx(Ln,{children:f.jsx(as,{variant:"secondary",children:((h=d.followUps)==null?void 0:h.length)||0})}),f.jsx(Ln,{children:f.jsx(as,{variant:"secondary",children:((m=d.tools)==null?void 0:m.length)||0})}),f.jsx(Ln,{children:f.jsxs("div",{className:"flex gap-1",children:[f.jsxs(as,{variant:"secondary",children:[((y=d.tags)==null?void 0:y.length)||0," tags"]}),f.jsxs(as,{variant:"secondary",children:[((b=d.rules)==null?void 0:b.length)||0," rules"]})]})}),f.jsx(Ln,{className:"text-right",children:f.jsxs("div",{className:"flex gap-2 justify-end",children:[i&&i(d),f.jsx(ct,{variant:"ghost",size:"sm",onClick:()=>t(d),title:`Edit ${r}`,children:f.jsx(Ch,{className:"h-4 w-4"})}),f.jsx(ct,{variant:"ghost",size:"sm",onClick:()=>n(d.id),title:`Delete ${r}`,children:f.jsx(Po,{className:"h-4 w-4"})})]})})]},d.id)})})]})]})},rYe=()=>{const[e,t]=E.useState("templates"),[n,r]=E.useState(),{loadPromptTemplates:s,addPromptTemplate:i,updatePromptTemplate:a,deletePromptTemplate:o,getTemplatesByType:l}=Om(yn(v=>({loadPromptTemplates:v.loadPromptTemplates,addPromptTemplate:v.addPromptTemplate,updatePromptTemplate:v.updatePromptTemplate,deletePromptTemplate:v.deletePromptTemplate,getTemplatesByType:v.getTemplatesByType}))),c=l("prompt");E.useEffect(()=>{s()},[s]);const u=async v=>{await i({...v,type:"prompt",isPublic:!1})},d=async v=>{n&&await a(n.id,v)},h=async v=>{confirm("Are you sure you want to delete this template?")&&await o(v)},m=v=>{r(v),t("edit")},y=()=>{t("templates"),r(void 0)},b=[{value:"templates",label:"Templates",content:f.jsx(W4,{templates:c,onEdit:m,onDelete:h,type:"prompt"})},{value:"new",label:"New Template",content:f.jsx(j0,{onSubmit:u,onSuccess:y,type:"prompt",showFollowUps:!0,followUpOptions:c},"new-template-form")}];return n&&b.push({value:"edit",label:`Edit: ${n.name}`,content:f.jsx(j0,{template:n,onSubmit:d,onSuccess:y,type:"prompt",showFollowUps:!0,followUpOptions:c},`edit-template-form-${n.id}`)}),f.jsx(xl,{tabs:b,initialValue:e,onValueChange:t,defaultValue:"templates",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},sYe=()=>{const[e,t]=E.useState("agents"),[n,r]=E.useState(),[s,i]=E.useState(),[a,o]=E.useState(),{loadPromptTemplates:l,addPromptTemplate:c,updatePromptTemplate:u,deletePromptTemplate:d,getAgents:h,getTasksForAgent:m}=Om(yn(P=>({loadPromptTemplates:P.loadPromptTemplates,addPromptTemplate:P.addPromptTemplate,updatePromptTemplate:P.updatePromptTemplate,deletePromptTemplate:P.deletePromptTemplate,getAgents:P.getAgents,getTasksForAgent:P.getTasksForAgent})));E.useEffect(()=>{l()},[l]);const y=h(),b=s?m(s.id):[],v=async P=>{await c({...P,type:"agent",isPublic:!1})},x=async P=>{n&&await u(n.id,P)},w=async P=>{if(confirm("Are you sure you want to delete this agent and all its tasks?")){const K=m(P);for(const U of K)await d(U.id);await d(P)}},S=async P=>{s&&await c({...P,type:"task",parentId:s.id,isPublic:!1})},k=async P=>{!a||!s||await u(a.id,{...P,parentId:s.id})},C=async P=>{confirm("Are you sure you want to delete this task?")&&await d(P)},T=P=>{r(P),t("edit-agent")},A=P=>{i(P),t("manage-tasks")},N=P=>{o(P),t("edit-task")},I=()=>{o(void 0),t("new-task")},O=()=>{t("agents"),r(void 0),i(void 0),o(void 0)},B=()=>{t("agents"),i(void 0),o(void 0)},D=()=>{t("manage-tasks"),o(void 0)},H=[{value:"agents",label:"Agents",content:f.jsx(W4,{templates:y,onEdit:T,onDelete:w,type:"agent",getTaskCount:P=>m(P).length,additionalActions:P=>f.jsxs(ct,{variant:"ghost",size:"sm",onClick:()=>A(P),title:"Manage Tasks",children:[f.jsx(Ch,{className:"h-4 w-4"}),"Tasks"]})})},{value:"new-agent",label:"New Agent",content:f.jsx(j0,{onSubmit:v,onSuccess:O,type:"agent",showFollowUps:!1,showMaxSteps:!0},"new-agent-form")}];return n&&H.push({value:"edit-agent",label:`Edit: ${n.name}`,content:f.jsx(j0,{template:n,onSubmit:x,onSuccess:O,type:"agent",showFollowUps:!1,showMaxSteps:!0,additionalActions:f.jsxs(ct,{type:"button",variant:"outline",onClick:()=>A(n),className:"flex items-center gap-2",children:[f.jsx(Ch,{className:"h-4 w-4"}),"Tasks (",m(n.id).length,")"]})},`edit-agent-form-${n.id}`)}),s&&H.push({value:"manage-tasks",label:`Tasks: ${s.name}`,content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(ct,{variant:"outline",onClick:B,children:" Back to Agents"})}),f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsxs("h3",{className:"font-medium",children:["Tasks for ",s.name]}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage tasks for this agent"})]}),f.jsxs(ct,{onClick:I,children:[f.jsx(Pc,{className:"h-4 w-4 mr-2"}),"New Task"]})]}),f.jsx(W4,{templates:b,onEdit:N,onDelete:C,type:"task",emptyMessage:"No Tasks Yet"})]})}),s&&e==="new-task"&&H.push({value:"new-task",label:"New Task",content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(ct,{variant:"outline",onClick:D,children:" Back to Tasks"})}),f.jsx(j0,{onSubmit:S,onSuccess:D,type:"task",showFollowUps:!0,followUpOptions:b,showMaxSteps:!0},`new-task-form-${s.id}`)]})}),a&&s&&H.push({value:"edit-task",label:`Edit: ${a.name}`,content:f.jsxs("div",{className:"space-y-4",children:[f.jsx("div",{className:"flex items-center gap-2",children:f.jsx(ct,{variant:"outline",onClick:D,children:" Back to Tasks"})}),f.jsx(j0,{template:a,onSubmit:k,onSuccess:D,type:"task",showFollowUps:!0,followUpOptions:b.filter(P=>P.id!==a.id),showMaxSteps:!0},`edit-task-form-${a.id}`)]})}),f.jsx(xl,{tabs:H,initialValue:e,onValueChange:t,defaultValue:"agents",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},iYe=Ke({name:$e().min(1,"Name is required"),url:$e().url("Must be a valid URL"),description:$e(),headers:$e(),enabled:Zn()}),aYe=Ke({retryAttempts:At().min(0,"Min 0 attempts").max(10,"Max 10 attempts"),retryDelay:At().min(500,"Min 500ms").max(3e4,"Max 30000ms"),connectionTimeout:At().min(1e3,"Min 1000ms").max(6e4,"Max 60000ms"),maxResponseSize:At().min(1e3,"Min 1KB").max(1e7,"Max 10MB")});function Ec({field:e}){return f.jsx(f.Fragment,{children:e.state.meta.isTouched&&e.state.meta.errors.length>0?f.jsx("em",{className:"text-xs text-destructive mt-1 block",children:e.state.meta.errors.join(", ")}):null})}function oYe(){const{bridgeConfig:e,setBridgeConfig:t}=ll(yn(s=>({bridgeConfig:s.bridgeConfig,setBridgeConfig:s.setBridgeConfig}))),n=ii({defaultValues:{url:e.url||"",host:e.host||"",port:e.port||void 0},onSubmit:async({value:s})=>{t({url:s.url||void 0,host:s.host||void 0,port:s.port})}});E.useEffect(()=>{n.reset({url:e.url||"",host:e.host||"",port:e.port||void 0})},[e,n]);const r=()=>{window.confirm("Reset bridge configuration to defaults?")&&t({})};return f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),n.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"Dynamic MCP Bridge Configuration"}),f.jsxs("p",{className:"text-sm text-muted-foreground",children:["Configure where LiteChat looks for the dynamic MCP bridge service (required for stdio:// servers). Start the bridge with: ",f.jsx("code",{className:"bg-muted px-1 rounded",children:"npm run mcp-proxy"})]})]}),f.jsxs(Fo,{children:[f.jsxs(Lo,{children:[f.jsxs(Bo,{className:"text-base flex items-center",children:[f.jsx(Rh,{className:"mr-2 h-4 w-4"}),"Bridge Location"]}),f.jsx(Au,{children:"Specify where your dynamic MCP bridge is running (default: localhost:3001)"})]}),f.jsxs($o,{className:"space-y-4",children:[f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsx(n.Field,{name:"url",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:s.name,children:"Full Bridge URL (highest priority)"}),f.jsx(xn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"http://192.168.1.100:3001"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Complete URL where the dynamic MCP bridge is running"}),f.jsx(Ec,{field:s})]})}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{children:"Or configure Host + Port"}),f.jsxs("div",{className:"flex gap-2",children:[f.jsx(n.Field,{name:"host",children:s=>f.jsxs("div",{className:"flex-1",children:[f.jsx(xn,{value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"localhost"}),f.jsx(Ec,{field:s})]})}),f.jsx(n.Field,{name:"port",children:s=>f.jsxs("div",{className:"w-20",children:[f.jsx(xn,{type:"number",value:s.state.value||"",onChange:i=>s.handleChange(parseInt(i.target.value)||void 0),onBlur:s.handleBlur,placeholder:"3001"}),f.jsx(Ec,{field:s})]})})]}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Host and port (uses HTTP by default)"})]})]}),f.jsxs("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md",children:[f.jsx("p",{className:"font-medium mb-1",children:"Bridge Detection Priority:"}),f.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-xs",children:[f.jsx("li",{children:"Full URL (if specified above)"}),f.jsx("li",{children:"Host + Port combination (if specified above)"}),f.jsx("li",{children:"Auto-detection fallback: localhost:3001"})]}),f.jsx("p",{className:"mt-2 text-xs",children:"Leave empty for auto-detection. For remote bridge, use full URL or configure host binding."})]})]})]}),f.jsxs(Fo,{children:[f.jsx(Lo,{children:f.jsx(Bo,{className:"text-base",children:"Bridge Setup Instructions"})}),f.jsx($o,{className:"space-y-3",children:f.jsxs("div",{className:"text-sm space-y-2",children:[f.jsx("p",{className:"font-medium",children:"To use stdio MCP servers, install and run the bridge:"}),f.jsxs("div",{className:"bg-muted p-3 rounded font-mono text-xs",children:[f.jsx("p",{children:"# Start the bridge (from LiteChat project directory)"}),f.jsx("p",{children:"node bin/mcp-bridge.js"}),f.jsx("p",{}),f.jsx("p",{children:"# Or with custom settings"}),f.jsx("p",{children:"node bin/mcp-bridge.js --host 0.0.0.0 --port 3001"})]})]})})]}),f.jsx("div",{className:"flex items-center justify-between pt-3 border-t",children:f.jsx(n.Subscribe,{children:s=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(ct,{type:"submit",size:"sm",disabled:!s.canSubmit||s.isSubmitting||s.isValidating||!s.isValid,children:s.isSubmitting?"Saving...":s.isValidating?"Validating...":"Save Bridge Config"}),f.jsxs(ct,{variant:"outline",size:"sm",onClick:r,type:"button",children:[f.jsx(b1,{className:"mr-2 h-4 w-4"}),"Reset"]})]})})})]})}function lYe(){const{retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r,setRetryAttempts:s,setRetryDelay:i,setConnectionTimeout:a,setMaxResponseSize:o}=ll(yn(u=>({retryAttempts:u.retryAttempts,retryDelay:u.retryDelay,connectionTimeout:u.connectionTimeout,maxResponseSize:u.maxResponseSize,setRetryAttempts:u.setRetryAttempts,setRetryDelay:u.setRetryDelay,setConnectionTimeout:u.setConnectionTimeout,setMaxResponseSize:u.setMaxResponseSize}))),l=ii({defaultValues:{retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r},validators:{onChangeAsync:aYe,onChangeAsyncDebounceMs:500},onSubmit:async({value:u})=>{s(u.retryAttempts),i(u.retryDelay),a(u.connectionTimeout),o(u.maxResponseSize)}});E.useEffect(()=>{l.reset({retryAttempts:e,retryDelay:t,connectionTimeout:n,maxResponseSize:r})},[e,t,n,r,l]);const c=()=>{window.confirm("Reset connection settings to defaults?")&&(s(3),i(2e3),a(1e4),o(128e3))};return f.jsxs("form",{onSubmit:u=>{u.preventDefault(),u.stopPropagation(),l.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"Connection Settings"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Configure retry behavior and timeouts for MCP server connections"})]}),f.jsxs(Fo,{children:[f.jsxs(Lo,{children:[f.jsx(Bo,{className:"text-base",children:"Retry Configuration"}),f.jsx(Au,{children:"How LiteChat handles failed connections"})]}),f.jsx($o,{className:"space-y-4",children:f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[f.jsx(l.Field,{name:"retryAttempts",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:u.name,children:"Retry Attempts"}),f.jsx(xn,{id:u.name,type:"number",min:"0",max:"10",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||0),onBlur:u.handleBlur,placeholder:"3"}),f.jsx(Ec,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Number of retry attempts (0-10)"})]})}),f.jsx(l.Field,{name:"retryDelay",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:u.name,children:"Retry Delay (ms)"}),f.jsx(xn,{id:u.name,type:"number",min:"500",max:"30000",step:"500",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||2e3),onBlur:u.handleBlur,placeholder:"2000"}),f.jsx(Ec,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Initial delay between retries (500-30000ms)"})]})}),f.jsx(l.Field,{name:"connectionTimeout",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:u.name,children:"Connection Timeout (ms)"}),f.jsx(xn,{id:u.name,type:"number",min:"1000",max:"60000",step:"1000",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||1e4),onBlur:u.handleBlur,placeholder:"10000"}),f.jsx(Ec,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Connection timeout (1000-60000ms)"})]})}),f.jsx(l.Field,{name:"maxResponseSize",children:u=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:u.name,children:"Max Response Size (bytes)"}),f.jsx(xn,{id:u.name,type:"number",min:"1000",max:"10000000",step:"1000",value:u.state.value,onChange:d=>u.handleChange(parseInt(d.target.value)||128e3),onBlur:u.handleBlur,placeholder:"128000"}),f.jsx(Ec,{field:u}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Max tool response size (1KB-10MB)"})]})})]})})]}),f.jsxs(Fo,{children:[f.jsx(Lo,{children:f.jsx(Bo,{className:"text-base",children:"How It Works"})}),f.jsx($o,{children:f.jsx("div",{className:"text-sm text-muted-foreground bg-muted/50 p-3 rounded-md",children:f.jsxs("ul",{className:"list-disc list-inside space-y-1",children:[f.jsx("li",{children:"Failed connections will be retried automatically with exponential backoff"}),f.jsx("li",{children:"Toast notifications will show connection status and retry progress"}),f.jsx("li",{children:"Servers that fail all retry attempts will be marked as disconnected"}),f.jsx("li",{children:"You can manually retry connections from the server cards in the Servers tab"}),f.jsxs("li",{children:[f.jsx("strong",{children:"Max Response Size:"})," Tool responses larger than this limit will be automatically truncated to prevent API errors"]})]})})})]}),f.jsx("div",{className:"flex items-center justify-between pt-3 border-t",children:f.jsx(l.Subscribe,{children:u=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(ct,{type:"submit",size:"sm",disabled:!u.canSubmit||u.isSubmitting||u.isValidating||!u.isValid,children:u.isSubmitting?"Saving...":u.isValidating?"Validating...":"Save Connection Settings"}),f.jsxs(ct,{variant:"outline",size:"sm",onClick:c,type:"button",children:[f.jsx(b1,{className:"mr-2 h-4 w-4"}),"Reset"]})]})})})]})}function lV({server:e,onSubmit:t,onCancel:n}){const r=ii({defaultValues:{name:(e==null?void 0:e.name)||"",url:(e==null?void 0:e.url)||"",description:(e==null?void 0:e.description)||"",headers:e!=null&&e.headers?JSON.stringify(e.headers,null,2):"",enabled:(e==null?void 0:e.enabled)??!0},validators:{onChangeAsync:iYe,onChangeAsyncDebounceMs:500},onSubmit:async({value:s})=>{t(s)}});return E.useEffect(()=>{r.reset({name:(e==null?void 0:e.name)||"",url:(e==null?void 0:e.url)||"",description:(e==null?void 0:e.description)||"",headers:e!=null&&e.headers?JSON.stringify(e.headers,null,2):"",enabled:(e==null?void 0:e.enabled)??!0})},[e,r]),f.jsxs("form",{onSubmit:s=>{s.preventDefault(),s.stopPropagation(),r.handleSubmit()},className:"space-y-6",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium",children:e?"Edit MCP Server":"Add New MCP Server"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:e?"Modify the server configuration below.":"Configure a new MCP server to connect to."})]}),f.jsxs(Fo,{children:[f.jsx(Lo,{children:f.jsxs(Bo,{className:"text-base flex items-center",children:[f.jsx(ry,{className:"mr-2 h-4 w-4"}),"Server Details"]})}),f.jsxs($o,{className:"space-y-4",children:[f.jsx(r.Field,{name:"name",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:s.name,children:"Server Name"}),f.jsx(xn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"My MCP Server"}),f.jsx(Ec,{field:s})]})}),f.jsx(r.Field,{name:"url",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:s.name,children:"Server URL"}),f.jsx(xn,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"https://api.example.com/mcp or stdio://npx?args=-y,@modelcontextprotocol/server-filesystem,."}),f.jsx(Ec,{field:s}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"HTTP/HTTPS URLs for remote servers, or stdio://command?args=arg1,arg2 for dynamic bridge servers"})]})}),f.jsx(r.Field,{name:"description",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:s.name,children:"Description (Optional)"}),f.jsx(qa,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:"Brief description of this server's purpose",rows:2}),f.jsx(Ec,{field:s})]})}),f.jsx(r.Field,{name:"headers",children:s=>f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:s.name,children:"Authentication Headers (Optional)"}),f.jsx(qa,{id:s.name,value:s.state.value,onChange:i=>s.handleChange(i.target.value),onBlur:s.handleBlur,placeholder:'{"Authorization": "Bearer your-token-here"}',rows:3}),f.jsx(Ec,{field:s}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"JSON object with authentication headers (not applicable for stdio servers)"})]})}),f.jsx(r.Field,{name:"enabled",children:s=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(oo,{id:s.name,checked:s.state.value,onCheckedChange:s.handleChange}),f.jsx(jt,{htmlFor:s.name,children:"Enable this server"})]})})]}),f.jsxs(jPe,{className:"flex gap-2",children:[f.jsx(r.Subscribe,{selector:s=>[s.canSubmit,s.isSubmitting],children:([s,i])=>f.jsx(ct,{type:"submit",disabled:!s||i,children:i?e?"Updating...":"Adding...":e?"Update Server":"Add Server"})}),f.jsx(ct,{type:"button",variant:"outline",onClick:n,children:"Cancel"})]})]})]})}function cYe({onNewServer:e,onEditServer:t}){const{servers:n,deleteServer:r,updateServer:s}=ll(yn(o=>({servers:o.servers,deleteServer:o.deleteServer,updateServer:o.updateServer}))),i=o=>{window.confirm("Are you sure you want to delete this MCP server?")&&r(o)},a=o=>{s(o.id,{enabled:!o.enabled})};return f.jsxs("div",{className:"space-y-6",children:[f.jsxs("div",{className:"flex items-center justify-between",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"font-medium",children:"MCP Servers"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Manage your Model Context Protocol servers"})]}),f.jsxs(ct,{onClick:e,children:[f.jsx(Pc,{className:"mr-2 h-4 w-4"}),"Add Server"]})]}),n.length===0?f.jsxs("div",{className:"text-center py-12 border-2 border-dashed rounded-lg",children:[f.jsx(ry,{className:"h-12 w-12 text-muted-foreground mb-4 mx-auto"}),f.jsx("h4",{className:"font-medium text-muted-foreground",children:"No MCP Servers"}),f.jsx("p",{className:"text-sm text-muted-foreground mt-1 mb-4",children:"Add HTTP-based MCP servers to extend LiteChat with additional tools and capabilities"}),f.jsxs(ct,{onClick:e,children:[f.jsx(Pc,{className:"mr-2 h-4 w-4"}),"Add Your First Server"]})]}):f.jsxs(yf,{children:[f.jsx(gp,{children:f.jsxs(Ts,{children:[f.jsx(Rr,{children:"Name"}),f.jsx(Rr,{children:"URL"}),f.jsx(Rr,{children:"Status"}),f.jsx(Rr,{children:"Description"}),f.jsx(Rr,{className:"text-right",children:"Actions"})]})}),f.jsx(bf,{children:n.map(o=>f.jsxs(Ts,{children:[f.jsx(Ln,{className:"font-medium",children:o.name}),f.jsx(Ln,{className:"max-w-xs truncate font-mono text-xs",children:o.url}),f.jsx(Ln,{children:f.jsx(as,{variant:o.enabled?"default":"secondary",children:o.enabled?f.jsxs(f.Fragment,{children:[f.jsx(Kpe,{className:"mr-1 h-3 w-3"}),"Enabled"]}):f.jsxs(f.Fragment,{children:[f.jsx(tme,{className:"mr-1 h-3 w-3"}),"Disabled"]})})}),f.jsx(Ln,{className:"max-w-xs truncate",children:o.description||""}),f.jsx(Ln,{className:"text-right",children:f.jsxs("div",{className:"flex gap-2 justify-end",children:[f.jsx(oo,{checked:o.enabled,onCheckedChange:()=>a(o),className:"scale-75"}),f.jsx(ct,{variant:"ghost",size:"sm",onClick:()=>t(o),children:f.jsx(Ch,{className:"h-4 w-4"})}),f.jsx(ct,{variant:"ghost",size:"sm",onClick:()=>i(o.id),children:f.jsx(t0e,{className:"h-4 w-4"})})]})})]},o.id))})]})]})}const uYe=()=>{const[e,t]=E.useState("servers"),[n,r]=E.useState(),{addServer:s,updateServer:i}=ll(yn(h=>({addServer:h.addServer,updateServer:h.updateServer}))),a=async h=>{try{const m=h.headers?JSON.parse(h.headers):void 0;s({name:h.name,url:h.url,description:h.description,headers:m,enabled:h.enabled}),t("servers")}catch(m){console.error("Invalid headers JSON:",m),Te.error("Invalid JSON in headers field")}},o=async h=>{if(n)try{const m=h.headers?JSON.parse(h.headers):void 0;i(n.id,{name:h.name,url:h.url,description:h.description,headers:m,enabled:h.enabled}),t("servers"),r(void 0)}catch(m){console.error("Invalid headers JSON:",m),Te.error("Invalid JSON in headers field")}},l=()=>{r(void 0),t("new")},c=h=>{r(h),t("edit")},u=()=>{t("servers"),r(void 0)},d=[{value:"servers",label:"Servers",content:f.jsx(cYe,{onNewServer:l,onEditServer:c})},{value:"bridge",label:"Bridge Config",content:f.jsx(oYe,{})},{value:"connection",label:"Connection",content:f.jsx(lYe,{})},{value:"new",label:"Add Server",content:f.jsx(lV,{onSubmit:a,onCancel:u},"new-server-form")}];return n&&d.push({value:"edit",label:`Edit: ${n.name}`,content:f.jsx(lV,{server:n,onSubmit:o,onCancel:u},`edit-server-form-${n.id}`)}),f.jsx(xl,{tabs:d,initialValue:e,onValueChange:t,defaultValue:"servers",contentContainerClassName:"pb-2 sm:pb-6 pr-1 sm:pr-2 -mr-1 sm:-mr-2",scrollable:!1})},wC=`Please provide a detailed but concise summary of our conversation so far. Include:

1. **Main Topics**: Key subjects we've discussed
2. **Important Decisions**: Any conclusions or agreements reached  
3. **Action Items**: Tasks or next steps identified
4. **Context**: Essential background information for continuing our discussion
5. **Current Status**: Where we left off and what we were working on

Keep the summary comprehensive enough that someone could understand the full context and continue our conversation seamlessly, but concise enough to be easily digestible. Focus on actionable information and key insights rather than verbose details.`,dYe=()=>{const[e,t]=E.useState(!1),[n,r]=E.useState(""),[s,i]=E.useState(null),{forkCompactPrompt:a,forkCompactModelId:o,setForkCompactPrompt:l,setForkCompactModelId:c}=pr(yn(y=>({forkCompactPrompt:y.forkCompactPrompt,forkCompactModelId:y.forkCompactModelId,setForkCompactPrompt:y.setForkCompactPrompt,setForkCompactModelId:y.setForkCompactModelId}))),{globallyEnabledModels:u}=Qn(yn(y=>({globallyEnabledModels:y.getGloballyEnabledModelDefinitions()})));E.useEffect(()=>{r(a||wC),i(o)},[a,o]);const d=async()=>{t(!0);try{l(n),c(s),Te.success("Fork Compact settings saved!")}catch(y){console.error("Failed to save fork compact settings:",y),Te.error("Failed to save settings")}finally{t(!1)}},h=()=>{confirm("Reset Fork Compact settings to defaults?")&&(r(wC),i(null),l(wC),c(null),Te.success("Fork Compact settings reset to defaults"))},m=n!==(a||wC)||s!==o;return f.jsx("div",{className:"space-y-6",children:f.jsxs(Fo,{children:[f.jsxs(Lo,{children:[f.jsx(Bo,{children:"Fork Compact Configuration"}),f.jsx(Au,{children:"Configure the model and prompt used when creating compact conversation summaries. Fork Compact creates a new conversation with a summary of the current conversation history."})]}),f.jsxs($o,{className:"space-y-4",children:[f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:"fork-compact-model",children:"Default Model"}),f.jsxs(lf,{value:s||"__default__",onValueChange:y=>i(y==="__default__"?null:y),children:[f.jsx(uf,{children:f.jsx(cf,{placeholder:"Use conversation's current model"})}),f.jsxs(df,{children:[f.jsx(Ba,{value:"__default__",children:"Use conversation's current model"}),u.map(y=>f.jsxs(Ba,{value:y.id,children:[y.name," (",y.providerName,")"]},y.id))]})]}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Leave empty to use the same model as the current conversation. Select a specific model to always use that model for compact summaries."})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:"fork-compact-prompt",children:"Compact Summary Prompt"}),f.jsx(qa,{id:"fork-compact-prompt",value:n,onChange:y=>r(y.target.value),placeholder:"Enter the prompt for generating compact summaries...",className:"min-h-[200px] font-mono text-sm"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"This prompt will be sent to the AI along with the conversation history to generate a compact summary. The summary will become the first assistant message in the new forked conversation."})]}),f.jsxs("div",{className:"flex items-center justify-between pt-4",children:[f.jsxs(ct,{variant:"outline",size:"sm",onClick:h,disabled:e,children:[f.jsx(b1,{className:"mr-2 h-4 w-4"}),"Reset to Default"]}),f.jsx(ct,{onClick:d,disabled:!m||e,children:e?"Saving...":"Save Changes"})]})]})]})})},fYe=()=>{const e=E.useMemo(()=>[{value:"prompt",label:"System Prompt",content:f.jsx(WKe,{})},{value:"parameters",label:"Parameters",content:f.jsx(GKe,{})},{value:"tools",label:"Tools",content:f.jsx(ZKe,{})},{value:"mcp",label:"MCP",content:f.jsx(uYe,{})},{value:"titles",label:"Auto-Titles",content:f.jsx(JKe,{})},{value:"fork-compact",label:"Fork Compact",content:f.jsx(dYe,{})},{value:"prompts",label:"Prompts",content:f.jsx(rYe,{})},{value:"agents",label:"Agents",content:f.jsx(sYe,{})}],[]);return f.jsx("div",{className:"space-y-4 p-1 h-full flex flex-col",children:f.jsx(xl,{tabs:e,defaultValue:"prompt",className:"flex-grow",listClassName:"bg-muted/50 rounded-md",contentContainerClassName:"mt-3",scrollable:!1})})},hYe=Ve.memo(fYe);class pYe{constructor(){ue(this,"id","core-settings-assistant");ue(this,"unregisterCallback",null);ue(this,"modApiRef",null);ue(this,"eventUnsubscribers",[]);ue(this,"isVisible",!1)}async initialize(t){this.modApiRef=t,this.isVisible=pr.getState().enableAdvancedSettings;const n=t.on(an.enableAdvancedSettingsChanged,r=>{typeof r=="object"&&r&&"enabled"in r&&this.isVisible!==r.enabled&&(this.isVisible=r.enabled,this.reregisterTab())});this.eventUnsubscribers.push(n)}reregisterTab(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef&&this.register(this.modApiRef)}register(t){this.modApiRef=t,this.isVisible?this.unregisterCallback||(this.unregisterCallback=t.registerSettingsTab({id:"assistant",title:"Assistant",component:hYe,order:40})):this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null)}destroy(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),this.modApiRef=null,console.log(`[${this.id}] Destroyed.`)}}const mYe=Ke({importSettings:Zn(),importApiKeys:Zn(),importProviderConfigs:Zn(),importProjects:Zn(),importConversations:Zn(),importRulesAndTags:Zn(),importMods:Zn(),importSyncRepos:Zn(),importMcpServers:Zn(),importPromptTemplates:Zn(),importAgents:Zn()}),gYe=Ke({importSettings:Zn(),importApiKeys:Zn(),importProviderConfigs:Zn(),importProjects:Zn(),importConversations:Zn(),importRulesAndTags:Zn(),importMods:Zn(),importSyncRepos:Zn(),importMcpServers:Zn(),importPromptTemplates:Zn(),importAgents:Zn()}),yYe=()=>{const{importConversation:e,exportAllConversations:t}=Vn(yn(N=>({importConversation:N.importConversation,exportAllConversations:N.exportAllConversations}))),n=E.useRef(null),r=E.useRef(null),[s,i]=E.useState(!1),[a,o]=E.useState(!1),[l,c]=E.useState(!1),[u,d]=E.useState(!1),[h,m]=E.useState(!1),y=ii({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0,importMcpServers:!0,importPromptTemplates:!0,importAgents:!0},validators:{onChange:mYe}}),b=ii({defaultValues:{importSettings:!0,importApiKeys:!0,importProviderConfigs:!0,importProjects:!0,importConversations:!0,importRulesAndTags:!0,importMods:!0,importSyncRepos:!0,importMcpServers:!0,importPromptTemplates:!0,importAgents:!0},validators:{onChange:gYe}}),v=()=>{var N;(N=n.current)==null||N.click()},x=()=>{var N;(N=r.current)==null||N.click()},w=E.useCallback(async N=>{var O;const I=(O=N.target.files)==null?void 0:O[0];if(I){i(!0);try{await e(I)}catch(B){console.error("Import failed (from component):",B)}finally{n.current&&(n.current.value=""),i(!1)}}},[e]),S=E.useCallback(async N=>{var O;const I=(O=N.target.files)==null?void 0:O[0];if(I){if(!window.confirm("Importing this file will OVERWRITE existing data for the selected categories. Are you sure you want to proceed?")){r.current&&(r.current.value="");return}m(!0);try{await E0.importFullConfiguration(I,y.state.values)}catch(B){console.error("Full import failed (from component):",B)}finally{r.current&&(r.current.value=""),m(!1)}}},[y]),k=E.useCallback(async()=>{o(!0);try{await t()}catch(N){console.error("Export all failed (from component):",N)}finally{o(!1)}},[t]),C=E.useCallback(async()=>{d(!0);try{await E0.exportFullConfiguration(b.state.values)}catch(N){console.error("Full export failed (from component):",N)}finally{d(!1)}},[b]),T=E.useCallback(async()=>{if(window.confirm(` ARE YOU ABSOLUTELY SURE? 

This will permanently delete ALL conversations, messages, mods, settings, providers, and stored API keys from your browser. This action cannot be undone.`)&&window.confirm(`SECOND CONFIRMATION:

Really delete everything? Consider exporting first.`)){c(!0);try{await bt.clearAllData(),Te.success("All local data cleared. Reloading the application..."),setTimeout(()=>window.location.reload(),1500)}catch(N){const I="Failed to clear all data";console.error(I,N),Te.error(`${I}: ${N instanceof Error?N.message:String(N)}`),c(!1)}}},[]),A=(N,I,O,B,D,H)=>{const P=`${H}-${I}-checkbox`;return f.jsx(N.Field,{name:I,children:K=>f.jsxs("div",{className:"flex items-center space-x-2",children:[f.jsx(zc,{id:P,checked:K.state.value,onCheckedChange:U=>K.handleChange(!!U),disabled:D}),f.jsxs(jt,{htmlFor:P,className:"text-sm font-normal flex items-center gap-1.5",children:[f.jsx(B,{className:"h-4 w-4 text-muted-foreground"})," ",O]})]})},I)};return f.jsxs("div",{className:"space-y-4 p-1",children:[f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium mb-2",children:"Single Conversation"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"border p-3 rounded-md space-y-2",children:[f.jsx(jt,{className:"font-semibold",children:"Import Conversation"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Import a previously exported single conversation (.json file)."}),f.jsx("input",{type:"file",ref:n,onChange:w,accept:".json",className:"hidden",id:"import-file-input",disabled:s}),f.jsxs(ct,{onClick:v,variant:"outline",size:"sm",disabled:s,children:[s?f.jsx(Jn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(NH,{className:"mr-2 h-4 w-4"}),s?"Importing...":"Select File..."]})]}),f.jsxs("div",{className:"border p-3 rounded-md space-y-2",children:[f.jsx(jt,{className:"font-semibold",children:"Export All Conversations"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all conversations and messages into a single JSON file."}),f.jsxs(ct,{onClick:k,variant:"outline",size:"sm",disabled:a,children:[a?f.jsx(Jn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(Tc,{className:"mr-2 h-4 w-4"}),a?"Exporting...":"Export All Chats"]})]})]})]}),f.jsx(Fm,{}),f.jsxs("div",{children:[f.jsx("h3",{className:"text-lg font-medium mb-2",children:"Full Configuration Backup"}),f.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[f.jsxs("div",{className:"border p-3 rounded-md space-y-3",children:[f.jsx(jt,{className:"font-semibold",children:"Import Full Configuration"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Import settings, providers, keys, projects, conversations, etc., from a backup file. Select which data types to restore."}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[A(y,"importSettings","Settings",Rh,h,"import"),A(y,"importApiKeys","API Keys",Zx,h,"import"),A(y,"importProviderConfigs","Providers",ry,h,"import"),A(y,"importProjects","Projects",AB,h,"import"),A(y,"importConversations","Conversations",rj,h,"import"),A(y,"importRulesAndTags","Rules & Tags",sj,h,"import"),A(y,"importMods","Mods",MB,h,"import"),A(y,"importSyncRepos","Sync Repos",jc,h,"import"),A(y,"importMcpServers","MCP Servers",NB,h,"import"),A(y,"importPromptTemplates","Prompt Templates",nj,h,"import"),A(y,"importAgents","Agents",ty,h,"import")]}),f.jsx("input",{type:"file",ref:r,onChange:S,accept:".json",className:"hidden",id:"full-import-file-input",disabled:h}),f.jsxs(ct,{onClick:x,variant:"outline",size:"sm",disabled:h,children:[h?f.jsx(Jn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(Ame,{className:"mr-2 h-4 w-4"}),h?"Importing...":"Select Backup File..."]})]}),f.jsxs("div",{className:"border p-3 rounded-md space-y-3",children:[f.jsx(jt,{className:"font-semibold",children:"Export Full Configuration"}),f.jsx("p",{className:"text-xs text-muted-foreground",children:"Export all settings, providers, keys, projects, conversations, rules, tags, mods, etc., into a single backup file. Select which data types to include."}),f.jsxs("div",{className:"grid grid-cols-2 gap-x-4 gap-y-2 pt-2",children:[A(b,"importSettings","Settings",Rh,u,"export"),A(b,"importApiKeys","API Keys",Zx,u,"export"),A(b,"importProviderConfigs","Providers",ry,u,"export"),A(b,"importProjects","Projects",AB,u,"export"),A(b,"importConversations","Conversations",rj,u,"export"),A(b,"importRulesAndTags","Rules & Tags",sj,u,"export"),A(b,"importMods","Mods",MB,u,"export"),A(b,"importSyncRepos","Sync Repos",jc,u,"export"),A(b,"importMcpServers","MCP Servers",NB,u,"export"),A(b,"importPromptTemplates","Prompt Templates",nj,u,"export"),A(b,"importAgents","Agents",ty,u,"export")]}),f.jsxs(ct,{onClick:C,variant:"secondary",size:"sm",disabled:u,children:[u?f.jsx(Jn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(wme,{className:"mr-2 h-4 w-4"}),u?"Exporting...":"Export Configuration"]})]})]})]}),f.jsxs("div",{className:"border-t pt-6 border-destructive/50",children:[f.jsx("h3",{className:"text-lg font-medium text-destructive mb-2",children:"Danger Zone"}),f.jsx("p",{className:"text-sm text-destructive/90 mb-3",children:"Be very careful with these actions. Data loss may be permanent."}),f.jsxs(ct,{onClick:T,variant:"destructive",disabled:l,children:[l?f.jsx(Jn,{className:"mr-2 h-4 w-4 animate-spin"}):f.jsx(Po,{className:"mr-2 h-4 w-4"}),l?"Clearing Data...":"Clear All Local Data (Conversations, Keys, Settings, etc.)"]})]})]})},bYe=Ve.memo(yYe);class vYe{constructor(){ue(this,"id","core-settings-data");ue(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"data",title:"Data",component:bYe,order:70})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const xYe=()=>{const{loadedMods:e,addDbMod:t,updateDbMod:n,deleteDbMod:r,dbMods:s,isLoading:i}=Wh(yn(T=>({loadedMods:T.loadedMods,addDbMod:T.addDbMod,updateDbMod:T.updateDbMod,deleteDbMod:T.deleteDbMod,dbMods:T.dbMods,isLoading:T.isLoading}))),[a,o]=E.useState(""),[l,c]=E.useState(""),[u,d]=E.useState(""),[h,m]=E.useState(!1),[y,b]=E.useState({}),[v,x]=E.useState({}),w=E.useCallback(async()=>{if(!a.trim()){Te.error("Mod name cannot be empty.");return}if(!l.trim()&&!u.trim()){Te.error("Either Mod URL or Script Content must be provided.");return}if(l.trim()&&u.trim()){Te.error("Provide either a Mod URL or Script Content, not both.");return}m(!0);try{const T={name:a.trim(),sourceUrl:l.trim()||null,scriptContent:u.trim()||null,enabled:!0,loadOrder:((s==null?void 0:s.length)??1)*10};await t(T),o(""),c(""),d(""),Te.info("Mod added. Reload required for changes to take effect.")}catch(T){console.error("Failed to add mod (from component):",T)}finally{m(!1)}},[a,l,u,t,s==null?void 0:s.length]),S=E.useCallback(async T=>{b(A=>({...A,[T.id]:!0}));try{await n(T.id,{enabled:!T.enabled}),Te.info(`Mod "${T.name}" ${T.enabled?"disabled":"enabled"}. Reload required for changes to take effect.`)}catch(A){console.error("Failed to update mod (from component):",A)}finally{b(A=>({...A,[T.id]:!1}))}},[n]),k=E.useCallback(async T=>{if(window.confirm(`Are you sure you want to delete the mod "${T.name}"? This cannot be undone.`)){x(A=>({...A,[T.id]:!0}));try{await r(T.id),Te.info("Mod deleted. Reload required for changes to take effect.")}catch(A){console.error("Failed to delete mod (from component):",A)}finally{x(A=>({...A,[T.id]:!1}))}}},[r]),C=E.useCallback(T=>{const A=e.find(I=>I.id===T);if(A)if(A.error){const I=A.error instanceof Error?A.error.message:String(A.error);return{status:"Error",error:A.error,tooltip:I}}else return{status:"Loaded"};const N=(s||[]).find(I=>I.id===T);return N?N.enabled?{status:"Load Pending (Reload Required)"}:{status:"Disabled"}:{status:"Unknown"}},[e,s]);return f.jsxs("div",{className:"space-y-6 p-1",children:[f.jsxs(Mse,{variant:"destructive",className:"border-destructive/50",children:[f.jsx(ZP,{className:"h-4 w-4"}),f.jsx(Ise,{children:"Security Warning"}),f.jsx(jse,{children:"Running mods from untrusted sources can compromise your security and privacy. Mods execute arbitrary JavaScript code within LiteChat and can potentially access sensitive data like API keys stored in the browser or interact with external services. Only install mods you trust. LiteChat is not responsible for any damage caused by mods."})]}),f.jsxs("div",{className:"space-y-4 rounded-md border p-4",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Add New Mod"}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:"mod-name",children:"Mod Name"}),f.jsx(xn,{id:"mod-name",value:a,onChange:T=>o(T.target.value),placeholder:"My Awesome Mod",disabled:h})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:"mod-url",children:"Source URL (Optional)"}),f.jsx(xn,{id:"mod-url",type:"url",value:l,onChange:T=>c(T.target.value),placeholder:"https://example.com/my-mod.js",disabled:h||!!u.trim()})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx(jt,{htmlFor:"mod-script",children:"Script Content (Optional)"}),f.jsx(qa,{id:"mod-script",value:u,onChange:T=>d(T.target.value),placeholder:`/* Paste your mod script here */
// Example: modApi.log('log', 'My Mod Loaded!');`,className:"min-h-[100px] font-mono text-xs",disabled:h||!!l.trim()})]}),f.jsxs(ct,{onClick:w,disabled:h,children:[h&&f.jsx(Jn,{className:"mr-2 h-4 w-4 animate-spin"}),h?"Adding...":"Add Mod"]})]}),f.jsxs("div",{className:"space-y-2",children:[f.jsx("h3",{className:"text-lg font-medium",children:"Installed Mods"}),f.jsx("p",{className:"text-sm text-muted-foreground",children:"Enable or disable mods below. A page reload is required for changes to fully take effect."}),f.jsx("div",{className:"rounded-md border",children:f.jsx(wr,{delayDuration:100,children:f.jsxs(yf,{children:[f.jsx(gp,{children:f.jsxs(Ts,{children:[f.jsx(Rr,{children:"Name"}),f.jsx(Rr,{children:"Source"}),f.jsx(Rr,{children:"Status"}),f.jsx(Rr,{className:"text-center",children:"Enabled"}),f.jsx(Rr,{className:"text-right",children:"Actions"})]})}),f.jsx(bf,{children:i?f.jsxs(f.Fragment,{children:[f.jsx(Ts,{children:f.jsx(Ln,{colSpan:5,children:f.jsx(Gr,{className:"h-10 w-full"})})}),f.jsx(Ts,{children:f.jsx(Ln,{colSpan:5,children:f.jsx(Gr,{className:"h-10 w-full"})})})]}):(s||[]).length===0?f.jsx(Ts,{children:f.jsx(Ln,{colSpan:5,className:"h-24 text-center",children:"No mods installed yet."})}):(s||[]).map(T=>{const{status:A,error:N,tooltip:I}=C(T.id),O=T.sourceUrl?new URL(T.sourceUrl).hostname:"Direct Script",B=y[T.id],D=v[T.id],H=B||D,P=A==="Error";return f.jsxs(Ts,{children:[f.jsx(Ln,{className:"font-medium",children:T.name}),f.jsx(Ln,{className:"text-muted-foreground",children:O}),f.jsxs(Ln,{children:[f.jsxs(_r,{children:[f.jsx(Sr,{asChild:!0,children:f.jsx("span",{className:P?"text-destructive font-semibold cursor-help":"",children:A})}),I&&f.jsx(Cr,{className:"max-w-xs break-words",children:f.jsx("p",{children:I})})]}),P&&N&&f.jsx("p",{className:"text-xs text-destructive truncate",children:N instanceof Error?N.message:String(N)})]}),f.jsxs(Ln,{className:"text-center",children:[f.jsx(oo,{checked:T.enabled??!1,onCheckedChange:()=>S(T),disabled:H,"aria-label":`Enable ${T.name}`}),B&&f.jsx(Jn,{className:"h-4 w-4 animate-spin inline-block ml-2"})]}),f.jsx(Ln,{className:"text-right",children:f.jsx(ct,{variant:"ghost",size:"icon",onClick:()=>k(T),disabled:H,"aria-label":`Delete ${T.name}`,className:"text-destructive hover:text-destructive/80",children:D?f.jsx(Jn,{className:"h-4 w-4 animate-spin"}):f.jsx(Po,{className:"h-4 w-4"})})})]},T.id)})})]})})})]})]})},wYe=Ve.memo(xYe);class _Ye{constructor(){ue(this,"id","core-settings-mods");ue(this,"unregisterCallback",null)}async initialize(t){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}this.unregisterCallback=t.registerSettingsTab({id:"mods",title:"Mods",component:wYe,order:80})}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=null),console.log(`[${this.id}] Destroyed.`)}}const SYe=({interactionId:e,contentToCopy:t,disabled:n})=>{const[r]=E.useState(!1),s=E.useCallback(async i=>{if(i.stopPropagation(),n||!t){Te.info("No content to copy or action disabled.");return}Re.emit(zi.copyInteractionResponseRequest,{interactionId:e})},[e,t,n]);return f.jsx(qn,{tooltipText:"Copy",onClick:s,"aria-label":"Copy content",disabled:n||!t,icon:r?f.jsx(co,{className:"text-green-500"}):f.jsx(wE,{}),className:"h-5 w-5"})};class CYe{constructor(){ue(this,"id","core-canvas-copy-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>n.interactionId?Ve.createElement(SYe,{interactionId:n.interactionId,contentToCopy:n.responseContent??"",disabled:!n.responseContent||n.responseContent.trim()===""}):(console.warn("CopyActionControlModule: interactionId is missing in context for an interaction control."),null)})}destroy(t){}}const kYe=({interactionId:e,disabled:t})=>{const n=r=>{if(r.stopPropagation(),t){Te.info("Regeneration is currently disabled.");return}Re.emit(zi.regenerateInteractionRequest,{interactionId:e})};return f.jsx(qn,{tooltipText:"Regenerate",onClick:n,"aria-label":"Regenerate Response",disabled:t,icon:f.jsx(_m,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class EYe{constructor(){ue(this,"id","core-canvas-regenerate-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=un.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null,l=(o==null?void 0:o.id)===r.id,c=l&&(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return l?Ve.createElement(kYe,{interactionId:r.id,disabled:!c}):null}})}destroy(t){}}const TYe=({module:e,interactionId:t,disabled:n})=>{const[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=l=>{if(!l){s(!1);return}s(!1),Re.emit(zi.regenerateInteractionWithModelRequest,{interactionId:t,modelId:l})},o=l=>{if(l.stopPropagation(),n){Te.info("Regeneration is currently disabled.");return}s(!r)};return r?f.jsx("div",{className:"relative",children:f.jsx(ag,{models:e.globallyEnabledModels,value:null,onChange:a,isLoading:e.isLoadingProviders})}):f.jsx(qn,{tooltipText:"Regenerate with Model",onClick:o,"aria-label":"Regenerate Response with Model Selection",disabled:n,icon:f.jsx(sge,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class AYe{constructor(){ue(this,"id","core-canvas-regenerate-with-model-action");ue(this,"eventUnsubscribers",[]);ue(this,"notifyComponentUpdate",null);ue(this,"globallyEnabledModels",[]);ue(this,"isLoadingProviders",!0)}async initialize(t){const n=Qn.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on(Wn.globallyEnabledModelsUpdated,a=>{var c;let o=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(a.models)&&(this.globallyEnabledModels=a.models,o=!0);const l=Qn.getState().isLoading;this.isLoadingProviders!==l&&(this.isLoadingProviders=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),s=t.on(Wn.initialDataLoaded,()=>{var c;const a=Qn.getState();let o=!1;this.isLoadingProviders!==a.isLoading&&(this.isLoadingProviders=a.isLoading,o=!0);const l=a.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(l)&&(this.globallyEnabledModels=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(En.statusChanged,()=>{var a;(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(r,s,i)}setNotifyCallback(t){this.notifyComponentUpdate=t}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=un.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null,l=(o==null?void 0:o.id)===r.id,c=l&&(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return l?Ve.createElement(TYe,{module:this,interactionId:r.id,disabled:!c}):null}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null}async destroy(){await this.cleanup()}}const RYe=({interactionId:e,disabled:t})=>{const n=r=>{if(r.stopPropagation(),t){Te.info("Fork is currently disabled.");return}Re.emit(zi.forkConversationRequest,{interactionId:e})};return f.jsx(qn,{tooltipText:"Fork",onClick:n,"aria-label":"Fork Conversation",disabled:t,icon:f.jsx(EH,{}),className:"h-5 w-5 md:h-6 md:w-6"})};class NYe{constructor(){ue(this,"id","core-canvas-fork-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=un.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null;if((o==null?void 0:o.id)===r.id)return null;const c=(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return Ve.createElement(RYe,{interactionId:r.id,disabled:!c})}})}destroy(t){}}const MYe=({module:e,interactionId:t,disabled:n})=>{const[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=l=>{if(!l){s(!1);return}s(!1),Re.emit(zi.forkConversationWithModelRequest,{interactionId:t,modelId:l})},o=l=>{if(l.stopPropagation(),n){Te.info("Fork is currently disabled.");return}s(!r)};return r?f.jsx("div",{className:"relative",children:f.jsx(ag,{models:e.globallyEnabledModels,value:null,onChange:a,isLoading:e.isLoadingProviders})}):f.jsx(qn,{tooltipText:"Fork with",onClick:o,"aria-label":"Fork Conversation with Model Selection",disabled:n,icon:f.jsxs("div",{className:"relative",children:[f.jsx(EH,{className:"h-4 w-4"}),f.jsx(Pc,{className:"absolute -top-1 -right-1 h-2 w-2"})]}),className:"h-5 w-5 md:h-6 md:w-6"})};class IYe{constructor(){ue(this,"id","core-canvas-fork-with-model-action");ue(this,"eventUnsubscribers",[]);ue(this,"notifyComponentUpdate",null);ue(this,"globallyEnabledModels",[]);ue(this,"isLoadingProviders",!0)}async initialize(t){const n=Qn.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on(Wn.globallyEnabledModelsUpdated,a=>{var c;let o=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(a.models)&&(this.globallyEnabledModels=a.models,o=!0);const l=Qn.getState().isLoading;this.isLoadingProviders!==l&&(this.isLoadingProviders=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),s=t.on(Wn.initialDataLoaded,()=>{var c;const a=Qn.getState();let o=!1;this.isLoadingProviders!==a.isLoading&&(this.isLoadingProviders=a.isLoading,o=!0);const l=a.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(l)&&(this.globallyEnabledModels=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(En.statusChanged,()=>{var a;(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(r,s,i)}setNotifyCallback(t){this.notifyComponentUpdate=t}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,s=un.getState(),i=s.status,a=s.interactions.filter(u=>u.conversationId===r.conversationId&&u.parentId===null&&(u.type==="message.user_assistant"||u.type==="message.assistant_regen"));a.sort((u,d)=>u.index-d.index);const o=a.length>0?a[a.length-1]:null;if((o==null?void 0:o.id)===r.id)return null;const c=(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return Ve.createElement(MYe,{module:this,interactionId:r.id,disabled:!c})}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null}async destroy(){await this.cleanup()}}const jYe=({module:e,interactionId:t,disabled:n})=>{const[r,s]=E.useState(!1),[,i]=E.useState({});E.useEffect(()=>{if(e)return e.setNotifyCallback(()=>i({})),()=>e.setNotifyCallback(null)},[e]);const a=l=>{if(!l){s(!1);return}s(!1),Re.emit(zi.forkConversationCompactRequest,{interactionId:t,modelId:l})},o=l=>{if(l.stopPropagation(),n){Te.info("Fork compact is currently disabled.");return}s(!r)};return r?f.jsx("div",{className:"relative",children:f.jsx(ag,{models:e.globallyEnabledModels,value:null,onChange:a,isLoading:e.isLoadingProviders})}):f.jsx(qn,{tooltipText:"Summarize",onClick:o,"aria-label":"Fork Conversation with Compact Summary",disabled:n,icon:f.jsx(kpe,{className:"h-4 w-4"}),className:"h-5 w-5 md:h-6 md:w-6"})};class PYe{constructor(){ue(this,"id","core-canvas-fork-compact-action");ue(this,"eventUnsubscribers",[]);ue(this,"notifyComponentUpdate",null);ue(this,"globallyEnabledModels",[]);ue(this,"isLoadingProviders",!0)}async initialize(t){const n=Qn.getState();this.isLoadingProviders=n.isLoading,this.globallyEnabledModels=n.getGloballyEnabledModelDefinitions();const r=t.on(Wn.globallyEnabledModelsUpdated,a=>{var c;let o=!1;JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(a.models)&&(this.globallyEnabledModels=a.models,o=!0);const l=Qn.getState().isLoading;this.isLoadingProviders!==l&&(this.isLoadingProviders=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),s=t.on(Wn.initialDataLoaded,()=>{var c;const a=Qn.getState();let o=!1;this.isLoadingProviders!==a.isLoading&&(this.isLoadingProviders=a.isLoading,o=!0);const l=a.getGloballyEnabledModelDefinitions();JSON.stringify(this.globallyEnabledModels)!==JSON.stringify(l)&&(this.globallyEnabledModels=l,o=!0),o&&((c=this.notifyComponentUpdate)==null||c.call(this))}),i=t.on(En.statusChanged,()=>{var a;(a=this.notifyComponentUpdate)==null||a.call(this)});this.eventUnsubscribers.push(r,s,i)}setNotifyCallback(t){this.notifyComponentUpdate=t}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,i=un.getState().status,a=(r.status==="COMPLETED"||r.status==="ERROR")&&i!=="streaming";return Ve.createElement(jYe,{module:this,interactionId:r.id,disabled:!a})}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[],this.notifyComponentUpdate=null}async destroy(){await this.cleanup()}}const OYe=({interactionId:e,currentRating:t})=>{const[n,r]=E.useState(!1),s=c=>{const u=c===t?null:c;Re.emit(En.rateInteractionRequest,{interactionId:e,rating:u}),r(!1)},i=Array.from({length:11},(c,u)=>u-5);let a="text-muted-foreground",o="",l="hover:text-foreground";return t!=null&&(t<0?(a="text-red-500",o="fill-red-500"):t===0?(a="text-gray-500",o="fill-gray-500"):(a="text-green-500",o="fill-green-500")),f.jsxs(ic,{open:n,onOpenChange:r,children:[f.jsx(ac,{asChild:!0,children:f.jsx(qn,{tooltipText:t!=null?`Rating: ${t}`:"Rate response",onClick:()=>r(!n),"aria-label":"Rate response",icon:f.jsx(PB,{className:Ze(o,t!=null?"fill-current":"fill-none")}),variant:"ghost",className:Ze("h-4 w-4 md:h-5 md:w-5 p-0",a,l)})}),f.jsx(oc,{className:"w-80 p-4",align:"start",children:f.jsxs("div",{className:"space-y-3",children:[f.jsx("div",{className:"text-sm font-medium",children:"Rate this response"}),f.jsx("div",{className:"grid grid-cols-11 gap-1",children:i.map(c=>{let u="";c===-5?u="Terrible":c===-4?u="Very Bad":c===-3?u="Bad":c===-2?u="Poor":c===-1?u="Below Average":c===0?u="Neutral":c===1?u="Above Average":c===2?u="Good":c===3?u="Very Good":c===4?u="Excellent":c===5&&(u="Perfect");let d="text-muted-foreground",h="hover:text-foreground",m="";c<0?(h="hover:text-red-500",t===c&&(d="text-red-500",m="fill-red-500")):c===0?(h="hover:text-gray-500",t===c&&(d="text-gray-500",m="fill-gray-500")):(h="hover:text-green-500",t===c&&(d="text-green-500",m="fill-green-500"));const y=t===c?"bg-muted":"";return f.jsx(qn,{tooltipText:`${c}: ${u}`,onClick:()=>s(c),"aria-label":`Rate response as ${u} (${c})`,icon:f.jsx(PB,{className:Ze(m,t===c?"fill-current":"fill-none")}),variant:"ghost",className:Ze("h-6 w-6 p-0",d,h,y)},c)})}),f.jsxs("div",{className:"flex justify-between text-xs text-muted-foreground",children:[f.jsx("span",{children:"-5 (Terrible)"}),f.jsx("span",{children:"0 (Neutral)"}),f.jsx("span",{children:"+5 (Perfect)"})]}),t!=null&&f.jsx("div",{className:"pt-2 border-t",children:f.jsx("button",{onClick:()=>s(null),className:"text-xs text-muted-foreground hover:text-foreground",children:"Clear rating"})})]})})]})};class DYe{constructor(){ue(this,"id","core-canvas-rating-action")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>!n.interactionId||!n.interaction?null:Ve.createElement(OYe,{interactionId:n.interactionId,currentRating:n.interaction.rating})})}destroy(t){}}const FYe=({interactionId:e,response:t,disabled:n})=>{const[r,s]=E.useState(!1),[i,a]=E.useState(""),o=u=>{if(u.stopPropagation(),n){Te.info("Response editing is currently disabled.");return}a(t||""),s(!0)},l=()=>{if(i.trim()===""){Te.error("Response cannot be empty");return}Re.emit(zi.editResponseRequest,{interactionId:e,newContent:i.trim()}),s(!1),Te.success("Response edited successfully")},c=()=>{s(!1),a("")};return f.jsxs(f.Fragment,{children:[f.jsx(qn,{tooltipText:"Edit Response",onClick:o,"aria-label":"Edit Assistant Response",disabled:n,icon:f.jsx(YP,{}),className:"h-5 max-w-7xl md:h-6 md:max-w-6xl"}),f.jsx(hf,{open:r,onOpenChange:s,children:f.jsxs(pf,{className:"!w-[80vw] !h-[85vh] !max-w-none flex flex-col",children:[f.jsx(mf,{children:f.jsx(gf,{children:"Edit Assistant Response"})}),f.jsx("div",{className:"flex-1 space-y-4 overflow-hidden",children:f.jsxs("div",{className:"space-y-2 h-full",children:[f.jsx(jt,{htmlFor:"response-edit",children:"Response Content"}),f.jsx(qa,{id:"response-edit",value:i,onChange:u=>a(u.target.value),placeholder:"Edit the assistant's response...",className:"min-h-[60vh] h-full resize-none text-sm leading-relaxed"})]})}),f.jsxs(xb,{className:"flex-shrink-0",children:[f.jsx(ct,{variant:"outline",onClick:c,children:"Cancel"}),f.jsx(ct,{onClick:l,children:"Save Changes"})]})]})})]})};class LYe{constructor(){ue(this,"id","core-canvas-edit-response-action");ue(this,"eventUnsubscribers",[])}async initialize(t){const n=t.on(zi.editResponseRequest,async r=>{await this.handleResponseEdit(r.interactionId,r.newContent)});this.eventUnsubscribers.push(n)}async handleResponseEdit(t,n){var r;try{const s=un.getState(),i=s.interactions.find(y=>y.id===t);if(!i)throw new Error("Original interaction not found");if(i.status!=="COMPLETED")throw new Error("Can only edit completed interactions");const a=qr(),o={...i,id:a,response:n,parentId:null,index:i.index,metadata:{...i.metadata,editedResponse:!0,editedFromId:i.id},endedAt:new Date};s._addInteractionToState(o);const l=s.interactions.filter(y=>y.parentId===i.id),c=[];let u=i;for(;u;){c.push(u);const y=(r=u.metadata)==null?void 0:r.editedFromId;y?u=s.interactions.find(b=>b.id===y):u=void 0}const d=c.sort((y,b)=>{var w,S;const v=((w=y.startedAt)==null?void 0:w.getTime())??0,x=((S=b.startedAt)==null?void 0:S.getTime())??0;return v-x}),h=d.map(async(y,b)=>{const v={parentId:a,index:b,metadata:{...y.metadata,originalVersion:b===0}};return console.log(`[EditResponseControlModule] Updating version ${y.id} to be child of ${a} with childIndex ${b}`),s._updateInteractionInState(y.id,v),bt.saveInteraction({...y,...v})}),m=l.map(async y=>{const b={parentId:a,index:d.length+y.index};return s._updateInteractionInState(y.id,b),bt.saveInteraction({...y,...b})});await Promise.all([bt.saveInteraction(o),...h,...m]),console.log(`[EditResponseControlModule] Response edited successfully. Original: ${t}, Edited: ${a}`)}catch(s){throw console.error("[EditResponseControlModule] Failed to edit response:",s),s}}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"actions",renderer:n=>{if(!n.interactionId||!n.interaction)return null;const r=n.interaction,i=un.getState().status,a=r.status==="COMPLETED"&&r.response&&typeof r.response=="string"&&i!=="streaming"&&(r.type==="message.user_assistant"||r.type==="message.assistant_regen");return a?Ve.createElement(FYe,{interactionId:r.id,response:r.response,disabled:!a}):null}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[]}async destroy(){await this.cleanup()}}var Co={},cV;function BYe(){if(cV)return Co;cV=1;var e=Co&&Co.__assign||function(){return e=Object.assign||function(C){for(var T,A=1,N=arguments.length;A<N;A++){T=arguments[A];for(var I in T)Object.prototype.hasOwnProperty.call(T,I)&&(C[I]=T[I])}return C},e.apply(this,arguments)},t=Co&&Co.__createBinding||(Object.create?function(C,T,A,N){N===void 0&&(N=A);var I=Object.getOwnPropertyDescriptor(T,A);(!I||("get"in I?!T.__esModule:I.writable||I.configurable))&&(I={enumerable:!0,get:function(){return T[A]}}),Object.defineProperty(C,N,I)}:function(C,T,A,N){N===void 0&&(N=A),C[N]=T[A]}),n=Co&&Co.__setModuleDefault||(Object.create?function(C,T){Object.defineProperty(C,"default",{enumerable:!0,value:T})}:function(C,T){C.default=T}),r=Co&&Co.__importStar||function(C){if(C&&C.__esModule)return C;var T={};if(C!=null)for(var A in C)A!=="default"&&Object.prototype.hasOwnProperty.call(C,A)&&t(T,C,A);return n(T,C),T},s=Co&&Co.__rest||function(C,T){var A={};for(var N in C)Object.prototype.hasOwnProperty.call(C,N)&&T.indexOf(N)<0&&(A[N]=C[N]);if(C!=null&&typeof Object.getOwnPropertySymbols=="function")for(var I=0,N=Object.getOwnPropertySymbols(C);I<N.length;I++)T.indexOf(N[I])<0&&Object.prototype.propertyIsEnumerable.call(C,N[I])&&(A[N[I]]=C[N[I]]);return A};Object.defineProperty(Co,"__esModule",{value:!0});var i=r(qy()),a=89,o=90,l=77,c=57,u=219,d=222,h=192,m=100,y=3e3,b=typeof window<"u"&&"navigator"in window&&/Win/i.test(navigator.platform),v=typeof window<"u"&&"navigator"in window&&/(Mac|iPhone|iPod|iPad)/i.test(navigator.platform),x="npm__react-simple-code-editor__textarea",w=`
/**
 * Reset the text fill color so that placeholder is visible
 */
.`.concat(x,`:empty {
  -webkit-text-fill-color: inherit !important;
}

/**
 * Hack to apply on some CSS on IE10 and IE11
 */
@media all and (-ms-high-contrast: none), (-ms-high-contrast: active) {
  /**
    * IE doesn't support '-webkit-text-fill-color'
    * So we use 'color: transparent' to make the text transparent on IE
    * Unlike other browsers, it doesn't affect caret color in IE
    */
  .`).concat(x,` {
    color: transparent !important;
  }

  .`).concat(x,`::selection {
    background-color: #accef7 !important;
    color: transparent !important;
  }
}
`),S=i.forwardRef(function(T,A){var N=T.autoFocus,I=T.disabled,O=T.form,B=T.highlight,D=T.ignoreTabKey,H=D===void 0?!1:D,P=T.insertSpaces,K=P===void 0?!0:P,U=T.maxLength,V=T.minLength,L=T.name,te=T.onBlur,W=T.onClick,Q=T.onFocus,ee=T.onKeyDown,re=T.onKeyUp,pe=T.onValueChange,de=T.padding,Oe=de===void 0?0:de,Fe=T.placeholder,Se=T.preClassName,Ce=T.readOnly,qe=T.required,Qe=T.style,We=T.tabSize,je=We===void 0?2:We,Y=T.textareaClassName,ye=T.textareaId,Ie=T.value,ce=s(T,["autoFocus","disabled","form","highlight","ignoreTabKey","insertSpaces","maxLength","minLength","name","onBlur","onClick","onFocus","onKeyDown","onKeyUp","onValueChange","padding","placeholder","preClassName","readOnly","required","style","tabSize","textareaClassName","textareaId","value"]),oe=i.useRef({stack:[],offset:-1}),se=i.useRef(null),Me=i.useState(!0),Be=Me[0],Ae=Me[1],lt={paddingTop:typeof Oe=="object"?Oe.top:Oe,paddingRight:typeof Oe=="object"?Oe.right:Oe,paddingBottom:typeof Oe=="object"?Oe.bottom:Oe,paddingLeft:typeof Oe=="object"?Oe.left:Oe},Tt=B(Ie),dt=function(ke,ge){return ke.substring(0,ge).split(`
`)},Pt=i.useCallback(function(ke,ge){var Ee,le,ft;ge===void 0&&(ge=!1);var et=oe.current,$=et.stack,Ue=et.offset;if($.length&&Ue>-1){oe.current.stack=$.slice(0,Ue+1);var tt=oe.current.stack.length;if(tt>m){var ve=tt-m;oe.current.stack=$.slice(ve,tt),oe.current.offset=Math.max(oe.current.offset-ve,0)}}var _e=Date.now();if(ge){var ze=oe.current.stack[oe.current.offset];if(ze&&_e-ze.timestamp<y){var Ct=/[^a-z0-9]([a-z0-9]+)$/i,fe=(Ee=dt(ze.value,ze.selectionStart).pop())===null||Ee===void 0?void 0:Ee.match(Ct),Z=(le=dt(ke.value,ke.selectionStart).pop())===null||le===void 0?void 0:le.match(Ct);if(fe!=null&&fe[1]&&(!((ft=Z==null?void 0:Z[1])===null||ft===void 0)&&ft.startsWith(fe[1]))){oe.current.stack[oe.current.offset]=e(e({},ke),{timestamp:_e});return}}}oe.current.stack.push(e(e({},ke),{timestamp:_e})),oe.current.offset++},[]),qt=i.useCallback(function(){var ke=se.current;if(ke){var ge=ke.value,Ee=ke.selectionStart,le=ke.selectionEnd;Pt({value:ge,selectionStart:Ee,selectionEnd:le})}},[Pt]),Ft=function(ke){var ge=se.current;ge&&(ge.value=ke.value,ge.selectionStart=ke.selectionStart,ge.selectionEnd=ke.selectionEnd,pe==null||pe(ke.value))},Ht=function(ke){var ge=se.current,Ee=oe.current.stack[oe.current.offset];Ee&&ge&&(oe.current.stack[oe.current.offset]=e(e({},Ee),{selectionStart:ge.selectionStart,selectionEnd:ge.selectionEnd})),Pt(ke),Ft(ke)},we=function(){var ke=oe.current,ge=ke.stack,Ee=ke.offset,le=ge[Ee-1];le&&(Ft(le),oe.current.offset=Math.max(Ee-1,0))},F=function(){var ke=oe.current,ge=ke.stack,Ee=ke.offset,le=ge[Ee+1];le&&(Ft(le),oe.current.offset=Math.min(Ee+1,ge.length-1))},X=function(ke){if(!(ee&&(ee(ke),ke.defaultPrevented))){ke.key==="Escape"&&ke.currentTarget.blur();var ge=ke.currentTarget,Ee=ge.value,le=ge.selectionStart,ft=ge.selectionEnd,et=(K?" ":"	").repeat(je);if(ke.key==="Tab"&&!H&&Be)if(ke.preventDefault(),ke.shiftKey){var $=dt(Ee,le),Ue=$.length-1,tt=dt(Ee,ft).length-1,ve=Ee.split(`
`).map(function(wt,Qt){return Qt>=Ue&&Qt<=tt&&wt.startsWith(et)?wt.substring(et.length):wt}).join(`
`);if(Ee!==ve){var _e=$[Ue];Ht({value:ve,selectionStart:_e!=null&&_e.startsWith(et)?le-et.length:le,selectionEnd:ft-(Ee.length-ve.length)})}}else if(le!==ft){var $=dt(Ee,le),ze=$.length-1,Ct=dt(Ee,ft).length-1,_e=$[ze];Ht({value:Ee.split(`
`).map(function(On,Zt){return Zt>=ze&&Zt<=Ct?et+On:On}).join(`
`),selectionStart:_e&&/\S/.test(_e)?le+et.length:le,selectionEnd:ft+et.length*(Ct-ze+1)})}else{var fe=le+et.length;Ht({value:Ee.substring(0,le)+et+Ee.substring(ft),selectionStart:fe,selectionEnd:fe})}else if(ke.key==="Backspace"){var Z=le!==ft,G=Ee.substring(0,le);if(G.endsWith(et)&&!Z){ke.preventDefault();var fe=le-et.length;Ht({value:Ee.substring(0,le-et.length)+Ee.substring(ft),selectionStart:fe,selectionEnd:fe})}}else if(ke.key==="Enter"){if(le===ft){var J=dt(Ee,le).pop(),xe=J==null?void 0:J.match(/^\s+/);if(xe!=null&&xe[0]){ke.preventDefault();var De=`
`+xe[0],fe=le+De.length;Ht({value:Ee.substring(0,le)+De+Ee.substring(ft),selectionStart:fe,selectionEnd:fe})}}}else if(ke.keyCode===c||ke.keyCode===u||ke.keyCode===d||ke.keyCode===h){var He=void 0;ke.keyCode===c&&ke.shiftKey?He=["(",")"]:ke.keyCode===u?ke.shiftKey?He=["{","}"]:He=["[","]"]:ke.keyCode===d?ke.shiftKey?He=['"','"']:He=["'","'"]:ke.keyCode===h&&!ke.shiftKey&&(He=["`","`"]),le!==ft&&He&&(ke.preventDefault(),Ht({value:Ee.substring(0,le)+He[0]+Ee.substring(le,ft)+He[1]+Ee.substring(ft),selectionStart:le,selectionEnd:ft+2}))}else(v?ke.metaKey&&ke.keyCode===o:ke.ctrlKey&&ke.keyCode===o)&&!ke.shiftKey&&!ke.altKey?(ke.preventDefault(),we()):(v?ke.metaKey&&ke.keyCode===o&&ke.shiftKey:b?ke.ctrlKey&&ke.keyCode===a:ke.ctrlKey&&ke.keyCode===o&&ke.shiftKey)&&!ke.altKey?(ke.preventDefault(),F()):ke.keyCode===l&&ke.ctrlKey&&(!v||ke.shiftKey)&&(ke.preventDefault(),Ae(function(wt){return!wt}))}},be=function(ke){var ge=ke.currentTarget,Ee=ge.value,le=ge.selectionStart,ft=ge.selectionEnd;Pt({value:Ee,selectionStart:le,selectionEnd:ft},!0),pe(Ee)};return i.useEffect(function(){qt()},[qt]),i.useImperativeHandle(A,function(){return{get session(){return{history:oe.current}},set session(ke){oe.current=ke.history}}},[]),i.createElement("div",e({},ce,{style:e(e({},k.container),Qe)}),i.createElement("pre",e({className:Se,"aria-hidden":"true",style:e(e(e({},k.editor),k.highlight),lt)},typeof Tt=="string"?{dangerouslySetInnerHTML:{__html:Tt+"<br />"}}:{children:Tt})),i.createElement("textarea",{ref:function(ke){return se.current=ke},style:e(e(e({},k.editor),k.textarea),lt),className:x+(Y?" ".concat(Y):""),id:ye,value:Ie,onChange:be,onKeyDown:X,onClick:W,onKeyUp:re,onFocus:Q,onBlur:te,disabled:I,form:O,maxLength:U,minLength:V,name:L,placeholder:Fe,readOnly:Ce,required:qe,autoFocus:N,autoCapitalize:"off",autoComplete:"off",autoCorrect:"off",spellCheck:!1,"data-gramm":!1}),i.createElement("style",{dangerouslySetInnerHTML:{__html:w}}))}),k={container:{position:"relative",textAlign:"left",boxSizing:"border-box",padding:0,overflow:"hidden"},textarea:{position:"absolute",top:0,left:0,height:"100%",width:"100%",resize:"none",color:"inherit",overflow:"hidden",MozOsxFontSmoothing:"grayscale",WebkitFontSmoothing:"antialiased",WebkitTextFillColor:"transparent"},highlight:{position:"relative",pointerEvents:"none"},editor:{margin:0,border:0,background:"none",boxSizing:"inherit",display:"inherit",fontFamily:"inherit",fontSize:"inherit",fontStyle:"inherit",fontVariantLigatures:"inherit",fontWeight:"inherit",letterSpacing:"inherit",lineHeight:"inherit",tabSize:"inherit",textIndent:"inherit",textRendering:"inherit",textTransform:"inherit",whiteSpace:"pre-wrap",wordBreak:"keep-all",overflowWrap:"break-word"}};return Co.default=S,Co}var $Ye=BYe();const zYe=da($Ye);var A3={exports:{}},uV;function UYe(){return uV||(uV=1,function(e){var t=typeof window<"u"?window:typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope?self:{};/**
 * Prism: Lightweight, robust, elegant syntax highlighting
 *
 * @license MIT <https://opensource.org/licenses/MIT>
 * @author Lea Verou <https://lea.verou.me>
 * @namespace
 * @public
 */var n=function(r){var s=/(?:^|\s)lang(?:uage)?-([\w-]+)(?=\s|$)/i,i=0,a={},o={manual:r.Prism&&r.Prism.manual,disableWorkerMessageHandler:r.Prism&&r.Prism.disableWorkerMessageHandler,util:{encode:function w(S){return S instanceof l?new l(S.type,w(S.content),S.alias):Array.isArray(S)?S.map(w):S.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/\u00a0/g," ")},type:function(w){return Object.prototype.toString.call(w).slice(8,-1)},objId:function(w){return w.__id||Object.defineProperty(w,"__id",{value:++i}),w.__id},clone:function w(S,k){k=k||{};var C,T;switch(o.util.type(S)){case"Object":if(T=o.util.objId(S),k[T])return k[T];C={},k[T]=C;for(var A in S)S.hasOwnProperty(A)&&(C[A]=w(S[A],k));return C;case"Array":return T=o.util.objId(S),k[T]?k[T]:(C=[],k[T]=C,S.forEach(function(N,I){C[I]=w(N,k)}),C);default:return S}},getLanguage:function(w){for(;w;){var S=s.exec(w.className);if(S)return S[1].toLowerCase();w=w.parentElement}return"none"},setLanguage:function(w,S){w.className=w.className.replace(RegExp(s,"gi"),""),w.classList.add("language-"+S)},currentScript:function(){if(typeof document>"u")return null;if(document.currentScript&&document.currentScript.tagName==="SCRIPT")return document.currentScript;try{throw new Error}catch(C){var w=(/at [^(\r\n]*\((.*):[^:]+:[^:]+\)$/i.exec(C.stack)||[])[1];if(w){var S=document.getElementsByTagName("script");for(var k in S)if(S[k].src==w)return S[k]}return null}},isActive:function(w,S,k){for(var C="no-"+S;w;){var T=w.classList;if(T.contains(S))return!0;if(T.contains(C))return!1;w=w.parentElement}return!!k}},languages:{plain:a,plaintext:a,text:a,txt:a,extend:function(w,S){var k=o.util.clone(o.languages[w]);for(var C in S)k[C]=S[C];return k},insertBefore:function(w,S,k,C){C=C||o.languages;var T=C[w],A={};for(var N in T)if(T.hasOwnProperty(N)){if(N==S)for(var I in k)k.hasOwnProperty(I)&&(A[I]=k[I]);k.hasOwnProperty(N)||(A[N]=T[N])}var O=C[w];return C[w]=A,o.languages.DFS(o.languages,function(B,D){D===O&&B!=w&&(this[B]=A)}),A},DFS:function w(S,k,C,T){T=T||{};var A=o.util.objId;for(var N in S)if(S.hasOwnProperty(N)){k.call(S,N,S[N],C||N);var I=S[N],O=o.util.type(I);O==="Object"&&!T[A(I)]?(T[A(I)]=!0,w(I,k,null,T)):O==="Array"&&!T[A(I)]&&(T[A(I)]=!0,w(I,k,N,T))}}},plugins:{},highlightAll:function(w,S){o.highlightAllUnder(document,w,S)},highlightAllUnder:function(w,S,k){var C={callback:k,container:w,selector:'code[class*="language-"], [class*="language-"] code, code[class*="lang-"], [class*="lang-"] code'};o.hooks.run("before-highlightall",C),C.elements=Array.prototype.slice.apply(C.container.querySelectorAll(C.selector)),o.hooks.run("before-all-elements-highlight",C);for(var T=0,A;A=C.elements[T++];)o.highlightElement(A,S===!0,C.callback)},highlightElement:function(w,S,k){var C=o.util.getLanguage(w),T=o.languages[C];o.util.setLanguage(w,C);var A=w.parentElement;A&&A.nodeName.toLowerCase()==="pre"&&o.util.setLanguage(A,C);var N=w.textContent,I={element:w,language:C,grammar:T,code:N};function O(D){I.highlightedCode=D,o.hooks.run("before-insert",I),I.element.innerHTML=I.highlightedCode,o.hooks.run("after-highlight",I),o.hooks.run("complete",I),k&&k.call(I.element)}if(o.hooks.run("before-sanity-check",I),A=I.element.parentElement,A&&A.nodeName.toLowerCase()==="pre"&&!A.hasAttribute("tabindex")&&A.setAttribute("tabindex","0"),!I.code){o.hooks.run("complete",I),k&&k.call(I.element);return}if(o.hooks.run("before-highlight",I),!I.grammar){O(o.util.encode(I.code));return}if(S&&r.Worker){var B=new Worker(o.filename);B.onmessage=function(D){O(D.data)},B.postMessage(JSON.stringify({language:I.language,code:I.code,immediateClose:!0}))}else O(o.highlight(I.code,I.grammar,I.language))},highlight:function(w,S,k){var C={code:w,grammar:S,language:k};if(o.hooks.run("before-tokenize",C),!C.grammar)throw new Error('The language "'+C.language+'" has no grammar.');return C.tokens=o.tokenize(C.code,C.grammar),o.hooks.run("after-tokenize",C),l.stringify(o.util.encode(C.tokens),C.language)},tokenize:function(w,S){var k=S.rest;if(k){for(var C in k)S[C]=k[C];delete S.rest}var T=new d;return h(T,T.head,w),u(w,T,S,T.head,0),y(T)},hooks:{all:{},add:function(w,S){var k=o.hooks.all;k[w]=k[w]||[],k[w].push(S)},run:function(w,S){var k=o.hooks.all[w];if(!(!k||!k.length))for(var C=0,T;T=k[C++];)T(S)}},Token:l};r.Prism=o;function l(w,S,k,C){this.type=w,this.content=S,this.alias=k,this.length=(C||"").length|0}l.stringify=function w(S,k){if(typeof S=="string")return S;if(Array.isArray(S)){var C="";return S.forEach(function(O){C+=w(O,k)}),C}var T={type:S.type,content:w(S.content,k),tag:"span",classes:["token",S.type],attributes:{},language:k},A=S.alias;A&&(Array.isArray(A)?Array.prototype.push.apply(T.classes,A):T.classes.push(A)),o.hooks.run("wrap",T);var N="";for(var I in T.attributes)N+=" "+I+'="'+(T.attributes[I]||"").replace(/"/g,"&quot;")+'"';return"<"+T.tag+' class="'+T.classes.join(" ")+'"'+N+">"+T.content+"</"+T.tag+">"};function c(w,S,k,C){w.lastIndex=S;var T=w.exec(k);if(T&&C&&T[1]){var A=T[1].length;T.index+=A,T[0]=T[0].slice(A)}return T}function u(w,S,k,C,T,A){for(var N in k)if(!(!k.hasOwnProperty(N)||!k[N])){var I=k[N];I=Array.isArray(I)?I:[I];for(var O=0;O<I.length;++O){if(A&&A.cause==N+","+O)return;var B=I[O],D=B.inside,H=!!B.lookbehind,P=!!B.greedy,K=B.alias;if(P&&!B.pattern.global){var U=B.pattern.toString().match(/[imsuy]*$/)[0];B.pattern=RegExp(B.pattern.source,U+"g")}for(var V=B.pattern||B,L=C.next,te=T;L!==S.tail&&!(A&&te>=A.reach);te+=L.value.length,L=L.next){var W=L.value;if(S.length>w.length)return;if(!(W instanceof l)){var Q=1,ee;if(P){if(ee=c(V,te,w,H),!ee||ee.index>=w.length)break;var Oe=ee.index,re=ee.index+ee[0].length,pe=te;for(pe+=L.value.length;Oe>=pe;)L=L.next,pe+=L.value.length;if(pe-=L.value.length,te=pe,L.value instanceof l)continue;for(var de=L;de!==S.tail&&(pe<re||typeof de.value=="string");de=de.next)Q++,pe+=de.value.length;Q--,W=w.slice(te,pe),ee.index-=te}else if(ee=c(V,0,W,H),!ee)continue;var Oe=ee.index,Fe=ee[0],Se=W.slice(0,Oe),Ce=W.slice(Oe+Fe.length),qe=te+W.length;A&&qe>A.reach&&(A.reach=qe);var Qe=L.prev;Se&&(Qe=h(S,Qe,Se),te+=Se.length),m(S,Qe,Q);var We=new l(N,D?o.tokenize(Fe,D):Fe,K,Fe);if(L=h(S,Qe,We),Ce&&h(S,L,Ce),Q>1){var je={cause:N+","+O,reach:qe};u(w,S,k,L.prev,te,je),A&&je.reach>A.reach&&(A.reach=je.reach)}}}}}}function d(){var w={value:null,prev:null,next:null},S={value:null,prev:w,next:null};w.next=S,this.head=w,this.tail=S,this.length=0}function h(w,S,k){var C=S.next,T={value:k,prev:S,next:C};return S.next=T,C.prev=T,w.length++,T}function m(w,S,k){for(var C=S.next,T=0;T<k&&C!==w.tail;T++)C=C.next;S.next=C,C.prev=S,w.length-=T}function y(w){for(var S=[],k=w.head.next;k!==w.tail;)S.push(k.value),k=k.next;return S}if(!r.document)return r.addEventListener&&(o.disableWorkerMessageHandler||r.addEventListener("message",function(w){var S=JSON.parse(w.data),k=S.language,C=S.code,T=S.immediateClose;r.postMessage(o.highlight(C,o.languages[k],k)),T&&r.close()},!1)),o;var b=o.util.currentScript();b&&(o.filename=b.src,b.hasAttribute("data-manual")&&(o.manual=!0));function v(){o.manual||o.highlightAll()}if(!o.manual){var x=document.readyState;x==="loading"||x==="interactive"&&b&&b.defer?document.addEventListener("DOMContentLoaded",v):window.requestAnimationFrame?window.requestAnimationFrame(v):window.setTimeout(v,16)}return o}(t);e.exports&&(e.exports=n),typeof im<"u"&&(im.Prism=n),n.languages.markup={comment:{pattern:/<!--(?:(?!<!--)[\s\S])*?-->/,greedy:!0},prolog:{pattern:/<\?[\s\S]+?\?>/,greedy:!0},doctype:{pattern:/<!DOCTYPE(?:[^>"'[\]]|"[^"]*"|'[^']*')+(?:\[(?:[^<"'\]]|"[^"]*"|'[^']*'|<(?!!--)|<!--(?:[^-]|-(?!->))*-->)*\]\s*)?>/i,greedy:!0,inside:{"internal-subset":{pattern:/(^[^\[]*\[)[\s\S]+(?=\]>$)/,lookbehind:!0,greedy:!0,inside:null},string:{pattern:/"[^"]*"|'[^']*'/,greedy:!0},punctuation:/^<!|>$|[[\]]/,"doctype-tag":/^DOCTYPE/i,name:/[^\s<>'"]+/}},cdata:{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,greedy:!0},tag:{pattern:/<\/?(?!\d)[^\s>\/=$<%]+(?:\s(?:\s*[^\s>\/=]+(?:\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))|(?=[\s/>])))+)?\s*\/?>/,greedy:!0,inside:{tag:{pattern:/^<\/?[^\s>\/]+/,inside:{punctuation:/^<\/?/,namespace:/^[^\s>\/:]+:/}},"special-attr":[],"attr-value":{pattern:/=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+)/,inside:{punctuation:[{pattern:/^=/,alias:"attr-equals"},{pattern:/^(\s*)["']|["']$/,lookbehind:!0}]}},punctuation:/\/?>/,"attr-name":{pattern:/[^\s>\/]+/,inside:{namespace:/^[^\s>\/:]+:/}}}},entity:[{pattern:/&[\da-z]{1,8};/i,alias:"named-entity"},/&#x?[\da-f]{1,8};/i]},n.languages.markup.tag.inside["attr-value"].inside.entity=n.languages.markup.entity,n.languages.markup.doctype.inside["internal-subset"].inside=n.languages.markup,n.hooks.add("wrap",function(r){r.type==="entity"&&(r.attributes.title=r.content.replace(/&amp;/,"&"))}),Object.defineProperty(n.languages.markup.tag,"addInlined",{value:function(s,i){var a={};a["language-"+i]={pattern:/(^<!\[CDATA\[)[\s\S]+?(?=\]\]>$)/i,lookbehind:!0,inside:n.languages[i]},a.cdata=/^<!\[CDATA\[|\]\]>$/i;var o={"included-cdata":{pattern:/<!\[CDATA\[[\s\S]*?\]\]>/i,inside:a}};o["language-"+i]={pattern:/[\s\S]+/,inside:n.languages[i]};var l={};l[s]={pattern:RegExp(/(<__[^>]*>)(?:<!\[CDATA\[(?:[^\]]|\](?!\]>))*\]\]>|(?!<!\[CDATA\[)[\s\S])*?(?=<\/__>)/.source.replace(/__/g,function(){return s}),"i"),lookbehind:!0,greedy:!0,inside:o},n.languages.insertBefore("markup","cdata",l)}}),Object.defineProperty(n.languages.markup.tag,"addAttribute",{value:function(r,s){n.languages.markup.tag.inside["special-attr"].push({pattern:RegExp(/(^|["'\s])/.source+"(?:"+r+")"+/\s*=\s*(?:"[^"]*"|'[^']*'|[^\s'">=]+(?=[\s>]))/.source,"i"),lookbehind:!0,inside:{"attr-name":/^[^\s=]+/,"attr-value":{pattern:/=[\s\S]+/,inside:{value:{pattern:/(^=\s*(["']|(?!["'])))\S[\s\S]*(?=\2$)/,lookbehind:!0,alias:[s,"language-"+s],inside:n.languages[s]},punctuation:[{pattern:/^=/,alias:"attr-equals"},/"|'/]}}}})}}),n.languages.html=n.languages.markup,n.languages.mathml=n.languages.markup,n.languages.svg=n.languages.markup,n.languages.xml=n.languages.extend("markup",{}),n.languages.ssml=n.languages.xml,n.languages.atom=n.languages.xml,n.languages.rss=n.languages.xml,function(r){var s=/(?:"(?:\\(?:\r\n|[\s\S])|[^"\\\r\n])*"|'(?:\\(?:\r\n|[\s\S])|[^'\\\r\n])*')/;r.languages.css={comment:/\/\*[\s\S]*?\*\//,atrule:{pattern:RegExp("@[\\w-](?:"+/[^;{\s"']|\s+(?!\s)/.source+"|"+s.source+")*?"+/(?:;|(?=\s*\{))/.source),inside:{rule:/^@[\w-]+/,"selector-function-argument":{pattern:/(\bselector\s*\(\s*(?![\s)]))(?:[^()\s]|\s+(?![\s)])|\((?:[^()]|\([^()]*\))*\))+(?=\s*\))/,lookbehind:!0,alias:"selector"},keyword:{pattern:/(^|[^\w-])(?:and|not|only|or)(?![\w-])/,lookbehind:!0}}},url:{pattern:RegExp("\\burl\\((?:"+s.source+"|"+/(?:[^\\\r\n()"']|\\[\s\S])*/.source+")\\)","i"),greedy:!0,inside:{function:/^url/i,punctuation:/^\(|\)$/,string:{pattern:RegExp("^"+s.source+"$"),alias:"url"}}},selector:{pattern:RegExp(`(^|[{}\\s])[^{}\\s](?:[^{};"'\\s]|\\s+(?![\\s{])|`+s.source+")*(?=\\s*\\{)"),lookbehind:!0},string:{pattern:s,greedy:!0},property:{pattern:/(^|[^-\w\xA0-\uFFFF])(?!\s)[-_a-z\xA0-\uFFFF](?:(?!\s)[-\w\xA0-\uFFFF])*(?=\s*:)/i,lookbehind:!0},important:/!important\b/i,function:{pattern:/(^|[^-a-z0-9])[-a-z0-9]+(?=\()/i,lookbehind:!0},punctuation:/[(){};:,]/},r.languages.css.atrule.inside.rest=r.languages.css;var i=r.languages.markup;i&&(i.tag.addInlined("style","css"),i.tag.addAttribute("style","css"))}(n),n.languages.clike={comment:[{pattern:/(^|[^\\])\/\*[\s\S]*?(?:\*\/|$)/,lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/(["'])(?:\\(?:\r\n|[\s\S])|(?!\1)[^\\\r\n])*\1/,greedy:!0},"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|trait)\s+|\bcatch\s+\()[\w.\\]+/i,lookbehind:!0,inside:{punctuation:/[.\\]/}},keyword:/\b(?:break|catch|continue|do|else|finally|for|function|if|in|instanceof|new|null|return|throw|try|while)\b/,boolean:/\b(?:false|true)\b/,function:/\b\w+(?=\()/,number:/\b0x[\da-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:e[+-]?\d+)?/i,operator:/[<>]=?|[!=]=?=?|--?|\+\+?|&&?|\|\|?|[?*/~^%]/,punctuation:/[{}[\];(),.:]/},n.languages.javascript=n.languages.extend("clike",{"class-name":[n.languages.clike["class-name"],{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$A-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\.(?:constructor|prototype))/,lookbehind:!0}],keyword:[{pattern:/((?:^|\})\s*)catch\b/,lookbehind:!0},{pattern:/(^|[^.]|\.\.\.\s*)\b(?:as|assert(?=\s*\{)|async(?=\s*(?:function\b|\(|[$\w\xA0-\uFFFF]|$))|await|break|case|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally(?=\s*(?:\{|$))|for|from(?=\s*(?:['"]|$))|function|(?:get|set)(?=\s*(?:[#\[$\w\xA0-\uFFFF]|$))|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)\b/,lookbehind:!0}],function:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*(?:\.\s*(?:apply|bind|call)\s*)?\()/,number:{pattern:RegExp(/(^|[^\w$])/.source+"(?:"+(/NaN|Infinity/.source+"|"+/0[bB][01]+(?:_[01]+)*n?/.source+"|"+/0[oO][0-7]+(?:_[0-7]+)*n?/.source+"|"+/0[xX][\dA-Fa-f]+(?:_[\dA-Fa-f]+)*n?/.source+"|"+/\d+(?:_\d+)*n/.source+"|"+/(?:\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\.\d+(?:_\d+)*)(?:[Ee][+-]?\d+(?:_\d+)*)?/.source)+")"+/(?![\w$])/.source),lookbehind:!0},operator:/--|\+\+|\*\*=?|=>|&&=?|\|\|=?|[!=]==|<<=?|>>>?=?|[-+*/%&|^!=<>]=?|\.{3}|\?\?=?|\?\.?|[~:]/}),n.languages.javascript["class-name"][0].pattern=/(\b(?:class|extends|implements|instanceof|interface|new)\s+)[\w.\\]+/,n.languages.insertBefore("javascript","keyword",{regex:{pattern:RegExp(/((?:^|[^$\w\xA0-\uFFFF."'\])\s]|\b(?:return|yield))\s*)/.source+/\//.source+"(?:"+/(?:\[(?:[^\]\\\r\n]|\\.)*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}/.source+"|"+/(?:\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.|\[(?:[^[\]\\\r\n]|\\.)*\])*\])*\]|\\.|[^/\\\[\r\n])+\/[dgimyus]{0,7}v[dgimyus]{0,7}/.source+")"+/(?=(?:\s|\/\*(?:[^*]|\*(?!\/))*\*\/)*(?:$|[\r\n,.;:})\]]|\/\/))/.source),lookbehind:!0,greedy:!0,inside:{"regex-source":{pattern:/^(\/)[\s\S]+(?=\/[a-z]*$)/,lookbehind:!0,alias:"language-regex",inside:n.languages.regex},"regex-delimiter":/^\/|\/$/,"regex-flags":/^[a-z]+$/}},"function-variable":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*[=:]\s*(?:async\s*)?(?:\bfunction\b|(?:\((?:[^()]|\([^()]*\))*\)|(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)\s*=>))/,alias:"function"},parameter:[{pattern:/(function(?:\s+(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*)?\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\))/,lookbehind:!0,inside:n.languages.javascript},{pattern:/(^|[^$\w\xA0-\uFFFF])(?!\s)[_$a-z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*=>)/i,lookbehind:!0,inside:n.languages.javascript},{pattern:/(\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*=>)/,lookbehind:!0,inside:n.languages.javascript},{pattern:/((?:\b|\s|^)(?!(?:as|async|await|break|case|catch|class|const|continue|debugger|default|delete|do|else|enum|export|extends|finally|for|from|function|get|if|implements|import|in|instanceof|interface|let|new|null|of|package|private|protected|public|return|set|static|super|switch|this|throw|try|typeof|undefined|var|void|while|with|yield)(?![$\w\xA0-\uFFFF]))(?:(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*)\(\s*|\]\s*\(\s*)(?!\s)(?:[^()\s]|\s+(?![\s)])|\([^()]*\))+(?=\s*\)\s*\{)/,lookbehind:!0,inside:n.languages.javascript}],constant:/\b[A-Z](?:[A-Z_]|\dx?)*\b/}),n.languages.insertBefore("javascript","string",{hashbang:{pattern:/^#!.*/,greedy:!0,alias:"comment"},"template-string":{pattern:/`(?:\\[\s\S]|\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}|(?!\$\{)[^\\`])*`/,greedy:!0,inside:{"template-punctuation":{pattern:/^`|`$/,alias:"string"},interpolation:{pattern:/((?:^|[^\\])(?:\\{2})*)\$\{(?:[^{}]|\{(?:[^{}]|\{[^}]*\})*\})+\}/,lookbehind:!0,inside:{"interpolation-punctuation":{pattern:/^\$\{|\}$/,alias:"punctuation"},rest:n.languages.javascript}},string:/[\s\S]+/}},"string-property":{pattern:/((?:^|[,{])[ \t]*)(["'])(?:\\(?:\r\n|[\s\S])|(?!\2)[^\\\r\n])*\2(?=\s*:)/m,lookbehind:!0,greedy:!0,alias:"property"}}),n.languages.insertBefore("javascript","operator",{"literal-property":{pattern:/((?:^|[,{])[ \t]*)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?=\s*:)/m,lookbehind:!0,alias:"property"}}),n.languages.markup&&(n.languages.markup.tag.addInlined("script","javascript"),n.languages.markup.tag.addAttribute(/on(?:abort|blur|change|click|composition(?:end|start|update)|dblclick|error|focus(?:in|out)?|key(?:down|up)|load|mouse(?:down|enter|leave|move|out|over|up)|reset|resize|scroll|select|slotchange|submit|unload|wheel)/.source,"javascript")),n.languages.js=n.languages.javascript,function(){if(typeof n>"u"||typeof document>"u")return;Element.prototype.matches||(Element.prototype.matches=Element.prototype.msMatchesSelector||Element.prototype.webkitMatchesSelector);var r="Loading",s=function(b,v){return" Error "+b+" while fetching file: "+v},i=" Error: File does not exist or is empty",a={js:"javascript",py:"python",rb:"ruby",ps1:"powershell",psm1:"powershell",sh:"bash",bat:"batch",h:"c",tex:"latex"},o="data-src-status",l="loading",c="loaded",u="failed",d="pre[data-src]:not(["+o+'="'+c+'"]):not(['+o+'="'+l+'"])';function h(b,v,x){var w=new XMLHttpRequest;w.open("GET",b,!0),w.onreadystatechange=function(){w.readyState==4&&(w.status<400&&w.responseText?v(w.responseText):w.status>=400?x(s(w.status,w.statusText)):x(i))},w.send(null)}function m(b){var v=/^\s*(\d+)\s*(?:(,)\s*(?:(\d+)\s*)?)?$/.exec(b||"");if(v){var x=Number(v[1]),w=v[2],S=v[3];return w?S?[x,Number(S)]:[x,void 0]:[x,x]}}n.hooks.add("before-highlightall",function(b){b.selector+=", "+d}),n.hooks.add("before-sanity-check",function(b){var v=b.element;if(v.matches(d)){b.code="",v.setAttribute(o,l);var x=v.appendChild(document.createElement("CODE"));x.textContent=r;var w=v.getAttribute("data-src"),S=b.language;if(S==="none"){var k=(/\.(\w+)$/.exec(w)||[,"none"])[1];S=a[k]||k}n.util.setLanguage(x,S),n.util.setLanguage(v,S);var C=n.plugins.autoloader;C&&C.loadLanguages(S),h(w,function(T){v.setAttribute(o,c);var A=m(v.getAttribute("data-range"));if(A){var N=T.split(/\r\n?|\n/g),I=A[0],O=A[1]==null?N.length:A[1];I<0&&(I+=N.length),I=Math.max(0,Math.min(I-1,N.length)),O<0&&(O+=N.length),O=Math.max(0,Math.min(O,N.length)),T=N.slice(I,O).join(`
`),v.hasAttribute("data-start")||v.setAttribute("data-start",String(I+1))}x.textContent=T,n.highlightElement(x)},function(T){v.setAttribute(o,u),x.textContent=T})}}),n.plugins.fileHighlight={highlight:function(v){for(var x=(v||document).querySelectorAll(d),w=0,S;S=x[w++];)n.highlightElement(S)}};var y=!1;n.fileHighlight=function(){y||(console.warn("Prism.fileHighlight is deprecated. Use `Prism.plugins.fileHighlight.highlight` instead."),y=!0),n.plugins.fileHighlight.highlight.apply(this,arguments)}}()}(A3)),A3.exports}var qYe=UYe();const Ks=da(qYe);var dV={},fV;function VYe(){return fV||(fV=1,function(e){e.languages.typescript=e.languages.extend("javascript",{"class-name":{pattern:/(\b(?:class|extends|implements|instanceof|interface|new|type)\s+)(?!keyof\b)(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*(?:\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>)?/,lookbehind:!0,greedy:!0,inside:null},builtin:/\b(?:Array|Function|Promise|any|boolean|console|never|number|string|symbol|unknown)\b/}),e.languages.typescript.keyword.push(/\b(?:abstract|declare|is|keyof|readonly|require)\b/,/\b(?:asserts|infer|interface|module|namespace|type)\b(?=\s*(?:[{_$a-zA-Z\xA0-\uFFFF]|$))/,/\btype\b(?=\s*(?:[\{*]|$))/),delete e.languages.typescript.parameter,delete e.languages.typescript["literal-property"];var t=e.languages.extend("typescript",{});delete t["class-name"],e.languages.typescript["class-name"].inside=t,e.languages.insertBefore("typescript","function",{decorator:{pattern:/@[$\w\xA0-\uFFFF]+/,inside:{at:{pattern:/^@/,alias:"operator"},function:/^[\s\S]+/}},"generic-function":{pattern:/#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*\s*<(?:[^<>]|<(?:[^<>]|<[^<>]*>)*>)*>(?=\s*\()/,greedy:!0,inside:{function:/^#?(?!\s)[_$a-zA-Z\xA0-\uFFFF](?:(?!\s)[$\w\xA0-\uFFFF])*/,generic:{pattern:/<[\s\S]+/,alias:"class-name",inside:t}}}}),e.languages.ts=e.languages.typescript}(Prism)),dV}VYe();var hV={},pV;function WYe(){return pV||(pV=1,Prism.languages.python={comment:{pattern:/(^|[^\\])#.*/,lookbehind:!0,greedy:!0},"string-interpolation":{pattern:/(?:f|fr|rf)(?:("""|''')[\s\S]*?\1|("|')(?:\\.|(?!\2)[^\\\r\n])*\2)/i,greedy:!0,inside:{interpolation:{pattern:/((?:^|[^{])(?:\{\{)*)\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}]|\{(?!\{)(?:[^{}])+\})+\})+\}/,lookbehind:!0,inside:{"format-spec":{pattern:/(:)[^:(){}]+(?=\}$)/,lookbehind:!0},"conversion-option":{pattern:/![sra](?=[:}]$)/,alias:"punctuation"},rest:null}},string:/[\s\S]+/}},"triple-quoted-string":{pattern:/(?:[rub]|br|rb)?("""|''')[\s\S]*?\1/i,greedy:!0,alias:"string"},string:{pattern:/(?:[rub]|br|rb)?("|')(?:\\.|(?!\1)[^\\\r\n])*\1/i,greedy:!0},function:{pattern:/((?:^|\s)def[ \t]+)[a-zA-Z_]\w*(?=\s*\()/g,lookbehind:!0},"class-name":{pattern:/(\bclass\s+)\w+/i,lookbehind:!0},decorator:{pattern:/(^[\t ]*)@\w+(?:\.\w+)*/m,lookbehind:!0,alias:["annotation","punctuation"],inside:{punctuation:/\./}},keyword:/\b(?:_(?=\s*:)|and|as|assert|async|await|break|case|class|continue|def|del|elif|else|except|exec|finally|for|from|global|if|import|in|is|lambda|match|nonlocal|not|or|pass|print|raise|return|try|while|with|yield)\b/,builtin:/\b(?:__import__|abs|all|any|apply|ascii|basestring|bin|bool|buffer|bytearray|bytes|callable|chr|classmethod|cmp|coerce|compile|complex|delattr|dict|dir|divmod|enumerate|eval|execfile|file|filter|float|format|frozenset|getattr|globals|hasattr|hash|help|hex|id|input|int|intern|isinstance|issubclass|iter|len|list|locals|long|map|max|memoryview|min|next|object|oct|open|ord|pow|property|range|raw_input|reduce|reload|repr|reversed|round|set|setattr|slice|sorted|staticmethod|str|sum|super|tuple|type|unichr|unicode|vars|xrange|zip)\b/,boolean:/\b(?:False|None|True)\b/,number:/\b0(?:b(?:_?[01])+|o(?:_?[0-7])+|x(?:_?[a-f0-9])+)\b|(?:\b\d+(?:_\d+)*(?:\.(?:\d+(?:_\d+)*)?)?|\B\.\d+(?:_\d+)*)(?:e[+-]?\d+(?:_\d+)*)?j?(?!\w)/i,operator:/[-+%=]=?|!=|:=|\*\*?=?|\/\/?=?|<[<=>]?|>[=>]?|[&|^~]/,punctuation:/[{}[\];(),.:]/},Prism.languages.python["string-interpolation"].inside.interpolation.inside.rest=Prism.languages.python,Prism.languages.py=Prism.languages.python),hV}WYe();(function(e){var t="\\b(?:BASH|BASHOPTS|BASH_ALIASES|BASH_ARGC|BASH_ARGV|BASH_CMDS|BASH_COMPLETION_COMPAT_DIR|BASH_LINENO|BASH_REMATCH|BASH_SOURCE|BASH_VERSINFO|BASH_VERSION|COLORTERM|COLUMNS|COMP_WORDBREAKS|DBUS_SESSION_BUS_ADDRESS|DEFAULTS_PATH|DESKTOP_SESSION|DIRSTACK|DISPLAY|EUID|GDMSESSION|GDM_LANG|GNOME_KEYRING_CONTROL|GNOME_KEYRING_PID|GPG_AGENT_INFO|GROUPS|HISTCONTROL|HISTFILE|HISTFILESIZE|HISTSIZE|HOME|HOSTNAME|HOSTTYPE|IFS|INSTANCE|JOB|LANG|LANGUAGE|LC_ADDRESS|LC_ALL|LC_IDENTIFICATION|LC_MEASUREMENT|LC_MONETARY|LC_NAME|LC_NUMERIC|LC_PAPER|LC_TELEPHONE|LC_TIME|LESSCLOSE|LESSOPEN|LINES|LOGNAME|LS_COLORS|MACHTYPE|MAILCHECK|MANDATORY_PATH|NO_AT_BRIDGE|OLDPWD|OPTERR|OPTIND|ORBIT_SOCKETDIR|OSTYPE|PAPERSIZE|PATH|PIPESTATUS|PPID|PS1|PS2|PS3|PS4|PWD|RANDOM|REPLY|SECONDS|SELINUX_INIT|SESSION|SESSIONTYPE|SESSION_MANAGER|SHELL|SHELLOPTS|SHLVL|SSH_AUTH_SOCK|TERM|UID|UPSTART_EVENTS|UPSTART_INSTANCE|UPSTART_JOB|UPSTART_SESSION|USER|WINDOWID|XAUTHORITY|XDG_CONFIG_DIRS|XDG_CURRENT_DESKTOP|XDG_DATA_DIRS|XDG_GREETER_DATA_DIR|XDG_MENU_PREFIX|XDG_RUNTIME_DIR|XDG_SEAT|XDG_SEAT_PATH|XDG_SESSION_DESKTOP|XDG_SESSION_ID|XDG_SESSION_PATH|XDG_SESSION_TYPE|XDG_VTNR|XMODIFIERS)\\b",n={pattern:/(^(["']?)\w+\2)[ \t]+\S.*/,lookbehind:!0,alias:"punctuation",inside:null},r={bash:n,environment:{pattern:RegExp("\\$"+t),alias:"constant"},variable:[{pattern:/\$?\(\([\s\S]+?\)\)/,greedy:!0,inside:{variable:[{pattern:/(^\$\(\([\s\S]+)\)\)/,lookbehind:!0},/^\$\(\(/],number:/\b0x[\dA-Fa-f]+\b|(?:\b\d+(?:\.\d*)?|\B\.\d+)(?:[Ee]-?\d+)?/,operator:/--|\+\+|\*\*=?|<<=?|>>=?|&&|\|\||[=!+\-*/%<>^&|]=?|[?~:]/,punctuation:/\(\(?|\)\)?|,|;/}},{pattern:/\$\((?:\([^)]+\)|[^()])+\)|`[^`]+`/,greedy:!0,inside:{variable:/^\$\(|^`|\)$|`$/}},{pattern:/\$\{[^}]+\}/,greedy:!0,inside:{operator:/:[-=?+]?|[!\/]|##?|%%?|\^\^?|,,?/,punctuation:/[\[\]]/,environment:{pattern:RegExp("(\\{)"+t),lookbehind:!0,alias:"constant"}}},/\$(?:\w+|[#?*!@$])/],entity:/\\(?:[abceEfnrtv\\"]|O?[0-7]{1,3}|U[0-9a-fA-F]{8}|u[0-9a-fA-F]{4}|x[0-9a-fA-F]{1,2})/};e.languages.bash={shebang:{pattern:/^#!\s*\/.*/,alias:"important"},comment:{pattern:/(^|[^"{\\$])#.*/,lookbehind:!0},"function-name":[{pattern:/(\bfunction\s+)[\w-]+(?=(?:\s*\(?:\s*\))?\s*\{)/,lookbehind:!0,alias:"function"},{pattern:/\b[\w-]+(?=\s*\(\s*\)\s*\{)/,alias:"function"}],"for-or-select":{pattern:/(\b(?:for|select)\s+)\w+(?=\s+in\s)/,alias:"variable",lookbehind:!0},"assign-left":{pattern:/(^|[\s;|&]|[<>]\()\w+(?:\.\w+)*(?=\+?=)/,inside:{environment:{pattern:RegExp("(^|[\\s;|&]|[<>]\\()"+t),lookbehind:!0,alias:"constant"}},alias:"variable",lookbehind:!0},parameter:{pattern:/(^|\s)-{1,2}(?:\w+:[+-]?)?\w+(?:\.\w+)*(?=[=\s]|$)/,alias:"variable",lookbehind:!0},string:[{pattern:/((?:^|[^<])<<-?\s*)(\w+)\s[\s\S]*?(?:\r?\n|\r)\2/,lookbehind:!0,greedy:!0,inside:r},{pattern:/((?:^|[^<])<<-?\s*)(["'])(\w+)\2\s[\s\S]*?(?:\r?\n|\r)\3/,lookbehind:!0,greedy:!0,inside:{bash:n}},{pattern:/(^|[^\\](?:\\\\)*)"(?:\\[\s\S]|\$\([^)]+\)|\$(?!\()|`[^`]+`|[^"\\`$])*"/,lookbehind:!0,greedy:!0,inside:r},{pattern:/(^|[^$\\])'[^']*'/,lookbehind:!0,greedy:!0},{pattern:/\$'(?:[^'\\]|\\[\s\S])*'/,greedy:!0,inside:{entity:r.entity}}],environment:{pattern:RegExp("\\$?"+t),alias:"constant"},variable:r.variable,function:{pattern:/(^|[\s;|&]|[<>]\()(?:add|apropos|apt|apt-cache|apt-get|aptitude|aspell|automysqlbackup|awk|basename|bash|bc|bconsole|bg|bzip2|cal|cargo|cat|cfdisk|chgrp|chkconfig|chmod|chown|chroot|cksum|clear|cmp|column|comm|composer|cp|cron|crontab|csplit|curl|cut|date|dc|dd|ddrescue|debootstrap|df|diff|diff3|dig|dir|dircolors|dirname|dirs|dmesg|docker|docker-compose|du|egrep|eject|env|ethtool|expand|expect|expr|fdformat|fdisk|fg|fgrep|file|find|fmt|fold|format|free|fsck|ftp|fuser|gawk|git|gparted|grep|groupadd|groupdel|groupmod|groups|grub-mkconfig|gzip|halt|head|hg|history|host|hostname|htop|iconv|id|ifconfig|ifdown|ifup|import|install|ip|java|jobs|join|kill|killall|less|link|ln|locate|logname|logrotate|look|lpc|lpr|lprint|lprintd|lprintq|lprm|ls|lsof|lynx|make|man|mc|mdadm|mkconfig|mkdir|mke2fs|mkfifo|mkfs|mkisofs|mknod|mkswap|mmv|more|most|mount|mtools|mtr|mutt|mv|nano|nc|netstat|nice|nl|node|nohup|notify-send|npm|nslookup|op|open|parted|passwd|paste|pathchk|ping|pkill|pnpm|podman|podman-compose|popd|pr|printcap|printenv|ps|pushd|pv|quota|quotacheck|quotactl|ram|rar|rcp|reboot|remsync|rename|renice|rev|rm|rmdir|rpm|rsync|scp|screen|sdiff|sed|sendmail|seq|service|sftp|sh|shellcheck|shuf|shutdown|sleep|slocate|sort|split|ssh|stat|strace|su|sudo|sum|suspend|swapon|sync|sysctl|tac|tail|tar|tee|time|timeout|top|touch|tr|traceroute|tsort|tty|umount|uname|unexpand|uniq|units|unrar|unshar|unzip|update-grub|uptime|useradd|userdel|usermod|users|uudecode|uuencode|v|vcpkg|vdir|vi|vim|virsh|vmstat|wait|watch|wc|wget|whereis|which|who|whoami|write|xargs|xdg-open|yarn|yes|zenity|zip|zsh|zypper)(?=$|[)\s;|&])/,lookbehind:!0},keyword:{pattern:/(^|[\s;|&]|[<>]\()(?:case|do|done|elif|else|esac|fi|for|function|if|in|select|then|until|while)(?=$|[)\s;|&])/,lookbehind:!0},builtin:{pattern:/(^|[\s;|&]|[<>]\()(?:\.|:|alias|bind|break|builtin|caller|cd|command|continue|declare|echo|enable|eval|exec|exit|export|getopts|hash|help|let|local|logout|mapfile|printf|pwd|read|readarray|readonly|return|set|shift|shopt|source|test|times|trap|type|typeset|ulimit|umask|unalias|unset)(?=$|[)\s;|&])/,lookbehind:!0,alias:"class-name"},boolean:{pattern:/(^|[\s;|&]|[<>]\()(?:false|true)(?=$|[)\s;|&])/,lookbehind:!0},"file-descriptor":{pattern:/\B&\d\b/,alias:"important"},operator:{pattern:/\d?<>|>\||\+=|=[=~]?|!=?|<<[<-]?|[&\d]?>>|\d[<>]&?|[<>][&=]?|&[>&]?|\|[&|]?/,inside:{"file-descriptor":{pattern:/^\d/,alias:"important"}}},punctuation:/\$?\(\(?|\)\)?|\.\.|[{}[\];\\]/,number:{pattern:/(^|\s)(?:[1-9]\d*|0)(?:[.,]\d+)?\b/,lookbehind:!0}},n.inside=e.languages.bash;for(var s=["comment","function-name","for-or-select","assign-left","parameter","string","environment","function","keyword","builtin","boolean","file-descriptor","operator","punctuation","number"],i=r.variable[1].inside,a=0;a<s.length;a++)i[s[a]]=e.languages.bash[s[a]];e.languages.sh=e.languages.bash,e.languages.shell=e.languages.bash})(Prism);Prism.languages.json={property:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?=\s*:)/,lookbehind:!0,greedy:!0},string:{pattern:/(^|[^\\])"(?:\\.|[^\\"\r\n])*"(?!\s*:)/,lookbehind:!0,greedy:!0},comment:{pattern:/\/\/.*|\/\*[\s\S]*?(?:\*\/|$)/,greedy:!0},number:/-?\b\d+(?:\.\d+)?(?:e[+-]?\d+)?\b/i,punctuation:/[{}[\],]/,operator:/:/,boolean:/\b(?:false|true)\b/,null:{pattern:/\bnull\b/,alias:"keyword"}};Prism.languages.webmanifest=Prism.languages.json;(function(e){var t=/(?:\\.|[^\\\n\r]|(?:\n|\r\n?)(?![\r\n]))/.source;function n(u){return u=u.replace(/<inner>/g,function(){return t}),RegExp(/((?:^|[^\\])(?:\\{2})*)/.source+"(?:"+u+")")}var r=/(?:\\.|``(?:[^`\r\n]|`(?!`))+``|`[^`\r\n]+`|[^\\|\r\n`])+/.source,s=/\|?__(?:\|__)+\|?(?:(?:\n|\r\n?)|(?![\s\S]))/.source.replace(/__/g,function(){return r}),i=/\|?[ \t]*:?-{3,}:?[ \t]*(?:\|[ \t]*:?-{3,}:?[ \t]*)+\|?(?:\n|\r\n?)/.source;e.languages.markdown=e.languages.extend("markup",{}),e.languages.insertBefore("markdown","prolog",{"front-matter-block":{pattern:/(^(?:\s*[\r\n])?)---(?!.)[\s\S]*?[\r\n]---(?!.)/,lookbehind:!0,greedy:!0,inside:{punctuation:/^---|---$/,"front-matter":{pattern:/\S+(?:\s+\S+)*/,alias:["yaml","language-yaml"],inside:e.languages.yaml}}},blockquote:{pattern:/^>(?:[\t ]*>)*/m,alias:"punctuation"},table:{pattern:RegExp("^"+s+i+"(?:"+s+")*","m"),inside:{"table-data-rows":{pattern:RegExp("^("+s+i+")(?:"+s+")*$"),lookbehind:!0,inside:{"table-data":{pattern:RegExp(r),inside:e.languages.markdown},punctuation:/\|/}},"table-line":{pattern:RegExp("^("+s+")"+i+"$"),lookbehind:!0,inside:{punctuation:/\||:?-{3,}:?/}},"table-header-row":{pattern:RegExp("^"+s+"$"),inside:{"table-header":{pattern:RegExp(r),alias:"important",inside:e.languages.markdown},punctuation:/\|/}}}},code:[{pattern:/((?:^|\n)[ \t]*\n|(?:^|\r\n?)[ \t]*\r\n?)(?: {4}|\t).+(?:(?:\n|\r\n?)(?: {4}|\t).+)*/,lookbehind:!0,alias:"keyword"},{pattern:/^```[\s\S]*?^```$/m,greedy:!0,inside:{"code-block":{pattern:/^(```.*(?:\n|\r\n?))[\s\S]+?(?=(?:\n|\r\n?)^```$)/m,lookbehind:!0},"code-language":{pattern:/^(```).+/,lookbehind:!0},punctuation:/```/}}],title:[{pattern:/\S.*(?:\n|\r\n?)(?:==+|--+)(?=[ \t]*$)/m,alias:"important",inside:{punctuation:/==+$|--+$/}},{pattern:/(^\s*)#.+/m,lookbehind:!0,alias:"important",inside:{punctuation:/^#+|#+$/}}],hr:{pattern:/(^\s*)([*-])(?:[\t ]*\2){2,}(?=\s*$)/m,lookbehind:!0,alias:"punctuation"},list:{pattern:/(^\s*)(?:[*+-]|\d+\.)(?=[\t ].)/m,lookbehind:!0,alias:"punctuation"},"url-reference":{pattern:/!?\[[^\]]+\]:[\t ]+(?:\S+|<(?:\\.|[^>\\])+>)(?:[\t ]+(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\)))?/,inside:{variable:{pattern:/^(!?\[)[^\]]+/,lookbehind:!0},string:/(?:"(?:\\.|[^"\\])*"|'(?:\\.|[^'\\])*'|\((?:\\.|[^)\\])*\))$/,punctuation:/^[\[\]!:]|[<>]/},alias:"url"},bold:{pattern:n(/\b__(?:(?!_)<inner>|_(?:(?!_)<inner>)+_)+__\b|\*\*(?:(?!\*)<inner>|\*(?:(?!\*)<inner>)+\*)+\*\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^..)[\s\S]+(?=..$)/,lookbehind:!0,inside:{}},punctuation:/\*\*|__/}},italic:{pattern:n(/\b_(?:(?!_)<inner>|__(?:(?!_)<inner>)+__)+_\b|\*(?:(?!\*)<inner>|\*\*(?:(?!\*)<inner>)+\*\*)+\*/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^.)[\s\S]+(?=.$)/,lookbehind:!0,inside:{}},punctuation:/[*_]/}},strike:{pattern:n(/(~~?)(?:(?!~)<inner>)+\2/.source),lookbehind:!0,greedy:!0,inside:{content:{pattern:/(^~~?)[\s\S]+(?=\1$)/,lookbehind:!0,inside:{}},punctuation:/~~?/}},"code-snippet":{pattern:/(^|[^\\`])(?:``[^`\r\n]+(?:`[^`\r\n]+)*``(?!`)|`[^`\r\n]+`(?!`))/,lookbehind:!0,greedy:!0,alias:["code","keyword"]},url:{pattern:n(/!?\[(?:(?!\])<inner>)+\](?:\([^\s)]+(?:[\t ]+"(?:\\.|[^"\\])*")?\)|[ \t]?\[(?:(?!\])<inner>)+\])/.source),lookbehind:!0,greedy:!0,inside:{operator:/^!/,content:{pattern:/(^\[)[^\]]+(?=\])/,lookbehind:!0,inside:{}},variable:{pattern:/(^\][ \t]?\[)[^\]]+(?=\]$)/,lookbehind:!0},url:{pattern:/(^\]\()[^\s)]+/,lookbehind:!0},string:{pattern:/(^[ \t]+)"(?:\\.|[^"\\])*"(?=\)$)/,lookbehind:!0}}}}),["url","bold","italic","strike"].forEach(function(u){["url","bold","italic","strike","code-snippet"].forEach(function(d){u!==d&&(e.languages.markdown[u].inside.content.inside[d]=e.languages.markdown[d])})}),e.hooks.add("after-tokenize",function(u){if(u.language!=="markdown"&&u.language!=="md")return;function d(h){if(!(!h||typeof h=="string"))for(var m=0,y=h.length;m<y;m++){var b=h[m];if(b.type!=="code"){d(b.content);continue}var v=b.content[1],x=b.content[3];if(v&&x&&v.type==="code-language"&&x.type==="code-block"&&typeof v.content=="string"){var w=v.content.replace(/\b#/g,"sharp").replace(/\b\+\+/g,"pp");w=(/[a-z][\w-]*/i.exec(w)||[""])[0].toLowerCase();var S="language-"+w;x.alias?typeof x.alias=="string"?x.alias=[x.alias,S]:x.alias.push(S):x.alias=[S]}}}d(u.tokens)}),e.hooks.add("wrap",function(u){if(u.type==="code-block"){for(var d="",h=0,m=u.classes.length;h<m;h++){var y=u.classes[h],b=/language-(.+)/.exec(y);if(b){d=b[1];break}}var v=e.languages[d];if(v)u.content=e.highlight(c(u.content),v,d);else if(d&&d!=="none"&&e.plugins.autoloader){var x="md-"+new Date().valueOf()+"-"+Math.floor(Math.random()*1e16);u.attributes.id=x,e.plugins.autoloader.loadLanguages(d,function(){var w=document.getElementById(x);w&&(w.innerHTML=e.highlight(w.textContent,e.languages[d],d))})}}});var a=RegExp(e.languages.markup.tag.pattern.source,"gi"),o={amp:"&",lt:"<",gt:">",quot:'"'},l=String.fromCodePoint||String.fromCharCode;function c(u){var d=u.replace(a,"");return d=d.replace(/&(\w{1,8}|#x?[\da-f]{1,8});/gi,function(h,m){if(m=m.toLowerCase(),m[0]==="#"){var y;return m[1]==="x"?y=parseInt(m.slice(2),16):y=Number(m.slice(1)),l(y)}else{var b=o[m];return b||h}}),d}e.languages.md=e.languages.markdown})(Prism);(function(e){e.languages.diff={coord:[/^(?:\*{3}|-{3}|\+{3}).*$/m,/^@@.*@@$/m,/^\d.*$/m]};var t={"deleted-sign":"-","deleted-arrow":"<","inserted-sign":"+","inserted-arrow":">",unchanged:" ",diff:"!"};Object.keys(t).forEach(function(n){var r=t[n],s=[];/^\w+$/.test(n)||s.push(/\w+/.exec(n)[0]),n==="diff"&&s.push("bold"),e.languages.diff[n]={pattern:RegExp("^(?:["+r+`].*(?:\r
?|
|(?![\\s\\S])))+`,"m"),alias:s,inside:{line:{pattern:/(.)(?=[\s\S]).*(?:\r\n?|\n)?/,lookbehind:!0},prefix:{pattern:/[\s\S]/,alias:/\w+/.exec(n)[0]}}}}),Object.defineProperty(e.languages.diff,"PREFIXES",{value:t})})(Prism);Prism.languages.go=Prism.languages.extend("clike",{string:{pattern:/(^|[^\\])"(?:\\.|[^"\\\r\n])*"|`[^`]*`/,lookbehind:!0,greedy:!0},keyword:/\b(?:break|case|chan|const|continue|default|defer|else|fallthrough|for|func|go(?:to)?|if|import|interface|map|package|range|return|select|struct|switch|type|var)\b/,boolean:/\b(?:_|false|iota|nil|true)\b/,number:[/\b0(?:b[01_]+|o[0-7_]+)i?\b/i,/\b0x(?:[a-f\d_]+(?:\.[a-f\d_]*)?|\.[a-f\d_]+)(?:p[+-]?\d+(?:_\d+)*)?i?(?!\w)/i,/(?:\b\d[\d_]*(?:\.[\d_]*)?|\B\.\d[\d_]*)(?:e[+-]?[\d_]+)?i?(?!\w)/i],operator:/[*\/%^!=]=?|\+[=+]?|-[=-]?|\|[=|]?|&(?:=|&|\^=?)?|>(?:>=?|=)?|<(?:<=?|=|-)?|:=|\.\.\./,builtin:/\b(?:append|bool|byte|cap|close|complex|complex(?:64|128)|copy|delete|error|float(?:32|64)|u?int(?:8|16|32|64)?|imag|len|make|new|panic|print(?:ln)?|real|recover|rune|string|uintptr)\b/});Prism.languages.insertBefore("go","string",{char:{pattern:/'(?:\\.|[^'\\\r\n]){0,10}'/,greedy:!0}});delete Prism.languages.go["class-name"];(function(e){var t=/[*&][^\s[\]{},]+/,n=/!(?:<[\w\-%#;/?:@&=+$,.!~*'()[\]]+>|(?:[a-zA-Z\d-]*!)?[\w\-%#;/?:@&=+$.~*'()]+)?/,r="(?:"+n.source+"(?:[ 	]+"+t.source+")?|"+t.source+"(?:[ 	]+"+n.source+")?)",s=/(?:[^\s\x00-\x08\x0e-\x1f!"#%&'*,\-:>?@[\]`{|}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]|[?:-]<PLAIN>)(?:[ \t]*(?:(?![#:])<PLAIN>|:<PLAIN>))*/.source.replace(/<PLAIN>/g,function(){return/[^\s\x00-\x08\x0e-\x1f,[\]{}\x7f-\x84\x86-\x9f\ud800-\udfff\ufffe\uffff]/.source}),i=/"(?:[^"\\\r\n]|\\.)*"|'(?:[^'\\\r\n]|\\.)*'/.source;function a(o,l){l=(l||"").replace(/m/g,"")+"m";var c=/([:\-,[{]\s*(?:\s<<prop>>[ \t]+)?)(?:<<value>>)(?=[ \t]*(?:$|,|\]|\}|(?:[\r\n]\s*)?#))/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<value>>/g,function(){return o});return RegExp(c,l)}e.languages.yaml={scalar:{pattern:RegExp(/([\-:]\s*(?:\s<<prop>>[ \t]+)?[|>])[ \t]*(?:((?:\r?\n|\r)[ \t]+)\S[^\r\n]*(?:\2[^\r\n]+)*)/.source.replace(/<<prop>>/g,function(){return r})),lookbehind:!0,alias:"string"},comment:/#.*/,key:{pattern:RegExp(/((?:^|[:\-,[{\r\n?])[ \t]*(?:<<prop>>[ \t]+)?)<<key>>(?=\s*:\s)/.source.replace(/<<prop>>/g,function(){return r}).replace(/<<key>>/g,function(){return"(?:"+s+"|"+i+")"})),lookbehind:!0,greedy:!0,alias:"atrule"},directive:{pattern:/(^[ \t]*)%.+/m,lookbehind:!0,alias:"important"},datetime:{pattern:a(/\d{4}-\d\d?-\d\d?(?:[tT]|[ \t]+)\d\d?:\d{2}:\d{2}(?:\.\d*)?(?:[ \t]*(?:Z|[-+]\d\d?(?::\d{2})?))?|\d{4}-\d{2}-\d{2}|\d\d?:\d{2}(?::\d{2}(?:\.\d*)?)?/.source),lookbehind:!0,alias:"number"},boolean:{pattern:a(/false|true/.source,"i"),lookbehind:!0,alias:"important"},null:{pattern:a(/null|~/.source,"i"),lookbehind:!0,alias:"important"},string:{pattern:a(i),lookbehind:!0,greedy:!0},number:{pattern:a(/[+-]?(?:0x[\da-f]+|0o[0-7]+|(?:\d+(?:\.\d*)?|\.\d+)(?:e[+-]?\d+)?|\.inf|\.nan)/.source,"i"),lookbehind:!0},tag:n,important:t,punctuation:/---|[:[\]{}\-,|>?]|\.\.\./},e.languages.yml=e.languages.yaml})(Prism);var mV={},gV;function HYe(){return gV||(gV=1,function(e){for(var t=/\/\*(?:[^*/]|\*(?!\/)|\/(?!\*)|<self>)*\*\//.source,n=0;n<2;n++)t=t.replace(/<self>/g,function(){return t});t=t.replace(/<self>/g,function(){return/[^\s\S]/.source}),e.languages.rust={comment:[{pattern:RegExp(/(^|[^\\])/.source+t),lookbehind:!0,greedy:!0},{pattern:/(^|[^\\:])\/\/.*/,lookbehind:!0,greedy:!0}],string:{pattern:/b?"(?:\\[\s\S]|[^\\"])*"|b?r(#*)"(?:[^"]|"(?!\1))*"\1/,greedy:!0},char:{pattern:/b?'(?:\\(?:x[0-7][\da-fA-F]|u\{(?:[\da-fA-F]_*){1,6}\}|.)|[^\\\r\n\t'])'/,greedy:!0},attribute:{pattern:/#!?\[(?:[^\[\]"]|"(?:\\[\s\S]|[^\\"])*")*\]/,greedy:!0,alias:"attr-name",inside:{string:null}},"closure-params":{pattern:/([=(,:]\s*|\bmove\s*)\|[^|]*\||\|[^|]*\|(?=\s*(?:\{|->))/,lookbehind:!0,greedy:!0,inside:{"closure-punctuation":{pattern:/^\||\|$/,alias:"punctuation"},rest:null}},"lifetime-annotation":{pattern:/'\w+/,alias:"symbol"},"fragment-specifier":{pattern:/(\$\w+:)[a-z]+/,lookbehind:!0,alias:"punctuation"},variable:/\$\w+/,"function-definition":{pattern:/(\bfn\s+)\w+/,lookbehind:!0,alias:"function"},"type-definition":{pattern:/(\b(?:enum|struct|trait|type|union)\s+)\w+/,lookbehind:!0,alias:"class-name"},"module-declaration":[{pattern:/(\b(?:crate|mod)\s+)[a-z][a-z_\d]*/,lookbehind:!0,alias:"namespace"},{pattern:/(\b(?:crate|self|super)\s*)::\s*[a-z][a-z_\d]*\b(?:\s*::(?:\s*[a-z][a-z_\d]*\s*::)*)?/,lookbehind:!0,alias:"namespace",inside:{punctuation:/::/}}],keyword:[/\b(?:Self|abstract|as|async|await|become|box|break|const|continue|crate|do|dyn|else|enum|extern|final|fn|for|if|impl|in|let|loop|macro|match|mod|move|mut|override|priv|pub|ref|return|self|static|struct|super|trait|try|type|typeof|union|unsafe|unsized|use|virtual|where|while|yield)\b/,/\b(?:bool|char|f(?:32|64)|[ui](?:8|16|32|64|128|size)|str)\b/],function:/\b[a-z_]\w*(?=\s*(?:::\s*<|\())/,macro:{pattern:/\b\w+!/,alias:"property"},constant:/\b[A-Z_][A-Z_\d]+\b/,"class-name":/\b[A-Z]\w*\b/,namespace:{pattern:/(?:\b[a-z][a-z_\d]*\s*::\s*)*\b[a-z][a-z_\d]*\s*::(?!\s*<)/,inside:{punctuation:/::/}},number:/\b(?:0x[\dA-Fa-f](?:_?[\dA-Fa-f])*|0o[0-7](?:_?[0-7])*|0b[01](?:_?[01])*|(?:(?:\d(?:_?\d)*)?\.)?\d(?:_?\d)*(?:[Ee][+-]?\d+)?)(?:_?(?:f32|f64|[iu](?:8|16|32|64|size)?))?\b/,boolean:/\b(?:false|true)\b/,punctuation:/->|\.\.=|\.{1,3}|::|[{}[\];(),:]/,operator:/[-+*\/%!^]=?|=[=>]?|&[&=]?|\|[|=]?|<<?=?|>>?=?|[@?]/},e.languages.rust["closure-params"].inside.rest=e.languages.rust,e.languages.rust.attribute.inside.string=e.languages.rust.string}(Prism)),mV}HYe();Prism.languages.sql={comment:{pattern:/(^|[^\\])(?:\/\*[\s\S]*?\*\/|(?:--|\/\/|#).*)/,lookbehind:!0},variable:[{pattern:/@(["'`])(?:\\[\s\S]|(?!\1)[^\\])+\1/,greedy:!0},/@[\w.$]+/],string:{pattern:/(^|[^@\\])("|')(?:\\[\s\S]|(?!\2)[^\\]|\2\2)*\2/,greedy:!0,lookbehind:!0},identifier:{pattern:/(^|[^@\\])`(?:\\[\s\S]|[^`\\]|``)*`/,greedy:!0,lookbehind:!0,inside:{punctuation:/^`|`$/}},function:/\b(?:AVG|COUNT|FIRST|FORMAT|LAST|LCASE|LEN|MAX|MID|MIN|MOD|NOW|ROUND|SUM|UCASE)(?=\s*\()/i,keyword:/\b(?:ACTION|ADD|AFTER|ALGORITHM|ALL|ALTER|ANALYZE|ANY|APPLY|AS|ASC|AUTHORIZATION|AUTO_INCREMENT|BACKUP|BDB|BEGIN|BERKELEYDB|BIGINT|BINARY|BIT|BLOB|BOOL|BOOLEAN|BREAK|BROWSE|BTREE|BULK|BY|CALL|CASCADED?|CASE|CHAIN|CHAR(?:ACTER|SET)?|CHECK(?:POINT)?|CLOSE|CLUSTERED|COALESCE|COLLATE|COLUMNS?|COMMENT|COMMIT(?:TED)?|COMPUTE|CONNECT|CONSISTENT|CONSTRAINT|CONTAINS(?:TABLE)?|CONTINUE|CONVERT|CREATE|CROSS|CURRENT(?:_DATE|_TIME|_TIMESTAMP|_USER)?|CURSOR|CYCLE|DATA(?:BASES?)?|DATE(?:TIME)?|DAY|DBCC|DEALLOCATE|DEC|DECIMAL|DECLARE|DEFAULT|DEFINER|DELAYED|DELETE|DELIMITERS?|DENY|DESC|DESCRIBE|DETERMINISTIC|DISABLE|DISCARD|DISK|DISTINCT|DISTINCTROW|DISTRIBUTED|DO|DOUBLE|DROP|DUMMY|DUMP(?:FILE)?|DUPLICATE|ELSE(?:IF)?|ENABLE|ENCLOSED|END|ENGINE|ENUM|ERRLVL|ERRORS|ESCAPED?|EXCEPT|EXEC(?:UTE)?|EXISTS|EXIT|EXPLAIN|EXTENDED|FETCH|FIELDS|FILE|FILLFACTOR|FIRST|FIXED|FLOAT|FOLLOWING|FOR(?: EACH ROW)?|FORCE|FOREIGN|FREETEXT(?:TABLE)?|FROM|FULL|FUNCTION|GEOMETRY(?:COLLECTION)?|GLOBAL|GOTO|GRANT|GROUP|HANDLER|HASH|HAVING|HOLDLOCK|HOUR|IDENTITY(?:COL|_INSERT)?|IF|IGNORE|IMPORT|INDEX|INFILE|INNER|INNODB|INOUT|INSERT|INT|INTEGER|INTERSECT|INTERVAL|INTO|INVOKER|ISOLATION|ITERATE|JOIN|KEYS?|KILL|LANGUAGE|LAST|LEAVE|LEFT|LEVEL|LIMIT|LINENO|LINES|LINESTRING|LOAD|LOCAL|LOCK|LONG(?:BLOB|TEXT)|LOOP|MATCH(?:ED)?|MEDIUM(?:BLOB|INT|TEXT)|MERGE|MIDDLEINT|MINUTE|MODE|MODIFIES|MODIFY|MONTH|MULTI(?:LINESTRING|POINT|POLYGON)|NATIONAL|NATURAL|NCHAR|NEXT|NO|NONCLUSTERED|NULLIF|NUMERIC|OFF?|OFFSETS?|ON|OPEN(?:DATASOURCE|QUERY|ROWSET)?|OPTIMIZE|OPTION(?:ALLY)?|ORDER|OUT(?:ER|FILE)?|OVER|PARTIAL|PARTITION|PERCENT|PIVOT|PLAN|POINT|POLYGON|PRECEDING|PRECISION|PREPARE|PREV|PRIMARY|PRINT|PRIVILEGES|PROC(?:EDURE)?|PUBLIC|PURGE|QUICK|RAISERROR|READS?|REAL|RECONFIGURE|REFERENCES|RELEASE|RENAME|REPEAT(?:ABLE)?|REPLACE|REPLICATION|REQUIRE|RESIGNAL|RESTORE|RESTRICT|RETURN(?:ING|S)?|REVOKE|RIGHT|ROLLBACK|ROUTINE|ROW(?:COUNT|GUIDCOL|S)?|RTREE|RULE|SAVE(?:POINT)?|SCHEMA|SECOND|SELECT|SERIAL(?:IZABLE)?|SESSION(?:_USER)?|SET(?:USER)?|SHARE|SHOW|SHUTDOWN|SIMPLE|SMALLINT|SNAPSHOT|SOME|SONAME|SQL|START(?:ING)?|STATISTICS|STATUS|STRIPED|SYSTEM_USER|TABLES?|TABLESPACE|TEMP(?:ORARY|TABLE)?|TERMINATED|TEXT(?:SIZE)?|THEN|TIME(?:STAMP)?|TINY(?:BLOB|INT|TEXT)|TOP?|TRAN(?:SACTIONS?)?|TRIGGER|TRUNCATE|TSEQUAL|TYPES?|UNBOUNDED|UNCOMMITTED|UNDEFINED|UNION|UNIQUE|UNLOCK|UNPIVOT|UNSIGNED|UPDATE(?:TEXT)?|USAGE|USE|USER|USING|VALUES?|VAR(?:BINARY|CHAR|CHARACTER|YING)|VIEW|WAITFOR|WARNINGS|WHEN|WHERE|WHILE|WITH(?: ROLLUP|IN)?|WORK|WRITE(?:TEXT)?|YEAR)\b/i,boolean:/\b(?:FALSE|NULL|TRUE)\b/i,number:/\b0x[\da-f]+\b|\b\d+(?:\.\d*)?|\B\.\d+\b/i,operator:/[-+*\/=%^~]|&&?|\|\|?|!=?|<(?:=>?|<|>)?|>[>=]?|\b(?:AND|BETWEEN|DIV|ILIKE|IN|IS|LIKE|NOT|OR|REGEXP|RLIKE|SOUNDS LIKE|XOR)\b/i,punctuation:/[;[\]()`,.]/};const GYe=({interactionId:e,codeBlockId:t,language:n,originalContent:r,editedContent:s,filepath:i,disabled:a,onEditModeChange:o})=>{const[l,c]=E.useState(!1),u=E.useCallback(y=>{if(y.stopPropagation(),a||!r||!e||!t){Te.info("Code editing is currently disabled.");return}c(!0),o==null||o(!0)},[a,r,e,t,o]),d=E.useCallback(()=>{if(!e||!t){Te.error("Missing interaction or code block ID");return}if(s.trim()===""){Te.error("Code cannot be empty");return}Re.emit(zi.editCodeBlockRequest,{interactionId:e,codeBlockId:t,language:n,filepath:i,originalContent:r,newContent:s}),c(!1),o==null||o(!1),Te.success("Code block edited successfully")},[e,t,n,i,r,s,o]),h=E.useCallback(()=>{c(!1),o==null||o(!1)},[o]);return r&&r.trim().length>0&&e&&t?l?f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsxs(ct,{size:"sm",onClick:d,className:"h-6 px-2 text-xs",children:[f.jsx(Uu,{className:"h-3 w-3 mr-1"}),"Save"]}),f.jsxs(ct,{size:"sm",variant:"outline",onClick:h,className:"h-6 px-2 text-xs",children:[f.jsx(Pi,{className:"h-3 w-3 mr-1"}),"Cancel"]})]}):f.jsx(qn,{tooltipText:"Edit Code",onClick:u,"aria-label":"Edit code block",disabled:a||!r||!e||!t,icon:f.jsx(YP,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"}):null},KYe=({code:e,language:t,onChange:n})=>{const r=E.useCallback(i=>i?{javascript:Ks.languages.javascript,js:Ks.languages.javascript,typescript:Ks.languages.typescript,ts:Ks.languages.typescript,python:Ks.languages.python,py:Ks.languages.python,bash:Ks.languages.bash,sh:Ks.languages.bash,json:Ks.languages.json,markdown:Ks.languages.markdown,md:Ks.languages.markdown,diff:Ks.languages.diff,go:Ks.languages.go,yaml:Ks.languages.yaml,yml:Ks.languages.yaml,rust:Ks.languages.rust,rs:Ks.languages.rust,sql:Ks.languages.sql}[i.toLowerCase()]||Ks.languages.plaintext||Ks.languages.text:Ks.languages.plaintext||Ks.languages.text,[]),s=E.useCallback(i=>{try{const a=r(t);return Ks.highlight(i,a,t||"text")}catch(a){return console.error("Syntax highlighting error:",a),i}},[t,r]);return f.jsx(zYe,{value:e,onValueChange:n,highlight:s,padding:16,tabSize:2,insertSpaces:!0,style:{fontFamily:'"Fira Code", "Fira Mono", "Consolas", "Monaco", monospace',fontSize:14,lineHeight:1.5,minHeight:"100px",backgroundColor:"transparent",outline:"none"}})},YYe=new Vo({html:!1,linkify:!0,breaks:!0});class ZYe{constructor(){ue(this,"id","core-canvas-edit-codeblock-action");ue(this,"eventUnsubscribers",[])}async initialize(t){const n=t.on(zi.editCodeBlockRequest,async r=>{await this.handleCodeBlockEdit(r.interactionId,r.codeBlockId,r.language,r.filepath,r.originalContent,r.newContent)});this.eventUnsubscribers.push(n)}parseMarkdownForCodeBlocks(t){var n,r,s;if(!t)return[];try{const i=YYe.parse(t,{}),a=[];for(const o of i)if(o.type==="fence"){const l=((n=o.info)==null?void 0:n.trim())||"";let c,u;if(l.includes(":")){const[m,...y]=l.split(":");c=m||void 0,u=y.join(":")||void 0}else c=l.split(" ")[0]||void 0;const d=((r=o.map)==null?void 0:r[0])||0,h=((s=o.map)==null?void 0:s[1])||0;a.push({type:"block",lang:c,code:o.content,filepath:u,startPos:d,endPos:h})}return a}catch(i){return console.error("Markdown parsing error:",i),[]}}findCodeBlockByContent(t,n,r,s){const i=this.parseMarkdownForCodeBlocks(t);for(let a=0;a<i.length;a++){const o=i[a];if(o.code===n&&o.lang===r&&o.filepath===s)return a}for(let a=0;a<i.length;a++)if(i[a].code===n)return a;return-1}replaceCodeBlockInMarkdown(t,n,r,s,i){const a=t.split(`
`),o=this.parseMarkdownForCodeBlocks(t);if(n<0||n>=o.length)throw new Error(`Code block index ${n} not found`);const l=o[n],c=l.startPos,u=l.endPos,d=s||"",h=i?`:${i}`:"",m=[`\`\`\`${d}${h}`,...r.split(`
`),"```"];return[...a.slice(0,c),...m,...a.slice(u)].join(`
`)}async handleCodeBlockEdit(t,n,r,s,i,a){var o;try{const l=un.getState(),c=l.interactions.find(k=>k.id===t);if(!c)throw new Error("Original interaction not found");if(c.status!=="COMPLETED")throw new Error("Can only edit completed interactions");if(!c.response||typeof c.response!="string")throw new Error("Invalid response content");const u=this.findCodeBlockByContent(c.response,i||"",r,s);if(u===-1)throw new Error("Code block not found in response");const d=this.replaceCodeBlockInMarkdown(c.response,u,a||"",r,s),h=qr(),m={...c,id:h,response:d,parentId:null,index:c.index,metadata:{...c.metadata,editedResponse:!0,editedFromId:c.id,editedCodeBlock:{codeBlockId:n,language:r,filepath:s,originalContent:i,newContent:a}},endedAt:new Date};l._addInteractionToState(m);const y=l.interactions.filter(k=>k.parentId===c.id),b=[];let v=c;for(;v;){b.push(v);const k=(o=v.metadata)==null?void 0:o.editedFromId;k?v=l.interactions.find(C=>C.id===k):v=void 0}const x=b.sort((k,C)=>{var N,I;const T=((N=k.startedAt)==null?void 0:N.getTime())??0,A=((I=C.startedAt)==null?void 0:I.getTime())??0;return T-A}),w=x.map(async(k,C)=>{const T={parentId:h,index:C,metadata:{...k.metadata,originalVersion:C===0}};return l._updateInteractionInState(k.id,T),bt.saveInteraction({...k,...T})}),S=y.map(async k=>{const C={parentId:h,index:x.length+k.index};return l._updateInteractionInState(k.id,C),bt.saveInteraction({...k,...C})});await Promise.all([bt.saveInteraction(m),...w,...S])}catch(l){throw console.error("[EditCodeBlockControlModule] Failed to edit code block:",l),l}}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>{if(!n.codeBlockContent||!n.interactionId)return null;const r=un.getState(),s=r.status,i=r.interactions.find(l=>l.id===n.interactionId),a=i&&i.status==="COMPLETED"&&i.response&&typeof i.response=="string"&&s!=="streaming"&&(i.type==="message.user_assistant"||i.type==="message.assistant_regen")&&n.codeBlockContent&&n.codeBlockContent.trim().length>0;if(!a)return null;const o=n.blockId||`fallback-${Date.now()}`;return Ve.createElement(GYe,{interactionId:n.interactionId,codeBlockId:o,language:n.codeBlockLang,filepath:n.codeBlockFilepath,originalContent:n.codeBlockContent||"",editedContent:n.codeBlockEditedContent||n.codeBlockContent||"",disabled:!a,onEditModeChange:n.onEditModeChange})}})}async cleanup(){this.eventUnsubscribers.forEach(t=>t()),this.eventUnsubscribers=[]}async destroy(){await this.cleanup()}}const XYe=({isFolded:e,toggleFold:t,canFold:n})=>{if(!n)return null;const r=s=>{s.stopPropagation(),t()};return f.jsx(qn,{tooltipText:e?"Unfold":"Fold",onClick:r,"aria-label":e?"Unfold response":"Fold response",icon:e?f.jsx(Ql,{}):f.jsx(Xh,{}),iconClassName:"h-3.5 w-3.5",className:"h-5 w-5"})};class JYe{constructor(){ue(this,"id","core-canvas-fold-interaction")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.toggleFold||n.isFolded===void 0?null:Ve.createElement(XYe,{isFolded:n.isFolded,toggleFold:n.toggleFold,canFold:!0})})}destroy(t){}}const QYe=({context:e})=>{const t=xT(e.responseContent||""),n=E.useMemo(()=>{const s=[];return t.forEach(i=>{if(typeof i=="object"&&i.type==="block"){const a=i;a.filepath&&a.filepath.trim()&&s.push({filepath:a.filepath,code:a.code,lang:a.lang})}}),s},[t]),r=E.useCallback(async()=>{var s;if(n.length===0){Te.info("No code blocks with filepaths found to download");return}try{const i=new fD,a=new Set;n.forEach(({filepath:h,code:m})=>{const y=h.replace(/^[\/\\]+/,"").replace(/\\/g,"/"),b=y.split("/");if(b.length>1)for(let w=1;w<b.length;w++){const S=b.slice(0,w).join("/");a.has(S)||(i.folder(S),a.add(S))}let v=y,x=1;for(;i.file(v);){const w=y.lastIndexOf(".");if(w>0){const S=y.substring(0,w),k=y.substring(w);v=`${S}_${x}${k}`}else v=`${y}_${x}`;x++}i.file(v,m)});const o=await i.generateAsync({type:"blob",compression:"DEFLATE",compressionOptions:{level:6}}),l=URL.createObjectURL(o),c=document.createElement("a");c.href=l;const u=new Date().toISOString().slice(0,19).replace(/[:.]/g,"-"),d=((s=e.interactionId)==null?void 0:s.slice(0,8))||"unknown";c.download=`codeblocks_${d}_${u}.zip`,document.body.appendChild(c),c.click(),document.body.removeChild(c),URL.revokeObjectURL(l),Te.success(`Downloaded ${n.length} code files as ZIP`)}catch(i){console.error("ZIP download failed:",i),Te.error("Failed to create ZIP file")}},[n,e.interactionId]);return n.length===0?null:f.jsx(qn,{tooltipText:`Download ${n.length} code files as ZIP`,onClick:r,"aria-label":"Download code blocks as ZIP file",icon:f.jsx(xH,{}),iconClassName:"h-4 w-4",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class eZe{constructor(){ue(this,"id","core-interaction-zip-download")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"interaction",targetSlot:"header-actions",renderer:n=>!n.interactionId||!n.responseContent?null:Ve.createElement(QYe,{context:n})})}destroy(t){}}const tZe=({interactionId:e,codeBlockId:t,language:n,codeToCopy:r,disabled:s})=>{const[i,a]=E.useState(!1),o=E.useCallback(async l=>{l.stopPropagation(),!(s||!r)&&(Re.emit(zi.copyCodeBlockRequest,{interactionId:e,codeBlockId:t,language:n,content:r}),a(!0),setTimeout(()=>a(!1),1500))},[e,t,n,r,s]);return f.jsx(qn,{tooltipText:"Copy Code",onClick:o,"aria-label":"Copy code block",disabled:s||!r,icon:i?f.jsx(co,{className:"text-green-500"}):f.jsx(wE,{}),className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class nZe{constructor(){ue(this,"id","core-codeblock-copy")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>Ve.createElement(tZe,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToCopy:n.codeBlockContent??"",disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const rZe=({isFolded:e,toggleFold:t})=>{const n=r=>{r.stopPropagation(),t()};return f.jsx(qn,{tooltipText:e?"Unfold Code":"Fold Code",onClick:n,"aria-label":e?"Unfold code block":"Fold code block",icon:f.jsx(vE,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"})};class sZe{constructor(){ue(this,"id","core-codeblock-fold")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>n.toggleFold===void 0||n.isFolded===void 0?null:Ve.createElement(rZe,{isFolded:n.isFolded,toggleFold:n.toggleFold})})}destroy(t){}}const iZe=({interactionId:e,codeBlockId:t,language:n,codeToDownload:r,filepath:s,disabled:i})=>{const a=E.useCallback(l=>{if(l.stopPropagation(),!(i||!r))try{let c;if(s){const m=s.split("/");c=m[m.length-1]}else c=`code${aZe(n)}`;const u=new Blob([r],{type:"text/plain"}),d=URL.createObjectURL(u),h=document.createElement("a");h.href=d,h.download=c,document.body.appendChild(h),h.click(),document.body.removeChild(h),URL.revokeObjectURL(d),Te.success(`Downloaded ${c}`)}catch(c){console.error("Download failed:",c),Te.error("Failed to download file")}},[e,t,n,r,s,i]);return s||r&&r.trim().length>1e3?f.jsx(qn,{tooltipText:"Download File",onClick:a,"aria-label":"Download code as file",disabled:i||!r,icon:f.jsx(Tc,{}),iconClassName:"h-3.5 w-3.5",className:"h-6 w-6 text-muted-foreground hover:text-foreground"}):null};function aZe(e){return e&&{javascript:".js",js:".js",typescript:".ts",ts:".ts",tsx:".tsx",jsx:".jsx",python:".py",py:".py",java:".java",c:".c",cpp:".cpp",cxx:".cxx",cc:".cc","c++":".cpp",csharp:".cs",cs:".cs",php:".php",ruby:".rb",rb:".rb",go:".go",rust:".rs",rs:".rs",swift:".swift",kotlin:".kt",kt:".kt",scala:".scala",html:".html",css:".css",scss:".scss",sass:".sass",less:".less",json:".json",xml:".xml",yaml:".yaml",yml:".yml",toml:".toml",ini:".ini",conf:".conf",config:".config",sh:".sh",bash:".sh",zsh:".zsh",fish:".fish",powershell:".ps1",ps1:".ps1",bat:".bat",cmd:".cmd",sql:".sql",r:".r",matlab:".m",octave:".m",lua:".lua",perl:".pl",vim:".vim",dockerfile:"Dockerfile",makefile:"Makefile",markdown:".md",md:".md",tex:".tex",latex:".tex"}[e.toLowerCase()]||".txt"}class oZe{constructor(){ue(this,"id","core-codeblock-download")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"codeblock",targetSlot:"codeblock-header-actions",renderer:n=>Ve.createElement(iZe,{interactionId:n.interactionId,codeBlockId:n.codeBlockId,language:n.codeBlockLang,codeToDownload:n.codeBlockContent??"",filepath:n.codeBlockFilepath,disabled:!n.codeBlockContent||n.codeBlockContent.trim()===""})})}destroy(t){}}const lZe=({toolCall:e})=>{const[t,n]=E.useState(!0),r=()=>n(i=>!i),s=E.useMemo(()=>{try{return JSON.stringify(e.args,null,2)}catch{return String(e.args)}},[e.args]);return f.jsxs("div",{className:"my-2 p-2 border border-amber-500/30 bg-amber-500/10 rounded-md text-xs",children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsxs("span",{className:"font-semibold text-amber-700 dark:text-amber-300",children:["Tool Call: ",f.jsx("code",{className:"font-mono",children:e.toolName})]}),f.jsx(qn,{tooltipText:t?"Show Args":"Hide Args",onClick:r,"aria-label":t?"Show arguments":"Hide arguments",icon:t?f.jsx(Ql,{}):f.jsx(Xh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&f.jsx(Qy,{lang:"json",code:s})]})},cZe=({toolResult:e})=>{const[t,n]=E.useState(!0),r=()=>n(a=>!a),s=E.useMemo(()=>{try{return typeof e.result=="object"&&e.result!==null&&e.result._isError===!0?`Error: ${e.result.error}`:JSON.stringify(e.result,null,2)}catch{return String(e.result)}},[e.result]),i=typeof e.result=="object"&&e.result!==null&&e.result._isError===!0;return f.jsxs("div",{className:Ze("my-2 p-2 border rounded-md text-xs",i?"border-destructive/30 bg-destructive/10":"border-green-500/30 bg-green-500/10"),children:[f.jsxs("div",{className:"flex items-center justify-between mb-1",children:[f.jsxs("span",{className:Ze("font-semibold",i?"text-destructive":"text-green-700 dark:text-green-300"),children:["Tool Result: ",f.jsx("code",{className:"font-mono",children:e.toolName})]}),f.jsx(qn,{tooltipText:t?"Show Result":"Hide Result",onClick:r,"aria-label":t?"Show result":"Hide result",icon:t?f.jsx(Ql,{}):f.jsx(Xh,{}),iconClassName:"h-3 w-3",className:"h-5 w-5 text-muted-foreground"})]}),!t&&f.jsx(Qy,{lang:i?"text":"json",code:s})]})},uZe=({interactionId:e,toolCall:t,toolResult:n})=>f.jsxs("div",{className:"tool-call-step my-1","data-interaction-id":e,"data-tool-call-id":t.toolCallId,children:[f.jsx(lZe,{toolCall:t}),n&&f.jsx(cZe,{toolResult:n})]});class dZe{constructor(){ue(this,"id","core-tool-call-step-display")}async initialize(t){}register(t){t.registerCanvasControl({id:this.id,type:"tool-call-step",targetSlot:"tool-call-content",renderer:n=>!n.interactionId||!n.toolCall?(console.warn("[ToolCallStepControlModule] Missing interactionId or toolCall in context"),null):Ve.createElement(uZe,{interactionId:n.interactionId,toolCall:n.toolCall,toolResult:n.toolResult})})}destroy(t){}}const fZe=({lang:e,code:t,filepath:n,isStreaming:r=!1,interactionId:s,blockId:i})=>{const{foldStreamingCodeBlocks:a}=pr(yn(C=>({foldStreamingCodeBlocks:C.foldStreamingCodeBlocks}))),[o,l]=E.useState(r?a:!1),[c,u]=E.useState(!1),[d,h]=E.useState(t);E.useEffect(()=>{c||h(t)},[t,c]);const m=E.useRef(null),y=Wi(yn(C=>Object.values(C.canvasControls))),b=E.useCallback((C,T,A,N,I,O)=>y.filter(B=>B.type==="codeblock"&&B.targetSlot===C&&B.renderer).map(B=>{if(B.renderer){const D={codeBlockContent:T,codeBlockEditedContent:d,codeBlockLang:A,codeBlockFilepath:N,isFolded:I,toggleFold:O,canvasContextType:"codeblock",interactionId:s,blockId:i,onEditModeChange:u};return f.jsx(Ve.Fragment,{children:B.renderer(D)},B.id)}return null}).filter(Boolean),[y,d,s,u]),v=E.useCallback(()=>{if(m.current&&t)try{m.current.style.whiteSpace!=="pre-wrap"&&(m.current.style.whiteSpace="pre-wrap"),m.current.textContent=t,Ks.highlightElement(m.current)}catch(C){console.error("Prism highlight error:",C),m.current.textContent=t}else m.current&&(m.current.textContent="")},[t]);E.useEffect(()=>{o||v()},[t,e,o,v]);const x=()=>{const C=o;l(T=>!T),C&&setTimeout(v,0)},w=e?`language-${e}`:"language-plaintext",S=E.useMemo(()=>t?t.split(`
`).slice(0,3).join(`
`):"",[t]),k=b("codeblock-header-actions",t,e,n,o,x);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between px-3 py-2 border border-b-0 border-border bg-muted/50 rounded-t-lg",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:e?e.toUpperCase():"CODE"}),n&&f.jsx("div",{className:"text-xs text-muted-foreground font-mono",children:n}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:k})]}),f.jsx("div",{})]}),!o&&!c&&f.jsx("div",{className:"overflow-hidden w-full",children:f.jsx("pre",{className:"overflow-x-auto w-full relative overflow-wrap-anywhere border border-border rounded-b-lg bg-muted/20",children:f.jsx("code",{ref:m,className:w+" block p-4 font-mono text-sm leading-relaxed"})})}),!o&&c&&f.jsx("div",{className:"overflow-hidden w-full border border-border rounded-b-lg bg-muted/20",children:f.jsx(KYe,{code:d,language:e,onChange:h})}),o&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border border border-t-0 border-border rounded-b-lg bg-muted/10 hover:bg-muted/20 transition-colors",onClick:x,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:S})})]})},m6=E.memo(fZe);class hZe{constructor(){ue(this,"id","core-block-renderer-code");ue(this,"unregisterCallback")}async initialize(){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={id:this.id,supportedLanguages:void 0,priority:0,renderer:r=>Ve.createElement(m6,{lang:r.lang,code:r.code,filepath:r.filepath,isStreaming:r.isStreaming,interactionId:r.interactionId,blockId:r.blockId})};this.unregisterCallback=t.registerBlockRenderer(n)}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=void 0)}}var ZC={exports:{}},pZe=ZC.exports,yV;function mZe(){return yV||(yV=1,function(e,t){(function(n,r){e.exports=r()})(pZe,function(){var n=1e3,r=6e4,s=36e5,i="millisecond",a="second",o="minute",l="hour",c="day",u="week",d="month",h="quarter",m="year",y="date",b="Invalid Date",v=/^(\d{4})[-/]?(\d{1,2})?[-/]?(\d{0,2})[Tt\s]*(\d{1,2})?:?(\d{1,2})?:?(\d{1,2})?[.:]?(\d+)?$/,x=/\[([^\]]+)]|Y{1,4}|M{1,4}|D{1,2}|d{1,4}|H{1,2}|h{1,2}|a|A|m{1,2}|s{1,2}|Z{1,2}|SSS/g,w={name:"en",weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),ordinal:function(P){var K=["th","st","nd","rd"],U=P%100;return"["+P+(K[(U-20)%10]||K[U]||K[0])+"]"}},S=function(P,K,U){var V=String(P);return!V||V.length>=K?P:""+Array(K+1-V.length).join(U)+P},k={s:S,z:function(P){var K=-P.utcOffset(),U=Math.abs(K),V=Math.floor(U/60),L=U%60;return(K<=0?"+":"-")+S(V,2,"0")+":"+S(L,2,"0")},m:function P(K,U){if(K.date()<U.date())return-P(U,K);var V=12*(U.year()-K.year())+(U.month()-K.month()),L=K.clone().add(V,d),te=U-L<0,W=K.clone().add(V+(te?-1:1),d);return+(-(V+(U-L)/(te?L-W:W-L))||0)},a:function(P){return P<0?Math.ceil(P)||0:Math.floor(P)},p:function(P){return{M:d,y:m,w:u,d:c,D:y,h:l,m:o,s:a,ms:i,Q:h}[P]||String(P||"").toLowerCase().replace(/s$/,"")},u:function(P){return P===void 0}},C="en",T={};T[C]=w;var A="$isDayjsObject",N=function(P){return P instanceof D||!(!P||!P[A])},I=function P(K,U,V){var L;if(!K)return C;if(typeof K=="string"){var te=K.toLowerCase();T[te]&&(L=te),U&&(T[te]=U,L=te);var W=K.split("-");if(!L&&W.length>1)return P(W[0])}else{var Q=K.name;T[Q]=K,L=Q}return!V&&L&&(C=L),L||!V&&C},O=function(P,K){if(N(P))return P.clone();var U=typeof K=="object"?K:{};return U.date=P,U.args=arguments,new D(U)},B=k;B.l=I,B.i=N,B.w=function(P,K){return O(P,{locale:K.$L,utc:K.$u,x:K.$x,$offset:K.$offset})};var D=function(){function P(U){this.$L=I(U.locale,null,!0),this.parse(U),this.$x=this.$x||U.x||{},this[A]=!0}var K=P.prototype;return K.parse=function(U){this.$d=function(V){var L=V.date,te=V.utc;if(L===null)return new Date(NaN);if(B.u(L))return new Date;if(L instanceof Date)return new Date(L);if(typeof L=="string"&&!/Z$/i.test(L)){var W=L.match(v);if(W){var Q=W[2]-1||0,ee=(W[7]||"0").substring(0,3);return te?new Date(Date.UTC(W[1],Q,W[3]||1,W[4]||0,W[5]||0,W[6]||0,ee)):new Date(W[1],Q,W[3]||1,W[4]||0,W[5]||0,W[6]||0,ee)}}return new Date(L)}(U),this.init()},K.init=function(){var U=this.$d;this.$y=U.getFullYear(),this.$M=U.getMonth(),this.$D=U.getDate(),this.$W=U.getDay(),this.$H=U.getHours(),this.$m=U.getMinutes(),this.$s=U.getSeconds(),this.$ms=U.getMilliseconds()},K.$utils=function(){return B},K.isValid=function(){return this.$d.toString()!==b},K.isSame=function(U,V){var L=O(U);return this.startOf(V)<=L&&L<=this.endOf(V)},K.isAfter=function(U,V){return O(U)<this.startOf(V)},K.isBefore=function(U,V){return this.endOf(V)<O(U)},K.$g=function(U,V,L){return B.u(U)?this[V]:this.set(L,U)},K.unix=function(){return Math.floor(this.valueOf()/1e3)},K.valueOf=function(){return this.$d.getTime()},K.startOf=function(U,V){var L=this,te=!!B.u(V)||V,W=B.p(U),Q=function(Ce,qe){var Qe=B.w(L.$u?Date.UTC(L.$y,qe,Ce):new Date(L.$y,qe,Ce),L);return te?Qe:Qe.endOf(c)},ee=function(Ce,qe){return B.w(L.toDate()[Ce].apply(L.toDate("s"),(te?[0,0,0,0]:[23,59,59,999]).slice(qe)),L)},re=this.$W,pe=this.$M,de=this.$D,Oe="set"+(this.$u?"UTC":"");switch(W){case m:return te?Q(1,0):Q(31,11);case d:return te?Q(1,pe):Q(0,pe+1);case u:var Fe=this.$locale().weekStart||0,Se=(re<Fe?re+7:re)-Fe;return Q(te?de-Se:de+(6-Se),pe);case c:case y:return ee(Oe+"Hours",0);case l:return ee(Oe+"Minutes",1);case o:return ee(Oe+"Seconds",2);case a:return ee(Oe+"Milliseconds",3);default:return this.clone()}},K.endOf=function(U){return this.startOf(U,!1)},K.$set=function(U,V){var L,te=B.p(U),W="set"+(this.$u?"UTC":""),Q=(L={},L[c]=W+"Date",L[y]=W+"Date",L[d]=W+"Month",L[m]=W+"FullYear",L[l]=W+"Hours",L[o]=W+"Minutes",L[a]=W+"Seconds",L[i]=W+"Milliseconds",L)[te],ee=te===c?this.$D+(V-this.$W):V;if(te===d||te===m){var re=this.clone().set(y,1);re.$d[Q](ee),re.init(),this.$d=re.set(y,Math.min(this.$D,re.daysInMonth())).$d}else Q&&this.$d[Q](ee);return this.init(),this},K.set=function(U,V){return this.clone().$set(U,V)},K.get=function(U){return this[B.p(U)]()},K.add=function(U,V){var L,te=this;U=Number(U);var W=B.p(V),Q=function(pe){var de=O(te);return B.w(de.date(de.date()+Math.round(pe*U)),te)};if(W===d)return this.set(d,this.$M+U);if(W===m)return this.set(m,this.$y+U);if(W===c)return Q(1);if(W===u)return Q(7);var ee=(L={},L[o]=r,L[l]=s,L[a]=n,L)[W]||1,re=this.$d.getTime()+U*ee;return B.w(re,this)},K.subtract=function(U,V){return this.add(-1*U,V)},K.format=function(U){var V=this,L=this.$locale();if(!this.isValid())return L.invalidDate||b;var te=U||"YYYY-MM-DDTHH:mm:ssZ",W=B.z(this),Q=this.$H,ee=this.$m,re=this.$M,pe=L.weekdays,de=L.months,Oe=L.meridiem,Fe=function(qe,Qe,We,je){return qe&&(qe[Qe]||qe(V,te))||We[Qe].slice(0,je)},Se=function(qe){return B.s(Q%12||12,qe,"0")},Ce=Oe||function(qe,Qe,We){var je=qe<12?"AM":"PM";return We?je.toLowerCase():je};return te.replace(x,function(qe,Qe){return Qe||function(We){switch(We){case"YY":return String(V.$y).slice(-2);case"YYYY":return B.s(V.$y,4,"0");case"M":return re+1;case"MM":return B.s(re+1,2,"0");case"MMM":return Fe(L.monthsShort,re,de,3);case"MMMM":return Fe(de,re);case"D":return V.$D;case"DD":return B.s(V.$D,2,"0");case"d":return String(V.$W);case"dd":return Fe(L.weekdaysMin,V.$W,pe,2);case"ddd":return Fe(L.weekdaysShort,V.$W,pe,3);case"dddd":return pe[V.$W];case"H":return String(Q);case"HH":return B.s(Q,2,"0");case"h":return Se(1);case"hh":return Se(2);case"a":return Ce(Q,ee,!0);case"A":return Ce(Q,ee,!1);case"m":return String(ee);case"mm":return B.s(ee,2,"0");case"s":return String(V.$s);case"ss":return B.s(V.$s,2,"0");case"SSS":return B.s(V.$ms,3,"0");case"Z":return W}return null}(qe)||W.replace(":","")})},K.utcOffset=function(){return 15*-Math.round(this.$d.getTimezoneOffset()/15)},K.diff=function(U,V,L){var te,W=this,Q=B.p(V),ee=O(U),re=(ee.utcOffset()-this.utcOffset())*r,pe=this-ee,de=function(){return B.m(W,ee)};switch(Q){case m:te=de()/12;break;case d:te=de();break;case h:te=de()/3;break;case u:te=(pe-re)/6048e5;break;case c:te=(pe-re)/864e5;break;case l:te=pe/s;break;case o:te=pe/r;break;case a:te=pe/n;break;default:te=pe}return L?te:B.a(te)},K.daysInMonth=function(){return this.endOf(d).$D},K.$locale=function(){return T[this.$L]},K.locale=function(U,V){if(!U)return this.$L;var L=this.clone(),te=I(U,V,!0);return te&&(L.$L=te),L},K.clone=function(){return B.w(this.$d,this)},K.toDate=function(){return new Date(this.valueOf())},K.toJSON=function(){return this.isValid()?this.toISOString():null},K.toISOString=function(){return this.$d.toISOString()},K.toString=function(){return this.$d.toUTCString()},P}(),H=D.prototype;return O.prototype=H,[["$ms",i],["$s",a],["$m",o],["$H",l],["$W",c],["$M",d],["$y",m],["$D",y]].forEach(function(P){H[P[1]]=function(K){return this.$g(K,P[0],P[1])}}),O.extend=function(P,K){return P.$i||(P(K,D,O),P.$i=!0),O},O.locale=I,O.isDayjs=N,O.unix=function(P){return O(1e3*P)},O.en=T[C],O.Ls=T,O.p={},O})}(ZC)),ZC.exports}var gZe=mZe();const yZe=da(gZe),XC={min:{r:0,g:0,b:0,s:0,l:0,a:0},max:{r:255,g:255,b:255,h:360,s:100,l:100,a:1},clamp:{r:e=>e>=255?255:e<0?0:e,g:e=>e>=255?255:e<0?0:e,b:e=>e>=255?255:e<0?0:e,h:e=>e%360,s:e=>e>=100?100:e<0?0:e,l:e=>e>=100?100:e<0?0:e,a:e=>e>=1?1:e<0?0:e},toLinear:e=>{const t=e/255;return e>.03928?Math.pow((t+.055)/1.055,2.4):t/12.92},hue2rgb:(e,t,n)=>(n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e),hsl2rgb:({h:e,s:t,l:n},r)=>{if(!t)return n*2.55;e/=360,t/=100,n/=100;const s=n<.5?n*(1+t):n+t-n*t,i=2*n-s;switch(r){case"r":return XC.hue2rgb(i,s,e+1/3)*255;case"g":return XC.hue2rgb(i,s,e)*255;case"b":return XC.hue2rgb(i,s,e-1/3)*255}},rgb2hsl:({r:e,g:t,b:n},r)=>{e/=255,t/=255,n/=255;const s=Math.max(e,t,n),i=Math.min(e,t,n),a=(s+i)/2;if(r==="l")return a*100;if(s===i)return 0;const o=s-i,l=a>.5?o/(2-s-i):o/(s+i);if(r==="s")return l*100;switch(s){case e:return((t-n)/o+(t<n?6:0))*60;case t:return((n-e)/o+2)*60;case n:return((e-t)/o+4)*60;default:return-1}}},bZe={clamp:(e,t,n)=>t>n?Math.min(t,Math.max(n,e)):Math.min(n,Math.max(t,e)),round:e=>Math.round(e*1e10)/1e10},vZe={dec2hex:e=>{const t=Math.round(e).toString(16);return t.length>1?t:`0${t}`}},dr={channel:XC,lang:bZe,unit:vZe},hh={};for(let e=0;e<=255;e++)hh[e]=dr.unit.dec2hex(e);const Ia={ALL:0,RGB:1,HSL:2};class xZe{constructor(){this.type=Ia.ALL}get(){return this.type}set(t){if(this.type&&this.type!==t)throw new Error("Cannot change both RGB and HSL channels at the same time");this.type=t}reset(){this.type=Ia.ALL}is(t){return this.type===t}}class wZe{constructor(t,n){this.color=n,this.changed=!1,this.data=t,this.type=new xZe}set(t,n){return this.color=n,this.changed=!1,this.data=t,this.type.type=Ia.ALL,this}_ensureHSL(){const t=this.data,{h:n,s:r,l:s}=t;n===void 0&&(t.h=dr.channel.rgb2hsl(t,"h")),r===void 0&&(t.s=dr.channel.rgb2hsl(t,"s")),s===void 0&&(t.l=dr.channel.rgb2hsl(t,"l"))}_ensureRGB(){const t=this.data,{r:n,g:r,b:s}=t;n===void 0&&(t.r=dr.channel.hsl2rgb(t,"r")),r===void 0&&(t.g=dr.channel.hsl2rgb(t,"g")),s===void 0&&(t.b=dr.channel.hsl2rgb(t,"b"))}get r(){const t=this.data,n=t.r;return!this.type.is(Ia.HSL)&&n!==void 0?n:(this._ensureHSL(),dr.channel.hsl2rgb(t,"r"))}get g(){const t=this.data,n=t.g;return!this.type.is(Ia.HSL)&&n!==void 0?n:(this._ensureHSL(),dr.channel.hsl2rgb(t,"g"))}get b(){const t=this.data,n=t.b;return!this.type.is(Ia.HSL)&&n!==void 0?n:(this._ensureHSL(),dr.channel.hsl2rgb(t,"b"))}get h(){const t=this.data,n=t.h;return!this.type.is(Ia.RGB)&&n!==void 0?n:(this._ensureRGB(),dr.channel.rgb2hsl(t,"h"))}get s(){const t=this.data,n=t.s;return!this.type.is(Ia.RGB)&&n!==void 0?n:(this._ensureRGB(),dr.channel.rgb2hsl(t,"s"))}get l(){const t=this.data,n=t.l;return!this.type.is(Ia.RGB)&&n!==void 0?n:(this._ensureRGB(),dr.channel.rgb2hsl(t,"l"))}get a(){return this.data.a}set r(t){this.type.set(Ia.RGB),this.changed=!0,this.data.r=t}set g(t){this.type.set(Ia.RGB),this.changed=!0,this.data.g=t}set b(t){this.type.set(Ia.RGB),this.changed=!0,this.data.b=t}set h(t){this.type.set(Ia.HSL),this.changed=!0,this.data.h=t}set s(t){this.type.set(Ia.HSL),this.changed=!0,this.data.s=t}set l(t){this.type.set(Ia.HSL),this.changed=!0,this.data.l=t}set a(t){this.changed=!0,this.data.a=t}}const nA=new wZe({r:0,g:0,b:0,a:0},"transparent"),V0={re:/^#((?:[a-f0-9]{2}){2,4}|[a-f0-9]{3})$/i,parse:e=>{if(e.charCodeAt(0)!==35)return;const t=e.match(V0.re);if(!t)return;const n=t[1],r=parseInt(n,16),s=n.length,i=s%4===0,a=s>4,o=a?1:17,l=a?8:4,c=i?0:-1,u=a?255:15;return nA.set({r:(r>>l*(c+3)&u)*o,g:(r>>l*(c+2)&u)*o,b:(r>>l*(c+1)&u)*o,a:i?(r&u)*o/255:1},e)},stringify:e=>{const{r:t,g:n,b:r,a:s}=e;return s<1?`#${hh[Math.round(t)]}${hh[Math.round(n)]}${hh[Math.round(r)]}${hh[Math.round(s*255)]}`:`#${hh[Math.round(t)]}${hh[Math.round(n)]}${hh[Math.round(r)]}`}},dm={re:/^hsla?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(?:deg|grad|rad|turn)?)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?%)(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e-?\d+)?(%)?))?\s*?\)$/i,hueRe:/^(.+?)(deg|grad|rad|turn)$/i,_hue2deg:e=>{const t=e.match(dm.hueRe);if(t){const[,n,r]=t;switch(r){case"grad":return dr.channel.clamp.h(parseFloat(n)*.9);case"rad":return dr.channel.clamp.h(parseFloat(n)*180/Math.PI);case"turn":return dr.channel.clamp.h(parseFloat(n)*360)}}return dr.channel.clamp.h(parseFloat(e))},parse:e=>{const t=e.charCodeAt(0);if(t!==104&&t!==72)return;const n=e.match(dm.re);if(!n)return;const[,r,s,i,a,o]=n;return nA.set({h:dm._hue2deg(r),s:dr.channel.clamp.s(parseFloat(s)),l:dr.channel.clamp.l(parseFloat(i)),a:a?dr.channel.clamp.a(o?parseFloat(a)/100:parseFloat(a)):1},e)},stringify:e=>{const{h:t,s:n,l:r,a:s}=e;return s<1?`hsla(${dr.lang.round(t)}, ${dr.lang.round(n)}%, ${dr.lang.round(r)}%, ${s})`:`hsl(${dr.lang.round(t)}, ${dr.lang.round(n)}%, ${dr.lang.round(r)}%)`}},Vx={colors:{aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyanaqua:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",transparent:"#00000000",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},parse:e=>{e=e.toLowerCase();const t=Vx.colors[e];if(t)return V0.parse(t)},stringify:e=>{const t=V0.stringify(e);for(const n in Vx.colors)if(Vx.colors[n]===t)return n}},_x={re:/^rgba?\(\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))\s*?(?:,|\s)\s*?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?))(?:\s*?(?:,|\/)\s*?\+?(-?(?:\d+(?:\.\d+)?|(?:\.\d+))(?:e\d+)?(%?)))?\s*?\)$/i,parse:e=>{const t=e.charCodeAt(0);if(t!==114&&t!==82)return;const n=e.match(_x.re);if(!n)return;const[,r,s,i,a,o,l,c,u]=n;return nA.set({r:dr.channel.clamp.r(s?parseFloat(r)*2.55:parseFloat(r)),g:dr.channel.clamp.g(a?parseFloat(i)*2.55:parseFloat(i)),b:dr.channel.clamp.b(l?parseFloat(o)*2.55:parseFloat(o)),a:c?dr.channel.clamp.a(u?parseFloat(c)/100:parseFloat(c)):1},e)},stringify:e=>{const{r:t,g:n,b:r,a:s}=e;return s<1?`rgba(${dr.lang.round(t)}, ${dr.lang.round(n)}, ${dr.lang.round(r)}, ${dr.lang.round(s)})`:`rgb(${dr.lang.round(t)}, ${dr.lang.round(n)}, ${dr.lang.round(r)})`}},$u={format:{keyword:Vx,hex:V0,rgb:_x,rgba:_x,hsl:dm,hsla:dm},parse:e=>{if(typeof e!="string")return e;const t=V0.parse(e)||_x.parse(e)||dm.parse(e)||Vx.parse(e);if(t)return t;throw new Error(`Unsupported color format: "${e}"`)},stringify:e=>!e.changed&&e.color?e.color:e.type.is(Ia.HSL)||e.data.r===void 0?dm.stringify(e):e.a<1||!Number.isInteger(e.r)||!Number.isInteger(e.g)||!Number.isInteger(e.b)?_x.stringify(e):V0.stringify(e)},Die=(e,t)=>{const n=$u.parse(e);for(const r in t)n[r]=dr.channel.clamp[r](t[r]);return $u.stringify(n)},Wx=(e,t,n=0,r=1)=>{if(typeof e!="number")return Die(e,{a:t});const s=nA.set({r:dr.channel.clamp.r(e),g:dr.channel.clamp.g(t),b:dr.channel.clamp.b(n),a:dr.channel.clamp.a(r)});return $u.stringify(s)},_Ze=e=>{const{r:t,g:n,b:r}=$u.parse(e),s=.2126*dr.channel.toLinear(t)+.7152*dr.channel.toLinear(n)+.0722*dr.channel.toLinear(r);return dr.lang.round(s)},SZe=e=>_Ze(e)>=.5,p_=e=>!SZe(e),Fie=(e,t,n)=>{const r=$u.parse(e),s=r[t],i=dr.channel.clamp[t](s+n);return s!==i&&(r[t]=i),$u.stringify(r)},Cn=(e,t)=>Fie(e,"l",t),Un=(e,t)=>Fie(e,"l",-t),xt=(e,t)=>{const n=$u.parse(e),r={};for(const s in t)t[s]&&(r[s]=n[s]+t[s]);return Die(e,r)},CZe=(e,t,n=50)=>{const{r,g:s,b:i,a}=$u.parse(e),{r:o,g:l,b:c,a:u}=$u.parse(t),d=n/100,h=d*2-1,m=a-u,b=((h*m===-1?h:(h+m)/(1+h*m))+1)/2,v=1-b,x=r*b+o*v,w=s*b+l*v,S=i*b+c*v,k=a*d+u*(1-d);return Wx(x,w,S,k)},dn=(e,t=100)=>{const n=$u.parse(e);return n.r=255-n.r,n.g=255-n.g,n.b=255-n.b,CZe(n,e,t)};/*! @license DOMPurify 3.2.6 | (c) Cure53 and other contributors | Released under the Apache license 2.0 and Mozilla Public License 2.0 | github.com/cure53/DOMPurify/blob/3.2.6/LICENSE */const{entries:Lie,setPrototypeOf:bV,isFrozen:kZe,getPrototypeOf:EZe,getOwnPropertyDescriptor:TZe}=Object;let{freeze:po,seal:Xl,create:Bie}=Object,{apply:H4,construct:G4}=typeof Reflect<"u"&&Reflect;po||(po=function(t){return t});Xl||(Xl=function(t){return t});H4||(H4=function(t,n,r){return t.apply(n,r)});G4||(G4=function(t,n){return new t(...n)});const _C=mo(Array.prototype.forEach),AZe=mo(Array.prototype.lastIndexOf),vV=mo(Array.prototype.pop),Yv=mo(Array.prototype.push),RZe=mo(Array.prototype.splice),JC=mo(String.prototype.toLowerCase),R3=mo(String.prototype.toString),xV=mo(String.prototype.match),Zv=mo(String.prototype.replace),NZe=mo(String.prototype.indexOf),MZe=mo(String.prototype.trim),bc=mo(Object.prototype.hasOwnProperty),eo=mo(RegExp.prototype.test),Xv=IZe(TypeError);function mo(e){return function(t){t instanceof RegExp&&(t.lastIndex=0);for(var n=arguments.length,r=new Array(n>1?n-1:0),s=1;s<n;s++)r[s-1]=arguments[s];return H4(e,t,r)}}function IZe(e){return function(){for(var t=arguments.length,n=new Array(t),r=0;r<t;r++)n[r]=arguments[r];return G4(e,n)}}function $r(e,t){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:JC;bV&&bV(e,null);let r=t.length;for(;r--;){let s=t[r];if(typeof s=="string"){const i=n(s);i!==s&&(kZe(t)||(t[r]=i),s=i)}e[s]=!0}return e}function jZe(e){for(let t=0;t<e.length;t++)bc(e,t)||(e[t]=null);return e}function kd(e){const t=Bie(null);for(const[n,r]of Lie(e))bc(e,n)&&(Array.isArray(r)?t[n]=jZe(r):r&&typeof r=="object"&&r.constructor===Object?t[n]=kd(r):t[n]=r);return t}function Jv(e,t){for(;e!==null;){const r=TZe(e,t);if(r){if(r.get)return mo(r.get);if(typeof r.value=="function")return mo(r.value)}e=EZe(e)}function n(){return null}return n}const wV=po(["a","abbr","acronym","address","area","article","aside","audio","b","bdi","bdo","big","blink","blockquote","body","br","button","canvas","caption","center","cite","code","col","colgroup","content","data","datalist","dd","decorator","del","details","dfn","dialog","dir","div","dl","dt","element","em","fieldset","figcaption","figure","font","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","img","input","ins","kbd","label","legend","li","main","map","mark","marquee","menu","menuitem","meter","nav","nobr","ol","optgroup","option","output","p","picture","pre","progress","q","rp","rt","ruby","s","samp","section","select","shadow","small","source","spacer","span","strike","strong","style","sub","summary","sup","table","tbody","td","template","textarea","tfoot","th","thead","time","tr","track","tt","u","ul","var","video","wbr"]),N3=po(["svg","a","altglyph","altglyphdef","altglyphitem","animatecolor","animatemotion","animatetransform","circle","clippath","defs","desc","ellipse","filter","font","g","glyph","glyphref","hkern","image","line","lineargradient","marker","mask","metadata","mpath","path","pattern","polygon","polyline","radialgradient","rect","stop","style","switch","symbol","text","textpath","title","tref","tspan","view","vkern"]),M3=po(["feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence"]),PZe=po(["animate","color-profile","cursor","discard","font-face","font-face-format","font-face-name","font-face-src","font-face-uri","foreignobject","hatch","hatchpath","mesh","meshgradient","meshpatch","meshrow","missing-glyph","script","set","solidcolor","unknown","use"]),I3=po(["math","menclose","merror","mfenced","mfrac","mglyph","mi","mlabeledtr","mmultiscripts","mn","mo","mover","mpadded","mphantom","mroot","mrow","ms","mspace","msqrt","mstyle","msub","msup","msubsup","mtable","mtd","mtext","mtr","munder","munderover","mprescripts"]),OZe=po(["maction","maligngroup","malignmark","mlongdiv","mscarries","mscarry","msgroup","mstack","msline","msrow","semantics","annotation","annotation-xml","mprescripts","none"]),_V=po(["#text"]),SV=po(["accept","action","align","alt","autocapitalize","autocomplete","autopictureinpicture","autoplay","background","bgcolor","border","capture","cellpadding","cellspacing","checked","cite","class","clear","color","cols","colspan","controls","controlslist","coords","crossorigin","datetime","decoding","default","dir","disabled","disablepictureinpicture","disableremoteplayback","download","draggable","enctype","enterkeyhint","face","for","headers","height","hidden","high","href","hreflang","id","inputmode","integrity","ismap","kind","label","lang","list","loading","loop","low","max","maxlength","media","method","min","minlength","multiple","muted","name","nonce","noshade","novalidate","nowrap","open","optimum","pattern","placeholder","playsinline","popover","popovertarget","popovertargetaction","poster","preload","pubdate","radiogroup","readonly","rel","required","rev","reversed","role","rows","rowspan","spellcheck","scope","selected","shape","size","sizes","span","srclang","start","src","srcset","step","style","summary","tabindex","title","translate","type","usemap","valign","value","width","wrap","xmlns","slot"]),j3=po(["accent-height","accumulate","additive","alignment-baseline","amplitude","ascent","attributename","attributetype","azimuth","basefrequency","baseline-shift","begin","bias","by","class","clip","clippathunits","clip-path","clip-rule","color","color-interpolation","color-interpolation-filters","color-profile","color-rendering","cx","cy","d","dx","dy","diffuseconstant","direction","display","divisor","dur","edgemode","elevation","end","exponent","fill","fill-opacity","fill-rule","filter","filterunits","flood-color","flood-opacity","font-family","font-size","font-size-adjust","font-stretch","font-style","font-variant","font-weight","fx","fy","g1","g2","glyph-name","glyphref","gradientunits","gradienttransform","height","href","id","image-rendering","in","in2","intercept","k","k1","k2","k3","k4","kerning","keypoints","keysplines","keytimes","lang","lengthadjust","letter-spacing","kernelmatrix","kernelunitlength","lighting-color","local","marker-end","marker-mid","marker-start","markerheight","markerunits","markerwidth","maskcontentunits","maskunits","max","mask","media","method","mode","min","name","numoctaves","offset","operator","opacity","order","orient","orientation","origin","overflow","paint-order","path","pathlength","patterncontentunits","patterntransform","patternunits","points","preservealpha","preserveaspectratio","primitiveunits","r","rx","ry","radius","refx","refy","repeatcount","repeatdur","restart","result","rotate","scale","seed","shape-rendering","slope","specularconstant","specularexponent","spreadmethod","startoffset","stddeviation","stitchtiles","stop-color","stop-opacity","stroke-dasharray","stroke-dashoffset","stroke-linecap","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke","stroke-width","style","surfacescale","systemlanguage","tabindex","tablevalues","targetx","targety","transform","transform-origin","text-anchor","text-decoration","text-rendering","textlength","type","u1","u2","unicode","values","viewbox","visibility","version","vert-adv-y","vert-origin-x","vert-origin-y","width","word-spacing","wrap","writing-mode","xchannelselector","ychannelselector","x","x1","x2","xmlns","y","y1","y2","z","zoomandpan"]),CV=po(["accent","accentunder","align","bevelled","close","columnsalign","columnlines","columnspan","denomalign","depth","dir","display","displaystyle","encoding","fence","frame","height","href","id","largeop","length","linethickness","lspace","lquote","mathbackground","mathcolor","mathsize","mathvariant","maxsize","minsize","movablelimits","notation","numalign","open","rowalign","rowlines","rowspacing","rowspan","rspace","rquote","scriptlevel","scriptminsize","scriptsizemultiplier","selection","separator","separators","stretchy","subscriptshift","supscriptshift","symmetric","voffset","width","xmlns"]),SC=po(["xlink:href","xml:id","xlink:title","xml:space","xmlns:xlink"]),DZe=Xl(/\{\{[\w\W]*|[\w\W]*\}\}/gm),FZe=Xl(/<%[\w\W]*|[\w\W]*%>/gm),LZe=Xl(/\$\{[\w\W]*/gm),BZe=Xl(/^data-[\-\w.\u00B7-\uFFFF]+$/),$Ze=Xl(/^aria-[\-\w]+$/),$ie=Xl(/^(?:(?:(?:f|ht)tps?|mailto|tel|callto|sms|cid|xmpp|matrix):|[^a-z]|[a-z+.\-]+(?:[^a-z+.\-:]|$))/i),zZe=Xl(/^(?:\w+script|data):/i),UZe=Xl(/[\u0000-\u0020\u00A0\u1680\u180E\u2000-\u2029\u205F\u3000]/g),zie=Xl(/^html$/i),qZe=Xl(/^[a-z][.\w]*(-[.\w]+)+$/i);var kV=Object.freeze({__proto__:null,ARIA_ATTR:$Ze,ATTR_WHITESPACE:UZe,CUSTOM_ELEMENT:qZe,DATA_ATTR:BZe,DOCTYPE_NAME:zie,ERB_EXPR:FZe,IS_ALLOWED_URI:$ie,IS_SCRIPT_OR_DATA:zZe,MUSTACHE_EXPR:DZe,TMPLIT_EXPR:LZe});const Qv={element:1,text:3,progressingInstruction:7,comment:8,document:9},VZe=function(){return typeof window>"u"?null:window},WZe=function(t,n){if(typeof t!="object"||typeof t.createPolicy!="function")return null;let r=null;const s="data-tt-policy-suffix";n&&n.hasAttribute(s)&&(r=n.getAttribute(s));const i="dompurify"+(r?"#"+r:"");try{return t.createPolicy(i,{createHTML(a){return a},createScriptURL(a){return a}})}catch{return console.warn("TrustedTypes policy "+i+" could not be created."),null}},EV=function(){return{afterSanitizeAttributes:[],afterSanitizeElements:[],afterSanitizeShadowDOM:[],beforeSanitizeAttributes:[],beforeSanitizeElements:[],beforeSanitizeShadowDOM:[],uponSanitizeAttribute:[],uponSanitizeElement:[],uponSanitizeShadowNode:[]}};function Uie(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:VZe();const t=mn=>Uie(mn);if(t.version="3.2.6",t.removed=[],!e||!e.document||e.document.nodeType!==Qv.document||!e.Element)return t.isSupported=!1,t;let{document:n}=e;const r=n,s=r.currentScript,{DocumentFragment:i,HTMLTemplateElement:a,Node:o,Element:l,NodeFilter:c,NamedNodeMap:u=e.NamedNodeMap||e.MozNamedAttrMap,HTMLFormElement:d,DOMParser:h,trustedTypes:m}=e,y=l.prototype,b=Jv(y,"cloneNode"),v=Jv(y,"remove"),x=Jv(y,"nextSibling"),w=Jv(y,"childNodes"),S=Jv(y,"parentNode");if(typeof a=="function"){const mn=n.createElement("template");mn.content&&mn.content.ownerDocument&&(n=mn.content.ownerDocument)}let k,C="";const{implementation:T,createNodeIterator:A,createDocumentFragment:N,getElementsByTagName:I}=n,{importNode:O}=r;let B=EV();t.isSupported=typeof Lie=="function"&&typeof S=="function"&&T&&T.createHTMLDocument!==void 0;const{MUSTACHE_EXPR:D,ERB_EXPR:H,TMPLIT_EXPR:P,DATA_ATTR:K,ARIA_ATTR:U,IS_SCRIPT_OR_DATA:V,ATTR_WHITESPACE:L,CUSTOM_ELEMENT:te}=kV;let{IS_ALLOWED_URI:W}=kV,Q=null;const ee=$r({},[...wV,...N3,...M3,...I3,..._V]);let re=null;const pe=$r({},[...SV,...j3,...CV,...SC]);let de=Object.seal(Bie(null,{tagNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},attributeNameCheck:{writable:!0,configurable:!1,enumerable:!0,value:null},allowCustomizedBuiltInElements:{writable:!0,configurable:!1,enumerable:!0,value:!1}})),Oe=null,Fe=null,Se=!0,Ce=!0,qe=!1,Qe=!0,We=!1,je=!0,Y=!1,ye=!1,Ie=!1,ce=!1,oe=!1,se=!1,Me=!0,Be=!1;const Ae="user-content-";let lt=!0,Tt=!1,dt={},Pt=null;const qt=$r({},["annotation-xml","audio","colgroup","desc","foreignobject","head","iframe","math","mi","mn","mo","ms","mtext","noembed","noframes","noscript","plaintext","script","style","svg","template","thead","title","video","xmp"]);let Ft=null;const Ht=$r({},["audio","video","img","source","image","track"]);let we=null;const F=$r({},["alt","class","for","id","label","name","pattern","placeholder","role","summary","title","value","style","xmlns"]),X="http://www.w3.org/1998/Math/MathML",be="http://www.w3.org/2000/svg",ke="http://www.w3.org/1999/xhtml";let ge=ke,Ee=!1,le=null;const ft=$r({},[X,be,ke],R3);let et=$r({},["mi","mo","mn","ms","mtext"]),$=$r({},["annotation-xml"]);const Ue=$r({},["title","style","font","a","script"]);let tt=null;const ve=["application/xhtml+xml","text/html"],_e="text/html";let ze=null,Ct=null;const fe=n.createElement("form"),Z=function(nt){return nt instanceof RegExp||nt instanceof Function},G=function(){let nt=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};if(!(Ct&&Ct===nt)){if((!nt||typeof nt!="object")&&(nt={}),nt=kd(nt),tt=ve.indexOf(nt.PARSER_MEDIA_TYPE)===-1?_e:nt.PARSER_MEDIA_TYPE,ze=tt==="application/xhtml+xml"?R3:JC,Q=bc(nt,"ALLOWED_TAGS")?$r({},nt.ALLOWED_TAGS,ze):ee,re=bc(nt,"ALLOWED_ATTR")?$r({},nt.ALLOWED_ATTR,ze):pe,le=bc(nt,"ALLOWED_NAMESPACES")?$r({},nt.ALLOWED_NAMESPACES,R3):ft,we=bc(nt,"ADD_URI_SAFE_ATTR")?$r(kd(F),nt.ADD_URI_SAFE_ATTR,ze):F,Ft=bc(nt,"ADD_DATA_URI_TAGS")?$r(kd(Ht),nt.ADD_DATA_URI_TAGS,ze):Ht,Pt=bc(nt,"FORBID_CONTENTS")?$r({},nt.FORBID_CONTENTS,ze):qt,Oe=bc(nt,"FORBID_TAGS")?$r({},nt.FORBID_TAGS,ze):kd({}),Fe=bc(nt,"FORBID_ATTR")?$r({},nt.FORBID_ATTR,ze):kd({}),dt=bc(nt,"USE_PROFILES")?nt.USE_PROFILES:!1,Se=nt.ALLOW_ARIA_ATTR!==!1,Ce=nt.ALLOW_DATA_ATTR!==!1,qe=nt.ALLOW_UNKNOWN_PROTOCOLS||!1,Qe=nt.ALLOW_SELF_CLOSE_IN_ATTR!==!1,We=nt.SAFE_FOR_TEMPLATES||!1,je=nt.SAFE_FOR_XML!==!1,Y=nt.WHOLE_DOCUMENT||!1,ce=nt.RETURN_DOM||!1,oe=nt.RETURN_DOM_FRAGMENT||!1,se=nt.RETURN_TRUSTED_TYPE||!1,Ie=nt.FORCE_BODY||!1,Me=nt.SANITIZE_DOM!==!1,Be=nt.SANITIZE_NAMED_PROPS||!1,lt=nt.KEEP_CONTENT!==!1,Tt=nt.IN_PLACE||!1,W=nt.ALLOWED_URI_REGEXP||$ie,ge=nt.NAMESPACE||ke,et=nt.MATHML_TEXT_INTEGRATION_POINTS||et,$=nt.HTML_INTEGRATION_POINTS||$,de=nt.CUSTOM_ELEMENT_HANDLING||{},nt.CUSTOM_ELEMENT_HANDLING&&Z(nt.CUSTOM_ELEMENT_HANDLING.tagNameCheck)&&(de.tagNameCheck=nt.CUSTOM_ELEMENT_HANDLING.tagNameCheck),nt.CUSTOM_ELEMENT_HANDLING&&Z(nt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck)&&(de.attributeNameCheck=nt.CUSTOM_ELEMENT_HANDLING.attributeNameCheck),nt.CUSTOM_ELEMENT_HANDLING&&typeof nt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements=="boolean"&&(de.allowCustomizedBuiltInElements=nt.CUSTOM_ELEMENT_HANDLING.allowCustomizedBuiltInElements),We&&(Ce=!1),oe&&(ce=!0),dt&&(Q=$r({},_V),re=[],dt.html===!0&&($r(Q,wV),$r(re,SV)),dt.svg===!0&&($r(Q,N3),$r(re,j3),$r(re,SC)),dt.svgFilters===!0&&($r(Q,M3),$r(re,j3),$r(re,SC)),dt.mathMl===!0&&($r(Q,I3),$r(re,CV),$r(re,SC))),nt.ADD_TAGS&&(Q===ee&&(Q=kd(Q)),$r(Q,nt.ADD_TAGS,ze)),nt.ADD_ATTR&&(re===pe&&(re=kd(re)),$r(re,nt.ADD_ATTR,ze)),nt.ADD_URI_SAFE_ATTR&&$r(we,nt.ADD_URI_SAFE_ATTR,ze),nt.FORBID_CONTENTS&&(Pt===qt&&(Pt=kd(Pt)),$r(Pt,nt.FORBID_CONTENTS,ze)),lt&&(Q["#text"]=!0),Y&&$r(Q,["html","head","body"]),Q.table&&($r(Q,["tbody"]),delete Oe.tbody),nt.TRUSTED_TYPES_POLICY){if(typeof nt.TRUSTED_TYPES_POLICY.createHTML!="function")throw Xv('TRUSTED_TYPES_POLICY configuration option must provide a "createHTML" hook.');if(typeof nt.TRUSTED_TYPES_POLICY.createScriptURL!="function")throw Xv('TRUSTED_TYPES_POLICY configuration option must provide a "createScriptURL" hook.');k=nt.TRUSTED_TYPES_POLICY,C=k.createHTML("")}else k===void 0&&(k=WZe(m,s)),k!==null&&typeof C=="string"&&(C=k.createHTML(""));po&&po(nt),Ct=nt}},J=$r({},[...N3,...M3,...PZe]),xe=$r({},[...I3,...OZe]),De=function(nt){let Vt=S(nt);(!Vt||!Vt.tagName)&&(Vt={namespaceURI:ge,tagName:"template"});const gn=JC(nt.tagName),ir=JC(Vt.tagName);return le[nt.namespaceURI]?nt.namespaceURI===be?Vt.namespaceURI===ke?gn==="svg":Vt.namespaceURI===X?gn==="svg"&&(ir==="annotation-xml"||et[ir]):!!J[gn]:nt.namespaceURI===X?Vt.namespaceURI===ke?gn==="math":Vt.namespaceURI===be?gn==="math"&&$[ir]:!!xe[gn]:nt.namespaceURI===ke?Vt.namespaceURI===be&&!$[ir]||Vt.namespaceURI===X&&!et[ir]?!1:!xe[gn]&&(Ue[gn]||!J[gn]):!!(tt==="application/xhtml+xml"&&le[nt.namespaceURI]):!1},He=function(nt){Yv(t.removed,{element:nt});try{S(nt).removeChild(nt)}catch{v(nt)}},wt=function(nt,Vt){try{Yv(t.removed,{attribute:Vt.getAttributeNode(nt),from:Vt})}catch{Yv(t.removed,{attribute:null,from:Vt})}if(Vt.removeAttribute(nt),nt==="is")if(ce||oe)try{He(Vt)}catch{}else try{Vt.setAttribute(nt,"")}catch{}},Qt=function(nt){let Vt=null,gn=null;if(Ie)nt="<remove></remove>"+nt;else{const ts=xV(nt,/^[\r\n\t ]+/);gn=ts&&ts[0]}tt==="application/xhtml+xml"&&ge===ke&&(nt='<html xmlns="http://www.w3.org/1999/xhtml"><head></head><body>'+nt+"</body></html>");const ir=k?k.createHTML(nt):nt;if(ge===ke)try{Vt=new h().parseFromString(ir,tt)}catch{}if(!Vt||!Vt.documentElement){Vt=T.createDocument(ge,"template",null);try{Vt.documentElement.innerHTML=Ee?C:ir}catch{}}const Rs=Vt.body||Vt.documentElement;return nt&&gn&&Rs.insertBefore(n.createTextNode(gn),Rs.childNodes[0]||null),ge===ke?I.call(Vt,Y?"html":"body")[0]:Y?Vt.documentElement:Rs},On=function(nt){return A.call(nt.ownerDocument||nt,nt,c.SHOW_ELEMENT|c.SHOW_COMMENT|c.SHOW_TEXT|c.SHOW_PROCESSING_INSTRUCTION|c.SHOW_CDATA_SECTION,null)},Zt=function(nt){return nt instanceof d&&(typeof nt.nodeName!="string"||typeof nt.textContent!="string"||typeof nt.removeChild!="function"||!(nt.attributes instanceof u)||typeof nt.removeAttribute!="function"||typeof nt.setAttribute!="function"||typeof nt.namespaceURI!="string"||typeof nt.insertBefore!="function"||typeof nt.hasChildNodes!="function")},nn=function(nt){return typeof o=="function"&&nt instanceof o};function fn(mn,nt,Vt){_C(mn,gn=>{gn.call(t,nt,Vt,Ct)})}const br=function(nt){let Vt=null;if(fn(B.beforeSanitizeElements,nt,null),Zt(nt))return He(nt),!0;const gn=ze(nt.nodeName);if(fn(B.uponSanitizeElement,nt,{tagName:gn,allowedTags:Q}),je&&nt.hasChildNodes()&&!nn(nt.firstElementChild)&&eo(/<[/\w!]/g,nt.innerHTML)&&eo(/<[/\w!]/g,nt.textContent)||nt.nodeType===Qv.progressingInstruction||je&&nt.nodeType===Qv.comment&&eo(/<[/\w]/g,nt.data))return He(nt),!0;if(!Q[gn]||Oe[gn]){if(!Oe[gn]&&rs(gn)&&(de.tagNameCheck instanceof RegExp&&eo(de.tagNameCheck,gn)||de.tagNameCheck instanceof Function&&de.tagNameCheck(gn)))return!1;if(lt&&!Pt[gn]){const ir=S(nt)||nt.parentNode,Rs=w(nt)||nt.childNodes;if(Rs&&ir){const ts=Rs.length;for(let Di=ts-1;Di>=0;--Di){const di=b(Rs[Di],!0);di.__removalCount=(nt.__removalCount||0)+1,ir.insertBefore(di,x(nt))}}}return He(nt),!0}return nt instanceof l&&!De(nt)||(gn==="noscript"||gn==="noembed"||gn==="noframes")&&eo(/<\/no(script|embed|frames)/i,nt.innerHTML)?(He(nt),!0):(We&&nt.nodeType===Qv.text&&(Vt=nt.textContent,_C([D,H,P],ir=>{Vt=Zv(Vt,ir," ")}),nt.textContent!==Vt&&(Yv(t.removed,{element:nt.cloneNode()}),nt.textContent=Vt)),fn(B.afterSanitizeElements,nt,null),!1)},Mr=function(nt,Vt,gn){if(Me&&(Vt==="id"||Vt==="name")&&(gn in n||gn in fe))return!1;if(!(Ce&&!Fe[Vt]&&eo(K,Vt))){if(!(Se&&eo(U,Vt))){if(!re[Vt]||Fe[Vt]){if(!(rs(nt)&&(de.tagNameCheck instanceof RegExp&&eo(de.tagNameCheck,nt)||de.tagNameCheck instanceof Function&&de.tagNameCheck(nt))&&(de.attributeNameCheck instanceof RegExp&&eo(de.attributeNameCheck,Vt)||de.attributeNameCheck instanceof Function&&de.attributeNameCheck(Vt))||Vt==="is"&&de.allowCustomizedBuiltInElements&&(de.tagNameCheck instanceof RegExp&&eo(de.tagNameCheck,gn)||de.tagNameCheck instanceof Function&&de.tagNameCheck(gn))))return!1}else if(!we[Vt]){if(!eo(W,Zv(gn,L,""))){if(!((Vt==="src"||Vt==="xlink:href"||Vt==="href")&&nt!=="script"&&NZe(gn,"data:")===0&&Ft[nt])){if(!(qe&&!eo(V,Zv(gn,L,"")))){if(gn)return!1}}}}}}return!0},rs=function(nt){return nt!=="annotation-xml"&&xV(nt,te)},ss=function(nt){fn(B.beforeSanitizeAttributes,nt,null);const{attributes:Vt}=nt;if(!Vt||Zt(nt))return;const gn={attrName:"",attrValue:"",keepAttr:!0,allowedAttributes:re,forceKeepAttr:void 0};let ir=Vt.length;for(;ir--;){const Rs=Vt[ir],{name:ts,namespaceURI:Di,value:di}=Rs,Ga=ze(ts),pa=di;let Hs=ts==="value"?pa:MZe(pa);if(gn.attrName=Ga,gn.attrValue=Hs,gn.keepAttr=!0,gn.forceKeepAttr=void 0,fn(B.uponSanitizeAttribute,nt,gn),Hs=gn.attrValue,Be&&(Ga==="id"||Ga==="name")&&(wt(ts,nt),Hs=Ae+Hs),je&&eo(/((--!?|])>)|<\/(style|title)/i,Hs)){wt(ts,nt);continue}if(gn.forceKeepAttr)continue;if(!gn.keepAttr){wt(ts,nt);continue}if(!Qe&&eo(/\/>/i,Hs)){wt(ts,nt);continue}We&&_C([D,H,P],wl=>{Hs=Zv(Hs,wl," ")});const Yo=ze(nt.nodeName);if(!Mr(Yo,Ga,Hs)){wt(ts,nt);continue}if(k&&typeof m=="object"&&typeof m.getAttributeType=="function"&&!Di)switch(m.getAttributeType(Yo,Ga)){case"TrustedHTML":{Hs=k.createHTML(Hs);break}case"TrustedScriptURL":{Hs=k.createScriptURL(Hs);break}}if(Hs!==pa)try{Di?nt.setAttributeNS(Di,ts,Hs):nt.setAttribute(ts,Hs),Zt(nt)?He(nt):vV(t.removed)}catch{wt(ts,nt)}}fn(B.afterSanitizeAttributes,nt,null)},kr=function mn(nt){let Vt=null;const gn=On(nt);for(fn(B.beforeSanitizeShadowDOM,nt,null);Vt=gn.nextNode();)fn(B.uponSanitizeShadowNode,Vt,null),br(Vt),ss(Vt),Vt.content instanceof i&&mn(Vt.content);fn(B.afterSanitizeShadowDOM,nt,null)};return t.sanitize=function(mn){let nt=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},Vt=null,gn=null,ir=null,Rs=null;if(Ee=!mn,Ee&&(mn="<!-->"),typeof mn!="string"&&!nn(mn))if(typeof mn.toString=="function"){if(mn=mn.toString(),typeof mn!="string")throw Xv("dirty is not a string, aborting")}else throw Xv("toString is not a function");if(!t.isSupported)return mn;if(ye||G(nt),t.removed=[],typeof mn=="string"&&(Tt=!1),Tt){if(mn.nodeName){const di=ze(mn.nodeName);if(!Q[di]||Oe[di])throw Xv("root node is forbidden and cannot be sanitized in-place")}}else if(mn instanceof o)Vt=Qt("<!---->"),gn=Vt.ownerDocument.importNode(mn,!0),gn.nodeType===Qv.element&&gn.nodeName==="BODY"||gn.nodeName==="HTML"?Vt=gn:Vt.appendChild(gn);else{if(!ce&&!We&&!Y&&mn.indexOf("<")===-1)return k&&se?k.createHTML(mn):mn;if(Vt=Qt(mn),!Vt)return ce?null:se?C:""}Vt&&Ie&&He(Vt.firstChild);const ts=On(Tt?mn:Vt);for(;ir=ts.nextNode();)br(ir),ss(ir),ir.content instanceof i&&kr(ir.content);if(Tt)return mn;if(ce){if(oe)for(Rs=N.call(Vt.ownerDocument);Vt.firstChild;)Rs.appendChild(Vt.firstChild);else Rs=Vt;return(re.shadowroot||re.shadowrootmode)&&(Rs=O.call(r,Rs,!0)),Rs}let Di=Y?Vt.outerHTML:Vt.innerHTML;return Y&&Q["!doctype"]&&Vt.ownerDocument&&Vt.ownerDocument.doctype&&Vt.ownerDocument.doctype.name&&eo(zie,Vt.ownerDocument.doctype.name)&&(Di="<!DOCTYPE "+Vt.ownerDocument.doctype.name+`>
`+Di),We&&_C([D,H,P],di=>{Di=Zv(Di,di," ")}),k&&se?k.createHTML(Di):Di},t.setConfig=function(){let mn=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};G(mn),ye=!0},t.clearConfig=function(){Ct=null,ye=!1},t.isValidAttribute=function(mn,nt,Vt){Ct||G({});const gn=ze(mn),ir=ze(nt);return Mr(gn,ir,Vt)},t.addHook=function(mn,nt){typeof nt=="function"&&Yv(B[mn],nt)},t.removeHook=function(mn,nt){if(nt!==void 0){const Vt=AZe(B[mn],nt);return Vt===-1?void 0:RZe(B[mn],Vt,1)[0]}return vV(B[mn])},t.removeHooks=function(mn){B[mn]=[]},t.removeAllHooks=function(){B=EV()},t}var Iy=Uie(),qie=Object.defineProperty,ie=(e,t)=>qie(e,"name",{value:t,configurable:!0}),HZe=(e,t)=>{for(var n in t)qie(e,n,{get:t[n],enumerable:!0})},wd={trace:0,debug:1,info:2,warn:3,error:4,fatal:5},Ut={trace:ie((...e)=>{},"trace"),debug:ie((...e)=>{},"debug"),info:ie((...e)=>{},"info"),warn:ie((...e)=>{},"warn"),error:ie((...e)=>{},"error"),fatal:ie((...e)=>{},"fatal")},g6=ie(function(e="fatal"){let t=wd.fatal;typeof e=="string"?e.toLowerCase()in wd&&(t=wd[e]):typeof e=="number"&&(t=e),Ut.trace=()=>{},Ut.debug=()=>{},Ut.info=()=>{},Ut.warn=()=>{},Ut.error=()=>{},Ut.fatal=()=>{},t<=wd.fatal&&(Ut.fatal=console.error?console.error.bind(console,Dl("FATAL"),"color: orange"):console.log.bind(console,"\x1B[35m",Dl("FATAL"))),t<=wd.error&&(Ut.error=console.error?console.error.bind(console,Dl("ERROR"),"color: orange"):console.log.bind(console,"\x1B[31m",Dl("ERROR"))),t<=wd.warn&&(Ut.warn=console.warn?console.warn.bind(console,Dl("WARN"),"color: orange"):console.log.bind(console,"\x1B[33m",Dl("WARN"))),t<=wd.info&&(Ut.info=console.info?console.info.bind(console,Dl("INFO"),"color: lightblue"):console.log.bind(console,"\x1B[34m",Dl("INFO"))),t<=wd.debug&&(Ut.debug=console.debug?console.debug.bind(console,Dl("DEBUG"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",Dl("DEBUG"))),t<=wd.trace&&(Ut.trace=console.debug?console.debug.bind(console,Dl("TRACE"),"color: lightgreen"):console.log.bind(console,"\x1B[32m",Dl("TRACE")))},"setLogLevel"),Dl=ie(e=>`%c${yZe().format("ss.SSS")} : ${e} : `,"format"),Vie=/^-{3}\s*[\n\r](.*?)[\n\r]-{3}\s*[\n\r]+/s,Hx=/%{2}{\s*(?:(\w+)\s*:|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,GZe=/\s*%%.*\n/gm,G0,Wie=(G0=class extends Error{constructor(t){super(t),this.name="UnknownDiagramError"}},ie(G0,"UnknownDiagramError"),G0),jy={},y6=ie(function(e,t){e=e.replace(Vie,"").replace(Hx,"").replace(GZe,`
`);for(const[n,{detector:r}]of Object.entries(jy))if(r(e,t))return n;throw new Wie(`No diagram type detected matching given configuration for text: ${e}`)},"detectType"),Hie=ie((...e)=>{for(const{id:t,detector:n,loader:r}of e)Gie(t,n,r)},"registerLazyLoadedDiagrams"),Gie=ie((e,t,n)=>{jy[e]&&Ut.warn(`Detector with key ${e} already exists. Overwriting.`),jy[e]={detector:t,loader:n},Ut.debug(`Detector with key ${e} added${n?" with loader":""}`)},"addDetector"),KZe=ie(e=>jy[e].loader,"getDiagramLoader"),K4=ie((e,t,{depth:n=2,clobber:r=!1}={})=>{const s={depth:n,clobber:r};return Array.isArray(t)&&!Array.isArray(e)?(t.forEach(i=>K4(e,i,s)),e):Array.isArray(t)&&Array.isArray(e)?(t.forEach(i=>{e.includes(i)||e.push(i)}),e):e===void 0||n<=0?e!=null&&typeof e=="object"&&typeof t=="object"?Object.assign(e,t):t:(t!==void 0&&typeof e=="object"&&typeof t=="object"&&Object.keys(t).forEach(i=>{typeof t[i]=="object"&&(e[i]===void 0||typeof e[i]=="object")?(e[i]===void 0&&(e[i]=Array.isArray(t[i])?[]:{}),e[i]=K4(e[i],t[i],{depth:n-1,clobber:r})):(r||typeof e[i]!="object"&&typeof t[i]!="object")&&(e[i]=t[i])}),e)},"assignWithDepth"),Ca=K4,rA="#ffffff",sA="#f2f2f2",ro=ie((e,t)=>t?xt(e,{s:-40,l:10}):xt(e,{s:-40,l:-10}),"mkBorder"),K0,YZe=(K0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#fff4dd",this.noteBkgColor="#fff5ad",this.noteTextColor="#333",this.THEME_COLOR_LIMIT=12,this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px"}updateColors(){var n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C,T;if(this.primaryTextColor=this.primaryTextColor||(this.darkMode?"#eee":"#333"),this.secondaryColor=this.secondaryColor||xt(this.primaryColor,{h:-120}),this.tertiaryColor=this.tertiaryColor||xt(this.primaryColor,{h:180,l:5}),this.primaryBorderColor=this.primaryBorderColor||ro(this.primaryColor,this.darkMode),this.secondaryBorderColor=this.secondaryBorderColor||ro(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=this.tertiaryBorderColor||ro(this.tertiaryColor,this.darkMode),this.noteBorderColor=this.noteBorderColor||ro(this.noteBkgColor,this.darkMode),this.noteBkgColor=this.noteBkgColor||"#fff5ad",this.noteTextColor=this.noteTextColor||"#333",this.secondaryTextColor=this.secondaryTextColor||dn(this.secondaryColor),this.tertiaryTextColor=this.tertiaryTextColor||dn(this.tertiaryColor),this.lineColor=this.lineColor||dn(this.background),this.arrowheadColor=this.arrowheadColor||dn(this.background),this.textColor=this.textColor||this.primaryTextColor,this.border2=this.border2||this.tertiaryBorderColor,this.nodeBkg=this.nodeBkg||this.primaryColor,this.mainBkg=this.mainBkg||this.primaryColor,this.nodeBorder=this.nodeBorder||this.primaryBorderColor,this.clusterBkg=this.clusterBkg||this.tertiaryColor,this.clusterBorder=this.clusterBorder||this.tertiaryBorderColor,this.defaultLinkColor=this.defaultLinkColor||this.lineColor,this.titleColor=this.titleColor||this.tertiaryTextColor,this.edgeLabelBackground=this.edgeLabelBackground||(this.darkMode?Un(this.secondaryColor,30):this.secondaryColor),this.nodeTextColor=this.nodeTextColor||this.primaryTextColor,this.actorBorder=this.actorBorder||this.primaryBorderColor,this.actorBkg=this.actorBkg||this.mainBkg,this.actorTextColor=this.actorTextColor||this.primaryTextColor,this.actorLineColor=this.actorLineColor||this.actorBorder,this.labelBoxBkgColor=this.labelBoxBkgColor||this.actorBkg,this.signalColor=this.signalColor||this.textColor,this.signalTextColor=this.signalTextColor||this.textColor,this.labelBoxBorderColor=this.labelBoxBorderColor||this.actorBorder,this.labelTextColor=this.labelTextColor||this.actorTextColor,this.loopTextColor=this.loopTextColor||this.actorTextColor,this.activationBorderColor=this.activationBorderColor||Un(this.secondaryColor,10),this.activationBkgColor=this.activationBkgColor||this.secondaryColor,this.sequenceNumberColor=this.sequenceNumberColor||dn(this.lineColor),this.sectionBkgColor=this.sectionBkgColor||this.tertiaryColor,this.altSectionBkgColor=this.altSectionBkgColor||"white",this.sectionBkgColor=this.sectionBkgColor||this.secondaryColor,this.sectionBkgColor2=this.sectionBkgColor2||this.primaryColor,this.excludeBkgColor=this.excludeBkgColor||"#eeeeee",this.taskBorderColor=this.taskBorderColor||this.primaryBorderColor,this.taskBkgColor=this.taskBkgColor||this.primaryColor,this.activeTaskBorderColor=this.activeTaskBorderColor||this.primaryColor,this.activeTaskBkgColor=this.activeTaskBkgColor||Cn(this.primaryColor,23),this.gridColor=this.gridColor||"lightgrey",this.doneTaskBkgColor=this.doneTaskBkgColor||"lightgrey",this.doneTaskBorderColor=this.doneTaskBorderColor||"grey",this.critBorderColor=this.critBorderColor||"#ff8888",this.critBkgColor=this.critBkgColor||"red",this.todayLineColor=this.todayLineColor||"red",this.taskTextColor=this.taskTextColor||this.textColor,this.taskTextOutsideColor=this.taskTextOutsideColor||this.textColor,this.taskTextLightColor=this.taskTextLightColor||this.textColor,this.taskTextColor=this.taskTextColor||this.primaryTextColor,this.taskTextDarkColor=this.taskTextDarkColor||this.textColor,this.taskTextClickableColor=this.taskTextClickableColor||"#003163",this.personBorder=this.personBorder||this.primaryBorderColor,this.personBkg=this.personBkg||this.mainBkg,this.darkMode?(this.rowOdd=this.rowOdd||Un(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||Un(this.mainBkg,10)):(this.rowOdd=this.rowOdd||Cn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||Cn(this.mainBkg,5)),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||this.tertiaryColor,this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.specialStateColor=this.lineColor,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||xt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||xt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||xt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||xt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||xt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||xt(this.primaryColor,{h:210,l:150}),this.cScale9=this.cScale9||xt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||xt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||xt(this.primaryColor,{h:330}),this.darkMode)for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScale"+A]=Un(this["cScale"+A],75);else for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScale"+A]=Un(this["cScale"+A],25);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleInv"+A]=this["cScaleInv"+A]||dn(this["cScale"+A]);for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this.darkMode?this["cScalePeer"+A]=this["cScalePeer"+A]||Cn(this["cScale"+A],10):this["cScalePeer"+A]=this["cScalePeer"+A]||Un(this["cScale"+A],10);this.scaleLabelColor=this.scaleLabelColor||this.labelTextColor;for(let A=0;A<this.THEME_COLOR_LIMIT;A++)this["cScaleLabel"+A]=this["cScaleLabel"+A]||this.scaleLabelColor;const t=this.darkMode?-4:-1;for(let A=0;A<5;A++)this["surface"+A]=this["surface"+A]||xt(this.mainBkg,{h:180,s:-15,l:t*(5+A*3)}),this["surfacePeer"+A]=this["surfacePeer"+A]||xt(this.mainBkg,{h:180,s:-15,l:t*(8+A*3)});this.classText=this.classText||this.textColor,this.fillType0=this.fillType0||this.primaryColor,this.fillType1=this.fillType1||this.secondaryColor,this.fillType2=this.fillType2||xt(this.primaryColor,{h:64}),this.fillType3=this.fillType3||xt(this.secondaryColor,{h:64}),this.fillType4=this.fillType4||xt(this.primaryColor,{h:-64}),this.fillType5=this.fillType5||xt(this.secondaryColor,{h:-64}),this.fillType6=this.fillType6||xt(this.primaryColor,{h:128}),this.fillType7=this.fillType7||xt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||xt(this.primaryColor,{l:-10}),this.pie5=this.pie5||xt(this.secondaryColor,{l:-10}),this.pie6=this.pie6||xt(this.tertiaryColor,{l:-10}),this.pie7=this.pie7||xt(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||xt(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||xt(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||xt(this.primaryColor,{h:60,l:-20}),this.pie11=this.pie11||xt(this.primaryColor,{h:-60,l:-20}),this.pie12=this.pie12||xt(this.primaryColor,{h:120,l:-10}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.radar={axisColor:((n=this.radar)==null?void 0:n.axisColor)||this.lineColor,axisStrokeWidth:((r=this.radar)==null?void 0:r.axisStrokeWidth)||2,axisLabelFontSize:((s=this.radar)==null?void 0:s.axisLabelFontSize)||12,curveOpacity:((i=this.radar)==null?void 0:i.curveOpacity)||.5,curveStrokeWidth:((a=this.radar)==null?void 0:a.curveStrokeWidth)||2,graticuleColor:((o=this.radar)==null?void 0:o.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((l=this.radar)==null?void 0:l.graticuleStrokeWidth)||1,graticuleOpacity:((c=this.radar)==null?void 0:c.graticuleOpacity)||.3,legendBoxSize:((u=this.radar)==null?void 0:u.legendBoxSize)||12,legendFontSize:((d=this.radar)==null?void 0:d.legendFontSize)||12},this.archEdgeColor=this.archEdgeColor||"#777",this.archEdgeArrowColor=this.archEdgeArrowColor||"#777",this.archEdgeWidth=this.archEdgeWidth||"3",this.archGroupBorderColor=this.archGroupBorderColor||"#000",this.archGroupBorderWidth=this.archGroupBorderWidth||"2px",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||xt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||xt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||xt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||xt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||xt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||xt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||p_(this.quadrant1Fill)?Cn(this.quadrant1Fill):Un(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((h=this.xyChart)==null?void 0:h.backgroundColor)||this.background,titleColor:((m=this.xyChart)==null?void 0:m.titleColor)||this.primaryTextColor,xAxisTitleColor:((y=this.xyChart)==null?void 0:y.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((b=this.xyChart)==null?void 0:b.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((v=this.xyChart)==null?void 0:v.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((x=this.xyChart)==null?void 0:x.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((w=this.xyChart)==null?void 0:w.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((S=this.xyChart)==null?void 0:S.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((k=this.xyChart)==null?void 0:k.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((C=this.xyChart)==null?void 0:C.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((T=this.xyChart)==null?void 0:T.plotColorPalette)||"#FFF4DD,#FFD8B1,#FFA07A,#ECEFF1,#D6DBDF,#C3E0A8,#FFB6A4,#FFD74D,#738FA7,#FFFFF0"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?Un(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||xt(this.primaryColor,{h:-30}),this.git4=this.git4||xt(this.primaryColor,{h:-60}),this.git5=this.git5||xt(this.primaryColor,{h:-90}),this.git6=this.git6||xt(this.primaryColor,{h:60}),this.git7=this.git7||xt(this.primaryColor,{h:120}),this.darkMode?(this.git0=Cn(this.git0,25),this.git1=Cn(this.git1,25),this.git2=Cn(this.git2,25),this.git3=Cn(this.git3,25),this.git4=Cn(this.git4,25),this.git5=Cn(this.git5,25),this.git6=Cn(this.git6,25),this.git7=Cn(this.git7,25)):(this.git0=Un(this.git0,25),this.git1=Un(this.git1,25),this.git2=Un(this.git2,25),this.git3=Un(this.git3,25),this.git4=Un(this.git4,25),this.git5=Un(this.git5,25),this.git6=Un(this.git6,25),this.git7=Un(this.git7,25)),this.gitInv0=this.gitInv0||dn(this.git0),this.gitInv1=this.gitInv1||dn(this.git1),this.gitInv2=this.gitInv2||dn(this.git2),this.gitInv3=this.gitInv3||dn(this.git3),this.gitInv4=this.gitInv4||dn(this.git4),this.gitInv5=this.gitInv5||dn(this.git5),this.gitInv6=this.gitInv6||dn(this.git6),this.gitInv7=this.gitInv7||dn(this.git7),this.branchLabelColor=this.branchLabelColor||(this.darkMode?"black":this.labelTextColor),this.gitBranchLabel0=this.gitBranchLabel0||this.branchLabelColor,this.gitBranchLabel1=this.gitBranchLabel1||this.branchLabelColor,this.gitBranchLabel2=this.gitBranchLabel2||this.branchLabelColor,this.gitBranchLabel3=this.gitBranchLabel3||this.branchLabelColor,this.gitBranchLabel4=this.gitBranchLabel4||this.branchLabelColor,this.gitBranchLabel5=this.gitBranchLabel5||this.branchLabelColor,this.gitBranchLabel6=this.gitBranchLabel6||this.branchLabelColor,this.gitBranchLabel7=this.gitBranchLabel7||this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||rA,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||sA}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(K0,"Theme"),K0),ZZe=ie(e=>{const t=new YZe;return t.calculate(e),t},"getThemeVariables"),Y0,XZe=(Y0=class{constructor(){this.background="#333",this.primaryColor="#1f2020",this.secondaryColor=Cn(this.primaryColor,16),this.tertiaryColor=xt(this.primaryColor,{h:-160}),this.primaryBorderColor=dn(this.background),this.secondaryBorderColor=ro(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=ro(this.tertiaryColor,this.darkMode),this.primaryTextColor=dn(this.primaryColor),this.secondaryTextColor=dn(this.secondaryColor),this.tertiaryTextColor=dn(this.tertiaryColor),this.lineColor=dn(this.background),this.textColor=dn(this.background),this.mainBkg="#1f2020",this.secondBkg="calculated",this.mainContrastColor="lightgrey",this.darkTextColor=Cn(dn("#323D47"),10),this.lineColor="calculated",this.border1="#ccc",this.border2=Wx(255,255,255,.25),this.arrowheadColor="calculated",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="#181818",this.textColor="#ccc",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#F9FFFE",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="calculated",this.activationBkgColor="calculated",this.sequenceNumberColor="black",this.sectionBkgColor=Un("#EAE8D9",30),this.altSectionBkgColor="calculated",this.sectionBkgColor2="#EAE8D9",this.excludeBkgColor=Un(this.sectionBkgColor,10),this.taskBorderColor=Wx(255,255,255,70),this.taskBkgColor="calculated",this.taskTextColor="calculated",this.taskTextLightColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor=Wx(255,255,255,50),this.activeTaskBkgColor="#81B1DB",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="grey",this.critBorderColor="#E83737",this.critBkgColor="#E83737",this.taskTextDarkColor="calculated",this.todayLineColor="#DB5757",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||Cn(this.mainBkg,5)||"#ffffff",this.rowEven=this.rowEven||Un(this.mainBkg,10),this.labelColor="calculated",this.errorBkgColor="#a44141",this.errorTextColor="#ddd"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C;this.secondBkg=Cn(this.mainBkg,16),this.lineColor=this.mainContrastColor,this.arrowheadColor=this.mainContrastColor,this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.edgeLabelBackground=Cn(this.labelBackground,25),this.actorBorder=this.border1,this.actorBkg=this.mainBkg,this.actorTextColor=this.mainContrastColor,this.actorLineColor=this.actorBorder,this.signalColor=this.mainContrastColor,this.signalTextColor=this.mainContrastColor,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.mainContrastColor,this.loopTextColor=this.mainContrastColor,this.noteBorderColor=this.secondaryBorderColor,this.noteBkgColor=this.secondBkg,this.noteTextColor=this.secondaryTextColor,this.activationBorderColor=this.border1,this.activationBkgColor=this.secondBkg,this.altSectionBkgColor=this.background,this.taskBkgColor=Cn(this.mainBkg,23),this.taskTextColor=this.darkTextColor,this.taskTextLightColor=this.mainContrastColor,this.taskTextOutsideColor=this.taskTextLightColor,this.gridColor=this.mainContrastColor,this.doneTaskBkgColor=this.mainContrastColor,this.taskTextDarkColor=this.darkTextColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#555",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#f4f4f4",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=xt(this.primaryColor,{h:64}),this.fillType3=xt(this.secondaryColor,{h:64}),this.fillType4=xt(this.primaryColor,{h:-64}),this.fillType5=xt(this.secondaryColor,{h:-64}),this.fillType6=xt(this.primaryColor,{h:128}),this.fillType7=xt(this.secondaryColor,{h:128}),this.cScale1=this.cScale1||"#0b0000",this.cScale2=this.cScale2||"#4d1037",this.cScale3=this.cScale3||"#3f5258",this.cScale4=this.cScale4||"#4f2f1b",this.cScale5=this.cScale5||"#6e0a0a",this.cScale6=this.cScale6||"#3b0048",this.cScale7=this.cScale7||"#995a01",this.cScale8=this.cScale8||"#154706",this.cScale9=this.cScale9||"#161722",this.cScale10=this.cScale10||"#00296f",this.cScale11=this.cScale11||"#01629c",this.cScale12=this.cScale12||"#010029",this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||xt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||xt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||xt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||xt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||xt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||xt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||xt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||xt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||xt(this.primaryColor,{h:330});for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||dn(this["cScale"+T]);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScalePeer"+T]=this["cScalePeer"+T]||Cn(this["cScale"+T],10);for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||xt(this.mainBkg,{h:30,s:-30,l:-(-10+T*4)}),this["surfacePeer"+T]=this["surfacePeer"+T]||xt(this.mainBkg,{h:30,s:-30,l:-(-7+T*4)});this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.scaleLabelColor;for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["pie"+T]=this["cScale"+T];this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||xt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||xt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||xt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||xt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||xt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||xt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||p_(this.quadrant1Fill)?Cn(this.quadrant1Fill):Un(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((t=this.xyChart)==null?void 0:t.backgroundColor)||this.background,titleColor:((n=this.xyChart)==null?void 0:n.titleColor)||this.primaryTextColor,xAxisTitleColor:((r=this.xyChart)==null?void 0:r.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((s=this.xyChart)==null?void 0:s.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((i=this.xyChart)==null?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((a=this.xyChart)==null?void 0:a.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((o=this.xyChart)==null?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((l=this.xyChart)==null?void 0:l.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((c=this.xyChart)==null?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((u=this.xyChart)==null?void 0:u.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((d=this.xyChart)==null?void 0:d.plotColorPalette)||"#3498db,#2ecc71,#e74c3c,#f1c40f,#bdc3c7,#ffffff,#34495e,#9b59b6,#1abc9c,#e67e22"},this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.background},this.radar={axisColor:((h=this.radar)==null?void 0:h.axisColor)||this.lineColor,axisStrokeWidth:((m=this.radar)==null?void 0:m.axisStrokeWidth)||2,axisLabelFontSize:((y=this.radar)==null?void 0:y.axisLabelFontSize)||12,curveOpacity:((b=this.radar)==null?void 0:b.curveOpacity)||.5,curveStrokeWidth:((v=this.radar)==null?void 0:v.curveStrokeWidth)||2,graticuleColor:((x=this.radar)==null?void 0:x.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((w=this.radar)==null?void 0:w.graticuleStrokeWidth)||1,graticuleOpacity:((S=this.radar)==null?void 0:S.graticuleOpacity)||.3,legendBoxSize:((k=this.radar)==null?void 0:k.legendBoxSize)||12,legendFontSize:((C=this.radar)==null?void 0:C.legendFontSize)||12},this.classText=this.primaryTextColor,this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||(this.darkMode?Un(this.secondaryColor,30):this.secondaryColor),this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=Cn(this.secondaryColor,20),this.git1=Cn(this.pie2||this.secondaryColor,20),this.git2=Cn(this.pie3||this.tertiaryColor,20),this.git3=Cn(this.pie4||xt(this.primaryColor,{h:-30}),20),this.git4=Cn(this.pie5||xt(this.primaryColor,{h:-60}),20),this.git5=Cn(this.pie6||xt(this.primaryColor,{h:-90}),10),this.git6=Cn(this.pie7||xt(this.primaryColor,{h:60}),10),this.git7=Cn(this.pie8||xt(this.primaryColor,{h:120}),20),this.gitInv0=this.gitInv0||dn(this.git0),this.gitInv1=this.gitInv1||dn(this.git1),this.gitInv2=this.gitInv2||dn(this.git2),this.gitInv3=this.gitInv3||dn(this.git3),this.gitInv4=this.gitInv4||dn(this.git4),this.gitInv5=this.gitInv5||dn(this.git5),this.gitInv6=this.gitInv6||dn(this.git6),this.gitInv7=this.gitInv7||dn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||dn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||dn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||Cn(this.background,12),this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||Cn(this.background,2),this.nodeBorder=this.nodeBorder||"#999"}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(Y0,"Theme"),Y0),JZe=ie(e=>{const t=new XZe;return t.calculate(e),t},"getThemeVariables"),Z0,QZe=(Z0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#ECECFF",this.secondaryColor=xt(this.primaryColor,{h:120}),this.secondaryColor="#ffffde",this.tertiaryColor=xt(this.primaryColor,{h:-160}),this.primaryBorderColor=ro(this.primaryColor,this.darkMode),this.secondaryBorderColor=ro(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=ro(this.tertiaryColor,this.darkMode),this.primaryTextColor=dn(this.primaryColor),this.secondaryTextColor=dn(this.secondaryColor),this.tertiaryTextColor=dn(this.tertiaryColor),this.lineColor=dn(this.background),this.textColor=dn(this.background),this.background="white",this.mainBkg="#ECECFF",this.secondBkg="#ffffde",this.lineColor="#333333",this.border1="#9370DB",this.border2="#aaaa33",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.labelBackground="rgba(232,232,232, 0.8)",this.textColor="#333",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="calculated",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="calculated",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="calculated",this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor="calculated",this.taskTextOutsideColor=this.taskTextDarkColor,this.taskTextClickableColor="calculated",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBorderColor="calculated",this.critBkgColor="calculated",this.todayLineColor="calculated",this.sectionBkgColor=Wx(102,102,255,.49),this.altSectionBkgColor="white",this.sectionBkgColor2="#fff400",this.taskBorderColor="#534fbc",this.taskBkgColor="#8a90dd",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="#534fbc",this.activeTaskBkgColor="#bfc7ff",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd="calculated",this.rowEven="calculated",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222",this.updateColors()}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C;this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||xt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||xt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||xt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||xt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||xt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||xt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||xt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||xt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||xt(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||Un(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||Un(this.tertiaryColor,40);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScale"+T]=Un(this["cScale"+T],10),this["cScalePeer"+T]=this["cScalePeer"+T]||Un(this["cScale"+T],25);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||xt(this["cScale"+T],{h:180});for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||xt(this.mainBkg,{h:30,l:-(5+T*5)}),this["surfacePeer"+T]=this["surfacePeer"+T]||xt(this.mainBkg,{h:30,l:-(7+T*5)});if(this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor,this.labelTextColor!=="calculated"){this.cScaleLabel0=this.cScaleLabel0||dn(this.labelTextColor),this.cScaleLabel3=this.cScaleLabel3||dn(this.labelTextColor);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.labelTextColor}this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.textColor,this.edgeLabelBackground=this.labelBackground,this.actorBorder=Cn(this.border1,23),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.signalColor=this.textColor,this.signalTextColor=this.textColor,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||Cn(this.primaryColor,75)||"#ffffff",this.rowEven=this.rowEven||Cn(this.primaryColor,1),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.nodeBorder,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=xt(this.primaryColor,{h:64}),this.fillType3=xt(this.secondaryColor,{h:64}),this.fillType4=xt(this.primaryColor,{h:-64}),this.fillType5=xt(this.secondaryColor,{h:-64}),this.fillType6=xt(this.primaryColor,{h:128}),this.fillType7=xt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||xt(this.tertiaryColor,{l:-40}),this.pie4=this.pie4||xt(this.primaryColor,{l:-10}),this.pie5=this.pie5||xt(this.secondaryColor,{l:-30}),this.pie6=this.pie6||xt(this.tertiaryColor,{l:-20}),this.pie7=this.pie7||xt(this.primaryColor,{h:60,l:-20}),this.pie8=this.pie8||xt(this.primaryColor,{h:-60,l:-40}),this.pie9=this.pie9||xt(this.primaryColor,{h:120,l:-40}),this.pie10=this.pie10||xt(this.primaryColor,{h:60,l:-40}),this.pie11=this.pie11||xt(this.primaryColor,{h:-90,l:-40}),this.pie12=this.pie12||xt(this.primaryColor,{h:120,l:-30}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||xt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||xt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||xt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||xt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||xt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||xt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||p_(this.quadrant1Fill)?Cn(this.quadrant1Fill):Un(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.radar={axisColor:((t=this.radar)==null?void 0:t.axisColor)||this.lineColor,axisStrokeWidth:((n=this.radar)==null?void 0:n.axisStrokeWidth)||2,axisLabelFontSize:((r=this.radar)==null?void 0:r.axisLabelFontSize)||12,curveOpacity:((s=this.radar)==null?void 0:s.curveOpacity)||.5,curveStrokeWidth:((i=this.radar)==null?void 0:i.curveStrokeWidth)||2,graticuleColor:((a=this.radar)==null?void 0:a.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((o=this.radar)==null?void 0:o.graticuleStrokeWidth)||1,graticuleOpacity:((l=this.radar)==null?void 0:l.graticuleOpacity)||.3,legendBoxSize:((c=this.radar)==null?void 0:c.legendBoxSize)||12,legendFontSize:((u=this.radar)==null?void 0:u.legendFontSize)||12},this.xyChart={backgroundColor:((d=this.xyChart)==null?void 0:d.backgroundColor)||this.background,titleColor:((h=this.xyChart)==null?void 0:h.titleColor)||this.primaryTextColor,xAxisTitleColor:((m=this.xyChart)==null?void 0:m.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((y=this.xyChart)==null?void 0:y.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((b=this.xyChart)==null?void 0:b.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((v=this.xyChart)==null?void 0:v.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((x=this.xyChart)==null?void 0:x.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((w=this.xyChart)==null?void 0:w.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((S=this.xyChart)==null?void 0:S.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((k=this.xyChart)==null?void 0:k.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((C=this.xyChart)==null?void 0:C.plotColorPalette)||"#ECECFF,#8493A6,#FFC3A0,#DCDDE1,#B8E994,#D1A36F,#C3CDE6,#FFB6C1,#496078,#F8F3E3"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.labelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||xt(this.primaryColor,{h:-30}),this.git4=this.git4||xt(this.primaryColor,{h:-60}),this.git5=this.git5||xt(this.primaryColor,{h:-90}),this.git6=this.git6||xt(this.primaryColor,{h:60}),this.git7=this.git7||xt(this.primaryColor,{h:120}),this.darkMode?(this.git0=Cn(this.git0,25),this.git1=Cn(this.git1,25),this.git2=Cn(this.git2,25),this.git3=Cn(this.git3,25),this.git4=Cn(this.git4,25),this.git5=Cn(this.git5,25),this.git6=Cn(this.git6,25),this.git7=Cn(this.git7,25)):(this.git0=Un(this.git0,25),this.git1=Un(this.git1,25),this.git2=Un(this.git2,25),this.git3=Un(this.git3,25),this.git4=Un(this.git4,25),this.git5=Un(this.git5,25),this.git6=Un(this.git6,25),this.git7=Un(this.git7,25)),this.gitInv0=this.gitInv0||Un(dn(this.git0),25),this.gitInv1=this.gitInv1||dn(this.git1),this.gitInv2=this.gitInv2||dn(this.git2),this.gitInv3=this.gitInv3||dn(this.git3),this.gitInv4=this.gitInv4||dn(this.git4),this.gitInv5=this.gitInv5||dn(this.git5),this.gitInv6=this.gitInv6||dn(this.git6),this.gitInv7=this.gitInv7||dn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||dn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||dn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||rA,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||sA}calculate(t){if(Object.keys(this).forEach(r=>{this[r]==="calculated"&&(this[r]=void 0)}),typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(Z0,"Theme"),Z0),eXe=ie(e=>{const t=new QZe;return t.calculate(e),t},"getThemeVariables"),X0,tXe=(X0=class{constructor(){this.background="#f4f4f4",this.primaryColor="#cde498",this.secondaryColor="#cdffb2",this.background="white",this.mainBkg="#cde498",this.secondBkg="#cdffb2",this.lineColor="green",this.border1="#13540c",this.border2="#6eaa49",this.arrowheadColor="green",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.tertiaryColor=Cn("#cde498",10),this.primaryBorderColor=ro(this.primaryColor,this.darkMode),this.secondaryBorderColor=ro(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=ro(this.tertiaryColor,this.darkMode),this.primaryTextColor=dn(this.primaryColor),this.secondaryTextColor=dn(this.secondaryColor),this.tertiaryTextColor=dn(this.primaryColor),this.lineColor=dn(this.background),this.textColor=dn(this.background),this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="#333",this.edgeLabelBackground="#e8e8e8",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="black",this.actorLineColor="calculated",this.signalColor="#333",this.signalTextColor="#333",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="#326932",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="#fff5ad",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="#6eaa49",this.altSectionBkgColor="white",this.sectionBkgColor2="#6eaa49",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="#487e3a",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="black",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="lightgrey",this.doneTaskBkgColor="lightgrey",this.doneTaskBorderColor="grey",this.critBorderColor="#ff8888",this.critBkgColor="red",this.todayLineColor="red",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C;this.actorBorder=Un(this.mainBkg,20),this.actorBkg=this.mainBkg,this.labelBoxBkgColor=this.actorBkg,this.labelTextColor=this.actorTextColor,this.loopTextColor=this.actorTextColor,this.noteBorderColor=this.border2,this.noteTextColor=this.actorTextColor,this.actorLineColor=this.actorBorder,this.cScale0=this.cScale0||this.primaryColor,this.cScale1=this.cScale1||this.secondaryColor,this.cScale2=this.cScale2||this.tertiaryColor,this.cScale3=this.cScale3||xt(this.primaryColor,{h:30}),this.cScale4=this.cScale4||xt(this.primaryColor,{h:60}),this.cScale5=this.cScale5||xt(this.primaryColor,{h:90}),this.cScale6=this.cScale6||xt(this.primaryColor,{h:120}),this.cScale7=this.cScale7||xt(this.primaryColor,{h:150}),this.cScale8=this.cScale8||xt(this.primaryColor,{h:210}),this.cScale9=this.cScale9||xt(this.primaryColor,{h:270}),this.cScale10=this.cScale10||xt(this.primaryColor,{h:300}),this.cScale11=this.cScale11||xt(this.primaryColor,{h:330}),this.cScalePeer1=this.cScalePeer1||Un(this.secondaryColor,45),this.cScalePeer2=this.cScalePeer2||Un(this.tertiaryColor,40);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScale"+T]=Un(this["cScale"+T],10),this["cScalePeer"+T]=this["cScalePeer"+T]||Un(this["cScale"+T],25);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||xt(this["cScale"+T],{h:180});this.scaleLabelColor=this.scaleLabelColor!=="calculated"&&this.scaleLabelColor?this.scaleLabelColor:this.labelTextColor;for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.scaleLabelColor;for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||xt(this.mainBkg,{h:30,s:-30,l:-(5+T*5)}),this["surfacePeer"+T]=this["surfacePeer"+T]||xt(this.mainBkg,{h:30,s:-30,l:-(8+T*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.taskBorderColor=this.border1,this.taskTextColor=this.taskTextLightColor,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.rowOdd=this.rowOdd||Cn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||Cn(this.mainBkg,20),this.transitionColor=this.transitionColor||this.lineColor,this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f0f0f0",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.compositeBorder=this.compositeBorder||this.nodeBorder,this.innerEndBackground=this.primaryBorderColor,this.specialStateColor=this.lineColor,this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.transitionColor=this.transitionColor||this.lineColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=xt(this.primaryColor,{h:64}),this.fillType3=xt(this.secondaryColor,{h:64}),this.fillType4=xt(this.primaryColor,{h:-64}),this.fillType5=xt(this.secondaryColor,{h:-64}),this.fillType6=xt(this.primaryColor,{h:128}),this.fillType7=xt(this.secondaryColor,{h:128}),this.pie1=this.pie1||this.primaryColor,this.pie2=this.pie2||this.secondaryColor,this.pie3=this.pie3||this.tertiaryColor,this.pie4=this.pie4||xt(this.primaryColor,{l:-30}),this.pie5=this.pie5||xt(this.secondaryColor,{l:-30}),this.pie6=this.pie6||xt(this.tertiaryColor,{h:40,l:-40}),this.pie7=this.pie7||xt(this.primaryColor,{h:60,l:-10}),this.pie8=this.pie8||xt(this.primaryColor,{h:-60,l:-10}),this.pie9=this.pie9||xt(this.primaryColor,{h:120,l:0}),this.pie10=this.pie10||xt(this.primaryColor,{h:60,l:-50}),this.pie11=this.pie11||xt(this.primaryColor,{h:-60,l:-50}),this.pie12=this.pie12||xt(this.primaryColor,{h:120,l:-50}),this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||xt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||xt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||xt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||xt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||xt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||xt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||p_(this.quadrant1Fill)?Cn(this.quadrant1Fill):Un(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.packet={startByteColor:this.primaryTextColor,endByteColor:this.primaryTextColor,labelColor:this.primaryTextColor,titleColor:this.primaryTextColor,blockStrokeColor:this.primaryTextColor,blockFillColor:this.mainBkg},this.radar={axisColor:((t=this.radar)==null?void 0:t.axisColor)||this.lineColor,axisStrokeWidth:((n=this.radar)==null?void 0:n.axisStrokeWidth)||2,axisLabelFontSize:((r=this.radar)==null?void 0:r.axisLabelFontSize)||12,curveOpacity:((s=this.radar)==null?void 0:s.curveOpacity)||.5,curveStrokeWidth:((i=this.radar)==null?void 0:i.curveStrokeWidth)||2,graticuleColor:((a=this.radar)==null?void 0:a.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((o=this.radar)==null?void 0:o.graticuleStrokeWidth)||1,graticuleOpacity:((l=this.radar)==null?void 0:l.graticuleOpacity)||.3,legendBoxSize:((c=this.radar)==null?void 0:c.legendBoxSize)||12,legendFontSize:((u=this.radar)==null?void 0:u.legendFontSize)||12},this.xyChart={backgroundColor:((d=this.xyChart)==null?void 0:d.backgroundColor)||this.background,titleColor:((h=this.xyChart)==null?void 0:h.titleColor)||this.primaryTextColor,xAxisTitleColor:((m=this.xyChart)==null?void 0:m.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((y=this.xyChart)==null?void 0:y.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((b=this.xyChart)==null?void 0:b.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((v=this.xyChart)==null?void 0:v.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((x=this.xyChart)==null?void 0:x.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((w=this.xyChart)==null?void 0:w.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((S=this.xyChart)==null?void 0:S.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((k=this.xyChart)==null?void 0:k.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((C=this.xyChart)==null?void 0:C.plotColorPalette)||"#CDE498,#FF6B6B,#A0D2DB,#D7BDE2,#F0F0F0,#FFC3A0,#7FD8BE,#FF9A8B,#FAF3E0,#FFF176"},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=this.git0||this.primaryColor,this.git1=this.git1||this.secondaryColor,this.git2=this.git2||this.tertiaryColor,this.git3=this.git3||xt(this.primaryColor,{h:-30}),this.git4=this.git4||xt(this.primaryColor,{h:-60}),this.git5=this.git5||xt(this.primaryColor,{h:-90}),this.git6=this.git6||xt(this.primaryColor,{h:60}),this.git7=this.git7||xt(this.primaryColor,{h:120}),this.darkMode?(this.git0=Cn(this.git0,25),this.git1=Cn(this.git1,25),this.git2=Cn(this.git2,25),this.git3=Cn(this.git3,25),this.git4=Cn(this.git4,25),this.git5=Cn(this.git5,25),this.git6=Cn(this.git6,25),this.git7=Cn(this.git7,25)):(this.git0=Un(this.git0,25),this.git1=Un(this.git1,25),this.git2=Un(this.git2,25),this.git3=Un(this.git3,25),this.git4=Un(this.git4,25),this.git5=Un(this.git5,25),this.git6=Un(this.git6,25),this.git7=Un(this.git7,25)),this.gitInv0=this.gitInv0||dn(this.git0),this.gitInv1=this.gitInv1||dn(this.git1),this.gitInv2=this.gitInv2||dn(this.git2),this.gitInv3=this.gitInv3||dn(this.git3),this.gitInv4=this.gitInv4||dn(this.git4),this.gitInv5=this.gitInv5||dn(this.git5),this.gitInv6=this.gitInv6||dn(this.git6),this.gitInv7=this.gitInv7||dn(this.git7),this.gitBranchLabel0=this.gitBranchLabel0||dn(this.labelTextColor),this.gitBranchLabel1=this.gitBranchLabel1||this.labelTextColor,this.gitBranchLabel2=this.gitBranchLabel2||this.labelTextColor,this.gitBranchLabel3=this.gitBranchLabel3||dn(this.labelTextColor),this.gitBranchLabel4=this.gitBranchLabel4||this.labelTextColor,this.gitBranchLabel5=this.gitBranchLabel5||this.labelTextColor,this.gitBranchLabel6=this.gitBranchLabel6||this.labelTextColor,this.gitBranchLabel7=this.gitBranchLabel7||this.labelTextColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||rA,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||sA}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(X0,"Theme"),X0),nXe=ie(e=>{const t=new tXe;return t.calculate(e),t},"getThemeVariables"),J0,rXe=(J0=class{constructor(){this.primaryColor="#eee",this.contrast="#707070",this.secondaryColor=Cn(this.contrast,55),this.background="#ffffff",this.tertiaryColor=xt(this.primaryColor,{h:-160}),this.primaryBorderColor=ro(this.primaryColor,this.darkMode),this.secondaryBorderColor=ro(this.secondaryColor,this.darkMode),this.tertiaryBorderColor=ro(this.tertiaryColor,this.darkMode),this.primaryTextColor=dn(this.primaryColor),this.secondaryTextColor=dn(this.secondaryColor),this.tertiaryTextColor=dn(this.tertiaryColor),this.lineColor=dn(this.background),this.textColor=dn(this.background),this.mainBkg="#eee",this.secondBkg="calculated",this.lineColor="#666",this.border1="#999",this.border2="calculated",this.note="#ffa",this.text="#333",this.critical="#d42",this.done="#bbb",this.arrowheadColor="#333333",this.fontFamily='"trebuchet ms", verdana, arial, sans-serif',this.fontSize="16px",this.THEME_COLOR_LIMIT=12,this.nodeBkg="calculated",this.nodeBorder="calculated",this.clusterBkg="calculated",this.clusterBorder="calculated",this.defaultLinkColor="calculated",this.titleColor="calculated",this.edgeLabelBackground="white",this.actorBorder="calculated",this.actorBkg="calculated",this.actorTextColor="calculated",this.actorLineColor=this.actorBorder,this.signalColor="calculated",this.signalTextColor="calculated",this.labelBoxBkgColor="calculated",this.labelBoxBorderColor="calculated",this.labelTextColor="calculated",this.loopTextColor="calculated",this.noteBorderColor="calculated",this.noteBkgColor="calculated",this.noteTextColor="calculated",this.activationBorderColor="#666",this.activationBkgColor="#f4f4f4",this.sequenceNumberColor="white",this.sectionBkgColor="calculated",this.altSectionBkgColor="white",this.sectionBkgColor2="calculated",this.excludeBkgColor="#eeeeee",this.taskBorderColor="calculated",this.taskBkgColor="calculated",this.taskTextLightColor="white",this.taskTextColor="calculated",this.taskTextDarkColor="calculated",this.taskTextOutsideColor="calculated",this.taskTextClickableColor="#003163",this.activeTaskBorderColor="calculated",this.activeTaskBkgColor="calculated",this.gridColor="calculated",this.doneTaskBkgColor="calculated",this.doneTaskBorderColor="calculated",this.critBkgColor="calculated",this.critBorderColor="calculated",this.todayLineColor="calculated",this.personBorder=this.primaryBorderColor,this.personBkg=this.mainBkg,this.archEdgeColor="calculated",this.archEdgeArrowColor="calculated",this.archEdgeWidth="3",this.archGroupBorderColor=this.primaryBorderColor,this.archGroupBorderWidth="2px",this.rowOdd=this.rowOdd||Cn(this.mainBkg,75)||"#ffffff",this.rowEven=this.rowEven||"#f4f4f4",this.labelColor="black",this.errorBkgColor="#552222",this.errorTextColor="#552222"}updateColors(){var t,n,r,s,i,a,o,l,c,u,d,h,m,y,b,v,x,w,S,k,C;this.secondBkg=Cn(this.contrast,55),this.border2=this.contrast,this.actorBorder=Cn(this.border1,23),this.actorBkg=this.mainBkg,this.actorTextColor=this.text,this.actorLineColor=this.actorBorder,this.signalColor=this.text,this.signalTextColor=this.text,this.labelBoxBkgColor=this.actorBkg,this.labelBoxBorderColor=this.actorBorder,this.labelTextColor=this.text,this.loopTextColor=this.text,this.noteBorderColor="#999",this.noteBkgColor="#666",this.noteTextColor="#fff",this.cScale0=this.cScale0||"#555",this.cScale1=this.cScale1||"#F4F4F4",this.cScale2=this.cScale2||"#555",this.cScale3=this.cScale3||"#BBB",this.cScale4=this.cScale4||"#777",this.cScale5=this.cScale5||"#999",this.cScale6=this.cScale6||"#DDD",this.cScale7=this.cScale7||"#FFF",this.cScale8=this.cScale8||"#DDD",this.cScale9=this.cScale9||"#BBB",this.cScale10=this.cScale10||"#999",this.cScale11=this.cScale11||"#777";for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleInv"+T]=this["cScaleInv"+T]||dn(this["cScale"+T]);for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this.darkMode?this["cScalePeer"+T]=this["cScalePeer"+T]||Cn(this["cScale"+T],10):this["cScalePeer"+T]=this["cScalePeer"+T]||Un(this["cScale"+T],10);this.scaleLabelColor=this.scaleLabelColor||(this.darkMode?"black":this.labelTextColor),this.cScaleLabel0=this.cScaleLabel0||this.cScale1,this.cScaleLabel2=this.cScaleLabel2||this.cScale1;for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["cScaleLabel"+T]=this["cScaleLabel"+T]||this.scaleLabelColor;for(let T=0;T<5;T++)this["surface"+T]=this["surface"+T]||xt(this.mainBkg,{l:-(5+T*5)}),this["surfacePeer"+T]=this["surfacePeer"+T]||xt(this.mainBkg,{l:-(8+T*5)});this.nodeBkg=this.mainBkg,this.nodeBorder=this.border1,this.clusterBkg=this.secondBkg,this.clusterBorder=this.border2,this.defaultLinkColor=this.lineColor,this.titleColor=this.text,this.sectionBkgColor=Cn(this.contrast,30),this.sectionBkgColor2=Cn(this.contrast,30),this.taskBorderColor=Un(this.contrast,10),this.taskBkgColor=this.contrast,this.taskTextColor=this.taskTextLightColor,this.taskTextDarkColor=this.text,this.taskTextOutsideColor=this.taskTextDarkColor,this.activeTaskBorderColor=this.taskBorderColor,this.activeTaskBkgColor=this.mainBkg,this.gridColor=Cn(this.border1,30),this.doneTaskBkgColor=this.done,this.doneTaskBorderColor=this.lineColor,this.critBkgColor=this.critical,this.critBorderColor=Un(this.critBkgColor,10),this.todayLineColor=this.critBkgColor,this.archEdgeColor=this.lineColor,this.archEdgeArrowColor=this.lineColor,this.transitionColor=this.transitionColor||"#000",this.transitionLabelColor=this.transitionLabelColor||this.textColor,this.stateLabelColor=this.stateLabelColor||this.stateBkg||this.primaryTextColor,this.stateBkg=this.stateBkg||this.mainBkg,this.labelBackgroundColor=this.labelBackgroundColor||this.stateBkg,this.compositeBackground=this.compositeBackground||this.background||this.tertiaryColor,this.altBackground=this.altBackground||"#f4f4f4",this.compositeTitleBackground=this.compositeTitleBackground||this.mainBkg,this.stateBorder=this.stateBorder||"#000",this.innerEndBackground=this.primaryBorderColor,this.specialStateColor="#222",this.errorBkgColor=this.errorBkgColor||this.tertiaryColor,this.errorTextColor=this.errorTextColor||this.tertiaryTextColor,this.classText=this.primaryTextColor,this.fillType0=this.primaryColor,this.fillType1=this.secondaryColor,this.fillType2=xt(this.primaryColor,{h:64}),this.fillType3=xt(this.secondaryColor,{h:64}),this.fillType4=xt(this.primaryColor,{h:-64}),this.fillType5=xt(this.secondaryColor,{h:-64}),this.fillType6=xt(this.primaryColor,{h:128}),this.fillType7=xt(this.secondaryColor,{h:128});for(let T=0;T<this.THEME_COLOR_LIMIT;T++)this["pie"+T]=this["cScale"+T];this.pie12=this.pie0,this.pieTitleTextSize=this.pieTitleTextSize||"25px",this.pieTitleTextColor=this.pieTitleTextColor||this.taskTextDarkColor,this.pieSectionTextSize=this.pieSectionTextSize||"17px",this.pieSectionTextColor=this.pieSectionTextColor||this.textColor,this.pieLegendTextSize=this.pieLegendTextSize||"17px",this.pieLegendTextColor=this.pieLegendTextColor||this.taskTextDarkColor,this.pieStrokeColor=this.pieStrokeColor||"black",this.pieStrokeWidth=this.pieStrokeWidth||"2px",this.pieOuterStrokeWidth=this.pieOuterStrokeWidth||"2px",this.pieOuterStrokeColor=this.pieOuterStrokeColor||"black",this.pieOpacity=this.pieOpacity||"0.7",this.quadrant1Fill=this.quadrant1Fill||this.primaryColor,this.quadrant2Fill=this.quadrant2Fill||xt(this.primaryColor,{r:5,g:5,b:5}),this.quadrant3Fill=this.quadrant3Fill||xt(this.primaryColor,{r:10,g:10,b:10}),this.quadrant4Fill=this.quadrant4Fill||xt(this.primaryColor,{r:15,g:15,b:15}),this.quadrant1TextFill=this.quadrant1TextFill||this.primaryTextColor,this.quadrant2TextFill=this.quadrant2TextFill||xt(this.primaryTextColor,{r:-5,g:-5,b:-5}),this.quadrant3TextFill=this.quadrant3TextFill||xt(this.primaryTextColor,{r:-10,g:-10,b:-10}),this.quadrant4TextFill=this.quadrant4TextFill||xt(this.primaryTextColor,{r:-15,g:-15,b:-15}),this.quadrantPointFill=this.quadrantPointFill||p_(this.quadrant1Fill)?Cn(this.quadrant1Fill):Un(this.quadrant1Fill),this.quadrantPointTextFill=this.quadrantPointTextFill||this.primaryTextColor,this.quadrantXAxisTextFill=this.quadrantXAxisTextFill||this.primaryTextColor,this.quadrantYAxisTextFill=this.quadrantYAxisTextFill||this.primaryTextColor,this.quadrantInternalBorderStrokeFill=this.quadrantInternalBorderStrokeFill||this.primaryBorderColor,this.quadrantExternalBorderStrokeFill=this.quadrantExternalBorderStrokeFill||this.primaryBorderColor,this.quadrantTitleFill=this.quadrantTitleFill||this.primaryTextColor,this.xyChart={backgroundColor:((t=this.xyChart)==null?void 0:t.backgroundColor)||this.background,titleColor:((n=this.xyChart)==null?void 0:n.titleColor)||this.primaryTextColor,xAxisTitleColor:((r=this.xyChart)==null?void 0:r.xAxisTitleColor)||this.primaryTextColor,xAxisLabelColor:((s=this.xyChart)==null?void 0:s.xAxisLabelColor)||this.primaryTextColor,xAxisTickColor:((i=this.xyChart)==null?void 0:i.xAxisTickColor)||this.primaryTextColor,xAxisLineColor:((a=this.xyChart)==null?void 0:a.xAxisLineColor)||this.primaryTextColor,yAxisTitleColor:((o=this.xyChart)==null?void 0:o.yAxisTitleColor)||this.primaryTextColor,yAxisLabelColor:((l=this.xyChart)==null?void 0:l.yAxisLabelColor)||this.primaryTextColor,yAxisTickColor:((c=this.xyChart)==null?void 0:c.yAxisTickColor)||this.primaryTextColor,yAxisLineColor:((u=this.xyChart)==null?void 0:u.yAxisLineColor)||this.primaryTextColor,plotColorPalette:((d=this.xyChart)==null?void 0:d.plotColorPalette)||"#EEE,#6BB8E4,#8ACB88,#C7ACD6,#E8DCC2,#FFB2A8,#FFF380,#7E8D91,#FFD8B1,#FAF3E0"},this.radar={axisColor:((h=this.radar)==null?void 0:h.axisColor)||this.lineColor,axisStrokeWidth:((m=this.radar)==null?void 0:m.axisStrokeWidth)||2,axisLabelFontSize:((y=this.radar)==null?void 0:y.axisLabelFontSize)||12,curveOpacity:((b=this.radar)==null?void 0:b.curveOpacity)||.5,curveStrokeWidth:((v=this.radar)==null?void 0:v.curveStrokeWidth)||2,graticuleColor:((x=this.radar)==null?void 0:x.graticuleColor)||"#DEDEDE",graticuleStrokeWidth:((w=this.radar)==null?void 0:w.graticuleStrokeWidth)||1,graticuleOpacity:((S=this.radar)==null?void 0:S.graticuleOpacity)||.3,legendBoxSize:((k=this.radar)==null?void 0:k.legendBoxSize)||12,legendFontSize:((C=this.radar)==null?void 0:C.legendFontSize)||12},this.requirementBackground=this.requirementBackground||this.primaryColor,this.requirementBorderColor=this.requirementBorderColor||this.primaryBorderColor,this.requirementBorderSize=this.requirementBorderSize||"1",this.requirementTextColor=this.requirementTextColor||this.primaryTextColor,this.relationColor=this.relationColor||this.lineColor,this.relationLabelBackground=this.relationLabelBackground||this.edgeLabelBackground,this.relationLabelColor=this.relationLabelColor||this.actorTextColor,this.git0=Un(this.pie1,25)||this.primaryColor,this.git1=this.pie2||this.secondaryColor,this.git2=this.pie3||this.tertiaryColor,this.git3=this.pie4||xt(this.primaryColor,{h:-30}),this.git4=this.pie5||xt(this.primaryColor,{h:-60}),this.git5=this.pie6||xt(this.primaryColor,{h:-90}),this.git6=this.pie7||xt(this.primaryColor,{h:60}),this.git7=this.pie8||xt(this.primaryColor,{h:120}),this.gitInv0=this.gitInv0||dn(this.git0),this.gitInv1=this.gitInv1||dn(this.git1),this.gitInv2=this.gitInv2||dn(this.git2),this.gitInv3=this.gitInv3||dn(this.git3),this.gitInv4=this.gitInv4||dn(this.git4),this.gitInv5=this.gitInv5||dn(this.git5),this.gitInv6=this.gitInv6||dn(this.git6),this.gitInv7=this.gitInv7||dn(this.git7),this.branchLabelColor=this.branchLabelColor||this.labelTextColor,this.gitBranchLabel0=this.branchLabelColor,this.gitBranchLabel1="white",this.gitBranchLabel2=this.branchLabelColor,this.gitBranchLabel3="white",this.gitBranchLabel4=this.branchLabelColor,this.gitBranchLabel5=this.branchLabelColor,this.gitBranchLabel6=this.branchLabelColor,this.gitBranchLabel7=this.branchLabelColor,this.tagLabelColor=this.tagLabelColor||this.primaryTextColor,this.tagLabelBackground=this.tagLabelBackground||this.primaryColor,this.tagLabelBorder=this.tagBorder||this.primaryBorderColor,this.tagLabelFontSize=this.tagLabelFontSize||"10px",this.commitLabelColor=this.commitLabelColor||this.secondaryTextColor,this.commitLabelBackground=this.commitLabelBackground||this.secondaryColor,this.commitLabelFontSize=this.commitLabelFontSize||"10px",this.attributeBackgroundColorOdd=this.attributeBackgroundColorOdd||rA,this.attributeBackgroundColorEven=this.attributeBackgroundColorEven||sA}calculate(t){if(typeof t!="object"){this.updateColors();return}const n=Object.keys(t);n.forEach(r=>{this[r]=t[r]}),this.updateColors(),n.forEach(r=>{this[r]=t[r]})}},ie(J0,"Theme"),J0),sXe=ie(e=>{const t=new rXe;return t.calculate(e),t},"getThemeVariables"),Vd={base:{getThemeVariables:ZZe},dark:{getThemeVariables:JZe},default:{getThemeVariables:eXe},forest:{getThemeVariables:nXe},neutral:{getThemeVariables:sXe}},_d={flowchart:{useMaxWidth:!0,titleTopMargin:25,subGraphTitleMargin:{top:0,bottom:0},diagramPadding:8,htmlLabels:!0,nodeSpacing:50,rankSpacing:50,curve:"basis",padding:15,defaultRenderer:"dagre-wrapper",wrappingWidth:200},sequence:{useMaxWidth:!0,hideUnusedParticipants:!1,activationWidth:10,diagramMarginX:50,diagramMarginY:10,actorMargin:50,width:150,height:65,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",mirrorActors:!0,forceMenus:!1,bottomMarginAdj:1,rightAngles:!1,showSequenceNumbers:!1,actorFontSize:14,actorFontFamily:'"Open Sans", sans-serif',actorFontWeight:400,noteFontSize:14,noteFontFamily:'"trebuchet ms", verdana, arial, sans-serif',noteFontWeight:400,noteAlign:"center",messageFontSize:16,messageFontFamily:'"trebuchet ms", verdana, arial, sans-serif',messageFontWeight:400,wrap:!1,wrapPadding:10,labelBoxWidth:50,labelBoxHeight:20},gantt:{useMaxWidth:!0,titleTopMargin:25,barHeight:20,barGap:4,topPadding:50,rightPadding:75,leftPadding:75,gridLineStartPadding:35,fontSize:11,sectionFontSize:11,numberSectionStyles:4,axisFormat:"%Y-%m-%d",topAxis:!1,displayMode:"",weekday:"sunday"},journey:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"]},class:{useMaxWidth:!0,titleTopMargin:25,arrowMarkerAbsolute:!1,dividerMargin:10,padding:5,textHeight:10,defaultRenderer:"dagre-wrapper",htmlLabels:!1,hideEmptyMembersBox:!1},state:{useMaxWidth:!0,titleTopMargin:25,dividerMargin:10,sizeUnit:5,padding:8,textHeight:10,titleShift:-15,noteMargin:10,forkWidth:70,forkHeight:7,miniPadding:2,fontSizeFactor:5.02,fontSize:24,labelHeight:16,edgeLengthFactor:"20",compositTitleSize:35,radius:5,defaultRenderer:"dagre-wrapper"},er:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:20,layoutDirection:"TB",minEntityWidth:100,minEntityHeight:75,entityPadding:15,nodeSpacing:140,rankSpacing:80,stroke:"gray",fill:"honeydew",fontSize:12},pie:{useMaxWidth:!0,textPosition:.75},quadrantChart:{useMaxWidth:!0,chartWidth:500,chartHeight:500,titleFontSize:20,titlePadding:10,quadrantPadding:5,xAxisLabelPadding:5,yAxisLabelPadding:5,xAxisLabelFontSize:16,yAxisLabelFontSize:16,quadrantLabelFontSize:16,quadrantTextTopPadding:5,pointTextPadding:5,pointLabelFontSize:12,pointRadius:5,xAxisPosition:"top",yAxisPosition:"left",quadrantInternalBorderStrokeWidth:1,quadrantExternalBorderStrokeWidth:2},xyChart:{useMaxWidth:!0,width:700,height:500,titleFontSize:20,titlePadding:10,showTitle:!0,xAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},yAxis:{$ref:"#/$defs/XYChartAxisConfig",showLabel:!0,labelFontSize:14,labelPadding:5,showTitle:!0,titleFontSize:16,titlePadding:5,showTick:!0,tickLength:5,tickWidth:2,showAxisLine:!0,axisLineWidth:2},chartOrientation:"vertical",plotReservedSpacePercent:50},requirement:{useMaxWidth:!0,rect_fill:"#f9f9f9",text_color:"#333",rect_border_size:"0.5px",rect_border_color:"#bbb",rect_min_width:200,rect_min_height:200,fontSize:14,rect_padding:10,line_height:20},mindmap:{useMaxWidth:!0,padding:10,maxNodeWidth:200},kanban:{useMaxWidth:!0,padding:8,sectionWidth:200,ticketBaseUrl:""},timeline:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,leftMargin:150,width:150,height:50,boxMargin:10,boxTextMargin:5,noteMargin:10,messageMargin:35,messageAlign:"center",bottomMarginAdj:1,rightAngles:!1,taskFontSize:14,taskFontFamily:'"Open Sans", sans-serif',taskMargin:50,activationWidth:10,textPlacement:"fo",actorColours:["#8FBC8F","#7CFC00","#00FFFF","#20B2AA","#B0E0E6","#FFFFE0"],sectionFills:["#191970","#8B008B","#4B0082","#2F4F4F","#800000","#8B4513","#00008B"],sectionColours:["#fff"],disableMulticolor:!1},gitGraph:{useMaxWidth:!0,titleTopMargin:25,diagramPadding:8,nodeLabel:{width:75,height:100,x:-25,y:0},mainBranchName:"main",mainBranchOrder:0,showCommitLabel:!0,showBranches:!0,rotateCommitLabel:!0,parallelCommits:!1,arrowMarkerAbsolute:!1},c4:{useMaxWidth:!0,diagramMarginX:50,diagramMarginY:10,c4ShapeMargin:50,c4ShapePadding:20,width:216,height:60,boxMargin:10,c4ShapeInRow:4,nextLinePaddingX:0,c4BoundaryInRow:2,personFontSize:14,personFontFamily:'"Open Sans", sans-serif',personFontWeight:"normal",external_personFontSize:14,external_personFontFamily:'"Open Sans", sans-serif',external_personFontWeight:"normal",systemFontSize:14,systemFontFamily:'"Open Sans", sans-serif',systemFontWeight:"normal",external_systemFontSize:14,external_systemFontFamily:'"Open Sans", sans-serif',external_systemFontWeight:"normal",system_dbFontSize:14,system_dbFontFamily:'"Open Sans", sans-serif',system_dbFontWeight:"normal",external_system_dbFontSize:14,external_system_dbFontFamily:'"Open Sans", sans-serif',external_system_dbFontWeight:"normal",system_queueFontSize:14,system_queueFontFamily:'"Open Sans", sans-serif',system_queueFontWeight:"normal",external_system_queueFontSize:14,external_system_queueFontFamily:'"Open Sans", sans-serif',external_system_queueFontWeight:"normal",boundaryFontSize:14,boundaryFontFamily:'"Open Sans", sans-serif',boundaryFontWeight:"normal",messageFontSize:12,messageFontFamily:'"Open Sans", sans-serif',messageFontWeight:"normal",containerFontSize:14,containerFontFamily:'"Open Sans", sans-serif',containerFontWeight:"normal",external_containerFontSize:14,external_containerFontFamily:'"Open Sans", sans-serif',external_containerFontWeight:"normal",container_dbFontSize:14,container_dbFontFamily:'"Open Sans", sans-serif',container_dbFontWeight:"normal",external_container_dbFontSize:14,external_container_dbFontFamily:'"Open Sans", sans-serif',external_container_dbFontWeight:"normal",container_queueFontSize:14,container_queueFontFamily:'"Open Sans", sans-serif',container_queueFontWeight:"normal",external_container_queueFontSize:14,external_container_queueFontFamily:'"Open Sans", sans-serif',external_container_queueFontWeight:"normal",componentFontSize:14,componentFontFamily:'"Open Sans", sans-serif',componentFontWeight:"normal",external_componentFontSize:14,external_componentFontFamily:'"Open Sans", sans-serif',external_componentFontWeight:"normal",component_dbFontSize:14,component_dbFontFamily:'"Open Sans", sans-serif',component_dbFontWeight:"normal",external_component_dbFontSize:14,external_component_dbFontFamily:'"Open Sans", sans-serif',external_component_dbFontWeight:"normal",component_queueFontSize:14,component_queueFontFamily:'"Open Sans", sans-serif',component_queueFontWeight:"normal",external_component_queueFontSize:14,external_component_queueFontFamily:'"Open Sans", sans-serif',external_component_queueFontWeight:"normal",wrap:!0,wrapPadding:10,person_bg_color:"#08427B",person_border_color:"#073B6F",external_person_bg_color:"#686868",external_person_border_color:"#8A8A8A",system_bg_color:"#1168BD",system_border_color:"#3C7FC0",system_db_bg_color:"#1168BD",system_db_border_color:"#3C7FC0",system_queue_bg_color:"#1168BD",system_queue_border_color:"#3C7FC0",external_system_bg_color:"#999999",external_system_border_color:"#8A8A8A",external_system_db_bg_color:"#999999",external_system_db_border_color:"#8A8A8A",external_system_queue_bg_color:"#999999",external_system_queue_border_color:"#8A8A8A",container_bg_color:"#438DD5",container_border_color:"#3C7FC0",container_db_bg_color:"#438DD5",container_db_border_color:"#3C7FC0",container_queue_bg_color:"#438DD5",container_queue_border_color:"#3C7FC0",external_container_bg_color:"#B3B3B3",external_container_border_color:"#A6A6A6",external_container_db_bg_color:"#B3B3B3",external_container_db_border_color:"#A6A6A6",external_container_queue_bg_color:"#B3B3B3",external_container_queue_border_color:"#A6A6A6",component_bg_color:"#85BBF0",component_border_color:"#78A8D8",component_db_bg_color:"#85BBF0",component_db_border_color:"#78A8D8",component_queue_bg_color:"#85BBF0",component_queue_border_color:"#78A8D8",external_component_bg_color:"#CCCCCC",external_component_border_color:"#BFBFBF",external_component_db_bg_color:"#CCCCCC",external_component_db_border_color:"#BFBFBF",external_component_queue_bg_color:"#CCCCCC",external_component_queue_border_color:"#BFBFBF"},sankey:{useMaxWidth:!0,width:600,height:400,linkColor:"gradient",nodeAlignment:"justify",showValues:!0,prefix:"",suffix:""},block:{useMaxWidth:!0,padding:8},packet:{useMaxWidth:!0,rowHeight:32,bitWidth:32,bitsPerRow:32,showBits:!0,paddingX:5,paddingY:5},architecture:{useMaxWidth:!0,padding:40,iconSize:80,fontSize:16},radar:{useMaxWidth:!0,width:600,height:600,marginTop:50,marginRight:50,marginBottom:50,marginLeft:50,axisScaleFactor:1,axisLabelFactor:1.05,curveTension:.17},theme:"default",look:"classic",handDrawnSeed:0,layout:"dagre",maxTextSize:5e4,maxEdges:500,darkMode:!1,fontFamily:'"trebuchet ms", verdana, arial, sans-serif;',logLevel:5,securityLevel:"strict",startOnLoad:!0,arrowMarkerAbsolute:!1,secure:["secure","securityLevel","startOnLoad","maxTextSize","suppressErrorRendering","maxEdges"],legacyMathML:!1,forceLegacyMathML:!1,deterministicIds:!1,fontSize:16,markdownAutoWrap:!0,suppressErrorRendering:!1},Kie={..._d,deterministicIDSeed:void 0,elk:{mergeEdges:!1,nodePlacementStrategy:"BRANDES_KOEPF"},themeCSS:void 0,themeVariables:Vd.default.getThemeVariables(),sequence:{..._d.sequence,messageFont:ie(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont"),noteFont:ie(function(){return{fontFamily:this.noteFontFamily,fontSize:this.noteFontSize,fontWeight:this.noteFontWeight}},"noteFont"),actorFont:ie(function(){return{fontFamily:this.actorFontFamily,fontSize:this.actorFontSize,fontWeight:this.actorFontWeight}},"actorFont")},class:{hideEmptyMembersBox:!1},gantt:{..._d.gantt,tickInterval:void 0,useWidth:void 0},c4:{..._d.c4,useWidth:void 0,personFont:ie(function(){return{fontFamily:this.personFontFamily,fontSize:this.personFontSize,fontWeight:this.personFontWeight}},"personFont"),external_personFont:ie(function(){return{fontFamily:this.external_personFontFamily,fontSize:this.external_personFontSize,fontWeight:this.external_personFontWeight}},"external_personFont"),systemFont:ie(function(){return{fontFamily:this.systemFontFamily,fontSize:this.systemFontSize,fontWeight:this.systemFontWeight}},"systemFont"),external_systemFont:ie(function(){return{fontFamily:this.external_systemFontFamily,fontSize:this.external_systemFontSize,fontWeight:this.external_systemFontWeight}},"external_systemFont"),system_dbFont:ie(function(){return{fontFamily:this.system_dbFontFamily,fontSize:this.system_dbFontSize,fontWeight:this.system_dbFontWeight}},"system_dbFont"),external_system_dbFont:ie(function(){return{fontFamily:this.external_system_dbFontFamily,fontSize:this.external_system_dbFontSize,fontWeight:this.external_system_dbFontWeight}},"external_system_dbFont"),system_queueFont:ie(function(){return{fontFamily:this.system_queueFontFamily,fontSize:this.system_queueFontSize,fontWeight:this.system_queueFontWeight}},"system_queueFont"),external_system_queueFont:ie(function(){return{fontFamily:this.external_system_queueFontFamily,fontSize:this.external_system_queueFontSize,fontWeight:this.external_system_queueFontWeight}},"external_system_queueFont"),containerFont:ie(function(){return{fontFamily:this.containerFontFamily,fontSize:this.containerFontSize,fontWeight:this.containerFontWeight}},"containerFont"),external_containerFont:ie(function(){return{fontFamily:this.external_containerFontFamily,fontSize:this.external_containerFontSize,fontWeight:this.external_containerFontWeight}},"external_containerFont"),container_dbFont:ie(function(){return{fontFamily:this.container_dbFontFamily,fontSize:this.container_dbFontSize,fontWeight:this.container_dbFontWeight}},"container_dbFont"),external_container_dbFont:ie(function(){return{fontFamily:this.external_container_dbFontFamily,fontSize:this.external_container_dbFontSize,fontWeight:this.external_container_dbFontWeight}},"external_container_dbFont"),container_queueFont:ie(function(){return{fontFamily:this.container_queueFontFamily,fontSize:this.container_queueFontSize,fontWeight:this.container_queueFontWeight}},"container_queueFont"),external_container_queueFont:ie(function(){return{fontFamily:this.external_container_queueFontFamily,fontSize:this.external_container_queueFontSize,fontWeight:this.external_container_queueFontWeight}},"external_container_queueFont"),componentFont:ie(function(){return{fontFamily:this.componentFontFamily,fontSize:this.componentFontSize,fontWeight:this.componentFontWeight}},"componentFont"),external_componentFont:ie(function(){return{fontFamily:this.external_componentFontFamily,fontSize:this.external_componentFontSize,fontWeight:this.external_componentFontWeight}},"external_componentFont"),component_dbFont:ie(function(){return{fontFamily:this.component_dbFontFamily,fontSize:this.component_dbFontSize,fontWeight:this.component_dbFontWeight}},"component_dbFont"),external_component_dbFont:ie(function(){return{fontFamily:this.external_component_dbFontFamily,fontSize:this.external_component_dbFontSize,fontWeight:this.external_component_dbFontWeight}},"external_component_dbFont"),component_queueFont:ie(function(){return{fontFamily:this.component_queueFontFamily,fontSize:this.component_queueFontSize,fontWeight:this.component_queueFontWeight}},"component_queueFont"),external_component_queueFont:ie(function(){return{fontFamily:this.external_component_queueFontFamily,fontSize:this.external_component_queueFontSize,fontWeight:this.external_component_queueFontWeight}},"external_component_queueFont"),boundaryFont:ie(function(){return{fontFamily:this.boundaryFontFamily,fontSize:this.boundaryFontSize,fontWeight:this.boundaryFontWeight}},"boundaryFont"),messageFont:ie(function(){return{fontFamily:this.messageFontFamily,fontSize:this.messageFontSize,fontWeight:this.messageFontWeight}},"messageFont")},pie:{..._d.pie,useWidth:984},xyChart:{..._d.xyChart,useWidth:void 0},requirement:{..._d.requirement,useWidth:void 0},packet:{..._d.packet},radar:{..._d.radar}},Yie=ie((e,t="")=>Object.keys(e).reduce((n,r)=>Array.isArray(e[r])?n:typeof e[r]=="object"&&e[r]!==null?[...n,t+r,...Yie(e[r],"")]:[...n,t+r],[]),"keyify"),iXe=new Set(Yie(Kie,"")),Zie=Kie,Lk=ie(e=>{if(Ut.debug("sanitizeDirective called with",e),!(typeof e!="object"||e==null)){if(Array.isArray(e)){e.forEach(t=>Lk(t));return}for(const t of Object.keys(e)){if(Ut.debug("Checking key",t),t.startsWith("__")||t.includes("proto")||t.includes("constr")||!iXe.has(t)||e[t]==null){Ut.debug("sanitize deleting key: ",t),delete e[t];continue}if(typeof e[t]=="object"){Ut.debug("sanitizing object",t),Lk(e[t]);continue}const n=["themeCSS","fontFamily","altFontFamily"];for(const r of n)t.includes(r)&&(Ut.debug("sanitizing css option",t),e[t]=aXe(e[t]))}if(e.themeVariables)for(const t of Object.keys(e.themeVariables)){const n=e.themeVariables[t];n!=null&&n.match&&!n.match(/^[\d "#%(),.;A-Za-z]+$/)&&(e.themeVariables[t]="")}Ut.debug("After sanitization",e)}},"sanitizeDirective"),aXe=ie(e=>{let t=0,n=0;for(const r of e){if(t<n)return"{ /* ERROR: Unbalanced CSS */ }";r==="{"?t++:r==="}"&&n++}return t!==n?"{ /* ERROR: Unbalanced CSS */ }":e},"sanitizeCss"),Py=Object.freeze(Zie),To=Ca({},Py),Xie,Oy=[],Gx=Ca({},Py),iA=ie((e,t)=>{let n=Ca({},e),r={};for(const s of t)eae(s),r=Ca(r,s);if(n=Ca(n,r),r.theme&&r.theme in Vd){const s=Ca({},Xie),i=Ca(s.themeVariables||{},r.themeVariables);n.theme&&n.theme in Vd&&(n.themeVariables=Vd[n.theme].getThemeVariables(i))}return Gx=n,tae(Gx),Gx},"updateCurrentConfig"),oXe=ie(e=>(To=Ca({},Py),To=Ca(To,e),e.theme&&Vd[e.theme]&&(To.themeVariables=Vd[e.theme].getThemeVariables(e.themeVariables)),iA(To,Oy),To),"setSiteConfig"),lXe=ie(e=>{Xie=Ca({},e)},"saveConfigFromInitialize"),cXe=ie(e=>(To=Ca(To,e),iA(To,Oy),To),"updateSiteConfig"),Jie=ie(()=>Ca({},To),"getSiteConfig"),Qie=ie(e=>(tae(e),Ca(Gx,e),zo()),"setConfig"),zo=ie(()=>Ca({},Gx),"getConfig"),eae=ie(e=>{e&&(["secure",...To.secure??[]].forEach(t=>{Object.hasOwn(e,t)&&(Ut.debug(`Denied attempt to modify a secure key ${t}`,e[t]),delete e[t])}),Object.keys(e).forEach(t=>{t.startsWith("__")&&delete e[t]}),Object.keys(e).forEach(t=>{typeof e[t]=="string"&&(e[t].includes("<")||e[t].includes(">")||e[t].includes("url(data:"))&&delete e[t],typeof e[t]=="object"&&eae(e[t])}))},"sanitize"),uXe=ie(e=>{var t;Lk(e),e.fontFamily&&!((t=e.themeVariables)!=null&&t.fontFamily)&&(e.themeVariables={...e.themeVariables,fontFamily:e.fontFamily}),Oy.push(e),iA(To,Oy)},"addDirective"),Bk=ie((e=To)=>{Oy=[],iA(e,Oy)},"reset"),dXe={LAZY_LOAD_DEPRECATED:"The configuration options lazyLoadedDiagrams and loadExternalDiagramsAtStartup are deprecated. Please use registerExternalDiagrams instead."},TV={},fXe=ie(e=>{TV[e]||(Ut.warn(dXe[e]),TV[e]=!0)},"issueWarning"),tae=ie(e=>{e&&(e.lazyLoadedDiagrams||e.loadExternalDiagramsAtStartup)&&fXe("LAZY_LOAD_DEPRECATED")},"checkConfig"),m_=/<br\s*\/?>/gi,hXe=ie(e=>e?sae(e).replace(/\\n/g,"#br#").split("#br#"):[""],"getRows"),pXe=(()=>{let e=!1;return()=>{e||(nae(),e=!0)}})();function nae(){const e="data-temp-href-target";Iy.addHook("beforeSanitizeAttributes",t=>{t instanceof Element&&t.tagName==="A"&&t.hasAttribute("target")&&t.setAttribute(e,t.getAttribute("target")??"")}),Iy.addHook("afterSanitizeAttributes",t=>{t instanceof Element&&t.tagName==="A"&&t.hasAttribute(e)&&(t.setAttribute("target",t.getAttribute(e)??""),t.removeAttribute(e),t.getAttribute("target")==="_blank"&&t.setAttribute("rel","noopener"))})}ie(nae,"setupDompurifyHooks");var rae=ie(e=>(pXe(),Iy.sanitize(e)),"removeScript"),AV=ie((e,t)=>{var n;if(((n=t.flowchart)==null?void 0:n.htmlLabels)!==!1){const r=t.securityLevel;r==="antiscript"||r==="strict"?e=rae(e):r!=="loose"&&(e=sae(e),e=e.replace(/</g,"&lt;").replace(/>/g,"&gt;"),e=e.replace(/=/g,"&equals;"),e=bXe(e))}return e},"sanitizeMore"),Bm=ie((e,t)=>e&&(t.dompurifyConfig?e=Iy.sanitize(AV(e,t),t.dompurifyConfig).toString():e=Iy.sanitize(AV(e,t),{FORBID_TAGS:["style"]}).toString(),e),"sanitizeText"),mXe=ie((e,t)=>typeof e=="string"?Bm(e,t):e.flat().map(n=>Bm(n,t)),"sanitizeTextOrArray"),gXe=ie(e=>m_.test(e),"hasBreaks"),yXe=ie(e=>e.split(m_),"splitBreaks"),bXe=ie(e=>e.replace(/#br#/g,"<br/>"),"placeholderToBreak"),sae=ie(e=>e.replace(m_,"#br#"),"breakToPlaceholder"),vXe=ie(e=>{let t="";return e&&(t=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,t=t.replaceAll(/\(/g,"\\("),t=t.replaceAll(/\)/g,"\\)")),t},"getUrl"),Ki=ie(e=>!(e===!1||["false","null","0"].includes(String(e).trim().toLowerCase())),"evaluate"),xXe=ie(function(...e){const t=e.filter(n=>!isNaN(n));return Math.max(...t)},"getMax"),wXe=ie(function(...e){const t=e.filter(n=>!isNaN(n));return Math.min(...t)},"getMin"),RV=ie(function(e){const t=e.split(/(,)/),n=[];for(let r=0;r<t.length;r++){let s=t[r];if(s===","&&r>0&&r+1<t.length){const i=t[r-1],a=t[r+1];_Xe(i,a)&&(s=i+","+a,r++,n.pop())}n.push(SXe(s))}return n.join("")},"parseGenericTypes"),Y4=ie((e,t)=>Math.max(0,e.split(t).length-1),"countOccurrence"),_Xe=ie((e,t)=>{const n=Y4(e,"~"),r=Y4(t,"~");return n===1&&r===1},"shouldCombineSets"),SXe=ie(e=>{const t=Y4(e,"~");let n=!1;if(t<=1)return e;t%2!==0&&e.startsWith("~")&&(e=e.substring(1),n=!0);const r=[...e];let s=r.indexOf("~"),i=r.lastIndexOf("~");for(;s!==-1&&i!==-1&&s!==i;)r[s]="<",r[i]=">",s=r.indexOf("~"),i=r.lastIndexOf("~");return n&&r.unshift("~"),r.join("")},"processSet"),NV=ie(()=>window.MathMLElement!==void 0,"isMathMLSupported"),Z4=/\$\$(.*)\$\$/g,Dy=ie(e=>{var t;return(((t=e.match(Z4))==null?void 0:t.length)??0)>0},"hasKatex"),Ydt=ie(async(e,t)=>{e=await b6(e,t);const n=document.createElement("div");n.innerHTML=e,n.id="katex-temp",n.style.visibility="hidden",n.style.position="absolute",n.style.top="0";const r=document.querySelector("body");r==null||r.insertAdjacentElement("beforeend",n);const s={width:n.clientWidth,height:n.clientHeight};return n.remove(),s},"calculateMathMLDimensions"),b6=ie(async(e,t)=>{if(!Dy(e))return e;if(!(NV()||t.legacyMathML||t.forceLegacyMathML))return e.replace(Z4,"MathML is unsupported in this environment.");const{default:n}=await Dr(async()=>{const{default:s}=await import("./katex-ChWnQ-fc.js");return{default:s}},[]),r=t.forceLegacyMathML||!NV()&&t.legacyMathML?"htmlAndMathml":"mathml";return e.split(m_).map(s=>Dy(s)?`<div style="display: flex; align-items: center; justify-content: center; white-space: nowrap;">${s}</div>`:`<div>${s}</div>`).join("").replace(Z4,(s,i)=>n.renderToString(i,{throwOnError:!0,displayMode:!0,output:r}).replace(/\n/g," ").replace(/<annotation.*<\/annotation>/g,""))},"renderKatex"),Eb={getRows:hXe,sanitizeText:Bm,sanitizeTextOrArray:mXe,hasBreaks:gXe,splitBreaks:yXe,lineBreakRegex:m_,removeScript:rae,getUrl:vXe,evaluate:Ki,getMax:xXe,getMin:wXe},CXe=ie(function(e,t){for(let n of t)e.attr(n[0],n[1])},"d3Attrs"),kXe=ie(function(e,t,n){let r=new Map;return n?(r.set("width","100%"),r.set("style",`max-width: ${t}px;`)):(r.set("height",e),r.set("width",t)),r},"calculateSvgSizeAttrs"),iae=ie(function(e,t,n,r){const s=kXe(t,n,r);CXe(e,s)},"configureSvgSize"),EXe=ie(function(e,t,n,r){const s=t.node().getBBox(),i=s.width,a=s.height;Ut.info(`SVG bounds: ${i}x${a}`,s);let o=0,l=0;Ut.info(`Graph bounds: ${o}x${l}`,e),o=i+n*2,l=a+n*2,Ut.info(`Calculated bounds: ${o}x${l}`),iae(t,l,o,r);const c=`${s.x-n} ${s.y-n} ${s.width+2*n} ${s.height+2*n}`;t.attr("viewBox",c)},"setupGraphViewbox"),QC={},TXe=ie((e,t,n)=>{let r="";return e in QC&&QC[e]?r=QC[e](n):Ut.warn(`No theme found for ${e}`),` & {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
    fill: ${n.textColor}
  }
  @keyframes edge-animation-frame {
    from {
      stroke-dashoffset: 0;
    }
  }
  @keyframes dash {
    to {
      stroke-dashoffset: 0;
    }
  }
  & .edge-animation-slow {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 50s linear infinite;
    stroke-linecap: round;
  }
  & .edge-animation-fast {
    stroke-dasharray: 9,5 !important;
    stroke-dashoffset: 900;
    animation: dash 20s linear infinite;
    stroke-linecap: round;
  }
  /* Classes common for multiple diagrams */

  & .error-icon {
    fill: ${n.errorBkgColor};
  }
  & .error-text {
    fill: ${n.errorTextColor};
    stroke: ${n.errorTextColor};
  }

  & .edge-thickness-normal {
    stroke-width: 1px;
  }
  & .edge-thickness-thick {
    stroke-width: 3.5px
  }
  & .edge-pattern-solid {
    stroke-dasharray: 0;
  }
  & .edge-thickness-invisible {
    stroke-width: 0;
    fill: none;
  }
  & .edge-pattern-dashed{
    stroke-dasharray: 3;
  }
  .edge-pattern-dotted {
    stroke-dasharray: 2;
  }

  & .marker {
    fill: ${n.lineColor};
    stroke: ${n.lineColor};
  }
  & .marker.cross {
    stroke: ${n.lineColor};
  }

  & svg {
    font-family: ${n.fontFamily};
    font-size: ${n.fontSize};
  }
   & p {
    margin: 0
   }

  ${r}

  ${t}
`},"getStyles"),AXe=ie((e,t)=>{t!==void 0&&(QC[e]=t)},"addStylesForDiagram"),RXe=TXe,aae={};HZe(aae,{clear:()=>NXe,getAccDescription:()=>PXe,getAccTitle:()=>IXe,getDiagramTitle:()=>DXe,setAccDescription:()=>jXe,setAccTitle:()=>MXe,setDiagramTitle:()=>OXe});var v6="",x6="",w6="",_6=ie(e=>Bm(e,zo()),"sanitizeText"),NXe=ie(()=>{v6="",w6="",x6=""},"clear"),MXe=ie(e=>{v6=_6(e).replace(/^\s+/g,"")},"setAccTitle"),IXe=ie(()=>v6,"getAccTitle"),jXe=ie(e=>{w6=_6(e).replace(/\n\s+/g,`
`)},"setAccDescription"),PXe=ie(()=>w6,"getAccDescription"),OXe=ie(e=>{x6=_6(e)},"setDiagramTitle"),DXe=ie(()=>x6,"getDiagramTitle"),MV=Ut,FXe=g6,ls=zo,Zdt=Qie,Xdt=Py,S6=ie(e=>Bm(e,ls()),"sanitizeText"),LXe=EXe,BXe=ie(()=>aae,"getCommonDb"),$k={},zk=ie((e,t,n)=>{var r;$k[e]&&MV.warn(`Diagram with id ${e} already registered. Overwriting.`),$k[e]=t,n&&Gie(e,n),AXe(e,t.styles),(r=t.injectUtils)==null||r.call(t,MV,FXe,ls,S6,LXe,BXe(),()=>{})},"registerDiagram"),X4=ie(e=>{if(e in $k)return $k[e];throw new $Xe(e)},"getDiagram"),Q0,$Xe=(Q0=class extends Error{constructor(t){super(`Diagram ${t} not found.`)}},ie(Q0,"DiagramNotFoundError"),Q0);function C6(e){return typeof e>"u"||e===null}ie(C6,"isNothing");function oae(e){return typeof e=="object"&&e!==null}ie(oae,"isObject");function lae(e){return Array.isArray(e)?e:C6(e)?[]:[e]}ie(lae,"toArray");function cae(e,t){var n,r,s,i;if(t)for(i=Object.keys(t),n=0,r=i.length;n<r;n+=1)s=i[n],e[s]=t[s];return e}ie(cae,"extend");function uae(e,t){var n="",r;for(r=0;r<t;r+=1)n+=e;return n}ie(uae,"repeat");function dae(e){return e===0&&Number.NEGATIVE_INFINITY===1/e}ie(dae,"isNegativeZero");var zXe=C6,UXe=oae,qXe=lae,VXe=uae,WXe=dae,HXe=cae,Vi={isNothing:zXe,isObject:UXe,toArray:qXe,repeat:VXe,isNegativeZero:WXe,extend:HXe};function k6(e,t){var n="",r=e.reason||"(unknown reason)";return e.mark?(e.mark.name&&(n+='in "'+e.mark.name+'" '),n+="("+(e.mark.line+1)+":"+(e.mark.column+1)+")",!t&&e.mark.snippet&&(n+=`

`+e.mark.snippet),r+" "+n):r}ie(k6,"formatError");function Fy(e,t){Error.call(this),this.name="YAMLException",this.reason=e,this.mark=t,this.message=k6(this,!1),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack||""}ie(Fy,"YAMLException$1");Fy.prototype=Object.create(Error.prototype);Fy.prototype.constructor=Fy;Fy.prototype.toString=ie(function(t){return this.name+": "+k6(this,t)},"toString");var Mo=Fy;function e2(e,t,n,r,s){var i="",a="",o=Math.floor(s/2)-1;return r-t>o&&(i=" ... ",t=r-o+i.length),n-r>o&&(a=" ...",n=r+o-a.length),{str:i+e.slice(t,n).replace(/\t/g,"")+a,pos:r-t+i.length}}ie(e2,"getLine");function t2(e,t){return Vi.repeat(" ",t-e.length)+e}ie(t2,"padStart");function fae(e,t){if(t=Object.create(t||null),!e.buffer)return null;t.maxLength||(t.maxLength=79),typeof t.indent!="number"&&(t.indent=1),typeof t.linesBefore!="number"&&(t.linesBefore=3),typeof t.linesAfter!="number"&&(t.linesAfter=2);for(var n=/\r?\n|\r|\0/g,r=[0],s=[],i,a=-1;i=n.exec(e.buffer);)s.push(i.index),r.push(i.index+i[0].length),e.position<=i.index&&a<0&&(a=r.length-2);a<0&&(a=r.length-1);var o="",l,c,u=Math.min(e.line+t.linesAfter,s.length).toString().length,d=t.maxLength-(t.indent+u+3);for(l=1;l<=t.linesBefore&&!(a-l<0);l++)c=e2(e.buffer,r[a-l],s[a-l],e.position-(r[a]-r[a-l]),d),o=Vi.repeat(" ",t.indent)+t2((e.line-l+1).toString(),u)+" | "+c.str+`
`+o;for(c=e2(e.buffer,r[a],s[a],e.position,d),o+=Vi.repeat(" ",t.indent)+t2((e.line+1).toString(),u)+" | "+c.str+`
`,o+=Vi.repeat("-",t.indent+u+3+c.pos)+`^
`,l=1;l<=t.linesAfter&&!(a+l>=s.length);l++)c=e2(e.buffer,r[a+l],s[a+l],e.position-(r[a]-r[a+l]),d),o+=Vi.repeat(" ",t.indent)+t2((e.line+l+1).toString(),u)+" | "+c.str+`
`;return o.replace(/\n$/,"")}ie(fae,"makeSnippet");var GXe=fae,KXe=["kind","multi","resolve","construct","instanceOf","predicate","represent","representName","defaultStyle","styleAliases"],YXe=["scalar","sequence","mapping"];function hae(e){var t={};return e!==null&&Object.keys(e).forEach(function(n){e[n].forEach(function(r){t[String(r)]=n})}),t}ie(hae,"compileStyleAliases");function pae(e,t){if(t=t||{},Object.keys(t).forEach(function(n){if(KXe.indexOf(n)===-1)throw new Mo('Unknown option "'+n+'" is met in definition of "'+e+'" YAML type.')}),this.options=t,this.tag=e,this.kind=t.kind||null,this.resolve=t.resolve||function(){return!0},this.construct=t.construct||function(n){return n},this.instanceOf=t.instanceOf||null,this.predicate=t.predicate||null,this.represent=t.represent||null,this.representName=t.representName||null,this.defaultStyle=t.defaultStyle||null,this.multi=t.multi||!1,this.styleAliases=hae(t.styleAliases||null),YXe.indexOf(this.kind)===-1)throw new Mo('Unknown kind "'+this.kind+'" is specified for "'+e+'" YAML type.')}ie(pae,"Type$1");var $a=pae;function J4(e,t){var n=[];return e[t].forEach(function(r){var s=n.length;n.forEach(function(i,a){i.tag===r.tag&&i.kind===r.kind&&i.multi===r.multi&&(s=a)}),n[s]=r}),n}ie(J4,"compileList");function mae(){var e={scalar:{},sequence:{},mapping:{},fallback:{},multi:{scalar:[],sequence:[],mapping:[],fallback:[]}},t,n;function r(s){s.multi?(e.multi[s.kind].push(s),e.multi.fallback.push(s)):e[s.kind][s.tag]=e.fallback[s.tag]=s}for(ie(r,"collectType"),t=0,n=arguments.length;t<n;t+=1)arguments[t].forEach(r);return e}ie(mae,"compileMap");function Uk(e){return this.extend(e)}ie(Uk,"Schema$1");Uk.prototype.extend=ie(function(t){var n=[],r=[];if(t instanceof $a)r.push(t);else if(Array.isArray(t))r=r.concat(t);else if(t&&(Array.isArray(t.implicit)||Array.isArray(t.explicit)))t.implicit&&(n=n.concat(t.implicit)),t.explicit&&(r=r.concat(t.explicit));else throw new Mo("Schema.extend argument should be a Type, [ Type ], or a schema definition ({ implicit: [...], explicit: [...] })");n.forEach(function(i){if(!(i instanceof $a))throw new Mo("Specified list of YAML types (or a single Type object) contains a non-Type object.");if(i.loadKind&&i.loadKind!=="scalar")throw new Mo("There is a non-scalar type in the implicit list of a schema. Implicit resolving of such types is not supported.");if(i.multi)throw new Mo("There is a multi type in the implicit list of a schema. Multi tags can only be listed as explicit.")}),r.forEach(function(i){if(!(i instanceof $a))throw new Mo("Specified list of YAML types (or a single Type object) contains a non-Type object.")});var s=Object.create(Uk.prototype);return s.implicit=(this.implicit||[]).concat(n),s.explicit=(this.explicit||[]).concat(r),s.compiledImplicit=J4(s,"implicit"),s.compiledExplicit=J4(s,"explicit"),s.compiledTypeMap=mae(s.compiledImplicit,s.compiledExplicit),s},"extend");var ZXe=Uk,XXe=new $a("tag:yaml.org,2002:str",{kind:"scalar",construct:ie(function(e){return e!==null?e:""},"construct")}),JXe=new $a("tag:yaml.org,2002:seq",{kind:"sequence",construct:ie(function(e){return e!==null?e:[]},"construct")}),QXe=new $a("tag:yaml.org,2002:map",{kind:"mapping",construct:ie(function(e){return e!==null?e:{}},"construct")}),eJe=new ZXe({explicit:[XXe,JXe,QXe]});function gae(e){if(e===null)return!0;var t=e.length;return t===1&&e==="~"||t===4&&(e==="null"||e==="Null"||e==="NULL")}ie(gae,"resolveYamlNull");function yae(){return null}ie(yae,"constructYamlNull");function bae(e){return e===null}ie(bae,"isNull");var tJe=new $a("tag:yaml.org,2002:null",{kind:"scalar",resolve:gae,construct:yae,predicate:bae,represent:{canonical:ie(function(){return"~"},"canonical"),lowercase:ie(function(){return"null"},"lowercase"),uppercase:ie(function(){return"NULL"},"uppercase"),camelcase:ie(function(){return"Null"},"camelcase"),empty:ie(function(){return""},"empty")},defaultStyle:"lowercase"});function vae(e){if(e===null)return!1;var t=e.length;return t===4&&(e==="true"||e==="True"||e==="TRUE")||t===5&&(e==="false"||e==="False"||e==="FALSE")}ie(vae,"resolveYamlBoolean");function xae(e){return e==="true"||e==="True"||e==="TRUE"}ie(xae,"constructYamlBoolean");function wae(e){return Object.prototype.toString.call(e)==="[object Boolean]"}ie(wae,"isBoolean");var nJe=new $a("tag:yaml.org,2002:bool",{kind:"scalar",resolve:vae,construct:xae,predicate:wae,represent:{lowercase:ie(function(e){return e?"true":"false"},"lowercase"),uppercase:ie(function(e){return e?"TRUE":"FALSE"},"uppercase"),camelcase:ie(function(e){return e?"True":"False"},"camelcase")},defaultStyle:"lowercase"});function _ae(e){return 48<=e&&e<=57||65<=e&&e<=70||97<=e&&e<=102}ie(_ae,"isHexCode");function Sae(e){return 48<=e&&e<=55}ie(Sae,"isOctCode");function Cae(e){return 48<=e&&e<=57}ie(Cae,"isDecCode");function kae(e){if(e===null)return!1;var t=e.length,n=0,r=!1,s;if(!t)return!1;if(s=e[n],(s==="-"||s==="+")&&(s=e[++n]),s==="0"){if(n+1===t)return!0;if(s=e[++n],s==="b"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(s!=="0"&&s!=="1")return!1;r=!0}return r&&s!=="_"}if(s==="x"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(!_ae(e.charCodeAt(n)))return!1;r=!0}return r&&s!=="_"}if(s==="o"){for(n++;n<t;n++)if(s=e[n],s!=="_"){if(!Sae(e.charCodeAt(n)))return!1;r=!0}return r&&s!=="_"}}if(s==="_")return!1;for(;n<t;n++)if(s=e[n],s!=="_"){if(!Cae(e.charCodeAt(n)))return!1;r=!0}return!(!r||s==="_")}ie(kae,"resolveYamlInteger");function Eae(e){var t=e,n=1,r;if(t.indexOf("_")!==-1&&(t=t.replace(/_/g,"")),r=t[0],(r==="-"||r==="+")&&(r==="-"&&(n=-1),t=t.slice(1),r=t[0]),t==="0")return 0;if(r==="0"){if(t[1]==="b")return n*parseInt(t.slice(2),2);if(t[1]==="x")return n*parseInt(t.slice(2),16);if(t[1]==="o")return n*parseInt(t.slice(2),8)}return n*parseInt(t,10)}ie(Eae,"constructYamlInteger");function Tae(e){return Object.prototype.toString.call(e)==="[object Number]"&&e%1===0&&!Vi.isNegativeZero(e)}ie(Tae,"isInteger");var rJe=new $a("tag:yaml.org,2002:int",{kind:"scalar",resolve:kae,construct:Eae,predicate:Tae,represent:{binary:ie(function(e){return e>=0?"0b"+e.toString(2):"-0b"+e.toString(2).slice(1)},"binary"),octal:ie(function(e){return e>=0?"0o"+e.toString(8):"-0o"+e.toString(8).slice(1)},"octal"),decimal:ie(function(e){return e.toString(10)},"decimal"),hexadecimal:ie(function(e){return e>=0?"0x"+e.toString(16).toUpperCase():"-0x"+e.toString(16).toUpperCase().slice(1)},"hexadecimal")},defaultStyle:"decimal",styleAliases:{binary:[2,"bin"],octal:[8,"oct"],decimal:[10,"dec"],hexadecimal:[16,"hex"]}}),sJe=new RegExp("^(?:[-+]?(?:[0-9][0-9_]*)(?:\\.[0-9_]*)?(?:[eE][-+]?[0-9]+)?|\\.[0-9_]+(?:[eE][-+]?[0-9]+)?|[-+]?\\.(?:inf|Inf|INF)|\\.(?:nan|NaN|NAN))$");function Aae(e){return!(e===null||!sJe.test(e)||e[e.length-1]==="_")}ie(Aae,"resolveYamlFloat");function Rae(e){var t,n;return t=e.replace(/_/g,"").toLowerCase(),n=t[0]==="-"?-1:1,"+-".indexOf(t[0])>=0&&(t=t.slice(1)),t===".inf"?n===1?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY:t===".nan"?NaN:n*parseFloat(t,10)}ie(Rae,"constructYamlFloat");var iJe=/^[-+]?[0-9]+e/;function Nae(e,t){var n;if(isNaN(e))switch(t){case"lowercase":return".nan";case"uppercase":return".NAN";case"camelcase":return".NaN"}else if(Number.POSITIVE_INFINITY===e)switch(t){case"lowercase":return".inf";case"uppercase":return".INF";case"camelcase":return".Inf"}else if(Number.NEGATIVE_INFINITY===e)switch(t){case"lowercase":return"-.inf";case"uppercase":return"-.INF";case"camelcase":return"-.Inf"}else if(Vi.isNegativeZero(e))return"-0.0";return n=e.toString(10),iJe.test(n)?n.replace("e",".e"):n}ie(Nae,"representYamlFloat");function Mae(e){return Object.prototype.toString.call(e)==="[object Number]"&&(e%1!==0||Vi.isNegativeZero(e))}ie(Mae,"isFloat");var aJe=new $a("tag:yaml.org,2002:float",{kind:"scalar",resolve:Aae,construct:Rae,predicate:Mae,represent:Nae,defaultStyle:"lowercase"}),Iae=eJe.extend({implicit:[tJe,nJe,rJe,aJe]}),oJe=Iae,jae=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9])-([0-9][0-9])$"),Pae=new RegExp("^([0-9][0-9][0-9][0-9])-([0-9][0-9]?)-([0-9][0-9]?)(?:[Tt]|[ \\t]+)([0-9][0-9]?):([0-9][0-9]):([0-9][0-9])(?:\\.([0-9]*))?(?:[ \\t]*(Z|([-+])([0-9][0-9]?)(?::([0-9][0-9]))?))?$");function Oae(e){return e===null?!1:jae.exec(e)!==null||Pae.exec(e)!==null}ie(Oae,"resolveYamlTimestamp");function Dae(e){var t,n,r,s,i,a,o,l=0,c=null,u,d,h;if(t=jae.exec(e),t===null&&(t=Pae.exec(e)),t===null)throw new Error("Date resolve error");if(n=+t[1],r=+t[2]-1,s=+t[3],!t[4])return new Date(Date.UTC(n,r,s));if(i=+t[4],a=+t[5],o=+t[6],t[7]){for(l=t[7].slice(0,3);l.length<3;)l+="0";l=+l}return t[9]&&(u=+t[10],d=+(t[11]||0),c=(u*60+d)*6e4,t[9]==="-"&&(c=-c)),h=new Date(Date.UTC(n,r,s,i,a,o,l)),c&&h.setTime(h.getTime()-c),h}ie(Dae,"constructYamlTimestamp");function Fae(e){return e.toISOString()}ie(Fae,"representYamlTimestamp");var lJe=new $a("tag:yaml.org,2002:timestamp",{kind:"scalar",resolve:Oae,construct:Dae,instanceOf:Date,represent:Fae});function Lae(e){return e==="<<"||e===null}ie(Lae,"resolveYamlMerge");var cJe=new $a("tag:yaml.org,2002:merge",{kind:"scalar",resolve:Lae}),E6=`ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=
\r`;function Bae(e){if(e===null)return!1;var t,n,r=0,s=e.length,i=E6;for(n=0;n<s;n++)if(t=i.indexOf(e.charAt(n)),!(t>64)){if(t<0)return!1;r+=6}return r%8===0}ie(Bae,"resolveYamlBinary");function $ae(e){var t,n,r=e.replace(/[\r\n=]/g,""),s=r.length,i=E6,a=0,o=[];for(t=0;t<s;t++)t%4===0&&t&&(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)),a=a<<6|i.indexOf(r.charAt(t));return n=s%4*6,n===0?(o.push(a>>16&255),o.push(a>>8&255),o.push(a&255)):n===18?(o.push(a>>10&255),o.push(a>>2&255)):n===12&&o.push(a>>4&255),new Uint8Array(o)}ie($ae,"constructYamlBinary");function zae(e){var t="",n=0,r,s,i=e.length,a=E6;for(r=0;r<i;r++)r%3===0&&r&&(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]),n=(n<<8)+e[r];return s=i%3,s===0?(t+=a[n>>18&63],t+=a[n>>12&63],t+=a[n>>6&63],t+=a[n&63]):s===2?(t+=a[n>>10&63],t+=a[n>>4&63],t+=a[n<<2&63],t+=a[64]):s===1&&(t+=a[n>>2&63],t+=a[n<<4&63],t+=a[64],t+=a[64]),t}ie(zae,"representYamlBinary");function Uae(e){return Object.prototype.toString.call(e)==="[object Uint8Array]"}ie(Uae,"isBinary");var uJe=new $a("tag:yaml.org,2002:binary",{kind:"scalar",resolve:Bae,construct:$ae,predicate:Uae,represent:zae}),dJe=Object.prototype.hasOwnProperty,fJe=Object.prototype.toString;function qae(e){if(e===null)return!0;var t=[],n,r,s,i,a,o=e;for(n=0,r=o.length;n<r;n+=1){if(s=o[n],a=!1,fJe.call(s)!=="[object Object]")return!1;for(i in s)if(dJe.call(s,i))if(!a)a=!0;else return!1;if(!a)return!1;if(t.indexOf(i)===-1)t.push(i);else return!1}return!0}ie(qae,"resolveYamlOmap");function Vae(e){return e!==null?e:[]}ie(Vae,"constructYamlOmap");var hJe=new $a("tag:yaml.org,2002:omap",{kind:"sequence",resolve:qae,construct:Vae}),pJe=Object.prototype.toString;function Wae(e){if(e===null)return!0;var t,n,r,s,i,a=e;for(i=new Array(a.length),t=0,n=a.length;t<n;t+=1){if(r=a[t],pJe.call(r)!=="[object Object]"||(s=Object.keys(r),s.length!==1))return!1;i[t]=[s[0],r[s[0]]]}return!0}ie(Wae,"resolveYamlPairs");function Hae(e){if(e===null)return[];var t,n,r,s,i,a=e;for(i=new Array(a.length),t=0,n=a.length;t<n;t+=1)r=a[t],s=Object.keys(r),i[t]=[s[0],r[s[0]]];return i}ie(Hae,"constructYamlPairs");var mJe=new $a("tag:yaml.org,2002:pairs",{kind:"sequence",resolve:Wae,construct:Hae}),gJe=Object.prototype.hasOwnProperty;function Gae(e){if(e===null)return!0;var t,n=e;for(t in n)if(gJe.call(n,t)&&n[t]!==null)return!1;return!0}ie(Gae,"resolveYamlSet");function Kae(e){return e!==null?e:{}}ie(Kae,"constructYamlSet");var yJe=new $a("tag:yaml.org,2002:set",{kind:"mapping",resolve:Gae,construct:Kae}),Yae=oJe.extend({implicit:[lJe,cJe],explicit:[uJe,hJe,mJe,yJe]}),Gh=Object.prototype.hasOwnProperty,qk=1,Zae=2,Xae=3,Vk=4,P3=1,bJe=2,IV=3,vJe=/[\x00-\x08\x0B\x0C\x0E-\x1F\x7F-\x84\x86-\x9F\uFFFE\uFFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF]/,xJe=/[\x85\u2028\u2029]/,wJe=/[,\[\]\{\}]/,Jae=/^(?:!|!!|![a-z\-]+!)$/i,Qae=/^(?:!|[^,\[\]\{\}])(?:%[0-9a-f]{2}|[0-9a-z\-#;\/\?:@&=\+\$,_\.!~\*'\(\)\[\]])*$/i;function Q4(e){return Object.prototype.toString.call(e)}ie(Q4,"_class");function Mc(e){return e===10||e===13}ie(Mc,"is_EOL");function Eh(e){return e===9||e===32}ie(Eh,"is_WHITE_SPACE");function so(e){return e===9||e===32||e===10||e===13}ie(so,"is_WS_OR_EOL");function fm(e){return e===44||e===91||e===93||e===123||e===125}ie(fm,"is_FLOW_INDICATOR");function eoe(e){var t;return 48<=e&&e<=57?e-48:(t=e|32,97<=t&&t<=102?t-97+10:-1)}ie(eoe,"fromHexCode");function toe(e){return e===120?2:e===117?4:e===85?8:0}ie(toe,"escapedHexLen");function noe(e){return 48<=e&&e<=57?e-48:-1}ie(noe,"fromDecimalCode");function eP(e){return e===48?"\0":e===97?"\x07":e===98?"\b":e===116||e===9?"	":e===110?`
`:e===118?"\v":e===102?"\f":e===114?"\r":e===101?"\x1B":e===32?" ":e===34?'"':e===47?"/":e===92?"\\":e===78?"":e===95?"":e===76?"\u2028":e===80?"\u2029":""}ie(eP,"simpleEscapeSequence");function roe(e){return e<=65535?String.fromCharCode(e):String.fromCharCode((e-65536>>10)+55296,(e-65536&1023)+56320)}ie(roe,"charFromCodepoint");var soe=new Array(256),ioe=new Array(256);for(Yp=0;Yp<256;Yp++)soe[Yp]=eP(Yp)?1:0,ioe[Yp]=eP(Yp);var Yp;function aoe(e,t){this.input=e,this.filename=t.filename||null,this.schema=t.schema||Yae,this.onWarning=t.onWarning||null,this.legacy=t.legacy||!1,this.json=t.json||!1,this.listener=t.listener||null,this.implicitTypes=this.schema.compiledImplicit,this.typeMap=this.schema.compiledTypeMap,this.length=e.length,this.position=0,this.line=0,this.lineStart=0,this.lineIndent=0,this.firstTabInLine=-1,this.documents=[]}ie(aoe,"State$1");function T6(e,t){var n={name:e.filename,buffer:e.input.slice(0,-1),position:e.position,line:e.line,column:e.position-e.lineStart};return n.snippet=GXe(n),new Mo(t,n)}ie(T6,"generateError");function Fn(e,t){throw T6(e,t)}ie(Fn,"throwError");function i1(e,t){e.onWarning&&e.onWarning.call(null,T6(e,t))}ie(i1,"throwWarning");var jV={YAML:ie(function(t,n,r){var s,i,a;t.version!==null&&Fn(t,"duplication of %YAML directive"),r.length!==1&&Fn(t,"YAML directive accepts exactly one argument"),s=/^([0-9]+)\.([0-9]+)$/.exec(r[0]),s===null&&Fn(t,"ill-formed argument of the YAML directive"),i=parseInt(s[1],10),a=parseInt(s[2],10),i!==1&&Fn(t,"unacceptable YAML version of the document"),t.version=r[0],t.checkLineBreaks=a<2,a!==1&&a!==2&&i1(t,"unsupported YAML version of the document")},"handleYamlDirective"),TAG:ie(function(t,n,r){var s,i;r.length!==2&&Fn(t,"TAG directive accepts exactly two arguments"),s=r[0],i=r[1],Jae.test(s)||Fn(t,"ill-formed tag handle (first argument) of the TAG directive"),Gh.call(t.tagMap,s)&&Fn(t,'there is a previously declared suffix for "'+s+'" tag handle'),Qae.test(i)||Fn(t,"ill-formed tag prefix (second argument) of the TAG directive");try{i=decodeURIComponent(i)}catch{Fn(t,"tag prefix is malformed: "+i)}t.tagMap[s]=i},"handleTagDirective")};function Wd(e,t,n,r){var s,i,a,o;if(t<n){if(o=e.input.slice(t,n),r)for(s=0,i=o.length;s<i;s+=1)a=o.charCodeAt(s),a===9||32<=a&&a<=1114111||Fn(e,"expected valid JSON character");else vJe.test(o)&&Fn(e,"the stream contains non-printable characters");e.result+=o}}ie(Wd,"captureSegment");function tP(e,t,n,r){var s,i,a,o;for(Vi.isObject(n)||Fn(e,"cannot merge mappings; the provided source object is unacceptable"),s=Object.keys(n),a=0,o=s.length;a<o;a+=1)i=s[a],Gh.call(t,i)||(t[i]=n[i],r[i]=!0)}ie(tP,"mergeMappings");function hm(e,t,n,r,s,i,a,o,l){var c,u;if(Array.isArray(s))for(s=Array.prototype.slice.call(s),c=0,u=s.length;c<u;c+=1)Array.isArray(s[c])&&Fn(e,"nested arrays are not supported inside keys"),typeof s=="object"&&Q4(s[c])==="[object Object]"&&(s[c]="[object Object]");if(typeof s=="object"&&Q4(s)==="[object Object]"&&(s="[object Object]"),s=String(s),t===null&&(t={}),r==="tag:yaml.org,2002:merge")if(Array.isArray(i))for(c=0,u=i.length;c<u;c+=1)tP(e,t,i[c],n);else tP(e,t,i,n);else!e.json&&!Gh.call(n,s)&&Gh.call(t,s)&&(e.line=a||e.line,e.lineStart=o||e.lineStart,e.position=l||e.position,Fn(e,"duplicated mapping key")),s==="__proto__"?Object.defineProperty(t,s,{configurable:!0,enumerable:!0,writable:!0,value:i}):t[s]=i,delete n[s];return t}ie(hm,"storeMappingPair");function aA(e){var t;t=e.input.charCodeAt(e.position),t===10?e.position++:t===13?(e.position++,e.input.charCodeAt(e.position)===10&&e.position++):Fn(e,"a line break is expected"),e.line+=1,e.lineStart=e.position,e.firstTabInLine=-1}ie(aA,"readLineBreak");function bi(e,t,n){for(var r=0,s=e.input.charCodeAt(e.position);s!==0;){for(;Eh(s);)s===9&&e.firstTabInLine===-1&&(e.firstTabInLine=e.position),s=e.input.charCodeAt(++e.position);if(t&&s===35)do s=e.input.charCodeAt(++e.position);while(s!==10&&s!==13&&s!==0);if(Mc(s))for(aA(e),s=e.input.charCodeAt(e.position),r++,e.lineIndent=0;s===32;)e.lineIndent++,s=e.input.charCodeAt(++e.position);else break}return n!==-1&&r!==0&&e.lineIndent<n&&i1(e,"deficient indentation"),r}ie(bi,"skipSeparationSpace");function g_(e){var t=e.position,n;return n=e.input.charCodeAt(t),!!((n===45||n===46)&&n===e.input.charCodeAt(t+1)&&n===e.input.charCodeAt(t+2)&&(t+=3,n=e.input.charCodeAt(t),n===0||so(n)))}ie(g_,"testDocumentSeparator");function oA(e,t){t===1?e.result+=" ":t>1&&(e.result+=Vi.repeat(`
`,t-1))}ie(oA,"writeFoldedLines");function ooe(e,t,n){var r,s,i,a,o,l,c,u,d=e.kind,h=e.result,m;if(m=e.input.charCodeAt(e.position),so(m)||fm(m)||m===35||m===38||m===42||m===33||m===124||m===62||m===39||m===34||m===37||m===64||m===96||(m===63||m===45)&&(s=e.input.charCodeAt(e.position+1),so(s)||n&&fm(s)))return!1;for(e.kind="scalar",e.result="",i=a=e.position,o=!1;m!==0;){if(m===58){if(s=e.input.charCodeAt(e.position+1),so(s)||n&&fm(s))break}else if(m===35){if(r=e.input.charCodeAt(e.position-1),so(r))break}else{if(e.position===e.lineStart&&g_(e)||n&&fm(m))break;if(Mc(m))if(l=e.line,c=e.lineStart,u=e.lineIndent,bi(e,!1,-1),e.lineIndent>=t){o=!0,m=e.input.charCodeAt(e.position);continue}else{e.position=a,e.line=l,e.lineStart=c,e.lineIndent=u;break}}o&&(Wd(e,i,a,!1),oA(e,e.line-l),i=a=e.position,o=!1),Eh(m)||(a=e.position+1),m=e.input.charCodeAt(++e.position)}return Wd(e,i,a,!1),e.result?!0:(e.kind=d,e.result=h,!1)}ie(ooe,"readPlainScalar");function loe(e,t){var n,r,s;if(n=e.input.charCodeAt(e.position),n!==39)return!1;for(e.kind="scalar",e.result="",e.position++,r=s=e.position;(n=e.input.charCodeAt(e.position))!==0;)if(n===39)if(Wd(e,r,e.position,!0),n=e.input.charCodeAt(++e.position),n===39)r=e.position,e.position++,s=e.position;else return!0;else Mc(n)?(Wd(e,r,s,!0),oA(e,bi(e,!1,t)),r=s=e.position):e.position===e.lineStart&&g_(e)?Fn(e,"unexpected end of the document within a single quoted scalar"):(e.position++,s=e.position);Fn(e,"unexpected end of the stream within a single quoted scalar")}ie(loe,"readSingleQuotedScalar");function coe(e,t){var n,r,s,i,a,o;if(o=e.input.charCodeAt(e.position),o!==34)return!1;for(e.kind="scalar",e.result="",e.position++,n=r=e.position;(o=e.input.charCodeAt(e.position))!==0;){if(o===34)return Wd(e,n,e.position,!0),e.position++,!0;if(o===92){if(Wd(e,n,e.position,!0),o=e.input.charCodeAt(++e.position),Mc(o))bi(e,!1,t);else if(o<256&&soe[o])e.result+=ioe[o],e.position++;else if((a=toe(o))>0){for(s=a,i=0;s>0;s--)o=e.input.charCodeAt(++e.position),(a=eoe(o))>=0?i=(i<<4)+a:Fn(e,"expected hexadecimal character");e.result+=roe(i),e.position++}else Fn(e,"unknown escape sequence");n=r=e.position}else Mc(o)?(Wd(e,n,r,!0),oA(e,bi(e,!1,t)),n=r=e.position):e.position===e.lineStart&&g_(e)?Fn(e,"unexpected end of the document within a double quoted scalar"):(e.position++,r=e.position)}Fn(e,"unexpected end of the stream within a double quoted scalar")}ie(coe,"readDoubleQuotedScalar");function uoe(e,t){var n=!0,r,s,i,a=e.tag,o,l=e.anchor,c,u,d,h,m,y=Object.create(null),b,v,x,w;if(w=e.input.charCodeAt(e.position),w===91)u=93,m=!1,o=[];else if(w===123)u=125,m=!0,o={};else return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=o),w=e.input.charCodeAt(++e.position);w!==0;){if(bi(e,!0,t),w=e.input.charCodeAt(e.position),w===u)return e.position++,e.tag=a,e.anchor=l,e.kind=m?"mapping":"sequence",e.result=o,!0;n?w===44&&Fn(e,"expected the node content, but found ','"):Fn(e,"missed comma between flow collection entries"),v=b=x=null,d=h=!1,w===63&&(c=e.input.charCodeAt(e.position+1),so(c)&&(d=h=!0,e.position++,bi(e,!0,t))),r=e.line,s=e.lineStart,i=e.position,$m(e,t,qk,!1,!0),v=e.tag,b=e.result,bi(e,!0,t),w=e.input.charCodeAt(e.position),(h||e.line===r)&&w===58&&(d=!0,w=e.input.charCodeAt(++e.position),bi(e,!0,t),$m(e,t,qk,!1,!0),x=e.result),m?hm(e,o,y,v,b,x,r,s,i):d?o.push(hm(e,null,y,v,b,x,r,s,i)):o.push(b),bi(e,!0,t),w=e.input.charCodeAt(e.position),w===44?(n=!0,w=e.input.charCodeAt(++e.position)):n=!1}Fn(e,"unexpected end of the stream within a flow collection")}ie(uoe,"readFlowCollection");function doe(e,t){var n,r,s=P3,i=!1,a=!1,o=t,l=0,c=!1,u,d;if(d=e.input.charCodeAt(e.position),d===124)r=!1;else if(d===62)r=!0;else return!1;for(e.kind="scalar",e.result="";d!==0;)if(d=e.input.charCodeAt(++e.position),d===43||d===45)P3===s?s=d===43?IV:bJe:Fn(e,"repeat of a chomping mode identifier");else if((u=noe(d))>=0)u===0?Fn(e,"bad explicit indentation width of a block scalar; it cannot be less than one"):a?Fn(e,"repeat of an indentation width identifier"):(o=t+u-1,a=!0);else break;if(Eh(d)){do d=e.input.charCodeAt(++e.position);while(Eh(d));if(d===35)do d=e.input.charCodeAt(++e.position);while(!Mc(d)&&d!==0)}for(;d!==0;){for(aA(e),e.lineIndent=0,d=e.input.charCodeAt(e.position);(!a||e.lineIndent<o)&&d===32;)e.lineIndent++,d=e.input.charCodeAt(++e.position);if(!a&&e.lineIndent>o&&(o=e.lineIndent),Mc(d)){l++;continue}if(e.lineIndent<o){s===IV?e.result+=Vi.repeat(`
`,i?1+l:l):s===P3&&i&&(e.result+=`
`);break}for(r?Eh(d)?(c=!0,e.result+=Vi.repeat(`
`,i?1+l:l)):c?(c=!1,e.result+=Vi.repeat(`
`,l+1)):l===0?i&&(e.result+=" "):e.result+=Vi.repeat(`
`,l):e.result+=Vi.repeat(`
`,i?1+l:l),i=!0,a=!0,l=0,n=e.position;!Mc(d)&&d!==0;)d=e.input.charCodeAt(++e.position);Wd(e,n,e.position,!1)}return!0}ie(doe,"readBlockScalar");function nP(e,t){var n,r=e.tag,s=e.anchor,i=[],a,o=!1,l;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=i),l=e.input.charCodeAt(e.position);l!==0&&(e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,Fn(e,"tab characters must not be used in indentation")),!(l!==45||(a=e.input.charCodeAt(e.position+1),!so(a))));){if(o=!0,e.position++,bi(e,!0,-1)&&e.lineIndent<=t){i.push(null),l=e.input.charCodeAt(e.position);continue}if(n=e.line,$m(e,t,Xae,!1,!0),i.push(e.result),bi(e,!0,-1),l=e.input.charCodeAt(e.position),(e.line===n||e.lineIndent>t)&&l!==0)Fn(e,"bad indentation of a sequence entry");else if(e.lineIndent<t)break}return o?(e.tag=r,e.anchor=s,e.kind="sequence",e.result=i,!0):!1}ie(nP,"readBlockSequence");function foe(e,t,n){var r,s,i,a,o,l,c=e.tag,u=e.anchor,d={},h=Object.create(null),m=null,y=null,b=null,v=!1,x=!1,w;if(e.firstTabInLine!==-1)return!1;for(e.anchor!==null&&(e.anchorMap[e.anchor]=d),w=e.input.charCodeAt(e.position);w!==0;){if(!v&&e.firstTabInLine!==-1&&(e.position=e.firstTabInLine,Fn(e,"tab characters must not be used in indentation")),r=e.input.charCodeAt(e.position+1),i=e.line,(w===63||w===58)&&so(r))w===63?(v&&(hm(e,d,h,m,y,null,a,o,l),m=y=b=null),x=!0,v=!0,s=!0):v?(v=!1,s=!0):Fn(e,"incomplete explicit mapping pair; a key node is missed; or followed by a non-tabulated empty line"),e.position+=1,w=r;else{if(a=e.line,o=e.lineStart,l=e.position,!$m(e,n,Zae,!1,!0))break;if(e.line===i){for(w=e.input.charCodeAt(e.position);Eh(w);)w=e.input.charCodeAt(++e.position);if(w===58)w=e.input.charCodeAt(++e.position),so(w)||Fn(e,"a whitespace character is expected after the key-value separator within a block mapping"),v&&(hm(e,d,h,m,y,null,a,o,l),m=y=b=null),x=!0,v=!1,s=!1,m=e.tag,y=e.result;else if(x)Fn(e,"can not read an implicit mapping pair; a colon is missed");else return e.tag=c,e.anchor=u,!0}else if(x)Fn(e,"can not read a block mapping entry; a multiline key may not be an implicit key");else return e.tag=c,e.anchor=u,!0}if((e.line===i||e.lineIndent>t)&&(v&&(a=e.line,o=e.lineStart,l=e.position),$m(e,t,Vk,!0,s)&&(v?y=e.result:b=e.result),v||(hm(e,d,h,m,y,b,a,o,l),m=y=b=null),bi(e,!0,-1),w=e.input.charCodeAt(e.position)),(e.line===i||e.lineIndent>t)&&w!==0)Fn(e,"bad indentation of a mapping entry");else if(e.lineIndent<t)break}return v&&hm(e,d,h,m,y,null,a,o,l),x&&(e.tag=c,e.anchor=u,e.kind="mapping",e.result=d),x}ie(foe,"readBlockMapping");function hoe(e){var t,n=!1,r=!1,s,i,a;if(a=e.input.charCodeAt(e.position),a!==33)return!1;if(e.tag!==null&&Fn(e,"duplication of a tag property"),a=e.input.charCodeAt(++e.position),a===60?(n=!0,a=e.input.charCodeAt(++e.position)):a===33?(r=!0,s="!!",a=e.input.charCodeAt(++e.position)):s="!",t=e.position,n){do a=e.input.charCodeAt(++e.position);while(a!==0&&a!==62);e.position<e.length?(i=e.input.slice(t,e.position),a=e.input.charCodeAt(++e.position)):Fn(e,"unexpected end of the stream within a verbatim tag")}else{for(;a!==0&&!so(a);)a===33&&(r?Fn(e,"tag suffix cannot contain exclamation marks"):(s=e.input.slice(t-1,e.position+1),Jae.test(s)||Fn(e,"named tag handle cannot contain such characters"),r=!0,t=e.position+1)),a=e.input.charCodeAt(++e.position);i=e.input.slice(t,e.position),wJe.test(i)&&Fn(e,"tag suffix cannot contain flow indicator characters")}i&&!Qae.test(i)&&Fn(e,"tag name cannot contain such characters: "+i);try{i=decodeURIComponent(i)}catch{Fn(e,"tag name is malformed: "+i)}return n?e.tag=i:Gh.call(e.tagMap,s)?e.tag=e.tagMap[s]+i:s==="!"?e.tag="!"+i:s==="!!"?e.tag="tag:yaml.org,2002:"+i:Fn(e,'undeclared tag handle "'+s+'"'),!0}ie(hoe,"readTagProperty");function poe(e){var t,n;if(n=e.input.charCodeAt(e.position),n!==38)return!1;for(e.anchor!==null&&Fn(e,"duplication of an anchor property"),n=e.input.charCodeAt(++e.position),t=e.position;n!==0&&!so(n)&&!fm(n);)n=e.input.charCodeAt(++e.position);return e.position===t&&Fn(e,"name of an anchor node must contain at least one character"),e.anchor=e.input.slice(t,e.position),!0}ie(poe,"readAnchorProperty");function moe(e){var t,n,r;if(r=e.input.charCodeAt(e.position),r!==42)return!1;for(r=e.input.charCodeAt(++e.position),t=e.position;r!==0&&!so(r)&&!fm(r);)r=e.input.charCodeAt(++e.position);return e.position===t&&Fn(e,"name of an alias node must contain at least one character"),n=e.input.slice(t,e.position),Gh.call(e.anchorMap,n)||Fn(e,'unidentified alias "'+n+'"'),e.result=e.anchorMap[n],bi(e,!0,-1),!0}ie(moe,"readAlias");function $m(e,t,n,r,s){var i,a,o,l=1,c=!1,u=!1,d,h,m,y,b,v;if(e.listener!==null&&e.listener("open",e),e.tag=null,e.anchor=null,e.kind=null,e.result=null,i=a=o=Vk===n||Xae===n,r&&bi(e,!0,-1)&&(c=!0,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)),l===1)for(;hoe(e)||poe(e);)bi(e,!0,-1)?(c=!0,o=i,e.lineIndent>t?l=1:e.lineIndent===t?l=0:e.lineIndent<t&&(l=-1)):o=!1;if(o&&(o=c||s),(l===1||Vk===n)&&(qk===n||Zae===n?b=t:b=t+1,v=e.position-e.lineStart,l===1?o&&(nP(e,v)||foe(e,v,b))||uoe(e,b)?u=!0:(a&&doe(e,b)||loe(e,b)||coe(e,b)?u=!0:moe(e)?(u=!0,(e.tag!==null||e.anchor!==null)&&Fn(e,"alias node should not have any properties")):ooe(e,b,qk===n)&&(u=!0,e.tag===null&&(e.tag="?")),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):l===0&&(u=o&&nP(e,v))),e.tag===null)e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);else if(e.tag==="?"){for(e.result!==null&&e.kind!=="scalar"&&Fn(e,'unacceptable node kind for !<?> tag; it should be "scalar", not "'+e.kind+'"'),d=0,h=e.implicitTypes.length;d<h;d+=1)if(y=e.implicitTypes[d],y.resolve(e.result)){e.result=y.construct(e.result),e.tag=y.tag,e.anchor!==null&&(e.anchorMap[e.anchor]=e.result);break}}else if(e.tag!=="!"){if(Gh.call(e.typeMap[e.kind||"fallback"],e.tag))y=e.typeMap[e.kind||"fallback"][e.tag];else for(y=null,m=e.typeMap.multi[e.kind||"fallback"],d=0,h=m.length;d<h;d+=1)if(e.tag.slice(0,m[d].tag.length)===m[d].tag){y=m[d];break}y||Fn(e,"unknown tag !<"+e.tag+">"),e.result!==null&&y.kind!==e.kind&&Fn(e,"unacceptable node kind for !<"+e.tag+'> tag; it should be "'+y.kind+'", not "'+e.kind+'"'),y.resolve(e.result,e.tag)?(e.result=y.construct(e.result,e.tag),e.anchor!==null&&(e.anchorMap[e.anchor]=e.result)):Fn(e,"cannot resolve a node with !<"+e.tag+"> explicit tag")}return e.listener!==null&&e.listener("close",e),e.tag!==null||e.anchor!==null||u}ie($m,"composeNode");function goe(e){var t=e.position,n,r,s,i=!1,a;for(e.version=null,e.checkLineBreaks=e.legacy,e.tagMap=Object.create(null),e.anchorMap=Object.create(null);(a=e.input.charCodeAt(e.position))!==0&&(bi(e,!0,-1),a=e.input.charCodeAt(e.position),!(e.lineIndent>0||a!==37));){for(i=!0,a=e.input.charCodeAt(++e.position),n=e.position;a!==0&&!so(a);)a=e.input.charCodeAt(++e.position);for(r=e.input.slice(n,e.position),s=[],r.length<1&&Fn(e,"directive name must not be less than one character in length");a!==0;){for(;Eh(a);)a=e.input.charCodeAt(++e.position);if(a===35){do a=e.input.charCodeAt(++e.position);while(a!==0&&!Mc(a));break}if(Mc(a))break;for(n=e.position;a!==0&&!so(a);)a=e.input.charCodeAt(++e.position);s.push(e.input.slice(n,e.position))}a!==0&&aA(e),Gh.call(jV,r)?jV[r](e,r,s):i1(e,'unknown document directive "'+r+'"')}if(bi(e,!0,-1),e.lineIndent===0&&e.input.charCodeAt(e.position)===45&&e.input.charCodeAt(e.position+1)===45&&e.input.charCodeAt(e.position+2)===45?(e.position+=3,bi(e,!0,-1)):i&&Fn(e,"directives end mark is expected"),$m(e,e.lineIndent-1,Vk,!1,!0),bi(e,!0,-1),e.checkLineBreaks&&xJe.test(e.input.slice(t,e.position))&&i1(e,"non-ASCII line breaks are interpreted as content"),e.documents.push(e.result),e.position===e.lineStart&&g_(e)){e.input.charCodeAt(e.position)===46&&(e.position+=3,bi(e,!0,-1));return}if(e.position<e.length-1)Fn(e,"end of the stream or a document separator is expected");else return}ie(goe,"readDocument");function A6(e,t){e=String(e),t=t||{},e.length!==0&&(e.charCodeAt(e.length-1)!==10&&e.charCodeAt(e.length-1)!==13&&(e+=`
`),e.charCodeAt(0)===65279&&(e=e.slice(1)));var n=new aoe(e,t),r=e.indexOf("\0");for(r!==-1&&(n.position=r,Fn(n,"null byte is not allowed in input")),n.input+="\0";n.input.charCodeAt(n.position)===32;)n.lineIndent+=1,n.position+=1;for(;n.position<n.length-1;)goe(n);return n.documents}ie(A6,"loadDocuments");function _Je(e,t,n){t!==null&&typeof t=="object"&&typeof n>"u"&&(n=t,t=null);var r=A6(e,n);if(typeof t!="function")return r;for(var s=0,i=r.length;s<i;s+=1)t(r[s])}ie(_Je,"loadAll$1");function yoe(e,t){var n=A6(e,t);if(n.length!==0){if(n.length===1)return n[0];throw new Mo("expected a single document in the stream, but found more")}}ie(yoe,"load$1");var SJe=yoe,CJe={load:SJe},boe=Object.prototype.toString,voe=Object.prototype.hasOwnProperty,R6=65279,kJe=9,a1=10,EJe=13,TJe=32,AJe=33,RJe=34,rP=35,NJe=37,MJe=38,IJe=39,jJe=42,xoe=44,PJe=45,Wk=58,OJe=61,DJe=62,FJe=63,LJe=64,woe=91,_oe=93,BJe=96,Soe=123,$Je=124,Coe=125,Ha={};Ha[0]="\\0";Ha[7]="\\a";Ha[8]="\\b";Ha[9]="\\t";Ha[10]="\\n";Ha[11]="\\v";Ha[12]="\\f";Ha[13]="\\r";Ha[27]="\\e";Ha[34]='\\"';Ha[92]="\\\\";Ha[133]="\\N";Ha[160]="\\_";Ha[8232]="\\L";Ha[8233]="\\P";var zJe=["y","Y","yes","Yes","YES","on","On","ON","n","N","no","No","NO","off","Off","OFF"],UJe=/^[-+]?[0-9_]+(?::[0-9_]+)+(?:\.[0-9_]*)?$/;function koe(e,t){var n,r,s,i,a,o,l;if(t===null)return{};for(n={},r=Object.keys(t),s=0,i=r.length;s<i;s+=1)a=r[s],o=String(t[a]),a.slice(0,2)==="!!"&&(a="tag:yaml.org,2002:"+a.slice(2)),l=e.compiledTypeMap.fallback[a],l&&voe.call(l.styleAliases,o)&&(o=l.styleAliases[o]),n[a]=o;return n}ie(koe,"compileStyleMap");function Eoe(e){var t,n,r;if(t=e.toString(16).toUpperCase(),e<=255)n="x",r=2;else if(e<=65535)n="u",r=4;else if(e<=4294967295)n="U",r=8;else throw new Mo("code point within a string may not be greater than 0xFFFFFFFF");return"\\"+n+Vi.repeat("0",r-t.length)+t}ie(Eoe,"encodeHex");var qJe=1,o1=2;function Toe(e){this.schema=e.schema||Yae,this.indent=Math.max(1,e.indent||2),this.noArrayIndent=e.noArrayIndent||!1,this.skipInvalid=e.skipInvalid||!1,this.flowLevel=Vi.isNothing(e.flowLevel)?-1:e.flowLevel,this.styleMap=koe(this.schema,e.styles||null),this.sortKeys=e.sortKeys||!1,this.lineWidth=e.lineWidth||80,this.noRefs=e.noRefs||!1,this.noCompatMode=e.noCompatMode||!1,this.condenseFlow=e.condenseFlow||!1,this.quotingType=e.quotingType==='"'?o1:qJe,this.forceQuotes=e.forceQuotes||!1,this.replacer=typeof e.replacer=="function"?e.replacer:null,this.implicitTypes=this.schema.compiledImplicit,this.explicitTypes=this.schema.compiledExplicit,this.tag=null,this.result="",this.duplicates=[],this.usedDuplicates=null}ie(Toe,"State");function sP(e,t){for(var n=Vi.repeat(" ",t),r=0,s=-1,i="",a,o=e.length;r<o;)s=e.indexOf(`
`,r),s===-1?(a=e.slice(r),r=o):(a=e.slice(r,s+1),r=s+1),a.length&&a!==`
`&&(i+=n),i+=a;return i}ie(sP,"indentString");function Hk(e,t){return`
`+Vi.repeat(" ",e.indent*t)}ie(Hk,"generateNextLine");function Aoe(e,t){var n,r,s;for(n=0,r=e.implicitTypes.length;n<r;n+=1)if(s=e.implicitTypes[n],s.resolve(t))return!0;return!1}ie(Aoe,"testImplicitResolving");function l1(e){return e===TJe||e===kJe}ie(l1,"isWhitespace");function Ly(e){return 32<=e&&e<=126||161<=e&&e<=55295&&e!==8232&&e!==8233||57344<=e&&e<=65533&&e!==R6||65536<=e&&e<=1114111}ie(Ly,"isPrintable");function iP(e){return Ly(e)&&e!==R6&&e!==EJe&&e!==a1}ie(iP,"isNsCharOrWhitespace");function aP(e,t,n){var r=iP(e),s=r&&!l1(e);return(n?r:r&&e!==xoe&&e!==woe&&e!==_oe&&e!==Soe&&e!==Coe)&&e!==rP&&!(t===Wk&&!s)||iP(t)&&!l1(t)&&e===rP||t===Wk&&s}ie(aP,"isPlainSafe");function Roe(e){return Ly(e)&&e!==R6&&!l1(e)&&e!==PJe&&e!==FJe&&e!==Wk&&e!==xoe&&e!==woe&&e!==_oe&&e!==Soe&&e!==Coe&&e!==rP&&e!==MJe&&e!==jJe&&e!==AJe&&e!==$Je&&e!==OJe&&e!==DJe&&e!==IJe&&e!==RJe&&e!==NJe&&e!==LJe&&e!==BJe}ie(Roe,"isPlainSafeFirst");function Noe(e){return!l1(e)&&e!==Wk}ie(Noe,"isPlainSafeLast");function P0(e,t){var n=e.charCodeAt(t),r;return n>=55296&&n<=56319&&t+1<e.length&&(r=e.charCodeAt(t+1),r>=56320&&r<=57343)?(n-55296)*1024+r-56320+65536:n}ie(P0,"codePointAt");function N6(e){var t=/^\n* /;return t.test(e)}ie(N6,"needIndentIndicator");var Moe=1,oP=2,Ioe=3,joe=4,v0=5;function Poe(e,t,n,r,s,i,a,o){var l,c=0,u=null,d=!1,h=!1,m=r!==-1,y=-1,b=Roe(P0(e,0))&&Noe(P0(e,e.length-1));if(t||a)for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=P0(e,l),!Ly(c))return v0;b=b&&aP(c,u,o),u=c}else{for(l=0;l<e.length;c>=65536?l+=2:l++){if(c=P0(e,l),c===a1)d=!0,m&&(h=h||l-y-1>r&&e[y+1]!==" ",y=l);else if(!Ly(c))return v0;b=b&&aP(c,u,o),u=c}h=h||m&&l-y-1>r&&e[y+1]!==" "}return!d&&!h?b&&!a&&!s(e)?Moe:i===o1?v0:oP:n>9&&N6(e)?v0:a?i===o1?v0:oP:h?joe:Ioe}ie(Poe,"chooseScalarStyle");function Ooe(e,t,n,r,s){e.dump=function(){if(t.length===0)return e.quotingType===o1?'""':"''";if(!e.noCompatMode&&(zJe.indexOf(t)!==-1||UJe.test(t)))return e.quotingType===o1?'"'+t+'"':"'"+t+"'";var i=e.indent*Math.max(1,n),a=e.lineWidth===-1?-1:Math.max(Math.min(e.lineWidth,40),e.lineWidth-i),o=r||e.flowLevel>-1&&n>=e.flowLevel;function l(c){return Aoe(e,c)}switch(ie(l,"testAmbiguity"),Poe(t,o,e.indent,a,l,e.quotingType,e.forceQuotes&&!r,s)){case Moe:return t;case oP:return"'"+t.replace(/'/g,"''")+"'";case Ioe:return"|"+lP(t,e.indent)+cP(sP(t,i));case joe:return">"+lP(t,e.indent)+cP(sP(Doe(t,a),i));case v0:return'"'+Foe(t)+'"';default:throw new Mo("impossible error: invalid scalar style")}}()}ie(Ooe,"writeScalar");function lP(e,t){var n=N6(e)?String(t):"",r=e[e.length-1]===`
`,s=r&&(e[e.length-2]===`
`||e===`
`),i=s?"+":r?"":"-";return n+i+`
`}ie(lP,"blockHeader");function cP(e){return e[e.length-1]===`
`?e.slice(0,-1):e}ie(cP,"dropEndingNewline");function Doe(e,t){for(var n=/(\n+)([^\n]*)/g,r=function(){var c=e.indexOf(`
`);return c=c!==-1?c:e.length,n.lastIndex=c,uP(e.slice(0,c),t)}(),s=e[0]===`
`||e[0]===" ",i,a;a=n.exec(e);){var o=a[1],l=a[2];i=l[0]===" ",r+=o+(!s&&!i&&l!==""?`
`:"")+uP(l,t),s=i}return r}ie(Doe,"foldString");function uP(e,t){if(e===""||e[0]===" ")return e;for(var n=/ [^ ]/g,r,s=0,i,a=0,o=0,l="";r=n.exec(e);)o=r.index,o-s>t&&(i=a>s?a:o,l+=`
`+e.slice(s,i),s=i+1),a=o;return l+=`
`,e.length-s>t&&a>s?l+=e.slice(s,a)+`
`+e.slice(a+1):l+=e.slice(s),l.slice(1)}ie(uP,"foldLine");function Foe(e){for(var t="",n=0,r,s=0;s<e.length;n>=65536?s+=2:s++)n=P0(e,s),r=Ha[n],!r&&Ly(n)?(t+=e[s],n>=65536&&(t+=e[s+1])):t+=r||Eoe(n);return t}ie(Foe,"escapeString");function Loe(e,t,n){var r="",s=e.tag,i,a,o;for(i=0,a=n.length;i<a;i+=1)o=n[i],e.replacer&&(o=e.replacer.call(n,String(i),o)),(zu(e,t,o,!1,!1)||typeof o>"u"&&zu(e,t,null,!1,!1))&&(r!==""&&(r+=","+(e.condenseFlow?"":" ")),r+=e.dump);e.tag=s,e.dump="["+r+"]"}ie(Loe,"writeFlowSequence");function dP(e,t,n,r){var s="",i=e.tag,a,o,l;for(a=0,o=n.length;a<o;a+=1)l=n[a],e.replacer&&(l=e.replacer.call(n,String(a),l)),(zu(e,t+1,l,!0,!0,!1,!0)||typeof l>"u"&&zu(e,t+1,null,!0,!0,!1,!0))&&((!r||s!=="")&&(s+=Hk(e,t)),e.dump&&a1===e.dump.charCodeAt(0)?s+="-":s+="- ",s+=e.dump);e.tag=i,e.dump=s||"[]"}ie(dP,"writeBlockSequence");function Boe(e,t,n){var r="",s=e.tag,i=Object.keys(n),a,o,l,c,u;for(a=0,o=i.length;a<o;a+=1)u="",r!==""&&(u+=", "),e.condenseFlow&&(u+='"'),l=i[a],c=n[l],e.replacer&&(c=e.replacer.call(n,l,c)),zu(e,t,l,!1,!1)&&(e.dump.length>1024&&(u+="? "),u+=e.dump+(e.condenseFlow?'"':"")+":"+(e.condenseFlow?"":" "),zu(e,t,c,!1,!1)&&(u+=e.dump,r+=u));e.tag=s,e.dump="{"+r+"}"}ie(Boe,"writeFlowMapping");function $oe(e,t,n,r){var s="",i=e.tag,a=Object.keys(n),o,l,c,u,d,h;if(e.sortKeys===!0)a.sort();else if(typeof e.sortKeys=="function")a.sort(e.sortKeys);else if(e.sortKeys)throw new Mo("sortKeys must be a boolean or a function");for(o=0,l=a.length;o<l;o+=1)h="",(!r||s!=="")&&(h+=Hk(e,t)),c=a[o],u=n[c],e.replacer&&(u=e.replacer.call(n,c,u)),zu(e,t+1,c,!0,!0,!0)&&(d=e.tag!==null&&e.tag!=="?"||e.dump&&e.dump.length>1024,d&&(e.dump&&a1===e.dump.charCodeAt(0)?h+="?":h+="? "),h+=e.dump,d&&(h+=Hk(e,t)),zu(e,t+1,u,!0,d)&&(e.dump&&a1===e.dump.charCodeAt(0)?h+=":":h+=": ",h+=e.dump,s+=h));e.tag=i,e.dump=s||"{}"}ie($oe,"writeBlockMapping");function fP(e,t,n){var r,s,i,a,o,l;for(s=n?e.explicitTypes:e.implicitTypes,i=0,a=s.length;i<a;i+=1)if(o=s[i],(o.instanceOf||o.predicate)&&(!o.instanceOf||typeof t=="object"&&t instanceof o.instanceOf)&&(!o.predicate||o.predicate(t))){if(n?o.multi&&o.representName?e.tag=o.representName(t):e.tag=o.tag:e.tag="?",o.represent){if(l=e.styleMap[o.tag]||o.defaultStyle,boe.call(o.represent)==="[object Function]")r=o.represent(t,l);else if(voe.call(o.represent,l))r=o.represent[l](t,l);else throw new Mo("!<"+o.tag+'> tag resolver accepts not "'+l+'" style');e.dump=r}return!0}return!1}ie(fP,"detectType");function zu(e,t,n,r,s,i,a){e.tag=null,e.dump=n,fP(e,n,!1)||fP(e,n,!0);var o=boe.call(e.dump),l=r,c;r&&(r=e.flowLevel<0||e.flowLevel>t);var u=o==="[object Object]"||o==="[object Array]",d,h;if(u&&(d=e.duplicates.indexOf(n),h=d!==-1),(e.tag!==null&&e.tag!=="?"||h||e.indent!==2&&t>0)&&(s=!1),h&&e.usedDuplicates[d])e.dump="*ref_"+d;else{if(u&&h&&!e.usedDuplicates[d]&&(e.usedDuplicates[d]=!0),o==="[object Object]")r&&Object.keys(e.dump).length!==0?($oe(e,t,e.dump,s),h&&(e.dump="&ref_"+d+e.dump)):(Boe(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(o==="[object Array]")r&&e.dump.length!==0?(e.noArrayIndent&&!a&&t>0?dP(e,t-1,e.dump,s):dP(e,t,e.dump,s),h&&(e.dump="&ref_"+d+e.dump)):(Loe(e,t,e.dump),h&&(e.dump="&ref_"+d+" "+e.dump));else if(o==="[object String]")e.tag!=="?"&&Ooe(e,e.dump,t,i,l);else{if(o==="[object Undefined]")return!1;if(e.skipInvalid)return!1;throw new Mo("unacceptable kind of an object to dump "+o)}e.tag!==null&&e.tag!=="?"&&(c=encodeURI(e.tag[0]==="!"?e.tag.slice(1):e.tag).replace(/!/g,"%21"),e.tag[0]==="!"?c="!"+c:c.slice(0,18)==="tag:yaml.org,2002:"?c="!!"+c.slice(18):c="!<"+c+">",e.dump=c+" "+e.dump)}return!0}ie(zu,"writeNode");function zoe(e,t){var n=[],r=[],s,i;for(Gk(e,n,r),s=0,i=r.length;s<i;s+=1)t.duplicates.push(n[r[s]]);t.usedDuplicates=new Array(i)}ie(zoe,"getDuplicateReferences");function Gk(e,t,n){var r,s,i;if(e!==null&&typeof e=="object")if(s=t.indexOf(e),s!==-1)n.indexOf(s)===-1&&n.push(s);else if(t.push(e),Array.isArray(e))for(s=0,i=e.length;s<i;s+=1)Gk(e[s],t,n);else for(r=Object.keys(e),s=0,i=r.length;s<i;s+=1)Gk(e[r[s]],t,n)}ie(Gk,"inspectNode");function VJe(e,t){t=t||{};var n=new Toe(t);n.noRefs||zoe(e,n);var r=e;return n.replacer&&(r=n.replacer.call({"":r},"",r)),zu(n,0,r,!0,!0)?n.dump+`
`:""}ie(VJe,"dump$1");function WJe(e,t){return function(){throw new Error("Function yaml."+e+" is removed in js-yaml 4. Use yaml."+t+" instead, which is now safe by default.")}}ie(WJe,"renamed");var HJe=Iae,GJe=CJe.load;/*! Bundled license information:

js-yaml/dist/js-yaml.mjs:
  (*! js-yaml 4.1.0 https://github.com/nodeca/js-yaml @license MIT *)
*/var Fl={aggregation:18,extension:18,composition:18,dependency:6,lollipop:13.5,arrow_point:4};function Sx(e,t){if(e===void 0||t===void 0)return{angle:0,deltaX:0,deltaY:0};e=Ys(e),t=Ys(t);const[n,r]=[e.x,e.y],[s,i]=[t.x,t.y],a=s-n,o=i-r;return{angle:Math.atan(o/a),deltaX:a,deltaY:o}}ie(Sx,"calculateDeltaAndAngle");var Ys=ie(e=>Array.isArray(e)?{x:e[0],y:e[1]}:e,"pointTransformer"),KJe=ie(e=>({x:ie(function(t,n,r){let s=0;const i=Ys(r[0]).x<Ys(r[r.length-1]).x?"left":"right";if(n===0&&Object.hasOwn(Fl,e.arrowTypeStart)){const{angle:m,deltaX:y}=Sx(r[0],r[1]);s=Fl[e.arrowTypeStart]*Math.cos(m)*(y>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(Fl,e.arrowTypeEnd)){const{angle:m,deltaX:y}=Sx(r[r.length-1],r[r.length-2]);s=Fl[e.arrowTypeEnd]*Math.cos(m)*(y>=0?1:-1)}const a=Math.abs(Ys(t).x-Ys(r[r.length-1]).x),o=Math.abs(Ys(t).y-Ys(r[r.length-1]).y),l=Math.abs(Ys(t).x-Ys(r[0]).x),c=Math.abs(Ys(t).y-Ys(r[0]).y),u=Fl[e.arrowTypeStart],d=Fl[e.arrowTypeEnd],h=1;if(a<d&&a>0&&o<d){let m=d+h-a;m*=i==="right"?-1:1,s-=m}if(l<u&&l>0&&c<u){let m=u+h-l;m*=i==="right"?-1:1,s+=m}return Ys(t).x+s},"x"),y:ie(function(t,n,r){let s=0;const i=Ys(r[0]).y<Ys(r[r.length-1]).y?"down":"up";if(n===0&&Object.hasOwn(Fl,e.arrowTypeStart)){const{angle:m,deltaY:y}=Sx(r[0],r[1]);s=Fl[e.arrowTypeStart]*Math.abs(Math.sin(m))*(y>=0?1:-1)}else if(n===r.length-1&&Object.hasOwn(Fl,e.arrowTypeEnd)){const{angle:m,deltaY:y}=Sx(r[r.length-1],r[r.length-2]);s=Fl[e.arrowTypeEnd]*Math.abs(Math.sin(m))*(y>=0?1:-1)}const a=Math.abs(Ys(t).y-Ys(r[r.length-1]).y),o=Math.abs(Ys(t).x-Ys(r[r.length-1]).x),l=Math.abs(Ys(t).y-Ys(r[0]).y),c=Math.abs(Ys(t).x-Ys(r[0]).x),u=Fl[e.arrowTypeStart],d=Fl[e.arrowTypeEnd],h=1;if(a<d&&a>0&&o<d){let m=d+h-a;m*=i==="up"?-1:1,s-=m}if(l<u&&l>0&&c<u){let m=u+h-l;m*=i==="up"?-1:1,s+=m}return Ys(t).y+s},"y")}),"getLineFunctionsWithOffset"),M6=ie(({flowchart:e})=>{var s,i;const t=((s=e==null?void 0:e.subGraphTitleMargin)==null?void 0:s.top)??0,n=((i=e==null?void 0:e.subGraphTitleMargin)==null?void 0:i.bottom)??0,r=t+n;return{subGraphTitleTopMargin:t,subGraphTitleBottomMargin:n,subGraphTitleTotalMargin:r}},"getSubGraphTitleMargins");const YJe=Object.freeze({left:0,top:0,width:16,height:16}),Kk=Object.freeze({rotate:0,vFlip:!1,hFlip:!1}),Uoe=Object.freeze({...YJe,...Kk}),ZJe=Object.freeze({...Uoe,body:"",hidden:!1}),XJe=Object.freeze({width:null,height:null}),JJe=Object.freeze({...XJe,...Kk}),QJe=(e,t,n,r="")=>{const s=e.split(":");if(e.slice(0,1)==="@"){if(s.length<2||s.length>3)return null;r=s.shift().slice(1)}if(s.length>3||!s.length)return null;if(s.length>1){const o=s.pop(),l=s.pop(),c={provider:s.length>0?s[0]:r,prefix:l,name:o};return O3(c)?c:null}const i=s[0],a=i.split("-");if(a.length>1){const o={provider:r,prefix:a.shift(),name:a.join("-")};return O3(o)?o:null}if(n&&r===""){const o={provider:r,prefix:"",name:i};return O3(o,n)?o:null}return null},O3=(e,t)=>e?!!((t&&e.prefix===""||e.prefix)&&e.name):!1;function eQe(e,t){const n={};!e.hFlip!=!t.hFlip&&(n.hFlip=!0),!e.vFlip!=!t.vFlip&&(n.vFlip=!0);const r=((e.rotate||0)+(t.rotate||0))%4;return r&&(n.rotate=r),n}function PV(e,t){const n=eQe(e,t);for(const r in ZJe)r in Kk?r in e&&!(r in n)&&(n[r]=Kk[r]):r in t?n[r]=t[r]:r in e&&(n[r]=e[r]);return n}function tQe(e,t){const n=e.icons,r=e.aliases||Object.create(null),s=Object.create(null);function i(a){if(n[a])return s[a]=[];if(!(a in s)){s[a]=null;const o=r[a]&&r[a].parent,l=o&&i(o);l&&(s[a]=[o].concat(l))}return s[a]}return(t||Object.keys(n).concat(Object.keys(r))).forEach(i),s}function OV(e,t,n){const r=e.icons,s=e.aliases||Object.create(null);let i={};function a(o){i=PV(r[o]||s[o],i)}return a(t),n.forEach(a),PV(e,i)}function nQe(e,t){if(e.icons[t])return OV(e,t,[]);const n=tQe(e,[t])[t];return n?OV(e,t,n):null}const rQe=/(-?[0-9.]*[0-9]+[0-9.]*)/g,sQe=/^-?[0-9.]*[0-9]+[0-9.]*$/g;function DV(e,t,n){if(t===1)return e;if(n=n||100,typeof e=="number")return Math.ceil(e*t*n)/n;if(typeof e!="string")return e;const r=e.split(rQe);if(r===null||!r.length)return e;const s=[];let i=r.shift(),a=sQe.test(i);for(;;){if(a){const o=parseFloat(i);isNaN(o)?s.push(i):s.push(Math.ceil(o*t*n)/n)}else s.push(i);if(i=r.shift(),i===void 0)return s.join("");a=!a}}function iQe(e,t="defs"){let n="";const r=e.indexOf("<"+t);for(;r>=0;){const s=e.indexOf(">",r),i=e.indexOf("</"+t);if(s===-1||i===-1)break;const a=e.indexOf(">",i);if(a===-1)break;n+=e.slice(s+1,i).trim(),e=e.slice(0,r).trim()+e.slice(a+1)}return{defs:n,content:e}}function aQe(e,t){return e?"<defs>"+e+"</defs>"+t:t}function oQe(e,t,n){const r=iQe(e);return aQe(r.defs,t+r.content+n)}const lQe=e=>e==="unset"||e==="undefined"||e==="none";function cQe(e,t){const n={...Uoe,...e},r={...JJe,...t},s={left:n.left,top:n.top,width:n.width,height:n.height};let i=n.body;[n,r].forEach(b=>{const v=[],x=b.hFlip,w=b.vFlip;let S=b.rotate;x?w?S+=2:(v.push("translate("+(s.width+s.left).toString()+" "+(0-s.top).toString()+")"),v.push("scale(-1 1)"),s.top=s.left=0):w&&(v.push("translate("+(0-s.left).toString()+" "+(s.height+s.top).toString()+")"),v.push("scale(1 -1)"),s.top=s.left=0);let k;switch(S<0&&(S-=Math.floor(S/4)*4),S=S%4,S){case 1:k=s.height/2+s.top,v.unshift("rotate(90 "+k.toString()+" "+k.toString()+")");break;case 2:v.unshift("rotate(180 "+(s.width/2+s.left).toString()+" "+(s.height/2+s.top).toString()+")");break;case 3:k=s.width/2+s.left,v.unshift("rotate(-90 "+k.toString()+" "+k.toString()+")");break}S%2===1&&(s.left!==s.top&&(k=s.left,s.left=s.top,s.top=k),s.width!==s.height&&(k=s.width,s.width=s.height,s.height=k)),v.length&&(i=oQe(i,'<g transform="'+v.join(" ")+'">',"</g>"))});const a=r.width,o=r.height,l=s.width,c=s.height;let u,d;a===null?(d=o===null?"1em":o==="auto"?c:o,u=DV(d,l/c)):(u=a==="auto"?l:a,d=o===null?DV(u,c/l):o==="auto"?c:o);const h={},m=(b,v)=>{lQe(v)||(h[b]=v.toString())};m("width",u),m("height",d);const y=[s.left,s.top,l,c];return h.viewBox=y.join(" "),{attributes:h,viewBox:y,body:i}}const uQe=/\sid="(\S+)"/g,dQe="IconifyId"+Date.now().toString(16)+(Math.random()*16777216|0).toString(16);let fQe=0;function hQe(e,t=dQe){const n=[];let r;for(;r=uQe.exec(e);)n.push(r[1]);if(!n.length)return e;const s="suffix"+(Math.random()*16777216|Date.now()).toString(16);return n.forEach(i=>{const a=typeof t=="function"?t(i):t+(fQe++).toString(),o=i.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");e=e.replace(new RegExp('([#;"])('+o+')([")]|\\.[a-z])',"g"),"$1"+a+s+"$3")}),e=e.replace(new RegExp(s,"g"),""),e}function pQe(e,t){let n=e.indexOf("xlink:")===-1?"":' xmlns:xlink="http://www.w3.org/1999/xlink"';for(const r in t)n+=" "+r+'="'+t[r]+'"';return'<svg xmlns="http://www.w3.org/2000/svg"'+n+">"+e+"</svg>"}var mQe={body:'<g><rect width="80" height="80" style="fill: #087ebf; stroke-width: 0px;"/><text transform="translate(21.16 64.67)" style="fill: #fff; font-family: ArialMT, Arial; font-size: 67.75px;"><tspan x="0" y="0">?</tspan></text></g>',height:80,width:80},hP=new Map,qoe=new Map,gQe=ie(e=>{for(const t of e){if(!t.name)throw new Error('Invalid icon loader. Must have a "name" property with non-empty string value.');if(Ut.debug("Registering icon pack:",t.name),"loader"in t)qoe.set(t.name,t.loader);else if("icons"in t)hP.set(t.name,t.icons);else throw Ut.error("Invalid icon loader:",t),new Error('Invalid icon loader. Must have either "icons" or "loader" property.')}},"registerIconPacks"),yQe=ie(async(e,t)=>{const n=QJe(e,!0,t!==void 0);if(!n)throw new Error(`Invalid icon name: ${e}`);const r=n.prefix||t;if(!r)throw new Error(`Icon name must contain a prefix: ${e}`);let s=hP.get(r);if(!s){const a=qoe.get(r);if(!a)throw new Error(`Icon set not found: ${n.prefix}`);try{s={...await a(),prefix:r},hP.set(r,s)}catch(o){throw Ut.error(o),new Error(`Failed to load icon set: ${n.prefix}`)}}const i=nQe(s,n.name);if(!i)throw new Error(`Icon not found: ${e}`);return i},"getRegisteredIconData"),lA=ie(async(e,t)=>{let n;try{n=await yQe(e,t==null?void 0:t.fallbackPrefix)}catch(i){Ut.error(i),n=mQe}const r=cQe(n,t);return pQe(hQe(r.body),r.attributes)},"getIconSVG"),ex={},$i={},FV;function bQe(){return FV||(FV=1,Object.defineProperty($i,"__esModule",{value:!0}),$i.BLANK_URL=$i.relativeFirstCharacters=$i.whitespaceEscapeCharsRegex=$i.urlSchemeRegex=$i.ctrlCharactersRegex=$i.htmlCtrlEntityRegex=$i.htmlEntitiesRegex=$i.invalidProtocolRegex=void 0,$i.invalidProtocolRegex=/^([^\w]*)(javascript|data|vbscript)/im,$i.htmlEntitiesRegex=/&#(\w+)(^\w|;)?/g,$i.htmlCtrlEntityRegex=/&(newline|tab);/gi,$i.ctrlCharactersRegex=/[\u0000-\u001F\u007F-\u009F\u2000-\u200D\uFEFF]/gim,$i.urlSchemeRegex=/^.+(:|&colon;)/gim,$i.whitespaceEscapeCharsRegex=/(\\|%5[cC])((%(6[eE]|72|74))|[nrt])/g,$i.relativeFirstCharacters=[".","/"],$i.BLANK_URL="about:blank"),$i}var LV;function vQe(){if(LV)return ex;LV=1,Object.defineProperty(ex,"__esModule",{value:!0}),ex.sanitizeUrl=void 0;var e=bQe();function t(a){return e.relativeFirstCharacters.indexOf(a[0])>-1}function n(a){var o=a.replace(e.ctrlCharactersRegex,"");return o.replace(e.htmlEntitiesRegex,function(l,c){return String.fromCharCode(c)})}function r(a){return URL.canParse(a)}function s(a){try{return decodeURIComponent(a)}catch{return a}}function i(a){if(!a)return e.BLANK_URL;var o,l=s(a.trim());do l=n(l).replace(e.htmlCtrlEntityRegex,"").replace(e.ctrlCharactersRegex,"").replace(e.whitespaceEscapeCharsRegex,"").trim(),l=s(l),o=l.match(e.ctrlCharactersRegex)||l.match(e.htmlEntitiesRegex)||l.match(e.htmlCtrlEntityRegex)||l.match(e.whitespaceEscapeCharsRegex);while(o&&o.length>0);var c=l;if(!c)return e.BLANK_URL;if(t(c))return c;var u=c.trimStart(),d=u.match(e.urlSchemeRegex);if(!d)return c;var h=d[0].toLowerCase().trim();if(e.invalidProtocolRegex.test(h))return e.BLANK_URL;var m=u.replace(/\\/g,"/");if(h==="mailto:"||h.includes("://"))return m;if(h==="http:"||h==="https:"){if(!r(m))return e.BLANK_URL;var y=new URL(m);return y.protocol=y.protocol.toLowerCase(),y.hostname=y.hostname.toLowerCase(),y.toString()}return m}return ex.sanitizeUrl=i,ex}var xQe=vQe(),wQe={value:()=>{}};function Voe(){for(var e=0,t=arguments.length,n={},r;e<t;++e){if(!(r=arguments[e]+"")||r in n||/[\s.]/.test(r))throw new Error("illegal type: "+r);n[r]=[]}return new n2(n)}function n2(e){this._=e}function _Qe(e,t){return e.trim().split(/^|\s+/).map(function(n){var r="",s=n.indexOf(".");if(s>=0&&(r=n.slice(s+1),n=n.slice(0,s)),n&&!t.hasOwnProperty(n))throw new Error("unknown type: "+n);return{type:n,name:r}})}n2.prototype=Voe.prototype={constructor:n2,on:function(e,t){var n=this._,r=_Qe(e+"",n),s,i=-1,a=r.length;if(arguments.length<2){for(;++i<a;)if((s=(e=r[i]).type)&&(s=SQe(n[s],e.name)))return s;return}if(t!=null&&typeof t!="function")throw new Error("invalid callback: "+t);for(;++i<a;)if(s=(e=r[i]).type)n[s]=BV(n[s],e.name,t);else if(t==null)for(s in n)n[s]=BV(n[s],e.name,null);return this},copy:function(){var e={},t=this._;for(var n in t)e[n]=t[n].slice();return new n2(e)},call:function(e,t){if((s=arguments.length-2)>0)for(var n=new Array(s),r=0,s,i;r<s;++r)n[r]=arguments[r+2];if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(i=this._[e],r=0,s=i.length;r<s;++r)i[r].value.apply(t,n)},apply:function(e,t,n){if(!this._.hasOwnProperty(e))throw new Error("unknown type: "+e);for(var r=this._[e],s=0,i=r.length;s<i;++s)r[s].value.apply(t,n)}};function SQe(e,t){for(var n=0,r=e.length,s;n<r;++n)if((s=e[n]).name===t)return s.value}function BV(e,t,n){for(var r=0,s=e.length;r<s;++r)if(e[r].name===t){e[r]=wQe,e=e.slice(0,r).concat(e.slice(r+1));break}return n!=null&&e.push({name:t,value:n}),e}var pP="http://www.w3.org/1999/xhtml";const $V={svg:"http://www.w3.org/2000/svg",xhtml:pP,xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};function cA(e){var t=e+="",n=t.indexOf(":");return n>=0&&(t=e.slice(0,n))!=="xmlns"&&(e=e.slice(n+1)),$V.hasOwnProperty(t)?{space:$V[t],local:e}:e}function CQe(e){return function(){var t=this.ownerDocument,n=this.namespaceURI;return n===pP&&t.documentElement.namespaceURI===pP?t.createElement(e):t.createElementNS(n,e)}}function kQe(e){return function(){return this.ownerDocument.createElementNS(e.space,e.local)}}function Woe(e){var t=cA(e);return(t.local?kQe:CQe)(t)}function EQe(){}function I6(e){return e==null?EQe:function(){return this.querySelector(e)}}function TQe(e){typeof e!="function"&&(e=I6(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=new Array(a),l,c,u=0;u<a;++u)(l=i[u])&&(c=e.call(l,l.__data__,u,i))&&("__data__"in l&&(c.__data__=l.__data__),o[u]=c);return new bl(r,this._parents)}function AQe(e){return e==null?[]:Array.isArray(e)?e:Array.from(e)}function RQe(){return[]}function Hoe(e){return e==null?RQe:function(){return this.querySelectorAll(e)}}function NQe(e){return function(){return AQe(e.apply(this,arguments))}}function MQe(e){typeof e=="function"?e=NQe(e):e=Hoe(e);for(var t=this._groups,n=t.length,r=[],s=[],i=0;i<n;++i)for(var a=t[i],o=a.length,l,c=0;c<o;++c)(l=a[c])&&(r.push(e.call(l,l.__data__,c,a)),s.push(l));return new bl(r,s)}function Goe(e){return function(){return this.matches(e)}}function Koe(e){return function(t){return t.matches(e)}}var IQe=Array.prototype.find;function jQe(e){return function(){return IQe.call(this.children,e)}}function PQe(){return this.firstElementChild}function OQe(e){return this.select(e==null?PQe:jQe(typeof e=="function"?e:Koe(e)))}var DQe=Array.prototype.filter;function FQe(){return Array.from(this.children)}function LQe(e){return function(){return DQe.call(this.children,e)}}function BQe(e){return this.selectAll(e==null?FQe:LQe(typeof e=="function"?e:Koe(e)))}function $Qe(e){typeof e!="function"&&(e=Goe(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=[],l,c=0;c<a;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&o.push(l);return new bl(r,this._parents)}function Yoe(e){return new Array(e.length)}function zQe(){return new bl(this._enter||this._groups.map(Yoe),this._parents)}function Yk(e,t){this.ownerDocument=e.ownerDocument,this.namespaceURI=e.namespaceURI,this._next=null,this._parent=e,this.__data__=t}Yk.prototype={constructor:Yk,appendChild:function(e){return this._parent.insertBefore(e,this._next)},insertBefore:function(e,t){return this._parent.insertBefore(e,t)},querySelector:function(e){return this._parent.querySelector(e)},querySelectorAll:function(e){return this._parent.querySelectorAll(e)}};function UQe(e){return function(){return e}}function qQe(e,t,n,r,s,i){for(var a=0,o,l=t.length,c=i.length;a<c;++a)(o=t[a])?(o.__data__=i[a],r[a]=o):n[a]=new Yk(e,i[a]);for(;a<l;++a)(o=t[a])&&(s[a]=o)}function VQe(e,t,n,r,s,i,a){var o,l,c=new Map,u=t.length,d=i.length,h=new Array(u),m;for(o=0;o<u;++o)(l=t[o])&&(h[o]=m=a.call(l,l.__data__,o,t)+"",c.has(m)?s[o]=l:c.set(m,l));for(o=0;o<d;++o)m=a.call(e,i[o],o,i)+"",(l=c.get(m))?(r[o]=l,l.__data__=i[o],c.delete(m)):n[o]=new Yk(e,i[o]);for(o=0;o<u;++o)(l=t[o])&&c.get(h[o])===l&&(s[o]=l)}function WQe(e){return e.__data__}function HQe(e,t){if(!arguments.length)return Array.from(this,WQe);var n=t?VQe:qQe,r=this._parents,s=this._groups;typeof e!="function"&&(e=UQe(e));for(var i=s.length,a=new Array(i),o=new Array(i),l=new Array(i),c=0;c<i;++c){var u=r[c],d=s[c],h=d.length,m=GQe(e.call(u,u&&u.__data__,c,r)),y=m.length,b=o[c]=new Array(y),v=a[c]=new Array(y),x=l[c]=new Array(h);n(u,d,b,v,x,m,t);for(var w=0,S=0,k,C;w<y;++w)if(k=b[w]){for(w>=S&&(S=w+1);!(C=v[S])&&++S<y;);k._next=C||null}}return a=new bl(a,r),a._enter=o,a._exit=l,a}function GQe(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function KQe(){return new bl(this._exit||this._groups.map(Yoe),this._parents)}function YQe(e,t,n){var r=this.enter(),s=this,i=this.exit();return typeof e=="function"?(r=e(r),r&&(r=r.selection())):r=r.append(e+""),t!=null&&(s=t(s),s&&(s=s.selection())),n==null?i.remove():n(i),r&&s?r.merge(s).order():s}function ZQe(e){for(var t=e.selection?e.selection():e,n=this._groups,r=t._groups,s=n.length,i=r.length,a=Math.min(s,i),o=new Array(s),l=0;l<a;++l)for(var c=n[l],u=r[l],d=c.length,h=o[l]=new Array(d),m,y=0;y<d;++y)(m=c[y]||u[y])&&(h[y]=m);for(;l<s;++l)o[l]=n[l];return new bl(o,this._parents)}function XQe(){for(var e=this._groups,t=-1,n=e.length;++t<n;)for(var r=e[t],s=r.length-1,i=r[s],a;--s>=0;)(a=r[s])&&(i&&a.compareDocumentPosition(i)^4&&i.parentNode.insertBefore(a,i),i=a);return this}function JQe(e){e||(e=QQe);function t(d,h){return d&&h?e(d.__data__,h.__data__):!d-!h}for(var n=this._groups,r=n.length,s=new Array(r),i=0;i<r;++i){for(var a=n[i],o=a.length,l=s[i]=new Array(o),c,u=0;u<o;++u)(c=a[u])&&(l[u]=c);l.sort(t)}return new bl(s,this._parents).order()}function QQe(e,t){return e<t?-1:e>t?1:e>=t?0:NaN}function eet(){var e=arguments[0];return arguments[0]=this,e.apply(null,arguments),this}function tet(){return Array.from(this)}function net(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length;s<i;++s){var a=r[s];if(a)return a}return null}function ret(){let e=0;for(const t of this)++e;return e}function set(){return!this.node()}function iet(e){for(var t=this._groups,n=0,r=t.length;n<r;++n)for(var s=t[n],i=0,a=s.length,o;i<a;++i)(o=s[i])&&e.call(o,o.__data__,i,s);return this}function aet(e){return function(){this.removeAttribute(e)}}function oet(e){return function(){this.removeAttributeNS(e.space,e.local)}}function cet(e,t){return function(){this.setAttribute(e,t)}}function uet(e,t){return function(){this.setAttributeNS(e.space,e.local,t)}}function det(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttribute(e):this.setAttribute(e,n)}}function fet(e,t){return function(){var n=t.apply(this,arguments);n==null?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}}function het(e,t){var n=cA(e);if(arguments.length<2){var r=this.node();return n.local?r.getAttributeNS(n.space,n.local):r.getAttribute(n)}return this.each((t==null?n.local?oet:aet:typeof t=="function"?n.local?fet:det:n.local?uet:cet)(n,t))}function Zoe(e){return e.ownerDocument&&e.ownerDocument.defaultView||e.document&&e||e.defaultView}function pet(e){return function(){this.style.removeProperty(e)}}function met(e,t,n){return function(){this.style.setProperty(e,t,n)}}function get(e,t,n){return function(){var r=t.apply(this,arguments);r==null?this.style.removeProperty(e):this.style.setProperty(e,r,n)}}function yet(e,t,n){return arguments.length>1?this.each((t==null?pet:typeof t=="function"?get:met)(e,t,n??"")):By(this.node(),e)}function By(e,t){return e.style.getPropertyValue(t)||Zoe(e).getComputedStyle(e,null).getPropertyValue(t)}function bet(e){return function(){delete this[e]}}function vet(e,t){return function(){this[e]=t}}function xet(e,t){return function(){var n=t.apply(this,arguments);n==null?delete this[e]:this[e]=n}}function wet(e,t){return arguments.length>1?this.each((t==null?bet:typeof t=="function"?xet:vet)(e,t)):this.node()[e]}function Xoe(e){return e.trim().split(/^|\s+/)}function j6(e){return e.classList||new Joe(e)}function Joe(e){this._node=e,this._names=Xoe(e.getAttribute("class")||"")}Joe.prototype={add:function(e){var t=this._names.indexOf(e);t<0&&(this._names.push(e),this._node.setAttribute("class",this._names.join(" ")))},remove:function(e){var t=this._names.indexOf(e);t>=0&&(this._names.splice(t,1),this._node.setAttribute("class",this._names.join(" ")))},contains:function(e){return this._names.indexOf(e)>=0}};function Qoe(e,t){for(var n=j6(e),r=-1,s=t.length;++r<s;)n.add(t[r])}function ele(e,t){for(var n=j6(e),r=-1,s=t.length;++r<s;)n.remove(t[r])}function _et(e){return function(){Qoe(this,e)}}function Cet(e){return function(){ele(this,e)}}function ket(e,t){return function(){(t.apply(this,arguments)?Qoe:ele)(this,e)}}function Eet(e,t){var n=Xoe(e+"");if(arguments.length<2){for(var r=j6(this.node()),s=-1,i=n.length;++s<i;)if(!r.contains(n[s]))return!1;return!0}return this.each((typeof t=="function"?ket:t?_et:Cet)(n,t))}function Tet(){this.textContent=""}function Aet(e){return function(){this.textContent=e}}function Ret(e){return function(){var t=e.apply(this,arguments);this.textContent=t??""}}function Net(e){return arguments.length?this.each(e==null?Tet:(typeof e=="function"?Ret:Aet)(e)):this.node().textContent}function Met(){this.innerHTML=""}function Iet(e){return function(){this.innerHTML=e}}function jet(e){return function(){var t=e.apply(this,arguments);this.innerHTML=t??""}}function Pet(e){return arguments.length?this.each(e==null?Met:(typeof e=="function"?jet:Iet)(e)):this.node().innerHTML}function Oet(){this.nextSibling&&this.parentNode.appendChild(this)}function Det(){return this.each(Oet)}function Fet(){this.previousSibling&&this.parentNode.insertBefore(this,this.parentNode.firstChild)}function Let(){return this.each(Fet)}function Bet(e){var t=typeof e=="function"?e:Woe(e);return this.select(function(){return this.appendChild(t.apply(this,arguments))})}function $et(){return null}function zet(e,t){var n=typeof e=="function"?e:Woe(e),r=t==null?$et:typeof t=="function"?t:I6(t);return this.select(function(){return this.insertBefore(n.apply(this,arguments),r.apply(this,arguments)||null)})}function Uet(){var e=this.parentNode;e&&e.removeChild(this)}function qet(){return this.each(Uet)}function Vet(){var e=this.cloneNode(!1),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Wet(){var e=this.cloneNode(!0),t=this.parentNode;return t?t.insertBefore(e,this.nextSibling):e}function Het(e){return this.select(e?Wet:Vet)}function Get(e){return arguments.length?this.property("__data__",e):this.node().__data__}function Ket(e){return function(t){e.call(this,t,this.__data__)}}function Yet(e){return e.trim().split(/^|\s+/).map(function(t){var n="",r=t.indexOf(".");return r>=0&&(n=t.slice(r+1),t=t.slice(0,r)),{type:t,name:n}})}function Zet(e){return function(){var t=this.__on;if(t){for(var n=0,r=-1,s=t.length,i;n<s;++n)i=t[n],(!e.type||i.type===e.type)&&i.name===e.name?this.removeEventListener(i.type,i.listener,i.options):t[++r]=i;++r?t.length=r:delete this.__on}}}function Xet(e,t,n){return function(){var r=this.__on,s,i=Ket(t);if(r){for(var a=0,o=r.length;a<o;++a)if((s=r[a]).type===e.type&&s.name===e.name){this.removeEventListener(s.type,s.listener,s.options),this.addEventListener(s.type,s.listener=i,s.options=n),s.value=t;return}}this.addEventListener(e.type,i,n),s={type:e.type,name:e.name,value:t,listener:i,options:n},r?r.push(s):this.__on=[s]}}function Jet(e,t,n){var r=Yet(e+""),s,i=r.length,a;if(arguments.length<2){var o=this.node().__on;if(o){for(var l=0,c=o.length,u;l<c;++l)for(s=0,u=o[l];s<i;++s)if((a=r[s]).type===u.type&&a.name===u.name)return u.value}return}for(o=t?Xet:Zet,s=0;s<i;++s)this.each(o(r[s],t,n));return this}function tle(e,t,n){var r=Zoe(e),s=r.CustomEvent;typeof s=="function"?s=new s(t,n):(s=r.document.createEvent("Event"),n?(s.initEvent(t,n.bubbles,n.cancelable),s.detail=n.detail):s.initEvent(t,!1,!1)),e.dispatchEvent(s)}function Qet(e,t){return function(){return tle(this,e,t)}}function ett(e,t){return function(){return tle(this,e,t.apply(this,arguments))}}function ttt(e,t){return this.each((typeof t=="function"?ett:Qet)(e,t))}function*ntt(){for(var e=this._groups,t=0,n=e.length;t<n;++t)for(var r=e[t],s=0,i=r.length,a;s<i;++s)(a=r[s])&&(yield a)}var nle=[null];function bl(e,t){this._groups=e,this._parents=t}function y_(){return new bl([[document.documentElement]],nle)}function rtt(){return this}bl.prototype=y_.prototype={constructor:bl,select:TQe,selectAll:MQe,selectChild:OQe,selectChildren:BQe,filter:$Qe,data:HQe,enter:zQe,exit:KQe,join:YQe,merge:ZQe,selection:rtt,order:XQe,sort:JQe,call:eet,nodes:tet,node:net,size:ret,empty:set,each:iet,attr:het,style:yet,property:wet,classed:Eet,text:Net,html:Pet,raise:Det,lower:Let,append:Bet,insert:zet,remove:qet,clone:Het,datum:Get,on:Jet,dispatch:ttt,[Symbol.iterator]:ntt};function Zr(e){return typeof e=="string"?new bl([[document.querySelector(e)]],[document.documentElement]):new bl([[e]],nle)}function P6(e,t,n){e.prototype=t.prototype=n,n.constructor=e}function rle(e,t){var n=Object.create(e.prototype);for(var r in t)n[r]=t[r];return n}function b_(){}var c1=.7,Zk=1/c1,W0="\\s*([+-]?\\d+)\\s*",u1="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)\\s*",Iu="\\s*([+-]?(?:\\d*\\.)?\\d+(?:[eE][+-]?\\d+)?)%\\s*",stt=/^#([0-9a-f]{3,8})$/,itt=new RegExp(`^rgb\\(${W0},${W0},${W0}\\)$`),att=new RegExp(`^rgb\\(${Iu},${Iu},${Iu}\\)$`),ott=new RegExp(`^rgba\\(${W0},${W0},${W0},${u1}\\)$`),ltt=new RegExp(`^rgba\\(${Iu},${Iu},${Iu},${u1}\\)$`),ctt=new RegExp(`^hsl\\(${u1},${Iu},${Iu}\\)$`),utt=new RegExp(`^hsla\\(${u1},${Iu},${Iu},${u1}\\)$`),zV={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};P6(b_,d1,{copy(e){return Object.assign(new this.constructor,this,e)},displayable(){return this.rgb().displayable()},hex:UV,formatHex:UV,formatHex8:dtt,formatHsl:ftt,formatRgb:qV,toString:qV});function UV(){return this.rgb().formatHex()}function dtt(){return this.rgb().formatHex8()}function ftt(){return sle(this).formatHsl()}function qV(){return this.rgb().formatRgb()}function d1(e){var t,n;return e=(e+"").trim().toLowerCase(),(t=stt.exec(e))?(n=t[1].length,t=parseInt(t[1],16),n===6?VV(t):n===3?new jo(t>>8&15|t>>4&240,t>>4&15|t&240,(t&15)<<4|t&15,1):n===8?CC(t>>24&255,t>>16&255,t>>8&255,(t&255)/255):n===4?CC(t>>12&15|t>>8&240,t>>8&15|t>>4&240,t>>4&15|t&240,((t&15)<<4|t&15)/255):null):(t=itt.exec(e))?new jo(t[1],t[2],t[3],1):(t=att.exec(e))?new jo(t[1]*255/100,t[2]*255/100,t[3]*255/100,1):(t=ott.exec(e))?CC(t[1],t[2],t[3],t[4]):(t=ltt.exec(e))?CC(t[1]*255/100,t[2]*255/100,t[3]*255/100,t[4]):(t=ctt.exec(e))?GV(t[1],t[2]/100,t[3]/100,1):(t=utt.exec(e))?GV(t[1],t[2]/100,t[3]/100,t[4]):zV.hasOwnProperty(e)?VV(zV[e]):e==="transparent"?new jo(NaN,NaN,NaN,0):null}function VV(e){return new jo(e>>16&255,e>>8&255,e&255,1)}function CC(e,t,n,r){return r<=0&&(e=t=n=NaN),new jo(e,t,n,r)}function htt(e){return e instanceof b_||(e=d1(e)),e?(e=e.rgb(),new jo(e.r,e.g,e.b,e.opacity)):new jo}function mP(e,t,n,r){return arguments.length===1?htt(e):new jo(e,t,n,r??1)}function jo(e,t,n,r){this.r=+e,this.g=+t,this.b=+n,this.opacity=+r}P6(jo,mP,rle(b_,{brighter(e){return e=e==null?Zk:Math.pow(Zk,e),new jo(this.r*e,this.g*e,this.b*e,this.opacity)},darker(e){return e=e==null?c1:Math.pow(c1,e),new jo(this.r*e,this.g*e,this.b*e,this.opacity)},rgb(){return this},clamp(){return new jo(xm(this.r),xm(this.g),xm(this.b),Xk(this.opacity))},displayable(){return-.5<=this.r&&this.r<255.5&&-.5<=this.g&&this.g<255.5&&-.5<=this.b&&this.b<255.5&&0<=this.opacity&&this.opacity<=1},hex:WV,formatHex:WV,formatHex8:ptt,formatRgb:HV,toString:HV}));function WV(){return`#${pm(this.r)}${pm(this.g)}${pm(this.b)}`}function ptt(){return`#${pm(this.r)}${pm(this.g)}${pm(this.b)}${pm((isNaN(this.opacity)?1:this.opacity)*255)}`}function HV(){const e=Xk(this.opacity);return`${e===1?"rgb(":"rgba("}${xm(this.r)}, ${xm(this.g)}, ${xm(this.b)}${e===1?")":`, ${e})`}`}function Xk(e){return isNaN(e)?1:Math.max(0,Math.min(1,e))}function xm(e){return Math.max(0,Math.min(255,Math.round(e)||0))}function pm(e){return e=xm(e),(e<16?"0":"")+e.toString(16)}function GV(e,t,n,r){return r<=0?e=t=n=NaN:n<=0||n>=1?e=t=NaN:t<=0&&(e=NaN),new wc(e,t,n,r)}function sle(e){if(e instanceof wc)return new wc(e.h,e.s,e.l,e.opacity);if(e instanceof b_||(e=d1(e)),!e)return new wc;if(e instanceof wc)return e;e=e.rgb();var t=e.r/255,n=e.g/255,r=e.b/255,s=Math.min(t,n,r),i=Math.max(t,n,r),a=NaN,o=i-s,l=(i+s)/2;return o?(t===i?a=(n-r)/o+(n<r)*6:n===i?a=(r-t)/o+2:a=(t-n)/o+4,o/=l<.5?i+s:2-i-s,a*=60):o=l>0&&l<1?0:a,new wc(a,o,l,e.opacity)}function mtt(e,t,n,r){return arguments.length===1?sle(e):new wc(e,t,n,r??1)}function wc(e,t,n,r){this.h=+e,this.s=+t,this.l=+n,this.opacity=+r}P6(wc,mtt,rle(b_,{brighter(e){return e=e==null?Zk:Math.pow(Zk,e),new wc(this.h,this.s,this.l*e,this.opacity)},darker(e){return e=e==null?c1:Math.pow(c1,e),new wc(this.h,this.s,this.l*e,this.opacity)},rgb(){var e=this.h%360+(this.h<0)*360,t=isNaN(e)||isNaN(this.s)?0:this.s,n=this.l,r=n+(n<.5?n:1-n)*t,s=2*n-r;return new jo(D3(e>=240?e-240:e+120,s,r),D3(e,s,r),D3(e<120?e+240:e-120,s,r),this.opacity)},clamp(){return new wc(KV(this.h),kC(this.s),kC(this.l),Xk(this.opacity))},displayable(){return(0<=this.s&&this.s<=1||isNaN(this.s))&&0<=this.l&&this.l<=1&&0<=this.opacity&&this.opacity<=1},formatHsl(){const e=Xk(this.opacity);return`${e===1?"hsl(":"hsla("}${KV(this.h)}, ${kC(this.s)*100}%, ${kC(this.l)*100}%${e===1?")":`, ${e})`}`}}));function KV(e){return e=(e||0)%360,e<0?e+360:e}function kC(e){return Math.max(0,Math.min(1,e||0))}function D3(e,t,n){return(e<60?t+(n-t)*e/60:e<180?n:e<240?t+(n-t)*(240-e)/60:t)*255}const O6=e=>()=>e;function ile(e,t){return function(n){return e+n*t}}function gtt(e,t,n){return e=Math.pow(e,n),t=Math.pow(t,n)-e,n=1/n,function(r){return Math.pow(e+r*t,n)}}function Jdt(e,t){var n=t-e;return n?ile(e,n>180||n<-180?n-360*Math.round(n/360):n):O6(isNaN(e)?t:e)}function ytt(e){return(e=+e)==1?ale:function(t,n){return n-t?gtt(t,n,e):O6(isNaN(t)?n:t)}}function ale(e,t){var n=t-e;return n?ile(e,n):O6(isNaN(e)?t:e)}const YV=function e(t){var n=ytt(t);function r(s,i){var a=n((s=mP(s)).r,(i=mP(i)).r),o=n(s.g,i.g),l=n(s.b,i.b),c=ale(s.opacity,i.opacity);return function(u){return s.r=a(u),s.g=o(u),s.b=l(u),s.opacity=c(u),s+""}}return r.gamma=e,r}(1);function bh(e,t){return e=+e,t=+t,function(n){return e*(1-n)+t*n}}var gP=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,F3=new RegExp(gP.source,"g");function btt(e){return function(){return e}}function vtt(e){return function(t){return e(t)+""}}function xtt(e,t){var n=gP.lastIndex=F3.lastIndex=0,r,s,i,a=-1,o=[],l=[];for(e=e+"",t=t+"";(r=gP.exec(e))&&(s=F3.exec(t));)(i=s.index)>n&&(i=t.slice(n,i),o[a]?o[a]+=i:o[++a]=i),(r=r[0])===(s=s[0])?o[a]?o[a]+=s:o[++a]=s:(o[++a]=null,l.push({i:a,x:bh(r,s)})),n=F3.lastIndex;return n<t.length&&(i=t.slice(n),o[a]?o[a]+=i:o[++a]=i),o.length<2?l[0]?vtt(l[0].x):btt(t):(t=l.length,function(c){for(var u=0,d;u<t;++u)o[(d=l[u]).i]=d.x(c);return o.join("")})}var ZV=180/Math.PI,yP={translateX:0,translateY:0,rotate:0,skewX:0,scaleX:1,scaleY:1};function ole(e,t,n,r,s,i){var a,o,l;return(a=Math.sqrt(e*e+t*t))&&(e/=a,t/=a),(l=e*n+t*r)&&(n-=e*l,r-=t*l),(o=Math.sqrt(n*n+r*r))&&(n/=o,r/=o,l/=o),e*r<t*n&&(e=-e,t=-t,l=-l,a=-a),{translateX:s,translateY:i,rotate:Math.atan2(t,e)*ZV,skewX:Math.atan(l)*ZV,scaleX:a,scaleY:o}}var EC;function wtt(e){const t=new(typeof DOMMatrix=="function"?DOMMatrix:WebKitCSSMatrix)(e+"");return t.isIdentity?yP:ole(t.a,t.b,t.c,t.d,t.e,t.f)}function _tt(e){return e==null||(EC||(EC=document.createElementNS("http://www.w3.org/2000/svg","g")),EC.setAttribute("transform",e),!(e=EC.transform.baseVal.consolidate()))?yP:(e=e.matrix,ole(e.a,e.b,e.c,e.d,e.e,e.f))}function lle(e,t,n,r){function s(c){return c.length?c.pop()+" ":""}function i(c,u,d,h,m,y){if(c!==d||u!==h){var b=m.push("translate(",null,t,null,n);y.push({i:b-4,x:bh(c,d)},{i:b-2,x:bh(u,h)})}else(d||h)&&m.push("translate("+d+t+h+n)}function a(c,u,d,h){c!==u?(c-u>180?u+=360:u-c>180&&(c+=360),h.push({i:d.push(s(d)+"rotate(",null,r)-2,x:bh(c,u)})):u&&d.push(s(d)+"rotate("+u+r)}function o(c,u,d,h){c!==u?h.push({i:d.push(s(d)+"skewX(",null,r)-2,x:bh(c,u)}):u&&d.push(s(d)+"skewX("+u+r)}function l(c,u,d,h,m,y){if(c!==d||u!==h){var b=m.push(s(m)+"scale(",null,",",null,")");y.push({i:b-4,x:bh(c,d)},{i:b-2,x:bh(u,h)})}else(d!==1||h!==1)&&m.push(s(m)+"scale("+d+","+h+")")}return function(c,u){var d=[],h=[];return c=e(c),u=e(u),i(c.translateX,c.translateY,u.translateX,u.translateY,d,h),a(c.rotate,u.rotate,d,h),o(c.skewX,u.skewX,d,h),l(c.scaleX,c.scaleY,u.scaleX,u.scaleY,d,h),c=u=null,function(m){for(var y=-1,b=h.length,v;++y<b;)d[(v=h[y]).i]=v.x(m);return d.join("")}}}var Stt=lle(wtt,"px, ","px)","deg)"),Ctt=lle(_tt,", ",")",")"),$y=0,Cx=0,tx=0,cle=1e3,Jk,kx,Qk=0,zm=0,uA=0,f1=typeof performance=="object"&&performance.now?performance:Date,ule=typeof window=="object"&&window.requestAnimationFrame?window.requestAnimationFrame.bind(window):function(e){setTimeout(e,17)};function D6(){return zm||(ule(ktt),zm=f1.now()+uA)}function ktt(){zm=0}function eE(){this._call=this._time=this._next=null}eE.prototype=dle.prototype={constructor:eE,restart:function(e,t,n){if(typeof e!="function")throw new TypeError("callback is not a function");n=(n==null?D6():+n)+(t==null?0:+t),!this._next&&kx!==this&&(kx?kx._next=this:Jk=this,kx=this),this._call=e,this._time=n,bP()},stop:function(){this._call&&(this._call=null,this._time=1/0,bP())}};function dle(e,t,n){var r=new eE;return r.restart(e,t,n),r}function Ett(){D6(),++$y;for(var e=Jk,t;e;)(t=zm-e._time)>=0&&e._call.call(void 0,t),e=e._next;--$y}function XV(){zm=(Qk=f1.now())+uA,$y=Cx=0;try{Ett()}finally{$y=0,Att(),zm=0}}function Ttt(){var e=f1.now(),t=e-Qk;t>cle&&(uA-=t,Qk=e)}function Att(){for(var e,t=Jk,n,r=1/0;t;)t._call?(r>t._time&&(r=t._time),e=t,t=t._next):(n=t._next,t._next=null,t=e?e._next=n:Jk=n);kx=e,bP(r)}function bP(e){if(!$y){Cx&&(Cx=clearTimeout(Cx));var t=e-zm;t>24?(e<1/0&&(Cx=setTimeout(XV,e-f1.now()-uA)),tx&&(tx=clearInterval(tx))):(tx||(Qk=f1.now(),tx=setInterval(Ttt,cle)),$y=1,ule(XV))}}function JV(e,t,n){var r=new eE;return t=t==null?0:+t,r.restart(s=>{r.stop(),e(s+t)},t,n),r}var Rtt=Voe("start","end","cancel","interrupt"),Ntt=[],fle=0,QV=1,vP=2,r2=3,eW=4,xP=5,s2=6;function dA(e,t,n,r,s,i){var a=e.__transition;if(!a)e.__transition={};else if(n in a)return;Mtt(e,n,{name:t,index:r,group:s,on:Rtt,tween:Ntt,time:i.time,delay:i.delay,duration:i.duration,ease:i.ease,timer:null,state:fle})}function F6(e,t){var n=Gc(e,t);if(n.state>fle)throw new Error("too late; already scheduled");return n}function Ku(e,t){var n=Gc(e,t);if(n.state>r2)throw new Error("too late; already running");return n}function Gc(e,t){var n=e.__transition;if(!n||!(n=n[t]))throw new Error("transition not found");return n}function Mtt(e,t,n){var r=e.__transition,s;r[t]=n,n.timer=dle(i,0,n.time);function i(c){n.state=QV,n.timer.restart(a,n.delay,n.time),n.delay<=c&&a(c-n.delay)}function a(c){var u,d,h,m;if(n.state!==QV)return l();for(u in r)if(m=r[u],m.name===n.name){if(m.state===r2)return JV(a);m.state===eW?(m.state=s2,m.timer.stop(),m.on.call("interrupt",e,e.__data__,m.index,m.group),delete r[u]):+u<t&&(m.state=s2,m.timer.stop(),m.on.call("cancel",e,e.__data__,m.index,m.group),delete r[u])}if(JV(function(){n.state===r2&&(n.state=eW,n.timer.restart(o,n.delay,n.time),o(c))}),n.state=vP,n.on.call("start",e,e.__data__,n.index,n.group),n.state===vP){for(n.state=r2,s=new Array(h=n.tween.length),u=0,d=-1;u<h;++u)(m=n.tween[u].value.call(e,e.__data__,n.index,n.group))&&(s[++d]=m);s.length=d+1}}function o(c){for(var u=c<n.duration?n.ease.call(null,c/n.duration):(n.timer.restart(l),n.state=xP,1),d=-1,h=s.length;++d<h;)s[d].call(e,u);n.state===xP&&(n.on.call("end",e,e.__data__,n.index,n.group),l())}function l(){n.state=s2,n.timer.stop(),delete r[t];for(var c in r)return;delete e.__transition}}function Itt(e,t){var n=e.__transition,r,s,i=!0,a;if(n){t=t==null?null:t+"";for(a in n){if((r=n[a]).name!==t){i=!1;continue}s=r.state>vP&&r.state<xP,r.state=s2,r.timer.stop(),r.on.call(s?"interrupt":"cancel",e,e.__data__,r.index,r.group),delete n[a]}i&&delete e.__transition}}function jtt(e){return this.each(function(){Itt(this,e)})}function Ptt(e,t){var n,r;return function(){var s=Ku(this,e),i=s.tween;if(i!==n){r=n=i;for(var a=0,o=r.length;a<o;++a)if(r[a].name===t){r=r.slice(),r.splice(a,1);break}}s.tween=r}}function Ott(e,t,n){var r,s;if(typeof n!="function")throw new Error;return function(){var i=Ku(this,e),a=i.tween;if(a!==r){s=(r=a).slice();for(var o={name:t,value:n},l=0,c=s.length;l<c;++l)if(s[l].name===t){s[l]=o;break}l===c&&s.push(o)}i.tween=s}}function Dtt(e,t){var n=this._id;if(e+="",arguments.length<2){for(var r=Gc(this.node(),n).tween,s=0,i=r.length,a;s<i;++s)if((a=r[s]).name===e)return a.value;return null}return this.each((t==null?Ptt:Ott)(n,e,t))}function L6(e,t,n){var r=e._id;return e.each(function(){var s=Ku(this,r);(s.value||(s.value={}))[t]=n.apply(this,arguments)}),function(s){return Gc(s,r).value[t]}}function hle(e,t){var n;return(typeof t=="number"?bh:t instanceof d1?YV:(n=d1(t))?(t=n,YV):xtt)(e,t)}function Ftt(e){return function(){this.removeAttribute(e)}}function Ltt(e){return function(){this.removeAttributeNS(e.space,e.local)}}function Btt(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttribute(e);return a===s?null:a===r?i:i=t(r=a,n)}}function $tt(e,t,n){var r,s=n+"",i;return function(){var a=this.getAttributeNS(e.space,e.local);return a===s?null:a===r?i:i=t(r=a,n)}}function ztt(e,t,n){var r,s,i;return function(){var a,o=n(this),l;return o==null?void this.removeAttribute(e):(a=this.getAttribute(e),l=o+"",a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o)))}}function Utt(e,t,n){var r,s,i;return function(){var a,o=n(this),l;return o==null?void this.removeAttributeNS(e.space,e.local):(a=this.getAttributeNS(e.space,e.local),l=o+"",a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o)))}}function qtt(e,t){var n=cA(e),r=n==="transform"?Ctt:hle;return this.attrTween(e,typeof t=="function"?(n.local?Utt:ztt)(n,r,L6(this,"attr."+e,t)):t==null?(n.local?Ltt:Ftt)(n):(n.local?$tt:Btt)(n,r,t))}function Vtt(e,t){return function(n){this.setAttribute(e,t.call(this,n))}}function Wtt(e,t){return function(n){this.setAttributeNS(e.space,e.local,t.call(this,n))}}function Htt(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Wtt(e,i)),n}return s._value=t,s}function Gtt(e,t){var n,r;function s(){var i=t.apply(this,arguments);return i!==r&&(n=(r=i)&&Vtt(e,i)),n}return s._value=t,s}function Ktt(e,t){var n="attr."+e;if(arguments.length<2)return(n=this.tween(n))&&n._value;if(t==null)return this.tween(n,null);if(typeof t!="function")throw new Error;var r=cA(e);return this.tween(n,(r.local?Htt:Gtt)(r,t))}function Ytt(e,t){return function(){F6(this,e).delay=+t.apply(this,arguments)}}function Ztt(e,t){return t=+t,function(){F6(this,e).delay=t}}function Xtt(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Ytt:Ztt)(t,e)):Gc(this.node(),t).delay}function Jtt(e,t){return function(){Ku(this,e).duration=+t.apply(this,arguments)}}function Qtt(e,t){return t=+t,function(){Ku(this,e).duration=t}}function ent(e){var t=this._id;return arguments.length?this.each((typeof e=="function"?Jtt:Qtt)(t,e)):Gc(this.node(),t).duration}function tnt(e,t){if(typeof t!="function")throw new Error;return function(){Ku(this,e).ease=t}}function nnt(e){var t=this._id;return arguments.length?this.each(tnt(t,e)):Gc(this.node(),t).ease}function rnt(e,t){return function(){var n=t.apply(this,arguments);if(typeof n!="function")throw new Error;Ku(this,e).ease=n}}function snt(e){if(typeof e!="function")throw new Error;return this.each(rnt(this._id,e))}function int(e){typeof e!="function"&&(e=Goe(e));for(var t=this._groups,n=t.length,r=new Array(n),s=0;s<n;++s)for(var i=t[s],a=i.length,o=r[s]=[],l,c=0;c<a;++c)(l=i[c])&&e.call(l,l.__data__,c,i)&&o.push(l);return new tf(r,this._parents,this._name,this._id)}function ant(e){if(e._id!==this._id)throw new Error;for(var t=this._groups,n=e._groups,r=t.length,s=n.length,i=Math.min(r,s),a=new Array(r),o=0;o<i;++o)for(var l=t[o],c=n[o],u=l.length,d=a[o]=new Array(u),h,m=0;m<u;++m)(h=l[m]||c[m])&&(d[m]=h);for(;o<r;++o)a[o]=t[o];return new tf(a,this._parents,this._name,this._id)}function ont(e){return(e+"").trim().split(/^|\s+/).every(function(t){var n=t.indexOf(".");return n>=0&&(t=t.slice(0,n)),!t||t==="start"})}function lnt(e,t,n){var r,s,i=ont(t)?F6:Ku;return function(){var a=i(this,e),o=a.on;o!==r&&(s=(r=o).copy()).on(t,n),a.on=s}}function cnt(e,t){var n=this._id;return arguments.length<2?Gc(this.node(),n).on.on(e):this.each(lnt(n,e,t))}function unt(e){return function(){var t=this.parentNode;for(var n in this.__transition)if(+n!==e)return;t&&t.removeChild(this)}}function dnt(){return this.on("end.remove",unt(this._id))}function fnt(e){var t=this._name,n=this._id;typeof e!="function"&&(e=I6(e));for(var r=this._groups,s=r.length,i=new Array(s),a=0;a<s;++a)for(var o=r[a],l=o.length,c=i[a]=new Array(l),u,d,h=0;h<l;++h)(u=o[h])&&(d=e.call(u,u.__data__,h,o))&&("__data__"in u&&(d.__data__=u.__data__),c[h]=d,dA(c[h],t,n,h,c,Gc(u,n)));return new tf(i,this._parents,t,n)}function hnt(e){var t=this._name,n=this._id;typeof e!="function"&&(e=Hoe(e));for(var r=this._groups,s=r.length,i=[],a=[],o=0;o<s;++o)for(var l=r[o],c=l.length,u,d=0;d<c;++d)if(u=l[d]){for(var h=e.call(u,u.__data__,d,l),m,y=Gc(u,n),b=0,v=h.length;b<v;++b)(m=h[b])&&dA(m,t,n,b,h,y);i.push(h),a.push(u)}return new tf(i,a,t,n)}var pnt=y_.prototype.constructor;function mnt(){return new pnt(this._groups,this._parents)}function gnt(e,t){var n,r,s;return function(){var i=By(this,e),a=(this.style.removeProperty(e),By(this,e));return i===a?null:i===n&&a===r?s:s=t(n=i,r=a)}}function ple(e){return function(){this.style.removeProperty(e)}}function ynt(e,t,n){var r,s=n+"",i;return function(){var a=By(this,e);return a===s?null:a===r?i:i=t(r=a,n)}}function bnt(e,t,n){var r,s,i;return function(){var a=By(this,e),o=n(this),l=o+"";return o==null&&(l=o=(this.style.removeProperty(e),By(this,e))),a===l?null:a===r&&l===s?i:(s=l,i=t(r=a,o))}}function vnt(e,t){var n,r,s,i="style."+t,a="end."+i,o;return function(){var l=Ku(this,e),c=l.on,u=l.value[i]==null?o||(o=ple(t)):void 0;(c!==n||s!==u)&&(r=(n=c).copy()).on(a,s=u),l.on=r}}function xnt(e,t,n){var r=(e+="")=="transform"?Stt:hle;return t==null?this.styleTween(e,gnt(e,r)).on("end.style."+e,ple(e)):typeof t=="function"?this.styleTween(e,bnt(e,r,L6(this,"style."+e,t))).each(vnt(this._id,e)):this.styleTween(e,ynt(e,r,t),n).on("end.style."+e,null)}function wnt(e,t,n){return function(r){this.style.setProperty(e,t.call(this,r),n)}}function _nt(e,t,n){var r,s;function i(){var a=t.apply(this,arguments);return a!==s&&(r=(s=a)&&wnt(e,a,n)),r}return i._value=t,i}function Snt(e,t,n){var r="style."+(e+="");if(arguments.length<2)return(r=this.tween(r))&&r._value;if(t==null)return this.tween(r,null);if(typeof t!="function")throw new Error;return this.tween(r,_nt(e,t,n??""))}function Cnt(e){return function(){this.textContent=e}}function knt(e){return function(){var t=e(this);this.textContent=t??""}}function Ent(e){return this.tween("text",typeof e=="function"?knt(L6(this,"text",e)):Cnt(e==null?"":e+""))}function Tnt(e){return function(t){this.textContent=e.call(this,t)}}function Ant(e){var t,n;function r(){var s=e.apply(this,arguments);return s!==n&&(t=(n=s)&&Tnt(s)),t}return r._value=e,r}function Rnt(e){var t="text";if(arguments.length<1)return(t=this.tween(t))&&t._value;if(e==null)return this.tween(t,null);if(typeof e!="function")throw new Error;return this.tween(t,Ant(e))}function Nnt(){for(var e=this._name,t=this._id,n=mle(),r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],o=a.length,l,c=0;c<o;++c)if(l=a[c]){var u=Gc(l,t);dA(l,e,n,c,a,{time:u.time+u.delay+u.duration,delay:0,duration:u.duration,ease:u.ease})}return new tf(r,this._parents,e,n)}function Mnt(){var e,t,n=this,r=n._id,s=n.size();return new Promise(function(i,a){var o={value:a},l={value:function(){--s===0&&i()}};n.each(function(){var c=Ku(this,r),u=c.on;u!==e&&(t=(e=u).copy(),t._.cancel.push(o),t._.interrupt.push(o),t._.end.push(l)),c.on=t}),s===0&&i()})}var Int=0;function tf(e,t,n,r){this._groups=e,this._parents=t,this._name=n,this._id=r}function mle(){return++Int}var Sd=y_.prototype;tf.prototype={constructor:tf,select:fnt,selectAll:hnt,selectChild:Sd.selectChild,selectChildren:Sd.selectChildren,filter:int,merge:ant,selection:mnt,transition:Nnt,call:Sd.call,nodes:Sd.nodes,node:Sd.node,size:Sd.size,empty:Sd.empty,each:Sd.each,on:cnt,attr:qtt,attrTween:Ktt,style:xnt,styleTween:Snt,text:Ent,textTween:Rnt,remove:dnt,tween:Dtt,delay:Xtt,duration:ent,ease:nnt,easeVarying:snt,end:Mnt,[Symbol.iterator]:Sd[Symbol.iterator]};function jnt(e){return((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2}var Pnt={time:null,delay:0,duration:250,ease:jnt};function Ont(e,t){for(var n;!(n=e.__transition)||!(n=n[t]);)if(!(e=e.parentNode))throw new Error(`transition ${t} not found`);return n}function Dnt(e){var t,n;e instanceof tf?(t=e._id,e=e._name):(t=mle(),(n=Pnt).time=D6(),e=e==null?null:e+"");for(var r=this._groups,s=r.length,i=0;i<s;++i)for(var a=r[i],o=a.length,l,c=0;c<o;++c)(l=a[c])&&dA(l,e,t,c,a,n||Ont(l,t));return new tf(r,this._parents,e,t)}y_.prototype.interrupt=jtt;y_.prototype.transition=Dnt;const wP=Math.PI,_P=2*wP,Jp=1e-6,Fnt=_P-Jp;function gle(e){this._+=e[0];for(let t=1,n=e.length;t<n;++t)this._+=arguments[t]+e[t]}function Lnt(e){let t=Math.floor(e);if(!(t>=0))throw new Error(`invalid digits: ${e}`);if(t>15)return gle;const n=10**t;return function(r){this._+=r[0];for(let s=1,i=r.length;s<i;++s)this._+=Math.round(arguments[s]*n)/n+r[s]}}class Bnt{constructor(t){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=t==null?gle:Lnt(t)}moveTo(t,n){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(t,n){this._append`L${this._x1=+t},${this._y1=+n}`}quadraticCurveTo(t,n,r,s){this._append`Q${+t},${+n},${this._x1=+r},${this._y1=+s}`}bezierCurveTo(t,n,r,s,i,a){this._append`C${+t},${+n},${+r},${+s},${this._x1=+i},${this._y1=+a}`}arcTo(t,n,r,s,i){if(t=+t,n=+n,r=+r,s=+s,i=+i,i<0)throw new Error(`negative radius: ${i}`);let a=this._x1,o=this._y1,l=r-t,c=s-n,u=a-t,d=o-n,h=u*u+d*d;if(this._x1===null)this._append`M${this._x1=t},${this._y1=n}`;else if(h>Jp)if(!(Math.abs(d*l-c*u)>Jp)||!i)this._append`L${this._x1=t},${this._y1=n}`;else{let m=r-a,y=s-o,b=l*l+c*c,v=m*m+y*y,x=Math.sqrt(b),w=Math.sqrt(h),S=i*Math.tan((wP-Math.acos((b+h-v)/(2*x*w)))/2),k=S/w,C=S/x;Math.abs(k-1)>Jp&&this._append`L${t+k*u},${n+k*d}`,this._append`A${i},${i},0,0,${+(d*m>u*y)},${this._x1=t+C*l},${this._y1=n+C*c}`}}arc(t,n,r,s,i,a){if(t=+t,n=+n,r=+r,a=!!a,r<0)throw new Error(`negative radius: ${r}`);let o=r*Math.cos(s),l=r*Math.sin(s),c=t+o,u=n+l,d=1^a,h=a?s-i:i-s;this._x1===null?this._append`M${c},${u}`:(Math.abs(this._x1-c)>Jp||Math.abs(this._y1-u)>Jp)&&this._append`L${c},${u}`,r&&(h<0&&(h=h%_P+_P),h>Fnt?this._append`A${r},${r},0,1,${d},${t-o},${n-l}A${r},${r},0,1,${d},${this._x1=c},${this._y1=u}`:h>Jp&&this._append`A${r},${r},0,${+(h>=wP)},${d},${this._x1=t+r*Math.cos(i)},${this._y1=n+r*Math.sin(i)}`)}rect(t,n,r,s){this._append`M${this._x0=this._x1=+t},${this._y0=this._y1=+n}h${r=+r}v${+s}h${-r}Z`}toString(){return this._}}function h0(e){return function(){return e}}const Qdt=Math.abs,eft=Math.atan2,tft=Math.cos,nft=Math.max,rft=Math.min,sft=Math.sin,ift=Math.sqrt,tW=1e-12,B6=Math.PI,nW=B6/2,aft=2*B6;function oft(e){return e>1?0:e<-1?B6:Math.acos(e)}function lft(e){return e>=1?nW:e<=-1?-nW:Math.asin(e)}function $nt(e){let t=3;return e.digits=function(n){if(!arguments.length)return t;if(n==null)t=null;else{const r=Math.floor(n);if(!(r>=0))throw new RangeError(`invalid digits: ${n}`);t=r}return e},()=>new Bnt(t)}function znt(e){return typeof e=="object"&&"length"in e?e:Array.from(e)}function yle(e){this._context=e}yle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:this._context.lineTo(e,t);break}}};function tE(e){return new yle(e)}function Unt(e){return e[0]}function qnt(e){return e[1]}function Vnt(e,t){var n=h0(!0),r=null,s=tE,i=null,a=$nt(o);e=typeof e=="function"?e:e===void 0?Unt:h0(e),t=typeof t=="function"?t:t===void 0?qnt:h0(t);function o(l){var c,u=(l=znt(l)).length,d,h=!1,m;for(r==null&&(i=s(m=a())),c=0;c<=u;++c)!(c<u&&n(d=l[c],c,l))===h&&((h=!h)?i.lineStart():i.lineEnd()),h&&i.point(+e(d,c,l),+t(d,c,l));if(m)return i=null,m+""||null}return o.x=function(l){return arguments.length?(e=typeof l=="function"?l:h0(+l),o):e},o.y=function(l){return arguments.length?(t=typeof l=="function"?l:h0(+l),o):t},o.defined=function(l){return arguments.length?(n=typeof l=="function"?l:h0(!!l),o):n},o.curve=function(l){return arguments.length?(s=l,r!=null&&(i=s(r)),o):s},o.context=function(l){return arguments.length?(l==null?r=i=null:i=s(r=l),o):r},o}class ble{constructor(t,n){this._context=t,this._x=n}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._point=0}lineEnd(){(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(t,n){switch(t=+t,n=+n,this._point){case 0:{this._point=1,this._line?this._context.lineTo(t,n):this._context.moveTo(t,n);break}case 1:this._point=2;default:{this._x?this._context.bezierCurveTo(this._x0=(this._x0+t)/2,this._y0,this._x0,n,t,n):this._context.bezierCurveTo(this._x0,this._y0=(this._y0+n)/2,t,this._y0,t,n);break}}this._x0=t,this._y0=n}}function vle(e){return new ble(e,!0)}function xle(e){return new ble(e,!1)}function Kh(){}function nE(e,t,n){e._context.bezierCurveTo((2*e._x0+e._x1)/3,(2*e._y0+e._y1)/3,(e._x0+2*e._x1)/3,(e._y0+2*e._y1)/3,(e._x0+4*e._x1+t)/6,(e._y0+4*e._y1+n)/6)}function fA(e){this._context=e}fA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){switch(this._point){case 3:nE(this,this._x1,this._y1);case 2:this._context.lineTo(this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,this._context.lineTo((5*this._x0+this._x1)/6,(5*this._y0+this._y1)/6);default:nE(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function i2(e){return new fA(e)}function wle(e){this._context=e}wle.prototype={areaStart:Kh,areaEnd:Kh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._y0=this._y1=this._y2=this._y3=this._y4=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x2,this._y2),this._context.closePath();break}case 2:{this._context.moveTo((this._x2+2*this._x3)/3,(this._y2+2*this._y3)/3),this._context.lineTo((this._x3+2*this._x2)/3,(this._y3+2*this._y2)/3),this._context.closePath();break}case 3:{this.point(this._x2,this._y2),this.point(this._x3,this._y3),this.point(this._x4,this._y4);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x2=e,this._y2=t;break;case 1:this._point=2,this._x3=e,this._y3=t;break;case 2:this._point=3,this._x4=e,this._y4=t,this._context.moveTo((this._x0+4*this._x1+e)/6,(this._y0+4*this._y1+t)/6);break;default:nE(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Wnt(e){return new wle(e)}function _le(e){this._context=e}_le.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3;var n=(this._x0+4*this._x1+e)/6,r=(this._y0+4*this._y1+t)/6;this._line?this._context.lineTo(n,r):this._context.moveTo(n,r);break;case 3:this._point=4;default:nE(this,e,t);break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t}};function Hnt(e){return new _le(e)}function Sle(e,t){this._basis=new fA(e),this._beta=t}Sle.prototype={lineStart:function(){this._x=[],this._y=[],this._basis.lineStart()},lineEnd:function(){var e=this._x,t=this._y,n=e.length-1;if(n>0)for(var r=e[0],s=t[0],i=e[n]-r,a=t[n]-s,o=-1,l;++o<=n;)l=o/n,this._basis.point(this._beta*e[o]+(1-this._beta)*(r+l*i),this._beta*t[o]+(1-this._beta)*(s+l*a));this._x=this._y=null,this._basis.lineEnd()},point:function(e,t){this._x.push(+e),this._y.push(+t)}};const Gnt=function e(t){function n(r){return t===1?new fA(r):new Sle(r,t)}return n.beta=function(r){return e(+r)},n}(.85);function rE(e,t,n){e._context.bezierCurveTo(e._x1+e._k*(e._x2-e._x0),e._y1+e._k*(e._y2-e._y0),e._x2+e._k*(e._x1-t),e._y2+e._k*(e._y1-n),e._x2,e._y2)}function $6(e,t){this._context=e,this._k=(1-t)/6}$6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:rE(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2,this._x1=e,this._y1=t;break;case 2:this._point=3;default:rE(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Cle=function e(t){function n(r){return new $6(r,t)}return n.tension=function(r){return e(+r)},n}(0);function z6(e,t){this._context=e,this._k=(1-t)/6}z6.prototype={areaStart:Kh,areaEnd:Kh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:rE(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Knt=function e(t){function n(r){return new z6(r,t)}return n.tension=function(r){return e(+r)},n}(0);function U6(e,t){this._context=e,this._k=(1-t)/6}U6.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:rE(this,e,t);break}this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Ynt=function e(t){function n(r){return new U6(r,t)}return n.tension=function(r){return e(+r)},n}(0);function q6(e,t,n){var r=e._x1,s=e._y1,i=e._x2,a=e._y2;if(e._l01_a>tW){var o=2*e._l01_2a+3*e._l01_a*e._l12_a+e._l12_2a,l=3*e._l01_a*(e._l01_a+e._l12_a);r=(r*o-e._x0*e._l12_2a+e._x2*e._l01_2a)/l,s=(s*o-e._y0*e._l12_2a+e._y2*e._l01_2a)/l}if(e._l23_a>tW){var c=2*e._l23_2a+3*e._l23_a*e._l12_a+e._l12_2a,u=3*e._l23_a*(e._l23_a+e._l12_a);i=(i*c+e._x1*e._l23_2a-t*e._l12_2a)/u,a=(a*c+e._y1*e._l23_2a-n*e._l12_2a)/u}e._context.bezierCurveTo(r,s,i,a,e._x2,e._y2)}function kle(e,t){this._context=e,this._alpha=t}kle.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:this.point(this._x2,this._y2);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3;default:q6(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Ele=function e(t){function n(r){return t?new kle(r,t):new $6(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Tle(e,t){this._context=e,this._alpha=t}Tle.prototype={areaStart:Kh,areaEnd:Kh,lineStart:function(){this._x0=this._x1=this._x2=this._x3=this._x4=this._x5=this._y0=this._y1=this._y2=this._y3=this._y4=this._y5=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){switch(this._point){case 1:{this._context.moveTo(this._x3,this._y3),this._context.closePath();break}case 2:{this._context.lineTo(this._x3,this._y3),this._context.closePath();break}case 3:{this.point(this._x3,this._y3),this.point(this._x4,this._y4),this.point(this._x5,this._y5);break}}},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1,this._x3=e,this._y3=t;break;case 1:this._point=2,this._context.moveTo(this._x4=e,this._y4=t);break;case 2:this._point=3,this._x5=e,this._y5=t;break;default:q6(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Znt=function e(t){function n(r){return t?new Tle(r,t):new z6(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Ale(e,t){this._context=e,this._alpha=t}Ale.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._l01_a=this._l12_a=this._l23_a=this._l01_2a=this._l12_2a=this._l23_2a=this._point=0},lineEnd:function(){(this._line||this._line!==0&&this._point===3)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){if(e=+e,t=+t,this._point){var n=this._x2-e,r=this._y2-t;this._l23_a=Math.sqrt(this._l23_2a=Math.pow(n*n+r*r,this._alpha))}switch(this._point){case 0:this._point=1;break;case 1:this._point=2;break;case 2:this._point=3,this._line?this._context.lineTo(this._x2,this._y2):this._context.moveTo(this._x2,this._y2);break;case 3:this._point=4;default:q6(this,e,t);break}this._l01_a=this._l12_a,this._l12_a=this._l23_a,this._l01_2a=this._l12_2a,this._l12_2a=this._l23_2a,this._x0=this._x1,this._x1=this._x2,this._x2=e,this._y0=this._y1,this._y1=this._y2,this._y2=t}};const Xnt=function e(t){function n(r){return t?new Ale(r,t):new U6(r,0)}return n.alpha=function(r){return e(+r)},n}(.5);function Rle(e){this._context=e}Rle.prototype={areaStart:Kh,areaEnd:Kh,lineStart:function(){this._point=0},lineEnd:function(){this._point&&this._context.closePath()},point:function(e,t){e=+e,t=+t,this._point?this._context.lineTo(e,t):(this._point=1,this._context.moveTo(e,t))}};function Jnt(e){return new Rle(e)}function rW(e){return e<0?-1:1}function sW(e,t,n){var r=e._x1-e._x0,s=t-e._x1,i=(e._y1-e._y0)/(r||s<0&&-0),a=(n-e._y1)/(s||r<0&&-0),o=(i*s+a*r)/(r+s);return(rW(i)+rW(a))*Math.min(Math.abs(i),Math.abs(a),.5*Math.abs(o))||0}function iW(e,t){var n=e._x1-e._x0;return n?(3*(e._y1-e._y0)/n-t)/2:t}function L3(e,t,n){var r=e._x0,s=e._y0,i=e._x1,a=e._y1,o=(i-r)/3;e._context.bezierCurveTo(r+o,s+o*t,i-o,a-o*n,i,a)}function sE(e){this._context=e}sE.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:L3(this,this._t0,iW(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(e,t){var n=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,L3(this,iW(this,n=sW(this,e,t)),n);break;default:L3(this,this._t0,n=sW(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=n}}};function Nle(e){this._context=new Mle(e)}(Nle.prototype=Object.create(sE.prototype)).point=function(e,t){sE.prototype.point.call(this,t,e)};function Mle(e){this._context=e}Mle.prototype={moveTo:function(e,t){this._context.moveTo(t,e)},closePath:function(){this._context.closePath()},lineTo:function(e,t){this._context.lineTo(t,e)},bezierCurveTo:function(e,t,n,r,s,i){this._context.bezierCurveTo(t,e,r,n,i,s)}};function Ile(e){return new sE(e)}function jle(e){return new Nle(e)}function Ple(e){this._context=e}Ple.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=[],this._y=[]},lineEnd:function(){var e=this._x,t=this._y,n=e.length;if(n)if(this._line?this._context.lineTo(e[0],t[0]):this._context.moveTo(e[0],t[0]),n===2)this._context.lineTo(e[1],t[1]);else for(var r=aW(e),s=aW(t),i=0,a=1;a<n;++i,++a)this._context.bezierCurveTo(r[0][i],s[0][i],r[1][i],s[1][i],e[a],t[a]);(this._line||this._line!==0&&n===1)&&this._context.closePath(),this._line=1-this._line,this._x=this._y=null},point:function(e,t){this._x.push(+e),this._y.push(+t)}};function aW(e){var t,n=e.length-1,r,s=new Array(n),i=new Array(n),a=new Array(n);for(s[0]=0,i[0]=2,a[0]=e[0]+2*e[1],t=1;t<n-1;++t)s[t]=1,i[t]=4,a[t]=4*e[t]+2*e[t+1];for(s[n-1]=2,i[n-1]=7,a[n-1]=8*e[n-1]+e[n],t=1;t<n;++t)r=s[t]/i[t-1],i[t]-=r,a[t]-=r*a[t-1];for(s[n-1]=a[n-1]/i[n-1],t=n-2;t>=0;--t)s[t]=(a[t]-s[t+1])/i[t];for(i[n-1]=(e[n]+s[n-1])/2,t=0;t<n-1;++t)i[t]=2*e[t+1]-s[t+1];return[s,i]}function Ole(e){return new Ple(e)}function hA(e,t){this._context=e,this._t=t}hA.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(e,t){switch(e=+e,t=+t,this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,t),this._context.lineTo(e,t);else{var n=this._x*(1-this._t)+e*this._t;this._context.lineTo(n,this._y),this._context.lineTo(n,t)}break}}this._x=e,this._y=t}};function Dle(e){return new hA(e,.5)}function Fle(e){return new hA(e,0)}function Lle(e){return new hA(e,1)}function Ex(e,t,n){this.k=e,this.x=t,this.y=n}Ex.prototype={constructor:Ex,scale:function(e){return e===1?this:new Ex(this.k*e,this.x,this.y)},translate:function(e,t){return e===0&t===0?this:new Ex(this.k,this.x+this.k*e,this.y+this.k*t)},apply:function(e){return[e[0]*this.k+this.x,e[1]*this.k+this.y]},applyX:function(e){return e*this.k+this.x},applyY:function(e){return e*this.k+this.y},invert:function(e){return[(e[0]-this.x)/this.k,(e[1]-this.y)/this.k]},invertX:function(e){return(e-this.x)/this.k},invertY:function(e){return(e-this.y)/this.k},rescaleX:function(e){return e.copy().domain(e.range().map(this.invertX,this).map(e.invert,e))},rescaleY:function(e){return e.copy().domain(e.range().map(this.invertY,this).map(e.invert,e))},toString:function(){return"translate("+this.x+","+this.y+") scale("+this.k+")"}};Ex.prototype;var Ble=typeof C0=="object"&&C0&&C0.Object===Object&&C0,Qnt=typeof self=="object"&&self&&self.Object===Object&&self,Yu=Ble||Qnt||Function("return this")(),iE=Yu.Symbol,$le=Object.prototype,ert=$le.hasOwnProperty,trt=$le.toString,nx=iE?iE.toStringTag:void 0;function nrt(e){var t=ert.call(e,nx),n=e[nx];try{e[nx]=void 0;var r=!0}catch{}var s=trt.call(e);return r&&(t?e[nx]=n:delete e[nx]),s}var rrt=Object.prototype,srt=rrt.toString;function irt(e){return srt.call(e)}var art="[object Null]",ort="[object Undefined]",oW=iE?iE.toStringTag:void 0;function Tb(e){return e==null?e===void 0?ort:art:oW&&oW in Object(e)?nrt(e):irt(e)}function og(e){var t=typeof e;return e!=null&&(t=="object"||t=="function")}var lrt="[object AsyncFunction]",crt="[object Function]",urt="[object GeneratorFunction]",drt="[object Proxy]";function V6(e){if(!og(e))return!1;var t=Tb(e);return t==crt||t==urt||t==lrt||t==drt}var B3=Yu["__core-js_shared__"],lW=function(){var e=/[^.]+$/.exec(B3&&B3.keys&&B3.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function frt(e){return!!lW&&lW in e}var hrt=Function.prototype,prt=hrt.toString;function lg(e){if(e!=null){try{return prt.call(e)}catch{}try{return e+""}catch{}}return""}var mrt=/[\\^$.*+?()[\]{}|]/g,grt=/^\[object .+?Constructor\]$/,yrt=Function.prototype,brt=Object.prototype,vrt=yrt.toString,xrt=brt.hasOwnProperty,wrt=RegExp("^"+vrt.call(xrt).replace(mrt,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function _rt(e){if(!og(e)||frt(e))return!1;var t=V6(e)?wrt:grt;return t.test(lg(e))}function Srt(e,t){return e==null?void 0:e[t]}function cg(e,t){var n=Srt(e,t);return _rt(n)?n:void 0}var h1=cg(Object,"create");function Crt(){this.__data__=h1?h1(null):{},this.size=0}function krt(e){var t=this.has(e)&&delete this.__data__[e];return this.size-=t?1:0,t}var Ert="__lodash_hash_undefined__",Trt=Object.prototype,Art=Trt.hasOwnProperty;function Rrt(e){var t=this.__data__;if(h1){var n=t[e];return n===Ert?void 0:n}return Art.call(t,e)?t[e]:void 0}var Nrt=Object.prototype,Mrt=Nrt.hasOwnProperty;function Irt(e){var t=this.__data__;return h1?t[e]!==void 0:Mrt.call(t,e)}var jrt="__lodash_hash_undefined__";function Prt(e,t){var n=this.__data__;return this.size+=this.has(e)?0:1,n[e]=h1&&t===void 0?jrt:t,this}function Um(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}Um.prototype.clear=Crt;Um.prototype.delete=krt;Um.prototype.get=Rrt;Um.prototype.has=Irt;Um.prototype.set=Prt;function Ort(){this.__data__=[],this.size=0}function pA(e,t){return e===t||e!==e&&t!==t}function mA(e,t){for(var n=e.length;n--;)if(pA(e[n][0],t))return n;return-1}var Drt=Array.prototype,Frt=Drt.splice;function Lrt(e){var t=this.__data__,n=mA(t,e);if(n<0)return!1;var r=t.length-1;return n==r?t.pop():Frt.call(t,n,1),--this.size,!0}function Brt(e){var t=this.__data__,n=mA(t,e);return n<0?void 0:t[n][1]}function $rt(e){return mA(this.__data__,e)>-1}function zrt(e,t){var n=this.__data__,r=mA(n,e);return r<0?(++this.size,n.push([e,t])):n[r][1]=t,this}function xf(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}xf.prototype.clear=Ort;xf.prototype.delete=Lrt;xf.prototype.get=Brt;xf.prototype.has=$rt;xf.prototype.set=zrt;var p1=cg(Yu,"Map");function Urt(){this.size=0,this.__data__={hash:new Um,map:new(p1||xf),string:new Um}}function qrt(e){var t=typeof e;return t=="string"||t=="number"||t=="symbol"||t=="boolean"?e!=="__proto__":e===null}function gA(e,t){var n=e.__data__;return qrt(t)?n[typeof t=="string"?"string":"hash"]:n.map}function Vrt(e){var t=gA(this,e).delete(e);return this.size-=t?1:0,t}function Wrt(e){return gA(this,e).get(e)}function Hrt(e){return gA(this,e).has(e)}function Grt(e,t){var n=gA(this,e),r=n.size;return n.set(e,t),this.size+=n.size==r?0:1,this}function yp(e){var t=-1,n=e==null?0:e.length;for(this.clear();++t<n;){var r=e[t];this.set(r[0],r[1])}}yp.prototype.clear=Urt;yp.prototype.delete=Vrt;yp.prototype.get=Wrt;yp.prototype.has=Hrt;yp.prototype.set=Grt;var Krt="Expected a function";function v_(e,t){if(typeof e!="function"||t!=null&&typeof t!="function")throw new TypeError(Krt);var n=function(){var r=arguments,s=t?t.apply(this,r):r[0],i=n.cache;if(i.has(s))return i.get(s);var a=e.apply(this,r);return n.cache=i.set(s,a)||i,a};return n.cache=new(v_.Cache||yp),n}v_.Cache=yp;function Yrt(){this.__data__=new xf,this.size=0}function Zrt(e){var t=this.__data__,n=t.delete(e);return this.size=t.size,n}function Xrt(e){return this.__data__.get(e)}function Jrt(e){return this.__data__.has(e)}var Qrt=200;function est(e,t){var n=this.__data__;if(n instanceof xf){var r=n.__data__;if(!p1||r.length<Qrt-1)return r.push([e,t]),this.size=++n.size,this;n=this.__data__=new yp(r)}return n.set(e,t),this.size=n.size,this}function Ab(e){var t=this.__data__=new xf(e);this.size=t.size}Ab.prototype.clear=Yrt;Ab.prototype.delete=Zrt;Ab.prototype.get=Xrt;Ab.prototype.has=Jrt;Ab.prototype.set=est;var aE=function(){try{var e=cg(Object,"defineProperty");return e({},"",{}),e}catch{}}();function W6(e,t,n){t=="__proto__"&&aE?aE(e,t,{configurable:!0,enumerable:!0,value:n,writable:!0}):e[t]=n}function SP(e,t,n){(n!==void 0&&!pA(e[t],n)||n===void 0&&!(t in e))&&W6(e,t,n)}function tst(e){return function(t,n,r){for(var s=-1,i=Object(t),a=r(t),o=a.length;o--;){var l=a[++s];if(n(i[l],l,i)===!1)break}return t}}var nst=tst(),zle=typeof exports=="object"&&exports&&!exports.nodeType&&exports,cW=zle&&typeof module=="object"&&module&&!module.nodeType&&module,rst=cW&&cW.exports===zle,uW=rst?Yu.Buffer:void 0,dW=uW?uW.allocUnsafe:void 0;function sst(e,t){if(t)return e.slice();var n=e.length,r=dW?dW(n):new e.constructor(n);return e.copy(r),r}var fW=Yu.Uint8Array;function ist(e){var t=new e.constructor(e.byteLength);return new fW(t).set(new fW(e)),t}function ast(e,t){var n=t?ist(e.buffer):e.buffer;return new e.constructor(n,e.byteOffset,e.length)}function ost(e,t){var n=-1,r=e.length;for(t||(t=Array(r));++n<r;)t[n]=e[n];return t}var hW=Object.create,lst=function(){function e(){}return function(t){if(!og(t))return{};if(hW)return hW(t);e.prototype=t;var n=new e;return e.prototype=void 0,n}}();function Ule(e,t){return function(n){return e(t(n))}}var qle=Ule(Object.getPrototypeOf,Object),cst=Object.prototype;function yA(e){var t=e&&e.constructor,n=typeof t=="function"&&t.prototype||cst;return e===n}function ust(e){return typeof e.constructor=="function"&&!yA(e)?lst(qle(e)):{}}function x_(e){return e!=null&&typeof e=="object"}var dst="[object Arguments]";function pW(e){return x_(e)&&Tb(e)==dst}var Vle=Object.prototype,fst=Vle.hasOwnProperty,hst=Vle.propertyIsEnumerable,oE=pW(function(){return arguments}())?pW:function(e){return x_(e)&&fst.call(e,"callee")&&!hst.call(e,"callee")},lE=Array.isArray,pst=9007199254740991;function Wle(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=pst}function bA(e){return e!=null&&Wle(e.length)&&!V6(e)}function mst(e){return x_(e)&&bA(e)}function gst(){return!1}var Hle=typeof exports=="object"&&exports&&!exports.nodeType&&exports,mW=Hle&&typeof module=="object"&&module&&!module.nodeType&&module,yst=mW&&mW.exports===Hle,gW=yst?Yu.Buffer:void 0,bst=gW?gW.isBuffer:void 0,H6=bst||gst,vst="[object Object]",xst=Function.prototype,wst=Object.prototype,Gle=xst.toString,_st=wst.hasOwnProperty,Sst=Gle.call(Object);function Cst(e){if(!x_(e)||Tb(e)!=vst)return!1;var t=qle(e);if(t===null)return!0;var n=_st.call(t,"constructor")&&t.constructor;return typeof n=="function"&&n instanceof n&&Gle.call(n)==Sst}var kst="[object Arguments]",Est="[object Array]",Tst="[object Boolean]",Ast="[object Date]",Rst="[object Error]",Nst="[object Function]",Mst="[object Map]",Ist="[object Number]",jst="[object Object]",Pst="[object RegExp]",Ost="[object Set]",Dst="[object String]",Fst="[object WeakMap]",Lst="[object ArrayBuffer]",Bst="[object DataView]",$st="[object Float32Array]",zst="[object Float64Array]",Ust="[object Int8Array]",qst="[object Int16Array]",Vst="[object Int32Array]",Wst="[object Uint8Array]",Hst="[object Uint8ClampedArray]",Gst="[object Uint16Array]",Kst="[object Uint32Array]",$s={};$s[$st]=$s[zst]=$s[Ust]=$s[qst]=$s[Vst]=$s[Wst]=$s[Hst]=$s[Gst]=$s[Kst]=!0;$s[kst]=$s[Est]=$s[Lst]=$s[Tst]=$s[Bst]=$s[Ast]=$s[Rst]=$s[Nst]=$s[Mst]=$s[Ist]=$s[jst]=$s[Pst]=$s[Ost]=$s[Dst]=$s[Fst]=!1;function Yst(e){return x_(e)&&Wle(e.length)&&!!$s[Tb(e)]}function Zst(e){return function(t){return e(t)}}var Kle=typeof exports=="object"&&exports&&!exports.nodeType&&exports,Kx=Kle&&typeof module=="object"&&module&&!module.nodeType&&module,Xst=Kx&&Kx.exports===Kle,$3=Xst&&Ble.process,yW=function(){try{var e=Kx&&Kx.require&&Kx.require("util").types;return e||$3&&$3.binding&&$3.binding("util")}catch{}}(),bW=yW&&yW.isTypedArray,G6=bW?Zst(bW):Yst;function CP(e,t){if(!(t==="constructor"&&typeof e[t]=="function")&&t!="__proto__")return e[t]}var Jst=Object.prototype,Qst=Jst.hasOwnProperty;function eit(e,t,n){var r=e[t];(!(Qst.call(e,t)&&pA(r,n))||n===void 0&&!(t in e))&&W6(e,t,n)}function tit(e,t,n,r){var s=!n;n||(n={});for(var i=-1,a=t.length;++i<a;){var o=t[i],l=void 0;l===void 0&&(l=e[o]),s?W6(n,o,l):eit(n,o,l)}return n}function nit(e,t){for(var n=-1,r=Array(e);++n<e;)r[n]=t(n);return r}var rit=9007199254740991,sit=/^(?:0|[1-9]\d*)$/;function Yle(e,t){var n=typeof e;return t=t??rit,!!t&&(n=="number"||n!="symbol"&&sit.test(e))&&e>-1&&e%1==0&&e<t}var iit=Object.prototype,ait=iit.hasOwnProperty;function oit(e,t){var n=lE(e),r=!n&&oE(e),s=!n&&!r&&H6(e),i=!n&&!r&&!s&&G6(e),a=n||r||s||i,o=a?nit(e.length,String):[],l=o.length;for(var c in e)(t||ait.call(e,c))&&!(a&&(c=="length"||s&&(c=="offset"||c=="parent")||i&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||Yle(c,l)))&&o.push(c);return o}function lit(e){var t=[];if(e!=null)for(var n in Object(e))t.push(n);return t}var cit=Object.prototype,uit=cit.hasOwnProperty;function dit(e){if(!og(e))return lit(e);var t=yA(e),n=[];for(var r in e)r=="constructor"&&(t||!uit.call(e,r))||n.push(r);return n}function Zle(e){return bA(e)?oit(e,!0):dit(e)}function fit(e){return tit(e,Zle(e))}function hit(e,t,n,r,s,i,a){var o=CP(e,n),l=CP(t,n),c=a.get(l);if(c){SP(e,n,c);return}var u=i?i(o,l,n+"",e,t,a):void 0,d=u===void 0;if(d){var h=lE(l),m=!h&&H6(l),y=!h&&!m&&G6(l);u=l,h||m||y?lE(o)?u=o:mst(o)?u=ost(o):m?(d=!1,u=sst(l,!0)):y?(d=!1,u=ast(l,!0)):u=[]:Cst(l)||oE(l)?(u=o,oE(o)?u=fit(o):(!og(o)||V6(o))&&(u=ust(l))):d=!1}d&&(a.set(l,u),s(u,l,r,i,a),a.delete(l)),SP(e,n,u)}function Xle(e,t,n,r,s){e!==t&&nst(t,function(i,a){if(s||(s=new Ab),og(i))hit(e,t,a,n,Xle,r,s);else{var o=r?r(CP(e,a),i,a+"",e,t,s):void 0;o===void 0&&(o=i),SP(e,a,o)}},Zle)}function Jle(e){return e}function pit(e,t,n){switch(n.length){case 0:return e.call(t);case 1:return e.call(t,n[0]);case 2:return e.call(t,n[0],n[1]);case 3:return e.call(t,n[0],n[1],n[2])}return e.apply(t,n)}var vW=Math.max;function mit(e,t,n){return t=vW(t===void 0?e.length-1:t,0),function(){for(var r=arguments,s=-1,i=vW(r.length-t,0),a=Array(i);++s<i;)a[s]=r[t+s];s=-1;for(var o=Array(t+1);++s<t;)o[s]=r[s];return o[t]=n(a),pit(e,this,o)}}function git(e){return function(){return e}}var yit=aE?function(e,t){return aE(e,"toString",{configurable:!0,enumerable:!1,value:git(t),writable:!0})}:Jle,bit=800,vit=16,xit=Date.now;function wit(e){var t=0,n=0;return function(){var r=xit(),s=vit-(r-n);if(n=r,s>0){if(++t>=bit)return arguments[0]}else t=0;return e.apply(void 0,arguments)}}var _it=wit(yit);function Sit(e,t){return _it(mit(e,t,Jle),e+"")}function Cit(e,t,n){if(!og(n))return!1;var r=typeof t;return(r=="number"?bA(n)&&Yle(t,n.length):r=="string"&&t in n)?pA(n[t],e):!1}function kit(e){return Sit(function(t,n){var r=-1,s=n.length,i=s>1?n[s-1]:void 0,a=s>2?n[2]:void 0;for(i=e.length>3&&typeof i=="function"?(s--,i):void 0,a&&Cit(n[0],n[1],a)&&(i=s<3?void 0:i,s=1),t=Object(t);++r<s;){var o=n[r];o&&e(t,o,r,i)}return t})}var Eit=kit(function(e,t,n){Xle(e,t,n)}),Tit="",Ait={curveBasis:i2,curveBasisClosed:Wnt,curveBasisOpen:Hnt,curveBumpX:vle,curveBumpY:xle,curveBundle:Gnt,curveCardinalClosed:Knt,curveCardinalOpen:Ynt,curveCardinal:Cle,curveCatmullRomClosed:Znt,curveCatmullRomOpen:Xnt,curveCatmullRom:Ele,curveLinear:tE,curveLinearClosed:Jnt,curveMonotoneX:Ile,curveMonotoneY:jle,curveNatural:Ole,curveStep:Dle,curveStepAfter:Lle,curveStepBefore:Fle},Rit=/\s*(?:(\w+)(?=:):|(\w+))\s*(?:(\w+)|((?:(?!}%{2}).|\r?\n)*))?\s*(?:}%{2})?/gi,Nit=ie(function(e,t){const n=Qle(e,/(?:init\b)|(?:initialize\b)/);let r={};if(Array.isArray(n)){const a=n.map(o=>o.args);Lk(a),r=Ca(r,[...a])}else r=n.args;if(!r)return;let s=y6(e,t);const i="config";return r[i]!==void 0&&(s==="flowchart-v2"&&(s="flowchart"),r[s]=r[i],delete r[i]),r},"detectInit"),Qle=ie(function(e,t=null){var n,r;try{const s=new RegExp(`[%]{2}(?![{]${Rit.source})(?=[}][%]{2}).*
`,"ig");e=e.trim().replace(s,"").replace(/'/gm,'"'),Ut.debug(`Detecting diagram directive${t!==null?" type:"+t:""} based on the text:${e}`);let i;const a=[];for(;(i=Hx.exec(e))!==null;)if(i.index===Hx.lastIndex&&Hx.lastIndex++,i&&!t||t&&((n=i[1])!=null&&n.match(t))||t&&((r=i[2])!=null&&r.match(t))){const o=i[1]?i[1]:i[2],l=i[3]?i[3].trim():i[4]?JSON.parse(i[4].trim()):null;a.push({type:o,args:l})}return a.length===0?{type:e,args:null}:a.length===1?a[0]:a}catch(s){return Ut.error(`ERROR: ${s.message} - Unable to parse directive type: '${t}' based on the text: '${e}'`),{type:void 0,args:null}}},"detectDirective"),Mit=ie(function(e){return e.replace(Hx,"")},"removeDirectives"),Iit=ie(function(e,t){for(const[n,r]of t.entries())if(r.match(e))return n;return-1},"isSubstringInArray");function K6(e,t){if(!e)return t;const n=`curve${e.charAt(0).toUpperCase()+e.slice(1)}`;return Ait[n]??t}ie(K6,"interpolateToCurve");function ece(e,t){const n=e.trim();if(n)return t.securityLevel!=="loose"?xQe.sanitizeUrl(n):n}ie(ece,"formatUrl");var jit=ie((e,...t)=>{const n=e.split("."),r=n.length-1,s=n[r];let i=window;for(let a=0;a<r;a++)if(i=i[n[a]],!i){Ut.error(`Function name: ${e} not found in window`);return}i[s](...t)},"runFunc");function Y6(e,t){return!e||!t?0:Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2))}ie(Y6,"distance");function tce(e){let t,n=0;e.forEach(s=>{n+=Y6(s,t),t=s});const r=n/2;return Z6(e,r)}ie(tce,"traverseEdge");function nce(e){return e.length===1?e[0]:tce(e)}ie(nce,"calcLabelPosition");var xW=ie((e,t=2)=>{const n=Math.pow(10,t);return Math.round(e*n)/n},"roundNumber"),Z6=ie((e,t)=>{let n,r=t;for(const s of e){if(n){const i=Y6(s,n);if(i===0)return n;if(i<r)r-=i;else{const a=r/i;if(a<=0)return n;if(a>=1)return{x:s.x,y:s.y};if(a>0&&a<1)return{x:xW((1-a)*n.x+a*s.x,5),y:xW((1-a)*n.y+a*s.y,5)}}}n=s}throw new Error("Could not find a suitable point for the given distance")},"calculatePoint"),Pit=ie((e,t,n)=>{Ut.info(`our points ${JSON.stringify(t)}`),t[0]!==n&&(t=t.reverse());const s=Z6(t,25),i=e?10:5,a=Math.atan2(t[0].y-s.y,t[0].x-s.x),o={x:0,y:0};return o.x=Math.sin(a)*i+(t[0].x+s.x)/2,o.y=-Math.cos(a)*i+(t[0].y+s.y)/2,o},"calcCardinalityPosition");function rce(e,t,n){const r=structuredClone(n);Ut.info("our points",r),t!=="start_left"&&t!=="start_right"&&r.reverse();const s=25+e,i=Z6(r,s),a=10+e*.5,o=Math.atan2(r[0].y-i.y,r[0].x-i.x),l={x:0,y:0};return t==="start_left"?(l.x=Math.sin(o+Math.PI)*a+(r[0].x+i.x)/2,l.y=-Math.cos(o+Math.PI)*a+(r[0].y+i.y)/2):t==="end_right"?(l.x=Math.sin(o-Math.PI)*a+(r[0].x+i.x)/2-5,l.y=-Math.cos(o-Math.PI)*a+(r[0].y+i.y)/2-5):t==="end_left"?(l.x=Math.sin(o)*a+(r[0].x+i.x)/2-5,l.y=-Math.cos(o)*a+(r[0].y+i.y)/2-5):(l.x=Math.sin(o)*a+(r[0].x+i.x)/2,l.y=-Math.cos(o)*a+(r[0].y+i.y)/2),l}ie(rce,"calcTerminalLabelPosition");function sce(e){let t="",n="";for(const r of e)r!==void 0&&(r.startsWith("color:")||r.startsWith("text-align:")?n=n+r+";":t=t+r+";");return{style:t,labelStyle:n}}ie(sce,"getStylesFromArray");var wW=0,Oit=ie(()=>(wW++,"id-"+Math.random().toString(36).substr(2,12)+"-"+wW),"generateId");function ice(e){let t="";const n="0123456789abcdef",r=n.length;for(let s=0;s<e;s++)t+=n.charAt(Math.floor(Math.random()*r));return t}ie(ice,"makeRandomHex");var Dit=ie(e=>ice(e.length),"random"),Fit=ie(function(){return{x:0,y:0,fill:void 0,anchor:"start",style:"#666",width:100,height:100,textMargin:0,rx:0,ry:0,valign:void 0,text:""}},"getTextObj"),Lit=ie(function(e,t){const n=t.text.replace(Eb.lineBreakRegex," "),[,r]=vA(t.fontSize),s=e.append("text");s.attr("x",t.x),s.attr("y",t.y),s.style("text-anchor",t.anchor),s.style("font-family",t.fontFamily),s.style("font-size",r),s.style("font-weight",t.fontWeight),s.attr("fill",t.fill),t.class!==void 0&&s.attr("class",t.class);const i=s.append("tspan");return i.attr("x",t.x+t.textMargin*2),i.attr("fill",t.fill),i.text(n),s},"drawSimpleText"),Bit=v_((e,t,n)=>{if(!e||(n=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",joinWith:"<br/>"},n),Eb.lineBreakRegex.test(e)))return e;const r=e.split(" ").filter(Boolean),s=[];let i="";return r.forEach((a,o)=>{const l=nf(`${a} `,n),c=nf(i,n);if(l>t){const{hyphenatedStrings:h,remainingWord:m}=$it(a,t,"-",n);s.push(i,...h),i=m}else c+l>=t?(s.push(i),i=a):i=[i,a].filter(Boolean).join(" ");o+1===r.length&&s.push(i)}),s.filter(a=>a!=="").join(n.joinWith)},(e,t,n)=>`${e}${t}${n.fontSize}${n.fontWeight}${n.fontFamily}${n.joinWith}`),$it=v_((e,t,n="-",r)=>{r=Object.assign({fontSize:12,fontWeight:400,fontFamily:"Arial",margin:0},r);const s=[...e],i=[];let a="";return s.forEach((o,l)=>{const c=`${a}${o}`;if(nf(c,r)>=t){const d=l+1,h=s.length===d,m=`${c}${n}`;i.push(h?c:m),a=""}else a=c}),{hyphenatedStrings:i,remainingWord:a}},(e,t,n="-",r)=>`${e}${t}${n}${r.fontSize}${r.fontWeight}${r.fontFamily}`);function ace(e,t){return X6(e,t).height}ie(ace,"calculateTextHeight");function nf(e,t){return X6(e,t).width}ie(nf,"calculateTextWidth");var X6=v_((e,t)=>{const{fontSize:n=12,fontFamily:r="Arial",fontWeight:s=400}=t;if(!e)return{width:0,height:0};const[,i]=vA(n),a=["sans-serif",r],o=e.split(Eb.lineBreakRegex),l=[],c=Zr("body");if(!c.remove)return{width:0,height:0,lineHeight:0};const u=c.append("svg");for(const h of a){let m=0;const y={width:0,height:0,lineHeight:0};for(const b of o){const v=Fit();v.text=b||Tit;const x=Lit(u,v).style("font-size",i).style("font-weight",s).style("font-family",h),w=(x._groups||x)[0][0].getBBox();if(w.width===0&&w.height===0)throw new Error("svg element not in render tree");y.width=Math.round(Math.max(y.width,w.width)),m=Math.round(w.height),y.height+=m,y.lineHeight=Math.round(Math.max(y.lineHeight,m))}l.push(y)}u.remove();const d=isNaN(l[1].height)||isNaN(l[1].width)||isNaN(l[1].lineHeight)||l[0].height>l[1].height&&l[0].width>l[1].width&&l[0].lineHeight>l[1].lineHeight?0:1;return l[d]},(e,t)=>`${e}${t.fontSize}${t.fontWeight}${t.fontFamily}`),ey,zit=(ey=class{constructor(t=!1,n){this.count=0,this.count=n?n.length:0,this.next=t?()=>this.count++:()=>Date.now()}},ie(ey,"InitIDGenerator"),ey),TC,Uit=ie(function(e){return TC=TC||document.createElement("div"),e=escape(e).replace(/%26/g,"&").replace(/%23/g,"#").replace(/%3B/g,";"),TC.innerHTML=e,unescape(TC.textContent)},"entityDecode");function J6(e){return"str"in e}ie(J6,"isDetailedError");var qit=ie((e,t,n,r)=>{var i;if(!r)return;const s=(i=e.node())==null?void 0:i.getBBox();s&&e.append("text").text(r).attr("text-anchor","middle").attr("x",s.x+s.width/2).attr("y",-n).attr("class",t)},"insertTitle"),vA=ie(e=>{if(typeof e=="number")return[e,e+"px"];const t=parseInt(e??"",10);return Number.isNaN(t)?[void 0,void 0]:e===String(t)?[t,e+"px"]:[t,e]},"parseFontSize");function Q6(e,t){return Eit({},e,t)}ie(Q6,"cleanAndMerge");var xu={assignWithDepth:Ca,wrapLabel:Bit,calculateTextHeight:ace,calculateTextWidth:nf,calculateTextDimensions:X6,cleanAndMerge:Q6,detectInit:Nit,detectDirective:Qle,isSubstringInArray:Iit,interpolateToCurve:K6,calcLabelPosition:nce,calcCardinalityPosition:Pit,calcTerminalLabelPosition:rce,formatUrl:ece,getStylesFromArray:sce,generateId:Oit,random:Dit,runFunc:jit,entityDecode:Uit,insertTitle:qit,parseFontSize:vA,InitIDGenerator:zit},Vit=ie(function(e){let t=e;return t=t.replace(/style.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/classDef.*:\S*#.*;/g,function(n){return n.substring(0,n.length-1)}),t=t.replace(/#\w+;/g,function(n){const r=n.substring(1,n.length-1);return/^\+?\d+$/.test(r)?""+r+"":""+r+""}),t},"encodeEntities"),ug=ie(function(e){return e.replace(//g,"&#").replace(//g,"&").replace(//g,";")},"decodeEntities"),cft=ie((e,t,{counter:n=0,prefix:r,suffix:s},i)=>i||`${r?`${r}_`:""}${e}_${t}_${n}${s?`_${s}`:""}`,"getEdgeId");function lo(e){return e??null}ie(lo,"handleUndefinedAttr");function e5(){return{async:!1,breaks:!1,extensions:null,gfm:!0,hooks:null,pedantic:!1,renderer:null,silent:!1,tokenizer:null,walkTokens:null}}var dg=e5();function oce(e){dg=e}var Yx={exec:()=>null};function gs(e,t=""){let n=typeof e=="string"?e:e.source;const r={replace:(s,i)=>{let a=typeof i=="string"?i:i.source;return a=a.replace(io.caret,"$1"),n=n.replace(s,a),r},getRegex:()=>new RegExp(n,t)};return r}var io={codeRemoveIndent:/^(?: {1,4}| {0,3}\t)/gm,outputLinkReplace:/\\([\[\]])/g,indentCodeCompensation:/^(\s+)(?:```)/,beginningSpace:/^\s+/,endingHash:/#$/,startingSpaceChar:/^ /,endingSpaceChar:/ $/,nonSpaceChar:/[^ ]/,newLineCharGlobal:/\n/g,tabCharGlobal:/\t/g,multipleSpaceGlobal:/\s+/g,blankLine:/^[ \t]*$/,doubleBlankLine:/\n[ \t]*\n[ \t]*$/,blockquoteStart:/^ {0,3}>/,blockquoteSetextReplace:/\n {0,3}((?:=+|-+) *)(?=\n|$)/g,blockquoteSetextReplace2:/^ {0,3}>[ \t]?/gm,listReplaceTabs:/^\t+/,listReplaceNesting:/^ {1,4}(?=( {4})*[^ ])/g,listIsTask:/^\[[ xX]\] /,listReplaceTask:/^\[[ xX]\] +/,anyLine:/\n.*\n/,hrefBrackets:/^<(.*)>$/,tableDelimiter:/[:|]/,tableAlignChars:/^\||\| *$/g,tableRowBlankLine:/\n[ \t]*$/,tableAlignRight:/^ *-+: *$/,tableAlignCenter:/^ *:-+: *$/,tableAlignLeft:/^ *:-+ *$/,startATag:/^<a /i,endATag:/^<\/a>/i,startPreScriptTag:/^<(pre|code|kbd|script)(\s|>)/i,endPreScriptTag:/^<\/(pre|code|kbd|script)(\s|>)/i,startAngleBracket:/^</,endAngleBracket:/>$/,pedanticHrefTitle:/^([^'"]*[^\s])\s+(['"])(.*)\2/,unicodeAlphaNumeric:/[\p{L}\p{N}]/u,escapeTest:/[&<>"']/,escapeReplace:/[&<>"']/g,escapeTestNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/,escapeReplaceNoEncode:/[<>"']|&(?!(#\d{1,7}|#[Xx][a-fA-F0-9]{1,6}|\w+);)/g,unescapeTest:/&(#(?:\d+)|(?:#x[0-9A-Fa-f]+)|(?:\w+));?/ig,caret:/(^|[^\[])\^/g,percentDecode:/%25/g,findPipe:/\|/g,splitPipe:/ \|/,slashPipe:/\\\|/g,carriageReturn:/\r\n|\r/g,spaceLine:/^ +$/gm,notSpaceStart:/^\S*/,endingNewline:/\n$/,listItemRegex:e=>new RegExp(`^( {0,3}${e})((?:[	 ][^\\n]*)?(?:\\n|$))`),nextBulletRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:[*+-]|\\d{1,9}[.)])((?:[ 	][^\\n]*)?(?:\\n|$))`),hrRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}((?:- *){3,}|(?:_ *){3,}|(?:\\* *){3,})(?:\\n+|$)`),fencesBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}(?:\`\`\`|~~~)`),headingBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}#`),htmlBeginRegex:e=>new RegExp(`^ {0,${Math.min(3,e-1)}}<(?:[a-z].*>|!--)`,"i")},Wit=/^(?:[ \t]*(?:\n|$))+/,Hit=/^((?: {4}| {0,3}\t)[^\n]+(?:\n(?:[ \t]*(?:\n|$))*)?)+/,Git=/^ {0,3}(`{3,}(?=[^`\n]*(?:\n|$))|~{3,})([^\n]*)(?:\n|$)(?:|([\s\S]*?)(?:\n|$))(?: {0,3}\1[~`]* *(?=\n|$)|$)/,w_=/^ {0,3}((?:-[\t ]*){3,}|(?:_[ \t]*){3,}|(?:\*[ \t]*){3,})(?:\n+|$)/,Kit=/^ {0,3}(#{1,6})(?=\s|$)(.*)(?:\n+|$)/,t5=/(?:[*+-]|\d{1,9}[.)])/,lce=/^(?!bull |blockCode|fences|blockquote|heading|html|table)((?:.|\n(?!\s*?\n|bull |blockCode|fences|blockquote|heading|html|table))+?)\n {0,3}(=+|-+) *(?:\n+|$)/,cce=gs(lce).replace(/bull/g,t5).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/\|table/g,"").getRegex(),Yit=gs(lce).replace(/bull/g,t5).replace(/blockCode/g,/(?: {4}| {0,3}\t)/).replace(/fences/g,/ {0,3}(?:`{3,}|~{3,})/).replace(/blockquote/g,/ {0,3}>/).replace(/heading/g,/ {0,3}#{1,6}/).replace(/html/g,/ {0,3}<[^\n>]+>\n/).replace(/table/g,/ {0,3}\|?(?:[:\- ]*\|)+[\:\- ]*\n/).getRegex(),n5=/^([^\n]+(?:\n(?!hr|heading|lheading|blockquote|fences|list|html|table| +\n)[^\n]+)*)/,Zit=/^[^\n]+/,r5=/(?!\s*\])(?:\\.|[^\[\]\\])+/,Xit=gs(/^ {0,3}\[(label)\]: *(?:\n[ \t]*)?([^<\s][^\s]*|<.*?>)(?:(?: +(?:\n[ \t]*)?| *\n[ \t]*)(title))? *(?:\n+|$)/).replace("label",r5).replace("title",/(?:"(?:\\"?|[^"\\])*"|'[^'\n]*(?:\n[^'\n]+)*\n?'|\([^()]*\))/).getRegex(),Jit=gs(/^( {0,3}bull)([ \t][^\n]+?)?(?:\n|$)/).replace(/bull/g,t5).getRegex(),xA="address|article|aside|base|basefont|blockquote|body|caption|center|col|colgroup|dd|details|dialog|dir|div|dl|dt|fieldset|figcaption|figure|footer|form|frame|frameset|h[1-6]|head|header|hr|html|iframe|legend|li|link|main|menu|menuitem|meta|nav|noframes|ol|optgroup|option|p|param|search|section|summary|table|tbody|td|tfoot|th|thead|title|tr|track|ul",s5=/<!--(?:-?>|[\s\S]*?(?:-->|$))/,Qit=gs("^ {0,3}(?:<(script|pre|style|textarea)[\\s>][\\s\\S]*?(?:</\\1>[^\\n]*\\n+|$)|comment[^\\n]*(\\n+|$)|<\\?[\\s\\S]*?(?:\\?>\\n*|$)|<![A-Z][\\s\\S]*?(?:>\\n*|$)|<!\\[CDATA\\[[\\s\\S]*?(?:\\]\\]>\\n*|$)|</?(tag)(?: +|\\n|/?>)[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|<(?!script|pre|style|textarea)([a-z][\\w-]*)(?:attribute)*? */?>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$)|</(?!script|pre|style|textarea)[a-z][\\w-]*\\s*>(?=[ \\t]*(?:\\n|$))[\\s\\S]*?(?:(?:\\n[ 	]*)+\\n|$))","i").replace("comment",s5).replace("tag",xA).replace("attribute",/ +[a-zA-Z:_][\w.:-]*(?: *= *"[^"\n]*"| *= *'[^'\n]*'| *= *[^\s"'=<>`]+)?/).getRegex(),uce=gs(n5).replace("hr",w_).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("|table","").replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xA).getRegex(),eat=gs(/^( {0,3}> ?(paragraph|[^\n]*)(?:\n|$))+/).replace("paragraph",uce).getRegex(),i5={blockquote:eat,code:Hit,def:Xit,fences:Git,heading:Kit,hr:w_,html:Qit,lheading:cce,list:Jit,newline:Wit,paragraph:uce,table:Yx,text:Zit},_W=gs("^ *([^\\n ].*)\\n {0,3}((?:\\| *)?:?-+:? *(?:\\| *:?-+:? *)*(?:\\| *)?)(?:\\n((?:(?! *\\n|hr|heading|blockquote|code|fences|list|html).*(?:\\n|$))*)\\n*|$)").replace("hr",w_).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("blockquote"," {0,3}>").replace("code","(?: {4}| {0,3}	)[^\\n]").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xA).getRegex(),tat={...i5,lheading:Yit,table:_W,paragraph:gs(n5).replace("hr",w_).replace("heading"," {0,3}#{1,6}(?:\\s|$)").replace("|lheading","").replace("table",_W).replace("blockquote"," {0,3}>").replace("fences"," {0,3}(?:`{3,}(?=[^`\\n]*\\n)|~{3,})[^\\n]*\\n").replace("list"," {0,3}(?:[*+-]|1[.)]) ").replace("html","</?(?:tag)(?: +|\\n|/?>)|<(?:script|pre|style|textarea|!--)").replace("tag",xA).getRegex()},nat={...i5,html:gs(`^ *(?:comment *(?:\\n|\\s*$)|<(tag)[\\s\\S]+?</\\1> *(?:\\n{2,}|\\s*$)|<tag(?:"[^"]*"|'[^']*'|\\s[^'"/>\\s]*)*?/?> *(?:\\n{2,}|\\s*$))`).replace("comment",s5).replace(/tag/g,"(?!(?:a|em|strong|small|s|cite|q|dfn|abbr|data|time|code|var|samp|kbd|sub|sup|i|b|u|mark|ruby|rt|rp|bdi|bdo|span|br|wbr|ins|del|img)\\b)\\w+(?!:|[^\\w\\s@]*@)\\b").getRegex(),def:/^ *\[([^\]]+)\]: *<?([^\s>]+)>?(?: +(["(][^\n]+[")]))? *(?:\n+|$)/,heading:/^(#{1,6})(.*)(?:\n+|$)/,fences:Yx,lheading:/^(.+?)\n {0,3}(=+|-+) *(?:\n+|$)/,paragraph:gs(n5).replace("hr",w_).replace("heading",` *#{1,6} *[^
]`).replace("lheading",cce).replace("|table","").replace("blockquote"," {0,3}>").replace("|fences","").replace("|list","").replace("|html","").replace("|tag","").getRegex()},rat=/^\\([!"#$%&'()*+,\-./:;<=>?@\[\]\\^_`{|}~])/,sat=/^(`+)([^`]|[^`][\s\S]*?[^`])\1(?!`)/,dce=/^( {2,}|\\)\n(?!\s*$)/,iat=/^(`+|[^`])(?:(?= {2,}\n)|[\s\S]*?(?:(?=[\\<!\[`*_]|\b_|$)|[^ ](?= {2,}\n)))/,wA=/[\p{P}\p{S}]/u,a5=/[\s\p{P}\p{S}]/u,fce=/[^\s\p{P}\p{S}]/u,aat=gs(/^((?![*_])punctSpace)/,"u").replace(/punctSpace/g,a5).getRegex(),hce=/(?!~)[\p{P}\p{S}]/u,oat=/(?!~)[\s\p{P}\p{S}]/u,lat=/(?:[^\s\p{P}\p{S}]|~)/u,cat=/\[[^[\]]*?\]\((?:\\.|[^\\\(\)]|\((?:\\.|[^\\\(\)])*\))*\)|`[^`]*?`|<[^<>]*?>/g,pce=/^(?:\*+(?:((?!\*)punct)|[^\s*]))|^_+(?:((?!_)punct)|([^\s_]))/,uat=gs(pce,"u").replace(/punct/g,wA).getRegex(),dat=gs(pce,"u").replace(/punct/g,hce).getRegex(),mce="^[^_*]*?__[^_*]*?\\*[^_*]*?(?=__)|[^*]+(?=[^*])|(?!\\*)punct(\\*+)(?=[\\s]|$)|notPunctSpace(\\*+)(?!\\*)(?=punctSpace|$)|(?!\\*)punctSpace(\\*+)(?=notPunctSpace)|[\\s](\\*+)(?!\\*)(?=punct)|(?!\\*)punct(\\*+)(?!\\*)(?=punct)|notPunctSpace(\\*+)(?=notPunctSpace)",fat=gs(mce,"gu").replace(/notPunctSpace/g,fce).replace(/punctSpace/g,a5).replace(/punct/g,wA).getRegex(),hat=gs(mce,"gu").replace(/notPunctSpace/g,lat).replace(/punctSpace/g,oat).replace(/punct/g,hce).getRegex(),pat=gs("^[^_*]*?\\*\\*[^_*]*?_[^_*]*?(?=\\*\\*)|[^_]+(?=[^_])|(?!_)punct(_+)(?=[\\s]|$)|notPunctSpace(_+)(?!_)(?=punctSpace|$)|(?!_)punctSpace(_+)(?=notPunctSpace)|[\\s](_+)(?!_)(?=punct)|(?!_)punct(_+)(?!_)(?=punct)","gu").replace(/notPunctSpace/g,fce).replace(/punctSpace/g,a5).replace(/punct/g,wA).getRegex(),mat=gs(/\\(punct)/,"gu").replace(/punct/g,wA).getRegex(),gat=gs(/^<(scheme:[^\s\x00-\x1f<>]*|email)>/).replace("scheme",/[a-zA-Z][a-zA-Z0-9+.-]{1,31}/).replace("email",/[a-zA-Z0-9.!#$%&'*+/=?^_`{|}~-]+(@)[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?(?:\.[a-zA-Z0-9](?:[a-zA-Z0-9-]{0,61}[a-zA-Z0-9])?)+(?![-_])/).getRegex(),yat=gs(s5).replace("(?:-->|$)","-->").getRegex(),bat=gs("^comment|^</[a-zA-Z][\\w:-]*\\s*>|^<[a-zA-Z][\\w-]*(?:attribute)*?\\s*/?>|^<\\?[\\s\\S]*?\\?>|^<![a-zA-Z]+\\s[\\s\\S]*?>|^<!\\[CDATA\\[[\\s\\S]*?\\]\\]>").replace("comment",yat).replace("attribute",/\s+[a-zA-Z:_][\w.:-]*(?:\s*=\s*"[^"]*"|\s*=\s*'[^']*'|\s*=\s*[^\s"'=<>`]+)?/).getRegex(),cE=/(?:\[(?:\\.|[^\[\]\\])*\]|\\.|`[^`]*`|[^\[\]\\`])*?/,vat=gs(/^!?\[(label)\]\(\s*(href)(?:(?:[ \t]*(?:\n[ \t]*)?)(title))?\s*\)/).replace("label",cE).replace("href",/<(?:\\.|[^\n<>\\])+>|[^ \t\n\x00-\x1f]*/).replace("title",/"(?:\\"?|[^"\\])*"|'(?:\\'?|[^'\\])*'|\((?:\\\)?|[^)\\])*\)/).getRegex(),gce=gs(/^!?\[(label)\]\[(ref)\]/).replace("label",cE).replace("ref",r5).getRegex(),yce=gs(/^!?\[(ref)\](?:\[\])?/).replace("ref",r5).getRegex(),xat=gs("reflink|nolink(?!\\()","g").replace("reflink",gce).replace("nolink",yce).getRegex(),o5={_backpedal:Yx,anyPunctuation:mat,autolink:gat,blockSkip:cat,br:dce,code:sat,del:Yx,emStrongLDelim:uat,emStrongRDelimAst:fat,emStrongRDelimUnd:pat,escape:rat,link:vat,nolink:yce,punctuation:aat,reflink:gce,reflinkSearch:xat,tag:bat,text:iat,url:Yx},wat={...o5,link:gs(/^!?\[(label)\]\((.*?)\)/).replace("label",cE).getRegex(),reflink:gs(/^!?\[(label)\]\s*\[([^\]]*)\]/).replace("label",cE).getRegex()},kP={...o5,emStrongRDelimAst:hat,emStrongLDelim:dat,url:gs(/^((?:ftp|https?):\/\/|www\.)(?:[a-zA-Z0-9\-]+\.?)+[^\s<]*|^email/,"i").replace("email",/[A-Za-z0-9._+-]+(@)[a-zA-Z0-9-_]+(?:\.[a-zA-Z0-9-_]*[a-zA-Z0-9])+(?![-_])/).getRegex(),_backpedal:/(?:[^?!.,:;*_'"~()&]+|\([^)]*\)|&(?![a-zA-Z0-9]+;$)|[?!.,:;*_'"~)]+(?!$))+/,del:/^(~~?)(?=[^\s~])((?:\\.|[^\\])*?(?:\\.|[^\s~\\]))\1(?=[^~]|$)/,text:/^([`~]+|[^`~])(?:(?= {2,}\n)|(?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)|[\s\S]*?(?:(?=[\\<!\[`*~_]|\b_|https?:\/\/|ftp:\/\/|www\.|$)|[^ ](?= {2,}\n)|[^a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-](?=[a-zA-Z0-9.!#$%&'*+\/=?_`{\|}~-]+@)))/},_at={...kP,br:gs(dce).replace("{2,}","*").getRegex(),text:gs(kP.text).replace("\\b_","\\b_| {2,}\\n").replace(/\{2,\}/g,"*").getRegex()},AC={normal:i5,gfm:tat,pedantic:nat},rx={normal:o5,gfm:kP,breaks:_at,pedantic:wat},Sat={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;"},SW=e=>Sat[e];function cu(e,t){if(t){if(io.escapeTest.test(e))return e.replace(io.escapeReplace,SW)}else if(io.escapeTestNoEncode.test(e))return e.replace(io.escapeReplaceNoEncode,SW);return e}function CW(e){try{e=encodeURI(e).replace(io.percentDecode,"%")}catch{return null}return e}function kW(e,t){var i;const n=e.replace(io.findPipe,(a,o,l)=>{let c=!1,u=o;for(;--u>=0&&l[u]==="\\";)c=!c;return c?"|":" |"}),r=n.split(io.splitPipe);let s=0;if(r[0].trim()||r.shift(),r.length>0&&!((i=r.at(-1))!=null&&i.trim())&&r.pop(),t)if(r.length>t)r.splice(t);else for(;r.length<t;)r.push("");for(;s<r.length;s++)r[s]=r[s].trim().replace(io.slashPipe,"|");return r}function sx(e,t,n){const r=e.length;if(r===0)return"";let s=0;for(;s<r&&e.charAt(r-s-1)===t;)s++;return e.slice(0,r-s)}function Cat(e,t){if(e.indexOf(t[1])===-1)return-1;let n=0;for(let r=0;r<e.length;r++)if(e[r]==="\\")r++;else if(e[r]===t[0])n++;else if(e[r]===t[1]&&(n--,n<0))return r;return n>0?-2:-1}function EW(e,t,n,r,s){const i=t.href,a=t.title||null,o=e[1].replace(s.other.outputLinkReplace,"$1");r.state.inLink=!0;const l={type:e[0].charAt(0)==="!"?"image":"link",raw:n,href:i,title:a,text:o,tokens:r.inlineTokens(o)};return r.state.inLink=!1,l}function kat(e,t,n){const r=e.match(n.other.indentCodeCompensation);if(r===null)return t;const s=r[1];return t.split(`
`).map(i=>{const a=i.match(n.other.beginningSpace);if(a===null)return i;const[o]=a;return o.length>=s.length?i.slice(s.length):i}).join(`
`)}var uE=class{constructor(e){ue(this,"options");ue(this,"rules");ue(this,"lexer");this.options=e||dg}space(e){const t=this.rules.block.newline.exec(e);if(t&&t[0].length>0)return{type:"space",raw:t[0]}}code(e){const t=this.rules.block.code.exec(e);if(t){const n=t[0].replace(this.rules.other.codeRemoveIndent,"");return{type:"code",raw:t[0],codeBlockStyle:"indented",text:this.options.pedantic?n:sx(n,`
`)}}}fences(e){const t=this.rules.block.fences.exec(e);if(t){const n=t[0],r=kat(n,t[3]||"",this.rules);return{type:"code",raw:n,lang:t[2]?t[2].trim().replace(this.rules.inline.anyPunctuation,"$1"):t[2],text:r}}}heading(e){const t=this.rules.block.heading.exec(e);if(t){let n=t[2].trim();if(this.rules.other.endingHash.test(n)){const r=sx(n,"#");(this.options.pedantic||!r||this.rules.other.endingSpaceChar.test(r))&&(n=r.trim())}return{type:"heading",raw:t[0],depth:t[1].length,text:n,tokens:this.lexer.inline(n)}}}hr(e){const t=this.rules.block.hr.exec(e);if(t)return{type:"hr",raw:sx(t[0],`
`)}}blockquote(e){const t=this.rules.block.blockquote.exec(e);if(t){let n=sx(t[0],`
`).split(`
`),r="",s="";const i=[];for(;n.length>0;){let a=!1;const o=[];let l;for(l=0;l<n.length;l++)if(this.rules.other.blockquoteStart.test(n[l]))o.push(n[l]),a=!0;else if(!a)o.push(n[l]);else break;n=n.slice(l);const c=o.join(`
`),u=c.replace(this.rules.other.blockquoteSetextReplace,`
    $1`).replace(this.rules.other.blockquoteSetextReplace2,"");r=r?`${r}
${c}`:c,s=s?`${s}
${u}`:u;const d=this.lexer.state.top;if(this.lexer.state.top=!0,this.lexer.blockTokens(u,i,!0),this.lexer.state.top=d,n.length===0)break;const h=i.at(-1);if((h==null?void 0:h.type)==="code")break;if((h==null?void 0:h.type)==="blockquote"){const m=h,y=m.raw+`
`+n.join(`
`),b=this.blockquote(y);i[i.length-1]=b,r=r.substring(0,r.length-m.raw.length)+b.raw,s=s.substring(0,s.length-m.text.length)+b.text;break}else if((h==null?void 0:h.type)==="list"){const m=h,y=m.raw+`
`+n.join(`
`),b=this.list(y);i[i.length-1]=b,r=r.substring(0,r.length-h.raw.length)+b.raw,s=s.substring(0,s.length-m.raw.length)+b.raw,n=y.substring(i.at(-1).raw.length).split(`
`);continue}}return{type:"blockquote",raw:r,tokens:i,text:s}}}list(e){let t=this.rules.block.list.exec(e);if(t){let n=t[1].trim();const r=n.length>1,s={type:"list",raw:"",ordered:r,start:r?+n.slice(0,-1):"",loose:!1,items:[]};n=r?`\\d{1,9}\\${n.slice(-1)}`:`\\${n}`,this.options.pedantic&&(n=r?n:"[*+-]");const i=this.rules.other.listItemRegex(n);let a=!1;for(;e;){let l=!1,c="",u="";if(!(t=i.exec(e))||this.rules.block.hr.test(e))break;c=t[0],e=e.substring(c.length);let d=t[2].split(`
`,1)[0].replace(this.rules.other.listReplaceTabs,x=>" ".repeat(3*x.length)),h=e.split(`
`,1)[0],m=!d.trim(),y=0;if(this.options.pedantic?(y=2,u=d.trimStart()):m?y=t[1].length+1:(y=t[2].search(this.rules.other.nonSpaceChar),y=y>4?1:y,u=d.slice(y),y+=t[1].length),m&&this.rules.other.blankLine.test(h)&&(c+=h+`
`,e=e.substring(h.length+1),l=!0),!l){const x=this.rules.other.nextBulletRegex(y),w=this.rules.other.hrRegex(y),S=this.rules.other.fencesBeginRegex(y),k=this.rules.other.headingBeginRegex(y),C=this.rules.other.htmlBeginRegex(y);for(;e;){const T=e.split(`
`,1)[0];let A;if(h=T,this.options.pedantic?(h=h.replace(this.rules.other.listReplaceNesting,"  "),A=h):A=h.replace(this.rules.other.tabCharGlobal,"    "),S.test(h)||k.test(h)||C.test(h)||x.test(h)||w.test(h))break;if(A.search(this.rules.other.nonSpaceChar)>=y||!h.trim())u+=`
`+A.slice(y);else{if(m||d.replace(this.rules.other.tabCharGlobal,"    ").search(this.rules.other.nonSpaceChar)>=4||S.test(d)||k.test(d)||w.test(d))break;u+=`
`+h}!m&&!h.trim()&&(m=!0),c+=T+`
`,e=e.substring(T.length+1),d=A.slice(y)}}s.loose||(a?s.loose=!0:this.rules.other.doubleBlankLine.test(c)&&(a=!0));let b=null,v;this.options.gfm&&(b=this.rules.other.listIsTask.exec(u),b&&(v=b[0]!=="[ ] ",u=u.replace(this.rules.other.listReplaceTask,""))),s.items.push({type:"list_item",raw:c,task:!!b,checked:v,loose:!1,text:u,tokens:[]}),s.raw+=c}const o=s.items.at(-1);if(o)o.raw=o.raw.trimEnd(),o.text=o.text.trimEnd();else return;s.raw=s.raw.trimEnd();for(let l=0;l<s.items.length;l++)if(this.lexer.state.top=!1,s.items[l].tokens=this.lexer.blockTokens(s.items[l].text,[]),!s.loose){const c=s.items[l].tokens.filter(d=>d.type==="space"),u=c.length>0&&c.some(d=>this.rules.other.anyLine.test(d.raw));s.loose=u}if(s.loose)for(let l=0;l<s.items.length;l++)s.items[l].loose=!0;return s}}html(e){const t=this.rules.block.html.exec(e);if(t)return{type:"html",block:!0,raw:t[0],pre:t[1]==="pre"||t[1]==="script"||t[1]==="style",text:t[0]}}def(e){const t=this.rules.block.def.exec(e);if(t){const n=t[1].toLowerCase().replace(this.rules.other.multipleSpaceGlobal," "),r=t[2]?t[2].replace(this.rules.other.hrefBrackets,"$1").replace(this.rules.inline.anyPunctuation,"$1"):"",s=t[3]?t[3].substring(1,t[3].length-1).replace(this.rules.inline.anyPunctuation,"$1"):t[3];return{type:"def",tag:n,raw:t[0],href:r,title:s}}}table(e){var a;const t=this.rules.block.table.exec(e);if(!t||!this.rules.other.tableDelimiter.test(t[2]))return;const n=kW(t[1]),r=t[2].replace(this.rules.other.tableAlignChars,"").split("|"),s=(a=t[3])!=null&&a.trim()?t[3].replace(this.rules.other.tableRowBlankLine,"").split(`
`):[],i={type:"table",raw:t[0],header:[],align:[],rows:[]};if(n.length===r.length){for(const o of r)this.rules.other.tableAlignRight.test(o)?i.align.push("right"):this.rules.other.tableAlignCenter.test(o)?i.align.push("center"):this.rules.other.tableAlignLeft.test(o)?i.align.push("left"):i.align.push(null);for(let o=0;o<n.length;o++)i.header.push({text:n[o],tokens:this.lexer.inline(n[o]),header:!0,align:i.align[o]});for(const o of s)i.rows.push(kW(o,i.header.length).map((l,c)=>({text:l,tokens:this.lexer.inline(l),header:!1,align:i.align[c]})));return i}}lheading(e){const t=this.rules.block.lheading.exec(e);if(t)return{type:"heading",raw:t[0],depth:t[2].charAt(0)==="="?1:2,text:t[1],tokens:this.lexer.inline(t[1])}}paragraph(e){const t=this.rules.block.paragraph.exec(e);if(t){const n=t[1].charAt(t[1].length-1)===`
`?t[1].slice(0,-1):t[1];return{type:"paragraph",raw:t[0],text:n,tokens:this.lexer.inline(n)}}}text(e){const t=this.rules.block.text.exec(e);if(t)return{type:"text",raw:t[0],text:t[0],tokens:this.lexer.inline(t[0])}}escape(e){const t=this.rules.inline.escape.exec(e);if(t)return{type:"escape",raw:t[0],text:t[1]}}tag(e){const t=this.rules.inline.tag.exec(e);if(t)return!this.lexer.state.inLink&&this.rules.other.startATag.test(t[0])?this.lexer.state.inLink=!0:this.lexer.state.inLink&&this.rules.other.endATag.test(t[0])&&(this.lexer.state.inLink=!1),!this.lexer.state.inRawBlock&&this.rules.other.startPreScriptTag.test(t[0])?this.lexer.state.inRawBlock=!0:this.lexer.state.inRawBlock&&this.rules.other.endPreScriptTag.test(t[0])&&(this.lexer.state.inRawBlock=!1),{type:"html",raw:t[0],inLink:this.lexer.state.inLink,inRawBlock:this.lexer.state.inRawBlock,block:!1,text:t[0]}}link(e){const t=this.rules.inline.link.exec(e);if(t){const n=t[2].trim();if(!this.options.pedantic&&this.rules.other.startAngleBracket.test(n)){if(!this.rules.other.endAngleBracket.test(n))return;const i=sx(n.slice(0,-1),"\\");if((n.length-i.length)%2===0)return}else{const i=Cat(t[2],"()");if(i===-2)return;if(i>-1){const o=(t[0].indexOf("!")===0?5:4)+t[1].length+i;t[2]=t[2].substring(0,i),t[0]=t[0].substring(0,o).trim(),t[3]=""}}let r=t[2],s="";if(this.options.pedantic){const i=this.rules.other.pedanticHrefTitle.exec(r);i&&(r=i[1],s=i[3])}else s=t[3]?t[3].slice(1,-1):"";return r=r.trim(),this.rules.other.startAngleBracket.test(r)&&(this.options.pedantic&&!this.rules.other.endAngleBracket.test(n)?r=r.slice(1):r=r.slice(1,-1)),EW(t,{href:r&&r.replace(this.rules.inline.anyPunctuation,"$1"),title:s&&s.replace(this.rules.inline.anyPunctuation,"$1")},t[0],this.lexer,this.rules)}}reflink(e,t){let n;if((n=this.rules.inline.reflink.exec(e))||(n=this.rules.inline.nolink.exec(e))){const r=(n[2]||n[1]).replace(this.rules.other.multipleSpaceGlobal," "),s=t[r.toLowerCase()];if(!s){const i=n[0].charAt(0);return{type:"text",raw:i,text:i}}return EW(n,s,n[0],this.lexer,this.rules)}}emStrong(e,t,n=""){let r=this.rules.inline.emStrongLDelim.exec(e);if(!r||r[3]&&n.match(this.rules.other.unicodeAlphaNumeric))return;if(!(r[1]||r[2]||"")||!n||this.rules.inline.punctuation.exec(n)){const i=[...r[0]].length-1;let a,o,l=i,c=0;const u=r[0][0]==="*"?this.rules.inline.emStrongRDelimAst:this.rules.inline.emStrongRDelimUnd;for(u.lastIndex=0,t=t.slice(-1*e.length+i);(r=u.exec(t))!=null;){if(a=r[1]||r[2]||r[3]||r[4]||r[5]||r[6],!a)continue;if(o=[...a].length,r[3]||r[4]){l+=o;continue}else if((r[5]||r[6])&&i%3&&!((i+o)%3)){c+=o;continue}if(l-=o,l>0)continue;o=Math.min(o,o+l+c);const d=[...r[0]][0].length,h=e.slice(0,i+r.index+d+o);if(Math.min(i,o)%2){const y=h.slice(1,-1);return{type:"em",raw:h,text:y,tokens:this.lexer.inlineTokens(y)}}const m=h.slice(2,-2);return{type:"strong",raw:h,text:m,tokens:this.lexer.inlineTokens(m)}}}}codespan(e){const t=this.rules.inline.code.exec(e);if(t){let n=t[2].replace(this.rules.other.newLineCharGlobal," ");const r=this.rules.other.nonSpaceChar.test(n),s=this.rules.other.startingSpaceChar.test(n)&&this.rules.other.endingSpaceChar.test(n);return r&&s&&(n=n.substring(1,n.length-1)),{type:"codespan",raw:t[0],text:n}}}br(e){const t=this.rules.inline.br.exec(e);if(t)return{type:"br",raw:t[0]}}del(e){const t=this.rules.inline.del.exec(e);if(t)return{type:"del",raw:t[0],text:t[2],tokens:this.lexer.inlineTokens(t[2])}}autolink(e){const t=this.rules.inline.autolink.exec(e);if(t){let n,r;return t[2]==="@"?(n=t[1],r="mailto:"+n):(n=t[1],r=n),{type:"link",raw:t[0],text:n,href:r,tokens:[{type:"text",raw:n,text:n}]}}}url(e){var n;let t;if(t=this.rules.inline.url.exec(e)){let r,s;if(t[2]==="@")r=t[0],s="mailto:"+r;else{let i;do i=t[0],t[0]=((n=this.rules.inline._backpedal.exec(t[0]))==null?void 0:n[0])??"";while(i!==t[0]);r=t[0],t[1]==="www."?s="http://"+t[0]:s=t[0]}return{type:"link",raw:t[0],text:r,href:s,tokens:[{type:"text",raw:r,text:r}]}}}inlineText(e){const t=this.rules.inline.text.exec(e);if(t){const n=this.lexer.state.inRawBlock;return{type:"text",raw:t[0],text:t[0],escaped:n}}}},Dd=class EP{constructor(t){ue(this,"tokens");ue(this,"options");ue(this,"state");ue(this,"tokenizer");ue(this,"inlineQueue");this.tokens=[],this.tokens.links=Object.create(null),this.options=t||dg,this.options.tokenizer=this.options.tokenizer||new uE,this.tokenizer=this.options.tokenizer,this.tokenizer.options=this.options,this.tokenizer.lexer=this,this.inlineQueue=[],this.state={inLink:!1,inRawBlock:!1,top:!0};const n={other:io,block:AC.normal,inline:rx.normal};this.options.pedantic?(n.block=AC.pedantic,n.inline=rx.pedantic):this.options.gfm&&(n.block=AC.gfm,this.options.breaks?n.inline=rx.breaks:n.inline=rx.gfm),this.tokenizer.rules=n}static get rules(){return{block:AC,inline:rx}}static lex(t,n){return new EP(n).lex(t)}static lexInline(t,n){return new EP(n).inlineTokens(t)}lex(t){t=t.replace(io.carriageReturn,`
`),this.blockTokens(t,this.tokens);for(let n=0;n<this.inlineQueue.length;n++){const r=this.inlineQueue[n];this.inlineTokens(r.src,r.tokens)}return this.inlineQueue=[],this.tokens}blockTokens(t,n=[],r=!1){var s,i,a;for(this.options.pedantic&&(t=t.replace(io.tabCharGlobal,"    ").replace(io.spaceLine,""));t;){let o;if((i=(s=this.options.extensions)==null?void 0:s.block)!=null&&i.some(c=>(o=c.call({lexer:this},t,n))?(t=t.substring(o.raw.length),n.push(o),!0):!1))continue;if(o=this.tokenizer.space(t)){t=t.substring(o.raw.length);const c=n.at(-1);o.raw.length===1&&c!==void 0?c.raw+=`
`:n.push(o);continue}if(o=this.tokenizer.code(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.at(-1).src=c.text):n.push(o);continue}if(o=this.tokenizer.fences(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.heading(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.hr(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.blockquote(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.list(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.html(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.def(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="paragraph"||(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.raw,this.inlineQueue.at(-1).src=c.text):this.tokens.links[o.tag]||(this.tokens.links[o.tag]={href:o.href,title:o.title});continue}if(o=this.tokenizer.table(t)){t=t.substring(o.raw.length),n.push(o);continue}if(o=this.tokenizer.lheading(t)){t=t.substring(o.raw.length),n.push(o);continue}let l=t;if((a=this.options.extensions)!=null&&a.startBlock){let c=1/0;const u=t.slice(1);let d;this.options.extensions.startBlock.forEach(h=>{d=h.call({lexer:this},u),typeof d=="number"&&d>=0&&(c=Math.min(c,d))}),c<1/0&&c>=0&&(l=t.substring(0,c+1))}if(this.state.top&&(o=this.tokenizer.paragraph(l))){const c=n.at(-1);r&&(c==null?void 0:c.type)==="paragraph"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(o),r=l.length!==t.length,t=t.substring(o.raw.length);continue}if(o=this.tokenizer.text(t)){t=t.substring(o.raw.length);const c=n.at(-1);(c==null?void 0:c.type)==="text"?(c.raw+=`
`+o.raw,c.text+=`
`+o.text,this.inlineQueue.pop(),this.inlineQueue.at(-1).src=c.text):n.push(o);continue}if(t){const c="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(c);break}else throw new Error(c)}}return this.state.top=!0,n}inline(t,n=[]){return this.inlineQueue.push({src:t,tokens:n}),n}inlineTokens(t,n=[]){var o,l,c;let r=t,s=null;if(this.tokens.links){const u=Object.keys(this.tokens.links);if(u.length>0)for(;(s=this.tokenizer.rules.inline.reflinkSearch.exec(r))!=null;)u.includes(s[0].slice(s[0].lastIndexOf("[")+1,-1))&&(r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.reflinkSearch.lastIndex))}for(;(s=this.tokenizer.rules.inline.anyPunctuation.exec(r))!=null;)r=r.slice(0,s.index)+"++"+r.slice(this.tokenizer.rules.inline.anyPunctuation.lastIndex);for(;(s=this.tokenizer.rules.inline.blockSkip.exec(r))!=null;)r=r.slice(0,s.index)+"["+"a".repeat(s[0].length-2)+"]"+r.slice(this.tokenizer.rules.inline.blockSkip.lastIndex);let i=!1,a="";for(;t;){i||(a=""),i=!1;let u;if((l=(o=this.options.extensions)==null?void 0:o.inline)!=null&&l.some(h=>(u=h.call({lexer:this},t,n))?(t=t.substring(u.raw.length),n.push(u),!0):!1))continue;if(u=this.tokenizer.escape(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.tag(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.link(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.reflink(t,this.tokens.links)){t=t.substring(u.raw.length);const h=n.at(-1);u.type==="text"&&(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(u=this.tokenizer.emStrong(t,r,a)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.codespan(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.br(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.del(t)){t=t.substring(u.raw.length),n.push(u);continue}if(u=this.tokenizer.autolink(t)){t=t.substring(u.raw.length),n.push(u);continue}if(!this.state.inLink&&(u=this.tokenizer.url(t))){t=t.substring(u.raw.length),n.push(u);continue}let d=t;if((c=this.options.extensions)!=null&&c.startInline){let h=1/0;const m=t.slice(1);let y;this.options.extensions.startInline.forEach(b=>{y=b.call({lexer:this},m),typeof y=="number"&&y>=0&&(h=Math.min(h,y))}),h<1/0&&h>=0&&(d=t.substring(0,h+1))}if(u=this.tokenizer.inlineText(d)){t=t.substring(u.raw.length),u.raw.slice(-1)!=="_"&&(a=u.raw.slice(-1)),i=!0;const h=n.at(-1);(h==null?void 0:h.type)==="text"?(h.raw+=u.raw,h.text+=u.text):n.push(u);continue}if(t){const h="Infinite loop on byte: "+t.charCodeAt(0);if(this.options.silent){console.error(h);break}else throw new Error(h)}}return n}},dE=class{constructor(e){ue(this,"options");ue(this,"parser");this.options=e||dg}space(e){return""}code({text:e,lang:t,escaped:n}){var i;const r=(i=(t||"").match(io.notSpaceStart))==null?void 0:i[0],s=e.replace(io.endingNewline,"")+`
`;return r?'<pre><code class="language-'+cu(r)+'">'+(n?s:cu(s,!0))+`</code></pre>
`:"<pre><code>"+(n?s:cu(s,!0))+`</code></pre>
`}blockquote({tokens:e}){return`<blockquote>
${this.parser.parse(e)}</blockquote>
`}html({text:e}){return e}heading({tokens:e,depth:t}){return`<h${t}>${this.parser.parseInline(e)}</h${t}>
`}hr(e){return`<hr>
`}list(e){const t=e.ordered,n=e.start;let r="";for(let a=0;a<e.items.length;a++){const o=e.items[a];r+=this.listitem(o)}const s=t?"ol":"ul",i=t&&n!==1?' start="'+n+'"':"";return"<"+s+i+`>
`+r+"</"+s+`>
`}listitem(e){var n;let t="";if(e.task){const r=this.checkbox({checked:!!e.checked});e.loose?((n=e.tokens[0])==null?void 0:n.type)==="paragraph"?(e.tokens[0].text=r+" "+e.tokens[0].text,e.tokens[0].tokens&&e.tokens[0].tokens.length>0&&e.tokens[0].tokens[0].type==="text"&&(e.tokens[0].tokens[0].text=r+" "+cu(e.tokens[0].tokens[0].text),e.tokens[0].tokens[0].escaped=!0)):e.tokens.unshift({type:"text",raw:r+" ",text:r+" ",escaped:!0}):t+=r+" "}return t+=this.parser.parse(e.tokens,!!e.loose),`<li>${t}</li>
`}checkbox({checked:e}){return"<input "+(e?'checked="" ':"")+'disabled="" type="checkbox">'}paragraph({tokens:e}){return`<p>${this.parser.parseInline(e)}</p>
`}table(e){let t="",n="";for(let s=0;s<e.header.length;s++)n+=this.tablecell(e.header[s]);t+=this.tablerow({text:n});let r="";for(let s=0;s<e.rows.length;s++){const i=e.rows[s];n="";for(let a=0;a<i.length;a++)n+=this.tablecell(i[a]);r+=this.tablerow({text:n})}return r&&(r=`<tbody>${r}</tbody>`),`<table>
<thead>
`+t+`</thead>
`+r+`</table>
`}tablerow({text:e}){return`<tr>
${e}</tr>
`}tablecell(e){const t=this.parser.parseInline(e.tokens),n=e.header?"th":"td";return(e.align?`<${n} align="${e.align}">`:`<${n}>`)+t+`</${n}>
`}strong({tokens:e}){return`<strong>${this.parser.parseInline(e)}</strong>`}em({tokens:e}){return`<em>${this.parser.parseInline(e)}</em>`}codespan({text:e}){return`<code>${cu(e,!0)}</code>`}br(e){return"<br>"}del({tokens:e}){return`<del>${this.parser.parseInline(e)}</del>`}link({href:e,title:t,tokens:n}){const r=this.parser.parseInline(n),s=CW(e);if(s===null)return r;e=s;let i='<a href="'+e+'"';return t&&(i+=' title="'+cu(t)+'"'),i+=">"+r+"</a>",i}image({href:e,title:t,text:n,tokens:r}){r&&(n=this.parser.parseInline(r,this.parser.textRenderer));const s=CW(e);if(s===null)return cu(n);e=s;let i=`<img src="${e}" alt="${n}"`;return t&&(i+=` title="${cu(t)}"`),i+=">",i}text(e){return"tokens"in e&&e.tokens?this.parser.parseInline(e.tokens):"escaped"in e&&e.escaped?e.text:cu(e.text)}},l5=class{strong({text:e}){return e}em({text:e}){return e}codespan({text:e}){return e}del({text:e}){return e}html({text:e}){return e}text({text:e}){return e}link({text:e}){return""+e}image({text:e}){return""+e}br(){return""}},Fd=class TP{constructor(t){ue(this,"options");ue(this,"renderer");ue(this,"textRenderer");this.options=t||dg,this.options.renderer=this.options.renderer||new dE,this.renderer=this.options.renderer,this.renderer.options=this.options,this.renderer.parser=this,this.textRenderer=new l5}static parse(t,n){return new TP(n).parse(t)}static parseInline(t,n){return new TP(n).parseInline(t)}parse(t,n=!0){var s,i;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const c=o,u=this.options.extensions.renderers[c.type].call({parser:this},c);if(u!==!1||!["space","hr","heading","code","table","blockquote","list","html","paragraph","text"].includes(c.type)){r+=u||"";continue}}const l=o;switch(l.type){case"space":{r+=this.renderer.space(l);continue}case"hr":{r+=this.renderer.hr(l);continue}case"heading":{r+=this.renderer.heading(l);continue}case"code":{r+=this.renderer.code(l);continue}case"table":{r+=this.renderer.table(l);continue}case"blockquote":{r+=this.renderer.blockquote(l);continue}case"list":{r+=this.renderer.list(l);continue}case"html":{r+=this.renderer.html(l);continue}case"paragraph":{r+=this.renderer.paragraph(l);continue}case"text":{let c=l,u=this.renderer.text(c);for(;a+1<t.length&&t[a+1].type==="text";)c=t[++a],u+=`
`+this.renderer.text(c);n?r+=this.renderer.paragraph({type:"paragraph",raw:u,text:u,tokens:[{type:"text",raw:u,text:u,escaped:!0}]}):r+=u;continue}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}parseInline(t,n=this.renderer){var s,i;let r="";for(let a=0;a<t.length;a++){const o=t[a];if((i=(s=this.options.extensions)==null?void 0:s.renderers)!=null&&i[o.type]){const c=this.options.extensions.renderers[o.type].call({parser:this},o);if(c!==!1||!["escape","html","link","image","strong","em","codespan","br","del","text"].includes(o.type)){r+=c||"";continue}}const l=o;switch(l.type){case"escape":{r+=n.text(l);break}case"html":{r+=n.html(l);break}case"link":{r+=n.link(l);break}case"image":{r+=n.image(l);break}case"strong":{r+=n.strong(l);break}case"em":{r+=n.em(l);break}case"codespan":{r+=n.codespan(l);break}case"br":{r+=n.br(l);break}case"del":{r+=n.del(l);break}case"text":{r+=n.text(l);break}default:{const c='Token with "'+l.type+'" type was not found.';if(this.options.silent)return console.error(c),"";throw new Error(c)}}}return r}},Y3,a2=(Y3=class{constructor(e){ue(this,"options");ue(this,"block");this.options=e||dg}preprocess(e){return e}postprocess(e){return e}processAllTokens(e){return e}provideLexer(){return this.block?Dd.lex:Dd.lexInline}provideParser(){return this.block?Fd.parse:Fd.parseInline}},ue(Y3,"passThroughHooks",new Set(["preprocess","postprocess","processAllTokens"])),Y3),Eat=class{constructor(...e){ue(this,"defaults",e5());ue(this,"options",this.setOptions);ue(this,"parse",this.parseMarkdown(!0));ue(this,"parseInline",this.parseMarkdown(!1));ue(this,"Parser",Fd);ue(this,"Renderer",dE);ue(this,"TextRenderer",l5);ue(this,"Lexer",Dd);ue(this,"Tokenizer",uE);ue(this,"Hooks",a2);this.use(...e)}walkTokens(e,t){var r,s;let n=[];for(const i of e)switch(n=n.concat(t.call(this,i)),i.type){case"table":{const a=i;for(const o of a.header)n=n.concat(this.walkTokens(o.tokens,t));for(const o of a.rows)for(const l of o)n=n.concat(this.walkTokens(l.tokens,t));break}case"list":{const a=i;n=n.concat(this.walkTokens(a.items,t));break}default:{const a=i;(s=(r=this.defaults.extensions)==null?void 0:r.childTokens)!=null&&s[a.type]?this.defaults.extensions.childTokens[a.type].forEach(o=>{const l=a[o].flat(1/0);n=n.concat(this.walkTokens(l,t))}):a.tokens&&(n=n.concat(this.walkTokens(a.tokens,t)))}}return n}use(...e){const t=this.defaults.extensions||{renderers:{},childTokens:{}};return e.forEach(n=>{const r={...n};if(r.async=this.defaults.async||r.async||!1,n.extensions&&(n.extensions.forEach(s=>{if(!s.name)throw new Error("extension name required");if("renderer"in s){const i=t.renderers[s.name];i?t.renderers[s.name]=function(...a){let o=s.renderer.apply(this,a);return o===!1&&(o=i.apply(this,a)),o}:t.renderers[s.name]=s.renderer}if("tokenizer"in s){if(!s.level||s.level!=="block"&&s.level!=="inline")throw new Error("extension level must be 'block' or 'inline'");const i=t[s.level];i?i.unshift(s.tokenizer):t[s.level]=[s.tokenizer],s.start&&(s.level==="block"?t.startBlock?t.startBlock.push(s.start):t.startBlock=[s.start]:s.level==="inline"&&(t.startInline?t.startInline.push(s.start):t.startInline=[s.start]))}"childTokens"in s&&s.childTokens&&(t.childTokens[s.name]=s.childTokens)}),r.extensions=t),n.renderer){const s=this.defaults.renderer||new dE(this.defaults);for(const i in n.renderer){if(!(i in s))throw new Error(`renderer '${i}' does not exist`);if(["options","parser"].includes(i))continue;const a=i,o=n.renderer[a],l=s[a];s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u||""}}r.renderer=s}if(n.tokenizer){const s=this.defaults.tokenizer||new uE(this.defaults);for(const i in n.tokenizer){if(!(i in s))throw new Error(`tokenizer '${i}' does not exist`);if(["options","rules","lexer"].includes(i))continue;const a=i,o=n.tokenizer[a],l=s[a];s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u}}r.tokenizer=s}if(n.hooks){const s=this.defaults.hooks||new a2;for(const i in n.hooks){if(!(i in s))throw new Error(`hook '${i}' does not exist`);if(["options","block"].includes(i))continue;const a=i,o=n.hooks[a],l=s[a];a2.passThroughHooks.has(i)?s[a]=c=>{if(this.defaults.async)return Promise.resolve(o.call(s,c)).then(d=>l.call(s,d));const u=o.call(s,c);return l.call(s,u)}:s[a]=(...c)=>{let u=o.apply(s,c);return u===!1&&(u=l.apply(s,c)),u}}r.hooks=s}if(n.walkTokens){const s=this.defaults.walkTokens,i=n.walkTokens;r.walkTokens=function(a){let o=[];return o.push(i.call(this,a)),s&&(o=o.concat(s.call(this,a))),o}}this.defaults={...this.defaults,...r}}),this}setOptions(e){return this.defaults={...this.defaults,...e},this}lexer(e,t){return Dd.lex(e,t??this.defaults)}parser(e,t){return Fd.parse(e,t??this.defaults)}parseMarkdown(e){return(n,r)=>{const s={...r},i={...this.defaults,...s},a=this.onError(!!i.silent,!!i.async);if(this.defaults.async===!0&&s.async===!1)return a(new Error("marked(): The async option was set to true by an extension. Remove async: false from the parse options object to return a Promise."));if(typeof n>"u"||n===null)return a(new Error("marked(): input parameter is undefined or null"));if(typeof n!="string")return a(new Error("marked(): input parameter is of type "+Object.prototype.toString.call(n)+", string expected"));i.hooks&&(i.hooks.options=i,i.hooks.block=e);const o=i.hooks?i.hooks.provideLexer():e?Dd.lex:Dd.lexInline,l=i.hooks?i.hooks.provideParser():e?Fd.parse:Fd.parseInline;if(i.async)return Promise.resolve(i.hooks?i.hooks.preprocess(n):n).then(c=>o(c,i)).then(c=>i.hooks?i.hooks.processAllTokens(c):c).then(c=>i.walkTokens?Promise.all(this.walkTokens(c,i.walkTokens)).then(()=>c):c).then(c=>l(c,i)).then(c=>i.hooks?i.hooks.postprocess(c):c).catch(a);try{i.hooks&&(n=i.hooks.preprocess(n));let c=o(n,i);i.hooks&&(c=i.hooks.processAllTokens(c)),i.walkTokens&&this.walkTokens(c,i.walkTokens);let u=l(c,i);return i.hooks&&(u=i.hooks.postprocess(u)),u}catch(c){return a(c)}}}onError(e,t){return n=>{if(n.message+=`
Please report this to https://github.com/markedjs/marked.`,e){const r="<p>An error occurred:</p><pre>"+cu(n.message+"",!0)+"</pre>";return t?Promise.resolve(r):r}if(t)return Promise.reject(n);throw n}}},qm=new Eat;function fs(e,t){return qm.parse(e,t)}fs.options=fs.setOptions=function(e){return qm.setOptions(e),fs.defaults=qm.defaults,oce(fs.defaults),fs};fs.getDefaults=e5;fs.defaults=dg;fs.use=function(...e){return qm.use(...e),fs.defaults=qm.defaults,oce(fs.defaults),fs};fs.walkTokens=function(e,t){return qm.walkTokens(e,t)};fs.parseInline=qm.parseInline;fs.Parser=Fd;fs.parser=Fd.parse;fs.Renderer=dE;fs.TextRenderer=l5;fs.Lexer=Dd;fs.lexer=Dd.lex;fs.Tokenizer=uE;fs.Hooks=a2;fs.parse=fs;fs.options;fs.setOptions;fs.use;fs.walkTokens;fs.parseInline;Fd.parse;Dd.lex;function bce(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=Array.from(typeof e=="string"?[e]:e);r[r.length-1]=r[r.length-1].replace(/\r?\n([\t ]*)$/,"");var s=r.reduce(function(o,l){var c=l.match(/\n([\t ]+|(?!\s).)/g);return c?o.concat(c.map(function(u){var d,h;return(h=(d=u.match(/[\t ]/g))===null||d===void 0?void 0:d.length)!==null&&h!==void 0?h:0})):o},[]);if(s.length){var i=new RegExp(`
[	 ]{`+Math.min.apply(Math,s)+"}","g");r=r.map(function(o){return o.replace(i,`
`)})}r[0]=r[0].replace(/^\r?\n/,"");var a=r[0];return t.forEach(function(o,l){var c=a.match(/(?:^|\n)( *)$/),u=c?c[1]:"",d=o;typeof o=="string"&&o.includes(`
`)&&(d=String(o).split(`
`).map(function(h,m){return m===0?h:""+u+h}).join(`
`)),a+=d+r[l+1]}),a}function vce(e,{markdownAutoWrap:t}){const r=e.replace(/<br\/>/g,`
`).replace(/\n{2,}/g,`
`),s=bce(r);return t===!1?s.replace(/ /g,"&nbsp;"):s}ie(vce,"preprocessMarkdown");function xce(e,t={}){const n=vce(e,t),r=fs.lexer(n),s=[[]];let i=0;function a(o,l="normal"){o.type==="text"?o.text.split(`
`).forEach((u,d)=>{d!==0&&(i++,s.push([])),u.split(" ").forEach(h=>{h=h.replace(/&#39;/g,"'"),h&&s[i].push({content:h,type:l})})}):o.type==="strong"||o.type==="em"?o.tokens.forEach(c=>{a(c,o.type)}):o.type==="html"&&s[i].push({content:o.text,type:"normal"})}return ie(a,"processNode"),r.forEach(o=>{var l;o.type==="paragraph"?(l=o.tokens)==null||l.forEach(c=>{a(c)}):o.type==="html"&&s[i].push({content:o.text,type:"normal"})}),s}ie(xce,"markdownToLines");function wce(e,{markdownAutoWrap:t}={}){const n=fs.lexer(e);function r(s){var i,a,o;return s.type==="text"?t===!1?s.text.replace(/\n */g,"<br/>").replace(/ /g,"&nbsp;"):s.text.replace(/\n */g,"<br/>"):s.type==="strong"?`<strong>${(i=s.tokens)==null?void 0:i.map(r).join("")}</strong>`:s.type==="em"?`<em>${(a=s.tokens)==null?void 0:a.map(r).join("")}</em>`:s.type==="paragraph"?`<p>${(o=s.tokens)==null?void 0:o.map(r).join("")}</p>`:s.type==="space"?"":s.type==="html"?`${s.text}`:s.type==="escape"?s.text:`Unsupported markdown: ${s.type}`}return ie(r,"output"),n.map(r).join("")}ie(wce,"markdownToHTML");function _ce(e){return Intl.Segmenter?[...new Intl.Segmenter().segment(e)].map(t=>t.segment):[...e]}ie(_ce,"splitTextToChars");function Sce(e,t){const n=_ce(t.content);return c5(e,[],n,t.type)}ie(Sce,"splitWordToFitWidth");function c5(e,t,n,r){if(n.length===0)return[{content:t.join(""),type:r},{content:"",type:r}];const[s,...i]=n,a=[...t,s];return e([{content:a.join(""),type:r}])?c5(e,a,i,r):(t.length===0&&s&&(t.push(s),n.shift()),[{content:t.join(""),type:r},{content:n.join(""),type:r}])}ie(c5,"splitWordToFitWidthRecursion");function Cce(e,t){if(e.some(({content:n})=>n.includes(`
`)))throw new Error("splitLineToFitWidth does not support newlines in the line");return fE(e,t)}ie(Cce,"splitLineToFitWidth");function fE(e,t,n=[],r=[]){if(e.length===0)return r.length>0&&n.push(r),n.length>0?n:[];let s="";e[0].content===" "&&(s=" ",e.shift());const i=e.shift()??{content:" ",type:"normal"},a=[...r];if(s!==""&&a.push({content:s,type:"normal"}),a.push(i),t(a))return fE(e,t,n,a);if(r.length>0)n.push(r),e.unshift(i);else if(i.content){const[o,l]=Sce(t,i);n.push([o]),l.content&&e.unshift(l)}return fE(e,t,n)}ie(fE,"splitLineToFitWidthRecursion");function AP(e,t){t&&e.attr("style",t)}ie(AP,"applyStyle");async function kce(e,t,n,r,s=!1){const i=e.append("foreignObject");i.attr("width",`${10*n}px`),i.attr("height",`${10*n}px`);const a=i.append("xhtml:div");let o=t.label;t.label&&Dy(t.label)&&(o=await b6(t.label.replace(Eb.lineBreakRegex,`
`),ls()));const l=t.isNode?"nodeLabel":"edgeLabel",c=a.append("span");c.html(o),AP(c,t.labelStyle),c.attr("class",`${l} ${r}`),AP(a,t.labelStyle),a.style("display","table-cell"),a.style("white-space","nowrap"),a.style("line-height","1.5"),a.style("max-width",n+"px"),a.style("text-align","center"),a.attr("xmlns","http://www.w3.org/1999/xhtml"),s&&a.attr("class","labelBkg");let u=a.node().getBoundingClientRect();return u.width===n&&(a.style("display","table"),a.style("white-space","break-spaces"),a.style("width",n+"px"),u=a.node().getBoundingClientRect()),i.node()}ie(kce,"addHtmlSpan");function _A(e,t,n){return e.append("tspan").attr("class","text-outer-tspan").attr("x",0).attr("y",t*n-.1+"em").attr("dy",n+"em")}ie(_A,"createTspan");function Ece(e,t,n){const r=e.append("text"),s=_A(r,1,t);SA(s,n);const i=s.node().getComputedTextLength();return r.remove(),i}ie(Ece,"computeWidthOfText");function Tat(e,t,n){var a;const r=e.append("text"),s=_A(r,1,t);SA(s,[{content:n,type:"normal"}]);const i=(a=s.node())==null?void 0:a.getBoundingClientRect();return i&&r.remove(),i}ie(Tat,"computeDimensionOfText");function Tce(e,t,n,r=!1){const i=t.append("g"),a=i.insert("rect").attr("class","background").attr("style","stroke: none"),o=i.append("text").attr("y","-10.1");let l=0;for(const c of n){const u=ie(h=>Ece(i,1.1,h)<=e,"checkWidth"),d=u(c)?[c]:Cce(c,u);for(const h of d){const m=_A(o,l,1.1);SA(m,h),l++}}if(r){const c=o.node().getBBox(),u=2;return a.attr("x",c.x-u).attr("y",c.y-u).attr("width",c.width+2*u).attr("height",c.height+2*u),i.node()}else return o.node()}ie(Tce,"createFormattedText");function SA(e,t){e.text(""),t.forEach((n,r)=>{const s=e.append("tspan").attr("font-style",n.type==="em"?"italic":"normal").attr("class","text-inner-tspan").attr("font-weight",n.type==="strong"?"bold":"normal");r===0?s.text(n.content):s.text(" "+n.content)})}ie(SA,"updateTextContentAndStyles");function Ace(e){return e.replace(/fa[bklrs]?:fa-[\w-]+/g,t=>`<i class='${t.replace(":"," ")}'></i>`)}ie(Ace,"replaceIconSubstring");var bp=ie(async(e,t="",{style:n="",isTitle:r=!1,classes:s="",useHtmlLabels:i=!0,isNode:a=!0,width:o=200,addSvgBackground:l=!1}={},c)=>{if(Ut.debug("XYZ createText",t,n,r,s,i,a,"addSvgBackground: ",l),i){const u=wce(t,c),d=Ace(ug(u)),h=t.replace(/\\\\/g,"\\"),m={isNode:a,label:Dy(t)?h:d,labelStyle:n.replace("fill:","color:")};return await kce(e,m,o,s,l)}else{const u=t.replace(/<br\s*\/?>/g,"<br/>"),d=xce(u.replace("<br>","<br/>"),c),h=Tce(o,e,d,t?l:!1);if(a){/stroke:/.exec(n)&&(n=n.replace("stroke:","lineColor:"));const m=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");Zr(h).attr("style",m)}else{const m=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/background:/g,"fill:");Zr(h).select("rect").attr("style",m.replace(/background:/g,"fill:"));const y=n.replace(/stroke:[^;]+;?/g,"").replace(/stroke-width:[^;]+;?/g,"").replace(/fill:[^;]+;?/g,"").replace(/color:/g,"fill:");Zr(h).select("text").attr("style",y)}return h}},"createText");function z3(e,t,n){if(e&&e.length){const[r,s]=t,i=Math.PI/180*n,a=Math.cos(i),o=Math.sin(i);for(const l of e){const[c,u]=l;l[0]=(c-r)*a-(u-s)*o+r,l[1]=(c-r)*o+(u-s)*a+s}}}function Aat(e,t){return e[0]===t[0]&&e[1]===t[1]}function Rat(e,t,n,r=1){const s=n,i=Math.max(t,.1),a=e[0]&&e[0][0]&&typeof e[0][0]=="number"?[e]:e,o=[0,0];if(s)for(const c of a)z3(c,o,s);const l=function(c,u,d){const h=[];for(const w of c){const S=[...w];Aat(S[0],S[S.length-1])||S.push([S[0][0],S[0][1]]),S.length>2&&h.push(S)}const m=[];u=Math.max(u,.1);const y=[];for(const w of h)for(let S=0;S<w.length-1;S++){const k=w[S],C=w[S+1];if(k[1]!==C[1]){const T=Math.min(k[1],C[1]);y.push({ymin:T,ymax:Math.max(k[1],C[1]),x:T===k[1]?k[0]:C[0],islope:(C[0]-k[0])/(C[1]-k[1])})}}if(y.sort((w,S)=>w.ymin<S.ymin?-1:w.ymin>S.ymin?1:w.x<S.x?-1:w.x>S.x?1:w.ymax===S.ymax?0:(w.ymax-S.ymax)/Math.abs(w.ymax-S.ymax)),!y.length)return m;let b=[],v=y[0].ymin,x=0;for(;b.length||y.length;){if(y.length){let w=-1;for(let S=0;S<y.length&&!(y[S].ymin>v);S++)w=S;y.splice(0,w+1).forEach(S=>{b.push({s:v,edge:S})})}if(b=b.filter(w=>!(w.edge.ymax<=v)),b.sort((w,S)=>w.edge.x===S.edge.x?0:(w.edge.x-S.edge.x)/Math.abs(w.edge.x-S.edge.x)),(d!==1||x%u==0)&&b.length>1)for(let w=0;w<b.length;w+=2){const S=w+1;if(S>=b.length)break;const k=b[w].edge,C=b[S].edge;m.push([[Math.round(k.x),v],[Math.round(C.x),v]])}v+=d,b.forEach(w=>{w.edge.x=w.edge.x+d*w.edge.islope}),x++}return m}(a,i,r);if(s){for(const c of a)z3(c,o,-s);(function(c,u,d){const h=[];c.forEach(m=>h.push(...m)),z3(h,u,d)})(l,o,-s)}return l}function __(e,t){var n;const r=t.hachureAngle+90;let s=t.hachureGap;s<0&&(s=4*t.strokeWidth),s=Math.round(Math.max(s,.1));let i=1;return t.roughness>=1&&(((n=t.randomizer)===null||n===void 0?void 0:n.next())||Math.random())>.7&&(i=s),Rat(e,s,r,i||1)}class u5{constructor(t){this.helper=t}fillPolygons(t,n){return this._fillPolygons(t,n)}_fillPolygons(t,n){const r=__(t,n);return{type:"fillSketch",ops:this.renderLines(r,n)}}renderLines(t,n){const r=[];for(const s of t)r.push(...this.helper.doubleLineOps(s[0][0],s[0][1],s[1][0],s[1][1],n));return r}}function CA(e){const t=e[0],n=e[1];return Math.sqrt(Math.pow(t[0]-n[0],2)+Math.pow(t[1]-n[1],2))}class Nat extends u5{fillPolygons(t,n){let r=n.hachureGap;r<0&&(r=4*n.strokeWidth),r=Math.max(r,.1);const s=__(t,Object.assign({},n,{hachureGap:r})),i=Math.PI/180*n.hachureAngle,a=[],o=.5*r*Math.cos(i),l=.5*r*Math.sin(i);for(const[c,u]of s)CA([c,u])&&a.push([[c[0]-o,c[1]+l],[...u]],[[c[0]+o,c[1]-l],[...u]]);return{type:"fillSketch",ops:this.renderLines(a,n)}}}class Mat extends u5{fillPolygons(t,n){const r=this._fillPolygons(t,n),s=Object.assign({},n,{hachureAngle:n.hachureAngle+90}),i=this._fillPolygons(t,s);return r.ops=r.ops.concat(i.ops),r}}class Iat{constructor(t){this.helper=t}fillPolygons(t,n){const r=__(t,n=Object.assign({},n,{hachureAngle:0}));return this.dotsOnLines(r,n)}dotsOnLines(t,n){const r=[];let s=n.hachureGap;s<0&&(s=4*n.strokeWidth),s=Math.max(s,.1);let i=n.fillWeight;i<0&&(i=n.strokeWidth/2);const a=s/4;for(const o of t){const l=CA(o),c=l/s,u=Math.ceil(c)-1,d=l-u*s,h=(o[0][0]+o[1][0])/2-s/4,m=Math.min(o[0][1],o[1][1]);for(let y=0;y<u;y++){const b=m+d+y*s,v=h-a+2*Math.random()*a,x=b-a+2*Math.random()*a,w=this.helper.ellipse(v,x,i,i,n);r.push(...w.ops)}}return{type:"fillSketch",ops:r}}}class jat{constructor(t){this.helper=t}fillPolygons(t,n){const r=__(t,n);return{type:"fillSketch",ops:this.dashedLine(r,n)}}dashedLine(t,n){const r=n.dashOffset<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashOffset,s=n.dashGap<0?n.hachureGap<0?4*n.strokeWidth:n.hachureGap:n.dashGap,i=[];return t.forEach(a=>{const o=CA(a),l=Math.floor(o/(r+s)),c=(o+s-l*(r+s))/2;let u=a[0],d=a[1];u[0]>d[0]&&(u=a[1],d=a[0]);const h=Math.atan((d[1]-u[1])/(d[0]-u[0]));for(let m=0;m<l;m++){const y=m*(r+s),b=y+r,v=[u[0]+y*Math.cos(h)+c*Math.cos(h),u[1]+y*Math.sin(h)+c*Math.sin(h)],x=[u[0]+b*Math.cos(h)+c*Math.cos(h),u[1]+b*Math.sin(h)+c*Math.sin(h)];i.push(...this.helper.doubleLineOps(v[0],v[1],x[0],x[1],n))}}),i}}class Pat{constructor(t){this.helper=t}fillPolygons(t,n){const r=n.hachureGap<0?4*n.strokeWidth:n.hachureGap,s=n.zigzagOffset<0?r:n.zigzagOffset,i=__(t,n=Object.assign({},n,{hachureGap:r+s}));return{type:"fillSketch",ops:this.zigzagLines(i,s,n)}}zigzagLines(t,n,r){const s=[];return t.forEach(i=>{const a=CA(i),o=Math.round(a/(2*n));let l=i[0],c=i[1];l[0]>c[0]&&(l=i[1],c=i[0]);const u=Math.atan((c[1]-l[1])/(c[0]-l[0]));for(let d=0;d<o;d++){const h=2*d*n,m=2*(d+1)*n,y=Math.sqrt(2*Math.pow(n,2)),b=[l[0]+h*Math.cos(u),l[1]+h*Math.sin(u)],v=[l[0]+m*Math.cos(u),l[1]+m*Math.sin(u)],x=[b[0]+y*Math.cos(u+Math.PI/4),b[1]+y*Math.sin(u+Math.PI/4)];s.push(...this.helper.doubleLineOps(b[0],b[1],x[0],x[1],r),...this.helper.doubleLineOps(x[0],x[1],v[0],v[1],r))}}),s}}const ko={};class Oat{constructor(t){this.seed=t}next(){return this.seed?(2**31-1&(this.seed=Math.imul(48271,this.seed)))/2**31:Math.random()}}const Dat=0,U3=1,TW=2,RC={A:7,a:7,C:6,c:6,H:1,h:1,L:2,l:2,M:2,m:2,Q:4,q:4,S:4,s:4,T:2,t:2,V:1,v:1,Z:0,z:0};function q3(e,t){return e.type===t}function d5(e){const t=[],n=function(a){const o=new Array;for(;a!=="";)if(a.match(/^([ \t\r\n,]+)/))a=a.substr(RegExp.$1.length);else if(a.match(/^([aAcChHlLmMqQsStTvVzZ])/))o[o.length]={type:Dat,text:RegExp.$1},a=a.substr(RegExp.$1.length);else{if(!a.match(/^(([-+]?[0-9]+(\.[0-9]*)?|[-+]?\.[0-9]+)([eE][-+]?[0-9]+)?)/))return[];o[o.length]={type:U3,text:`${parseFloat(RegExp.$1)}`},a=a.substr(RegExp.$1.length)}return o[o.length]={type:TW,text:""},o}(e);let r="BOD",s=0,i=n[s];for(;!q3(i,TW);){let a=0;const o=[];if(r==="BOD"){if(i.text!=="M"&&i.text!=="m")return d5("M0,0"+e);s++,a=RC[i.text],r=i.text}else q3(i,U3)?a=RC[r]:(s++,a=RC[i.text],r=i.text);if(!(s+a<n.length))throw new Error("Path data ended short");for(let l=s;l<s+a;l++){const c=n[l];if(!q3(c,U3))throw new Error("Param not a number: "+r+","+c.text);o[o.length]=+c.text}if(typeof RC[r]!="number")throw new Error("Bad segment: "+r);{const l={key:r,data:o};t.push(l),s+=a,i=n[s],r==="M"&&(r="L"),r==="m"&&(r="l")}}return t}function Rce(e){let t=0,n=0,r=0,s=0;const i=[];for(const{key:a,data:o}of e)switch(a){case"M":i.push({key:"M",data:[...o]}),[t,n]=o,[r,s]=o;break;case"m":t+=o[0],n+=o[1],i.push({key:"M",data:[t,n]}),r=t,s=n;break;case"L":i.push({key:"L",data:[...o]}),[t,n]=o;break;case"l":t+=o[0],n+=o[1],i.push({key:"L",data:[t,n]});break;case"C":i.push({key:"C",data:[...o]}),t=o[4],n=o[5];break;case"c":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"C",data:l}),t=l[4],n=l[5];break}case"Q":i.push({key:"Q",data:[...o]}),t=o[2],n=o[3];break;case"q":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"Q",data:l}),t=l[2],n=l[3];break}case"A":i.push({key:"A",data:[...o]}),t=o[5],n=o[6];break;case"a":t+=o[5],n+=o[6],i.push({key:"A",data:[o[0],o[1],o[2],o[3],o[4],t,n]});break;case"H":i.push({key:"H",data:[...o]}),t=o[0];break;case"h":t+=o[0],i.push({key:"H",data:[t]});break;case"V":i.push({key:"V",data:[...o]}),n=o[0];break;case"v":n+=o[0],i.push({key:"V",data:[n]});break;case"S":i.push({key:"S",data:[...o]}),t=o[2],n=o[3];break;case"s":{const l=o.map((c,u)=>u%2?c+n:c+t);i.push({key:"S",data:l}),t=l[2],n=l[3];break}case"T":i.push({key:"T",data:[...o]}),t=o[0],n=o[1];break;case"t":t+=o[0],n+=o[1],i.push({key:"T",data:[t,n]});break;case"Z":case"z":i.push({key:"Z",data:[]}),t=r,n=s}return i}function Nce(e){const t=[];let n="",r=0,s=0,i=0,a=0,o=0,l=0;for(const{key:c,data:u}of e){switch(c){case"M":t.push({key:"M",data:[...u]}),[r,s]=u,[i,a]=u;break;case"C":t.push({key:"C",data:[...u]}),r=u[4],s=u[5],o=u[2],l=u[3];break;case"L":t.push({key:"L",data:[...u]}),[r,s]=u;break;case"H":r=u[0],t.push({key:"L",data:[r,s]});break;case"V":s=u[0],t.push({key:"L",data:[r,s]});break;case"S":{let d=0,h=0;n==="C"||n==="S"?(d=r+(r-o),h=s+(s-l)):(d=r,h=s),t.push({key:"C",data:[d,h,...u]}),o=u[0],l=u[1],r=u[2],s=u[3];break}case"T":{const[d,h]=u;let m=0,y=0;n==="Q"||n==="T"?(m=r+(r-o),y=s+(s-l)):(m=r,y=s);const b=r+2*(m-r)/3,v=s+2*(y-s)/3,x=d+2*(m-d)/3,w=h+2*(y-h)/3;t.push({key:"C",data:[b,v,x,w,d,h]}),o=m,l=y,r=d,s=h;break}case"Q":{const[d,h,m,y]=u,b=r+2*(d-r)/3,v=s+2*(h-s)/3,x=m+2*(d-m)/3,w=y+2*(h-y)/3;t.push({key:"C",data:[b,v,x,w,m,y]}),o=d,l=h,r=m,s=y;break}case"A":{const d=Math.abs(u[0]),h=Math.abs(u[1]),m=u[2],y=u[3],b=u[4],v=u[5],x=u[6];d===0||h===0?(t.push({key:"C",data:[r,s,v,x,v,x]}),r=v,s=x):(r!==v||s!==x)&&(Mce(r,s,v,x,d,h,m,y,b).forEach(function(w){t.push({key:"C",data:w})}),r=v,s=x);break}case"Z":t.push({key:"Z",data:[]}),r=i,s=a}n=c}return t}function ix(e,t,n){return[e*Math.cos(n)-t*Math.sin(n),e*Math.sin(n)+t*Math.cos(n)]}function Mce(e,t,n,r,s,i,a,o,l,c){const u=(d=a,Math.PI*d/180);var d;let h=[],m=0,y=0,b=0,v=0;if(c)[m,y,b,v]=c;else{[e,t]=ix(e,t,-u),[n,r]=ix(n,r,-u);const H=(e-n)/2,P=(t-r)/2;let K=H*H/(s*s)+P*P/(i*i);K>1&&(K=Math.sqrt(K),s*=K,i*=K);const U=s*s,V=i*i,L=U*V-U*P*P-V*H*H,te=U*P*P+V*H*H,W=(o===l?-1:1)*Math.sqrt(Math.abs(L/te));b=W*s*P/i+(e+n)/2,v=W*-i*H/s+(t+r)/2,m=Math.asin(parseFloat(((t-v)/i).toFixed(9))),y=Math.asin(parseFloat(((r-v)/i).toFixed(9))),e<b&&(m=Math.PI-m),n<b&&(y=Math.PI-y),m<0&&(m=2*Math.PI+m),y<0&&(y=2*Math.PI+y),l&&m>y&&(m-=2*Math.PI),!l&&y>m&&(y-=2*Math.PI)}let x=y-m;if(Math.abs(x)>120*Math.PI/180){const H=y,P=n,K=r;y=l&&y>m?m+120*Math.PI/180*1:m+120*Math.PI/180*-1,h=Mce(n=b+s*Math.cos(y),r=v+i*Math.sin(y),P,K,s,i,a,0,l,[y,H,b,v])}x=y-m;const w=Math.cos(m),S=Math.sin(m),k=Math.cos(y),C=Math.sin(y),T=Math.tan(x/4),A=4/3*s*T,N=4/3*i*T,I=[e,t],O=[e+A*S,t-N*w],B=[n+A*C,r-N*k],D=[n,r];if(O[0]=2*I[0]-O[0],O[1]=2*I[1]-O[1],c)return[O,B,D].concat(h);{h=[O,B,D].concat(h);const H=[];for(let P=0;P<h.length;P+=3){const K=ix(h[P][0],h[P][1],u),U=ix(h[P+1][0],h[P+1][1],u),V=ix(h[P+2][0],h[P+2][1],u);H.push([K[0],K[1],U[0],U[1],V[0],V[1]])}return H}}const Fat={randOffset:function(e,t){return nr(e,t)},randOffsetWithRange:function(e,t,n){return hE(e,t,n)},ellipse:function(e,t,n,r,s){const i=jce(n,r,s);return RP(e,t,s,i).opset},doubleLineOps:function(e,t,n,r,s){return Yh(e,t,n,r,s,!0)}};function Ice(e,t,n,r,s){return{type:"path",ops:Yh(e,t,n,r,s)}}function o2(e,t,n){const r=(e||[]).length;if(r>2){const s=[];for(let i=0;i<r-1;i++)s.push(...Yh(e[i][0],e[i][1],e[i+1][0],e[i+1][1],n));return t&&s.push(...Yh(e[r-1][0],e[r-1][1],e[0][0],e[0][1],n)),{type:"path",ops:s}}return r===2?Ice(e[0][0],e[0][1],e[1][0],e[1][1],n):{type:"path",ops:[]}}function Lat(e,t,n,r,s){return function(i,a){return o2(i,!0,a)}([[e,t],[e+n,t],[e+n,t+r],[e,t+r]],s)}function AW(e,t){if(e.length){const n=typeof e[0][0]=="number"?[e]:e,r=NC(n[0],1*(1+.2*t.roughness),t),s=t.disableMultiStroke?[]:NC(n[0],1.5*(1+.22*t.roughness),MW(t));for(let i=1;i<n.length;i++){const a=n[i];if(a.length){const o=NC(a,1*(1+.2*t.roughness),t),l=t.disableMultiStroke?[]:NC(a,1.5*(1+.22*t.roughness),MW(t));for(const c of o)c.op!=="move"&&r.push(c);for(const c of l)c.op!=="move"&&s.push(c)}}return{type:"path",ops:r.concat(s)}}return{type:"path",ops:[]}}function jce(e,t,n){const r=Math.sqrt(2*Math.PI*Math.sqrt((Math.pow(e/2,2)+Math.pow(t/2,2))/2)),s=Math.ceil(Math.max(n.curveStepCount,n.curveStepCount/Math.sqrt(200)*r)),i=2*Math.PI/s;let a=Math.abs(e/2),o=Math.abs(t/2);const l=1-n.curveFitting;return a+=nr(a*l,n),o+=nr(o*l,n),{increment:i,rx:a,ry:o}}function RP(e,t,n,r){const[s,i]=IW(r.increment,e,t,r.rx,r.ry,1,r.increment*hE(.1,hE(.4,1,n),n),n);let a=pE(s,null,n);if(!n.disableMultiStroke&&n.roughness!==0){const[o]=IW(r.increment,e,t,r.rx,r.ry,1.5,0,n),l=pE(o,null,n);a=a.concat(l)}return{estimatedPoints:i,opset:{type:"path",ops:a}}}function RW(e,t,n,r,s,i,a,o,l){const c=e,u=t;let d=Math.abs(n/2),h=Math.abs(r/2);d+=nr(.01*d,l),h+=nr(.01*h,l);let m=s,y=i;for(;m<0;)m+=2*Math.PI,y+=2*Math.PI;y-m>2*Math.PI&&(m=0,y=2*Math.PI);const b=2*Math.PI/l.curveStepCount,v=Math.min(b/2,(y-m)/2),x=jW(v,c,u,d,h,m,y,1,l);if(!l.disableMultiStroke){const w=jW(v,c,u,d,h,m,y,1.5,l);x.push(...w)}return a&&(o?x.push(...Yh(c,u,c+d*Math.cos(m),u+h*Math.sin(m),l),...Yh(c,u,c+d*Math.cos(y),u+h*Math.sin(y),l)):x.push({op:"lineTo",data:[c,u]},{op:"lineTo",data:[c+d*Math.cos(m),u+h*Math.sin(m)]})),{type:"path",ops:x}}function NW(e,t){const n=Nce(Rce(d5(e))),r=[];let s=[0,0],i=[0,0];for(const{key:a,data:o}of n)switch(a){case"M":i=[o[0],o[1]],s=[o[0],o[1]];break;case"L":r.push(...Yh(i[0],i[1],o[0],o[1],t)),i=[o[0],o[1]];break;case"C":{const[l,c,u,d,h,m]=o;r.push(...Bat(l,c,u,d,h,m,i,t)),i=[h,m];break}case"Z":r.push(...Yh(i[0],i[1],s[0],s[1],t)),i=[s[0],s[1]]}return{type:"path",ops:r}}function V3(e,t){const n=[];for(const r of e)if(r.length){const s=t.maxRandomnessOffset||0,i=r.length;if(i>2){n.push({op:"move",data:[r[0][0]+nr(s,t),r[0][1]+nr(s,t)]});for(let a=1;a<i;a++)n.push({op:"lineTo",data:[r[a][0]+nr(s,t),r[a][1]+nr(s,t)]})}}return{type:"fillPath",ops:n}}function p0(e,t){return function(n,r){let s=n.fillStyle||"hachure";if(!ko[s])switch(s){case"zigzag":ko[s]||(ko[s]=new Nat(r));break;case"cross-hatch":ko[s]||(ko[s]=new Mat(r));break;case"dots":ko[s]||(ko[s]=new Iat(r));break;case"dashed":ko[s]||(ko[s]=new jat(r));break;case"zigzag-line":ko[s]||(ko[s]=new Pat(r));break;default:s="hachure",ko[s]||(ko[s]=new u5(r))}return ko[s]}(t,Fat).fillPolygons(e,t)}function MW(e){const t=Object.assign({},e);return t.randomizer=void 0,e.seed&&(t.seed=e.seed+1),t}function Pce(e){return e.randomizer||(e.randomizer=new Oat(e.seed||0)),e.randomizer.next()}function hE(e,t,n,r=1){return n.roughness*r*(Pce(n)*(t-e)+e)}function nr(e,t,n=1){return hE(-e,e,t,n)}function Yh(e,t,n,r,s,i=!1){const a=i?s.disableMultiStrokeFill:s.disableMultiStroke,o=NP(e,t,n,r,s,!0,!1);if(a)return o;const l=NP(e,t,n,r,s,!0,!0);return o.concat(l)}function NP(e,t,n,r,s,i,a){const o=Math.pow(e-n,2)+Math.pow(t-r,2),l=Math.sqrt(o);let c=1;c=l<200?1:l>500?.4:-.0016668*l+1.233334;let u=s.maxRandomnessOffset||0;u*u*100>o&&(u=l/10);const d=u/2,h=.2+.2*Pce(s);let m=s.bowing*s.maxRandomnessOffset*(r-t)/200,y=s.bowing*s.maxRandomnessOffset*(e-n)/200;m=nr(m,s,c),y=nr(y,s,c);const b=[],v=()=>nr(d,s,c),x=()=>nr(u,s,c),w=s.preserveVertices;return a?b.push({op:"move",data:[e+(w?0:v()),t+(w?0:v())]}):b.push({op:"move",data:[e+(w?0:nr(u,s,c)),t+(w?0:nr(u,s,c))]}),a?b.push({op:"bcurveTo",data:[m+e+(n-e)*h+v(),y+t+(r-t)*h+v(),m+e+2*(n-e)*h+v(),y+t+2*(r-t)*h+v(),n+(w?0:v()),r+(w?0:v())]}):b.push({op:"bcurveTo",data:[m+e+(n-e)*h+x(),y+t+(r-t)*h+x(),m+e+2*(n-e)*h+x(),y+t+2*(r-t)*h+x(),n+(w?0:x()),r+(w?0:x())]}),b}function NC(e,t,n){if(!e.length)return[];const r=[];r.push([e[0][0]+nr(t,n),e[0][1]+nr(t,n)]),r.push([e[0][0]+nr(t,n),e[0][1]+nr(t,n)]);for(let s=1;s<e.length;s++)r.push([e[s][0]+nr(t,n),e[s][1]+nr(t,n)]),s===e.length-1&&r.push([e[s][0]+nr(t,n),e[s][1]+nr(t,n)]);return pE(r,null,n)}function pE(e,t,n){const r=e.length,s=[];if(r>3){const i=[],a=1-n.curveTightness;s.push({op:"move",data:[e[1][0],e[1][1]]});for(let o=1;o+2<r;o++){const l=e[o];i[0]=[l[0],l[1]],i[1]=[l[0]+(a*e[o+1][0]-a*e[o-1][0])/6,l[1]+(a*e[o+1][1]-a*e[o-1][1])/6],i[2]=[e[o+1][0]+(a*e[o][0]-a*e[o+2][0])/6,e[o+1][1]+(a*e[o][1]-a*e[o+2][1])/6],i[3]=[e[o+1][0],e[o+1][1]],s.push({op:"bcurveTo",data:[i[1][0],i[1][1],i[2][0],i[2][1],i[3][0],i[3][1]]})}}else r===3?(s.push({op:"move",data:[e[1][0],e[1][1]]}),s.push({op:"bcurveTo",data:[e[1][0],e[1][1],e[2][0],e[2][1],e[2][0],e[2][1]]})):r===2&&s.push(...NP(e[0][0],e[0][1],e[1][0],e[1][1],n,!0,!0));return s}function IW(e,t,n,r,s,i,a,o){const l=[],c=[];if(o.roughness===0){e/=4,c.push([t+r*Math.cos(-e),n+s*Math.sin(-e)]);for(let u=0;u<=2*Math.PI;u+=e){const d=[t+r*Math.cos(u),n+s*Math.sin(u)];l.push(d),c.push(d)}c.push([t+r*Math.cos(0),n+s*Math.sin(0)]),c.push([t+r*Math.cos(e),n+s*Math.sin(e)])}else{const u=nr(.5,o)-Math.PI/2;c.push([nr(i,o)+t+.9*r*Math.cos(u-e),nr(i,o)+n+.9*s*Math.sin(u-e)]);const d=2*Math.PI+u-.01;for(let h=u;h<d;h+=e){const m=[nr(i,o)+t+r*Math.cos(h),nr(i,o)+n+s*Math.sin(h)];l.push(m),c.push(m)}c.push([nr(i,o)+t+r*Math.cos(u+2*Math.PI+.5*a),nr(i,o)+n+s*Math.sin(u+2*Math.PI+.5*a)]),c.push([nr(i,o)+t+.98*r*Math.cos(u+a),nr(i,o)+n+.98*s*Math.sin(u+a)]),c.push([nr(i,o)+t+.9*r*Math.cos(u+.5*a),nr(i,o)+n+.9*s*Math.sin(u+.5*a)])}return[c,l]}function jW(e,t,n,r,s,i,a,o,l){const c=i+nr(.1,l),u=[];u.push([nr(o,l)+t+.9*r*Math.cos(c-e),nr(o,l)+n+.9*s*Math.sin(c-e)]);for(let d=c;d<=a;d+=e)u.push([nr(o,l)+t+r*Math.cos(d),nr(o,l)+n+s*Math.sin(d)]);return u.push([t+r*Math.cos(a),n+s*Math.sin(a)]),u.push([t+r*Math.cos(a),n+s*Math.sin(a)]),pE(u,null,l)}function Bat(e,t,n,r,s,i,a,o){const l=[],c=[o.maxRandomnessOffset||1,(o.maxRandomnessOffset||1)+.3];let u=[0,0];const d=o.disableMultiStroke?1:2,h=o.preserveVertices;for(let m=0;m<d;m++)m===0?l.push({op:"move",data:[a[0],a[1]]}):l.push({op:"move",data:[a[0]+(h?0:nr(c[0],o)),a[1]+(h?0:nr(c[0],o))]}),u=h?[s,i]:[s+nr(c[m],o),i+nr(c[m],o)],l.push({op:"bcurveTo",data:[e+nr(c[m],o),t+nr(c[m],o),n+nr(c[m],o),r+nr(c[m],o),u[0],u[1]]});return l}function ax(e){return[...e]}function PW(e,t=0){const n=e.length;if(n<3)throw new Error("A curve must have at least three points.");const r=[];if(n===3)r.push(ax(e[0]),ax(e[1]),ax(e[2]),ax(e[2]));else{const s=[];s.push(e[0],e[0]);for(let o=1;o<e.length;o++)s.push(e[o]),o===e.length-1&&s.push(e[o]);const i=[],a=1-t;r.push(ax(s[0]));for(let o=1;o+2<s.length;o++){const l=s[o];i[0]=[l[0],l[1]],i[1]=[l[0]+(a*s[o+1][0]-a*s[o-1][0])/6,l[1]+(a*s[o+1][1]-a*s[o-1][1])/6],i[2]=[s[o+1][0]+(a*s[o][0]-a*s[o+2][0])/6,s[o+1][1]+(a*s[o][1]-a*s[o+2][1])/6],i[3]=[s[o+1][0],s[o+1][1]],r.push(i[1],i[2],i[3])}}return r}function l2(e,t){return Math.pow(e[0]-t[0],2)+Math.pow(e[1]-t[1],2)}function $at(e,t,n){const r=l2(t,n);if(r===0)return l2(e,t);let s=((e[0]-t[0])*(n[0]-t[0])+(e[1]-t[1])*(n[1]-t[1]))/r;return s=Math.max(0,Math.min(1,s)),l2(e,Qp(t,n,s))}function Qp(e,t,n){return[e[0]+(t[0]-e[0])*n,e[1]+(t[1]-e[1])*n]}function MP(e,t,n,r){const s=r||[];if(function(o,l){const c=o[l+0],u=o[l+1],d=o[l+2],h=o[l+3];let m=3*u[0]-2*c[0]-h[0];m*=m;let y=3*u[1]-2*c[1]-h[1];y*=y;let b=3*d[0]-2*h[0]-c[0];b*=b;let v=3*d[1]-2*h[1]-c[1];return v*=v,m<b&&(m=b),y<v&&(y=v),m+y}(e,t)<n){const o=e[t+0];s.length?(i=s[s.length-1],a=o,Math.sqrt(l2(i,a))>1&&s.push(o)):s.push(o),s.push(e[t+3])}else{const l=e[t+0],c=e[t+1],u=e[t+2],d=e[t+3],h=Qp(l,c,.5),m=Qp(c,u,.5),y=Qp(u,d,.5),b=Qp(h,m,.5),v=Qp(m,y,.5),x=Qp(b,v,.5);MP([l,h,b,x],0,n,s),MP([x,v,y,d],0,n,s)}var i,a;return s}function zat(e,t){return mE(e,0,e.length,t)}function mE(e,t,n,r,s){const i=s||[],a=e[t],o=e[n-1];let l=0,c=1;for(let u=t+1;u<n-1;++u){const d=$at(e[u],a,o);d>l&&(l=d,c=u)}return Math.sqrt(l)>r?(mE(e,t,c+1,r,i),mE(e,c,n,r,i)):(i.length||i.push(a),i.push(o)),i}function W3(e,t=.15,n){const r=[],s=(e.length-1)/3;for(let i=0;i<s;i++)MP(e,3*i,t,r);return n&&n>0?mE(r,0,r.length,n):r}const al="none";class gE{constructor(t){this.defaultOptions={maxRandomnessOffset:2,roughness:1,bowing:1,stroke:"#000",strokeWidth:1,curveTightness:0,curveFitting:.95,curveStepCount:9,fillStyle:"hachure",fillWeight:-1,hachureAngle:-41,hachureGap:-1,dashOffset:-1,dashGap:-1,zigzagOffset:-1,seed:0,disableMultiStroke:!1,disableMultiStrokeFill:!1,preserveVertices:!1,fillShapeRoughnessGain:.8},this.config=t||{},this.config.options&&(this.defaultOptions=this._o(this.config.options))}static newSeed(){return Math.floor(Math.random()*2**31)}_o(t){return t?Object.assign({},this.defaultOptions,t):this.defaultOptions}_d(t,n,r){return{shape:t,sets:n||[],options:r||this.defaultOptions}}line(t,n,r,s,i){const a=this._o(i);return this._d("line",[Ice(t,n,r,s,a)],a)}rectangle(t,n,r,s,i){const a=this._o(i),o=[],l=Lat(t,n,r,s,a);if(a.fill){const c=[[t,n],[t+r,n],[t+r,n+s],[t,n+s]];a.fillStyle==="solid"?o.push(V3([c],a)):o.push(p0([c],a))}return a.stroke!==al&&o.push(l),this._d("rectangle",o,a)}ellipse(t,n,r,s,i){const a=this._o(i),o=[],l=jce(r,s,a),c=RP(t,n,a,l);if(a.fill)if(a.fillStyle==="solid"){const u=RP(t,n,a,l).opset;u.type="fillPath",o.push(u)}else o.push(p0([c.estimatedPoints],a));return a.stroke!==al&&o.push(c.opset),this._d("ellipse",o,a)}circle(t,n,r,s){const i=this.ellipse(t,n,r,r,s);return i.shape="circle",i}linearPath(t,n){const r=this._o(n);return this._d("linearPath",[o2(t,!1,r)],r)}arc(t,n,r,s,i,a,o=!1,l){const c=this._o(l),u=[],d=RW(t,n,r,s,i,a,o,!0,c);if(o&&c.fill)if(c.fillStyle==="solid"){const h=Object.assign({},c);h.disableMultiStroke=!0;const m=RW(t,n,r,s,i,a,!0,!1,h);m.type="fillPath",u.push(m)}else u.push(function(h,m,y,b,v,x,w){const S=h,k=m;let C=Math.abs(y/2),T=Math.abs(b/2);C+=nr(.01*C,w),T+=nr(.01*T,w);let A=v,N=x;for(;A<0;)A+=2*Math.PI,N+=2*Math.PI;N-A>2*Math.PI&&(A=0,N=2*Math.PI);const I=(N-A)/w.curveStepCount,O=[];for(let B=A;B<=N;B+=I)O.push([S+C*Math.cos(B),k+T*Math.sin(B)]);return O.push([S+C*Math.cos(N),k+T*Math.sin(N)]),O.push([S,k]),p0([O],w)}(t,n,r,s,i,a,c));return c.stroke!==al&&u.push(d),this._d("arc",u,c)}curve(t,n){const r=this._o(n),s=[],i=AW(t,r);if(r.fill&&r.fill!==al)if(r.fillStyle==="solid"){const a=AW(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(a.ops)})}else{const a=[],o=t;if(o.length){const l=typeof o[0][0]=="number"?[o]:o;for(const c of l)c.length<3?a.push(...c):c.length===3?a.push(...W3(PW([c[0],c[0],c[1],c[2]]),10,(1+r.roughness)/2)):a.push(...W3(PW(c),10,(1+r.roughness)/2))}a.length&&s.push(p0([a],r))}return r.stroke!==al&&s.push(i),this._d("curve",s,r)}polygon(t,n){const r=this._o(n),s=[],i=o2(t,!0,r);return r.fill&&(r.fillStyle==="solid"?s.push(V3([t],r)):s.push(p0([t],r))),r.stroke!==al&&s.push(i),this._d("polygon",s,r)}path(t,n){const r=this._o(n),s=[];if(!t)return this._d("path",s,r);t=(t||"").replace(/\n/g," ").replace(/(-\s)/g,"-").replace("/(ss)/g"," ");const i=r.fill&&r.fill!=="transparent"&&r.fill!==al,a=r.stroke!==al,o=!!(r.simplification&&r.simplification<1),l=function(u,d,h){const m=Nce(Rce(d5(u))),y=[];let b=[],v=[0,0],x=[];const w=()=>{x.length>=4&&b.push(...W3(x,d)),x=[]},S=()=>{w(),b.length&&(y.push(b),b=[])};for(const{key:C,data:T}of m)switch(C){case"M":S(),v=[T[0],T[1]],b.push(v);break;case"L":w(),b.push([T[0],T[1]]);break;case"C":if(!x.length){const A=b.length?b[b.length-1]:v;x.push([A[0],A[1]])}x.push([T[0],T[1]]),x.push([T[2],T[3]]),x.push([T[4],T[5]]);break;case"Z":w(),b.push([v[0],v[1]])}if(S(),!h)return y;const k=[];for(const C of y){const T=zat(C,h);T.length&&k.push(T)}return k}(t,1,o?4-4*(r.simplification||1):(1+r.roughness)/2),c=NW(t,r);if(i)if(r.fillStyle==="solid")if(l.length===1){const u=NW(t,Object.assign(Object.assign({},r),{disableMultiStroke:!0,roughness:r.roughness?r.roughness+r.fillShapeRoughnessGain:0}));s.push({type:"fillPath",ops:this._mergedShape(u.ops)})}else s.push(V3(l,r));else s.push(p0(l,r));return a&&(o?l.forEach(u=>{s.push(o2(u,!1,r))}):s.push(c)),this._d("path",s,r)}opsToPath(t,n){let r="";for(const s of t.ops){const i=typeof n=="number"&&n>=0?s.data.map(a=>+a.toFixed(n)):s.data;switch(s.op){case"move":r+=`M${i[0]} ${i[1]} `;break;case"bcurveTo":r+=`C${i[0]} ${i[1]}, ${i[2]} ${i[3]}, ${i[4]} ${i[5]} `;break;case"lineTo":r+=`L${i[0]} ${i[1]} `}}return r.trim()}toPaths(t){const n=t.sets||[],r=t.options||this.defaultOptions,s=[];for(const i of n){let a=null;switch(i.type){case"path":a={d:this.opsToPath(i),stroke:r.stroke,strokeWidth:r.strokeWidth,fill:al};break;case"fillPath":a={d:this.opsToPath(i),stroke:al,strokeWidth:0,fill:r.fill||al};break;case"fillSketch":a=this.fillSketch(i,r)}a&&s.push(a)}return s}fillSketch(t,n){let r=n.fillWeight;return r<0&&(r=n.strokeWidth/2),{d:this.opsToPath(t),stroke:n.fill||al,strokeWidth:r,fill:al}}_mergedShape(t){return t.filter((n,r)=>r===0||n.op!=="move")}}class Uat{constructor(t,n){this.canvas=t,this.ctx=this.canvas.getContext("2d"),this.gen=new gE(n)}draw(t){const n=t.sets||[],r=t.options||this.getDefaultOptions(),s=this.ctx,i=t.options.fixedDecimalPlaceDigits;for(const a of n)switch(a.type){case"path":s.save(),s.strokeStyle=r.stroke==="none"?"transparent":r.stroke,s.lineWidth=r.strokeWidth,r.strokeLineDash&&s.setLineDash(r.strokeLineDash),r.strokeLineDashOffset&&(s.lineDashOffset=r.strokeLineDashOffset),this._drawToContext(s,a,i),s.restore();break;case"fillPath":{s.save(),s.fillStyle=r.fill||"";const o=t.shape==="curve"||t.shape==="polygon"||t.shape==="path"?"evenodd":"nonzero";this._drawToContext(s,a,i,o),s.restore();break}case"fillSketch":this.fillSketch(s,a,r)}}fillSketch(t,n,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2),t.save(),r.fillLineDash&&t.setLineDash(r.fillLineDash),r.fillLineDashOffset&&(t.lineDashOffset=r.fillLineDashOffset),t.strokeStyle=r.fill||"",t.lineWidth=s,this._drawToContext(t,n,r.fixedDecimalPlaceDigits),t.restore()}_drawToContext(t,n,r,s="nonzero"){t.beginPath();for(const i of n.ops){const a=typeof r=="number"&&r>=0?i.data.map(o=>+o.toFixed(r)):i.data;switch(i.op){case"move":t.moveTo(a[0],a[1]);break;case"bcurveTo":t.bezierCurveTo(a[0],a[1],a[2],a[3],a[4],a[5]);break;case"lineTo":t.lineTo(a[0],a[1])}}n.type==="fillPath"?t.fill(s):t.stroke()}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}line(t,n,r,s,i){const a=this.gen.line(t,n,r,s,i);return this.draw(a),a}rectangle(t,n,r,s,i){const a=this.gen.rectangle(t,n,r,s,i);return this.draw(a),a}ellipse(t,n,r,s,i){const a=this.gen.ellipse(t,n,r,s,i);return this.draw(a),a}circle(t,n,r,s){const i=this.gen.circle(t,n,r,s);return this.draw(i),i}linearPath(t,n){const r=this.gen.linearPath(t,n);return this.draw(r),r}polygon(t,n){const r=this.gen.polygon(t,n);return this.draw(r),r}arc(t,n,r,s,i,a,o=!1,l){const c=this.gen.arc(t,n,r,s,i,a,o,l);return this.draw(c),c}curve(t,n){const r=this.gen.curve(t,n);return this.draw(r),r}path(t,n){const r=this.gen.path(t,n);return this.draw(r),r}}const MC="http://www.w3.org/2000/svg";class qat{constructor(t,n){this.svg=t,this.gen=new gE(n)}draw(t){const n=t.sets||[],r=t.options||this.getDefaultOptions(),s=this.svg.ownerDocument||window.document,i=s.createElementNS(MC,"g"),a=t.options.fixedDecimalPlaceDigits;for(const o of n){let l=null;switch(o.type){case"path":l=s.createElementNS(MC,"path"),l.setAttribute("d",this.opsToPath(o,a)),l.setAttribute("stroke",r.stroke),l.setAttribute("stroke-width",r.strokeWidth+""),l.setAttribute("fill","none"),r.strokeLineDash&&l.setAttribute("stroke-dasharray",r.strokeLineDash.join(" ").trim()),r.strokeLineDashOffset&&l.setAttribute("stroke-dashoffset",`${r.strokeLineDashOffset}`);break;case"fillPath":l=s.createElementNS(MC,"path"),l.setAttribute("d",this.opsToPath(o,a)),l.setAttribute("stroke","none"),l.setAttribute("stroke-width","0"),l.setAttribute("fill",r.fill||""),t.shape!=="curve"&&t.shape!=="polygon"||l.setAttribute("fill-rule","evenodd");break;case"fillSketch":l=this.fillSketch(s,o,r)}l&&i.appendChild(l)}return i}fillSketch(t,n,r){let s=r.fillWeight;s<0&&(s=r.strokeWidth/2);const i=t.createElementNS(MC,"path");return i.setAttribute("d",this.opsToPath(n,r.fixedDecimalPlaceDigits)),i.setAttribute("stroke",r.fill||""),i.setAttribute("stroke-width",s+""),i.setAttribute("fill","none"),r.fillLineDash&&i.setAttribute("stroke-dasharray",r.fillLineDash.join(" ").trim()),r.fillLineDashOffset&&i.setAttribute("stroke-dashoffset",`${r.fillLineDashOffset}`),i}get generator(){return this.gen}getDefaultOptions(){return this.gen.defaultOptions}opsToPath(t,n){return this.gen.opsToPath(t,n)}line(t,n,r,s,i){const a=this.gen.line(t,n,r,s,i);return this.draw(a)}rectangle(t,n,r,s,i){const a=this.gen.rectangle(t,n,r,s,i);return this.draw(a)}ellipse(t,n,r,s,i){const a=this.gen.ellipse(t,n,r,s,i);return this.draw(a)}circle(t,n,r,s){const i=this.gen.circle(t,n,r,s);return this.draw(i)}linearPath(t,n){const r=this.gen.linearPath(t,n);return this.draw(r)}polygon(t,n){const r=this.gen.polygon(t,n);return this.draw(r)}arc(t,n,r,s,i,a,o=!1,l){const c=this.gen.arc(t,n,r,s,i,a,o,l);return this.draw(c)}curve(t,n){const r=this.gen.curve(t,n);return this.draw(r)}path(t,n){const r=this.gen.path(t,n);return this.draw(r)}}var An={canvas:(e,t)=>new Uat(e,t),svg:(e,t)=>new qat(e,t),generator:e=>new gE(e),newSeed:()=>gE.newSeed()},hr=ie(async(e,t,n)=>{var d,h;let r;const s=t.useHtmlLabels||Ki((d=ls())==null?void 0:d.htmlLabels);n?r=n:r="node default";const i=e.insert("g").attr("class",r).attr("id",t.domId||t.id),a=i.insert("g").attr("class","label").attr("style",lo(t.labelStyle));let o;t.label===void 0?o="":o=typeof t.label=="string"?t.label:t.label[0];const l=await bp(a,Bm(ug(o),ls()),{useHtmlLabels:s,width:t.width||((h=ls().flowchart)==null?void 0:h.wrappingWidth),cssClasses:"markdown-node-label",style:t.labelStyle,addSvgBackground:!!t.icon||!!t.img});let c=l.getBBox();const u=((t==null?void 0:t.padding)??0)/2;if(s){const m=l.children[0],y=Zr(l),b=m.getElementsByTagName("img");if(b){const v=o.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...b].map(x=>new Promise(w=>{function S(){if(x.style.display="flex",x.style.flexDirection="column",v){const k=ls().fontSize?ls().fontSize:window.getComputedStyle(document.body).fontSize,C=5,[T=Zie.fontSize]=vA(k),A=T*C+"px";x.style.minWidth=A,x.style.maxWidth=A}else x.style.width="100%";w(x)}ie(S,"setupImage"),setTimeout(()=>{x.complete&&S()}),x.addEventListener("error",S),x.addEventListener("load",S)})))}c=m.getBoundingClientRect(),y.attr("width",c.width),y.attr("height",c.height)}return s?a.attr("transform","translate("+-c.width/2+", "+-c.height/2+")"):a.attr("transform","translate(0, "+-c.height/2+")"),t.centerLabel&&a.attr("transform","translate("+-c.width/2+", "+-c.height/2+")"),a.insert("rect",":first-child"),{shapeSvg:i,bbox:c,halfPadding:u,label:a}},"labelHelper"),H3=ie(async(e,t,n)=>{var l,c,u,d,h,m;const r=n.useHtmlLabels||Ki((c=(l=ls())==null?void 0:l.flowchart)==null?void 0:c.htmlLabels),s=e.insert("g").attr("class","label").attr("style",n.labelStyle||""),i=await bp(s,Bm(ug(t),ls()),{useHtmlLabels:r,width:n.width||((d=(u=ls())==null?void 0:u.flowchart)==null?void 0:d.wrappingWidth),style:n.labelStyle,addSvgBackground:!!n.icon||!!n.img});let a=i.getBBox();const o=n.padding/2;if(Ki((m=(h=ls())==null?void 0:h.flowchart)==null?void 0:m.htmlLabels)){const y=i.children[0],b=Zr(i);a=y.getBoundingClientRect(),b.attr("width",a.width),b.attr("height",a.height)}return r?s.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"):s.attr("transform","translate(0, "+-a.height/2+")"),n.centerLabel&&s.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"),s.insert("rect",":first-child"),{shapeSvg:e,bbox:a,halfPadding:o,label:s}},"insertLabel"),jn=ie((e,t)=>{const n=t.node().getBBox();e.width=n.width,e.height=n.height},"updateNodeBounds"),sr=ie((e,t)=>(e.look==="handDrawn"?"rough-node":"node")+" "+e.cssClasses+" "+(t||""),"getNodeClasses");function Jr(e){const t=e.map((n,r)=>`${r===0?"M":"L"}${n.x},${n.y}`);return t.push("Z"),t.join(" ")}ie(Jr,"createPathFromPoints");function Zh(e,t,n,r,s,i){const a=[],l=n-e,c=r-t,u=l/i,d=2*Math.PI/u,h=t+c/2;for(let m=0;m<=50;m++){const y=m/50,b=e+y*l,v=h+s*Math.sin(d*(b-e));a.push({x:b,y:v})}return a}ie(Zh,"generateFullSineWavePoints");function f5(e,t,n,r,s,i){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(f5,"generateCirclePoints");var Vat=ie((e,t)=>{var n=e.x,r=e.y,s=t.x-n,i=t.y-r,a=e.width/2,o=e.height/2,l,c;return Math.abs(i)*a>Math.abs(s)*o?(i<0&&(o=-o),l=i===0?0:o*s/i,c=o):(s<0&&(a=-a),l=a,c=s===0?0:a*i/s),{x:n+l,y:r+c}},"intersectRect"),Rb=Vat;function Oce(e,t){t&&e.attr("style",t)}ie(Oce,"applyStyle");async function Dce(e){const t=Zr(document.createElementNS("http://www.w3.org/2000/svg","foreignObject")),n=t.append("xhtml:div");let r=e.label;e.label&&Dy(e.label)&&(r=await b6(e.label.replace(Eb.lineBreakRegex,`
`),ls()));const s=e.isNode?"nodeLabel":"edgeLabel";return n.html('<span class="'+s+'" '+(e.labelStyle?'style="'+e.labelStyle+'"':"")+">"+r+"</span>"),Oce(n,e.labelStyle),n.style("display","inline-block"),n.style("padding-right","1px"),n.style("white-space","nowrap"),n.attr("xmlns","http://www.w3.org/1999/xhtml"),t.node()}ie(Dce,"addHtmlLabel");var Wat=ie(async(e,t,n,r)=>{let s=e||"";if(typeof s=="object"&&(s=s[0]),Ki(ls().flowchart.htmlLabels)){s=s.replace(/\\n|\n/g,"<br />"),Ut.info("vertexText"+s);const i={isNode:r,label:ug(s).replace(/fa[blrs]?:fa-[\w-]+/g,o=>`<i class='${o.replace(":"," ")}'></i>`),labelStyle:t&&t.replace("fill:","color:")};return await Dce(i)}else{const i=document.createElementNS("http://www.w3.org/2000/svg","text");i.setAttribute("style",t.replace("color:","fill:"));let a=[];typeof s=="string"?a=s.split(/\\n|\n|<br\s*\/?>/gi):Array.isArray(s)?a=s:a=[];for(const o of a){const l=document.createElementNS("http://www.w3.org/2000/svg","tspan");l.setAttributeNS("http://www.w3.org/XML/1998/namespace","xml:space","preserve"),l.setAttribute("dy","1em"),l.setAttribute("x","0"),n?l.setAttribute("class","title-row"):l.setAttribute("class","row"),l.textContent=o.trim(),i.appendChild(l)}return i}},"createLabel"),mm=Wat,wf=ie((e,t,n,r,s)=>["M",e+s,t,"H",e+n-s,"A",s,s,0,0,1,e+n,t+s,"V",t+r-s,"A",s,s,0,0,1,e+n-s,t+r,"H",e+s,"A",s,s,0,0,1,e,t+r-s,"V",t+s,"A",s,s,0,0,1,e+s,t,"Z"].join(" "),"createRoundedRectPathD"),Hat=ie(e=>{const{handDrawnSeed:t}=ls();return{fill:e,hachureAngle:120,hachureGap:4,fillWeight:2,roughness:.7,stroke:e,seed:t}},"solidStateFill"),Nb=ie(e=>{const t=Gat([...e.cssCompiledStyles||[],...e.cssStyles||[]]);return{stylesMap:t,stylesArray:[...t]}},"compileStyles"),Gat=ie(e=>{const t=new Map;return e.forEach(n=>{const[r,s]=n.split(":");t.set(r.trim(),s==null?void 0:s.trim())}),t},"styles2Map"),Fce=ie(e=>e==="color"||e==="font-size"||e==="font-family"||e==="font-weight"||e==="font-style"||e==="text-decoration"||e==="text-align"||e==="text-transform"||e==="line-height"||e==="letter-spacing"||e==="word-spacing"||e==="text-shadow"||e==="text-overflow"||e==="white-space"||e==="word-wrap"||e==="word-break"||e==="overflow-wrap"||e==="hyphens","isLabelStyle"),Pn=ie(e=>{const{stylesArray:t}=Nb(e),n=[],r=[],s=[],i=[];return t.forEach(a=>{const o=a[0];Fce(o)?n.push(a.join(":")+" !important"):(r.push(a.join(":")+" !important"),o.includes("stroke")&&s.push(a.join(":")+" !important"),o==="fill"&&i.push(a.join(":")+" !important"))}),{labelStyles:n.join(";"),nodeStyles:r.join(";"),stylesArray:t,borderStyles:s,backgroundStyles:i}},"styles2String"),Nn=ie((e,t)=>{var l;const{themeVariables:n,handDrawnSeed:r}=ls(),{nodeBorder:s,mainBkg:i}=n,{stylesMap:a}=Nb(e);return Object.assign({roughness:.7,fill:a.get("fill")||i,fillStyle:"hachure",fillWeight:4,hachureGap:5.2,stroke:a.get("stroke")||s,seed:r,strokeWidth:((l=a.get("stroke-width"))==null?void 0:l.replace("px",""))||1.3,fillLineDash:[0,0]},t)},"userNodeOverrides"),Lce=ie(async(e,t)=>{Ut.info("Creating subgraph rect for ",t.id,t);const n=ls(),{themeVariables:r,handDrawnSeed:s}=n,{clusterBkg:i,clusterBorder:a}=r,{labelStyles:o,nodeStyles:l,borderStyles:c,backgroundStyles:u}=Pn(t),d=e.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),h=Ki(n.flowchart.htmlLabels),m=d.insert("g").attr("class","cluster-label "),y=await bp(m,t.label,{style:t.labelStyle,useHtmlLabels:h,isNode:!0});let b=y.getBBox();if(Ki(n.flowchart.htmlLabels)){const A=y.children[0],N=Zr(y);b=A.getBoundingClientRect(),N.attr("width",b.width),N.attr("height",b.height)}const v=t.width<=b.width+t.padding?b.width+t.padding:t.width;t.width<=b.width+t.padding?t.diff=(v-t.width)/2-t.padding:t.diff=-t.padding;const x=t.height,w=t.x-v/2,S=t.y-x/2;Ut.trace("Data ",t,JSON.stringify(t));let k;if(t.look==="handDrawn"){const A=An.svg(d),N=Nn(t,{roughness:.7,fill:i,stroke:a,fillWeight:3,seed:s}),I=A.path(wf(w,S,v,x,0),N);k=d.insert(()=>(Ut.debug("Rough node insert CXC",I),I),":first-child"),k.select("path:nth-child(2)").attr("style",c.join(";")),k.select("path").attr("style",u.join(";").replace("fill","stroke"))}else k=d.insert("rect",":first-child"),k.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",w).attr("y",S).attr("width",v).attr("height",x);const{subGraphTitleTopMargin:C}=M6(n);if(m.attr("transform",`translate(${t.x-b.width/2}, ${t.y-t.height/2+C})`),o){const A=m.select("span");A&&A.attr("style",o)}const T=k.node().getBBox();return t.offsetX=0,t.width=T.width,t.height=T.height,t.offsetY=b.height-t.padding/2,t.intersect=function(A){return Rb(t,A)},{cluster:d,labelBBox:b}},"rect"),Kat=ie((e,t)=>{const n=e.insert("g").attr("class","note-cluster").attr("id",t.id),r=n.insert("rect",":first-child"),s=0*t.padding,i=s/2;r.attr("rx",t.rx).attr("ry",t.ry).attr("x",t.x-t.width/2-i).attr("y",t.y-t.height/2-i).attr("width",t.width+s).attr("height",t.height+s).attr("fill","none");const a=r.node().getBBox();return t.width=a.width,t.height=a.height,t.intersect=function(o){return Rb(t,o)},{cluster:n,labelBBox:{width:0,height:0}}},"noteGroup"),Yat=ie(async(e,t)=>{const n=ls(),{themeVariables:r,handDrawnSeed:s}=n,{altBackground:i,compositeBackground:a,compositeTitleBackground:o,nodeBorder:l}=r,c=e.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-id",t.id).attr("data-look",t.look),u=c.insert("g",":first-child"),d=c.insert("g").attr("class","cluster-label");let h=c.append("rect");const m=d.node().appendChild(await mm(t.label,t.labelStyle,void 0,!0));let y=m.getBBox();if(Ki(n.flowchart.htmlLabels)){const I=m.children[0],O=Zr(m);y=I.getBoundingClientRect(),O.attr("width",y.width),O.attr("height",y.height)}const b=0*t.padding,v=b/2,x=(t.width<=y.width+t.padding?y.width+t.padding:t.width)+b;t.width<=y.width+t.padding?t.diff=(x-t.width)/2-t.padding:t.diff=-t.padding;const w=t.height+b,S=t.height+b-y.height-6,k=t.x-x/2,C=t.y-w/2;t.width=x;const T=t.y-t.height/2-v+y.height+2;let A;if(t.look==="handDrawn"){const I=t.cssClasses.includes("statediagram-cluster-alt"),O=An.svg(c),B=t.rx||t.ry?O.path(wf(k,C,x,w,10),{roughness:.7,fill:o,fillStyle:"solid",stroke:l,seed:s}):O.rectangle(k,C,x,w,{seed:s});A=c.insert(()=>B,":first-child");const D=O.rectangle(k,T,x,S,{fill:I?i:a,fillStyle:I?"hachure":"solid",stroke:l,seed:s});A=c.insert(()=>B,":first-child"),h=c.insert(()=>D)}else A=u.insert("rect",":first-child"),A.attr("class","outer").attr("x",k).attr("y",C).attr("width",x).attr("height",w).attr("data-look",t.look),h.attr("class","inner").attr("x",k).attr("y",T).attr("width",x).attr("height",S);d.attr("transform",`translate(${t.x-y.width/2}, ${C+1-(Ki(n.flowchart.htmlLabels)?0:3)})`);const N=A.node().getBBox();return t.height=N.height,t.offsetX=0,t.offsetY=y.height-t.padding/2,t.labelBBox=y,t.intersect=function(I){return Rb(t,I)},{cluster:c,labelBBox:y}},"roundedWithTitle"),Zat=ie(async(e,t)=>{Ut.info("Creating subgraph rect for ",t.id,t);const n=ls(),{themeVariables:r,handDrawnSeed:s}=n,{clusterBkg:i,clusterBorder:a}=r,{labelStyles:o,nodeStyles:l,borderStyles:c,backgroundStyles:u}=Pn(t),d=e.insert("g").attr("class","cluster "+t.cssClasses).attr("id",t.id).attr("data-look",t.look),h=Ki(n.flowchart.htmlLabels),m=d.insert("g").attr("class","cluster-label "),y=await bp(m,t.label,{style:t.labelStyle,useHtmlLabels:h,isNode:!0,width:t.width});let b=y.getBBox();if(Ki(n.flowchart.htmlLabels)){const A=y.children[0],N=Zr(y);b=A.getBoundingClientRect(),N.attr("width",b.width),N.attr("height",b.height)}const v=t.width<=b.width+t.padding?b.width+t.padding:t.width;t.width<=b.width+t.padding?t.diff=(v-t.width)/2-t.padding:t.diff=-t.padding;const x=t.height,w=t.x-v/2,S=t.y-x/2;Ut.trace("Data ",t,JSON.stringify(t));let k;if(t.look==="handDrawn"){const A=An.svg(d),N=Nn(t,{roughness:.7,fill:i,stroke:a,fillWeight:4,seed:s}),I=A.path(wf(w,S,v,x,t.rx),N);k=d.insert(()=>(Ut.debug("Rough node insert CXC",I),I),":first-child"),k.select("path:nth-child(2)").attr("style",c.join(";")),k.select("path").attr("style",u.join(";").replace("fill","stroke"))}else k=d.insert("rect",":first-child"),k.attr("style",l).attr("rx",t.rx).attr("ry",t.ry).attr("x",w).attr("y",S).attr("width",v).attr("height",x);const{subGraphTitleTopMargin:C}=M6(n);if(m.attr("transform",`translate(${t.x-b.width/2}, ${t.y-t.height/2+C})`),o){const A=m.select("span");A&&A.attr("style",o)}const T=k.node().getBBox();return t.offsetX=0,t.width=T.width,t.height=T.height,t.offsetY=b.height-t.padding/2,t.intersect=function(A){return Rb(t,A)},{cluster:d,labelBBox:b}},"kanbanSection"),Xat=ie((e,t)=>{const n=ls(),{themeVariables:r,handDrawnSeed:s}=n,{nodeBorder:i}=r,a=e.insert("g").attr("class",t.cssClasses).attr("id",t.id).attr("data-look",t.look),o=a.insert("g",":first-child"),l=0*t.padding,c=t.width+l;t.diff=-t.padding;const u=t.height+l,d=t.x-c/2,h=t.y-u/2;t.width=c;let m;if(t.look==="handDrawn"){const v=An.svg(a).rectangle(d,h,c,u,{fill:"lightgrey",roughness:.5,strokeLineDash:[5],stroke:i,seed:s});m=a.insert(()=>v,":first-child")}else m=o.insert("rect",":first-child"),m.attr("class","divider").attr("x",d).attr("y",h).attr("width",c).attr("height",u).attr("data-look",t.look);const y=m.node().getBBox();return t.height=y.height,t.offsetX=0,t.offsetY=0,t.intersect=function(b){return Rb(t,b)},{cluster:a,labelBBox:{}}},"divider"),Jat=Lce,Qat={rect:Lce,squareRect:Jat,roundedWithTitle:Yat,noteGroup:Kat,divider:Xat,kanbanSection:Zat},Bce=new Map,eot=ie(async(e,t)=>{const n=t.shape||"rect",r=await Qat[n](e,t);return Bce.set(t.id,r),r},"insertCluster"),uft=ie(()=>{Bce=new Map},"clear");function $ce(e,t){return e.intersect(t)}ie($ce,"intersectNode");var tot=$ce;function zce(e,t,n,r){var s=e.x,i=e.y,a=s-r.x,o=i-r.y,l=Math.sqrt(t*t*o*o+n*n*a*a),c=Math.abs(t*n*a/l);r.x<s&&(c=-c);var u=Math.abs(t*n*o/l);return r.y<i&&(u=-u),{x:s+c,y:i+u}}ie(zce,"intersectEllipse");var Uce=zce;function qce(e,t,n){return Uce(e,t,t,n)}ie(qce,"intersectCircle");var not=qce;function Vce(e,t,n,r){var s,i,a,o,l,c,u,d,h,m,y,b,v,x,w;if(s=t.y-e.y,a=e.x-t.x,l=t.x*e.y-e.x*t.y,h=s*n.x+a*n.y+l,m=s*r.x+a*r.y+l,!(h!==0&&m!==0&&IP(h,m))&&(i=r.y-n.y,o=n.x-r.x,c=r.x*n.y-n.x*r.y,u=i*e.x+o*e.y+c,d=i*t.x+o*t.y+c,!(u!==0&&d!==0&&IP(u,d))&&(y=s*o-i*a,y!==0)))return b=Math.abs(y/2),v=a*c-o*l,x=v<0?(v-b)/y:(v+b)/y,v=i*l-s*c,w=v<0?(v-b)/y:(v+b)/y,{x,y:w}}ie(Vce,"intersectLine");function IP(e,t){return e*t>0}ie(IP,"sameSign");var rot=Vce;function Wce(e,t,n){let r=e.x,s=e.y,i=[],a=Number.POSITIVE_INFINITY,o=Number.POSITIVE_INFINITY;typeof t.forEach=="function"?t.forEach(function(u){a=Math.min(a,u.x),o=Math.min(o,u.y)}):(a=Math.min(a,t.x),o=Math.min(o,t.y));let l=r-e.width/2-a,c=s-e.height/2-o;for(let u=0;u<t.length;u++){let d=t[u],h=t[u<t.length-1?u+1:0],m=rot(e,n,{x:l+d.x,y:c+d.y},{x:l+h.x,y:c+h.y});m&&i.push(m)}return i.length?(i.length>1&&i.sort(function(u,d){let h=u.x-n.x,m=u.y-n.y,y=Math.sqrt(h*h+m*m),b=d.x-n.x,v=d.y-n.y,x=Math.sqrt(b*b+v*v);return y<x?-1:y===x?0:1}),i[0]):e}ie(Wce,"intersectPolygon");var sot=Wce,kn={node:tot,circle:not,ellipse:Uce,polygon:sot,rect:Rb};function Hce(e,t){const{labelStyles:n}=Pn(t);t.labelStyle=n;const r=sr(t);let s=r;r||(s="anchor");const i=e.insert("g").attr("class",s).attr("id",t.domId||t.id),a=1,{cssStyles:o}=t,l=An.svg(i),c=Nn(t,{fill:"black",stroke:"none",fillStyle:"solid"});t.look!=="handDrawn"&&(c.roughness=0);const u=l.circle(0,0,a*2,c),d=i.insert(()=>u,":first-child");return d.attr("class","anchor").attr("style",lo(o)),jn(t,d),t.intersect=function(h){return Ut.info("Circle intersect",t,a,h),kn.circle(t,a,h)},i}ie(Hce,"anchor");function jP(e,t,n,r,s,i,a){const l=(e+n)/2,c=(t+r)/2,u=Math.atan2(r-t,n-e),d=(n-e)/2,h=(r-t)/2,m=d/s,y=h/i,b=Math.sqrt(m**2+y**2);if(b>1)throw new Error("The given radii are too small to create an arc between the points.");const v=Math.sqrt(1-b**2),x=l+v*i*Math.sin(u)*(a?-1:1),w=c-v*s*Math.cos(u)*(a?-1:1),S=Math.atan2((t-w)/i,(e-x)/s);let C=Math.atan2((r-w)/i,(n-x)/s)-S;a&&C<0&&(C+=2*Math.PI),!a&&C>0&&(C-=2*Math.PI);const T=[];for(let A=0;A<20;A++){const N=A/19,I=S+N*C,O=x+s*Math.cos(I),B=w+i*Math.sin(I);T.push({x:O,y:B})}return T}ie(jP,"generateArcPoints");async function Gce(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,sr(t)),a=i.width+t.padding+20,o=i.height+t.padding,l=o/2,c=l/(2.5+o/50),{cssStyles:u}=t,d=[{x:a/2,y:-o/2},{x:-a/2,y:-o/2},...jP(-a/2,-o/2,-a/2,o/2,c,l,!1),{x:a/2,y:o/2},...jP(a/2,o/2,a/2,-o/2,c,l,!0)],h=An.svg(s),m=Nn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=Jr(d),b=h.path(y,m),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),v.attr("transform",`translate(${c/2}, 0)`),jn(t,v),t.intersect=function(x){return kn.polygon(t,d,x)},s}ie(Gce,"bowTieRect");function _f(e,t,n,r){return e.insert("polygon",":first-child").attr("points",r.map(function(s){return s.x+","+s.y}).join(" ")).attr("class","label-container").attr("transform","translate("+-t/2+","+n/2+")")}ie(_f,"insertPolygonShape");async function Kce(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,sr(t)),a=i.height+t.padding,o=12,l=i.width+t.padding+o,c=0,u=l,d=-a,h=0,m=[{x:c+o,y:d},{x:u,y:d},{x:u,y:h},{x:c,y:h},{x:c,y:d+o},{x:c+o,y:d}];let y;const{cssStyles:b}=t;if(t.look==="handDrawn"){const v=An.svg(s),x=Nn(t,{}),w=Jr(m),S=v.path(w,x);y=s.insert(()=>S,":first-child").attr("transform",`translate(${-l/2}, ${a/2})`),b&&y.attr("style",b)}else y=_f(s,l,a,m);return r&&y.attr("style",r),jn(t,y),t.intersect=function(v){return kn.polygon(t,m,v)},s}ie(Kce,"card");function Yce(e,t){const{nodeStyles:n}=Pn(t);t.label="";const r=e.insert("g").attr("class",sr(t)).attr("id",t.domId??t.id),{cssStyles:s}=t,i=Math.max(28,t.width??0),a=[{x:0,y:i/2},{x:i/2,y:0},{x:0,y:-i/2},{x:-i/2,y:0}],o=An.svg(r),l=Nn(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");const c=Jr(a),u=o.path(c,l),d=r.insert(()=>u,":first-child");return s&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",s),n&&t.look!=="handDrawn"&&d.selectAll("path").attr("style",n),t.width=28,t.height=28,t.intersect=function(h){return kn.polygon(t,a,h)},r}ie(Yce,"choice");async function Zce(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,halfPadding:a}=await hr(e,t,sr(t)),o=i.width/2+a;let l;const{cssStyles:c}=t;if(t.look==="handDrawn"){const u=An.svg(s),d=Nn(t,{}),h=u.circle(0,0,o*2,d);l=s.insert(()=>h,":first-child"),l.attr("class","basic label-container").attr("style",lo(c))}else l=s.insert("circle",":first-child").attr("class","basic label-container").attr("style",r).attr("r",o).attr("cx",0).attr("cy",0);return jn(t,l),t.intersect=function(u){return Ut.info("Circle intersect",t,o,u),kn.circle(t,o,u)},s}ie(Zce,"circle");function Xce(e){const t=Math.cos(Math.PI/4),n=Math.sin(Math.PI/4),r=e*2,s={x:r/2*t,y:r/2*n},i={x:-(r/2)*t,y:r/2*n},a={x:-(r/2)*t,y:-(r/2)*n},o={x:r/2*t,y:-(r/2)*n};return`M ${i.x},${i.y} L ${o.x},${o.y}
                   M ${s.x},${s.y} L ${a.x},${a.y}`}ie(Xce,"createLine");function Jce(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n,t.label="";const s=e.insert("g").attr("class",sr(t)).attr("id",t.domId??t.id),i=Math.max(30,(t==null?void 0:t.width)??0),{cssStyles:a}=t,o=An.svg(s),l=Nn(t,{});t.look!=="handDrawn"&&(l.roughness=0,l.fillStyle="solid");const c=o.circle(0,0,i*2,l),u=Xce(i),d=o.path(u,l),h=s.insert(()=>c,":first-child");return h.insert(()=>d),a&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",a),r&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",r),jn(t,h),t.intersect=function(m){return Ut.info("crossedCircle intersect",t,{radius:i,point:m}),kn.circle(t,i,m)},s}ie(Jce,"crossedCircle");function Ed(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(Ed,"generateCirclePoints");async function Qce(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...Ed(o/2,-l/2,c,30,-90,0),{x:-o/2-c,y:c},...Ed(o/2+c*2,-c,c,20,-180,-270),...Ed(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:-l/2},...Ed(o/2,l/2,c,20,0,90)],h=[{x:o/2,y:-l/2-c},{x:-o/2,y:-l/2-c},...Ed(o/2,-l/2,c,20,-90,0),{x:-o/2-c,y:-c},...Ed(o/2+o*.1,-c,c,20,-180,-270),...Ed(o/2+o*.1,c,c,20,-90,-180),{x:-o/2-c,y:l/2},...Ed(o/2,l/2,c,20,0,90),{x:-o/2,y:l/2+c},{x:o/2,y:l/2+c}],m=An.svg(s),y=Nn(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const v=Jr(d).replace("Z",""),x=m.path(v,y),w=Jr(h),S=m.path(w,{...y}),k=s.insert("g",":first-child");return k.insert(()=>S,":first-child").attr("stroke-opacity",0),k.insert(()=>x,":first-child"),k.attr("class","text"),u&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),k.attr("transform",`translate(${c}, 0)`),a.attr("transform",`translate(${-o/2+c-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),jn(t,k),t.intersect=function(C){return kn.polygon(t,h,C)},s}ie(Qce,"curlyBraceLeft");function Td(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:m,y})}return a}ie(Td,"generateCirclePoints");async function eue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...Td(o/2,-l/2,c,20,-90,0),{x:o/2+c,y:-c},...Td(o/2+c*2,-c,c,20,-180,-270),...Td(o/2+c*2,c,c,20,-90,-180),{x:o/2+c,y:l/2},...Td(o/2,l/2,c,20,0,90)],h=[{x:-o/2,y:-l/2-c},{x:o/2,y:-l/2-c},...Td(o/2,-l/2,c,20,-90,0),{x:o/2+c,y:-c},...Td(o/2+c*2,-c,c,20,-180,-270),...Td(o/2+c*2,c,c,20,-90,-180),{x:o/2+c,y:l/2},...Td(o/2,l/2,c,20,0,90),{x:o/2,y:l/2+c},{x:-o/2,y:l/2+c}],m=An.svg(s),y=Nn(t,{fill:"none"});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const v=Jr(d).replace("Z",""),x=m.path(v,y),w=Jr(h),S=m.path(w,{...y}),k=s.insert("g",":first-child");return k.insert(()=>S,":first-child").attr("stroke-opacity",0),k.insert(()=>x,":first-child"),k.attr("class","text"),u&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),k.attr("transform",`translate(${-c}, 0)`),a.attr("transform",`translate(${-o/2+(t.padding??0)/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),jn(t,k),t.intersect=function(C){return kn.polygon(t,h,C)},s}ie(eue,"curlyBraceRight");function va(e,t,n,r=100,s=0,i=180){const a=[],o=s*Math.PI/180,u=(i*Math.PI/180-o)/(r-1);for(let d=0;d<r;d++){const h=o+d*u,m=e+n*Math.cos(h),y=t+n*Math.sin(h);a.push({x:-m,y:-y})}return a}ie(va,"generateCirclePoints");async function tue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=i.width+(t.padding??0),l=i.height+(t.padding??0),c=Math.max(5,l*.1),{cssStyles:u}=t,d=[...va(o/2,-l/2,c,30,-90,0),{x:-o/2-c,y:c},...va(o/2+c*2,-c,c,20,-180,-270),...va(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:-l/2},...va(o/2,l/2,c,20,0,90)],h=[...va(-o/2+c+c/2,-l/2,c,20,-90,-180),{x:o/2-c/2,y:c},...va(-o/2-c/2,-c,c,20,0,90),...va(-o/2-c/2,c,c,20,-90,0),{x:o/2-c/2,y:-c},...va(-o/2+c+c/2,l/2,c,30,-180,-270)],m=[{x:o/2,y:-l/2-c},{x:-o/2,y:-l/2-c},...va(o/2,-l/2,c,20,-90,0),{x:-o/2-c,y:-c},...va(o/2+c*2,-c,c,20,-180,-270),...va(o/2+c*2,c,c,20,-90,-180),{x:-o/2-c,y:l/2},...va(o/2,l/2,c,20,0,90),{x:-o/2,y:l/2+c},{x:o/2-c-c/2,y:l/2+c},...va(-o/2+c+c/2,-l/2,c,20,-90,-180),{x:o/2-c/2,y:c},...va(-o/2-c/2,-c,c,20,0,90),...va(-o/2-c/2,c,c,20,-90,0),{x:o/2-c/2,y:-c},...va(-o/2+c+c/2,l/2,c,30,-180,-270)],y=An.svg(s),b=Nn(t,{fill:"none"});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const x=Jr(d).replace("Z",""),w=y.path(x,b),k=Jr(h).replace("Z",""),C=y.path(k,b),T=Jr(m),A=y.path(T,{...b}),N=s.insert("g",":first-child");return N.insert(()=>A,":first-child").attr("stroke-opacity",0),N.insert(()=>w,":first-child"),N.insert(()=>C,":first-child"),N.attr("class","text"),u&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",u),r&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",r),N.attr("transform",`translate(${c-c/4}, 0)`),a.attr("transform",`translate(${-o/2+(t.padding??0)/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)/2-(i.y-(i.top??0))})`),jn(t,N),t.intersect=function(I){return kn.polygon(t,m,I)},s}ie(tue,"curlyBraces");async function nue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,sr(t)),a=80,o=20,l=Math.max(a,(i.width+(t.padding??0)*2)*1.25,(t==null?void 0:t.width)??0),c=Math.max(o,i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=c/2,{cssStyles:d}=t,h=An.svg(s),m=Nn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=l,b=c,v=y-u,x=b/4,w=[{x:v,y:0},{x,y:0},{x:0,y:b/2},{x,y:b},{x:v,y:b},...f5(-v,-b/2,u,50,270,90)],S=Jr(w),k=h.path(S,m),C=s.insert(()=>k,":first-child");return C.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&C.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&C.selectChildren("path").attr("style",r),C.attr("transform",`translate(${-l/2}, ${-c/2})`),jn(t,C),t.intersect=function(T){return kn.polygon(t,w,T)},s}ie(nue,"curvedTrapezoid");var iot=ie((e,t,n,r,s,i)=>[`M${e},${t+i}`,`a${s},${i} 0,0,0 ${n},0`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`].join(" "),"createCylinderPathD"),aot=ie((e,t,n,r,s,i)=>[`M${e},${t+i}`,`M${e+n},${t+i}`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`].join(" "),"createOuterCylinderPathD"),oot=ie((e,t,n,r,s,i)=>[`M${e-n/2},${-r/2}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createInnerCylinderPathD");async function rue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=Math.max(i.width+t.padding,t.width??0),l=o/2,c=l/(2.5+o/50),u=Math.max(i.height+c+t.padding,t.height??0);let d;const{cssStyles:h}=t;if(t.look==="handDrawn"){const m=An.svg(s),y=aot(0,0,o,u,l,c),b=oot(0,c,o,u,l,c),v=m.path(y,Nn(t,{})),x=m.path(b,Nn(t,{fill:"none"}));d=s.insert(()=>x,":first-child"),d=s.insert(()=>v,":first-child"),d.attr("class","basic label-container"),h&&d.attr("style",h)}else{const m=iot(0,0,o,u,l,c);d=s.insert("path",":first-child").attr("d",m).attr("class","basic label-container").attr("style",lo(h)).attr("style",r)}return d.attr("label-offset-y",c),d.attr("transform",`translate(${-o/2}, ${-(u/2+c)})`),jn(t,d),a.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+(t.padding??0)/1.5-(i.y-(i.top??0))})`),t.intersect=function(m){const y=kn.rect(t,m),b=y.x-(t.x??0);if(l!=0&&(Math.abs(b)<(t.width??0)/2||Math.abs(b)==(t.width??0)/2&&Math.abs(y.y-(t.y??0))>(t.height??0)/2-c)){let v=c*c*(1-b*b/(l*l));v>0&&(v=Math.sqrt(v)),v=c-v,m.y-(t.y??0)>0&&(v=-v),y.y+=v}return y},s}ie(rue,"cylinder");async function sue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=i.width+t.padding,l=i.height+t.padding,c=l*.2,u=-o/2,d=-l/2-c/2,{cssStyles:h}=t,m=An.svg(s),y=Nn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=[{x:u,y:d+c},{x:-u,y:d+c},{x:-u,y:-d},{x:u,y:-d},{x:u,y:d},{x:-u,y:d},{x:-u,y:d+c}],v=m.polygon(b.map(w=>[w.x,w.y]),y),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),a.attr("transform",`translate(${u+(t.padding??0)/2-(i.x-(i.left??0))}, ${d+c+(t.padding??0)/2-(i.y-(i.top??0))})`),jn(t,x),t.intersect=function(w){return kn.rect(t,w)},s}ie(sue,"dividedRectangle");async function iue(e,t){var h,m;const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,halfPadding:a}=await hr(e,t,sr(t)),l=i.width/2+a+5,c=i.width/2+a;let u;const{cssStyles:d}=t;if(t.look==="handDrawn"){const y=An.svg(s),b=Nn(t,{roughness:.2,strokeWidth:2.5}),v=Nn(t,{roughness:.2,strokeWidth:1.5}),x=y.circle(0,0,l*2,b),w=y.circle(0,0,c*2,v);u=s.insert("g",":first-child"),u.attr("class",lo(t.cssClasses)).attr("style",lo(d)),(h=u.node())==null||h.appendChild(x),(m=u.node())==null||m.appendChild(w)}else{u=s.insert("g",":first-child");const y=u.insert("circle",":first-child"),b=u.insert("circle");u.attr("class","basic label-container").attr("style",r),y.attr("class","outer-circle").attr("style",r).attr("r",l).attr("cx",0).attr("cy",0),b.attr("class","inner-circle").attr("style",r).attr("r",c).attr("cx",0).attr("cy",0)}return jn(t,u),t.intersect=function(y){return Ut.info("DoubleCircle intersect",t,l,y),kn.circle(t,l,y)},s}ie(iue,"doublecircle");function aue(e,t,{config:{themeVariables:n}}){const{labelStyles:r,nodeStyles:s}=Pn(t);t.label="",t.labelStyle=r;const i=e.insert("g").attr("class",sr(t)).attr("id",t.domId??t.id),a=7,{cssStyles:o}=t,l=An.svg(i),{nodeBorder:c}=n,u=Nn(t,{fillStyle:"solid"});t.look!=="handDrawn"&&(u.roughness=0);const d=l.circle(0,0,a*2,u),h=i.insert(()=>d,":first-child");return h.selectAll("path").attr("style",`fill: ${c} !important;`),o&&o.length>0&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",o),s&&t.look!=="handDrawn"&&h.selectAll("path").attr("style",s),jn(t,h),t.intersect=function(m){return Ut.info("filledCircle intersect",t,{radius:a,point:m}),kn.circle(t,a,m)},i}ie(aue,"filledCircle");async function oue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=i.width+(t.padding??0),l=o+i.height,c=o+i.height,u=[{x:0,y:-l},{x:c,y:-l},{x:c/2,y:0}],{cssStyles:d}=t,h=An.svg(s),m=Nn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=Jr(u),b=h.path(y,m),v=s.insert(()=>b,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`);return d&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",r),t.width=o,t.height=l,jn(t,v),a.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${-l/2+(t.padding??0)/2+(i.y-(i.top??0))})`),t.intersect=function(x){return Ut.info("Triangle intersect",t,u,x),kn.polygon(t,u,x)},s}ie(oue,"flippedTriangle");function lue(e,t,{dir:n,config:{state:r,themeVariables:s}}){const{nodeStyles:i}=Pn(t);t.label="";const a=e.insert("g").attr("class",sr(t)).attr("id",t.domId??t.id),{cssStyles:o}=t;let l=Math.max(70,(t==null?void 0:t.width)??0),c=Math.max(10,(t==null?void 0:t.height)??0);n==="LR"&&(l=Math.max(10,(t==null?void 0:t.width)??0),c=Math.max(70,(t==null?void 0:t.height)??0));const u=-1*l/2,d=-1*c/2,h=An.svg(a),m=Nn(t,{stroke:s.lineColor,fill:s.lineColor});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=h.rectangle(u,d,l,c,m),b=a.insert(()=>y,":first-child");o&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",o),i&&t.look!=="handDrawn"&&b.selectAll("path").attr("style",i),jn(t,b);const v=(r==null?void 0:r.padding)??0;return t.width&&t.height&&(t.width+=v/2||0,t.height+=v/2||0),t.intersect=function(x){return kn.rect(t,x)},a}ie(lue,"forkJoin");async function cue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const s=80,i=50,{shapeSvg:a,bbox:o}=await hr(e,t,sr(t)),l=Math.max(s,o.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i,o.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=c/2,{cssStyles:d}=t,h=An.svg(a),m=Nn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:-l/2,y:-c/2},{x:l/2-u,y:-c/2},...f5(-l/2+u,0,u,50,90,270),{x:l/2-u,y:c/2},{x:-l/2,y:c/2}],b=Jr(y),v=h.path(b,m),x=a.insert(()=>v,":first-child");return x.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),jn(t,x),t.intersect=function(w){return Ut.info("Pill intersect",t,{radius:u,point:w}),kn.polygon(t,y,w)},a}ie(cue,"halfRoundedRectangle");var lot=ie((e,t,n,r,s)=>[`M${e+s},${t}`,`L${e+n-s},${t}`,`L${e+n},${t-r/2}`,`L${e+n-s},${t-r}`,`L${e+s},${t-r}`,`L${e},${t-r/2}`,"Z"].join(" "),"createHexagonPathD");async function uue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,sr(t)),a=4,o=i.height+t.padding,l=o/a,c=i.width+2*l+t.padding,u=[{x:l,y:0},{x:c-l,y:0},{x:c,y:-o/2},{x:c-l,y:-o},{x:l,y:-o},{x:0,y:-o/2}];let d;const{cssStyles:h}=t;if(t.look==="handDrawn"){const m=An.svg(s),y=Nn(t,{}),b=lot(0,0,c,o,l),v=m.path(b,y);d=s.insert(()=>v,":first-child").attr("transform",`translate(${-c/2}, ${o/2})`),h&&d.attr("style",h)}else d=_f(s,c,o,u);return r&&d.attr("style",r),t.width=c,t.height=o,jn(t,d),t.intersect=function(m){return kn.polygon(t,u,m)},s}ie(uue,"hexagon");async function due(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.label="",t.labelStyle=n;const{shapeSvg:s}=await hr(e,t,sr(t)),i=Math.max(30,(t==null?void 0:t.width)??0),a=Math.max(30,(t==null?void 0:t.height)??0),{cssStyles:o}=t,l=An.svg(s),c=Nn(t,{});t.look!=="handDrawn"&&(c.roughness=0,c.fillStyle="solid");const u=[{x:0,y:0},{x:i,y:0},{x:0,y:a},{x:i,y:a}],d=Jr(u),h=l.path(d,c),m=s.insert(()=>h,":first-child");return m.attr("class","basic label-container"),o&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",o),r&&t.look!=="handDrawn"&&m.selectChildren("path").attr("style",r),m.attr("transform",`translate(${-i/2}, ${-a/2})`),jn(t,m),t.intersect=function(y){return Ut.info("Pill intersect",t,{points:u}),kn.polygon(t,u,y)},s}ie(due,"hourglass");async function fue(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=Pn(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,label:d}=await hr(e,t,"icon-shape default"),h=t.pos==="t",m=o,y=o,{nodeBorder:b}=n,{stylesMap:v}=Nb(t),x=-y/2,w=-m/2,S=t.label?8:0,k=An.svg(c),C=Nn(t,{stroke:"none",fill:"none"});t.look!=="handDrawn"&&(C.roughness=0,C.fillStyle="solid");const T=k.rectangle(x,w,y,m,C),A=Math.max(y,u.width),N=m+u.height+S,I=k.rectangle(-A/2,-N/2,A,N,{...C,fill:"transparent",stroke:"none"}),O=c.insert(()=>T,":first-child"),B=c.insert(()=>I);if(t.icon){const D=c.append("g");D.html(`<g>${await lA(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const H=D.node().getBBox(),P=H.width,K=H.height,U=H.x,V=H.y;D.attr("transform",`translate(${-P/2-U},${h?u.height/2+S/2-K/2-V:-u.height/2-S/2-K/2-V})`),D.attr("style",`color: ${v.get("stroke")??b};`)}return d.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${h?-N/2:N/2-u.height})`),O.attr("transform",`translate(0,${h?u.height/2+S/2:-u.height/2-S/2})`),jn(t,B),t.intersect=function(D){if(Ut.info("iconSquare intersect",t,D),!t.label)return kn.rect(t,D);const H=t.x??0,P=t.y??0,K=t.height??0;let U=[];return h?U=[{x:H-u.width/2,y:P-K/2},{x:H+u.width/2,y:P-K/2},{x:H+u.width/2,y:P-K/2+u.height+S},{x:H+y/2,y:P-K/2+u.height+S},{x:H+y/2,y:P+K/2},{x:H-y/2,y:P+K/2},{x:H-y/2,y:P-K/2+u.height+S},{x:H-u.width/2,y:P-K/2+u.height+S}]:U=[{x:H-y/2,y:P-K/2},{x:H+y/2,y:P-K/2},{x:H+y/2,y:P-K/2+m},{x:H+u.width/2,y:P-K/2+m},{x:H+u.width/2/2,y:P+K/2},{x:H-u.width/2,y:P+K/2},{x:H-u.width/2,y:P-K/2+m},{x:H-y/2,y:P-K/2+m}],kn.polygon(t,U,D)},c}ie(fue,"icon");async function hue(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=Pn(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,label:d}=await hr(e,t,"icon-shape default"),h=20,m=t.label?8:0,y=t.pos==="t",{nodeBorder:b,mainBkg:v}=n,{stylesMap:x}=Nb(t),w=An.svg(c),S=Nn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const k=x.get("fill");S.stroke=k??v;const C=c.append("g");t.icon&&C.html(`<g>${await lA(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const T=C.node().getBBox(),A=T.width,N=T.height,I=T.x,O=T.y,B=Math.max(A,N)*Math.SQRT2+h*2,D=w.circle(0,0,B,S),H=Math.max(B,u.width),P=B+u.height+m,K=w.rectangle(-H/2,-P/2,H,P,{...S,fill:"transparent",stroke:"none"}),U=c.insert(()=>D,":first-child"),V=c.insert(()=>K);return C.attr("transform",`translate(${-A/2-I},${y?u.height/2+m/2-N/2-O:-u.height/2-m/2-N/2-O})`),C.attr("style",`color: ${x.get("stroke")??b};`),d.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${y?-P/2:P/2-u.height})`),U.attr("transform",`translate(0,${y?u.height/2+m/2:-u.height/2-m/2})`),jn(t,V),t.intersect=function(L){return Ut.info("iconSquare intersect",t,L),kn.rect(t,L)},c}ie(hue,"iconCircle");async function pue(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=Pn(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,halfPadding:d,label:h}=await hr(e,t,"icon-shape default"),m=t.pos==="t",y=o+d*2,b=o+d*2,{nodeBorder:v,mainBkg:x}=n,{stylesMap:w}=Nb(t),S=-b/2,k=-y/2,C=t.label?8:0,T=An.svg(c),A=Nn(t,{});t.look!=="handDrawn"&&(A.roughness=0,A.fillStyle="solid");const N=w.get("fill");A.stroke=N??x;const I=T.path(wf(S,k,b,y,5),A),O=Math.max(b,u.width),B=y+u.height+C,D=T.rectangle(-O/2,-B/2,O,B,{...A,fill:"transparent",stroke:"none"}),H=c.insert(()=>I,":first-child").attr("class","icon-shape2"),P=c.insert(()=>D);if(t.icon){const K=c.append("g");K.html(`<g>${await lA(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const U=K.node().getBBox(),V=U.width,L=U.height,te=U.x,W=U.y;K.attr("transform",`translate(${-V/2-te},${m?u.height/2+C/2-L/2-W:-u.height/2-C/2-L/2-W})`),K.attr("style",`color: ${w.get("stroke")??v};`)}return h.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${m?-B/2:B/2-u.height})`),H.attr("transform",`translate(0,${m?u.height/2+C/2:-u.height/2-C/2})`),jn(t,P),t.intersect=function(K){if(Ut.info("iconSquare intersect",t,K),!t.label)return kn.rect(t,K);const U=t.x??0,V=t.y??0,L=t.height??0;let te=[];return m?te=[{x:U-u.width/2,y:V-L/2},{x:U+u.width/2,y:V-L/2},{x:U+u.width/2,y:V-L/2+u.height+C},{x:U+b/2,y:V-L/2+u.height+C},{x:U+b/2,y:V+L/2},{x:U-b/2,y:V+L/2},{x:U-b/2,y:V-L/2+u.height+C},{x:U-u.width/2,y:V-L/2+u.height+C}]:te=[{x:U-b/2,y:V-L/2},{x:U+b/2,y:V-L/2},{x:U+b/2,y:V-L/2+y},{x:U+u.width/2,y:V-L/2+y},{x:U+u.width/2/2,y:V+L/2},{x:U-u.width/2,y:V+L/2},{x:U-u.width/2,y:V-L/2+y},{x:U-b/2,y:V-L/2+y}],kn.polygon(t,te,K)},c}ie(pue,"iconRounded");async function mue(e,t,{config:{themeVariables:n,flowchart:r}}){const{labelStyles:s}=Pn(t);t.labelStyle=s;const i=t.assetHeight??48,a=t.assetWidth??48,o=Math.max(i,a),l=r==null?void 0:r.wrappingWidth;t.width=Math.max(o,l??0);const{shapeSvg:c,bbox:u,halfPadding:d,label:h}=await hr(e,t,"icon-shape default"),m=t.pos==="t",y=o+d*2,b=o+d*2,{nodeBorder:v,mainBkg:x}=n,{stylesMap:w}=Nb(t),S=-b/2,k=-y/2,C=t.label?8:0,T=An.svg(c),A=Nn(t,{});t.look!=="handDrawn"&&(A.roughness=0,A.fillStyle="solid");const N=w.get("fill");A.stroke=N??x;const I=T.path(wf(S,k,b,y,.1),A),O=Math.max(b,u.width),B=y+u.height+C,D=T.rectangle(-O/2,-B/2,O,B,{...A,fill:"transparent",stroke:"none"}),H=c.insert(()=>I,":first-child"),P=c.insert(()=>D);if(t.icon){const K=c.append("g");K.html(`<g>${await lA(t.icon,{height:o,width:o,fallbackPrefix:""})}</g>`);const U=K.node().getBBox(),V=U.width,L=U.height,te=U.x,W=U.y;K.attr("transform",`translate(${-V/2-te},${m?u.height/2+C/2-L/2-W:-u.height/2-C/2-L/2-W})`),K.attr("style",`color: ${w.get("stroke")??v};`)}return h.attr("transform",`translate(${-u.width/2-(u.x-(u.left??0))},${m?-B/2:B/2-u.height})`),H.attr("transform",`translate(0,${m?u.height/2+C/2:-u.height/2-C/2})`),jn(t,P),t.intersect=function(K){if(Ut.info("iconSquare intersect",t,K),!t.label)return kn.rect(t,K);const U=t.x??0,V=t.y??0,L=t.height??0;let te=[];return m?te=[{x:U-u.width/2,y:V-L/2},{x:U+u.width/2,y:V-L/2},{x:U+u.width/2,y:V-L/2+u.height+C},{x:U+b/2,y:V-L/2+u.height+C},{x:U+b/2,y:V+L/2},{x:U-b/2,y:V+L/2},{x:U-b/2,y:V-L/2+u.height+C},{x:U-u.width/2,y:V-L/2+u.height+C}]:te=[{x:U-b/2,y:V-L/2},{x:U+b/2,y:V-L/2},{x:U+b/2,y:V-L/2+y},{x:U+u.width/2,y:V-L/2+y},{x:U+u.width/2/2,y:V+L/2},{x:U-u.width/2,y:V+L/2},{x:U-u.width/2,y:V-L/2+y},{x:U-b/2,y:V-L/2+y}],kn.polygon(t,te,K)},c}ie(mue,"iconSquare");async function gue(e,t,{config:{flowchart:n}}){const r=new Image;r.src=(t==null?void 0:t.img)??"",await r.decode();const s=Number(r.naturalWidth.toString().replace("px","")),i=Number(r.naturalHeight.toString().replace("px",""));t.imageAspectRatio=s/i;const{labelStyles:a}=Pn(t);t.labelStyle=a;const o=n==null?void 0:n.wrappingWidth;t.defaultWidth=n==null?void 0:n.wrappingWidth;const l=Math.max(t.label?o??0:0,(t==null?void 0:t.assetWidth)??s),c=t.constraint==="on"&&t!=null&&t.assetHeight?t.assetHeight*t.imageAspectRatio:l,u=t.constraint==="on"?c/t.imageAspectRatio:(t==null?void 0:t.assetHeight)??i;t.width=Math.max(c,o??0);const{shapeSvg:d,bbox:h,label:m}=await hr(e,t,"image-shape default"),y=t.pos==="t",b=-c/2,v=-u/2,x=t.label?8:0,w=An.svg(d),S=Nn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const k=w.rectangle(b,v,c,u,S),C=Math.max(c,h.width),T=u+h.height+x,A=w.rectangle(-C/2,-T/2,C,T,{...S,fill:"none",stroke:"none"}),N=d.insert(()=>k,":first-child"),I=d.insert(()=>A);if(t.img){const O=d.append("image");O.attr("href",t.img),O.attr("width",c),O.attr("height",u),O.attr("preserveAspectRatio","none"),O.attr("transform",`translate(${-c/2},${y?T/2-u:-T/2})`)}return m.attr("transform",`translate(${-h.width/2-(h.x-(h.left??0))},${y?-u/2-h.height/2-x/2:u/2-h.height/2+x/2})`),N.attr("transform",`translate(0,${y?h.height/2+x/2:-h.height/2-x/2})`),jn(t,I),t.intersect=function(O){if(Ut.info("iconSquare intersect",t,O),!t.label)return kn.rect(t,O);const B=t.x??0,D=t.y??0,H=t.height??0;let P=[];return y?P=[{x:B-h.width/2,y:D-H/2},{x:B+h.width/2,y:D-H/2},{x:B+h.width/2,y:D-H/2+h.height+x},{x:B+c/2,y:D-H/2+h.height+x},{x:B+c/2,y:D+H/2},{x:B-c/2,y:D+H/2},{x:B-c/2,y:D-H/2+h.height+x},{x:B-h.width/2,y:D-H/2+h.height+x}]:P=[{x:B-c/2,y:D-H/2},{x:B+c/2,y:D-H/2},{x:B+c/2,y:D-H/2+u},{x:B+h.width/2,y:D-H/2+u},{x:B+h.width/2/2,y:D+H/2},{x:B-h.width/2,y:D+H/2},{x:B-h.width/2,y:D-H/2+u},{x:B-c/2,y:D-H/2+u}],kn.polygon(t,P,O)},d}ie(gue,"imageSquare");async function yue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,sr(t)),a=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=[{x:0,y:0},{x:a,y:0},{x:a+3*o/6,y:-o},{x:-3*o/6,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=An.svg(s),h=Nn(t,{}),m=Jr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=_f(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,jn(t,c),t.intersect=function(d){return kn.polygon(t,l,d)},s}ie(yue,"inv_trapezoid");async function S_(e,t,n){const{labelStyles:r,nodeStyles:s}=Pn(t);t.labelStyle=r;const{shapeSvg:i,bbox:a}=await hr(e,t,sr(t)),o=Math.max(a.width+n.labelPaddingX*2,(t==null?void 0:t.width)||0),l=Math.max(a.height+n.labelPaddingY*2,(t==null?void 0:t.height)||0),c=-o/2,u=-l/2;let d,{rx:h,ry:m}=t;const{cssStyles:y}=t;if(n!=null&&n.rx&&n.ry&&(h=n.rx,m=n.ry),t.look==="handDrawn"){const b=An.svg(i),v=Nn(t,{}),x=h||m?b.path(wf(c,u,o,l,h||0),v):b.rectangle(c,u,o,l,v);d=i.insert(()=>x,":first-child"),d.attr("class","basic label-container").attr("style",lo(y))}else d=i.insert("rect",":first-child"),d.attr("class","basic label-container").attr("style",s).attr("rx",lo(h)).attr("ry",lo(m)).attr("x",c).attr("y",u).attr("width",o).attr("height",l);return jn(t,d),t.intersect=function(b){return kn.rect(t,b)},i}ie(S_,"drawRect");async function bue(e,t){const{shapeSvg:n,bbox:r,label:s}=await hr(e,t,"label"),i=n.insert("rect",":first-child");return i.attr("width",.1).attr("height",.1),n.attr("class","label edgeLabel"),s.attr("transform",`translate(${-(r.width/2)-(r.x-(r.left??0))}, ${-(r.height/2)-(r.y-(r.top??0))})`),jn(t,i),t.intersect=function(l){return kn.rect(t,l)},n}ie(bue,"labelRect");async function vue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,sr(t)),a=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),l=[{x:0,y:0},{x:a+3*o/6,y:0},{x:a,y:-o},{x:-(3*o)/6,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=An.svg(s),h=Nn(t,{}),m=Jr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=_f(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,jn(t,c),t.intersect=function(d){return kn.polygon(t,l,d)},s}ie(vue,"lean_left");async function xue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,sr(t)),a=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),l=[{x:-3*o/6,y:0},{x:a,y:0},{x:a+3*o/6,y:-o},{x:0,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=An.svg(s),h=Nn(t,{}),m=Jr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=_f(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,jn(t,c),t.intersect=function(d){return kn.polygon(t,l,d)},s}ie(xue,"lean_right");function wue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.label="",t.labelStyle=n;const s=e.insert("g").attr("class",sr(t)).attr("id",t.domId??t.id),{cssStyles:i}=t,a=Math.max(35,(t==null?void 0:t.width)??0),o=Math.max(35,(t==null?void 0:t.height)??0),l=7,c=[{x:a,y:0},{x:0,y:o+l/2},{x:a-2*l,y:o+l/2},{x:0,y:2*o},{x:a,y:o-l/2},{x:2*l,y:o-l/2}],u=An.svg(s),d=Nn(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const h=Jr(c),m=u.path(h,d),y=s.insert(()=>m,":first-child");return i&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",i),r&&t.look!=="handDrawn"&&y.selectAll("path").attr("style",r),y.attr("transform",`translate(-${a/2},${-o})`),jn(t,y),t.intersect=function(b){return Ut.info("lightningBolt intersect",t,b),kn.polygon(t,c,b)},s}ie(wue,"lightningBolt");var cot=ie((e,t,n,r,s,i,a)=>[`M${e},${t+i}`,`a${s},${i} 0,0,0 ${n},0`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+i+a}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createCylinderPathD"),uot=ie((e,t,n,r,s,i,a)=>[`M${e},${t+i}`,`M${e+n},${t+i}`,`a${s},${i} 0,0,0 ${-n},0`,`l0,${r}`,`a${s},${i} 0,0,0 ${n},0`,`l0,${-r}`,`M${e},${t+i+a}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createOuterCylinderPathD"),dot=ie((e,t,n,r,s,i)=>[`M${e-n/2},${-r/2}`,`a${s},${i} 0,0,0 ${n},0`].join(" "),"createInnerCylinderPathD");async function _ue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=Math.max(i.width+(t.padding??0),t.width??0),l=o/2,c=l/(2.5+o/50),u=Math.max(i.height+c+(t.padding??0),t.height??0),d=u*.1;let h;const{cssStyles:m}=t;if(t.look==="handDrawn"){const y=An.svg(s),b=uot(0,0,o,u,l,c,d),v=dot(0,c,o,u,l,c),x=Nn(t,{}),w=y.path(b,x),S=y.path(v,x);s.insert(()=>S,":first-child").attr("class","line"),h=s.insert(()=>w,":first-child"),h.attr("class","basic label-container"),m&&h.attr("style",m)}else{const y=cot(0,0,o,u,l,c,d);h=s.insert("path",":first-child").attr("d",y).attr("class","basic label-container").attr("style",lo(m)).attr("style",r)}return h.attr("label-offset-y",c),h.attr("transform",`translate(${-o/2}, ${-(u/2+c)})`),jn(t,h),a.attr("transform",`translate(${-(i.width/2)-(i.x-(i.left??0))}, ${-(i.height/2)+c-(i.y-(i.top??0))})`),t.intersect=function(y){const b=kn.rect(t,y),v=b.x-(t.x??0);if(l!=0&&(Math.abs(v)<(t.width??0)/2||Math.abs(v)==(t.width??0)/2&&Math.abs(b.y-(t.y??0))>(t.height??0)/2-c)){let x=c*c*(1-v*v/(l*l));x>0&&(x=Math.sqrt(x)),x=c-x,y.y-(t.y??0)>0&&(x=-x),b.y+=x}return b},s}ie(_ue,"linedCylinder");async function Sue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=l+c,{cssStyles:d}=t,h=An.svg(s),m=Nn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:-o/2-o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:u/2},...Zh(-o/2-o/2*.1,u/2,o/2+o/2*.1,u/2,c,.8),{x:o/2+o/2*.1,y:-u/2},{x:-o/2-o/2*.1,y:-u/2},{x:-o/2,y:-u/2},{x:-o/2,y:u/2*1.1},{x:-o/2,y:-u/2}],b=h.polygon(y.map(x=>[x.x,x.y]),m),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",d),r&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",r),v.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)+o/2*.1/2-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c/2-(i.y-(i.top??0))})`),jn(t,v),t.intersect=function(x){return kn.polygon(t,y,x)},s}ie(Sue,"linedWaveEdgedRect");async function Cue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=5,u=-o/2,d=-l/2,{cssStyles:h}=t,m=An.svg(s),y=Nn(t,{}),b=[{x:u-c,y:d+c},{x:u-c,y:d+l+c},{x:u+o-c,y:d+l+c},{x:u+o-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d+l-c},{x:u+o+c,y:d+l-c},{x:u+o+c,y:d-c},{x:u+c,y:d-c},{x:u+c,y:d},{x:u,y:d},{x:u,y:d+c}],v=[{x:u,y:d+c},{x:u+o-c,y:d+c},{x:u+o-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d},{x:u,y:d}];t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=Jr(b),w=m.path(x,y),S=Jr(v),k=m.path(S,{...y,fill:"none"}),C=s.insert(()=>k,":first-child");return C.insert(()=>w,":first-child"),C.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),a.attr("transform",`translate(${-(i.width/2)-c-(i.x-(i.left??0))}, ${-(i.height/2)+c-(i.y-(i.top??0))})`),jn(t,C),t.intersect=function(T){return kn.polygon(t,b,T)},s}ie(Cue,"multiRect");async function kue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=l+c,d=-o/2,h=-u/2,m=5,{cssStyles:y}=t,b=Zh(d-m,h+u+m,d+o-m,h+u+m,c,.8),v=b==null?void 0:b[b.length-1],x=[{x:d-m,y:h+m},{x:d-m,y:h+u+m},...b,{x:d+o-m,y:v.y-m},{x:d+o,y:v.y-m},{x:d+o,y:v.y-2*m},{x:d+o+m,y:v.y-2*m},{x:d+o+m,y:h-m},{x:d+m,y:h-m},{x:d+m,y:h},{x:d,y:h},{x:d,y:h+m}],w=[{x:d,y:h+m},{x:d+o-m,y:h+m},{x:d+o-m,y:v.y-m},{x:d+o,y:v.y-m},{x:d+o,y:h},{x:d,y:h}],S=An.svg(s),k=Nn(t,{});t.look!=="handDrawn"&&(k.roughness=0,k.fillStyle="solid");const C=Jr(x),T=S.path(C,k),A=Jr(w),N=S.path(A,k),I=s.insert(()=>T,":first-child");return I.insert(()=>N),I.attr("class","basic label-container"),y&&t.look!=="handDrawn"&&I.selectAll("path").attr("style",y),r&&t.look!=="handDrawn"&&I.selectAll("path").attr("style",r),I.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-(i.width/2)-m-(i.x-(i.left??0))}, ${-(i.height/2)+m-c/2-(i.y-(i.top??0))})`),jn(t,I),t.intersect=function(O){return kn.polygon(t,x,O)},s}ie(kue,"multiWaveEdgedRectangle");async function Eue(e,t,{config:{themeVariables:n}}){var x;const{labelStyles:r,nodeStyles:s}=Pn(t);t.labelStyle=r,t.useHtmlLabels||((x=zo().flowchart)==null?void 0:x.htmlLabels)!==!1||(t.centerLabel=!0);const{shapeSvg:a,bbox:o}=await hr(e,t,sr(t)),l=Math.max(o.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(o.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=-l/2,d=-c/2,{cssStyles:h}=t,m=An.svg(a),y=Nn(t,{fill:n.noteBkgColor,stroke:n.noteBorderColor});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=m.rectangle(u,d,l,c,y),v=a.insert(()=>b,":first-child");return v.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",h),s&&t.look!=="handDrawn"&&v.selectAll("path").attr("style",s),jn(t,v),t.intersect=function(w){return kn.rect(t,w)},a}ie(Eue,"note");var fot=ie((e,t,n)=>[`M${e+n/2},${t}`,`L${e+n},${t-n/2}`,`L${e+n/2},${t-n}`,`L${e},${t-n/2}`,"Z"].join(" "),"createDecisionBoxPathD");async function Tue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,sr(t)),a=i.width+t.padding,o=i.height+t.padding,l=a+o,c=[{x:l/2,y:0},{x:l,y:-l/2},{x:l/2,y:-l},{x:0,y:-l/2}];let u;const{cssStyles:d}=t;if(t.look==="handDrawn"){const h=An.svg(s),m=Nn(t,{}),y=fot(0,0,l),b=h.path(y,m);u=s.insert(()=>b,":first-child").attr("transform",`translate(${-l/2}, ${l/2})`),d&&u.attr("style",d)}else u=_f(s,l,l,c);return r&&u.attr("style",r),jn(t,u),t.intersect=function(h){return Ut.debug(`APA12 Intersect called SPLIT
point:`,h,`
node:
`,t,`
res:`,kn.polygon(t,c,h)),kn.polygon(t,c,h)},s}ie(Tue,"question");async function Aue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=Math.max(i.width+(t.padding??0),(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0),(t==null?void 0:t.height)??0),c=-o/2,u=-l/2,d=u/2,h=[{x:c+d,y:u},{x:c,y:0},{x:c+d,y:-u},{x:-c,y:-u},{x:-c,y:u}],{cssStyles:m}=t,y=An.svg(s),b=Nn(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const v=Jr(h),x=y.path(v,b),w=s.insert(()=>x,":first-child");return w.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",m),r&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),w.attr("transform",`translate(${-d/2},0)`),a.attr("transform",`translate(${-d/2-i.width/2-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),jn(t,w),t.intersect=function(S){return kn.polygon(t,h,S)},s}ie(Aue,"rect_left_inv_arrow");async function Rue(e,t){var N,I;const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;let s;t.cssClasses?s="node "+t.cssClasses:s="node default";const i=e.insert("g").attr("class",s).attr("id",t.domId||t.id),a=i.insert("g"),o=i.insert("g").attr("class","label").attr("style",r),l=t.description,c=t.label,u=o.node().appendChild(await mm(c,t.labelStyle,!0,!0));let d={width:0,height:0};if(Ki((I=(N=ls())==null?void 0:N.flowchart)==null?void 0:I.htmlLabels)){const O=u.children[0],B=Zr(u);d=O.getBoundingClientRect(),B.attr("width",d.width),B.attr("height",d.height)}Ut.info("Text 2",l);const h=l||[],m=u.getBBox(),y=o.node().appendChild(await mm(h.join?h.join("<br/>"):h,t.labelStyle,!0,!0)),b=y.children[0],v=Zr(y);d=b.getBoundingClientRect(),v.attr("width",d.width),v.attr("height",d.height);const x=(t.padding||0)/2;Zr(y).attr("transform","translate( "+(d.width>m.width?0:(m.width-d.width)/2)+", "+(m.height+x+5)+")"),Zr(u).attr("transform","translate( "+(d.width<m.width?0:-(m.width-d.width)/2)+", 0)"),d=o.node().getBBox(),o.attr("transform","translate("+-d.width/2+", "+(-d.height/2-x+3)+")");const w=d.width+(t.padding||0),S=d.height+(t.padding||0),k=-d.width/2-x,C=-d.height/2-x;let T,A;if(t.look==="handDrawn"){const O=An.svg(i),B=Nn(t,{}),D=O.path(wf(k,C,w,S,t.rx||0),B),H=O.line(-d.width/2-x,-d.height/2-x+m.height+x,d.width/2+x,-d.height/2-x+m.height+x,B);A=i.insert(()=>(Ut.debug("Rough node insert CXC",D),H),":first-child"),T=i.insert(()=>(Ut.debug("Rough node insert CXC",D),D),":first-child")}else T=a.insert("rect",":first-child"),A=a.insert("line"),T.attr("class","outer title-state").attr("style",r).attr("x",-d.width/2-x).attr("y",-d.height/2-x).attr("width",d.width+(t.padding||0)).attr("height",d.height+(t.padding||0)),A.attr("class","divider").attr("x1",-d.width/2-x).attr("x2",d.width/2+x).attr("y1",-d.height/2-x+m.height+x).attr("y2",-d.height/2-x+m.height+x);return jn(t,T),t.intersect=function(O){return kn.rect(t,O)},i}ie(Rue,"rectWithTitle");async function Nue(e,t){const n={rx:5,ry:5,labelPaddingX:((t==null?void 0:t.padding)||0)*1,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return S_(e,t,n)}ie(Nue,"roundedRect");async function Mue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=(t==null?void 0:t.padding)??0,l=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=-i.width/2-o,d=-i.height/2-o,{cssStyles:h}=t,m=An.svg(s),y=Nn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=[{x:u,y:d},{x:u+l+8,y:d},{x:u+l+8,y:d+c},{x:u-8,y:d+c},{x:u-8,y:d},{x:u,y:d},{x:u,y:d+c}],v=m.polygon(b.map(w=>[w.x,w.y]),y),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container").attr("style",lo(h)),r&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),h&&t.look!=="handDrawn"&&x.selectAll("path").attr("style",r),a.attr("transform",`translate(${-l/2+4+(t.padding??0)-(i.x-(i.left??0))},${-c/2+(t.padding??0)-(i.y-(i.top??0))})`),jn(t,x),t.intersect=function(w){return kn.rect(t,w)},s}ie(Mue,"shadedProcess");async function Iue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=-o/2,u=-l/2,{cssStyles:d}=t,h=An.svg(s),m=Nn(t,{});t.look!=="handDrawn"&&(m.roughness=0,m.fillStyle="solid");const y=[{x:c,y:u},{x:c,y:u+l},{x:c+o,y:u+l},{x:c+o,y:u-l/2}],b=Jr(y),v=h.path(b,m),x=s.insert(()=>v,":first-child");return x.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",d),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),x.attr("transform",`translate(0, ${l/4})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))}, ${-l/4+(t.padding??0)-(i.y-(i.top??0))})`),jn(t,x),t.intersect=function(w){return kn.polygon(t,y,w)},s}ie(Iue,"slopedRect");async function jue(e,t){const n={rx:0,ry:0,labelPaddingX:((t==null?void 0:t.padding)||0)*2,labelPaddingY:((t==null?void 0:t.padding)||0)*1};return S_(e,t,n)}ie(jue,"squareRect");async function Pue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,sr(t)),a=i.height+t.padding,o=i.width+a/4+t.padding;let l;const{cssStyles:c}=t;if(t.look==="handDrawn"){const u=An.svg(s),d=Nn(t,{}),h=wf(-o/2,-a/2,o,a,a/2),m=u.path(h,d);l=s.insert(()=>m,":first-child"),l.attr("class","basic label-container").attr("style",lo(c))}else l=s.insert("rect",":first-child"),l.attr("class","basic label-container").attr("style",r).attr("rx",a/2).attr("ry",a/2).attr("x",-o/2).attr("y",-a/2).attr("width",o).attr("height",a);return jn(t,l),t.intersect=function(u){return kn.rect(t,u)},s}ie(Pue,"stadium");async function Oue(e,t){return S_(e,t,{rx:5,ry:5})}ie(Oue,"state");function Due(e,t,{config:{themeVariables:n}}){const{labelStyles:r,nodeStyles:s}=Pn(t);t.labelStyle=r;const{cssStyles:i}=t,{lineColor:a,stateBorder:o,nodeBorder:l}=n,c=e.insert("g").attr("class","node default").attr("id",t.domId||t.id),u=An.svg(c),d=Nn(t,{});t.look!=="handDrawn"&&(d.roughness=0,d.fillStyle="solid");const h=u.circle(0,0,14,{...d,stroke:a,strokeWidth:2}),m=o??l,y=u.circle(0,0,5,{...d,fill:m,stroke:m,strokeWidth:2,fillStyle:"solid"}),b=c.insert(()=>h,":first-child");return b.insert(()=>y),i&&b.selectAll("path").attr("style",i),s&&b.selectAll("path").attr("style",s),jn(t,b),t.intersect=function(v){return kn.circle(t,7,v)},c}ie(Due,"stateEnd");function Fue(e,t,{config:{themeVariables:n}}){const{lineColor:r}=n,s=e.insert("g").attr("class","node default").attr("id",t.domId||t.id);let i;if(t.look==="handDrawn"){const o=An.svg(s).circle(0,0,14,Hat(r));i=s.insert(()=>o),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14)}else i=s.insert("circle",":first-child"),i.attr("class","state-start").attr("r",7).attr("width",14).attr("height",14);return jn(t,i),t.intersect=function(a){return kn.circle(t,7,a)},s}ie(Fue,"stateStart");async function Lue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,sr(t)),a=((t==null?void 0:t.padding)||0)/2,o=i.width+t.padding,l=i.height+t.padding,c=-i.width/2-a,u=-i.height/2-a,d=[{x:0,y:0},{x:o,y:0},{x:o,y:-l},{x:0,y:-l},{x:0,y:0},{x:-8,y:0},{x:o+8,y:0},{x:o+8,y:-l},{x:-8,y:-l},{x:-8,y:0}];if(t.look==="handDrawn"){const h=An.svg(s),m=Nn(t,{}),y=h.rectangle(c-8,u,o+16,l,m),b=h.line(c,u,c,u+l,m),v=h.line(c+o,u,c+o,u+l,m);s.insert(()=>b,":first-child"),s.insert(()=>v,":first-child");const x=s.insert(()=>y,":first-child"),{cssStyles:w}=t;x.attr("class","basic label-container").attr("style",lo(w)),jn(t,x)}else{const h=_f(s,o,l,d);r&&h.attr("style",r),jn(t,h)}return t.intersect=function(h){return kn.polygon(t,d,h)},s}ie(Lue,"subroutine");async function Bue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,sr(t)),a=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),o=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),l=-a/2,c=-o/2,u=.2*o,d=.2*o,{cssStyles:h}=t,m=An.svg(s),y=Nn(t,{}),b=[{x:l-u/2,y:c},{x:l+a+u/2,y:c},{x:l+a+u/2,y:c+o},{x:l-u/2,y:c+o}],v=[{x:l+a-u/2,y:c+o},{x:l+a+u/2,y:c+o},{x:l+a+u/2,y:c+o-d}];t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=Jr(b),w=m.path(x,y),S=Jr(v),k=m.path(S,{...y,fillStyle:"solid"}),C=s.insert(()=>k,":first-child");return C.insert(()=>w,":first-child"),C.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),jn(t,C),t.intersect=function(T){return kn.polygon(t,b,T)},s}ie(Bue,"taggedRect");async function $ue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/4,u=.2*o,d=.2*l,h=l+c,{cssStyles:m}=t,y=An.svg(s),b=Nn(t,{});t.look!=="handDrawn"&&(b.roughness=0,b.fillStyle="solid");const v=[{x:-o/2-o/2*.1,y:h/2},...Zh(-o/2-o/2*.1,h/2,o/2+o/2*.1,h/2,c,.8),{x:o/2+o/2*.1,y:-h/2},{x:-o/2-o/2*.1,y:-h/2}],x=-o/2+o/2*.1,w=-h/2-d*.4,S=[{x:x+o-u,y:(w+l)*1.4},{x:x+o,y:w+l-d},{x:x+o,y:(w+l)*.9},...Zh(x+o,(w+l)*1.3,x+o-u,(w+l)*1.5,-l*.03,.5)],k=Jr(v),C=y.path(k,b),T=Jr(S),A=y.path(T,{...b,fillStyle:"solid"}),N=s.insert(()=>A,":first-child");return N.insert(()=>C,":first-child"),N.attr("class","basic label-container"),m&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",m),r&&t.look!=="handDrawn"&&N.selectAll("path").attr("style",r),N.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c/2-(i.y-(i.top??0))})`),jn(t,N),t.intersect=function(I){return kn.polygon(t,v,I)},s}ie($ue,"taggedWaveEdgedRectangle");async function zue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,sr(t)),a=Math.max(i.width+t.padding,(t==null?void 0:t.width)||0),o=Math.max(i.height+t.padding,(t==null?void 0:t.height)||0),l=-a/2,c=-o/2,u=s.insert("rect",":first-child");return u.attr("class","text").attr("style",r).attr("rx",0).attr("ry",0).attr("x",l).attr("y",c).attr("width",a).attr("height",o),jn(t,u),t.intersect=function(d){return kn.rect(t,d)},s}ie(zue,"text");var hot=ie((e,t,n,r,s,i)=>`M${e},${t}
    a${s},${i} 0,0,1 0,${-r}
    l${n},0
    a${s},${i} 0,0,1 0,${r}
    M${n},${-r}
    a${s},${i} 0,0,0 0,${r}
    l${-n},0`,"createCylinderPathD"),pot=ie((e,t,n,r,s,i)=>[`M${e},${t}`,`M${e+n},${t}`,`a${s},${i} 0,0,0 0,${-r}`,`l${-n},0`,`a${s},${i} 0,0,0 0,${r}`,`l${n},0`].join(" "),"createOuterCylinderPathD"),mot=ie((e,t,n,r,s,i)=>[`M${e+n/2},${-r/2}`,`a${s},${i} 0,0,0 0,${r}`].join(" "),"createInnerCylinderPathD");async function Uue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a,halfPadding:o}=await hr(e,t,sr(t)),l=t.look==="neo"?o*2:o,c=i.height+l,u=c/2,d=u/(2.5+c/50),h=i.width+d+l,{cssStyles:m}=t;let y;if(t.look==="handDrawn"){const b=An.svg(s),v=pot(0,0,h,c,d,u),x=mot(0,0,h,c,d,u),w=b.path(v,Nn(t,{})),S=b.path(x,Nn(t,{fill:"none"}));y=s.insert(()=>S,":first-child"),y=s.insert(()=>w,":first-child"),y.attr("class","basic label-container"),m&&y.attr("style",m)}else{const b=hot(0,0,h,c,d,u);y=s.insert("path",":first-child").attr("d",b).attr("class","basic label-container").attr("style",lo(m)).attr("style",r),y.attr("class","basic label-container"),m&&y.selectAll("path").attr("style",m),r&&y.selectAll("path").attr("style",r)}return y.attr("label-offset-x",d),y.attr("transform",`translate(${-h/2}, ${c/2} )`),a.attr("transform",`translate(${-(i.width/2)-d-(i.x-(i.left??0))}, ${-(i.height/2)-(i.y-(i.top??0))})`),jn(t,y),t.intersect=function(b){const v=kn.rect(t,b),x=v.y-(t.y??0);if(u!=0&&(Math.abs(x)<(t.height??0)/2||Math.abs(x)==(t.height??0)/2&&Math.abs(v.x-(t.x??0))>(t.width??0)/2-d)){let w=d*d*(1-x*x/(u*u));w!=0&&(w=Math.sqrt(Math.abs(w))),w=d-w,b.x-(t.x??0)>0&&(w=-w),v.x+=w}return v},s}ie(Uue,"tiltedCylinder");async function que(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,sr(t)),a=i.width+t.padding,o=i.height+t.padding,l=[{x:-3*o/6,y:0},{x:a+3*o/6,y:0},{x:a,y:-o},{x:0,y:-o}];let c;const{cssStyles:u}=t;if(t.look==="handDrawn"){const d=An.svg(s),h=Nn(t,{}),m=Jr(l),y=d.path(m,h);c=s.insert(()=>y,":first-child").attr("transform",`translate(${-a/2}, ${o/2})`),u&&c.attr("style",u)}else c=_f(s,a,o,l);return r&&c.attr("style",r),t.width=a,t.height=o,jn(t,c),t.intersect=function(d){return kn.polygon(t,l,d)},s}ie(que,"trapezoid");async function Vue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,sr(t)),a=60,o=20,l=Math.max(a,i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(o,i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),{cssStyles:u}=t,d=An.svg(s),h=Nn(t,{});t.look!=="handDrawn"&&(h.roughness=0,h.fillStyle="solid");const m=[{x:-l/2*.8,y:-c/2},{x:l/2*.8,y:-c/2},{x:l/2,y:-c/2*.6},{x:l/2,y:c/2},{x:-l/2,y:c/2},{x:-l/2,y:-c/2*.6}],y=Jr(m),b=d.path(y,h),v=s.insert(()=>b,":first-child");return v.attr("class","basic label-container"),u&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",u),r&&t.look!=="handDrawn"&&v.selectChildren("path").attr("style",r),jn(t,v),t.intersect=function(x){return kn.polygon(t,m,x)},s}ie(Vue,"trapezoidalPentagon");async function Wue(e,t){var w;const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=Ki((w=ls().flowchart)==null?void 0:w.htmlLabels),l=i.width+(t.padding??0),c=l+i.height,u=l+i.height,d=[{x:0,y:0},{x:u,y:0},{x:u/2,y:-c}],{cssStyles:h}=t,m=An.svg(s),y=Nn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=Jr(d),v=m.path(b,y),x=s.insert(()=>v,":first-child").attr("transform",`translate(${-c/2}, ${c/2})`);return h&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",h),r&&t.look!=="handDrawn"&&x.selectChildren("path").attr("style",r),t.width=l,t.height=c,jn(t,x),a.attr("transform",`translate(${-i.width/2-(i.x-(i.left??0))}, ${c/2-(i.height+(t.padding??0)/(o?2:1)-(i.y-(i.top??0)))})`),t.intersect=function(S){return Ut.info("Triangle intersect",t,d,S),kn.polygon(t,d,S)},s}ie(Wue,"triangle");async function Hue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=l/8,u=l+c,{cssStyles:d}=t,m=70-o,y=m>0?m/2:0,b=An.svg(s),v=Nn(t,{});t.look!=="handDrawn"&&(v.roughness=0,v.fillStyle="solid");const x=[{x:-o/2-y,y:u/2},...Zh(-o/2-y,u/2,o/2+y,u/2,c,.8),{x:o/2+y,y:-u/2},{x:-o/2-y,y:-u/2}],w=Jr(x),S=b.path(w,v),k=s.insert(()=>S,":first-child");return k.attr("class","basic label-container"),d&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",d),r&&t.look!=="handDrawn"&&k.selectAll("path").attr("style",r),k.attr("transform",`translate(0,${-c/2})`),a.attr("transform",`translate(${-o/2+(t.padding??0)-(i.x-(i.left??0))},${-l/2+(t.padding??0)-c-(i.y-(i.top??0))})`),jn(t,k),t.intersect=function(C){return kn.polygon(t,x,C)},s}ie(Hue,"waveEdgedRectangle");async function Gue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i}=await hr(e,t,sr(t)),a=100,o=50,l=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),c=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),u=l/c;let d=l,h=c;d>h*u?h=d/u:d=h*u,d=Math.max(d,a),h=Math.max(h,o);const m=Math.min(h*.2,h/4),y=h+m*2,{cssStyles:b}=t,v=An.svg(s),x=Nn(t,{});t.look!=="handDrawn"&&(x.roughness=0,x.fillStyle="solid");const w=[{x:-d/2,y:y/2},...Zh(-d/2,y/2,d/2,y/2,m,1),{x:d/2,y:-y/2},...Zh(d/2,-y/2,-d/2,-y/2,m,-1)],S=Jr(w),k=v.path(S,x),C=s.insert(()=>k,":first-child");return C.attr("class","basic label-container"),b&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",b),r&&t.look!=="handDrawn"&&C.selectAll("path").attr("style",r),jn(t,C),t.intersect=function(T){return kn.polygon(t,w,T)},s}ie(Gue,"waveRectangle");async function Kue(e,t){const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const{shapeSvg:s,bbox:i,label:a}=await hr(e,t,sr(t)),o=Math.max(i.width+(t.padding??0)*2,(t==null?void 0:t.width)??0),l=Math.max(i.height+(t.padding??0)*2,(t==null?void 0:t.height)??0),c=5,u=-o/2,d=-l/2,{cssStyles:h}=t,m=An.svg(s),y=Nn(t,{}),b=[{x:u-c,y:d-c},{x:u-c,y:d+l},{x:u+o,y:d+l},{x:u+o,y:d-c}],v=`M${u-c},${d-c} L${u+o},${d-c} L${u+o},${d+l} L${u-c},${d+l} L${u-c},${d-c}
                M${u-c},${d} L${u+o},${d}
                M${u},${d-c} L${u},${d+l}`;t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const x=m.path(v,y),w=s.insert(()=>x,":first-child");return w.attr("transform",`translate(${c/2}, ${c/2})`),w.attr("class","basic label-container"),h&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",h),r&&t.look!=="handDrawn"&&w.selectAll("path").attr("style",r),a.attr("transform",`translate(${-(i.width/2)+c/2-(i.x-(i.left??0))}, ${-(i.height/2)+c/2-(i.y-(i.top??0))})`),jn(t,w),t.intersect=function(S){return kn.polygon(t,b,S)},s}ie(Kue,"windowPane");async function h5(e,t){var te,W,Q;const n=t;if(n.alias&&(t.label=n.alias),t.look==="handDrawn"){const{themeVariables:ee}=zo(),{background:re}=ee,pe={...t,id:t.id+"-background",look:"default",cssStyles:["stroke: none",`fill: ${re}`]};await h5(e,pe)}const r=zo();t.useHtmlLabels=r.htmlLabels;let s=((te=r.er)==null?void 0:te.diagramPadding)??10,i=((W=r.er)==null?void 0:W.entityPadding)??6;const{cssStyles:a}=t,{labelStyles:o}=Pn(t);if(n.attributes.length===0&&t.label){const ee={rx:0,ry:0,labelPaddingX:s,labelPaddingY:s*1.5};nf(t.label,r)+ee.labelPaddingX*2<r.er.minEntityWidth&&(t.width=r.er.minEntityWidth);const re=await S_(e,t,ee);if(!Ki(r.htmlLabels)){const pe=re.select("text"),de=(Q=pe.node())==null?void 0:Q.getBBox();pe.attr("transform",`translate(${-de.width/2}, 0)`)}return re}r.htmlLabels||(s*=1.25,i*=1.25);let l=sr(t);l||(l="node default");const c=e.insert("g").attr("class",l).attr("id",t.domId||t.id),u=await x0(c,t.label??"",r,0,0,["name"],o);u.height+=i;let d=0;const h=[];let m=0,y=0,b=0,v=0,x=!0,w=!0;for(const ee of n.attributes){const re=await x0(c,ee.type,r,0,d,["attribute-type"],o);m=Math.max(m,re.width+s);const pe=await x0(c,ee.name,r,0,d,["attribute-name"],o);y=Math.max(y,pe.width+s);const de=await x0(c,ee.keys.join(),r,0,d,["attribute-keys"],o);b=Math.max(b,de.width+s);const Oe=await x0(c,ee.comment,r,0,d,["attribute-comment"],o);v=Math.max(v,Oe.width+s),d+=Math.max(re.height,pe.height,de.height,Oe.height)+i,h.push(d)}h.pop();let S=4;b<=s&&(x=!1,b=0,S--),v<=s&&(w=!1,v=0,S--);const k=c.node().getBBox();if(u.width+s*2-(m+y+b+v)>0){const ee=u.width+s*2-(m+y+b+v);m+=ee/S,y+=ee/S,b>0&&(b+=ee/S),v>0&&(v+=ee/S)}const C=m+y+b+v,T=An.svg(c),A=Nn(t,{});t.look!=="handDrawn"&&(A.roughness=0,A.fillStyle="solid");const N=Math.max(k.width+s*2,(t==null?void 0:t.width)||0,C),I=Math.max(k.height+(h[0]||d)+i,(t==null?void 0:t.height)||0),O=-N/2,B=-I/2;c.selectAll("g:not(:first-child)").each((ee,re,pe)=>{const de=Zr(pe[re]),Oe=de.attr("transform");let Fe=0,Se=0;if(Oe){const qe=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(Oe);qe&&(Fe=parseFloat(qe[1]),Se=parseFloat(qe[2]),de.attr("class").includes("attribute-name")?Fe+=m:de.attr("class").includes("attribute-keys")?Fe+=m+y:de.attr("class").includes("attribute-comment")&&(Fe+=m+y+b))}de.attr("transform",`translate(${O+s/2+Fe}, ${Se+B+u.height+i/2})`)}),c.select(".name").attr("transform","translate("+-u.width/2+", "+(B+i/2)+")");const D=T.rectangle(O,B,N,I,A),H=c.insert(()=>D,":first-child").attr("style",a.join("")),{themeVariables:P}=zo(),{rowEven:K,rowOdd:U,nodeBorder:V}=P;h.push(0);for(const[ee,re]of h.entries()){if(ee===0&&h.length>1)continue;const pe=ee%2===0&&re!==0,de=T.rectangle(O,u.height+B+re,N,u.height,{...A,fill:pe?K:U,stroke:V});c.insert(()=>de,"g.label").attr("style",a.join("")).attr("class",`row-rect-${ee%2===0?"even":"odd"}`)}let L=T.line(O,u.height+B,N+O,u.height+B,A);c.insert(()=>L).attr("class","divider"),L=T.line(m+O,u.height+B,m+O,I+B,A),c.insert(()=>L).attr("class","divider"),x&&(L=T.line(m+y+O,u.height+B,m+y+O,I+B,A),c.insert(()=>L).attr("class","divider")),w&&(L=T.line(m+y+b+O,u.height+B,m+y+b+O,I+B,A),c.insert(()=>L).attr("class","divider"));for(const ee of h)L=T.line(O,u.height+B+ee,N+O,u.height+B+ee,A),c.insert(()=>L).attr("class","divider");return jn(t,H),t.intersect=function(ee){return kn.rect(t,ee)},c}ie(h5,"erBox");async function x0(e,t,n,r=0,s=0,i=[],a=""){const o=e.insert("g").attr("class",`label ${i.join(" ")}`).attr("transform",`translate(${r}, ${s})`).attr("style",a);t!==RV(t)&&(t=RV(t),t=t.replaceAll("<","&lt;").replaceAll(">","&gt;"));const l=o.node().appendChild(await bp(o,t,{width:nf(t,n)+100,style:a,useHtmlLabels:n.htmlLabels},n));if(t.includes("&lt;")||t.includes("&gt;")){let u=l.children[0];for(u.textContent=u.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">");u.childNodes[0];)u=u.childNodes[0],u.textContent=u.textContent.replaceAll("&lt;","<").replaceAll("&gt;",">")}let c=l.getBBox();if(Ki(n.htmlLabels)){const u=l.children[0];u.style.textAlign="start";const d=Zr(l);c=u.getBoundingClientRect(),d.attr("width",c.width),d.attr("height",c.height)}return c}ie(x0,"addText");async function Yue(e,t,n,r,s=n.class.padding??12){const i=r?0:3,a=e.insert("g").attr("class",sr(t)).attr("id",t.domId||t.id);let o=null,l=null,c=null,u=null,d=0,h=0,m=0;if(o=a.insert("g").attr("class","annotation-group text"),t.annotations.length>0){const w=t.annotations[0];await Tx(o,{text:`${w}`},0),d=o.node().getBBox().height}l=a.insert("g").attr("class","label-group text"),await Tx(l,t,0,["font-weight: bolder"]);const y=l.node().getBBox();h=y.height,c=a.insert("g").attr("class","members-group text");let b=0;for(const w of t.members){const S=await Tx(c,w,b,[w.parseClassifier()]);b+=S+i}m=c.node().getBBox().height,m<=0&&(m=s/2),u=a.insert("g").attr("class","methods-group text");let v=0;for(const w of t.methods){const S=await Tx(u,w,v,[w.parseClassifier()]);v+=S+i}let x=a.node().getBBox();if(o!==null){const w=o.node().getBBox();o.attr("transform",`translate(${-w.width/2})`)}return l.attr("transform",`translate(${-y.width/2}, ${d})`),x=a.node().getBBox(),c.attr("transform",`translate(0, ${d+h+s*2})`),x=a.node().getBBox(),u.attr("transform",`translate(0, ${d+h+(m?m+s*4:s*2)})`),x=a.node().getBBox(),{shapeSvg:a,bbox:x}}ie(Yue,"textHelper");async function Tx(e,t,n,r=[]){const s=e.insert("g").attr("class","label").attr("style",r.join("; ")),i=zo();let a="useHtmlLabels"in t?t.useHtmlLabels:Ki(i.htmlLabels)??!0,o="";"text"in t?o=t.text:o=t.label,!a&&o.startsWith("\\")&&(o=o.substring(1)),Dy(o)&&(a=!0);const l=await bp(s,S6(ug(o)),{width:nf(o,i)+50,classes:"markdown-node-label",useHtmlLabels:a},i);let c,u=1;if(a){const d=l.children[0],h=Zr(l);u=d.innerHTML.split("<br>").length,d.innerHTML.includes("</math>")&&(u+=d.innerHTML.split("<mrow>").length-1);const m=d.getElementsByTagName("img");if(m){const y=o.replace(/<img[^>]*>/g,"").trim()==="";await Promise.all([...m].map(b=>new Promise(v=>{function x(){var w;if(b.style.display="flex",b.style.flexDirection="column",y){const S=((w=i.fontSize)==null?void 0:w.toString())??window.getComputedStyle(document.body).fontSize,C=parseInt(S,10)*5+"px";b.style.minWidth=C,b.style.maxWidth=C}else b.style.width="100%";v(b)}ie(x,"setupImage"),setTimeout(()=>{b.complete&&x()}),b.addEventListener("error",x),b.addEventListener("load",x)})))}c=d.getBoundingClientRect(),h.attr("width",c.width),h.attr("height",c.height)}else{r.includes("font-weight: bolder")&&Zr(l).selectAll("tspan").attr("font-weight",""),u=l.children.length;const d=l.children[0];(l.textContent===""||l.textContent.includes("&gt"))&&(d.textContent=o[0]+o.substring(1).replaceAll("&gt;",">").replaceAll("&lt;","<").trim(),o[1]===" "&&(d.textContent=d.textContent[0]+" "+d.textContent.substring(1))),d.textContent==="undefined"&&(d.textContent=""),c=l.getBBox()}return s.attr("transform","translate(0,"+(-c.height/(2*u)+n)+")"),c.height}ie(Tx,"addText");async function Zue(e,t){var I,O;const n=ls(),r=n.class.padding??12,s=r,i=t.useHtmlLabels??Ki(n.htmlLabels)??!0,a=t;a.annotations=a.annotations??[],a.members=a.members??[],a.methods=a.methods??[];const{shapeSvg:o,bbox:l}=await Yue(e,t,n,i,s),{labelStyles:c,nodeStyles:u}=Pn(t);t.labelStyle=c,t.cssStyles=a.styles||"";const d=((I=a.styles)==null?void 0:I.join(";"))||u||"";t.cssStyles||(t.cssStyles=d.replaceAll("!important","").split(";"));const h=a.members.length===0&&a.methods.length===0&&!((O=n.class)!=null&&O.hideEmptyMembersBox),m=An.svg(o),y=Nn(t,{});t.look!=="handDrawn"&&(y.roughness=0,y.fillStyle="solid");const b=l.width;let v=l.height;a.members.length===0&&a.methods.length===0?v+=s:a.members.length>0&&a.methods.length===0&&(v+=s*2);const x=-b/2,w=-v/2,S=m.rectangle(x-r,w-r-(h?r:a.members.length===0&&a.methods.length===0?-r/2:0),b+2*r,v+2*r+(h?r*2:a.members.length===0&&a.methods.length===0?-r:0),y),k=o.insert(()=>S,":first-child");k.attr("class","basic label-container");const C=k.node().getBBox();o.selectAll(".text").each((B,D,H)=>{var te;const P=Zr(H[D]),K=P.attr("transform");let U=0;if(K){const Q=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(K);Q&&(U=parseFloat(Q[2]))}let V=U+w+r-(h?r:a.members.length===0&&a.methods.length===0?-r/2:0);i||(V-=4);let L=x;(P.attr("class").includes("label-group")||P.attr("class").includes("annotation-group"))&&(L=-((te=P.node())==null?void 0:te.getBBox().width)/2||0,o.selectAll("text").each(function(W,Q,ee){window.getComputedStyle(ee[Q]).textAnchor==="middle"&&(L=0)})),P.attr("transform",`translate(${L}, ${V})`)});const T=o.select(".annotation-group").node().getBBox().height-(h?r/2:0)||0,A=o.select(".label-group").node().getBBox().height-(h?r/2:0)||0,N=o.select(".members-group").node().getBBox().height-(h?r/2:0)||0;if(a.members.length>0||a.methods.length>0||h){const B=m.line(C.x,T+A+w+r,C.x+C.width,T+A+w+r,y);o.insert(()=>B).attr("class","divider").attr("style",d)}if(h||a.members.length>0||a.methods.length>0){const B=m.line(C.x,T+A+N+w+s*2+r,C.x+C.width,T+A+N+w+r+s*2,y);o.insert(()=>B).attr("class","divider").attr("style",d)}if(a.look!=="handDrawn"&&o.selectAll("path").attr("style",d),k.select(":nth-child(2)").attr("style",d),o.selectAll(".divider").select("path").attr("style",d),t.labelStyle?o.selectAll("span").attr("style",t.labelStyle):o.selectAll("span").attr("style",d),!i){const B=RegExp(/color\s*:\s*([^;]*)/),D=B.exec(d);if(D){const H=D[0].replace("color","fill");o.selectAll("tspan").attr("style",H)}else if(c){const H=B.exec(c);if(H){const P=H[0].replace("color","fill");o.selectAll("tspan").attr("style",P)}}}return jn(t,k),t.intersect=function(B){return kn.rect(t,B)},o}ie(Zue,"classBox");async function Xue(e,t){var T,A;const{labelStyles:n,nodeStyles:r}=Pn(t);t.labelStyle=n;const s=t,i=t,a=20,o=20,l="verifyMethod"in t,c=sr(t),u=e.insert("g").attr("class",c).attr("id",t.domId??t.id);let d;l?d=await uu(u,`&lt;&lt;${s.type}&gt;&gt;`,0,t.labelStyle):d=await uu(u,"&lt;&lt;Element&gt;&gt;",0,t.labelStyle);let h=d;const m=await uu(u,s.name,h,t.labelStyle+"; font-weight: bold;");if(h+=m+o,l){const N=await uu(u,`${s.requirementId?`Id: ${s.requirementId}`:""}`,h,t.labelStyle);h+=N;const I=await uu(u,`${s.text?`Text: ${s.text}`:""}`,h,t.labelStyle);h+=I;const O=await uu(u,`${s.risk?`Risk: ${s.risk}`:""}`,h,t.labelStyle);h+=O,await uu(u,`${s.verifyMethod?`Verification: ${s.verifyMethod}`:""}`,h,t.labelStyle)}else{const N=await uu(u,`${i.type?`Type: ${i.type}`:""}`,h,t.labelStyle);h+=N,await uu(u,`${i.docRef?`Doc Ref: ${i.docRef}`:""}`,h,t.labelStyle)}const y=(((T=u.node())==null?void 0:T.getBBox().width)??200)+a,b=(((A=u.node())==null?void 0:A.getBBox().height)??200)+a,v=-y/2,x=-b/2,w=An.svg(u),S=Nn(t,{});t.look!=="handDrawn"&&(S.roughness=0,S.fillStyle="solid");const k=w.rectangle(v,x,y,b,S),C=u.insert(()=>k,":first-child");if(C.attr("class","basic label-container").attr("style",r),u.selectAll(".label").each((N,I,O)=>{const B=Zr(O[I]),D=B.attr("transform");let H=0,P=0;if(D){const L=RegExp(/translate\(([^,]+),([^)]+)\)/).exec(D);L&&(H=parseFloat(L[1]),P=parseFloat(L[2]))}const K=P-b/2;let U=v+a/2;(I===0||I===1)&&(U=H),B.attr("transform",`translate(${U}, ${K+a})`)}),h>d+m+o){const N=w.line(v,x+d+m+o,v+y,x+d+m+o,S);u.insert(()=>N).attr("style",r)}return jn(t,C),t.intersect=function(N){return kn.rect(t,N)},u}ie(Xue,"requirementBox");async function uu(e,t,n,r=""){if(t==="")return 0;const s=e.insert("g").attr("class","label").attr("style",r),i=ls(),a=i.htmlLabels??!0,o=await bp(s,S6(ug(t)),{width:nf(t,i)+50,classes:"markdown-node-label",useHtmlLabels:a,style:r},i);let l;if(a){const c=o.children[0],u=Zr(o);l=c.getBoundingClientRect(),u.attr("width",l.width),u.attr("height",l.height)}else{const c=o.children[0];for(const u of c.children)u.textContent=u.textContent.replaceAll("&gt;",">").replaceAll("&lt;","<"),r&&u.setAttribute("style",r);l=o.getBBox(),l.height+=6}return s.attr("transform",`translate(${-l.width/2},${-l.height/2+n})`),l.height}ie(uu,"addText");var got=ie(e=>{switch(e){case"Very High":return"red";case"High":return"orange";case"Medium":return null;case"Low":return"blue";case"Very Low":return"lightblue"}},"colorFromPriority");async function Jue(e,t,{config:n}){var D,H;const{labelStyles:r,nodeStyles:s}=Pn(t);t.labelStyle=r||"";const i=10,a=t.width;t.width=(t.width??200)-10;const{shapeSvg:o,bbox:l,label:c}=await hr(e,t,sr(t)),u=t.padding||10;let d="",h;"ticket"in t&&t.ticket&&((D=n==null?void 0:n.kanban)!=null&&D.ticketBaseUrl)&&(d=(H=n==null?void 0:n.kanban)==null?void 0:H.ticketBaseUrl.replace("#TICKET#",t.ticket),h=o.insert("svg:a",":first-child").attr("class","kanban-ticket-link").attr("xlink:href",d).attr("target","_blank"));const m={useHtmlLabels:t.useHtmlLabels,labelStyle:t.labelStyle||"",width:t.width,img:t.img,padding:t.padding||8,centerLabel:!1};let y,b;h?{label:y,bbox:b}=await H3(h,"ticket"in t&&t.ticket||"",m):{label:y,bbox:b}=await H3(o,"ticket"in t&&t.ticket||"",m);const{label:v,bbox:x}=await H3(o,"assigned"in t&&t.assigned||"",m);t.width=a;const w=10,S=(t==null?void 0:t.width)||0,k=Math.max(b.height,x.height)/2,C=Math.max(l.height+w*2,(t==null?void 0:t.height)||0)+k,T=-S/2,A=-C/2;c.attr("transform","translate("+(u-S/2)+", "+(-k-l.height/2)+")"),y.attr("transform","translate("+(u-S/2)+", "+(-k+l.height/2)+")"),v.attr("transform","translate("+(u+S/2-x.width-2*i)+", "+(-k+l.height/2)+")");let N;const{rx:I,ry:O}=t,{cssStyles:B}=t;if(t.look==="handDrawn"){const P=An.svg(o),K=Nn(t,{}),U=I||O?P.path(wf(T,A,S,C,I||0),K):P.rectangle(T,A,S,C,K);N=o.insert(()=>U,":first-child"),N.attr("class","basic label-container").attr("style",B||null)}else{N=o.insert("rect",":first-child"),N.attr("class","basic label-container __APA__").attr("style",s).attr("rx",I??5).attr("ry",O??5).attr("x",T).attr("y",A).attr("width",S).attr("height",C);const P="priority"in t&&t.priority;if(P){const K=o.append("line"),U=T+2,V=A+Math.floor((I??0)/2),L=A+C-Math.floor((I??0)/2);K.attr("x1",U).attr("y1",V).attr("x2",U).attr("y2",L).attr("stroke-width","4").attr("stroke",got(P))}}return jn(t,N),t.height=C,t.intersect=function(P){return kn.rect(t,P)},o}ie(Jue,"kanbanItem");var yot=[{semanticName:"Process",name:"Rectangle",shortName:"rect",description:"Standard process shape",aliases:["proc","process","rectangle"],internalAliases:["squareRect"],handler:jue},{semanticName:"Event",name:"Rounded Rectangle",shortName:"rounded",description:"Represents an event",aliases:["event"],internalAliases:["roundedRect"],handler:Nue},{semanticName:"Terminal Point",name:"Stadium",shortName:"stadium",description:"Terminal point",aliases:["terminal","pill"],handler:Pue},{semanticName:"Subprocess",name:"Framed Rectangle",shortName:"fr-rect",description:"Subprocess",aliases:["subprocess","subproc","framed-rectangle","subroutine"],handler:Lue},{semanticName:"Database",name:"Cylinder",shortName:"cyl",description:"Database storage",aliases:["db","database","cylinder"],handler:rue},{semanticName:"Start",name:"Circle",shortName:"circle",description:"Starting point",aliases:["circ"],handler:Zce},{semanticName:"Decision",name:"Diamond",shortName:"diam",description:"Decision-making step",aliases:["decision","diamond","question"],handler:Tue},{semanticName:"Prepare Conditional",name:"Hexagon",shortName:"hex",description:"Preparation or condition step",aliases:["hexagon","prepare"],handler:uue},{semanticName:"Data Input/Output",name:"Lean Right",shortName:"lean-r",description:"Represents input or output",aliases:["lean-right","in-out"],internalAliases:["lean_right"],handler:xue},{semanticName:"Data Input/Output",name:"Lean Left",shortName:"lean-l",description:"Represents output or input",aliases:["lean-left","out-in"],internalAliases:["lean_left"],handler:vue},{semanticName:"Priority Action",name:"Trapezoid Base Bottom",shortName:"trap-b",description:"Priority action",aliases:["priority","trapezoid-bottom","trapezoid"],handler:que},{semanticName:"Manual Operation",name:"Trapezoid Base Top",shortName:"trap-t",description:"Represents a manual task",aliases:["manual","trapezoid-top","inv-trapezoid"],internalAliases:["inv_trapezoid"],handler:yue},{semanticName:"Stop",name:"Double Circle",shortName:"dbl-circ",description:"Represents a stop point",aliases:["double-circle"],internalAliases:["doublecircle"],handler:iue},{semanticName:"Text Block",name:"Text Block",shortName:"text",description:"Text block",handler:zue},{semanticName:"Card",name:"Notched Rectangle",shortName:"notch-rect",description:"Represents a card",aliases:["card","notched-rectangle"],handler:Kce},{semanticName:"Lined/Shaded Process",name:"Lined Rectangle",shortName:"lin-rect",description:"Lined process shape",aliases:["lined-rectangle","lined-process","lin-proc","shaded-process"],handler:Mue},{semanticName:"Start",name:"Small Circle",shortName:"sm-circ",description:"Small starting point",aliases:["start","small-circle"],internalAliases:["stateStart"],handler:Fue},{semanticName:"Stop",name:"Framed Circle",shortName:"fr-circ",description:"Stop point",aliases:["stop","framed-circle"],internalAliases:["stateEnd"],handler:Due},{semanticName:"Fork/Join",name:"Filled Rectangle",shortName:"fork",description:"Fork or join in process flow",aliases:["join"],internalAliases:["forkJoin"],handler:lue},{semanticName:"Collate",name:"Hourglass",shortName:"hourglass",description:"Represents a collate operation",aliases:["hourglass","collate"],handler:due},{semanticName:"Comment",name:"Curly Brace",shortName:"brace",description:"Adds a comment",aliases:["comment","brace-l"],handler:Qce},{semanticName:"Comment Right",name:"Curly Brace",shortName:"brace-r",description:"Adds a comment",handler:eue},{semanticName:"Comment with braces on both sides",name:"Curly Braces",shortName:"braces",description:"Adds a comment",handler:tue},{semanticName:"Com Link",name:"Lightning Bolt",shortName:"bolt",description:"Communication link",aliases:["com-link","lightning-bolt"],handler:wue},{semanticName:"Document",name:"Document",shortName:"doc",description:"Represents a document",aliases:["doc","document"],handler:Hue},{semanticName:"Delay",name:"Half-Rounded Rectangle",shortName:"delay",description:"Represents a delay",aliases:["half-rounded-rectangle"],handler:cue},{semanticName:"Direct Access Storage",name:"Horizontal Cylinder",shortName:"h-cyl",description:"Direct access storage",aliases:["das","horizontal-cylinder"],handler:Uue},{semanticName:"Disk Storage",name:"Lined Cylinder",shortName:"lin-cyl",description:"Disk storage",aliases:["disk","lined-cylinder"],handler:_ue},{semanticName:"Display",name:"Curved Trapezoid",shortName:"curv-trap",description:"Represents a display",aliases:["curved-trapezoid","display"],handler:nue},{semanticName:"Divided Process",name:"Divided Rectangle",shortName:"div-rect",description:"Divided process shape",aliases:["div-proc","divided-rectangle","divided-process"],handler:sue},{semanticName:"Extract",name:"Triangle",shortName:"tri",description:"Extraction process",aliases:["extract","triangle"],handler:Wue},{semanticName:"Internal Storage",name:"Window Pane",shortName:"win-pane",description:"Internal storage",aliases:["internal-storage","window-pane"],handler:Kue},{semanticName:"Junction",name:"Filled Circle",shortName:"f-circ",description:"Junction point",aliases:["junction","filled-circle"],handler:aue},{semanticName:"Loop Limit",name:"Trapezoidal Pentagon",shortName:"notch-pent",description:"Loop limit step",aliases:["loop-limit","notched-pentagon"],handler:Vue},{semanticName:"Manual File",name:"Flipped Triangle",shortName:"flip-tri",description:"Manual file operation",aliases:["manual-file","flipped-triangle"],handler:oue},{semanticName:"Manual Input",name:"Sloped Rectangle",shortName:"sl-rect",description:"Manual input step",aliases:["manual-input","sloped-rectangle"],handler:Iue},{semanticName:"Multi-Document",name:"Stacked Document",shortName:"docs",description:"Multiple documents",aliases:["documents","st-doc","stacked-document"],handler:kue},{semanticName:"Multi-Process",name:"Stacked Rectangle",shortName:"st-rect",description:"Multiple processes",aliases:["procs","processes","stacked-rectangle"],handler:Cue},{semanticName:"Stored Data",name:"Bow Tie Rectangle",shortName:"bow-rect",description:"Stored data",aliases:["stored-data","bow-tie-rectangle"],handler:Gce},{semanticName:"Summary",name:"Crossed Circle",shortName:"cross-circ",description:"Summary",aliases:["summary","crossed-circle"],handler:Jce},{semanticName:"Tagged Document",name:"Tagged Document",shortName:"tag-doc",description:"Tagged document",aliases:["tag-doc","tagged-document"],handler:$ue},{semanticName:"Tagged Process",name:"Tagged Rectangle",shortName:"tag-rect",description:"Tagged process",aliases:["tagged-rectangle","tag-proc","tagged-process"],handler:Bue},{semanticName:"Paper Tape",name:"Flag",shortName:"flag",description:"Paper tape",aliases:["paper-tape"],handler:Gue},{semanticName:"Odd",name:"Odd",shortName:"odd",description:"Odd shape",internalAliases:["rect_left_inv_arrow"],handler:Aue},{semanticName:"Lined Document",name:"Lined Document",shortName:"lin-doc",description:"Lined document",aliases:["lined-document"],handler:Sue}],bot=ie(()=>{const t=[...Object.entries({state:Oue,choice:Yce,note:Eue,rectWithTitle:Rue,labelRect:bue,iconSquare:mue,iconCircle:hue,icon:fue,iconRounded:pue,imageSquare:gue,anchor:Hce,kanbanItem:Jue,classBox:Zue,erBox:h5,requirementBox:Xue}),...yot.flatMap(n=>[n.shortName,..."aliases"in n?n.aliases:[],..."internalAliases"in n?n.internalAliases:[]].map(s=>[s,n.handler]))];return Object.fromEntries(t)},"generateShapeMap"),Que=bot();function vot(e){return e in Que}ie(vot,"isValidShape");var kA=new Map;async function ede(e,t,n){let r,s;t.shape==="rect"&&(t.rx&&t.ry?t.shape="roundedRect":t.shape="squareRect");const i=t.shape?Que[t.shape]:void 0;if(!i)throw new Error(`No such shape: ${t.shape}. Please check your syntax.`);if(t.link){let a;n.config.securityLevel==="sandbox"?a="_top":t.linkTarget&&(a=t.linkTarget||"_blank"),r=e.insert("svg:a").attr("xlink:href",t.link).attr("target",a??null),s=await i(r,t,n)}else s=await i(e,t,n),r=s;return t.tooltip&&s.attr("title",t.tooltip),kA.set(t.id,r),t.haveCallback&&r.attr("class",r.attr("class")+" clickable"),r}ie(ede,"insertNode");var dft=ie((e,t)=>{kA.set(t.id,e)},"setNodeElem"),fft=ie(()=>{kA.clear()},"clear"),hft=ie(e=>{const t=kA.get(e.id);Ut.trace("Transforming node",e.diff,e,"translate("+(e.x-e.width/2-5)+", "+e.width/2+")");const n=8,r=e.diff||0;return e.clusterNode?t.attr("transform","translate("+(e.x+r-e.width/2)+", "+(e.y-e.height/2-n)+")"):t.attr("transform","translate("+e.x+", "+e.y+")"),r},"positionNode"),xot=ie((e,t,n,r,s,i)=>{t.arrowTypeStart&&OW(e,"start",t.arrowTypeStart,n,r,s,i),t.arrowTypeEnd&&OW(e,"end",t.arrowTypeEnd,n,r,s,i)},"addEdgeMarkers"),wot={arrow_cross:{type:"cross",fill:!1},arrow_point:{type:"point",fill:!0},arrow_barb:{type:"barb",fill:!0},arrow_circle:{type:"circle",fill:!1},aggregation:{type:"aggregation",fill:!1},extension:{type:"extension",fill:!1},composition:{type:"composition",fill:!0},dependency:{type:"dependency",fill:!0},lollipop:{type:"lollipop",fill:!1},only_one:{type:"onlyOne",fill:!1},zero_or_one:{type:"zeroOrOne",fill:!1},one_or_more:{type:"oneOrMore",fill:!1},zero_or_more:{type:"zeroOrMore",fill:!1},requirement_arrow:{type:"requirement_arrow",fill:!1},requirement_contains:{type:"requirement_contains",fill:!1}},OW=ie((e,t,n,r,s,i,a)=>{var d;const o=wot[n];if(!o){Ut.warn(`Unknown arrow type: ${n}`);return}const l=o.type,u=`${s}_${i}-${l}${t==="start"?"Start":"End"}`;if(a&&a.trim()!==""){const h=a.replace(/[^\dA-Za-z]/g,"_"),m=`${u}_${h}`;if(!document.getElementById(m)){const y=document.getElementById(u);if(y){const b=y.cloneNode(!0);b.id=m,b.querySelectorAll("path, circle, line").forEach(x=>{x.setAttribute("stroke",a),o.fill&&x.setAttribute("fill",a)}),(d=y.parentNode)==null||d.appendChild(b)}}e.attr(`marker-${t}`,`url(${r}#${m})`)}else e.attr(`marker-${t}`,`url(${r}#${u})`)},"addEdgeMarker"),yE=new Map,wa=new Map,pft=ie(()=>{yE.clear(),wa.clear()},"clear"),ox=ie(e=>e?e.reduce((n,r)=>n+";"+r,""):"","getLabelStyles"),_ot=ie(async(e,t)=>{let n=Ki(ls().flowchart.htmlLabels);const r=await bp(e,t.label,{style:ox(t.labelStyle),useHtmlLabels:n,addSvgBackground:!0,isNode:!1});Ut.info("abc82",t,t.labelType);const s=e.insert("g").attr("class","edgeLabel"),i=s.insert("g").attr("class","label");i.node().appendChild(r);let a=r.getBBox();if(n){const l=r.children[0],c=Zr(r);a=l.getBoundingClientRect(),c.attr("width",a.width),c.attr("height",a.height)}i.attr("transform","translate("+-a.width/2+", "+-a.height/2+")"),yE.set(t.id,s),t.width=a.width,t.height=a.height;let o;if(t.startLabelLeft){const l=await mm(t.startLabelLeft,ox(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),wa.get(t.id)||wa.set(t.id,{}),wa.get(t.id).startLeft=c,Ax(o,t.startLabelLeft)}if(t.startLabelRight){const l=await mm(t.startLabelRight,ox(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=c.node().appendChild(l),u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),wa.get(t.id)||wa.set(t.id,{}),wa.get(t.id).startRight=c,Ax(o,t.startLabelRight)}if(t.endLabelLeft){const l=await mm(t.endLabelLeft,ox(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),c.node().appendChild(l),wa.get(t.id)||wa.set(t.id,{}),wa.get(t.id).endLeft=c,Ax(o,t.endLabelLeft)}if(t.endLabelRight){const l=await mm(t.endLabelRight,ox(t.labelStyle)),c=e.insert("g").attr("class","edgeTerminals"),u=c.insert("g").attr("class","inner");o=u.node().appendChild(l);const d=l.getBBox();u.attr("transform","translate("+-d.width/2+", "+-d.height/2+")"),c.node().appendChild(l),wa.get(t.id)||wa.set(t.id,{}),wa.get(t.id).endRight=c,Ax(o,t.endLabelRight)}return r},"insertEdgeLabel");function Ax(e,t){ls().flowchart.htmlLabels&&e&&(e.style.width=t.length*9+"px",e.style.height="12px")}ie(Ax,"setTerminalWidth");var Sot=ie((e,t)=>{Ut.debug("Moving label abc88 ",e.id,e.label,yE.get(e.id),t);let n=t.updatedPath?t.updatedPath:t.originalPath;const r=ls(),{subGraphTitleTotalMargin:s}=M6(r);if(e.label){const i=yE.get(e.id);let a=e.x,o=e.y;if(n){const l=xu.calcLabelPosition(n);Ut.debug("Moving label "+e.label+" from (",a,",",o,") to (",l.x,",",l.y,") abc88"),t.updatedPath&&(a=l.x,o=l.y)}i.attr("transform",`translate(${a}, ${o+s/2})`)}if(e.startLabelLeft){const i=wa.get(e.id).startLeft;let a=e.x,o=e.y;if(n){const l=xu.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_left",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.startLabelRight){const i=wa.get(e.id).startRight;let a=e.x,o=e.y;if(n){const l=xu.calcTerminalLabelPosition(e.arrowTypeStart?10:0,"start_right",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.endLabelLeft){const i=wa.get(e.id).endLeft;let a=e.x,o=e.y;if(n){const l=xu.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_left",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}if(e.endLabelRight){const i=wa.get(e.id).endRight;let a=e.x,o=e.y;if(n){const l=xu.calcTerminalLabelPosition(e.arrowTypeEnd?10:0,"end_right",n);a=l.x,o=l.y}i.attr("transform",`translate(${a}, ${o})`)}},"positionEdgeLabel"),Cot=ie((e,t)=>{const n=e.x,r=e.y,s=Math.abs(t.x-n),i=Math.abs(t.y-r),a=e.width/2,o=e.height/2;return s>=a||i>=o},"outsideNode"),kot=ie((e,t,n)=>{Ut.debug(`intersection calc abc89:
  outsidePoint: ${JSON.stringify(t)}
  insidePoint : ${JSON.stringify(n)}
  node        : x:${e.x} y:${e.y} w:${e.width} h:${e.height}`);const r=e.x,s=e.y,i=Math.abs(r-n.x),a=e.width/2;let o=n.x<t.x?a-i:a+i;const l=e.height/2,c=Math.abs(t.y-n.y),u=Math.abs(t.x-n.x);if(Math.abs(s-t.y)*a>Math.abs(r-t.x)*l){let d=n.y<t.y?t.y-l-s:s-l-t.y;o=u*d/c;const h={x:n.x<t.x?n.x+o:n.x-u+o,y:n.y<t.y?n.y+c-d:n.y-c+d};return o===0&&(h.x=t.x,h.y=t.y),u===0&&(h.x=t.x),c===0&&(h.y=t.y),Ut.debug(`abc89 top/bottom calc, Q ${c}, q ${d}, R ${u}, r ${o}`,h),h}else{n.x<t.x?o=t.x-a-r:o=r-a-t.x;let d=c*o/u,h=n.x<t.x?n.x+u-o:n.x-u+o,m=n.y<t.y?n.y+d:n.y-d;return Ut.debug(`sides calc abc89, Q ${c}, q ${d}, R ${u}, r ${o}`,{_x:h,_y:m}),o===0&&(h=t.x,m=t.y),u===0&&(h=t.x),c===0&&(m=t.y),{x:h,y:m}}},"intersection"),DW=ie((e,t)=>{Ut.warn("abc88 cutPathAtIntersect",e,t);let n=[],r=e[0],s=!1;return e.forEach(i=>{if(Ut.info("abc88 checking point",i,t),!Cot(t,i)&&!s){const a=kot(t,r,i);Ut.debug("abc88 inside",i,r,a),Ut.debug("abc88 intersection",a,t);let o=!1;n.forEach(l=>{o=o||l.x===a.x&&l.y===a.y}),n.some(l=>l.x===a.x&&l.y===a.y)?Ut.warn("abc88 no intersect",a,n):n.push(a),s=!0}else Ut.warn("abc88 outside",i,r),r=i,s||n.push(i)}),Ut.debug("returning points",n),n},"cutPathAtIntersect");function tde(e){const t=[],n=[];for(let r=1;r<e.length-1;r++){const s=e[r-1],i=e[r],a=e[r+1];(s.x===i.x&&i.y===a.y&&Math.abs(i.x-a.x)>5&&Math.abs(i.y-s.y)>5||s.y===i.y&&i.x===a.x&&Math.abs(i.x-s.x)>5&&Math.abs(i.y-a.y)>5)&&(t.push(i),n.push(r))}return{cornerPoints:t,cornerPointPositions:n}}ie(tde,"extractCornerPoints");var FW=ie(function(e,t,n){const r=t.x-e.x,s=t.y-e.y,i=Math.sqrt(r*r+s*s),a=n/i;return{x:t.x-a*r,y:t.y-a*s}},"findAdjacentPoint"),Eot=ie(function(e){const{cornerPointPositions:t}=tde(e),n=[];for(let r=0;r<e.length;r++)if(t.includes(r)){const s=e[r-1],i=e[r+1],a=e[r],o=FW(s,a,5),l=FW(i,a,5),c=l.x-o.x,u=l.y-o.y;n.push(o);const d=Math.sqrt(2)*2;let h={x:a.x,y:a.y};if(Math.abs(i.x-s.x)>10&&Math.abs(i.y-s.y)>=10){Ut.debug("Corner point fixing",Math.abs(i.x-s.x),Math.abs(i.y-s.y));const m=5;a.x===o.x?h={x:c<0?o.x-m+d:o.x+m-d,y:u<0?o.y-d:o.y+d}:h={x:c<0?o.x-d:o.x+d,y:u<0?o.y-m+d:o.y+m-d}}else Ut.debug("Corner point skipping fixing",Math.abs(i.x-s.x),Math.abs(i.y-s.y));n.push(h,l)}else n.push(e[r]);return n},"fixCorners"),Tot=ie(function(e,t,n,r,s,i,a){var I;const{handDrawnSeed:o}=ls();let l=t.points,c=!1;const u=s;var d=i;const h=[];for(const O in t.cssCompiledStyles)Fce(O)||h.push(t.cssCompiledStyles[O]);d.intersect&&u.intersect&&(l=l.slice(1,t.points.length-1),l.unshift(u.intersect(l[0])),Ut.debug("Last point APA12",t.start,"-->",t.end,l[l.length-1],d,d.intersect(l[l.length-1])),l.push(d.intersect(l[l.length-1]))),t.toCluster&&(Ut.info("to cluster abc88",n.get(t.toCluster)),l=DW(t.points,n.get(t.toCluster).node),c=!0),t.fromCluster&&(Ut.debug("from cluster abc88",n.get(t.fromCluster),JSON.stringify(l,null,2)),l=DW(l.reverse(),n.get(t.fromCluster).node).reverse(),c=!0);let m=l.filter(O=>!Number.isNaN(O.y));m=Eot(m);let y=i2;switch(y=tE,t.curve){case"linear":y=tE;break;case"basis":y=i2;break;case"cardinal":y=Cle;break;case"bumpX":y=vle;break;case"bumpY":y=xle;break;case"catmullRom":y=Ele;break;case"monotoneX":y=Ile;break;case"monotoneY":y=jle;break;case"natural":y=Ole;break;case"step":y=Dle;break;case"stepAfter":y=Lle;break;case"stepBefore":y=Fle;break;default:y=i2}const{x:b,y:v}=KJe(t),x=Vnt().x(b).y(v).curve(y);let w;switch(t.thickness){case"normal":w="edge-thickness-normal";break;case"thick":w="edge-thickness-thick";break;case"invisible":w="edge-thickness-invisible";break;default:w="edge-thickness-normal"}switch(t.pattern){case"solid":w+=" edge-pattern-solid";break;case"dotted":w+=" edge-pattern-dotted";break;case"dashed":w+=" edge-pattern-dashed";break;default:w+=" edge-pattern-solid"}let S,k=x(m);const C=Array.isArray(t.style)?t.style:[t.style];let T=C.find(O=>O==null?void 0:O.startsWith("stroke:"));if(t.look==="handDrawn"){const O=An.svg(e);Object.assign([],m);const B=O.path(k,{roughness:.3,seed:o});w+=" transition",S=Zr(B).select("path").attr("id",t.id).attr("class"," "+w+(t.classes?" "+t.classes:"")).attr("style",C?C.reduce((H,P)=>H+";"+P,""):"");let D=S.attr("d");S.attr("d",D),e.node().appendChild(S.node())}else{const O=h.join(";"),B=C?C.reduce((P,K)=>P+K+";",""):"";let D="";t.animate&&(D=" edge-animation-fast"),t.animation&&(D=" edge-animation-"+t.animation);const H=O?O+";"+B+";":B;S=e.append("path").attr("d",k).attr("id",t.id).attr("class"," "+w+(t.classes?" "+t.classes:"")+(D??"")).attr("style",H),T=(I=H.match(/stroke:([^;]+)/))==null?void 0:I[1]}let A="";(ls().flowchart.arrowMarkerAbsolute||ls().state.arrowMarkerAbsolute)&&(A=window.location.protocol+"//"+window.location.host+window.location.pathname+window.location.search,A=A.replace(/\(/g,"\\(").replace(/\)/g,"\\)")),Ut.info("arrowTypeStart",t.arrowTypeStart),Ut.info("arrowTypeEnd",t.arrowTypeEnd),xot(S,t,A,a,r,T);let N={};return c&&(N.updatedPath=l),N.originalPath=t.points,N},"insertEdge"),Aot=ie((e,t,n,r)=>{t.forEach(s=>{Vot[s](e,n,r)})},"insertMarkers"),Rot=ie((e,t,n)=>{Ut.trace("Making markers for ",n),e.append("defs").append("marker").attr("id",n+"_"+t+"-extensionStart").attr("class","marker extension "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 1,7 L18,13 V 1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-extensionEnd").attr("class","marker extension "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 1,1 V 13 L18,7 Z")},"extension"),Not=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-compositionStart").attr("class","marker composition "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-compositionEnd").attr("class","marker composition "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"composition"),Mot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-aggregationStart").attr("class","marker aggregation "+t).attr("refX",18).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-aggregationEnd").attr("class","marker aggregation "+t).attr("refX",1).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L1,7 L9,1 Z")},"aggregation"),Iot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-dependencyStart").attr("class","marker dependency "+t).attr("refX",6).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("path").attr("d","M 5,7 L9,13 L1,7 L9,1 Z"),e.append("defs").append("marker").attr("id",n+"_"+t+"-dependencyEnd").attr("class","marker dependency "+t).attr("refX",13).attr("refY",7).attr("markerWidth",20).attr("markerHeight",28).attr("orient","auto").append("path").attr("d","M 18,7 L9,13 L14,7 L9,1 Z")},"dependency"),jot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-lollipopStart").attr("class","marker lollipop "+t).attr("refX",13).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6),e.append("defs").append("marker").attr("id",n+"_"+t+"-lollipopEnd").attr("class","marker lollipop "+t).attr("refX",1).attr("refY",7).attr("markerWidth",190).attr("markerHeight",240).attr("orient","auto").append("circle").attr("stroke","black").attr("fill","transparent").attr("cx",7).attr("cy",7).attr("r",6)},"lollipop"),Pot=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-pointEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 0 L 10 5 L 0 10 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-pointStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",4.5).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",8).attr("markerHeight",8).attr("orient","auto").append("path").attr("d","M 0 5 L 10 10 L 10 0 z").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"point"),Oot=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-circleEnd").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",11).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-circleStart").attr("class","marker "+t).attr("viewBox","0 0 10 10").attr("refX",-1).attr("refY",5).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("circle").attr("cx","5").attr("cy","5").attr("r","5").attr("class","arrowMarkerPath").style("stroke-width",1).style("stroke-dasharray","1,0")},"circle"),Dot=ie((e,t,n)=>{e.append("marker").attr("id",n+"_"+t+"-crossEnd").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",12).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0"),e.append("marker").attr("id",n+"_"+t+"-crossStart").attr("class","marker cross "+t).attr("viewBox","0 0 11 11").attr("refX",-1).attr("refY",5.2).attr("markerUnits","userSpaceOnUse").attr("markerWidth",11).attr("markerHeight",11).attr("orient","auto").append("path").attr("d","M 1,1 l 9,9 M 10,1 l -9,9").attr("class","arrowMarkerPath").style("stroke-width",2).style("stroke-dasharray","1,0")},"cross"),Fot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-barbEnd").attr("refX",19).attr("refY",7).attr("markerWidth",20).attr("markerHeight",14).attr("markerUnits","userSpaceOnUse").attr("orient","auto").append("path").attr("d","M 19,7 L9,13 L14,7 L9,1 Z")},"barb"),Lot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-onlyOneStart").attr("class","marker onlyOne "+t).attr("refX",0).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M9,0 L9,18 M15,0 L15,18"),e.append("defs").append("marker").attr("id",n+"_"+t+"-onlyOneEnd").attr("class","marker onlyOne "+t).attr("refX",18).attr("refY",9).attr("markerWidth",18).attr("markerHeight",18).attr("orient","auto").append("path").attr("d","M3,0 L3,18 M9,0 L9,18")},"only_one"),Bot=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrOneStart").attr("class","marker zeroOrOne "+t).attr("refX",0).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");r.append("circle").attr("fill","white").attr("cx",21).attr("cy",9).attr("r",6),r.append("path").attr("d","M9,0 L9,18");const s=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrOneEnd").attr("class","marker zeroOrOne "+t).attr("refX",30).attr("refY",9).attr("markerWidth",30).attr("markerHeight",18).attr("orient","auto");s.append("circle").attr("fill","white").attr("cx",9).attr("cy",9).attr("r",6),s.append("path").attr("d","M21,0 L21,18")},"zero_or_one"),$ot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-oneOrMoreStart").attr("class","marker oneOrMore "+t).attr("refX",18).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M0,18 Q 18,0 36,18 Q 18,36 0,18 M42,9 L42,27"),e.append("defs").append("marker").attr("id",n+"_"+t+"-oneOrMoreEnd").attr("class","marker oneOrMore "+t).attr("refX",27).attr("refY",18).attr("markerWidth",45).attr("markerHeight",36).attr("orient","auto").append("path").attr("d","M3,9 L3,27 M9,18 Q27,0 45,18 Q27,36 9,18")},"one_or_more"),zot=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrMoreStart").attr("class","marker zeroOrMore "+t).attr("refX",18).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");r.append("circle").attr("fill","white").attr("cx",48).attr("cy",18).attr("r",6),r.append("path").attr("d","M0,18 Q18,0 36,18 Q18,36 0,18");const s=e.append("defs").append("marker").attr("id",n+"_"+t+"-zeroOrMoreEnd").attr("class","marker zeroOrMore "+t).attr("refX",39).attr("refY",18).attr("markerWidth",57).attr("markerHeight",36).attr("orient","auto");s.append("circle").attr("fill","white").attr("cx",9).attr("cy",18).attr("r",6),s.append("path").attr("d","M21,18 Q39,0 57,18 Q39,36 21,18")},"zero_or_more"),Uot=ie((e,t,n)=>{e.append("defs").append("marker").attr("id",n+"_"+t+"-requirement_arrowEnd").attr("refX",20).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("path").attr("d",`M0,0
      L20,10
      M20,10
      L0,20`)},"requirement_arrow"),qot=ie((e,t,n)=>{const r=e.append("defs").append("marker").attr("id",n+"_"+t+"-requirement_containsStart").attr("refX",0).attr("refY",10).attr("markerWidth",20).attr("markerHeight",20).attr("orient","auto").append("g");r.append("circle").attr("cx",10).attr("cy",10).attr("r",9).attr("fill","none"),r.append("line").attr("x1",1).attr("x2",19).attr("y1",10).attr("y2",10),r.append("line").attr("y1",1).attr("y2",19).attr("x1",10).attr("x2",10)},"requirement_contains"),Vot={extension:Rot,composition:Not,aggregation:Mot,dependency:Iot,lollipop:jot,point:Pot,circle:Oot,cross:Dot,barb:Fot,only_one:Lot,zero_or_one:Bot,one_or_more:$ot,zero_or_more:zot,requirement_arrow:Uot,requirement_contains:qot},Wot=Aot,Hot={common:Eb,getConfig:zo,insertCluster:eot,insertEdge:Tot,insertEdgeLabel:_ot,insertMarkers:Wot,insertNode:ede,interpolateToCurve:K6,labelHelper:hr,log:Ut,positionEdgeLabel:Sot},m1={},nde=ie(e=>{for(const t of e)m1[t.name]=t},"registerLayoutLoaders"),Got=ie(()=>{nde([{name:"dagre",loader:ie(async()=>await Dr(()=>import("./dagre-OKDRZEBW-BP_uGu6R.js"),__vite__mapDeps([0,1,2,3,4,5])),"loader")}])},"registerDefaultLayoutLoaders");Got();var mft=ie(async(e,t)=>{if(!(e.layoutAlgorithm in m1))throw new Error(`Unknown layout algorithm: ${e.layoutAlgorithm}`);const n=m1[e.layoutAlgorithm];return(await n.loader()).render(e,t,Hot,{algorithm:n.algorithm})},"render"),gft=ie((e="",{fallback:t="dagre"}={})=>{if(e in m1)return e;if(t in m1)return Ut.warn(`Layout algorithm ${e} is not registered. Using ${t} as fallback.`),t;throw new Error(`Both layout algorithms ${e} and ${t} are not registered.`)},"getRegisteredLayoutAlgorithm"),LW={name:"mermaid",version:"11.6.0",description:"Markdown-ish syntax for generating flowcharts, mindmaps, sequence diagrams, class diagrams, gantt charts, git graphs and more.",type:"module",module:"./dist/mermaid.core.mjs",types:"./dist/mermaid.d.ts",exports:{".":{types:"./dist/mermaid.d.ts",import:"./dist/mermaid.core.mjs",default:"./dist/mermaid.core.mjs"},"./*":"./*"},keywords:["diagram","markdown","flowchart","sequence diagram","gantt","class diagram","git graph","mindmap","packet diagram","c4 diagram","er diagram","pie chart","pie diagram","quadrant chart","requirement diagram","graph"],scripts:{clean:"rimraf dist",dev:"pnpm -w dev","docs:code":"typedoc src/defaultConfig.ts src/config.ts src/mermaid.ts && prettier --write ./src/docs/config/setup","docs:build":"rimraf ../../docs && pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts","docs:verify":"pnpm docs:code && pnpm docs:spellcheck && tsx scripts/docs.cli.mts --verify","docs:pre:vitepress":"pnpm --filter ./src/docs prefetch && rimraf src/vitepress && pnpm docs:code && tsx scripts/docs.cli.mts --vitepress && pnpm --filter ./src/vitepress install --no-frozen-lockfile --ignore-scripts","docs:build:vitepress":"pnpm docs:pre:vitepress && (cd src/vitepress && pnpm run build) && cpy --flat src/docs/landing/ ./src/vitepress/.vitepress/dist/landing","docs:dev":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:dev:docker":'pnpm docs:pre:vitepress && concurrently "pnpm --filter ./src/vitepress dev:docker" "tsx scripts/docs.cli.mts --watch --vitepress"',"docs:serve":"pnpm docs:build:vitepress && vitepress serve src/vitepress","docs:spellcheck":'cspell "src/docs/**/*.md"',"docs:release-version":"tsx scripts/update-release-version.mts","docs:verify-version":"tsx scripts/update-release-version.mts --verify","types:build-config":"tsx scripts/create-types-from-json-schema.mts","types:verify-config":"tsx scripts/create-types-from-json-schema.mts --verify",checkCircle:"npx madge --circular ./src",prepublishOnly:"pnpm docs:verify-version"},repository:{type:"git",url:"https://github.com/mermaid-js/mermaid"},author:"Knut Sveidqvist",license:"MIT",standard:{ignore:["**/parser/*.js","dist/**/*.js","cypress/**/*.js"],globals:["page"]},dependencies:{"@braintree/sanitize-url":"^7.0.4","@iconify/utils":"^2.1.33","@mermaid-js/parser":"workspace:^","@types/d3":"^7.4.3",cytoscape:"^3.29.3","cytoscape-cose-bilkent":"^4.1.0","cytoscape-fcose":"^2.2.0",d3:"^7.9.0","d3-sankey":"^0.12.3","dagre-d3-es":"7.0.11",dayjs:"^1.11.13",dompurify:"^3.2.4",katex:"^0.16.9",khroma:"^2.1.0","lodash-es":"^4.17.21",marked:"^15.0.7",roughjs:"^4.6.6",stylis:"^4.3.6","ts-dedent":"^2.2.0",uuid:"^11.1.0"},devDependencies:{"@adobe/jsonschema2md":"^8.0.2","@iconify/types":"^2.0.0","@types/cytoscape":"^3.21.9","@types/cytoscape-fcose":"^2.2.4","@types/d3-sankey":"^0.12.4","@types/d3-scale":"^4.0.9","@types/d3-scale-chromatic":"^3.1.0","@types/d3-selection":"^3.0.11","@types/d3-shape":"^3.1.7","@types/jsdom":"^21.1.7","@types/katex":"^0.16.7","@types/lodash-es":"^4.17.12","@types/micromatch":"^4.0.9","@types/stylis":"^4.2.7","@types/uuid":"^10.0.0",ajv:"^8.17.1",chokidar:"^4.0.3",concurrently:"^9.1.2","csstree-validator":"^4.0.1",globby:"^14.0.2",jison:"^0.4.18","js-base64":"^3.7.7",jsdom:"^26.0.0","json-schema-to-typescript":"^15.0.4",micromatch:"^4.0.8","path-browserify":"^1.0.1",prettier:"^3.5.2",remark:"^15.0.1","remark-frontmatter":"^5.0.0","remark-gfm":"^4.0.1",rimraf:"^6.0.1","start-server-and-test":"^2.0.10","type-fest":"^4.35.0",typedoc:"^0.27.8","typedoc-plugin-markdown":"^4.4.2",typescript:"~5.7.3","unist-util-flatmap":"^1.0.0","unist-util-visit":"^5.0.0",vitepress:"^1.0.2","vitepress-plugin-search":"1.0.4-alpha.22"},files:["dist/","README.md"],publishConfig:{access:"public"}},Kot=ie(e=>{var s;const{securityLevel:t}=ls();let n=Zr("body");if(t==="sandbox"){const a=((s=Zr(`#i${e}`).node())==null?void 0:s.contentDocument)??document;n=Zr(a.body)}return n.select(`#${e}`)},"selectSvgElement"),rde="comm",sde="rule",ide="decl",Yot="@import",Zot="@namespace",Xot="@keyframes",Jot="@layer",ade=Math.abs,p5=String.fromCharCode;function ode(e){return e.trim()}function c2(e,t,n){return e.replace(t,n)}function Qot(e,t,n){return e.indexOf(t,n)}function H0(e,t){return e.charCodeAt(t)|0}function zy(e,t,n){return e.slice(t,n)}function mu(e){return e.length}function elt(e){return e.length}function IC(e,t){return t.push(e),e}var EA=1,Uy=1,lde=0,Jl=0,Ii=0,Mb="";function m5(e,t,n,r,s,i,a,o){return{value:e,root:t,parent:n,type:r,props:s,children:i,line:EA,column:Uy,length:a,return:"",siblings:o}}function tlt(){return Ii}function nlt(){return Ii=Jl>0?H0(Mb,--Jl):0,Uy--,Ii===10&&(Uy=1,EA--),Ii}function Ic(){return Ii=Jl<lde?H0(Mb,Jl++):0,Uy++,Ii===10&&(Uy=1,EA++),Ii}function Sh(){return H0(Mb,Jl)}function u2(){return Jl}function TA(e,t){return zy(Mb,e,t)}function g1(e){switch(e){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function rlt(e){return EA=Uy=1,lde=mu(Mb=e),Jl=0,[]}function slt(e){return Mb="",e}function G3(e){return ode(TA(Jl-1,PP(e===91?e+2:e===40?e+1:e)))}function ilt(e){for(;(Ii=Sh())&&Ii<33;)Ic();return g1(e)>2||g1(Ii)>3?"":" "}function alt(e,t){for(;--t&&Ic()&&!(Ii<48||Ii>102||Ii>57&&Ii<65||Ii>70&&Ii<97););return TA(e,u2()+(t<6&&Sh()==32&&Ic()==32))}function PP(e){for(;Ic();)switch(Ii){case e:return Jl;case 34:case 39:e!==34&&e!==39&&PP(Ii);break;case 40:e===41&&PP(e);break;case 92:Ic();break}return Jl}function olt(e,t){for(;Ic()&&e+Ii!==57;)if(e+Ii===84&&Sh()===47)break;return"/*"+TA(t,Jl-1)+"*"+p5(e===47?e:Ic())}function llt(e){for(;!g1(Sh());)Ic();return TA(e,Jl)}function clt(e){return slt(d2("",null,null,null,[""],e=rlt(e),0,[0],e))}function d2(e,t,n,r,s,i,a,o,l){for(var c=0,u=0,d=a,h=0,m=0,y=0,b=1,v=1,x=1,w=0,S="",k=s,C=i,T=r,A=S;v;)switch(y=w,w=Ic()){case 40:if(y!=108&&H0(A,d-1)==58){Qot(A+=c2(G3(w),"&","&\f"),"&\f",ade(c?o[c-1]:0))!=-1&&(x=-1);break}case 34:case 39:case 91:A+=G3(w);break;case 9:case 10:case 13:case 32:A+=ilt(y);break;case 92:A+=alt(u2()-1,7);continue;case 47:switch(Sh()){case 42:case 47:IC(ult(olt(Ic(),u2()),t,n,l),l),(g1(y||1)==5||g1(Sh()||1)==5)&&mu(A)&&zy(A,-1,void 0)!==" "&&(A+=" ");break;default:A+="/"}break;case 123*b:o[c++]=mu(A)*x;case 125*b:case 59:case 0:switch(w){case 0:case 125:v=0;case 59+u:x==-1&&(A=c2(A,/\f/g,"")),m>0&&(mu(A)-d||b===0&&y===47)&&IC(m>32?$W(A+";",r,n,d-1,l):$W(c2(A," ","")+";",r,n,d-2,l),l);break;case 59:A+=";";default:if(IC(T=BW(A,t,n,c,u,s,o,S,k=[],C=[],d,i),i),w===123)if(u===0)d2(A,t,T,T,k,i,d,o,C);else{switch(h){case 99:if(H0(A,3)===110)break;case 108:if(H0(A,2)===97)break;default:u=0;case 100:case 109:case 115:}u?d2(e,T,T,r&&IC(BW(e,T,T,0,0,s,o,S,s,k=[],d,C),C),s,C,d,o,r?k:C):d2(A,T,T,T,[""],C,0,o,C)}}c=u=m=0,b=x=1,S=A="",d=a;break;case 58:d=1+mu(A),m=y;default:if(b<1){if(w==123)--b;else if(w==125&&b++==0&&nlt()==125)continue}switch(A+=p5(w),w*b){case 38:x=u>0?1:(A+="\f",-1);break;case 44:o[c++]=(mu(A)-1)*x,x=1;break;case 64:Sh()===45&&(A+=G3(Ic())),h=Sh(),u=d=mu(S=A+=llt(u2())),w++;break;case 45:y===45&&mu(A)==2&&(b=0)}}return i}function BW(e,t,n,r,s,i,a,o,l,c,u,d){for(var h=s-1,m=s===0?i:[""],y=elt(m),b=0,v=0,x=0;b<r;++b)for(var w=0,S=zy(e,h+1,h=ade(v=a[b])),k=e;w<y;++w)(k=ode(v>0?m[w]+" "+S:c2(S,/&\f/g,m[w])))&&(l[x++]=k);return m5(e,t,n,s===0?sde:o,l,c,u,d)}function ult(e,t,n,r){return m5(e,t,n,rde,p5(tlt()),zy(e,2,-2),0,r)}function $W(e,t,n,r,s){return m5(e,t,n,ide,zy(e,0,r),zy(e,r+1,-1),r,s)}function OP(e,t){for(var n="",r=0;r<e.length;r++)n+=t(e[r],r,e,t)||"";return n}function dlt(e,t,n,r){switch(e.type){case Jot:if(e.children.length)break;case Yot:case Zot:case ide:return e.return=e.return||e.value;case rde:return"";case Xot:return e.return=e.value+"{"+OP(e.children,r)+"}";case sde:if(!mu(e.value=e.props.join(",")))return""}return mu(n=OP(e.children,r))?e.return=e.value+"{"+n+"}":""}var flt=Ule(Object.keys,Object),hlt=Object.prototype,plt=hlt.hasOwnProperty;function mlt(e){if(!yA(e))return flt(e);var t=[];for(var n in Object(e))plt.call(e,n)&&n!="constructor"&&t.push(n);return t}var DP=cg(Yu,"DataView"),FP=cg(Yu,"Promise"),LP=cg(Yu,"Set"),BP=cg(Yu,"WeakMap"),zW="[object Map]",glt="[object Object]",UW="[object Promise]",qW="[object Set]",VW="[object WeakMap]",WW="[object DataView]",ylt=lg(DP),blt=lg(p1),vlt=lg(FP),xlt=lg(LP),wlt=lg(BP),em=Tb;(DP&&em(new DP(new ArrayBuffer(1)))!=WW||p1&&em(new p1)!=zW||FP&&em(FP.resolve())!=UW||LP&&em(new LP)!=qW||BP&&em(new BP)!=VW)&&(em=function(e){var t=Tb(e),n=t==glt?e.constructor:void 0,r=n?lg(n):"";if(r)switch(r){case ylt:return WW;case blt:return zW;case vlt:return UW;case xlt:return qW;case wlt:return VW}return t});var _lt="[object Map]",Slt="[object Set]",Clt=Object.prototype,klt=Clt.hasOwnProperty;function HW(e){if(e==null)return!0;if(bA(e)&&(lE(e)||typeof e=="string"||typeof e.splice=="function"||H6(e)||G6(e)||oE(e)))return!e.length;var t=em(e);if(t==_lt||t==Slt)return!e.size;if(yA(e))return!mlt(e).length;for(var n in e)if(klt.call(e,n))return!1;return!0}var cde="c4",Elt=ie(e=>/^\s*C4Context|C4Container|C4Component|C4Dynamic|C4Deployment/.test(e),"detector"),Tlt=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./c4Diagram-VJAJSXHY-DAoYp8P1.js");return{diagram:t}},__vite__mapDeps([6,7]));return{id:cde,diagram:e}},"loader"),Alt={id:cde,detector:Elt,loader:Tlt},Rlt=Alt,ude="flowchart",Nlt=ie((e,t)=>{var n,r;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-wrapper"||((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"?!1:/^\s*graph/.test(e)},"detector"),Mlt=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-DV0MFZip.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:ude,diagram:e}},"loader"),Ilt={id:ude,detector:Nlt,loader:Mlt},jlt=Ilt,dde="flowchart-v2",Plt=ie((e,t)=>{var n,r,s;return((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="dagre-d3"?!1:(((r=t==null?void 0:t.flowchart)==null?void 0:r.defaultRenderer)==="elk"&&(t.layout="elk"),/^\s*graph/.test(e)&&((s=t==null?void 0:t.flowchart)==null?void 0:s.defaultRenderer)==="dagre-wrapper"?!0:/^\s*flowchart/.test(e))},"detector"),Olt=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-DV0MFZip.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:dde,diagram:e}},"loader"),Dlt={id:dde,detector:Plt,loader:Olt},Flt=Dlt,fde="er",Llt=ie(e=>/^\s*erDiagram/.test(e),"detector"),Blt=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./erDiagram-Q7BY3M3F-DQXt_1Bg.js");return{diagram:t}},__vite__mapDeps([11,9,10]));return{id:fde,diagram:e}},"loader"),$lt={id:fde,detector:Llt,loader:Blt},zlt=$lt,hde="gitGraph",Ult=ie(e=>/^\s*gitGraph/.test(e),"detector"),qlt=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./gitGraphDiagram-7IBYFJ6S-D4Y31WBC.js");return{diagram:t}},__vite__mapDeps([12,13,14,15,2,4,5]));return{id:hde,diagram:e}},"loader"),Vlt={id:hde,detector:Ult,loader:qlt},Wlt=Vlt,pde="gantt",Hlt=ie(e=>/^\s*gantt/.test(e),"detector"),Glt=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./ganttDiagram-APWFNJXF-BzM2t_dV.js");return{diagram:t}},__vite__mapDeps([16,17,18]));return{id:pde,diagram:e}},"loader"),Klt={id:pde,detector:Hlt,loader:Glt},Ylt=Klt,mde="info",Zlt=ie(e=>/^\s*info/.test(e),"detector"),Xlt=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./infoDiagram-PH2N3AL5-jE3WwQYk.js");return{diagram:t}},__vite__mapDeps([19,15,2,4,5]));return{id:mde,diagram:e}},"loader"),Jlt={id:mde,detector:Zlt,loader:Xlt},gde="pie",Qlt=ie(e=>/^\s*pie/.test(e),"detector"),ect=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./pieDiagram-IB7DONF6-Dm8Axtby.js");return{diagram:t}},__vite__mapDeps([20,13,15,2,4,5,21,22,18]));return{id:gde,diagram:e}},"loader"),tct={id:gde,detector:Qlt,loader:ect},yde="quadrantChart",nct=ie(e=>/^\s*quadrantChart/.test(e),"detector"),rct=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./quadrantDiagram-7GDLP6J5-DgaaC3vq.js");return{diagram:t}},__vite__mapDeps([23,17,18]));return{id:yde,diagram:e}},"loader"),sct={id:yde,detector:nct,loader:rct},ict=sct,bde="xychart",act=ie(e=>/^\s*xychart-beta/.test(e),"detector"),oct=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./xychartDiagram-VJFVF3MP-B8QNAwNv.js");return{diagram:t}},__vite__mapDeps([24,18,22,17]));return{id:bde,diagram:e}},"loader"),lct={id:bde,detector:act,loader:oct},cct=lct,vde="requirement",uct=ie(e=>/^\s*requirement(Diagram)?/.test(e),"detector"),dct=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./requirementDiagram-KVF5MWMF-CuBxPlW9.js");return{diagram:t}},__vite__mapDeps([25,9]));return{id:vde,diagram:e}},"loader"),fct={id:vde,detector:uct,loader:dct},hct=fct,xde="sequence",pct=ie(e=>/^\s*sequenceDiagram/.test(e),"detector"),mct=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./sequenceDiagram-X6HHIX6F-CgSrSdSo.js");return{diagram:t}},__vite__mapDeps([26,7,14]));return{id:xde,diagram:e}},"loader"),gct={id:xde,detector:pct,loader:mct},yct=gct,wde="class",bct=ie((e,t)=>{var n;return((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*classDiagram/.test(e)},"detector"),vct=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./classDiagram-GIVACNV2-6ORpZH1j.js");return{diagram:t}},__vite__mapDeps([27,28,9]));return{id:wde,diagram:e}},"loader"),xct={id:wde,detector:bct,loader:vct},wct=xct,_de="classDiagram",_ct=ie((e,t)=>{var n;return/^\s*classDiagram/.test(e)&&((n=t==null?void 0:t.class)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!0:/^\s*classDiagram-v2/.test(e)},"detector"),Sct=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./classDiagram-v2-COTLJTTW-6ORpZH1j.js");return{diagram:t}},__vite__mapDeps([29,28,9]));return{id:_de,diagram:e}},"loader"),Cct={id:_de,detector:_ct,loader:Sct},kct=Cct,Sde="state",Ect=ie((e,t)=>{var n;return((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper"?!1:/^\s*stateDiagram/.test(e)},"detector"),Tct=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./stateDiagram-DGXRK772-BiXRKdTN.js");return{diagram:t}},__vite__mapDeps([30,31,9,1,2,3,4]));return{id:Sde,diagram:e}},"loader"),Act={id:Sde,detector:Ect,loader:Tct},Rct=Act,Cde="stateDiagram",Nct=ie((e,t)=>{var n;return!!(/^\s*stateDiagram-v2/.test(e)||/^\s*stateDiagram/.test(e)&&((n=t==null?void 0:t.state)==null?void 0:n.defaultRenderer)==="dagre-wrapper")},"detector"),Mct=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./stateDiagram-v2-YXO3MK2T-Ch1LouUT.js");return{diagram:t}},__vite__mapDeps([32,31,9]));return{id:Cde,diagram:e}},"loader"),Ict={id:Cde,detector:Nct,loader:Mct},jct=Ict,kde="journey",Pct=ie(e=>/^\s*journey/.test(e),"detector"),Oct=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./journeyDiagram-U35MCT3I-633ng70h.js");return{diagram:t}},__vite__mapDeps([33,7,21]));return{id:kde,diagram:e}},"loader"),Dct={id:kde,detector:Pct,loader:Oct},Fct=Dct,Lct=ie((e,t,n)=>{Ut.debug(`rendering svg for syntax error
`);const r=Kot(t),s=r.append("g");r.attr("viewBox","0 0 2412 512"),iae(r,100,512,!0),s.append("path").attr("class","error-icon").attr("d","m411.313,123.313c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32-9.375,9.375-20.688-20.688c-12.484-12.5-32.766-12.5-45.25,0l-16,16c-1.261,1.261-2.304,2.648-3.31,4.051-21.739-8.561-45.324-13.426-70.065-13.426-105.867,0-192,86.133-192,192s86.133,192 192,192 192-86.133 192-192c0-24.741-4.864-48.327-13.426-70.065 1.402-1.007 2.79-2.049 4.051-3.31l16-16c12.5-12.492 12.5-32.758 0-45.25l-20.688-20.688 9.375-9.375 32.001-31.999zm-219.313,100.687c-52.938,0-96,43.063-96,96 0,8.836-7.164,16-16,16s-16-7.164-16-16c0-70.578 57.422-128 128-128 8.836,0 16,7.164 16,16s-7.164,16-16,16z"),s.append("path").attr("class","error-icon").attr("d","m459.02,148.98c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l16,16c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16.001-16z"),s.append("path").attr("class","error-icon").attr("d","m340.395,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688 6.25-6.25 6.25-16.375 0-22.625l-16-16c-6.25-6.25-16.375-6.25-22.625,0s-6.25,16.375 0,22.625l15.999,16z"),s.append("path").attr("class","error-icon").attr("d","m400,64c8.844,0 16-7.164 16-16v-32c0-8.836-7.156-16-16-16-8.844,0-16,7.164-16,16v32c0,8.836 7.156,16 16,16z"),s.append("path").attr("class","error-icon").attr("d","m496,96.586h-32c-8.844,0-16,7.164-16,16 0,8.836 7.156,16 16,16h32c8.844,0 16-7.164 16-16 0-8.836-7.156-16-16-16z"),s.append("path").attr("class","error-icon").attr("d","m436.98,75.605c3.125,3.125 7.219,4.688 11.313,4.688 4.094,0 8.188-1.563 11.313-4.688l32-32c6.25-6.25 6.25-16.375 0-22.625s-16.375-6.25-22.625,0l-32,32c-6.251,6.25-6.251,16.375-0.001,22.625z"),s.append("text").attr("class","error-text").attr("x",1440).attr("y",250).attr("font-size","150px").style("text-anchor","middle").text("Syntax error in text"),s.append("text").attr("class","error-text").attr("x",1250).attr("y",400).attr("font-size","100px").style("text-anchor","middle").text(`mermaid version ${n}`)},"draw"),Ede={draw:Lct},Bct=Ede,$ct={db:{},renderer:Ede,parser:{parse:ie(()=>{},"parse")}},zct=$ct,Tde="flowchart-elk",Uct=ie((e,t={})=>{var n;return/^\s*flowchart-elk/.test(e)||/^\s*flowchart|graph/.test(e)&&((n=t==null?void 0:t.flowchart)==null?void 0:n.defaultRenderer)==="elk"?(t.layout="elk",!0):!1},"detector"),qct=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./flowDiagram-4HSFHLVR-DV0MFZip.js");return{diagram:t}},__vite__mapDeps([8,9,10]));return{id:Tde,diagram:e}},"loader"),Vct={id:Tde,detector:Uct,loader:qct},Wct=Vct,Ade="timeline",Hct=ie(e=>/^\s*timeline/.test(e),"detector"),Gct=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./timeline-definition-BDJGKUSR-DlhRL8hc.js");return{diagram:t}},__vite__mapDeps([34,21]));return{id:Ade,diagram:e}},"loader"),Kct={id:Ade,detector:Hct,loader:Gct},Yct=Kct,Rde="mindmap",Zct=ie(e=>/^\s*mindmap/.test(e),"detector"),Xct=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./mindmap-definition-ALO5MXBD-DJOoKNdo.js");return{diagram:t}},__vite__mapDeps([35,36]));return{id:Rde,diagram:e}},"loader"),Jct={id:Rde,detector:Zct,loader:Xct},Qct=Jct,Nde="kanban",eut=ie(e=>/^\s*kanban/.test(e),"detector"),tut=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./kanban-definition-NDS4AKOZ-2XcO8OoW.js");return{diagram:t}},[]);return{id:Nde,diagram:e}},"loader"),nut={id:Nde,detector:eut,loader:tut},rut=nut,Mde="sankey",sut=ie(e=>/^\s*sankey-beta/.test(e),"detector"),iut=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./sankeyDiagram-QLVOVGJD-BpP9x-9M.js");return{diagram:t}},__vite__mapDeps([37,22,18]));return{id:Mde,diagram:e}},"loader"),aut={id:Mde,detector:sut,loader:iut},out=aut,Ide="packet",lut=ie(e=>/^\s*packet-beta/.test(e),"detector"),cut=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./diagram-VNBRO52H-CZc-FANS.js");return{diagram:t}},__vite__mapDeps([38,13,15,2,4,5]));return{id:Ide,diagram:e}},"loader"),uut={id:Ide,detector:lut,loader:cut},jde="radar",dut=ie(e=>/^\s*radar-beta/.test(e),"detector"),fut=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./diagram-SSKATNLV-BITmD47d.js");return{diagram:t}},__vite__mapDeps([39,13,15,2,4,5]));return{id:jde,diagram:e}},"loader"),hut={id:jde,detector:dut,loader:fut},Pde="block",put=ie(e=>/^\s*block-beta/.test(e),"detector"),mut=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./blockDiagram-JOT3LUYC-CJ7Eq9Ut.js");return{diagram:t}},__vite__mapDeps([40,5,2,1,10]));return{id:Pde,diagram:e}},"loader"),gut={id:Pde,detector:put,loader:mut},yut=gut,Ode="architecture",but=ie(e=>/^\s*architecture/.test(e),"detector"),vut=ie(async()=>{const{diagram:e}=await Dr(async()=>{const{diagram:t}=await import("./architectureDiagram-IEHRJDOE-Caw6k2ZI.js");return{diagram:t}},__vite__mapDeps([41,13,14,15,2,4,5,36]));return{id:Ode,diagram:e}},"loader"),xut={id:Ode,detector:but,loader:vut},wut=xut,GW=!1,AA=ie(()=>{GW||(GW=!0,zk("error",zct,e=>e.toLowerCase().trim()==="error"),zk("---",{db:{clear:ie(()=>{},"clear")},styles:{},renderer:{draw:ie(()=>{},"draw")},parser:{parse:ie(()=>{throw new Error("Diagrams beginning with --- are not valid. If you were trying to use a YAML front-matter, please ensure that you've correctly opened and closed the YAML front-matter with un-indented `---` blocks")},"parse")},init:ie(()=>null,"init")},e=>e.toLowerCase().trimStart().startsWith("---")),Hie(Rlt,rut,kct,wct,zlt,Ylt,Jlt,tct,hct,yct,Wct,Flt,jlt,Qct,Yct,Wlt,jct,Rct,Fct,ict,out,uut,cct,yut,wut,hut))},"addDiagrams"),_ut=ie(async()=>{Ut.debug("Loading registered diagrams");const t=(await Promise.allSettled(Object.entries(jy).map(async([n,{detector:r,loader:s}])=>{if(s)try{X4(n)}catch{try{const{diagram:i,id:a}=await s();zk(a,i,r)}catch(i){throw Ut.error(`Failed to load external diagram with key ${n}. Removing from detectors.`),delete jy[n],i}}}))).filter(n=>n.status==="rejected");if(t.length>0){Ut.error(`Failed to load ${t.length} external diagrams`);for(const n of t)Ut.error(n);throw new Error(`Failed to load ${t.length} external diagrams`)}},"loadRegisteredDiagrams"),Sut="graphics-document document";function Dde(e,t){e.attr("role",Sut),t!==""&&e.attr("aria-roledescription",t)}ie(Dde,"setA11yDiagramInfo");function Fde(e,t,n,r){if(e.insert!==void 0){if(n){const s=`chart-desc-${r}`;e.attr("aria-describedby",s),e.insert("desc",":first-child").attr("id",s).text(n)}if(t){const s=`chart-title-${r}`;e.attr("aria-labelledby",s),e.insert("title",":first-child").attr("id",s).text(t)}}}ie(Fde,"addSVGa11yTitleDescription");var wm,$P=(wm=class{constructor(t,n,r,s,i){this.type=t,this.text=n,this.db=r,this.parser=s,this.renderer=i}static async fromText(t,n={}){var c,u;const r=zo(),s=y6(t,r);t=Vit(t)+`
`;try{X4(s)}catch{const d=KZe(s);if(!d)throw new Wie(`Diagram ${s} not found.`);const{id:h,diagram:m}=await d();zk(h,m)}const{db:i,parser:a,renderer:o,init:l}=X4(s);return a.parser&&(a.parser.yy=i),(c=i.clear)==null||c.call(i),l==null||l(r),n.title&&((u=i.setDiagramTitle)==null||u.call(i,n.title)),await a.parse(t),new wm(s,t,i,a,o)}async render(t,n){await this.renderer.draw(this.text,t,n,this)}getParser(){return this.parser}getType(){return this.type}},ie(wm,"Diagram"),wm),KW=[],Cut=ie(()=>{KW.forEach(e=>{e()}),KW=[]},"attachFunctions"),kut=ie(e=>e.replace(/^\s*%%(?!{)[^\n]+\n?/gm,"").trimStart(),"cleanupComments");function Lde(e){const t=e.match(Vie);if(!t)return{text:e,metadata:{}};let n=GJe(t[1],{schema:HJe})??{};n=typeof n=="object"&&!Array.isArray(n)?n:{};const r={};return n.displayMode&&(r.displayMode=n.displayMode.toString()),n.title&&(r.title=n.title.toString()),n.config&&(r.config=n.config),{text:e.slice(t[0].length),metadata:r}}ie(Lde,"extractFrontMatter");var Eut=ie(e=>e.replace(/\r\n?/g,`
`).replace(/<(\w+)([^>]*)>/g,(t,n,r)=>"<"+n+r.replace(/="([^"]*)"/g,"='$1'")+">"),"cleanupText"),Tut=ie(e=>{const{text:t,metadata:n}=Lde(e),{displayMode:r,title:s,config:i={}}=n;return r&&(i.gantt||(i.gantt={}),i.gantt.displayMode=r),{title:s,config:i,text:t}},"processFrontmatter"),Aut=ie(e=>{const t=xu.detectInit(e)??{},n=xu.detectDirective(e,"wrap");return Array.isArray(n)?t.wrap=n.some(({type:r})=>r==="wrap"):(n==null?void 0:n.type)==="wrap"&&(t.wrap=!0),{text:Mit(e),directive:t}},"processDirectives");function g5(e){const t=Eut(e),n=Tut(t),r=Aut(n.text),s=Q6(n.config,r.directive);return e=kut(r.text),{code:e,title:n.title,config:s}}ie(g5,"preprocessDiagram");function Bde(e){const t=new TextEncoder().encode(e),n=Array.from(t,r=>String.fromCodePoint(r)).join("");return btoa(n)}ie(Bde,"toBase64");var Rut=5e4,Nut="graph TB;a[Maximum text size in diagram exceeded];style a fill:#faa",Mut="sandbox",Iut="loose",jut="http://www.w3.org/2000/svg",Put="http://www.w3.org/1999/xlink",Out="http://www.w3.org/1999/xhtml",Dut="100%",Fut="100%",Lut="border:0;margin:0;",But="margin:0",$ut="allow-top-navigation-by-user-activation allow-popups",zut='The "iframe" tag is not supported by your browser.',Uut=["foreignobject"],qut=["dominant-baseline"];function y5(e){const t=g5(e);return Bk(),uXe(t.config??{}),t}ie(y5,"processAndSetConfigs");async function $de(e,t){AA();try{const{code:n,config:r}=y5(e);return{diagramType:(await Ude(n)).type,config:r}}catch(n){if(t!=null&&t.suppressErrors)return!1;throw n}}ie($de,"parse");var YW=ie((e,t,n=[])=>`
.${e} ${t} { ${n.join(" !important; ")} !important; }`,"cssImportantStyles"),Vut=ie((e,t=new Map)=>{var r;let n="";if(e.themeCSS!==void 0&&(n+=`
${e.themeCSS}`),e.fontFamily!==void 0&&(n+=`
:root { --mermaid-font-family: ${e.fontFamily}}`),e.altFontFamily!==void 0&&(n+=`
:root { --mermaid-alt-font-family: ${e.altFontFamily}}`),t instanceof Map){const o=e.htmlLabels??((r=e.flowchart)==null?void 0:r.htmlLabels)?["> *","span"]:["rect","polygon","ellipse","circle","path"];t.forEach(l=>{HW(l.styles)||o.forEach(c=>{n+=YW(l.id,c,l.styles)}),HW(l.textStyles)||(n+=YW(l.id,"tspan",((l==null?void 0:l.textStyles)||[]).map(c=>c.replace("color","fill"))))})}return n},"createCssStyles"),Wut=ie((e,t,n,r)=>{const s=Vut(e,n),i=RXe(t,s,e.themeVariables);return OP(clt(`${r}{${i}}`),dlt)},"createUserStyles"),Hut=ie((e="",t,n)=>{let r=e;return!n&&!t&&(r=r.replace(/marker-end="url\([\d+./:=?A-Za-z-]*?#/g,'marker-end="url(#')),r=ug(r),r=r.replace(/<br>/g,"<br/>"),r},"cleanUpSvgCode"),Gut=ie((e="",t)=>{var s,i;const n=(i=(s=t==null?void 0:t.viewBox)==null?void 0:s.baseVal)!=null&&i.height?t.viewBox.baseVal.height+"px":Fut,r=Bde(`<body style="${But}">${e}</body>`);return`<iframe style="width:${Dut};height:${n};${Lut}" src="data:text/html;charset=UTF-8;base64,${r}" sandbox="${$ut}">
  ${zut}
</iframe>`},"putIntoIFrame"),ZW=ie((e,t,n,r,s)=>{const i=e.append("div");i.attr("id",n),r&&i.attr("style",r);const a=i.append("svg").attr("id",t).attr("width","100%").attr("xmlns",jut);return s&&a.attr("xmlns:xlink",s),a.append("g"),e},"appendDivSvgG");function zP(e,t){return e.append("iframe").attr("id",t).attr("style","width: 100%; height: 100%;").attr("sandbox","")}ie(zP,"sandboxedIframe");var Kut=ie((e,t,n,r)=>{var s,i,a;(s=e.getElementById(t))==null||s.remove(),(i=e.getElementById(n))==null||i.remove(),(a=e.getElementById(r))==null||a.remove()},"removeExistingElements"),Yut=ie(async function(e,t,n){var D,H,P,K,U,V;AA();const r=y5(t);t=r.code;const s=zo();Ut.debug(s),t.length>((s==null?void 0:s.maxTextSize)??Rut)&&(t=Nut);const i="#"+e,a="i"+e,o="#"+a,l="d"+e,c="#"+l,u=ie(()=>{const te=Zr(h?o:c).node();te&&"remove"in te&&te.remove()},"removeTempElements");let d=Zr("body");const h=s.securityLevel===Mut,m=s.securityLevel===Iut,y=s.fontFamily;if(n!==void 0){if(n&&(n.innerHTML=""),h){const L=zP(Zr(n),a);d=Zr(L.nodes()[0].contentDocument.body),d.node().style.margin=0}else d=Zr(n);ZW(d,e,l,`font-family: ${y}`,Put)}else{if(Kut(document,e,l,a),h){const L=zP(Zr("body"),a);d=Zr(L.nodes()[0].contentDocument.body),d.node().style.margin=0}else d=Zr("body");ZW(d,e,l)}let b,v;try{b=await $P.fromText(t,{title:r.title})}catch(L){if(s.suppressErrorRendering)throw u(),L;b=await $P.fromText("error"),v=L}const x=d.select(c).node(),w=b.type,S=x.firstChild,k=S.firstChild,C=(H=(D=b.renderer).getClasses)==null?void 0:H.call(D,t,b),T=Wut(s,w,C,i),A=document.createElement("style");A.innerHTML=T,S.insertBefore(A,k);try{await b.renderer.draw(t,e,LW.version,b)}catch(L){throw s.suppressErrorRendering?u():Bct.draw(t,e,LW.version),L}const N=d.select(`${c} svg`),I=(K=(P=b.db).getAccTitle)==null?void 0:K.call(P),O=(V=(U=b.db).getAccDescription)==null?void 0:V.call(U);qde(w,N,I,O),d.select(`[id="${e}"]`).selectAll("foreignobject > *").attr("xmlns",Out);let B=d.select(c).node().innerHTML;if(Ut.debug("config.arrowMarkerAbsolute",s.arrowMarkerAbsolute),B=Hut(B,h,Ki(s.arrowMarkerAbsolute)),h){const L=d.select(c+" svg").node();B=Gut(B,L)}else m||(B=Iy.sanitize(B,{ADD_TAGS:Uut,ADD_ATTR:qut,HTML_INTEGRATION_POINTS:{foreignobject:!0}}));if(Cut(),v)throw v;return u(),{diagramType:w,svg:B,bindFunctions:b.db.bindFunctions}},"render");function zde(e={}){var r;const t=Ca({},e);t!=null&&t.fontFamily&&!((r=t.themeVariables)!=null&&r.fontFamily)&&(t.themeVariables||(t.themeVariables={}),t.themeVariables.fontFamily=t.fontFamily),lXe(t),t!=null&&t.theme&&t.theme in Vd?t.themeVariables=Vd[t.theme].getThemeVariables(t.themeVariables):t&&(t.themeVariables=Vd.default.getThemeVariables(t.themeVariables));const n=typeof t=="object"?oXe(t):Jie();g6(n.logLevel),AA()}ie(zde,"initialize");var Ude=ie((e,t={})=>{const{code:n}=g5(e);return $P.fromText(n,t)},"getDiagramFromText");function qde(e,t,n,r){Dde(t,e),Fde(t,n,r,t.attr("id"))}ie(qde,"addA11yInfo");var Vm=Object.freeze({render:Yut,parse:$de,getDiagramFromText:Ude,initialize:zde,getConfig:zo,setConfig:Qie,getSiteConfig:Jie,updateSiteConfig:cXe,reset:ie(()=>{Bk()},"reset"),globalReset:ie(()=>{Bk(Py)},"globalReset"),defaultConfig:Py});g6(zo().logLevel);Bk(zo());var Zut=ie((e,t,n)=>{Ut.warn(e),J6(e)?(n&&n(e.str,e.hash),t.push({...e,message:e.str,error:e})):(n&&n(e),e instanceof Error&&t.push({str:e.message,message:e.message,hash:e.name,error:e}))},"handleError"),Vde=ie(async function(e={querySelector:".mermaid"}){try{await Xut(e)}catch(t){if(J6(t)&&Ut.error(t.str),hl.parseError&&hl.parseError(t),!e.suppressErrors)throw Ut.error("Use the suppressErrors option to suppress these errors"),t}},"run"),Xut=ie(async function({postRenderCallback:e,querySelector:t,nodes:n}={querySelector:".mermaid"}){const r=Vm.getConfig();Ut.debug(`${e?"":"No "}Callback function found`);let s;if(n)s=n;else if(t)s=document.querySelectorAll(t);else throw new Error("Nodes and querySelector are both undefined");Ut.debug(`Found ${s.length} diagrams`),(r==null?void 0:r.startOnLoad)!==void 0&&(Ut.debug("Start On Load: "+(r==null?void 0:r.startOnLoad)),Vm.updateSiteConfig({startOnLoad:r==null?void 0:r.startOnLoad}));const i=new xu.InitIDGenerator(r.deterministicIds,r.deterministicIDSeed);let a;const o=[];for(const l of Array.from(s)){if(Ut.info("Rendering diagram: "+l.id),l.getAttribute("data-processed"))continue;l.setAttribute("data-processed","true");const c=`mermaid-${i.next()}`;a=l.innerHTML,a=bce(xu.entityDecode(a)).trim().replace(/<br\s*\/?>/gi,"<br/>");const u=xu.detectInit(a);u&&Ut.debug("Detected early reinit: ",u);try{const{svg:d,bindFunctions:h}=await Kde(c,a,l);l.innerHTML=d,e&&await e(c),h&&h(l)}catch(d){Zut(d,o,hl.parseError)}}if(o.length>0)throw o[0]},"runThrowsErrors"),Wde=ie(function(e){Vm.initialize(e)},"initialize"),Jut=ie(async function(e,t,n){Ut.warn("mermaid.init is deprecated. Please use run instead."),e&&Wde(e);const r={postRenderCallback:n,querySelector:".mermaid"};typeof t=="string"?r.querySelector=t:t&&(t instanceof HTMLElement?r.nodes=[t]:r.nodes=t),await Vde(r)},"init"),Qut=ie(async(e,{lazyLoad:t=!0}={})=>{AA(),Hie(...e),t===!1&&await _ut()},"registerExternalDiagrams"),Hde=ie(function(){if(hl.startOnLoad){const{startOnLoad:e}=Vm.getConfig();e&&hl.run().catch(t=>Ut.error("Mermaid failed to initialize",t))}},"contentLoaded");typeof document<"u"&&window.addEventListener("load",Hde,!1);var edt=ie(function(e){hl.parseError=e},"setParseErrorHandler"),bE=[],K3=!1,Gde=ie(async()=>{if(!K3){for(K3=!0;bE.length>0;){const e=bE.shift();if(e)try{await e()}catch(t){Ut.error("Error executing queue",t)}}K3=!1}},"executeQueue"),tdt=ie(async(e,t)=>new Promise((n,r)=>{const s=ie(()=>new Promise((i,a)=>{Vm.parse(e,t).then(o=>{i(o),n(o)},o=>{var l;Ut.error("Error parsing",o),(l=hl.parseError)==null||l.call(hl,o),a(o),r(o)})}),"performCall");bE.push(s),Gde().catch(r)}),"parse"),Kde=ie((e,t,n)=>new Promise((r,s)=>{const i=ie(()=>new Promise((a,o)=>{Vm.render(e,t,n).then(l=>{a(l),r(l)},l=>{var c;Ut.error("Error parsing",l),(c=hl.parseError)==null||c.call(hl,l),o(l),s(l)})}),"performCall");bE.push(i),Gde().catch(s)}),"render"),hl={startOnLoad:!0,mermaidAPI:Vm,parse:tdt,render:Kde,init:Jut,run:Vde,registerExternalDiagrams:Qut,registerLayoutLoaders:nde,initialize:Wde,parseError:void 0,contentLoaded:Hde,setParseErrorHandler:edt,detectType:y6,registerIconPacks:gQe},ndt=hl;/*! Check if previously processed *//*!
 * Wait for document loaded before starting the execution
 */const rdt=new DOMParser,sdt=new XMLSerializer;function XW(e,t){const n=e.getAttribute(t);if(!n)return;let r="";for(const s of n.split(/\s+/)){const i=e.getElementById(s);i&&(r+=i.textContent)}return r}let JW=0;const idt=async(e,t)=>{const n=document.createElement("div");n.ariaHidden="true",n.style.maxHeight="0",n.style.opacity="0",n.style.overflow="hidden",t!=null&&t.containerStyle&&Object.assign(n.style,t.containerStyle),document.body.append(n);const r=await Promise.allSettled(e.map(async s=>{const i=`${(t==null?void 0:t.prefix)??"mermaid"}-${JW}`;JW+=1;const{svg:a}=await ndt.render(i,s,n),o=rdt.parseFromString(a,"text/html"),[l]=o.getElementsByTagName("svg"),{height:c,width:u}=l.viewBox.baseVal,d=XW(l,"aria-describedby"),h=XW(l,"aria-labelledby"),m={height:c,id:i,svg:sdt.serializeToString(l),width:u};return d&&(m.description=d),h&&(m.title=h),m}));return n.remove(),r},adt=()=>idt,odt=({code:e,isStreaming:t=!1})=>{const{foldStreamingCodeBlocks:n}=pr(yn(T=>({foldStreamingCodeBlocks:T.foldStreamingCodeBlocks}))),[r,s]=E.useState(t?n:!1),[i,a]=E.useState(null),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState(!1),m=E.useRef(null),y=Wi(yn(T=>Object.values(T.canvasControls))),b=E.useCallback((T,A,N,I,O)=>y.filter(B=>B.type==="codeblock"&&B.targetSlot===T&&B.renderer).map(B=>{if(B.renderer){const D={codeBlockContent:A,codeBlockLang:"mermaid",isFolded:I,toggleFold:O,canvasContextType:"codeblock"};return f.jsx(Ve.Fragment,{children:B.renderer(D)},B.id)}return null}).filter(Boolean),[y]),v=E.useCallback(async()=>{if(!(!e.trim()||r)){l(!0),u(null),a(null);try{const A=await adt()([e]);if(A.length>0&&A[0].status==="fulfilled")a(A[0].value.svg);else if(A.length>0&&A[0].status==="rejected"){const N=A[0].reason;u((N==null?void 0:N.message)||"Failed to render Mermaid diagram")}else u("No results returned from Mermaid renderer")}catch(T){console.error("Mermaid rendering error:",T),u(T instanceof Error?T.message:"Failed to render Mermaid diagram")}finally{l(!1)}}},[e,r]);E.useEffect(()=>{!r&&e.trim()&&!d&&v()},[e,r,d,v]);const x=()=>{const T=r;s(A=>!A),T&&!d&&setTimeout(v,0)},w=E.useCallback(async()=>{if(!i){Te.error("No SVG content to download");return}try{const T=new Blob([i],{type:"image/svg+xml"}),A=URL.createObjectURL(T),N=document.createElement("a");N.href=A,N.download="mermaid-diagram.svg",document.body.appendChild(N),N.click(),document.body.removeChild(N),URL.revokeObjectURL(A),Te.success("SVG downloaded successfully!")}catch(T){console.error("Download error:",T),Te.error("Failed to download SVG")}},[i]),S=E.useCallback(()=>{h(T=>!T)},[]),k=E.useMemo(()=>e?e.split(`
`).slice(0,3).join(`
`):"",[e]),C=b("codeblock-header-actions",e,"mermaid",r,x);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:"MERMAID"}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:C})]}),f.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:[f.jsx("button",{onClick:S,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:d?"Show diagram":"Show code",children:d?f.jsx(Ah,{className:"h-4 w-4"}):f.jsx(_E,{className:"h-4 w-4"})}),i&&!d&&f.jsx("button",{onClick:w,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:"Download SVG",children:f.jsx(Tc,{className:"h-4 w-4"})})]})]}),!r&&f.jsx("div",{className:"overflow-hidden w-full",children:d?f.jsx(m6,{lang:"mermaid",code:e,isStreaming:t}):f.jsxs(f.Fragment,{children:[o&&f.jsxs("div",{className:"flex items-center justify-center p-8",children:[f.jsx(Jn,{className:"h-6 w-6 animate-spin text-muted-foreground"}),f.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Rendering diagram..."})]}),c&&f.jsxs("div",{className:"flex items-center gap-2 p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:[f.jsx(Kl,{className:"h-5 w-5 text-destructive flex-shrink-0"}),f.jsxs("div",{className:"text-sm text-destructive",children:[f.jsx("div",{className:"font-medium",children:"Failed to render Mermaid diagram"}),f.jsx("div",{className:"text-xs mt-1 opacity-80",children:c})]})]}),i&&!o&&!c&&f.jsx("div",{ref:m,className:"mermaid-container p-4 bg-background border rounded-md overflow-auto",dangerouslySetInnerHTML:{__html:i}})]})}),r&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:x,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:k})})]})},ldt=E.memo(odt);class cdt{constructor(){ue(this,"id","core-block-renderer-mermaid");ue(this,"unregisterCallback")}async initialize(){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={id:this.id,supportedLanguages:["mermaid"],priority:10,renderer:r=>Ve.createElement(ldt,{code:r.code,isStreaming:r.isStreaming})};this.unregisterCallback=t.registerBlockRenderer(n)}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=void 0)}}class tm{static parse(t){try{const n=this.sanitizeCode(t),r=this.parseObjectLiteral(n);return this.validateAndSanitize(r)}catch(n){throw new Error(`Failed to parse Formedible definition: ${n instanceof Error?n.message:String(n)}`)}}static sanitizeCode(t){let n=t.replace(/\/\*[\s\S]*?\*\//g,"").replace(/\/\/.*$/gm,"");return n=n.replace(/\b(eval|Function|setTimeout|setInterval|require|import)\s*\(/g,""),n=n.replace(/=>\s*{[^}]*}/g,'""'),n=n.replace(/function\s*\([^)]*\)\s*{[^}]*}/g,'""'),n}static parseObjectLiteral(t){try{return JSON.parse(t)}catch{try{let r=t.trim();return r=this.replaceZodExpressions(r),r=r.replace(/([{,]\s*)([a-zA-Z_$][a-zA-Z0-9_$]*)\s*:/g,'$1"$2":'),r=r.replace(/,(\s*[}\]])/g,"$1"),r=r.replace(/'/g,'"'),JSON.parse(r)}catch(r){throw new Error(`Invalid syntax. Please use valid JSON format or JavaScript object literal syntax. Error: ${r instanceof Error?r.message:String(r)}`)}}}static replaceZodExpressions(t){let n=t,r=!0;for(;r;){r=!1;const s=n.match(/z\.[a-zA-Z]+\(/);if(s){const i=s.index,a=i+s[0].length-1;let o=1,l=a+1;for(;l<n.length&&o>0;)n[l]==="("?o++:n[l]===")"&&o--,l++;if(o===0){let c=l;for(;c<n.length;){const u=n.slice(c).match(/^\.[a-zA-Z]+\(/);if(u){let d=1,m=c+u[0].length-1+1;for(;m<n.length&&d>0;)n[m]==="("?d++:n[m]===")"&&d--,m++;if(d===0)c=m;else break}else break}n=n.slice(0,i)+'"__ZOD_SCHEMA__"'+n.slice(c),r=!0}else n=n.replace(/z\.[a-zA-Z]+/,'"__ZOD_SCHEMA__"'),r=!0}}return n}static validateAndSanitize(t){if(typeof t!="object"||t===null)throw new Error("Definition must be an object");const n={};for(const[r,s]of Object.entries(t))if(this.ALLOWED_KEYS.includes(r))switch(r){case"schema":break;case"fields":n[r]=this.validateFields(s);break;case"pages":n[r]=this.validatePages(s);break;case"progress":n[r]=this.validateProgress(s);break;case"formOptions":n[r]=this.validateFormOptions(s);break;case"submitLabel":case"nextLabel":case"previousLabel":case"formClassName":case"fieldClassName":typeof s=="string"&&(n[r]=s);break}return n}static validateFields(t){if(!Array.isArray(t))throw new Error("Fields must be an array");return t.map((n,r)=>{if(typeof n!="object"||n===null)throw new Error(`Field at index ${r} must be an object`);const s={};for(const[i,a]of Object.entries(n))if(this.ALLOWED_FIELD_KEYS.includes(i))switch(i){case"name":typeof a=="string"&&/^[a-zA-Z_$][a-zA-Z0-9_$]*$/.test(a)&&(s[i]=a);break;case"type":typeof a=="string"&&this.ALLOWED_FIELD_TYPES.includes(a)&&(s[i]=a);break;case"label":case"placeholder":case"description":case"accept":typeof a=="string"&&(s[i]=a);break;case"options":Array.isArray(a)&&(s[i]=a.filter(o=>typeof o=="string"||typeof o=="object"&&o!==null&&typeof o.value=="string"&&typeof o.label=="string"));break;case"min":case"max":case"step":case"page":typeof a=="number"&&!isNaN(a)&&(s[i]=a);break;case"multiple":typeof a=="boolean"&&(s[i]=a);break}if(!s.name||!s.type)throw new Error(`Field at index ${r} must have 'name' and 'type' properties`);return s})}static validatePages(t){return Array.isArray(t)?t.map(n=>{if(typeof n!="object"||n===null)return null;const r={};for(const[s,i]of Object.entries(n))if(this.ALLOWED_PAGE_KEYS.includes(s))switch(s){case"page":typeof i=="number"&&!isNaN(i)&&(r[s]=i);break;case"title":case"description":typeof i=="string"&&(r[s]=i);break}return r.page?r:null}).filter(Boolean):[]}static validateProgress(t){if(typeof t!="object"||t===null)return{};const n={};for(const[r,s]of Object.entries(t))if(this.ALLOWED_PROGRESS_KEYS.includes(r))switch(r){case"showSteps":case"showPercentage":typeof s=="boolean"&&(n[r]=s);break;case"className":typeof s=="string"&&(n[r]=s);break}return n}static validateFormOptions(t){if(typeof t!="object"||t===null)return{};const n={};for(const[r,s]of Object.entries(t))if(this.ALLOWED_FORM_OPTIONS_KEYS.includes(r))switch(r){case"defaultValues":typeof s=="object"&&s!==null&&(n[r]=s);break;case"asyncDebounceMs":typeof s=="number"&&!isNaN(s)&&(n[r]=s);break;case"canSubmitWhenInvalid":typeof s=="boolean"&&(n[r]=s);break}return n}}ue(tm,"ALLOWED_FIELD_TYPES",["text","email","password","url","tel","textarea","select","checkbox","switch","number","date","slider","file"]),ue(tm,"ALLOWED_KEYS",["schema","fields","pages","progress","submitLabel","nextLabel","previousLabel","formClassName","fieldClassName","formOptions"]),ue(tm,"ALLOWED_FIELD_KEYS",["name","type","label","placeholder","description","options","min","max","step","accept","multiple","page","conditional"]),ue(tm,"ALLOWED_PAGE_KEYS",["page","title","description"]),ue(tm,"ALLOWED_PROGRESS_KEYS",["showSteps","showPercentage","className"]),ue(tm,"ALLOWED_FORM_OPTIONS_KEYS",["defaultValues","asyncDebounceMs","canSubmitWhenInvalid"]);const udt=({code:e,isStreaming:t=!1})=>{const{foldStreamingCodeBlocks:n}=pr(yn(H=>({foldStreamingCodeBlocks:H.foldStreamingCodeBlocks}))),[r,s]=E.useState(t?n:!1),[i,a]=E.useState(null),[o,l]=E.useState(!1),[c,u]=E.useState(null),[d,h]=E.useState(!1),[m,y]=E.useState(!1),b=E.useMemo(()=>`_sendOnSubmit_${qr()}`,[]),v=Wi(yn(H=>Object.values(H.canvasControls))),x=E.useCallback((H,P,K,U,V)=>v.filter(L=>L.type==="codeblock"&&L.targetSlot===H&&L.renderer).map(L=>{if(L.renderer){const te={codeBlockContent:P,codeBlockLang:"formedible",isFolded:U,toggleFold:V,canvasContextType:"codeblock"};return f.jsx(Ve.Fragment,{children:L.renderer(te)},L.id)}return null}).filter(Boolean),[v]),w=E.useCallback(async()=>{if(!(!e.trim()||r)){l(!0),u(null),a(null);try{const H=tm.parse(e);a(H)}catch(H){console.error("Formedible parsing error:",H),u(H instanceof Error?H.message:"Failed to parse Formedible definition")}finally{l(!1)}}},[e,r]);E.useEffect(()=>{!r&&e.trim()&&!d&&!t&&w()},[e,r,d,t,w]);const S=()=>{const H=r;s(P=>!P),H&&!d&&setTimeout(w,0)},k=E.useCallback(()=>{h(H=>!H)},[]),C=E.useMemo(()=>e?e.split(`
`).slice(0,3).join(`
`):"",[e]),T=E.useCallback(H=>{const P={};return H.forEach(K=>{switch(K.type){case"text":case"email":case"password":case"url":case"tel":case"textarea":P[K.name]=$e();break;case"number":case"slider":P[K.name]=At();break;case"checkbox":case"switch":P[K.name]=Zn();break;case"date":P[K.name]=vbe();break;case"select":P[K.name]=$e();break;case"file":P[K.name]=Gd();break;default:P[K.name]=$e()}}),Ke(P)},[]),A=E.useCallback(H=>{const P={};return H.forEach(K=>{switch(K.type){case"text":case"email":case"password":case"url":case"tel":case"textarea":P[K.name]="";break;case"number":case"slider":P[K.name]=K.min||0;break;case"checkbox":case"switch":P[K.name]=!1;break;case"date":P[K.name]=new Date().toISOString().split("T")[0];break;case"select":if(K.options&&K.options.length>0){const U=K.options[0];P[K.name]=typeof U=="string"?U:U.value}else P[K.name]="";break;case"file":P[K.name]=null;break;default:P[K.name]=""}}),P},[]),N=E.useCallback(async(H,P)=>{try{const U=`These are the form values:
\`\`\`json
${JSON.stringify(H,null,2)}
\`\`\`
`;Re.emit(sn.setInputTextRequest,{text:U}),Re.emit(sn.focusInputRequest,void 0),console.log("Formedible: sendOnSubmit value before conditional: ",P),P?(console.log("Sending form data to prompt"),requestAnimationFrame(()=>{console.log("Setting input text");try{console.log("Creating turn data");const V={id:qr(),content:U,parameters:{},metadata:{}};Re.emit(sn.submitPromptRequest,{turnData:V}),Te.success("Form submitted and prompt sent!")}catch(V){console.error("Failed to submit prompt:",V),Te.error("Form data added to input, but failed to send prompt")}})):Te.success("Form data added to prompt input")}catch(K){console.error("Form submission error:",K),Te.error("Failed to process form submission")}},[]),I=E.useMemo(()=>{var H;if(!i||!i.fields)return null;try{const P=T(i.fields),K=((H=i.formOptions)==null?void 0:H.defaultValues)||A(i.fields),U=i.pages&&i.pages.length>0?Math.max(...i.pages.map(W=>W.page)):1,V=[...i.fields,{name:b,type:"switch",label:"Send on submit",description:"Automatically send the prompt after form submission",page:U}],L=P.extend({[b]:Zn().default(!1)}),te={...K,[b]:!1};return{schema:L,fields:V,pages:i.pages,progress:i.progress,submitLabel:i.submitLabel||"Submit",nextLabel:i.nextLabel||"Next",previousLabel:i.previousLabel||"Previous",formClassName:i.formClassName,fieldClassName:i.fieldClassName,formOptions:{...i.formOptions,defaultValues:te,canSubmitWhenInvalid:!0,onSubmit:async({value:W})=>{console.log("Formedible onSubmit received full value:",W),console.log("Formedible onSubmit received sendOnSubmit:",W[b]);const Q=W[b],ee={...W};delete ee[b],y(Q),await N(ee,Q)},onSubmitInvalid:({value:W,formApi:Q})=>{console.error("Formedible onSubmitInvalid triggered. Values:",W),console.error("Formedible onSubmitInvalid triggered. Form API errors:",Q.formState.errors),Te.error("Form has validation errors. Please check your input.")}},disabled:!1}}catch(P){return console.error("Form configuration error:",P),{error:P instanceof Error?P.message:"Unknown error"}}},[i,T,A,N,b]),O=u_(I&&!("error"in I)?I:{fields:[],formOptions:{defaultValues:{}}}),B=E.useMemo(()=>I?"error"in I?f.jsx("div",{className:"p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:f.jsxs("div",{className:"text-sm text-destructive",children:["Failed to render form: ",I.error]})}):!i||!i.fields?null:f.jsx(O.Form,{}):null,[I,i,O.Form]),D=x("codeblock-header-actions",e,"formedible",r,S);return f.jsxs("div",{className:"code-block-container group/codeblock my-4 max-w-full",children:[f.jsxs("div",{className:"code-block-header sticky top-0 z-10 flex items-center justify-between",children:[f.jsxs("div",{className:"flex items-center gap-1",children:[f.jsx("div",{className:"text-sm font-medium",children:"FORMEDIBLE"}),f.jsx("div",{className:"flex items-center gap-0.5 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:D})]}),f.jsx("div",{className:"flex items-center gap-1 opacity-0 group-hover/codeblock:opacity-100 focus-within:opacity-100 transition-opacity",children:f.jsx("button",{onClick:k,className:"p-1.5 rounded-md hover:bg-muted/50 transition-colors",title:d?"Show form":"Show code",children:d?f.jsx(Nge,{className:"h-4 w-4"}):f.jsx(_E,{className:"h-4 w-4"})})})]}),!r&&f.jsx("div",{className:"overflow-hidden w-full",children:d?f.jsx(m6,{lang:"formedible",code:e,isStreaming:t}):f.jsxs(f.Fragment,{children:[o&&f.jsxs("div",{className:"flex items-center justify-center p-8",children:[f.jsx(Jn,{className:"h-6 w-6 animate-spin text-muted-foreground"}),f.jsx("span",{className:"ml-2 text-sm text-muted-foreground",children:"Parsing form definition..."})]}),c&&f.jsxs("div",{className:"flex items-center gap-2 p-4 border border-destructive/20 bg-destructive/10 rounded-md",children:[f.jsx(Kl,{className:"h-5 w-5 text-destructive flex-shrink-0"}),f.jsxs("div",{className:"text-sm text-destructive",children:[f.jsx("div",{className:"font-medium",children:"Failed to parse Formedible definition"}),f.jsx("div",{className:"text-xs mt-1 opacity-80",children:c})]})]}),B&&!o&&!c&&f.jsxs("div",{className:"p-4 bg-background border rounded-md",children:[f.jsx("div",{className:"mb-4 p-2 bg-muted/50 rounded text-xs text-muted-foreground",children:" Interactive Form - Fill out and submit to add data to prompt input"}),B]})]})}),r&&f.jsx("div",{className:"folded-content-preview p-4 cursor-pointer w-full box-border",onClick:S,children:f.jsx("pre",{className:"whitespace-pre-wrap break-words text-muted-foreground font-mono text-sm",children:C})})]})},ddt=E.memo(udt);class fdt{constructor(){ue(this,"id","core-block-renderer-formedible");ue(this,"unregisterCallback")}async initialize(){}register(t){if(this.unregisterCallback){console.warn(`[${this.id}] Already registered. Skipping.`);return}const n={id:this.id,supportedLanguages:["formedible"],priority:10,renderer:r=>Ve.createElement(ddt,{code:r.code,isStreaming:r.isStreaming})};this.unregisterCallback=t.registerBlockRenderer(n)}destroy(){this.unregisterCallback&&(this.unregisterCallback(),this.unregisterCallback=void 0)}}const hdt=[gVe,IHe,BHe,UKe,pYe,vYe,_Ye,Y$e,J9e,Z9e,$qe,zqe,pVe,Yqe,Xqe,Qqe,bVe,kze,SUe,fVe,qqe,iqe,wze,Hqe,xVe,yHe,wHe,AHe,BUe,zUe,KUe,eqe,tqe,hZe,cdt,fdt,CYe,JYe,eZe,EYe,AYe,NYe,IYe,PYe,LYe,DYe,nZe,sZe,oZe,ZYe,dZe];function pdt(){return f.jsxs(W$e,{children:[f.jsx(q$e,{}),f.jsx(U$e,{}),f.jsx("div",{className:"h-screen bg-background text-foreground flex flex-col",children:f.jsx("main",{className:"flex-grow overflow-hidden",children:f.jsx(D$e,{controls:hdt})})})]})}E0e();Ehe.createRoot(document.getElementById("root")).render(f.jsx(Ve.StrictMode,{children:f.jsx(pdt,{})}));export{$nt as $,Wx as A,HZe as B,LXe as C,Q6 as D,zo as E,Zie as F,Dit as G,Kot as H,LW as I,HJe as J,eXe as K,Dy as L,Ydt as M,vA as N,b6 as O,RV as P,Vnt as Q,i2 as R,Oit as S,m_ as T,EXe as U,p_ as V,Cn as W,Un as X,aae as Y,Tit as Z,ie as _,IXe as a,yZe as a$,B6 as a0,tft as a1,sft as a2,h0 as a3,nW as a4,tW as a5,aft as a6,ift as a7,rft as a8,Qdt as a9,Sit as aA,mst as aB,git as aC,V6 as aD,HW as aE,Tat as aF,znt as aG,da as aH,lA as aI,gQe as aJ,mQe as aK,og as aL,Cit as aM,Zle as aN,pA as aO,bA as aP,lE as aQ,Jle as aR,Yle as aS,eit as aT,jo as aU,htt as aV,P6 as aW,rle as aX,b_ as aY,ale as aZ,Jdt as a_,eft as aa,lft as ab,nft as ac,oft as ad,eot as ae,ede as af,hft as ag,KJe as ah,Ki as ai,bp as aj,M6 as ak,Ace as al,ug as am,sce as an,dr as ao,$u as ap,C0 as aq,Wot as ar,fft as as,pft as at,uft as au,jn as av,dft as aw,Tot as ax,Sot as ay,_ot as az,MXe as b,O6 as b0,bh as b1,YV as b2,xtt as b3,d1 as b4,_it as b5,mit as b6,nst as b7,W6 as b8,Zst as b9,Mi as bA,Dr as bB,Eit as ba,x_ as bb,Tb as bc,iE as bd,oit as be,mlt as bf,v_ as bg,oE as bh,tit as bi,qle as bj,ist as bk,ast as bl,em as bm,yW as bn,ost as bo,H6 as bp,sst as bq,ust as br,Ab as bs,yp as bt,fW as bu,G6 as bv,Wle as bw,LP as bx,kit as by,yA as bz,ls as c,Zr as d,iae as e,Ca as f,PXe as g,nf as h,Bm as i,xQe as j,Eb as k,Ut as l,ace as m,Zdt as n,gft as o,OXe as p,DXe as q,mft as r,jXe as s,GJe as t,xu as u,vot as v,Bit as w,cft as x,NXe as y,Xdt as z};
